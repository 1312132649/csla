<html><header><title>Strange Drag and Drop problem</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Strange Drag and Drop problem</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/651.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai posted on Tuesday, July 18, 2006</h2><P>Hi guys.</P>
<P>I have a custom TreeNode that stores a reference to a Csla Business Object in a property.&nbsp; I wanted to support drag and drop of this TreeNode and its related business object to another application.&nbsp; First off I tried drag and drop within the same application, and that worked fine.&nbsp; Then I tried drag and drop to another application and got the Exception "This remoting proxy has no channel sink which means either the server has no registered server channels that are listening, or this application has no suitable client channel to talk to the server".</P>
<P>This is the code I am using (<FONT size=2>tvBusinessObjects is a TreeView)</FONT></P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> tvBusinessObjects_MouseMove(</FONT><FONT color=#0000ff size=2>object</FONT><FONT size=2> sender, </FONT><FONT color=#008080 size=2>MouseEventArgs</FONT><FONT size=2> e)<BR></FONT><FONT size=2>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (e.Button == </FONT><FONT color=#008080 size=2>MouseButtons</FONT><FONT size=2>.Left &amp;&amp; tvBusinessObjects.SelectedNode != </FONT><FONT color=#0000ff size=2>null</FONT><FONT size=2>)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>DoDragDrop(tvBusinessObjects.SelectedNode, </FONT><FONT color=#008080 size=2>DragDropEffects</FONT><FONT size=2>.Move);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>}</FONT></P><FONT color=#0000ff>
<P><FONT size=2>private</FONT></FONT><FONT size=2> <FONT color=#0000ff>void</FONT> tvBusinessObjects_DragDrop(<FONT color=#0000ff>object</FONT> sender, <FONT color=#008080>DragEventArgs</FONT> e)<BR>{<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT size=2><FONT color=#008000>//Check the type of the data is correct<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff>if</FONT> (e.Data.GetDataPresent(<FONT color=#0000ff>typeof</FONT>(<FONT color=#008080>BusinessObjectTreeNode</FONT>)))<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT color=#008080>BusinessObjectTreeNode</FONT> tn = (<FONT color=#008080>BusinessObjectTreeNode</FONT>)e.Data.GetData(<FONT color=#0000ff>typeof</FONT>(<FONT color=#008080>BusinessObjectTreeNode</FONT>));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ProcessDraggedBizObject(tn);<BR>&nbsp;&nbsp;&nbsp;}<BR>}</FONT></P><FONT color=#0000ff>
<P><FONT size=2>private</FONT></FONT><FONT size=2> <FONT color=#0000ff>void</FONT> ProcessDraggedBizObject(<FONT color=#008080>BusinessObjectTreeNode</FONT> tn)<BR>{<BR>&nbsp;&nbsp;&nbsp;<FONT color=#008080>BusinessObject</FONT> bo = tn.BusinessObject;&nbsp;&nbsp;&nbsp;//Exception raised here!<BR>&nbsp;&nbsp;&nbsp;//Do some more stuff with the BO<BR>}</FONT></P>
<P>If I look at the value of the tn variable in the DragDrop event it is listed as System.Runtime.Remoting.Proxies__TransparentProxy rather than BusinessObjectTreeNode as expected.&nbsp; When dragging locally it seems to be the correct type.&nbsp; What on earth do I need to do to get this to work correctly?&nbsp; Hope somone can help!</P>
<P>TIA</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai replied on Tuesday, July 18, 2006</h2>Interesting, I can replicate this without using the Csla at all i.e. with a standard TreeView.&nbsp; Still struggling to fix it though!</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai replied on Tuesday, July 18, 2006</h2>Figured it out.&nbsp; TreeNode is not Serializable!&nbsp; Can get around this by passing the actual biz object rather than the TreeNode.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
