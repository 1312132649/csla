<html><header><title>Need help with VB BusinessListBase using async factory methods</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Need help with VB BusinessListBase using async factory methods</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9476.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>c_manboy posted on Tuesday, September 07, 2010</h2><p>I&#39;m creating a wpf project using MVVM and Bxf as outlined in Rocky&#39;s videos.&nbsp;&nbsp;</p>
<p>It took me awhile to realize that my factory methods require an EventHandler parameter.&nbsp; I&#39;ve tried converting the sample C# code, but&nbsp;I&nbsp;am unsuccessful.&nbsp; Looking in the Expert VB book, Chapter 15 on page 440 seems to address the async factory methods, but I&#39;m having a hard time implementing them in my BO.</p>
<p>My GetGroupList method has an error on the addhandler line becuase callback does not exist in my BO.&nbsp;&nbsp;&nbsp;Here&#39;s my current Factory Methods and Data Access:</p>
<p>
<p><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">
<p>#Region <span style="font-family:Consolas;color:#a31515;font-size:x-small;">&quot;Factory Methods&quot;</span></p>
<span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"></span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">Public</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">Shared</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">Function</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> GetGroups() </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">As</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">Groups</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> <br />&nbsp;&nbsp;&nbsp; </span></span></span></span>Return<span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">DataPortal</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">.FetchChild(</span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">Of</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">Groups</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">)()<span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> <br /></span></span></span></span>End<span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">Function</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> <br /></span></span></span></span>Public<span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">Shared</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">Sub</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> GetGroupList(</span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">ByVal</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> callback </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">As</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">EventHandler</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">(</span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">Of</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">DataPortalResult</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">(</span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">Of</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">Groups</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">)))<span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> <br />&nbsp;&nbsp;&nbsp; </span></span></span></span>Dim<span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> dp = </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">New</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">DataPortal</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">(</span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">Of</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">Groups</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">)()<span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> <br />&nbsp;&nbsp;&nbsp; </span></span></span></span>AddHandler<span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> dp.FetchCompleted, </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">AddressOf</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> callback<br />&nbsp;&nbsp;&nbsp; dp.BeginFetch()</span></span><br />End<span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">Sub
<p>#End Region</p>
<p>#Region <span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;">&quot;Data Access&quot;</span> </span></span></p>
</span></span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">Private</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">Overloads</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">Sub</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> DataPortal_Fetch()<br />&nbsp;&nbsp;&nbsp; RaiseListChangedEvents = False <br />&nbsp;&nbsp;&nbsp; </span></span>Dim<span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> reader </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">As</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">New</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> Dal.</span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">Reader</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> <br />&nbsp;&nbsp;&nbsp; </span></span></span></span>Dim<span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> groups </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">As</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">List</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">(</span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">Of</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> Dal.</span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">DtoGroup</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">) = reader.GetGroups <br />&nbsp;&nbsp;&nbsp; </span></span>For<span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">Each</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> grp </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">In</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> groups<span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></span>Dim<span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> dtoGroup </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">As</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">New</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> Dal.</span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">DtoGroup</span></span></span>dto<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Group.Name = grp.Namedto<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Group.Path = grp.Path <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me<span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">.Add(</span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">Group</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">.GetGroup(dtoGroup))<span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> <br />&nbsp;&nbsp;&nbsp; </span></span></span></span>Next <span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">
<p>RaiseListChangedEvents = True</p>
<span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">End</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">Sub<span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">
<p>#End Region</p>
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Tuesday, September 07, 2010</h2><p>If you can upgrade to VB 10 and Visual Studio 10 your life will be much easier, because VB now has multi-line lambda support. That allows you to use comparable syntax to C#.</p>
<p>If you are still using VB 9, you are about to discover why I quit maintaining CSLA in VB - without multi-line lambda support it is much harder to do async programming.</p>
<p>Basically, in VB9 you often have to create an intermediate object to maintain state between the point where you start the async call and the point where the async call completes. In the simplest cases you don&#39;t need to do this, and you can just provide the AddressOf the callback handler, but if there&#39;s any information around the point of the async call that is needed in the async handler, you need this intermediate state object.</p>
<p>Before I spend a lot of time either way - are you VB 9 or 10?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>c_manboy replied on Tuesday, September 07, 2010</h2><p>VB 10 with VS 2010</p>
<p>I&#39;ve continued to work on it and the following code fetches the data and appears to populate the List, but nothing appears in grid.&nbsp; The viewmodel is not firing OnRefreshed because I assume callback is not properly implemented in my code:</p>
<p><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:blue;">#Region</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"> <span style="color:#A31515;">&quot;Factory Methods&quot;</span></span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Public</span> <span style="color:blue;">Shared</span> <span style="color:blue;">Function</span> GetGroups() <span style="color:blue;">As</span> <span style="color:#2B91AF;">Groups</span></span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Return</span> <span style="color:#2B91AF;">DataPortal</span>.FetchChild(<span style="color:blue;">Of</span> <span style="color:#2B91AF;">Groups</span>)()</span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">End</span> <span style="color:blue;">Function</span></span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Public</span> <span style="color:blue;">Shared</span> <span style="color:blue;">Sub</span> GetGroupList(<span style="color:blue;">ByVal</span> callback <span style="color:blue;">As</span> <span style="color:#2B91AF;">EventHandler</span>(<span style="color:blue;">Of</span> <span style="color:#2B91AF;">DataPortalResult</span>(<span style="color:blue;">Of</span> <span style="color:#2B91AF;">Groups</span>)))</span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Dim</span> dp = <span style="color:blue;">New</span> <span style="color:#2B91AF;">DataPortal</span>(<span style="color:blue;">Of</span> <span style="color:#2B91AF;">Groups</span>)()</span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dp.BeginFetch(callback)</span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">End</span> <span style="color:blue;">Sub</span></span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:blue;">#End</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"> <span style="color:blue;">Region</span></span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:blue;">#Region</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"> <span style="color:#A31515;">&quot;Data Access&quot;</span></span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Private</span> <span style="color:blue;">Overloads</span> <span style="color:blue;">Sub</span> DataPortal_Fetch()</span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RaiseListChangedEvents = <span style="color:blue;">False</span></span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Dim</span> reader <span style="color:blue;">As</span> <span style="color:blue;">New</span> Dal.<span style="color:#2B91AF;">Reader</span></span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Dim</span> groups <span style="color:blue;">As</span> <span style="color:#2B91AF;">List</span>(<span style="color:blue;">Of</span> Dal.<span style="color:#2B91AF;">DtoGroup</span>) = reader.GetGroups</span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">For</span> <span style="color:blue;">Each</span> grp <span style="color:blue;">In</span> groups</span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Dim</span> dtoGroup <span style="color:blue;">As</span> <span style="color:blue;">New</span> Dal.<span style="color:#2B91AF;">DtoGroup</span></span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dtoGroup.Name = grp.Name</span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dtoGroup.Path = grp.Path</span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Me</span>.Add(<span style="color:#2B91AF;">Group</span>.GetGroup(dtoGroup))</span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Next</span></span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</span>RaiseListChangedEvents = <span style="color:blue;">True</span></span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">End</span> <span style="color:blue;">Sub</span></span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:blue;">#End</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"> <span style="color:blue;">Region</span></span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;color:blue;">End</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"> <span style="color:blue;">Class</span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>c_manboy replied on Tuesday, September 07, 2010</h2><p>I added my AddHandler back in to my second post on my GetGroupList method with the addtion of Invoke:</p>
<p>AddHandler dp.FetchCompleted, AddressOf callback.Invoke</p>
<p>This seems to be working now.&nbsp; However, my lack of comprehending this process makes me wonder if that&#39;s the correct solution and/or if I missed something else in my methods?&nbsp; I&#39;ll eventually &quot;get it&quot;, but until then I want to make sure I&#39;m not missing something else.</p>
<p>Thanks.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Tuesday, September 07, 2010</h2><p>It is true that if you rely on things like ViewModel&lt;T&gt; or CslaDataProvider you shouldn&#39;t have to worry about the low-level details. Those components are designed to handle the async stuff so you don&#39;t have to.</p>
<p>The only exception is the factory method, where you need to set the callback parameter as being the handler for the completed event and you are set.</p>
<p>In fact, you can just use the static helper method on DataPortal to consolidate that all into one line of code, which simplifies the factory method even more:</p>
<p>DataPortal.BeginFetch(Of&nbsp; Groups)(callback)</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
