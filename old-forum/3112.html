<html><header><title>MUST READ if you're using databinding with the winform DataGridView</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>MUST READ if you're using databinding with the winform DataGridView</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3112.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Cslah posted on Thursday, June 28, 2007</h2><P>Yesterday I wrote about performance problems with databinding and after tearing out what little hair I have left, I FINALLY figured out what the problem was.<BR><BR>Thanks to an article on msdn:<BR><A href="http://msdn2.microsoft.com/en-us/library/ha5xt0d9.aspx">http://msdn2.microsoft.com/en-us/library/ha5xt0d9.aspx</A><BR><BR>The number one performance trick on this page says to avoid using formatting at the cell level (i.e., going into the column&nbsp;properties on the grid and setting it to C to format the number for currency). This includes setting the numeric formatting, which I've done on most of my cells. To remove the formatting you have to actually remove the column and re-add it. When you set formatting it makes a new instance of the default cell style to use. So, I've got 9 columns with 'other than default' settings. Once I removed the formatting.... waahhla!</P>
<P>They also recommend trapping the cell formatting event, which I did. I noticed that the event is fired constantly during load, so I added the “if _loading = true then exit sub” trick to only have it fire after everything else is done. This helped a little.<BR><BR>Another biggie for me was that I had ‘autoresizecolumns’ set. I set it to none, then made a single call to MyDatagrid.AutoResizeColumns(DisplayedOnly).<BR><BR>My grid loads in a mere 2 seconds, instead of 30, including fetching the collection with about 2000 items!!! I love that it’s faster and I never dreamed it would be this fast.<BR><BR>I hope this helps someone out. I've spent no less than 8 hours on this one item. Sometimes fixing a bug like this is so satisfying. :-)<o:p></o:p></P>
<P>Brian<o:p><FONT face=Tahoma size=2>&nbsp;</FONT></o:p></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ozitraveller replied on Thursday, June 28, 2007</h2>Nice find. Thanks</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dezeeuw replied on Thursday, July 05, 2007</h2><P>I am just beginning with CSLA, so this might be a really stupid question.&nbsp; How do you format the cell to show just a date with a datetime field if you cannot use the column properties for formatting?</P>
<P>Rick</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>triplea replied on Thursday, July 05, 2007</h2>What about adding a property on your object that returns a string which would be the date in any format you require? I always find this easier than formatting cells manually, though it might add a lot of excess properties.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Cslah replied on Monday, July 09, 2007</h2><P>internally within your library you should declare all of your datatime types as SmartDate. The property from your library, however, returns a string for the date. In your get you return: return _smartDate.Text. You can see the ProjectTracker for example library props.</P>
<P>If the date doesn't have a value then your datagrid will show a blank string. Also, you won't need to format anything on the grid. If you&nbsp;want to show time or something in addition to the date then add another property in your library. This is much much easier than trying to get the datagrid to format it. Besides, you'll probably want to use it somewhere else in your app if you're using it here.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
