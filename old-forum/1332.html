<html><header><title>is it possible to pass an object to the bo's save method </title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>is it possible to pass an object to the bo's save method </h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1332.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dstarkey posted on Tuesday, September 26, 2006</h2><P>for example, i would like to implement something like the following.&nbsp; But get the error no overridable method exists and I do not know how to implement this logic.&nbsp; The role object need to be passed to the CanAdd and CanEdit.&nbsp; This works when using the CanGet because I pass in the object as part of the static method.</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>override</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>EmployeeEM</FONT><FONT size=2> Save(Role rl)</P>
<P>{</P>
<P></FONT><FONT color=#008000 size=2>// origEmp is used to call pending changes with only props that have changed.</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (!IsNew) </FONT><FONT color=#008000 size=2>// only retrieve this original if the record exists ! </P></FONT><FONT size=2>
<P>origEmp = </FONT><FONT color=#008080 size=2>EmployeeEM</FONT><FONT size=2>.GetEmployeeByEmpno(</FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.LocNo, </FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.EmpNo);</P>
<P></FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (IsNew &amp;&amp; !CanAddObject(rl))</P>
<P></FONT><FONT color=#0000ff size=2>throw</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> System.Security.</FONT><FONT color=#008080 size=2>SecurityException</FONT><FONT size=2>(</P>
<P></FONT><FONT color=#800000 size=2>"User not authorized to add an Employee Record!"</FONT><FONT size=2>);</P>
<P></FONT><FONT color=#0000ff size=2>else</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (!CanEditObject(rl))</P>
<P></FONT><FONT color=#0000ff size=2>throw</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> System.Security.</FONT><FONT color=#008080 size=2>SecurityException</FONT><FONT size=2>(</P>
<P></FONT><FONT color=#800000 size=2>"User not authorized to update an Employee Record!"</FONT><FONT size=2>);</P>
<P></FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>base</FONT><FONT size=2>.Save();</P>
<P>}</P>
<P>thanks for your help, stuck on this.</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, September 26, 2006</h2>I think if you change override to new you'll get the behavior your want.&nbsp; I don't think its a good idea though.<br><br>Why are you passing a role into the save method?&nbsp; Seems an odd thing to do..<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dstarkey replied on Tuesday, September 26, 2006</h2><P>I am doing it in order to make my bo's more efficient.&nbsp; It just so happens that the application I am working on would have over 30000 roles, a userID, and the Location and Division which would grant that user access to the site.&nbsp; Rather than hard code each role, or even populate this section I pass in the role requested through the role object.&nbsp; for example: userId 38322, location 8765 division 1.&nbsp; Since the userId roles was populated in the identity object in the same format I can simply send the userId, and the requested location and division and compare them to the allowed roles maintained in the identity object.&nbsp; I knew of know other way to do this.&nbsp; This way instead of 30000 entries in each "Canxxxx" method, I have very few.&nbsp; for example: </P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>static</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>bool</FONT><FONT size=2> CanAddObject(</FONT><FONT color=#008080 size=2>Role</FONT><FONT size=2> rl)</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>bool</FONT><FONT size=2> result = </FONT><FONT color=#0000ff size=2>false</FONT><FONT size=2>;</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (Csla.</FONT><FONT color=#008080 size=2>ApplicationContext</FONT><FONT size=2>.User.IsInRole(rl.RockyRole + </FONT><FONT color=#800000 size=2>":Worksite Manager"</FONT><FONT size=2>))<BR>result = </FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>;</P>
<P></FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (Csla.</FONT><FONT color=#008080 size=2>ApplicationContext</FONT><FONT size=2>.User.IsInRole(rl.RockyRole + </FONT><FONT color=#800000 size=2>":Internal Employee"</FONT><FONT size=2>))<BR>result = </FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>;</P>
<P></FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> result;</P>
<P>}</P>
<P>I know it could be improved, but couldnt figure out a different solution.&nbsp; Then I had to&nbsp;figure out a way to make the role available through the insert and save methods.&nbsp; Once again, I had a difficult time with this, and finally made an extra property called currentRole (which i set in the ui, just before the update) and am able to check this property from within&nbsp; the bo.&nbsp; Any suggestions or alternate solutions are greatly appreciated.</P>
<P>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, September 26, 2006</h2>Yikes..<br><br>Hmm... is it possible to create your own principal class and perhaps implement the build of the exact role name in the IsInRole method?<br><br>It seems to me that the logic for determining the role name should be encapsulated in a class, which would free you of having to pass around a role class.&nbsp; Perhaps this class can collaborate with your custom principal object as well.<br><br>I really recommend thinking about how you could do that... because these kinds of changes will also leave you with some pain down the line, making it harder to keep current with the newest versions of Csla, if that is something you think you would like to do.<br><br>Andy<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
