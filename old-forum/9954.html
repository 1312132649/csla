<html><header><title>CSLA 3 to 4: Properties with private backing fields must be marked as RelationshipTypes.PrivateField</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA 3 to 4: Properties with private backing fields must be marked as RelationshipTypes.PrivateField</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9954.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>JJLoubser posted on Wednesday, January 19, 2011</h2><p>error:</p>
<p>Properties with private backing fields must be marked as RelationshipTypes.PrivateField</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>this work in Silverlight 3 CSLA 3, but not in Siliverlight 4 CSLA 4:</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>public bool _loadingProvinceNVL = false;<br />private static PropertyInfo&lt;ProvinceNVL&gt; ProvinceListProperty = RegisterProperty&lt;ProvinceNVL&gt;(c =&gt; c.ProvinceList);<br />[NonSerialized]<br />private ProvinceNVL _provinceList = ProvinceListProperty.DefaultValue;<br />public ProvinceNVL ProvinceList<br />{<br />&nbsp;&nbsp;&nbsp; get<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!_loadingProvinceNVL &amp;&amp; (!FieldManager.FieldExists(ProvinceListProperty) || ReadProperty(ProvinceListProperty) == null))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />#if SILVERLIGHT<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _loadingProvinceNVL = true;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ProvinceNVL.GetProvinceNVL((o, e) =&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _provinceList = e.Object;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OnPropertyChanged(ProvinceListProperty.Name);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _loadingProvinceNVL = false;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; );<br />#else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _provinceList = ProvinceNVL.GetProvinceNVL();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //LoadProperty(ProvinceListProperty, ProvinceNVL.GetProvinceNVL());<br />#endif<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return GetProperty(ProvinceListProperty, _provinceList);<br />&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<br />&nbsp; }<br />}</p>
<p>&nbsp;</p>
<p>how do I mark it as RelationshipTypes.PrivateField?</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JJLoubser replied on Wednesday, January 19, 2011</h2><p>like this:</p>
<p>&nbsp;</p>
<p>public bool _loadingProvinceNVL = false;<br />private static PropertyInfo&lt;ProvinceNVL&gt; ProvinceListProperty = RegisterProperty&lt;ProvinceNVL&gt;(c =&gt; c.ProvinceList, &quot;ProvinceList&quot;, RelationshipTypes.PrivateField);<br />[NonSerialized]<br />private ProvinceNVL _provinceList = ProvinceListProperty.DefaultValue;<br />public ProvinceNVL ProvinceList<br />{<br />&nbsp;&nbsp;&nbsp; get<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!_loadingProvinceNVL &amp;&amp; (!FieldManager.FieldExists(ProvinceListProperty) || ReadProperty(ProvinceListProperty) == null))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />#if SILVERLIGHT<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _loadingProvinceNVL = true;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ProvinceNVL.GetProvinceNVL((o, e) =&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _provinceList = e.Object;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OnPropertyChanged(ProvinceListProperty.Name);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _loadingProvinceNVL = false;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; );<br />#else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _provinceList = ProvinceNVL.GetProvinceNVL();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //LoadProperty(ProvinceListProperty, ProvinceNVL.GetProvinceNVL());<br />#endif<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return GetProperty(ProvinceListProperty, _provinceList);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp; }<br />}</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>bniemyjski replied on Wednesday, January 19, 2011</h2><p>
<p>Hello,</p>
<p>I wouldn&#39;t recommend using a private backing field with Silverlight and I would never recommend using a private backing field with collection or child business objects!</p>
<p>Thanks</p>
<p>-Blake Niemyjski</p>
</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JJLoubser replied on Wednesday, January 19, 2011</h2><p>why? it is working fine, we had memory problems in Silverlight 3 CSLA 3, but did not check for Silverlight 4 CSLA 4, it runs smooth so far.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, January 20, 2011</h2><p>If you need to use the NonSerialized or NotUndoable attributes then you must create a private backing field. </p>
<p>But that would be the only reasons (IMO) to use a private backing field. </p>
<p>Private backing fields as part of the BO graph will require additional code for Serialize and OnDeserialized.<br />Your sample code works fine as the property is a lazy loaded NVL.</p>
<p>ManagedProperties is the preferred and recommended property type.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
