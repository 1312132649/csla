<html><header><title>Table Selection Parameter</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Table Selection Parameter</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6239.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>TheSquirrelKing posted on Thursday, January 22, 2009</h2><P>So I've got this slightly unusual situation where most of my stored procedures require a parameter (@TableName) to determine which of 3 identically-structured tables in our DB to use. The sprocs are setup this way to avoid having to create triplicates for each table. This is especially important for us because the number of tables is very likely to change in the future. So far the sprocs themselves work great (using sp_executesql gave a nice boost to efficiency by allowing execution plan reuse), but I have been running the app with the TableName parameter hard-coded in the DataPortal methods like so:</P>
<BLOCKQUOTE dir=ltr>
<P>&nbsp;Private Overloads Sub DataPortal_Fetch(ByVal criteria As RootCriteria)<BR>&nbsp;&nbsp;Dim db As Database = DatabaseFactory.CreateDatabase()<BR>&nbsp;&nbsp;Dim dbCommand As DbCommand = db.GetStoredProcCommand("GetDataPointById")</P>
<P dir=ltr>&nbsp;&nbsp;db.AddInParameter(dbCommand, "@TableName", DbType.String, "TableNameHere")<BR>&nbsp;&nbsp;db.AddInParameter(dbCommand, "@Id", DbType.Guid, criteria.Id)</P>
<P dir=ltr>&nbsp;&nbsp;Using dataReader As SafeDataReader = New SafeDataReader(db.ExecuteReader(dbCommand))<BR>&nbsp;&nbsp;&nbsp;While dataReader.Read()<BR>&nbsp;&nbsp;&nbsp;&nbsp;DoFetch(dataReader)<BR>&nbsp;&nbsp;&nbsp;End While<BR>&nbsp;&nbsp;End Using<BR>&nbsp;End Sub</P></BLOCKQUOTE>
<P dir=ltr>So now I am trying to discover the best way to pass the selected TableName parameter from the user (be it from the GUI or in my unit test config) to the DataPortal methods given that these methods would not have access to application variables or app.config settings that might be on another machine (depending on the tiers that are in use) and that DataPortal_Insert and DataPortal_Update don't take criteria objects. </P>
<P>Does anyone have any ideas or suggestions?</P>
<P>Thanks,<BR>TSK</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Curelom replied on Thursday, January 22, 2009</h2>depending on your business logic, you could derive which tablename to use via the properties of the object itself.&nbsp; If these are not sufficient, you could add another property/variable specifically for this case.&nbsp; This probably isn't as clean as you would like it, but it should work.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TheSquirrelKing replied on Thursday, January 22, 2009</h2><P>Yeah, I was thinking that I could pass the parameter in with the criteria class for the Create/Fetch methods, set a private helper variable in the object itself, and then use that in the DP methods, but, as you point out, it's not as clean as I'd like it. That said, barring any other creative solutions, this is what I'm going to run with. </P>
<P>Thanks for the second opinion,<BR>TSK</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
