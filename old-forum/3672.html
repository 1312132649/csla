<html><header><title>Line item options</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Line item options</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3672.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Monday, October 08, 2007</h2>Hi,<br><br>I have my quoting application live finally, and the user's are happy with it.&nbsp; There is one change though, and I'd like some feedback on best to implement this.<br><br>I have a few classes, which all inherit a common LineItem base class.&nbsp; In this specific request, a change to the behavior of the PackingFeeLineItem is needed to accomodate one customer.&nbsp; Now, I don't intend on having the class look at a particular customer and figure it out itself; instead, I want to give the users a way to switch a flag that affects its behavior.&nbsp; If the flag is not set, the PackingFeeLineItem will calcualte the fee as a percentage of the quote total, or $10, whichever is more.&nbsp; If the flag is set, the minium fee won't apply at all.&nbsp; <br><br>I'd like to handle this in such a way that I can add other similar options to arbitrary line items.&nbsp; My current thinking is that I will have a flag on LineItem which indicates if the item supports options at all, a method to enumerate the supported options (this will give the UI details such as what kind of values to allow, a description to display, a "key" which identifies the option, etc), and two more methods to get or set the value of the current option.<br><br>My thought is that this will allow me to enable other very specific options for line items in the future while keeping the UI dumb about what is actually going on.&nbsp; To this end, the UI only knows about an interface, ILineItem... the specific classes are internal to my busines layer only.&nbsp; <br><br>I believe this scheme will work... but I'd like some feedback on this.&nbsp; In the future, I may add support for changing the percentage discount on my DiscountLineItem via this API.. currently you need to delete the discount and add a new one... but thats not important right now.<br><br>Thanks<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, October 09, 2007</h2>I guess I'm right on track. <img src="/emoticons/emotion-5.gif" alt="Wink [;)]" /><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Tuesday, October 23, 2007</h2><P>In general, the approach makes sense to me.&nbsp; Having been down this route before (just not with OO languages to support me), there are some business issues to consider.</P>
<P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>Hi,<BR><BR>Now, I don't intend on having the class look at a particular customer and figure it out itself; instead, I want to give the users a way to switch a flag that affects its behavior.&nbsp; </div></BLOCKQUOTE></P>
<P>Here's an example:</P>
<P>I negotiate a special deal with management, that my minimum shipping fee is $5 instead of the normal $10.&nbsp; We put it into our contract.</P>
<P>You implement this as an option that the user chooses from when filling out the line item.</P>
<P>All the sales staff are told about the exception via an email&nbsp;memo or staff meeting.</P>
<P>A new guy joins the sales team and, of course, no one sends him last months email or remembers to tell them about the special rule for this customer.</P>
<P>He invoices them $10 instead of $5 for shipping on several orders.</P>
<P>Another clerk is "less than average in reliability".&nbsp; This might be because he's depressed, or hung-over, or just doesn't give a rat's behind about the quality of his work.&nbsp; So, in a boredom-induced stupor, he enters "the usual" $10 shipping fee for several more orders.</P>
<P>The customer notices that they are being charged $10 instead of $5 despite a contract to the contrary.</P>
<P>The important question is: </P>
<P><STRONG>How mad will the customer get and how much money might it cost the company in lost sales?</STRONG></P>
<P>So, you might want to consider adding the ability to set a non-default choice at the customer level for these types of customizations.&nbsp;&nbsp;&nbsp; </P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jeff replied on Wednesday, October 24, 2007</h2><P>You could also implement a strategy pattern. ie. Define an interface such as IPackingFeeCalculator or maybe ILineItemTotalCalculator which would have a Calculate method of some kind. Then you&nbsp;create various implementations of the calculator such as PercentageOfQuoteTotalCalculator or MinimumFeeCalculator. Use some sort of "dependancy injection" to give the LineItem&nbsp;class the appropriate implementation either through the constructor or by setting a property. Or you could create as needed in the LineItem class (less testable).</P>
<P>One side effect of this is improved testability&nbsp;since you would be able to mock the ILineItemTotalCalculator and thus test isolated behavior of the LineItem class without worrying about possible bugs with the calculator classes.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
