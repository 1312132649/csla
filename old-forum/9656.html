<html><header><title>WPF / Silverlight Library in 4.0</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>WPF / Silverlight Library in 4.0</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9656.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ChaseC posted on Tuesday, October 19, 2010</h2><p>Hi Rocky,</p>
<p>We are finally starting to rewrite our WinForms application and for various reasons the winner for the new interface is WPF.&nbsp; However, I&#39;d really like to make sure that we can create a Silverlight front-end as time permits down the road.</p>
<p>I understand that the ProjectTracker sample is out of date, so I was hoping I could get some general guidance setting up my projects.</p>
<p>I was thinking about just having a single Library project that points to the silverlight version of csla.dll.&nbsp; If I do that, would it significantly handicap the WPF version of my application?</p>
<p>Or would I be better off following the ProjectTracker sample by creating a duplicate Library.SL project that has shortcuts pointing to the original Library?&nbsp; Or is there a new approach with 4.0?</p>
<p>Any help is much appreciated.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ChaseC replied on Wednesday, October 20, 2010</h2><p>As a followup question, if I go with two projects (Library and Library.SL) does anyone know of an add-in that will keep the projects synced, so that if I add a file in Project A a link will automatically be created in Project B?</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Wednesday, October 20, 2010</h2><p>Though it is simple, the best sample right now is Samples\Net\cs\SimpleNTier - especially in 4.1 (only in svn right now). That contains a single, simple n-tier app that has WPF, Silverlight, ASP.NET MVC and WP7 interfaces.</p>
<p>There is a tool from the Microsoft Patterns and Practices group called Project Linker. Someone posted a few weeks ago that they&#39;ve upgraded it to VS10, and if so then it is what you are looking for in terms of automatically linking files from one project to another.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ChaseC replied on Thursday, October 21, 2010</h2><p>Looking at the samples, I&#39;m trying to wrap my head around the need for the !SILVERLIGHT pre-compiler statements. I guess i just dont know enough about the limitations of Silverlight.&nbsp; Would the Silverlight for 3.8 videos help me out with that, or would i be better off waiting for newer videos at this point?&nbsp; I already have the MVVM videos.</p>
<p>Also, I&#39;m assuming you could point a WPF UI to a Silverlight business layer.&nbsp; What is the compelling reason not to do that (i.e., have a single Library that is dumbed down for SL)?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, October 21, 2010</h2><p>There are certain features that just don&#39;t exist on SL, such as synchronous data portal calls. So if you want to have sync factory methods in your classes, you need to prevent them from compiling on SL - which is the reason for the #if !SILVERLIGHT blocks.</p>
<p>For my part, I usually build my WPF UIs to be async too, so if my only UI targets are WPF and SL I won&#39;t even implement sync factory methods. But if my types are going to be used in ASP.NET MVC (for example), then the sync factories are important.</p>
<p>Right now Csla.dll compiles differently for .NET, SL and WP7. I thought about trying to come up with a &quot;core of CSLA&quot; that could be common across .NET and SL, but that is really challenging.</p>
<p>For example, in .NET I use the new .NET 4 threading features for certain things because having the best possible implementations is really important in a multi-user, multi-threaded server environment. SL4 doesn&#39;t even have those features, so the SL codebase uses my own implementation. And that implementation is fine, but I am pretty confident that the new threading stuff in .NET 4 is better. If I&#39;d created a common Csla.dll I&#39;d be entirely limited to SL functionality, and couldn&#39;t use the .NET 4 features.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ChaseC replied on Thursday, October 21, 2010</h2><p>Thanks for the explanation.&nbsp; It makes more sense now.&nbsp; Compiling two versions of the Library isn&#39;t a big issue, but unless I&#39;m missing something I&#39;d also have to create two versions of every project that references my business library.&nbsp; </p>
<p>For example, we currently have a Common.UI.Controls project that is referenced by two different WinForms applications. It sounds like I&#39;d have to create a Common.UI.Controls.SL if I keep the current solution structure. Or better yet, rework the controls so that they don&#39;t reference the business objects directly.</p>
<p>Anyway, something to keep in mind.&nbsp; Thanks again for your time.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, October 21, 2010</h2><p>I&#39;m not sure what you mean by two versions of every project?</p>
<p>Typically my SL solutions, often with some web or service components on the server, look like this:</p>
<ul>
<li>Library.Net (.NET)</li>
<li>Library.Sl (SL)</li>
<li>SilverlightUI (SL)</li>
<li>WebUI (.NET)</li>
<li>AppServer (.NET)</li>
<li>DataLayer (.NET)</li>
</ul>
<p>Of all that, only the Library.Net and Library.Sl share their files. All the other projects are unique to a specific platform.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ChaseC replied on Thursday, October 21, 2010</h2><p>Our current solution is broken up more is all.&nbsp; We have one UI project for our end-user application, another UI project for a separate administration application, a project for shared UI controls, and finally a project with all of our DevXpress reports in it.&nbsp;&nbsp; Since they all reference the business objects, I would have to create two versions (one referencing the WPF library and another referencing the SL library) for each project IF I kept the same structure, right?</p>
<p>So I&#39;ll probably just restructure things a bit for the rewrite.&nbsp; For the record, I inherited the current structure =)</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ChaseC replied on Tuesday, October 26, 2010</h2><p>Sorry to dig this back up, but I&#39;m really confusing myself over here.&nbsp; </p>
<p>If we decide to go silverlight completely and will never (for the sake of argument&#39;) use another
 UI , what kind of project should my dataportal be and which 
version of csla.dll should it reference?</p>
<p>When I create a .NET dataportal referencing &quot;server/csla.dll&quot; and my Library.SL project, there&#39;s a warning icon in my reference list.</p>
<p>I&#39;d really prefer not to have two library projects if possible.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, October 26, 2010</h2><p>The data portal has to be hosted somewhere - IIS/ASP.NET, Windows Server AppFabric, WAS or a custom Windows service. This is true for all scenarios where you do 3- or 4-tier deployments.</p>
<p>The data portal has two possible endpoints - .NET and Silverlight. And your data portal can have <i>both</i> - they are just different svc files.</p>
<p>In all cases, the data portal is running in .NET of course, so it uses the .NET assemblies. </p>
<p>There is no Silverlight data portal host - I&#39;m rather skeptical that you could do that even if you wanted to.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
