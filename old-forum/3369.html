<html><header><title>isDirty in BusinessListBase</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>isDirty in BusinessListBase</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3369.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ballistic posted on Monday, August 13, 2007</h2><P>Have a class which lists tags for a member:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> MemberTagList<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp; Inherits</FONT><FONT size=2> BusinessListBase(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> MemberTagList, MemberTag)</P>
<P></FONT>This class has a function (TextToList) which will parse a comma seperated string and for each "tag" add it to the list. This function&nbsp;ONLY gets called if the current Member's tags are different from what they entered.</P>
<P>The IsDirty property on the list is being set correctly when I have new item to add to the list.&nbsp; However, if no items are set, I still need the list to be dirty. (For instance they had tags in their account, but are now removing them)</P>
<P>How can I force TextToList to set the IsDirty flag to true?</P>
<P>This is how I'm using it:<FONT size=2></P>
<P></FONT><FONT color=#0000ff size=2>Set</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> TagListText </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>)<BR>&nbsp;&nbsp;&nbsp;&nbsp; CanWriteProperty(</FONT><FONT color=#0000ff size=2>True</FONT><FONT size=2>)<BR>&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> (BioTagsText &lt;&gt; TagListText) </FONT><FONT color=#0000ff size=2>Then<BR></FONT><FONT size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _BioTags = Tags.MemberTagList.TextToList(_Id, TagListText)&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>PropertyHasChanged()<BR>&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Set</P></FONT>
<P>Then in the update, I check to see if the list is dirty:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> (_BioTags.IsDirty) </FONT><FONT color=#0000ff size=2>Then<BR></FONT><FONT size=2>&nbsp;&nbsp;&nbsp;Tags.MemberTagList.UpdateToDB(_Id, _BioTags)<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>juddaman replied on Friday, August 17, 2007</h2>Hi<br><br>If you call MarkDirty() in the ctor of <font size="2">MemberTagList then new lists will always be dirty. So even if </font><font size="2">TextToList(x,y) returns a new empty list then IsDirty will return true. The ctor may not be the best place to call MarkDirty() but it should work for now as long as you are calling MarkOld() after your fetch and updates as you are probably already doing.<br><br>Regards<br><br>George<br></font></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
