<html><header><title>Undo not propagated to child objects if _bindingEdit true? (CSLA 3.0.4)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Undo not propagated to child objects if _bindingEdit true? (CSLA 3.0.4)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5554.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 posted on Wednesday, October 08, 2008</h2><P>This is a ERLB with parallel editing form use case. I've found that when I call UndoChanges() on a root object, the child objects don't get undone. </P>
<P>Here is the code that is skipping the undo in UndoChanges(). As a result, I have a "partially undone" object at this point and changes to the child (a BLB in this case) cannot be undone. </P>
<P>Since the grid is managing the editing, I'm not doing my own BeginEdit/ApplyEdit in this case. So, the result is that Undo seems to be working fine for fields but not child lists. </P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>if</FONT></FONT><FONT size=2> (!_bindingEdit)</P>
<P>((Core.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>IUndoableObject</FONT></FONT><FONT size=2>)value).UndoChanges(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT><FONT size=2>.EditLevel);</FONT></P>
<P><FONT size=2>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, October 08, 2008</h2><P>You know, I can hardly wait until Windows Forms is entirely replaced by WPF. The idiosyncracies involved in WinForms data binding are ridiculous.</P>
<P>I don't know the answer to your issue right off, and won't have time to research it in the near future.</P>
<P>It is true that somewhere in the past few versions (3.0 I think) CSLA changed to match the DataTable in terms of how it does or doesn't cascade undo operations from data binding. This was necessary because Windows Forms specifically expects DataTable behaviors - which means no cascading. This may have caused your issue, but it solved a TON of common issues faced (knowingly or unknowingly) by everyone using WinForms.</P>
<P>Whether it is possible, or even desirable, to special-case ERLB is questionable and would take serious research.</P>
<P>I'll be honest, ERLB was never designed to support a row that contains an object graph. It was designed to support a row that contains a single object. So it doesn't entirely surprise me that there are issues cropping up when each row is an entire object graph, because that's outside of the design parameters I considered.</P>
<P>All I can offer at this point is to put this thread into the wish list and perhaps look into it in a few months when I get a chance.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Thursday, October 09, 2008</h2><P>Can you point me to a use case in ProjectTracker that actually utilizes "not" cascading so I can study it? I'm just trying to understand why this makes sense. </P>
<P>(Incidentally, if the child object didn't actually exist in the previous state, then the current implementation WILL "cascade" the undo to the child by removing it :)</P>
<P>Meanwhile, I'll either have to add a "CascadeUndo" switch or forgo IEditableObject entirely...</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, October 09, 2008</h2>






 





<div class=Section1>

<p class=MsoNormal><span>ProjectTracker doesn&#8217;t actually use ERLB.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>ERLB is designed for one very narrow and specific scenario:
retrieving a list of objects that are edited in-place within a DataGrid or
similar control, where changes made to that row are committed when the user
moves off that row.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>Anything outside that narrow and specific scenario is out of the
scope for the ERLB design. So if something outside that scope works then we can
celebrate, and if it doesn&#8217;t work that&#8217;s to be expected.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>Rocky</span><b><span><o:p></o:p></span></b></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

</div>



</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, October 09, 2008</h2>






 





<div class=Section1>

<p class=MsoNormal><span>Btw, I don&#8217;t mean to come across as harsh on this thread. I&#8217;m
doling out bits of time between revising chapters and traveling 5 out of 6
weeks and pretending I have a family (ha!), so I really have little time to
help or focus on stuff that&#8217;s not in the 2008 book or part of my
conference sessions. Windows Forms is not part of any of that (except briefly
in Chapter 10) and is really way outside my sphere of focus right now.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>So I mean to be firm, not offensive or harsh. ERLB really is
designed for that very narrow and specific scenario. You are outside that
scenario. It doesn&#8217;t surprise me that you are having issues. They may not
be solvable within the context of ERLB. <o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>You may need to create your own base class &#8211; and I&#8217;m
not entirely sure that would even be possible given the constraints of WinForms
data binding. Those constraints are what they are, and they aren&#8217;t
designed with the flexibility of objects in mind &#8211; they are design with
the DataTable in mind.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>You may need to consider disabling IEditableObject. Basically
abandon the confines of data binding and handle UI events yourself to force the
object graph to behave as desired. I suspect this may be the only realistic
solution to your problem.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>A given object can not be bound to more than one bindingsource.
The bindingsource/data binding infrastructure just doesn&#8217;t support that
(not a CSLA thing &#8211; a data binding thing). But what you are doing almost
certainly involves an object being bound to more than one bindingsource (or
equivalent) &#8211; which is why I say that you may have to entirely abandon
data binding to meet your scenario&#8217;s requirements.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>Rocky</span><o:p></o:p></p>

</div>



</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Thursday, October 09, 2008</h2><P>^^^</P>
<P>No offense taken, and&nbsp;you got me moving in a better direction.&nbsp; I know you are busy so I appreciate your responding to my questions. </P>
<P>I'm experimenting with turning off IEditableObject and it's working very well so far. I've had to implement an "object broker" for lack of a better term that keeps track of the current object being edited in various grids and emulates ERLB behavior by saving the object being tracked anytime the corresponding BindingSource.CurrentChanged event is fired. </P>
<P>If anyone else has any input into potential pitfalls into doing your own BeginEdit/ApplyEdit/CancelEdit processing versus letting the bindings do it automatically via IEditableObject, I'd certainly be interes</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
