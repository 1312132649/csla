<html><header><title>LinqBindingList NEWB question</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>LinqBindingList NEWB question</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6975.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>DCottle posted on Wednesday, May 20, 2009</h2><P>I have read chapter 14 on the LinqBindingList object, but I am failing to get it instantiated correctly.</P>
<P>&nbsp;</P>
<P>Can somebody please give me a sample of code&nbsp;(including&nbsp;using statements)&nbsp;where the LBL is created using a linq query with a BusinessListBase collection?</P>
<P>I have tried this:</P>
<P>using Csla.Linq;</P><FONT size=2>
<P>Csla.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>LinqBindingList</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>INote</FONT></FONT><FONT size=2>&gt; filteredList = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>from</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>INote</FONT></FONT><FONT size=2> item </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>in</FONT></FONT><FONT size=2> _notesCollection </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>select</FONT></FONT><FONT size=2> item;</FONT></P>
<P><FONT size=2>But I keep getting a couple of errors on that: </FONT></P><FONT size=2><FONT size=2>
<P>Error&nbsp;1&nbsp;'Notes.INotes' does not contain a definition for 'Cast' and the best extension method overload 'System.Data.EnumerableRowCollectionExtensions.Cast&lt;TResult&gt;(System.Data.EnumerableRowCollection)' </P>
<P>Error&nbsp;2&nbsp;Instance argument: cannot convert from 'Notes.INotes' to 'System.Data.EnumerableRowCollection'&nbsp;</P>
<P>MORE DETAILS:</P>
<P>In this example I removed the reference to System.Linq, because with the System.Linq reference I kept getting back a System.Linq.Enum erableQuery...and I cannot figure out how to cast it to a LBL or get back an LBL automatically like people are implying here with the code being posted.</P>
<P>Thanks,</P>
<P>David</FONT></FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, May 20, 2009</h2>Did you review this thread?<br />http://forums.lhotka.net/forums/thread/31891.aspx<br /><br />Also try this syntax:<br /><br />  Dim sortedList As Csla.LinqBindingList(Of MyBO)<br /><br />        Dim query As System.Linq.IOrderedQueryable(Of MyBO) = From x In mMyColl Order By x.Line Ascending, x.Code Descending<br />        sortedList = CType(query, Csla.LinqBindingList(Of MyBO))<br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DCottle replied on Wednesday, May 20, 2009</h2><P>I reviewed that thread in depth, and also tried the C# version of your syntax above (I did not have a order by statement, so the return type of the linq statement i changed to IEnumerable...I couldn't get the IOrderedQueryable to work either though):</P><FONT size=2>
<P>Csla.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>LinqBindingList</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>TransactionNote</FONT></FONT><FONT size=2>&gt; sortedList;</P>
<P>System.Collections.Generic.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>IEnumerable</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>TransactionNote</FONT></FONT><FONT size=2>&gt; query = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>from</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>TransactionNote</FONT></FONT><FONT size=2> item </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>in</FONT></FONT><FONT size=2> _notesCollection </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2><STRONG>select</STRONG></FONT></FONT><FONT size=2><STRONG> item</STRONG>;&nbsp; <FONT color=#ff0000>//notice,&nbsp; i cannot for some reason remove the "select item"...the compiler requires it.</FONT></P>
<P>sortedList = (Csla.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>LinqBindingList</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>TransactionNote</FONT></FONT><FONT size=2>&gt;)query;&nbsp; <FONT color=#ff0000>//error on this line</FONT></P></FONT>
<P>Unable to cast object of type 'WhereSelectEnumerableIterator`2[Notes.TransactionNote,Notes.TransactionNote]' to type 'Csla.LinqBindingList`1[Notes.TransactionNote]'.</P>
<P>&nbsp;</P>
<P>any thoughts?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AaronErickson replied on Thursday, May 21, 2009</h2>Out of curiosity (and so I can help - lol)...<br /><br />what is _notesCollection a type of?<br /><br />should I assume it is something that derives from BLB?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DCottle replied on Thursday, May 21, 2009</h2><P>It is of type BLB.&nbsp; I actually got this to work, but I had to change some of my internals to make it work.</P>
<P>&nbsp;</P>
<P>Basically, I had several collections of objects that were implementing the same interfaces (INotes, and INote).&nbsp; If I try to return a LinqBindingList&lt;INote&gt; collection, it fails.&nbsp; I guess it considers the cast to its interface to be some sort of transformation so the result is no longer an identity projection.&nbsp; There is more code I could include, but hopefully this gets across my trouble.</P>
<P><FONT color=#ff0000>This works</FONT>:&nbsp; (sorry about double spaced lines.&nbsp; how do you get rid of those?)</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>class</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>GenericNotes</FONT></FONT><FONT size=2> : </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>BusinessListBase</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>GenericNotes</FONT></FONT><FONT size=2>, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>GenericNote</FONT></FONT><FONT size=2>&gt;, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>INotes</P></FONT></FONT><FONT size=2>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2><STRONG>object</STRONG></FONT></FONT><FONT size=2> GetFilteredNotes(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2> NoteType)</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>return<FONT color=#000000 size=2>&nbsp;</FONT></FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>from</FONT></FONT><FONT size=2> c </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>in</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>where</FONT></FONT><FONT size=2> c.NoteType == NoteType</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>select</FONT></FONT><FONT size=2> c; <FONT color=#008000 size=2><FONT color=#008000 size=2>//this actually returns a LinqBindingList&lt;GenericNote&gt; collection</FONT></FONT></FONT></P>
<P><FONT size=2>}</P>
<P><FONT color=#ff0000 size=3>This does not work:</FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>class</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>GenericNotes</FONT></FONT><FONT size=2> : </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>BusinessListBase</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>GenericNotes</FONT></FONT><FONT size=2>, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>GenericNote</FONT></FONT><FONT size=2>&gt;, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>INotes</P></FONT></FONT><FONT size=2>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2><STRONG><FONT color=#2b91af>LinqBindingList</FONT><FONT color=#000000 size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>INote</FONT></FONT><FONT color=#000000 size=2>&gt;)</FONT></STRONG></FONT></FONT><FONT size=2>GetFilteredNotes(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2> NoteType)</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>var</FONT></FONT><FONT size=2> foo = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>from</FONT></FONT><FONT size=2> <STRONG>INote</STRONG> c </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>in</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>where</FONT></FONT><FONT size=2> c.NoteType == NoteType</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>select</FONT></FONT><FONT size=2> c;</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>return</FONT></FONT><FONT size=2> (</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>LinqBindingList</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2><STRONG>INote</STRONG></FONT></FONT><FONT size=2>&gt;)foo;</P>
<P>}</P></FONT>
<P><FONT color=#ff0000></FONT>&nbsp;</P>
<P><FONT color=#ff0000></FONT>&nbsp;</P></FONT>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AaronErickson replied on Thursday, May 21, 2009</h2>Ok - thanks for the clarification.<br /><br />The latter case will certainly not work - nor am I sure even how it would.<br /><br />One of the things a LBL will do is maintain a mapping from the destination to the original BLB it came from.  In order to effectivley do the mapping, it has to deal with objects of the same type (i.e. when you add to the LBL, for example, it will also add to the BLB it came from).<br /><br />Just thinking this through, if you have an LBL of I, which an interface T implements, but also U implements, how do I know how I can add that item to the BLB it came from?<br /><br />There might be an answer to that that I need to think through more, but I can assure that such functionality is well beyond the scope of how we have designed this subsystem to date.<br /><br />As of now, we support LBL where you get back an LBL with the same child types that your BLB contains.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
