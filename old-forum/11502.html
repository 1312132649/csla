<html><header><title>PropertyStatus + TabControl + Switch Tabs = NullReferenceException</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>PropertyStatus + TabControl + Switch Tabs = NullReferenceException</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11502.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dagware posted on Monday, July 23, 2012</h2><p>I&#39;m using CSLA 4.3.13. I&#39;m still relatively new to WPF and MVVM, so I could be doing somerthing wrong.</p>
<p>Anyway, I have a TabControl whose ContentControl is a UserControl. Within the UserControl I have an ItemsControl. The items have various controls that have PropertyStatus controls next to them. The PropertyStatus conttrols work fine. But if I switch to a different tab, I get a NullReferenceException, somewhere untraceable. If I take the PropertyStatus controls out, the exception goes away.</p>
<p>Has anyone else experienced this before? Anyone got any idea how to fix it? Of course I could just roll my own, but there&#39;s no guarantees I might not come up with the same problem, so I thought I&#39;d ask.</p>
<p>Dan</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Monday, July 23, 2012</h2><p>Are you able to reproduce the bahavior in a small sample project? &nbsp; As that would be a good starting pointo the verify/debug PropertyStatus.</p>
<p>I did several bugfixes last year on PropertyStatus and tabs is a PITA. Tabs do NOT load controls for all pages - rather loads when required and this means that the &quot;invisible&quot;, nonvisited tab pages (read controls) are not in the VisualTree.&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dagware replied on Tuesday, July 24, 2012</h2><p>Thanks for the reply. No, I haven&#39;t tried to narrow it down to a simple solution. My guess was that it was related to exactly what you mentioned about TabControls and the visual tree. I was hoping someone knew of a quick fix, but otherwise, I didn&#39;t want to get bogged down debugging this. I&#39;m so far behind on this project as it is, because I&#39;ve been side-tracked by so many issues, and I promised myself not to let it happen again. :) We&#39;ll see how that goes.</p>
<p>With respect to your experiences with TabControls, I&#39;d like to ask you a question. Not only do I have this PropertyStatus issue, but other oddities keep cropping up when switching from one tab to another. I&#39;m beginning to wonder if I should scrap the TabControl and roll my own. For instance, I could have each tab page be some sort of container that all end up in the same grid cell, then collapsing all containers except the active one, etc. This would probably require some codebehind, but it&#39;s for a good cause. Do you think this would be a good idea? I&#39;m worried I might end up wasting more precious time with these kinds of TabControl issues.</p>
<p>I&#39;d love to hear your opinion on this. Thanks.</p>
<p>Dan</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>dagware replied on Tuesday, July 24, 2012</h2><p>I found a good workaround. I&#39;m using an attached behavior from <a href="http://www.codeproject.com/Articles/362940/Persist-the-Visual-Tree-when-switching-tabs-in-the">http://www.codeproject.com/Articles/362940/Persist-the-Visual-Tree-when-switching-tabs-in-the</a>. It persists the visual tree for each tab item, and eliminates the exception. It also appears to fix the other little issues I was having.</p>
<p>Dan</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>richardb replied on Thursday, July 26, 2012</h2><p>Your workaround is indeed the sort of thing you need to do.&nbsp; We had exact same problem with a Infragistics tab control which inherits from the MS one.</p>
<p>WPF&nbsp;loads controls into the visual tree when they appear on the screen (sometimes you might be able to force them), but this can cause binding and validation issues.&nbsp; It&#39;s done for performance reasons apparently.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dagware replied on Saturday, July 28, 2012</h2><p>&quot;Apparently&quot;. That made me smile!</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dagware replied on Saturday, July 28, 2012</h2><p>FYI, I finally had to give up on the PropertyStatus control within the TabControl. I came across another situation where it threw a NullReferenceException. This time, it happend while removing an item from an ItemsControl (in a TabControl). It would have been nice if the PropertyStatus control implemented the try/catch/forget pattern, like most other things that cause binding issues. But whatever. You can&#39;t have everything, I guess.</p>
<p>Dan</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Tuesday, July 24, 2012</h2><p>I&#39;ve experienced this with WinForms (not CSLA project).</p>
<p>I found that one thing I ended up doing in this project was to iterate through the collection of tabs, SetFocus on each (something like that) - to cause them to all generate their controls right at the beginning.&nbsp; This was quite a long time ago, but that&#39;s the sort of thing I ended up needing to do.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
