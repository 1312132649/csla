<html><header><title>Usefulness of CSLA in this scenario</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Usefulness of CSLA in this scenario</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8841.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>TSF posted on Monday, April 26, 2010</h2><p>I&#39;d like to know if CSLA would be a good fit for a project that I&#39;m preparing to work on based the folllowing scenario encountered in the project:&nbsp;&nbsp; I will have&nbsp;a .NET&nbsp;application that will need to allow for multiple instances to be open&nbsp;simultaneously (on a given desktop machine).&nbsp; There will also be one separate &quot;app&quot; that will act as a gateway to the multiple instances.&nbsp; Specifically, this separate &quot;app&quot; will contain an ActiveX control that receives messages from telephony software and needs to pass call information to one of the open&nbsp;instances (or open a new instance, if required).&nbsp; (Note that this messaging &quot;app&quot; is really part of the same overall application...it will not be utilized by anything other than these opened instances of the main MDI form.)</p>
<p>In other words:</p>
<ul>
<li>Form A - contains the ActiveX control and provides messages to every other app instance</li>
<li>Form B - one instance of the MDI app</li>
<li>Form C - another instance of the MDI app</li>
<li>Form n - etc</li>
</ul>
<p>I was beginning to read up on WCF to allow communication across app domains, but from my prior reading on CSLA I think I remember that this handles these types of things.&nbsp; Does this scenario sound like something for which CSLA would be a good framework?&nbsp; Thanks.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Monday, April 26, 2010</h2><p>CSLA doesn&#39;t address this type of messaging requirement, no. CSLA uses WCF to handle messaging (or other similar technologies).</p>
<p>CSLA may help with other aspects of the app (assuming you have a UI, its support for data binding is always useful), but it won&#39;t help the messaging.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TSF replied on Monday, April 26, 2010</h2><p>Thanks for the response.&nbsp; So whether I utilize CSLA or not, would your recommendation be to look into WCF to handle this kind of messaging?&nbsp; Or is there something else that I should be looking to?&nbsp; BTW - the app does have a UI.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, April 26, 2010</h2><p>There are probably several options, but using WCF with a named pipe channel is probably the most direct route. MSMQ is something I&#39;ve also used in the past, but that requires MSMQ be installed on the machine (which it isn&#39;t by default for client OSes like Win7).</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TSF replied on Monday, April 26, 2010</h2><p>Good question - I would like to do that and get away from this model (currently existing in a VB6 form - we&#39;re slowly starting to migrate small pieces to .NET using the Interop Forms Toolkit).&nbsp; The initial VB3(?) design of this app was done is such a way that the users launch separate instances of the MDI parent whenever they need to.&nbsp; Its an order entry application, and instead of having one parent form within which multiple child order entry forms could be launched, a new MDI parent form is launched each time they need to service a different customer.&nbsp; They might take a call from one customer, start taking down order info and then get a call from another customer.&nbsp; They&#39;ll minimize the first MDI parent (instance A) and launch another one (instance B)&nbsp;to work on so their first instance doesn&#39;t loose its state.&nbsp; Basically, the &quot;messaging&quot; app is where the call information comes in to, and it&nbsp;will give them the option to select/use one of their already-opened MDI parent instances if they want, or launch a new instance if they so choose.&nbsp; I&#39;d love to hear other ideas about how to deal with this (other than re-writing the entire app from scratch the right way...I&#39;d like to do that but it is a massive application and we simply can&#39;t do that right now).</p>
<p>The other aspect to this is that the ActiveX control that handles incoming call information shares state with all opened applications that utilize the control.&nbsp; So if all MDI instances have the ActiveX control on them, an event really intended for one of those instances gets raised on all of the instances.&nbsp; We have some work-arounds, but having one instance like a server/messaging app might (or not)&nbsp;minimize the complexity...that&#39;s what I&#39;m trying to decide - does having to deal with WCF increase the complexity in one way while minimizing it another way.&nbsp; Thoughts are welcome.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xAvailx replied on Thursday, May 06, 2010</h2><p>Take a look at a messaging framework. I&#39;ve used NServiceBus in similar scenario and it worked great.</p>
<p><a href="http://www.nservicebus.com/">http://www.nservicebus.com/</a></p>
<p>NServiceBus uses MSMQ.</p>
<p>There is also MassTransit</p>
<p><a href="http://code.google.com/p/masstransit/">http://code.google.com/p/masstransit/</a></p>
<p>HTH..</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
