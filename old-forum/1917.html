<html><header><title>Inheriting a subclassed base class that has children issues</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Inheriting a subclassed base class that has children issues</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1917.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tommybouy posted on Thursday, December 07, 2006</h2><P>I did read a thread that starting talking about a similar situation but it never really answered my question. </P>
<P>As per suggestions here and from Rocky, we have subclassed all of the base classes to create our own baseclasses that we inherit from. We have an Entity object that inherits from this and has child collections of addresses and contact numbers. We also have Classes for Customers, Employees and Vendors that inherit from Entity. One of the problems we encountered was in the child classes that are children of Entity. There are many places in the code where the parent is passed as a parameter but because we have declared the Entity&nbsp;class like this;&nbsp;&nbsp;<FONT color=#0000ff size=2></P>
<P>Partial</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>MustInherit</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> Entity(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Entity(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T))</FONT></P><FONT color=#0000ff size=2>
<P>&nbsp;&nbsp;&nbsp;Inherits</FONT><FONT size=2> ACSBusinessBase(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T)</P></FONT>
<P><FONT size=2>we receive errors about too few type arguments if we pass Entity as the parent class. I have read about possibly using interfaces in this situation but I am unsure of what is best. We use the CodesSmith generator tool and we are VBers in case you didn't already figure that one out.</FONT></P>
<P><FONT size=2>Thanks in advance for any help you can offer.</FONT></P>
<P><FONT size=2>Tom</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Thursday, December 07, 2006</h2>Which line is the too few type arguments actually referring to?&nbsp; And what is the definition of ACSBusinessBase?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tommybouy replied on Tuesday, December 12, 2006</h2><P>The ACSBusinessBase is defined as:<FONT size=2></P>
<P>&lt;Serializable</FONT><FONT size=2>()&gt; _</P></FONT><FONT color=#0000ff size=2>
<P>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>MustInherit</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> ACSBusinessBase(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> ACSBusinessBase(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T))</P>
<P>#</FONT><FONT color=#0000ff size=2>Region</FONT><FONT size=2> </FONT><FONT color=#800000 size=2>"Declarations"</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;Inherits</FONT><FONT size=2> Csla.BusinessBase(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> ACSBusinessBase(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T))</P></FONT><FONT size=2>
<P>#</FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</FONT><FONT size=2> </FONT><FONT color=#008000 size=2>' Declarations</FONT></P>
<P><FONT color=#008000 size=2><FONT color=#000000 size=3>The too few arguments error happens in many places such as </FONT></FONT></P><FONT color=#008000 size=2><FONT size=2>
<P>&lt;NonSerialized()&gt; _</P>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> executeInsertDelegate </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> predicateEx(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> SqlConnection, Entity)</P>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> OnExecuteInsert(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> cn </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> SqlConnection, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> parent </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Entity) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;If</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Not</FONT><FONT size=2> executeInsertDelegate </FONT><FONT color=#0000ff size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Nothing</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Then</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return</FONT><FONT size=2> executeInsertDelegate(cn, parent)</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>True</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#000000 size=3>It seems like the only way to get the error to go away is change Entity to Customer or Employee in these situations. That defeats the purpose though of having the the classes be children of Entity.</FONT></FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#000000 size=3>Thanks</FONT></P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Tuesday, December 12, 2006</h2>You don't have many possibilities...<br>You can change that "Entity" to be an interface.<br>You could declare your base class like<br><br><br><p><font color="#0000ff" size="2">Public</font><font size="2"> </font><font color="#0000ff" size="2">MustInherit</font><font size="2"> </font><font color="#0000ff" size="2">Class</font><font size="2"> ACSBusinessBase(</font><font color="#0000ff" size="2">Of</font><font size="2"> T </font><font color="#0000ff" size="2">As</font><font size="2"> ACSBusinessBase(</font><font color="#0000ff" size="2">Of</font><font size="2"> T), P As Entity(Of P)) <br></font></p><p><font size="2">'Where P is parent type</font></p>And then in your method you use<br><p><font color="#008000" size="2"><font color="#0000ff" size="2">Private</font><font size="2"> </font><font color="#0000ff" size="2">Function</font><font size="2"> OnExecuteInsert(</font><font color="#0000ff" size="2">ByVal</font><font size="2"> cn </font><font color="#0000ff" size="2">As</font><font size="2"> SqlConnection, </font><font color="#0000ff" size="2">ByVal</font><font size="2"> parent </font><font color="#0000ff" size="2">As</font><font size="2"> P) </font><font color="#0000ff" size="2">As</font><font size="2"> </font><font color="#0000ff" size="2">Boolean</font></font></p>Although this is a workable solution, it might make it a pain in the ass to maintain. I'd say go with interfaces. There is probably a set of common properties that you'll want to access from the entity type, so if you make that an interface, you have no problems left...<br><br>You could also change the method to take an "Object", and cast to the correct type in the delegate's handler...<br><br>Andrés<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tommybouy replied on Tuesday, December 12, 2006</h2><P>Thank you for your ideas. Is there a good interface example somewhere? It sounds like the best solution to use. I was reading one of Rocky's responses and his question was if the parent "acts-as" something different from itself then an interface was the best way. I'm just hoping to see and axample of it so I do it correctly.</P>
<P>Tom</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Tuesday, December 12, 2006</h2>This is how you define an interface<br><br>Public Interface IEntity<br>&nbsp;&nbsp;&nbsp; Property EntityName As String<br>&nbsp;&nbsp;&nbsp; ReadOnlyProperty EntityId As Guid<br>&nbsp;&nbsp;&nbsp; Function GetSomeData(paramA as Integer, paramB as String) as String<br>&nbsp;&nbsp;&nbsp; Sub SetSqlCommandParams(cmd as SqlCommand)<br>End Interface<br><br>Notice the interface doesn't worry about implementation or visibility (Public, private, Protected, etc)<br><br>So, then you go and create your Entity class:<br><br>Public Class Entity(Of T As Entity(Of T))1<br>Inherits YourBaseClass(Of T)<br>Implements IEntity<br><br>Public Property EntityName() As String Implements IEntity.EntityName<br>...<br>End Property<br><br>End Class<br><br><br>VS will be a sport and help you out in that it will auto gen the structure of the code as soon as you hit "Enter" in the implements line.<br><br>I hope it helps!<br><br>Andrés<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
