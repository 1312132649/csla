<html><header><title>Obtaining a Value from a databound listbox using NameValueListBase - Solved</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Obtaining a Value from a databound listbox using NameValueListBase - Solved</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2819.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>CSLABound posted on Thursday, May 03, 2007</h2><P>I'm sure this is a newbie question.... but I've pulled every book off of Barnes and Nobles and Books a Million as well as looking through online forums, and can't find an answer.</P>
<P>I have a NameValueListBase (a list of Admin Settings for the app) databound to a windows form UI listbox.&nbsp; I want to grab the integer representation of an item in the NameValueListBase, within a button click method.</P>
<P>So there is a public class AdminSettingsList: NameValueListBase&lt;int, string&gt;</P>
<P>there is an adminSettingsListBindingSource</P>
<P>and there is an AdminSettingsListBox.</P>
<P>When a user clicks on the edit button, I need to grab the int of the selected Admin Setting, to populate a grid control with another object that corresponds to that Admin setting.&nbsp; How do I get the integer?</P>
<P>Thanks</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>CSLABound replied on Thursday, May 03, 2007</h2><P>Sometimes I think just posting to this forum pulls the answer out of my head.&nbsp; Let me apologize for figuring it out 2 seconds after posting this.&nbsp; But the answer I came up with is the following:</P>
<P>int integerSelected&nbsp;= int.Parse(this.AdminSettingsListBox.SelectedValue.ToStrng());</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tetranz replied on Friday, May 04, 2007</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>CSLABound:</strong></div><div>But the answer I came up with is the following: <BR>int integerSelected&nbsp;= int.Parse(this.AdminSettingsListBox.SelectedValue.ToStrng());</div></BLOCKQUOTE></P>
<P>That probably works but its making the data jump through lots of unnecessary hoops.</P>
<P>AdminSettingsListBox.SelectedItem gives you a reference to the selected object in the collection which will be of type&nbsp;AdminSettingsList.NameValuePair.&nbsp; That has&nbsp;the strongly typed properties&nbsp;Key and Value.&nbsp;I think a cleaner answer is:</P>
<P>int integerSelected&nbsp;= ((AdminSettingsList.NameValuePair) AdminSettingsListBox.SelectedItem).Key</P>
<P>Cheers<BR>Ross</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, May 04, 2007</h2><P>Well, as long as we're throwing out alternate methods to acomplish this:</P>
<P>int integerSelected&nbsp;= (int)AdminSettingsListBox.SelectedValue;</P>
<P>Would be the shortest path to the value, assuming the Value property&nbsp;of the combobox is set to the interger column.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
