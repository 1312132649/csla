<html><header><title>Authentication on website application</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Authentication on website application</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4509.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jfreeman posted on Monday, March 17, 2008</h2>We have a website that is being built using CSLA and everything is working fine when it is ran on our development machines.&nbsp; It also works fine when we move the site to a QA server and set it up as a virtual directory in IIS.&nbsp; However, the admin wants to set it up as site instead of a virtual directory.&nbsp; When we do that, we get errors on DataPortal.Fetch.&nbsp; It says it is trying to use 'NT AUTHORITY\ANONYMOUS LOGON'.&nbsp; Any ideas why it is trying to do this when it is an IIS site?&nbsp; Thanks.<br><br>Jonathan<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, March 17, 2008</h2>Your vdir is configured to accept anonymous connections, and the application under which it is running isn't set to run under a specific account.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jfreeman replied on Wednesday, March 19, 2008</h2><P>Maybe I'm missing something but I still cannot get the site to work.&nbsp; It is setup in IIS as a site now not a vdir.&nbsp; Where should I be looking to change the account it is running under?&nbsp; thanks.</P>
<P>&nbsp;</P>
<P>Jonathan</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, March 19, 2008</h2>Depends on the IIS version.&nbsp; In 6 and above you change the identity of the application pool which your site application is using.&nbsp; In IIS 5 there's a different place to set it, directly from the site properties page I think.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jfreeman replied on Wednesday, March 19, 2008</h2><P>I am in IIS 6.&nbsp; What identity should the App Pool be running under?&nbsp; Right now, it is set to run NetworkService.</P>
<P>Thanks.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jfreeman replied on Wednesday, March 19, 2008</h2><P>I was able to setup the App Pool to run under a local user account on that server.&nbsp; The site is running but when I access the database, this is what I get in Event Viewer:</P>
<P>Process information: <BR>&nbsp;&nbsp;&nbsp; Process ID: 6368 <BR>&nbsp;&nbsp;&nbsp; Process name: w3wp.exe <BR>&nbsp;&nbsp;&nbsp; Account name: PANDORA\AppDev <BR><BR>Exception information: <BR>&nbsp;&nbsp;&nbsp; Exception type: DataPortalException <BR>&nbsp;&nbsp;&nbsp; Exception message: DataPortal.Fetch failed <STRONG>(Login failed for user 'NT AUTHORITY\ANONYMOUS LOGON'.) <BR></STRONG>&nbsp;<BR>Request information: <BR>&nbsp;&nbsp;&nbsp; Request URL: <A href="http://scorecard/Admin/KpiManagement.aspx">http://scorecard/Admin/KpiManagement.aspx</A> <BR>&nbsp;&nbsp;&nbsp; Request path: /Admin/KpiManagement.aspx <BR>&nbsp;&nbsp;&nbsp; User host address: 10.10.2.100 <BR>&nbsp;&nbsp;&nbsp; User: LBMCNET\10034 <BR>&nbsp;&nbsp;&nbsp; Is authenticated: True <BR>&nbsp;&nbsp;&nbsp; Authentication Type: Negotiate <BR>&nbsp;&nbsp;&nbsp; Thread account name: PANDORA\AppDev </P>
<P>Whey would it be trying to Call Fetch using Anonymous Logon?&nbsp; Thanks.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, March 19, 2008</h2>Did you enable identity impersonate in the web.config file?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jfreeman replied on Wednesday, March 19, 2008</h2>Yes, I have identity impersonate set to true.&nbsp; Is there another setting I need to change?<br><br>Jonathan<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
