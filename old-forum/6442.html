<html><header><title>Conversion from type 'Guid' to type 'String' is not valid.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Conversion from type 'Guid' to type 'String' is not valid.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6442.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jasona22 posted on Tuesday, February 17, 2009</h2><P>First, let me start by admitting I am a mud-farmer compared to most of you on this CSLA stuff.&nbsp; </P>
<P>Here is what I am running into and perhaps one of you kind folks can speak mud-farmer well enough to explain how to resolve my issue.</P>
<P>I have a property that is the datafield of a combo box.&nbsp; This property is of type GUID.&nbsp; The business rule I am trying to implement is that a value is required to be selected.&nbsp; I tried using StringRequired, but get the "conversion" error in the Subject line above.&nbsp; Although I can type ".ToString()" and get a value -- kind of confounds the simple.</P>
<P>I am currently playing with a work around that does a regex against the guid, but as it turns out, an empty guid is still a properly formated guid. I will continue down this path for a time or perhaps I will create a "string wrapper" around the guid property that does a convert... but what a hack that feels like.</P>
<P>What I would love to know is if there is a simpler way to validate a Guid as a "StringRequired" or some such thing instead of the regex route.&nbsp; The fact I can do a ".ToString" on the Guid property says that the above error is incorrect; yet it still fails.</P>
<P>Help?</P>
<P>Thank you</P>
<P>Mud-Farmer</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, February 17, 2009</h2>What are you using for the combobox's DataSource?&nbsp; <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jasona22 replied on Tuesday, February 17, 2009</h2><P>The DataSource is bound progmatically to the business object.&nbsp; So there is a "WorkOrder" class that is my business object and it is the DataSource, the properties of WorkOrder are what the various controls of the form are using as DataFields.</P>
<P>Just as a note, my validation rules for strings and numeric fields all work perfectly.&nbsp; It is just the properties (DataFields) that have a type of Guid that are giving me a fit.</P><FONT size=2>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>'MyString works</FONT></FONT></P>
<P><FONT size=2>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>AddressOf</FONT></FONT><FONT size=2> Validation.StringRequired, </FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"MyString"</FONT></FONT><FONT size=2>)</P>
<P>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>AddressOf</FONT></FONT><FONT size=2> Validation.StringMaxLength, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>New</FONT></FONT><FONT size=2> Validation.MaxLengthRuleArgs(</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"MyString"</FONT></FONT><FONT size=2>, 15))</FONT></P>
<P><FONT size=2></FONT>&nbsp;</P>
<P><FONT size=2></FONT>&nbsp;</P>
<P><FONT color=#008000 size=2>'OrgGuid does NOT work</FONT></P>
<P><FONT size=2><FONT size=2>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>AddressOf</FONT></FONT><FONT size=2> Validation.StringRequired, </FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"OrgGuid"</FONT></FONT><FONT size=2>)</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2></FONT></FONT>&nbsp;</P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2></FONT></FONT>&nbsp;</P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> OrgGuid() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> Guid</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Get</FONT></FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Return</FONT></FONT><FONT size=2> _supportorganizationguid</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Get</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Set</FONT></FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> value </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> Guid)</P>
<P>_orgguid = value</P>
<P>PropertyHasChanged()</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Set</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2></FONT></FONT>&nbsp;</P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#000000>Does this help?</FONT></P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DocJames replied on Wednesday, February 18, 2009</h2><br />I would do a Custom rule:<br /><br />private static bool OrgGuidRequired(object target, RuleArgs e)<br />{<br />  if (((WorkOrder)target).OrgGuid == Guid.Empty)<br />  {<br />    e.Description = "Org is required";<br />    return false;<br />  }<br />  return true;<br />}<br /><br />and add the rule with:<br /><br />ValidationRules.AddRule(OrgGuidRequired, "OrgGuid", 1);<br /><br />I hope this can help.<br /><br />Thanks,<br />Jimmy</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Dave Boal replied on Friday, November 06, 2009</h2>...to add on to the previous solution, I would add a project to your solution adding a class that can be called from any project:<br /><br />namespace CodeQwik.Common.CustomValidationRules<br />{<br />	public static class CustomRules<br />	{<br />		/// <br />		/// Rule ensuring a Guid value is not Guid.Empty<br />		/// <br />		/// Object containing the data to validate<br />		/// Arguments parameter specifying the name of the string<br />		/// property to validate<br />		///  if the rule is broken<br />		/// <br />		/// This implementation uses late binding, and will only work<br />		/// against Guid property values.<br />		/// <br />		[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Design", "CA1062:ValidateArgumentsOfPublicMethods")]<br />		public static bool GuidRequired(object target, RuleArgs e)<br />		{<br />			Guid value = (Guid)Utilities.CallByName(<br />				target, e.PropertyName, CallType.Get);<br />			if (value != Guid.Empty)<br />			{<br />				e.Description = string.Format("{0} must be assigned.", e.PropertyName);<br />				return false;<br />			}<br />			return true;<br />		}<br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Dave Boal replied on Friday, November 06, 2009</h2>...to add on to the previous solution, I would add a project to your solution adding a class that can be called from any project:<br /><br />namespace CodeQwik.Common.CustomValidationRules<br />{<br />	public static class CustomRules<br />	{<br />		/// <br />		/// Rule ensuring a Guid value is not Guid.Empty<br />		/// <br />		/// Object containing the data to validate<br />		/// Arguments parameter specifying the name of the string<br />		/// property to validate<br />		///  if the rule is broken<br />		/// <br />		/// This implementation uses late binding, and will only work<br />		/// against Guid property values.<br />		/// <br />		[System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Design", "CA1062:ValidateArgumentsOfPublicMethods")]<br />		public static bool GuidRequired(object target, RuleArgs e)<br />		{<br />			Guid value = (Guid)Utilities.CallByName(<br />				target, e.PropertyName, CallType.Get);<br />			if (value == Guid.Empty)<br />			{<br />				e.Description = string.Format("{0} must be assigned.", e.PropertyName);<br />				return false;<br />			}<br />			return true;<br />		}<br />	}<br />}<br /><br /><br />... which could be called in your business object as follows:<br />#region Validation Rules<br />private void addCustomRules()<br />{<br />	ValidationRules.AddRule(<br />	CodeQwik.Common.CustomValidationRules.CustomRules.GuidRequired, "ID", 1); <br />}<br />#endregion //Validation Rules</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
