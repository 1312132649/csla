<html><header><title>How to remove an item from BusinessListBase and perform a list.Save() without cascading Save() into the other items in the list?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How to remove an item from BusinessListBase and perform a list.Save() without cascading Save() into the other items in the list?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11730.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>fryderyk posted on Thursday, November 29, 2012</h2><p>The title may be a little confusing, let&#39;s dive into details:&nbsp; I have a BLB inherited list model called Documents, and the child item model is a regular BusinessBase inherited model Document.&nbsp; Consider the following situation:</p>
<p>The Documents list has 3 items, two of which is currently opened for editing (utilizing BeginEdit() ), the other one is not opened.</p>
<p>Now I&#39;m trying to remove the closed document by calling list.Remove(doc), but the document file is not deleted since the actual filesystem delete operation is done in Child_DeleteSelf() in the Document class which is not fired until list.Save() is called. However I cannot simply call list.Save() because this will save all the other currently editing documents which is not intended.</p>
<p>Probably I made some silly mistakes somewhere, or is there a better way to accomplish this?</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Saturday, December 01, 2012</h2><p>Hi, </p>
<p>So you want a different behavior than that of the standard lists - which is for the save to:&nbsp; </p>
<ol>
<li>delete items in DeletedList that har IsNew = false</li>
<li>insert/update items in list </li>
</ol>
<p>You can override the RemoveItem method of the list to call a command object to do the actual immediate delete and the leave the child_delete method empty to do nothing in the child object. </p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fryderyk replied on Saturday, December 01, 2012</h2><p>Really appreciated for the quick reply. I suppose you suggest doing this:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected override void RemoveItem(int index)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var item = this[index];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.RemoveItem(index);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!item.IsNew)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; File.Delete(item.FilePath);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.DeletedList.Remove(item); // since the underlying file is deleted,&nbsp; it should not be undoable.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p><br />now whenever list.Remove(item) is called, the actual file delete is performed, eliminate the need to call list.Save(). But then the normal collection undo capability is lost. I don&#39;t like to alter the normal Remove(item) behavior, so I think for me, adding a separate Delete(item) function into the collection class is a more practical solution, like this:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void Delete(item)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (item.IsNew)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.Remove(item);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; File.Delete(item.FilePath);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.Remove(item);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.DeletedList.Remove(item);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /><br />Is this an OK approach ?</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Sunday, December 02, 2012</h2><p>The only difference in your code above is that you must call a specific method on the list for remove. </p>
<p>That doesn&#39;t stop anyone (potentially) using your code and call the regular Remove by using DataBinding or built-in Remove/Delete in a grid. </p>
<p>None of the solutions will support n-level undo functions in that a &quot;deleted&quot; item will be recovers . the file is already deleted.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fryderyk replied on Monday, December 03, 2012</h2><p>Luckily no grid in my circumstances, will use the code from my previous reply.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
