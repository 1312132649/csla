<html><header><title>Missing support for DataPortal_Insert in the Client DataPortal and ObjectFactoryAttribute</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Missing support for DataPortal_Insert in the Client DataPortal and ObjectFactoryAttribute</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5426.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jmcd posted on Thursday, September 18, 2008</h2>I'm working on an implementation of the ObjectFactoryAttribute pattern based on Rocky's blog post http://www.lhotka.net/weblog/CSLANETObjectFactoryAttribute.aspx<br><br>I like the control the approach gives me with respect to checking cross-cutting concerns before invoking DataPortal methods.&nbsp; However, I have noticed that in the latest source (http://lhotka.net/files/csla36/cslacs-3.6.0-080906.zip) there seems to be missing support for calling a Business Object's DataPortal_Insert method.&nbsp; In the ObjectFactoryAttribute class there are class properties available for describing the methods Create, Fetch, Update and Delete but no Insert.&nbsp; Additionally, when you call Save on a new Business Object instance, the Client DataPortal only decides whether to call Update or Delete whereas in 3.5 it decided whether to call Insert, Update or Delete.<br><br>Is the omitted support for Insert a bug or has the design changed?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jmcd replied on Friday, September 19, 2008</h2>I think I've answered my own question so thought I should share my findings.<br><br>I think the Update method in the Factory class is to decide what to do (like the DataPortal Update) i.e. either call Update, Delete or Insert based on the class properties of the object<br><br>My Update method looks something like:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(busObj.IsDeleted)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //perform a Delete Self<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if (busObj.IsNew)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // perform an Insert<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //perform an Update<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, September 19, 2008</h2><P>That is exactly right. When you use the ObjectFactory attribute, your factory assumes all responsibility for interacting with any business objects - in any way you choose. The data portal does as little as possible, allowing you the flexibility to do as much as possible.</P>
<P>You should look at the Csla.Server.ObjectFactory base class. While you don't have to inherit from this class, it is a good choice, because it provides methods allowing you to manipulate the state of business objects (MarkNew(), MarkOld(), MarkAsChild()).</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
