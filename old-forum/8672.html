<html><header><title>How can one bound combobox update another bound combobox?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How can one bound combobox update another bound combobox?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8672.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jerrycurl posted on Tuesday, March 16, 2010</h2><p>I have a BusinessBase object called FavoriteColors (not really, this is just a simplified example of my question).&nbsp; It has two properties: FavoriteColorYesterday and FavoriteColorToday.&nbsp; They are both ints, which map to colors in a Color table (1=Red, 2=Blue, etc...).&nbsp; </p>
<p>On my form, I have a BindingSource.&nbsp; The form also has two comboboxes, one each for FavoriteColorYesterday and FavoriteColorToday.&nbsp; Each is bound to the appropriate property.&nbsp; In the form constructor, I create an instance of FavoriteColors (_favoriteColors) and set it as the DataSource of the BindingSource (via the BindUI function as shown in the ProjectTracker example).&nbsp; Everything works fine.</p>
<p>Now I want to make it so that when the user selects a color in the FavoriteColorYesterday combobox, that the same color will automatically be selected in the FavoriteColorToday combox (since the user will usually want the same color in both places, this will save them a little time).&nbsp; I can&#39;t figure out how to make this happen.</p>
<p>In my comboBoxFavoriteColorYesterday_SelectedIndexChanged event, I have</p>
<p>&nbsp; if(comboBoxFavoriteColorYesterday.SelectedItem.Text == &quot;Red&quot;)</p>
<p>&nbsp;&nbsp;&nbsp; _favoriteColors.FavoriteColorToday = 1;</p>
<p>&nbsp;</p>
<p>But this doesn&#39;t work.&nbsp; The comboBoxFavoriteColorYesterday doesn&#39;t change.&nbsp; The comboBoxFavoriteColorToday does change, but the change doesn&#39;t get saved.&nbsp; </p>
<p>I&#39;ve also tried setting the property on the bindingsource like this:&nbsp; ((FavoriteColors)bindingSourceFavoriteColors).FavoriteColorToday = 1;</p>
<p>I&#39;ve also tried setting the SelectedIndex property of comboBoxFavoriteColorToday.&nbsp; Nothing works.&nbsp; What am I doing wrong?</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>triplea replied on Wednesday, March 17, 2010</h2><p>You should perform the change within your BO. Override OnPropertyChanged:</p>
<p>protected override void OnPropertyChanged(string propertyName)<br />{<br />&nbsp;&nbsp;&nbsp; if (propertyname.Equals(&quot;YesterdaysColor&quot;)<br />&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TodaysColor = YesterdaysColor;<br />&nbsp;&nbsp; }<br />&nbsp;&nbsp; ...<br />}</p>
<p>I also assume you are using WinForms in which case if I remember well you will need a BindingSourceRefresh otherwise the value will be updated in your BO but the change will not be reflected on your UI.</p>
<p>HTH</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jerrycurl replied on Friday, March 19, 2010</h2><p>Thanks, that works.&nbsp; No BindingSourceRefresh needed.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, March 18, 2010</h2><p>Hi, </p>
<p>You shouldn&#39;t need the BindingSourceRefresh but I&#39;d rather suspect that the sequence for UnBinding bindingsources is not correct. </p>
<p>Try to set a breakpoint on the property setter to see if the value is &quot;destroyed&quot; from the UI after you have set the BO value.</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
