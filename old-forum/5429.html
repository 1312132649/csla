<html><header><title>Business base inheritance</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Business base inheritance</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5429.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>tchimev posted on Thursday, September 18, 2008</h2>I'm trying to create an abstract class which inherits BB, like this:<br><br>&nbsp;&nbsp;&nbsp; public abstract class Abstr&lt;T&gt; : BusinessBase&lt;Abstr&lt;T&gt;&gt;<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected static PropertyInfo&lt;int&gt; _id = RegisterProperty&lt;int&gt;(new PropertyInfo&lt;int&gt;("ID"));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int ID<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return GetProperty&lt;int&gt;(_id); }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; public class Test : Abstr&lt;Test&gt;<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private static PropertyInfo&lt;string&gt; _name = RegisterProperty&lt;string&gt;(new PropertyInfo&lt;string&gt;("Name"));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string Name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return GetProperty&lt;string&gt;(_name); }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set { SetProperty&lt;string&gt;(_name, value); }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br><br><br>But when I create a new instance of type Test the ID property of the abstract class does not load with default value. <br>When I try to use the ID property I get an exception( something like RegisterProperty() func does not work correctly).<br>What am I missing?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, September 18, 2008</h2>Off the top of my head, shouldn't it be:<br>public abstract class Abstr&lt;T&gt; : BusinessBase&lt;T&gt;<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tchimev replied on Thursday, September 18, 2008</h2>may be like this <br><br>&nbsp;&nbsp;&nbsp; public abstract class Abstr&lt;T&gt; : BusinessBase&lt;T&gt; where T : Abstr&lt;T&gt;<br><br>but that does not help<br>The error comes from the RegisterProperty() method.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tchimev replied on Thursday, September 18, 2008</h2>Ok, I replaced my generics classes and it is working fine I think.<br><br>public abstract class Abstr : BusinessBase&lt;Abstr&gt;<br>{ }<br><br>public class Test : Abstr<br>{ }<br><br>But can someone explain why it is not working with generics?<br>thank you.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>stefan replied on Friday, September 19, 2008</h2>What you still need to implement is the 'dummy-workaround' as I call it.<br>Search the forum for '_dummy', especially in recent posts from Rocky.<br><br>In short:<br>If you have managed properties (e.g. using RegisterProperty) in any base classes, <br>then, in order to force RegisterProperty to be called in the right order (e.g. down-top), <br>you have to do the following in <i>every</i> base class using 'RegisterProperty:<br><br>- declare a static/shared dummy variable<br>&nbsp;&nbsp;&nbsp; private static int _dummy;<br>&nbsp;&nbsp;&nbsp; Private Shared _dummy As Integer<br><br>- initialize the dummy variable in the constructor<br>&nbsp;&nbsp;&nbsp; protected MyClass() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _dummy = 0;<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; Protected Sub New()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _dummy = 0<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>- override OnDeserialized, and initialize _dummy there too<br>&nbsp;&nbsp;&nbsp; protected override void OnDeserialized(System.Runtime.Serialization.StreamingContext context) {<br>&nbsp;&nbsp;&nbsp;&nbsp; base.OnDeserialized(context);<br>&nbsp;&nbsp;&nbsp;&nbsp; _dummy = 0;<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; Protected Overrides Sub OnDeserialized(ByVal context As System.Runtime.Serialization.StreamingContext)<br>&nbsp;&nbsp;&nbsp; MyBase.OnDeserialized(context)<br>&nbsp;&nbsp;&nbsp; _dummy = 0<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>This is how I see it at the moment.<br><br><br>Stefan<br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
