<html><header><title>BusinessBase and events</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>BusinessBase and events</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6681.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>DivisibleByZero posted on Thursday, March 26, 2009</h2>I have a BusinessBase class which has a few properties:<br><br>Root : BusinessBase&lt;Root&gt;<br>-----<br>&nbsp;&nbsp; int Foo<br>&nbsp;&nbsp; int Bar<br><br><br>In my UI, I need to populate a dropdown with all the possible values for Foo<br><br>cboFoo.DataSource = FooList.GetList();<br><br>I also need to populate a list of Bar's, but Bar is dependent on Foo:<br><br>cboBar.DataSource = BarList.GetList(fooId);<br><br>Should I add an event to my root class called FooChanged and subscribe to that in order to know when I need to repopulate the Bar dropdown? I don't want to write the code in the combo box selected item changed handler.<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, March 26, 2009</h2><P>This is a common question and there are several threads on the forum about populating combobox controls and how to manage NameValueListBase objects.</P>
<P>My basic answer is this.</P>
<P>If your NVL is global (doesn't change based on other fields) then you should reference it globally:</P>
<P>var list = MyListOfItems.GetList();</P>
<P>If your NVL is different depending on the scenario, then it belongs to that scenario. In your example, FooList is global, but BarList is scenario dependent. So I'd expose a BarList property off Root, so the UI would get the appropriately filtered list from Root.</P>
<P>This is also useful, because Root may want to validate the value of Bar, which means verifying that it is in the appropriately filtered list. By maintaining its own appropriately filtered list, the Root object can easily implement its validation rule.</P>
<P>Then all you need to do in Root is make sure to raise PropertyChanged for BarList any time Foo changes. Though in Windows Forms that is probably not necessary since any PropertyChanged event refreshes all bound fields - but you'll have to test to see what works.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
