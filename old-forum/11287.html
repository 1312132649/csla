<html><header><title>Difficulty understanding how to implement the save strategy using BusinessBase&lt;T&gt; and (Dynamic/Business)BindingListBase&lt;&gt;...</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Difficulty understanding how to implement the save strategy using BusinessBase&lt;T&gt; and (Dynamic/Business)BindingListBase&lt;&gt;...</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11287.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>cwinkelmann posted on Monday, April 09, 2012</h2><p>I have a list of BusinessBase&lt;T&gt; objects loaded from the database. These are rather complex objects as they contain two BusinessBindingListBase properties which are children and one of those lists is of BusinessBase&lt;T2&gt; which also contains a BusinessBindingListBase&lt;&gt; of other BusinessBase&lt;T3&gt; objects.</p>
<p>&nbsp;</p>
<p>The first list is a DynamicBindingListBase&lt;T&gt; which should update the objects when the current pointer changes on the Form BindingSource. The initial form cannot possibly display all the complex data so showing the list and the header level information on the base or parent object is sufficient for the end user. However when the user wants to view / edit more data for that specific object, they can click on a button that will open an editor form which displays all the data for that single object (child and grandchild lists)... The problem is &quot;how to save the object when the data has changed&quot; because it is bound in the first form (showing the list of multiple items). Do I need to share the BindingSource of the original form so I can call EndEdit() to manually save when the object is changed? </p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, April 10, 2012</h2><p>You may look into this article by Tiago for clarification:</p>
<p><a href="http://www.codeproject.com/Articles/34095/Make-a-Master-Detail-DGV-using-CSLA-DynamicRootLis">http://www.codeproject.com/Articles/34095/Make-a-Master-Detail-DGV-using-CSLA-DynamicRootLis&nbsp; </a></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>shrikant44 replied on Tuesday, April 10, 2012</h2><p>These are rather complex objects as they contain two BusinessBindingListBase properties which are children.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<table frame="VOID" border="0" cellspacing="0" rules="NONE">
<colgroup><col width="167"></col></colgroup>
	
<tbody>
<tr>
<td align="LEFT" height="17" width="167"><a href="http://www.tapesolutionsinc.com/masking-tape.html">blue masking tape</a></td>
</tr>
</tbody>
</table></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Wednesday, April 11, 2012</h2><p>Quote from the C# 2008 Business Objects book: </p>
<p><i>&quot;Dynamic Editable Collection <br /><br />The dynamic editable collection stereotype is designed to support a narrow and focused scenario in <br />which the UI is a Windows Forms grid control that is data bound to the collection, and in which the <br />user wants his changes to each row saved as soon as he moves off each row. &quot;</i></p>
<p>IE: DynamicListBase i s created to support edit of a &quot;simple&quot; editable object that has no child lists.</p>
<p>So the typical solution wold rather be:</p>
<ol>
<li>Use a ReadOnlyList to select object to edit</li>
<li>Get a new Editable object to open in same or new Form</li>
<li>Call Save on the new object (and possibly update the ReadOnly object in first list). </li>
</ol>
<p>I believe you are stretching the limits for what DynamicListBase is meant to support.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cwinkelmann replied on Wednesday, April 11, 2012</h2><p>I think you are right about my use of DynamicBindingListBase&lt;&gt; where I am stretching (abusing) the intended use of it. </p>
<p>The next logical question is then how would I rig the form to update the EditableRoot object where the root elements are bound, the EditableChildList (s) are bound to relevant data grids, and EditableGrandchild objects are displayed in a repeated UserControl. </p>
<p>Because the child objects are marked IsChild=true I cannot use a DynamicBindingListBase to display these so the change in focus or change of current item will not trigger the save. (Child objects cannot call Save() directly...) </p>
<p>I&#39;m not clear if I need to provide a button that will call ApplyEdit() on the BindingSource, and as there are several BindingSources on the same page, will ApplyEdit() on the EditableRoot end the edit session on each of the child objects? </p>
<p>I intend to write a proof of concept and upload it to CodeProject.com. I hope then solving this puzzle will help many more developers than just me. </p>
<p>My next post here will be with the link to CP.... </p>
<p>Thanks!</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, April 12, 2012</h2><p>Hi,</p>
<p>Well, maybe you could start by explaining the&nbsp;use case / requirements that you have? </p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cwinkelmann replied on Monday, April 16, 2012</h2><p>I have a Proof of concept project that should be attached here which is the code for the following requirements. This is not my company&#39;s code, but it is the exact relationship between objects I&#39;d like to get working with CSLA. I hope that if this is a strong enough example for other developers to learn from that it can be added to the CSLA samples! It looks like I need to use the CslaActionExtender class, but I&#39;m just starting to learn about this class.</p>
<p>I feel I have to abandon the hopes of making the EditableRoot object save every time a property is changed. I would like to create a special PropertyInfo class that can invoke or raise a save event where the CslaActionExtender will listen to and then automatically perform it&#39;s actions to unhook events, save, and rebind the new object... I think having the ability to automatically save an object when it is validated will reduce some small tasks for the User and if there is an error, it will be displayed in the form and then when they correct the field it is then automatically saved again...</p>
<p>Requirements:<br />-----------------------------------------------------<br /><br />EditableRoot - Can create an instance as New(), or Get() from dto. <br />&nbsp;&nbsp;&nbsp; Properties - Index, Class Index, Name, Description, Collection of EditableChild1 objects, <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Collection of EditableChild2 objects each with Collection of EditableGrandchild objects, <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *** Compute the following: GrossValue, NetValue.<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />EditableRootDto - Load properties from datasource... <br /><br />EditableRootClass - Acts as dropdown selection as a descriptor for EditableRoot.<br /><br />EditableRootDynamicList - Automatically save the EditableRoot objects as they are modified. (perhaps a special &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br />-----------------------------------------------------<br /><br />EditableChild1 - Can create an instance as New(), or Get() from dto. <br />&nbsp;&nbsp;&nbsp; Properties - Index, Class Index, Name, Description,<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *** TaxPercentRate, TaxAnnualRate<br />-----------------------------------------------------<br /><br />EditableChild2 - Can create an instance as New(), or Get() from dto. <br />&nbsp;&nbsp;&nbsp; Properties - Index, Class Index, Name, Description, Collection of Child objects,<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *** GrossValue, NetValue<br />-----------------------------------------------------<br /><br />EditableGrandchild - Can create an instance as New(), or Get() from dto. <br />&nbsp;&nbsp;&nbsp; Properties - Index, Class Index, Name, Description<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; *** MaintenanceCost, MarketValue, PurchaseValue<br />-----------------------------------------------------<br /><br />*** When specific properties on the EditableRoot, EditableChild1, EditableChild2, and EditableGrandchild<br />&nbsp;&nbsp;&nbsp; objects are modified then through the relationship (object graph) the EditableRoot will have to <br />&nbsp;&nbsp;&nbsp; recompute/recalculate some specific values which are necessary for display in the UI. These are <br />&nbsp;&nbsp;&nbsp; READONLY properties and should NOT cause any object to be marked as ISDirty. (with exception one total<br />&nbsp;&nbsp;&nbsp; on the EditableRoot that may be persisted for computation in other downstream processes)<br /><br /><br /></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cwinkelmann replied on Tuesday, April 17, 2012</h2><p>I&#39;ve updated the solution file to include Tiago Freitas Leal&#39;s latest version of the CslaActionEctender in the Csla.Windows project. His work is documented here: http://forums.lhotka.net/forums/t/8009.aspx</p>
<p>The attached file contains an updated and more functional version with the binding on two forms enabled. <span style="text-decoration:line-through;">There are still some bugs with CslaActionExtender in this version (4.3.10 V3) just fyi for Tiago. </span></p>
<p>((((( Correction:::: I&#39;m NOT sure there are any bugs in CslaActionExtender v3... I had found an issue where a bug would occur when updating a property of a child object but it was unhandled and bubbled up to CSLA which threw the error. I did however notice that the Save and Cancel buttons do not disable when saved for the first time. I would think that should create a state where there was nothing to do.))))</p>
<p>To me, there is a lot of complexity added because the Save/Update process (also required for the Undo functionality) automatically makes a Clone of the object and that is the object returned by the update process. The result is the issues with rebinding the data when saving. This makes it difficult if not impossible (by complexity...) to have multiple forms bound to the same object because if one commits (save/update) then that form will have a new object (clone) to rebind but then multiple forms would also have to handle the replacement of the new object. This is even more complicated when the bound object in one form is a member of a list in another form.</p>
<p>If the save process didn&#39;t clone and return the new object then everything would be copacetic. Then there is a new problem of how to transmit and return data to the source. This could be enforced by the use of Dto&#39;s for every communication. It is not much different than Clone, but I don&#39;t now about the performance. I suspect Clone is much faster than creating and loading an object, unless the only thing l loaded to Dto is a few fields to persist; and not the entire business object with logic and tons of other data...</p>
<p>I&#39;m curious if it is possible that the Windows version of Csla could be more easy to use if it was split from the asp.net xaml etc version?</p>
<p><b><br /></b></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>shrikant44 replied on Tuesday, April 24, 2012</h2><p>I believe you are stretching the limits for what DynamicListBase is meant to support..</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<table frame="VOID" rules="NONE" border="0" cellspacing="0">
<colgroup><col width="171"></col></colgroup>
	
<tbody>
<tr>
<td align="LEFT" height="17" width="171"><a href="http://www.sound.realpropertymgt.com%20">property management everett washington</a></td>
</tr>
</tbody>
</table></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
