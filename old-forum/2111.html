<html><header><title>FormView w/ CslaDataSource not updating when BO properties are changed!?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>FormView w/ CslaDataSource not updating when BO properties are changed!?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2111.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate posted on Wednesday, January 10, 2007</h2><P>I have a FormView control bound to a CslaDataSource representing a Project in the application.&nbsp; Part of the business logic calls for us to "cascade" some property values when a Customer is selected from a DropDownList in the form.&nbsp; The DropDownList is also bound using the CslaDataSource control and the OnSelectedIndexChanged handler is defined declaratively as follows:</P>
<P><CODE>&lt;asp:DropDownList ID="CustomerDropDownList" runat="Server" AutoPostBack="true" DataSourceID="CustomersDataSource" DataTextField="Name" DataValueField="UniqueID" OnSelectedIndexChanged="CustomerDropDownList_SelectedIndexChanged" Text='&lt;%# Bind("Customer") %&gt;' /&gt;</CODE></P>
<P>In the code-beside, I have:</P>
<P><CODE>protected void CustomerDropDownList_SelectedIndexChanged(object sender, EventArgs e)<BR>{<BR>&nbsp; &nbsp; Customer c = Customer.GetCustomer(new Guid(((DropDownList)sender).SelectedValue));<BR>&nbsp; &nbsp; Project p&nbsp;= GetProject();</CODE></P>
<P><CODE>&nbsp;&nbsp;&nbsp; // copy some properties from "c" to "p"</CODE></P>
<P><CODE>&nbsp;&nbsp;&nbsp; FormView1.DataBind();<BR>}</CODE></P>
<P>First, I get the Customer object based on the selected item in the drop down list.&nbsp; Then I get the Project that is the data source for the form and copy some property values from the Customer to the Project.&nbsp; Finally, I rebind the FormView control (cuz this was all I could find to do in other forums to try and fix my problem).</P>
<P>When I put breakpoints in my code and step through, the CslaDataSource's SelectObject handler does fire after the DataBind statement and the updated BO is set to the e.BusinessObject property.&nbsp; However, the FormView's field do not reflect the changes made in the SelectedIndexChanged handler - they come up blank as they did originally.</P>
<P>What am I doing wrong?&nbsp;&nbsp;How is it possible&nbsp;for&nbsp;the e.BusinessObject to reflect the changes yet the page renders unchanged?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Wednesday, January 10, 2007</h2><P>I'm not sure if this is what is coming into play but I thought I'd shoot a quick reply.</P>
<P>If you're rebinding the dropdownlist to the datasource on every post back, you may lose your selected index for your event. (At least there are instances where this sort of thing has come into play for me). </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Wednesday, January 10, 2007</h2><P>I think you may be on to something.&nbsp; I didn't realize that the DropDownList is also rebound when the FormView1.DataBind method is called.&nbsp; I put in a breakpoint and confirmed that this is happening.</P>
<P>What confuses me is that the DropDownList is bound to the BO's Customer property which is set to the selected item in the SelectedIndexChanged handler - before the DataBind method call.&nbsp; So, even though we re-retrieve the CustomerList to bind the DropDownList to, when the SelectedItem property is set, shouldn't it be set to the BO's Customer property which, as I said, was reset to the previously selected item?</P>
<P>And, why does this affect the other fields in the FormView which are bound to other properties of our BO?</P>
<P>Finally, what is the fix???</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Thursday, January 11, 2007</h2><P>I use individual controls rather than FormsView, etc - and essentially&nbsp;I bind dropdownlists to the datasource when !IsPostBack only.</P>
<P>I'm not entirely sure what the answer is for you, I haven't used FormsView or any of those ilk for a while for edit controls.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
