<html><header><title>Shared ViewModels</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Shared ViewModels</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10807.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jh72i posted on Tuesday, October 25, 2011</h2><p>If you are creating&nbsp;literally the&nbsp;same screen in Silverlight and WPF is it appropriate to share the same ViewModel or is that just plain wrong. </p>
<p>I know the VM is UI specific and therefore will likely need to do different things on SL and WPF but couldn&#39;t I still share the commonalilty in a base VM for that screen?</p>
<p>Is inheritance in VMs a road that should be avoided?</p>
<p>Thanks for any and all thoughts.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Tuesday, October 25, 2011</h2><p>I am of the opinion that the viewmodel should be:</p>
<ul>
<li>Specifically user workflow focused (i.e. tightly coupled to the user experience and workflow/navigation)</li>
<li>Broadly technology dependent (i.e. XAML, but not WPF/SL/etc)</li>
</ul>
<p>What this means, is that a viewmodel should focus on the user experience and navigation structure first and foremost. As a result, a viewmodel for a PC screen size will often work for other similar screen sizes across technologies. But it won&#39;t work between PC and phone screen sizes, because the user workflow isn&#39;t the same.</p>
<p>It also means that you should avoid having your viewmodel use any UI-specific types. No properties that return a Brush or other XAML type that might vary from WPF to SL to WinRT. That&#39;s what value converters are for, and the viewmodel should stick with native property types.</p>
<p>Where you can end up stuck with technology dependent code is when using things like the WP7 app bar. But even there, I am tending to use small bits of code-behind to glue nasty platform controls to the viewmodel, rather than contaminating the viewmodel with platform-specific types.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jh72i replied on Wednesday, October 26, 2011</h2><p>Thanks for the reply and insght Rocky. </p>
<p>I&#39;m still left wondering a little though...did you give a thumbs up or a thumbs down to sharing a single VM (or a <em>base </em>VM) among Silverlight and WPF (I&#39;m thinking simple Windows and PC browser now). </p>
<p>I suppose I gather from your answer that I really cannot think of a <em>single</em> user experience (a screen that looks, smells, acts the same) shared in two environments. Rather I need to think about the whole applications - navigation and context. Which is a bit of a bummer as I suppose I had really kind of been thinking in terms of non-workflow type applications - i.e. where a <em>container</em> controls the navigation and most screens (not all of course) encapsulate their part of the puzzle completely.</p>
<p>As a major role of the VM is to <em>shape</em> the M for presentation we might introduce properties there that could equally be useful in both environments so I&#39;d really want to avoid duplication. I can see too, though, how tying both together might result in 1. redundant VM properties in one environment 2. complexity of inheritance and base class polution 3. navigation confusion. </p>
<p>I suppose my real goal right now is to facilitate a migration from winforms to WPF and/or Silverlight. There is&nbsp;little doubt in my mind that the first serious migration choice (of the business and management) will be to WPF with Silverlight seen as a more web/asp.net(intranet) related change. And it is hard to argue - WPF is more closely aligned to what we can achieve in Winforms. But I worry about the furture and WinRT and the general consensus that those doing Silverlight now will have an earier migration time. </p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Wednesday, October 26, 2011</h2><p>In the much delayed (for which I am very sorry) <em>Using CSLA 4: WPF and Silverlight</em> ebook, I reuse all viewmodel base classes and viewmodel classes between WPF and Silverlight.</p>
<p>I expect that when I create the WinRT ProjectTracker UI, that I&#39;ll reuse those same viewmodel types in WinRT too.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jh72i replied on Wednesday, October 26, 2011</h2><p>Thank you Rocky. I tested out some VM sharing&nbsp;between WPF and SL and it went quite well. Good to know that you don&#39;t think its a rocky road.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jh72i replied on Wednesday, October 26, 2011</h2><p><div style='padding-left: 50px;background-color:silver'><b>jh72i<br></b>Good to know that you don&#39;t think its a rocky road</div></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">oops, I just noticed that this might not have been the best phraseology. I don&#39;t even know if it translates States-side but I meant a <em><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;">route fraught with problems</span></em> basically. Obviously a <strong><span style="text-decoration:underline;">R</span></strong>ocky road is a whole other more pleasant journey route <img src="http://forums.lhotka.net/emoticons/emotion-2.gif" alt="Big Smile" /></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-size:10pt;mso-bidi-font-size:11.0pt;"><span style="font-family:Calibri;">&nbsp;</span></span></p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, October 26, 2011</h2><p>&#39;Rocky Road&#39; is also an ice cream (a good one) </p>
<p>I knew what you meant ;)</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jh72i replied on Thursday, October 27, 2011</h2><p>mmmmm icecream! Funny thing is that in Ireland (where I live) icecream season&nbsp;pretty much ends when the summer season (note: I say <em>season</em> rather than weather!) ends but here in Helsinki (where I also live <img src="http://forums.lhotka.net/emoticons/emotion-42.gif" alt="Confused" />) I see folk eating icecream in the depths of winter when temperatures can drop to -35&nbsp;&deg;C.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
