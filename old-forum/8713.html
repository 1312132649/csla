<html><header><title>MVVM Silverlight clear control on error</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>MVVM Silverlight clear control on error</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8713.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ranjini posted on Wednesday, March 24, 2010</h2><p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-outline-level:1;mso-layout-grid-align:none;"><span style="font-family:&#39;Times New Roman&#39;,&#39;serif&#39;;color:black;font-size:12pt;mso-fareast-font-family:&#39;Times New Roman&#39;;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-no-proof:yes;">I am fairly new to mvvm + silverlight concepts and am running into a roadblock. I have a silverlight treecontrol bound to a viewmodel that is refreshed on the click event of a button. My problem is , if for any reason, there is a model binding error, i want to clear the treecontrol and not display anything. Currently, if the model has valid data the first time the button is clicked, the tree populates and if i click the button a second time and due to some problem&nbsp; , the model binding failed, the treecontrol retains its last populated value. I want the behaviour to change so that when there is an error, the treecontrol is cleared , so the UI and model are in sync. I am using Silverlight 3 with CSLA v 3.8.2. Here are my code snippets.</span><span style="line-height:115%;font-family:&#39;Times New Roman&#39;,&#39;serif&#39;;color:black;font-size:12pt;"></span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-outline-level:1;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-outline-level:1;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-outline-level:1;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">XAML -<span style="mso-spacerun:yes;">&nbsp; </span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-outline-level:1;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">UserControl.Resources</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">ResourceDictionary</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">this</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TreeListViewModel</span><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"> <span style="color:red;"><span style="mso-spacerun:yes;">&nbsp;</span>x</span><span style="color:blue;">:</span><span style="color:red;">Key</span><span style="color:blue;">=&quot;TreeListModel&quot; /&gt;</span><span style="color:#a31515;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">common</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">HierarchicalDataTemplate</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> x</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;">Key</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;TreeTemplate&quot;</span><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"> <span style="color:red;"><span style="mso-spacerun:yes;">&nbsp;</span>ItemsSource</span><span style="color:blue;">=&quot;{</span><span style="color:#a31515;">Binding</span><span style="color:red;"> Path</span><span style="color:blue;">=TreeNodeList}&quot;&gt;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-outline-level:1;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">StackPanel</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Orientation</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;Horizontal&quot;&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TextBlock</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Text</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;{</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">Binding</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Id</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot; /&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-outline-level:1;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TextBlock</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Text</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;{</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">Binding</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Name</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot; /&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TextBlock</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Text</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;{</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">Binding</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Count</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot; /&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-outline-level:1;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;/</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">StackPanel</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;/</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">common</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">HierarchicalDataTemplate</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-outline-level:1;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;/</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">ResourceDictionary</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="line-height:115%;font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="line-height:115%;font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;/</span><span style="line-height:115%;font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">UserControl.Resources</span><span style="line-height:115%;font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="line-height:115%;font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">input</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">AutoCompleteBox</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> x</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;">Name</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;acbDomain&quot;</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> ItemsSource</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;{</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">Binding</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Path</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=Model}&quot;</span><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp; </span><span style="color:red;">ValueMemberBinding</span><span style="color:blue;">=&quot;{</span><span style="color:#a31515;">Binding</span><span style="color:red;"> Name</span><span style="color:blue;">}&quot;</span><span style="color:red;"> </span><span style="color:blue;">&gt;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">input</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">AutoCompleteBox.ItemTemplate</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-outline-level:1;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">DataTemplate</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes;">&nbsp;&nbsp;</span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TextBlock</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Text</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;{</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">Binding</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Name</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot;/&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-outline-level:1;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;/</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">DataTemplate</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;/</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">input</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">AutoCompleteBox.ItemTemplate</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-outline-level:1;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;/</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">input</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">AutoCompleteBox</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">Button</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> x</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;">Name</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;btnSetDomain&quot;</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Content</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;Go&quot;</span><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"> <span style="color:red;">Click</span><span style="color:blue;">=&quot;btnSetDomain_Click&quot;</span> <span style="color:blue;"><span style="mso-spacerun:yes;">&nbsp;</span>/&gt;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">controls</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TreeView</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> x</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;">Name</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;treeViewCtrl&quot;</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Style</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;{</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">StaticResource</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> SimpleTreeView</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot;</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> DataContext</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;{</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">StaticResource</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> TreeListModel</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot;</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> ItemsSource</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;{</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">Binding</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Path</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=Model}&quot;</span><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="line-height:115%;font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;">ItemTemplate</span><span style="line-height:115%;font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;{</span><span style="line-height:115%;font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">StaticResource</span><span style="line-height:115%;font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> TreeTemplate</span><span style="line-height:115%;font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot;</span><span style="line-height:115%;font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> </span><span style="line-height:115%;font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">/&gt;</span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="line-height:115%;font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-family:Calibri;font-size:small;">Code Behind &ndash; </span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">private</span><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"> <span style="color:blue;">void</span> btnSetDomain_Click(<span style="color:blue;">object</span> sender, <span style="color:#2b91af;">RoutedEventArgs</span> e)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt 1in;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;color:#2b91af;font-size:10pt;mso-no-proof:yes;">Guid</span><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"> domainId = ((<span style="color:#2b91af;">DomainInfo</span>)acbDomain.SelectedItem).Id; ((<span style="color:#2b91af;">TreeListViewModel</span>)<span style="color:blue;">this</span>.Resources[<span style="color:#a31515;">&quot;TreeListModel&quot;</span>]).GetTreeNodes(domainId);</span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="line-height:115%;font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="line-height:115%;font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-family:Calibri;font-size:small;">Thanks</span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-family:Calibri;font-size:small;">Ranjini</span></p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Wednesday, March 24, 2010</h2><p>If your viewmodel inherits from ViewModel&lt;T&gt; or ViewModelBase&lt;T&gt; (which it doesn&#39;t look like yours does) then you&#39;ll have a Model property that exposes the model for binding to the UI.</p>
<p>And there are protected methods such as OnError() you can override to detect when an error has occurred. In your OnError() override you could just set Model to null, which will blank the UI.</p>
<p>You can do the same thing in your viewmodel class too - it all depends on how you are handling your data access and error/exception handling in your code.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ranjini replied on Thursday, March 25, 2010</h2><p>Thanks much! I was inheriting ViewModel. That was simple! Thanks again.</p>
<p>On separate topic ( I will start a new discussion if I need to), I need to be able to capture fetchcompleted on the UI (through the viewmodel) in order to trigger some events. Is this possible, if so how?</p>
<p>Thanks again</p>
<p>Ranjini</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Thursday, March 25, 2010</h2><p>Override OnModelRefreshed().</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ranjini replied on Thursday, March 25, 2010</h2><p>I was just about to write that I figured it out. I did overide OnModelRefreshed. Thanks again. You have been very helpful.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pooja replied on Friday, June 17, 2011</h2><p>Hey,</p>
<p>I am new in Silverlight.</p>
<p>Can You please explain how to implement OnModelRefreshed method(full code) in view model.</p>
<p>highly thankfull to you.</p>
<p>thanks</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
