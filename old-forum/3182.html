<html><header><title>Validation Rule to check a child collection is populated</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Validation Rule to check a child collection is populated</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3182.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>pfeds posted on Thursday, July 12, 2007</h2><P>Hi, </P>
<P>Firstly sorry if this is a bit of a "noob" post!?</P>
<P>I need to ensure that a child collection has at least one entry.&nbsp; Is it possible to add this as a validation rule in the parent object?&nbsp; </P>
<P>Thanks.&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, July 12, 2007</h2>Yup.&nbsp; Create the rule as you would suspect, and then you'll need to have the parent listen to the child collections ListChanged event.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>renegrin replied on Tuesday, September 11, 2007</h2><P>How would you have the parent listen to the events?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Marjon1 replied on Tuesday, September 11, 2007</h2><font face="Arial" size="2">To listen to events you would do the following; note the extra WithEvents as part of the variable declaration:<br><br><font color="#0000ff">Private WithEvents</font><span> _LineItems </span><font color="#0000ff">As</font><span> ChildList = ChildList.NewList()</span><br><font color="#0000ff"><br>Public ReadOnly</font><span> <span>Property </span>ChildListProperty() </span><font color="#0000ff">As</font><span> ChildList</span><br><span>&nbsp; </span><font color="#0000ff">Get</font><br><span>&nbsp;&nbsp;&nbsp; </span><font color="#0000ff">Return </font><span>_ListItems</span><br><span>&nbsp; </span><font color="#0000ff">End Get</font><br><br></font><br><font face="Arial" size="2"><font color="#0000ff">Public Sub </font>ListChanged_Method(<font color="#0000ff">ByVal </font>sender <font color="#0000ff">As Object</font>, <font color="#0000ff">ByVal </font>e <font color="#0000ff">As </font>System.ComponentModel.ListChangedEventArgs) <font color="#0000ff">Handles </font>_LineItems.ListChanged</font><br><font size="2">&nbsp;&nbsp;&nbsp; PropertyHasChanged("ChildListProperty")</font><br><font face="Arial" size="2"><font color="#0000ff">End Sub</font></font><br><font face="Arial" size="2"><br></font></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
