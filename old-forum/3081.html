<html><header><title>NVL's not Refreshing</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>NVL's not Refreshing</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3081.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Sarosh posted on Monday, June 25, 2007</h2><P>Hi!</P>
<P>I am currently using CSLA 2.14</P>
<P>I have&nbsp;a DataGridView (in a Winform) with a few ComboBox Columns&nbsp;each bound to a BindingSource&nbsp;which in turn is bound to a NVL BO. In the Form's Load event I have call the RefreshLookups() method on the form which loads all the date from lookup</P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>private</FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2><FONT color=#000000> RefreshLookups()</FONT></P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.ScheduleNVL = </FONT><FONT color=#2b91af size=2>ScheduleNVL</FONT><FONT size=2>.GetScheduleNVL();</P>
<P></FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.schedulebindingSource.DataSource = </FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.ScheduleNVL;</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.DesignAreaNVL = </FONT><FONT color=#2b91af size=2>DesignAreaNVL</FONT><FONT size=2>.GetDesignAreaNVL();</P>
<P></FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.designAreabindingSource.DataSource = </FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>._DesignAreaNVL;</P>
<P></FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.LoadTypeNVL = </FONT><FONT color=#2b91af size=2>LoadTypeNVL</FONT><FONT size=2>.GetLoadTypeNVL();</P>
<P></FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.loadTypebindingSource.DataSource = </FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>._LoadTypeNVL;</P></FONT><FONT size=2>
<P>}</P>
<P></FONT></FONT>All the ComboBox Columns&nbsp;show the correct values from their respective BO's/Lookup tables, while this main form is open the same user can open one or more&nbsp;lookup maintenance forms and add new rows, change descriptions etc. After saving these changes in the lookup forms when they activate the main form the DropDown Combo's don't show the changes which I guess is normal but they can click on a refresh button on the main form which calls the RefreshLookups() method but even after that the DropDown's don't get the new/changed values.</P>
<P>When I look at the NVL BO's even they are not getting the new values so I guess there is some caching going on some where and I am not sure how to refresh the BO's.</P>
<P>Thanks</P>
<P>Sarosh</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dcleven replied on Monday, June 25, 2007</h2><P><FONT face=Arial>If the NVL BO do not have the new values then you must be using a cached NVL. Check the NVL GetList() method to see if it is checking for a cached list member and avoiding the creation of a new list.</FONT></P>
<P><FONT face=Arial>--Doug</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Sarosh replied on Monday, June 25, 2007</h2><P>Hi!</P>
<P>How do I check that?</P>
<P>Is there a property on the NVL BO to specify whether or not you want caching?</P>
<P>I am using the default CSLA NVL Objects.</P>
<P>Sarosh</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dcleven replied on Monday, June 25, 2007</h2><P><FONT face=Arial>Just look at the source code for your GetList() method which you have to implement, it is not part of the CSLA, but a pattern that many use when implementing the derived NVL class.</FONT></P>
<P><FONT face=Arial>Here is an example that implements the caching pattern.</FONT></P>
<P><FONT face="Courier New">public static MyList GetList()</FONT></P>
<P><FONT face="Courier New">{</FONT></P>
<P>&nbsp;&nbsp;&nbsp;<FONT face="Courier New">if (m_cachedList == null)</FONT></P>
<P>&nbsp;&nbsp;&nbsp;<FONT face="Courier New">{</FONT></P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT face="Courier New">m_cachedList = DataPortal.Fetch&lt;MyList&gt;(new Criteria());</FONT></P>
<P>&nbsp;&nbsp;&nbsp;<FONT face="Courier New">}</FONT></P>
<P>&nbsp;&nbsp;&nbsp;<FONT face="Courier New">return m_cachedList;</FONT></P>
<P><FONT face="Courier New">}</FONT></P><FONT size=2>
<P></FONT><FONT face="Courier New" size=1></FONT><FONT size=2>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Sarosh replied on Monday, June 25, 2007</h2><P>Hi!</P>
<P>You were right on the money!</P>
<P>I did generate my BO's using templates and did not realise that they were being cached.</P>
<P>Thanks a lot for your help.</P>
<P>Sarosh</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
