<html><header><title>DataPortal.Fetch failed (There is already an open DataReader associated with this Command which must be closed first.)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>DataPortal.Fetch failed (There is already an open DataReader associated with this Command which must be closed first.)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7780.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ludwigs3rd posted on Tuesday, October 13, 2009</h2>This happens whenever the client crashes (test case) and using WCFHost setup like in PTracker. I've implemented Dispose() in the DAL like in Rocky's C# 2008 BO page 550  but that doesn't seem to fix the issue. The only way I can get around this issue is by restarting the server hosting the WCFHost. I appreciate any suggestions anyone can offer.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, October 13, 2009</h2><P>You are saying that a db connection on the <EM>application server</EM> is being left open (or something) because the <EM>client crashed</EM>? So the client crash is echoing through the WCF connection to the server or something?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ludwigs3rd replied on Wednesday, October 14, 2009</h2>I may have worded that incorrectly. So we are purposefully creating a condition on the client where the DAL throws an exception. But looking at the code, since the SafeDataFeader is thrown back to the parent object (from the DAL to populate the fields/properties) I guess I should be explicitly closing it? I didn't see an example showing that in the book (maybe I missed it). Is explicitly closing the SafeDataReader recommended or necessary?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>whelzer replied on Wednesday, October 14, 2009</h2>You can use ;MultipleActiveResultSets=True" in you connection string<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ludwigs3rd replied on Wednesday, October 14, 2009</h2>Interesting, that worked like a charm. Thanks for your suggestion! Should I still be explicitly closing the DataReader?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, October 14, 2009</h2><P>Yes.</P>
<P>If dr IsNot Nothing Then dr.Close<BR>If cnn IsNot Nothing Then cnn.Close</P>
<P>Joe</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
