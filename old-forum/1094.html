<html><header><title>A CSLA bug or I missed something?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>A CSLA bug or I missed something?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1094.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Tian posted on Thursday, August 31, 2006</h2><P>Hi, All.</P>
<P>In my base object, I have start date and&nbsp;end date propery. </P><FONT color=#0000ff size=2>
<P>private</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>SmartDate</FONT><FONT size=2> _startDate = </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>SmartDate</FONT><FONT size=2>(</FONT><FONT color=#800000 size=2>""</FONT><FONT size=2>,</FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2> ) ;<BR></FONT><FONT color=#0000ff size=2>private</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>SmartDate</FONT><FONT size=2> _enddate = </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>SmartDate</FONT><FONT size=2>(</FONT><FONT color=#800000 size=2>""</FONT><FONT size=2>,</FONT><FONT color=#0000ff size=2>false</FONT><FONT size=2> );</FONT></P><FONT size=2><FONT color=#0000ff size=2>
<P>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> StartDate <BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>get<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>{&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CanReadProperty(</FONT><FONT color=#800000 size=2>"StartDate"</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> _startDate.Text;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>set<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CanWriteProperty(</FONT><FONT color=#800000 size=2>"StartDate"</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (!_startDate.Equals(</FONT><FONT color=#0000ff size=2>value</FONT><FONT size=2>))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_startDate.Text = </FONT><FONT color=#0000ff size=2>value</FONT><FONT size=2>;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PropertyHasChanged(</FONT><FONT color=#800000 size=2>"StartDate"</FONT><FONT size=2>);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>}</FONT></P>
<P><FONT size=2>EndDate property is&nbsp;similiar as StarDate property and I won't repeat here.</P></FONT>
<P></FONT>I set&nbsp;the validation rule to force the&nbsp;end date is greater the&nbsp;start date.<FONT size=2></P>
<P>ValidationRules.AddRule(</FONT><FONT color=#008080 size=2>CommonRules</FONT><FONT size=2>.StringRequired, </FONT><FONT color=#800000 size=2>"StartDate")</FONT><FONT size=2>;<BR>ValidationRules.AddRule(</FONT><FONT color=#008080 size=2>CommonRules</FONT><FONT size=2>.StringRequired, </FONT><FONT color=#800000 size=2>"EndDate"</FONT><FONT size=2>);</FONT></P><FONT size=2><FONT size=2><FONT size=2>
<P>ValidationRules.AddRule(BeginDateGTEndDate, </FONT><FONT color=#800000 size=2>"StartDate"</FONT><FONT size=2>);<BR></FONT><FONT size=2>ValidationRules.AddRule(BeginDateGTEndDate, </FONT><FONT color=#800000 size=2>"EndDate"</FONT><FONT size=2>);</P>
<P></FONT></FONT><FONT size=2>the function BeginDateGTEndDate to return bool value <BR></FONT><FONT color=#0000ff size=2>private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>bool</FONT><FONT size=2> BeginDateGTEndDate( </FONT><FONT color=#008080 size=2>Object</FONT><FONT size=2> target , Csla.Validation.</FONT><FONT color=#008080 size=2>RuleArgs</FONT><FONT size=2> e) <BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (_startDate &gt; _enddate)&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.Description = </FONT><FONT color=#800000 size=2>"Beginning Date is greater than End Date"</FONT><FONT size=2>;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>false</FONT><FONT size=2>;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2> ;<BR>}</FONT></P>
<P>For example, the startDate is 8/16/2006. EndDate is 8/20/2006. it is fine and will be saved. If I modified endDate to 8/15/2006 and still keep the old start date, it will failed as it should be.&nbsp; If I changed start date to any date earlier than 8/15/2006. for example, 8/10/2006, it will be failed(in this case, I modify both start date and end date). Why? it should be ok because&nbsp; 8/10/2006 &lt; 8/15/2006, and the function&nbsp; BeginDateGTEndDate return true. I tracked the code and find base.IsValid = false.&nbsp; I already modified the date and start date is less than end date. so, I find if I modified both properties and even&nbsp;&nbsp;BeginDateGTEndDate( ) return true,&nbsp; the object could not be saved.</P>
<P>&nbsp;If I modified on side, it will be ok. for example, the startDate is 8/16/2006. EndDate is 8/20/2006. it is fine and will be saved. if I modified end date to 8/5/2006, it will be failed as it should be. if&nbsp;I modified end date back to any date greater than start date (in the case, start date doesn't changed at all, still is 8/16/206). it will be ok and be saved.&nbsp; </P>
<P>Why I can not modify both property? Did I miss something or this is a CLAS bug?</P>
<P>Thanks for help</P>
<P>Brian </P>
<P>&nbsp;</P>
<P><FONT size=2>&nbsp;</P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, August 31, 2006</h2>It seems whats happening is this;<br><br>You have two broken rules indicating that the startdate is after the end date.&nbsp; On of the broken rules is for StartDate, the other for Enddate.&nbsp; The problem is that your property setter is only causing one of those rules to be rechecked and removed; the other remains.<br><br>The solution depends on which version of Csla you're using; if its the new 2.1 beta refresh, you can use the AddDependantProperty method, which will cause both properties to be checked. <br><br>Alternately (if you're using 2.0.3) you'll need to call ValidationRules.CheckRules( "StartDate" ) in your EndDate setter, and do the reverse in the setter for StartDate.<br><br>HTH<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Tian replied on Thursday, August 31, 2006</h2><P>Andy,</P>
<P>Thank you, I'm use (CSLA 2.03). I did what you told me but I still have the same problem. At least, I know what kind of the problem it is.</P>
<P>Thank you very much and have a great one.</P>
<P>Brian </P>
<P><FONT color=#000000 size=2> The code snippet like this</FONT></P>
<P>public<FONT size=2> </FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> StartDate <BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>get<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>{&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CanReadProperty(</FONT><FONT color=#800000 size=2>"StartDate"</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> _startDate.Text;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>set<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CanWriteProperty(</FONT><FONT color=#800000 size=2>"StartDate"</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT color=#ff0000>&nbsp;&nbsp;</FONT></FONT><FONT size=2><FONT color=#ff0000><FONT size=2>ValidationRules.CheckRules(</FONT><FONT size=2>"EndDate"</FONT><FONT size=2>);</FONT><BR></FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (!_startDate.Equals(</FONT><FONT color=#0000ff size=2>value</FONT><FONT size=2>))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_startDate.Text = </FONT><FONT color=#0000ff size=2>value</FONT><FONT size=2>;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PropertyHasChanged(</FONT><FONT color=#800000 size=2>"StartDate"</FONT><FONT size=2>);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>}</FONT></P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> EndDate<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>get<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CanReadProperty(</FONT><FONT color=#800000 size=2>"EndDate"</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> _enddate.Text;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>set<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CanWriteProperty(</FONT><FONT color=#800000 size=2>"EndDate"</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT color=#000000>&nbsp;</FONT><FONT color=#ff0000>&nbsp;&nbsp;&nbsp;ValidationRules.CheckRules(</FONT></FONT><FONT color=#ff0000 size=2>"StartDate"</FONT><FONT size=2><FONT color=#ff0000>);<BR></FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (!_enddate.Equals(</FONT><FONT color=#0000ff size=2>value</FONT><FONT size=2>))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_enddate.Text = </FONT><FONT color=#0000ff size=2>value</FONT><FONT size=2>;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PropertyHasChanged(</FONT><FONT color=#800000 size=2>"EndDate"</FONT><FONT size=2>);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>}</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DesNolan replied on Thursday, August 31, 2006</h2>Not too familar with the use of&nbsp;<font size="2"><font color="#ff0000"> ValidationRules.CheckRules...</font></font><font size="2"><font color="#ff0000"><br></font>&nbsp; <br>
but it appears you may&nbsp; not be doing it at the end o the setter as
previously advised, you're calling the check rules before you set&nbsp;
the value, try<br>
</font><br>
<p>public<font size="2"> </font><font color="#0000ff" size="2">string</font><font size="2"> StartDate <br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000ff" size="2">get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font size="2">{&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CanReadProperty(</font><font color="#800000" size="2">"StartDate"</font><font size="2">, </font><font color="#0000ff" size="2">true</font><font size="2">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000ff" size="2">return</font><font size="2"> _startDate.Text;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000ff" size="2">set<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font size="2">{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CanWriteProperty(</font><font color="#800000" size="2">"StartDate"</font><font size="2">, </font><font color="#0000ff" size="2">true</font><font size="2">);<br></font><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#0000ff" size="2">if</font><font size="2"> (!_startDate.Equals(</font><font color="#0000ff" size="2">value</font><font size="2">))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_startDate.Text = </font><font color="#0000ff" size="2">value</font><font size="2">;<br>
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff0000">&nbsp; </font></font><font size="2"><font color="#ff0000"><font size="2">ValidationRules.CheckRules(</font><font size="2">"EndDate"</font><font size="2">);</font><br></font></font><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged(</font><font color="#800000" size="2">"StartDate"</font><font size="2">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br>
</font></p>
<p><font size="2">OR EVEN<br>
</font></p>
<font size="2">
</font>
<p><font color="#0000ff" size="2">public</font><font size="2"> </font><font color="#0000ff" size="2">string</font><font size="2"> EndDate<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000ff" size="2">get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font size="2">{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CanReadProperty(</font><font color="#800000" size="2">"EndDate"</font><font size="2">, </font><font color="#0000ff" size="2">true</font><font size="2">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000ff" size="2">return</font><font size="2"> _enddate.Text;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000ff" size="2">set<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font size="2">{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CanWriteProperty(</font><font color="#800000" size="2">"EndDate"</font><font size="2">, </font><font color="#0000ff" size="2">true</font><font size="2">);<br></font><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#0000ff" size="2">if</font><font size="2"> (!_enddate.Equals(</font><font color="#0000ff" size="2">value</font><font size="2">))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_enddate.Text
= </font><font color="#0000ff" size="2">value</font><font size="2">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PropertyHasChanged(</font><font color="#800000" size="2">"EndDate"</font><font size="2">);<br></font><font size="2">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">&nbsp;</font><font color="#ff0000">&nbsp;&nbsp; ValidationRules.CheckRules(</font></font><font color="#ff0000" size="2">"StartDate"</font><font size="2"><font color="#ff0000">);<br></font></font><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br></font><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>}<br>
</font></p>
<p><font size="2">Cheers,<br>
</font></p>
<p><font size="2">Des Nolan<br>
</font></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Friday, September 01, 2006</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>DesNolan:</strong></div><div>Not too familar with the use of&nbsp;<font size="2"><font color="#ff0000"> ValidationRules.CheckRules...</font></font><font size="2"><font color="#ff0000"><br></font>&nbsp; <br>
but it appears you may&nbsp; not be doing it at the end o the setter as
previously advised, you're calling the check rules before you set&nbsp;
the value, try<br>
</font><br>
<p>public<font size="2"> </font><font color="#0000ff" size="2">string</font><font size="2"> StartDate <br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000ff" size="2">get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font size="2">{&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CanReadProperty(</font><font color="#800000" size="2">"StartDate"</font><font size="2">, </font><font color="#0000ff" size="2">true</font><font size="2">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000ff" size="2">return</font><font size="2"> _startDate.Text;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000ff" size="2">set<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font size="2">{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CanWriteProperty(</font><font color="#800000" size="2">"StartDate"</font><font size="2">, </font><font color="#0000ff" size="2">true</font><font size="2">);<br></font><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#0000ff" size="2">if</font><font size="2"> (!_startDate.Equals(</font><font color="#0000ff" size="2">value</font><font size="2">))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_startDate.Text = </font><font color="#0000ff" size="2">value</font><font size="2">;<br>
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff0000">&nbsp; </font></font><font size="2"><font color="#ff0000"><font size="2">ValidationRules.CheckRules(</font><font size="2">"EndDate"</font><font size="2">);</font><br></font></font><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged(</font><font color="#800000" size="2">"StartDate"</font><font size="2">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br>
</font></p>
<p><font size="2">OR EVEN<br>
</font></p>
<font size="2">
</font>
<p><font color="#0000ff" size="2">public</font><font size="2"> </font><font color="#0000ff" size="2">string</font><font size="2"> EndDate<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000ff" size="2">get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font size="2">{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CanReadProperty(</font><font color="#800000" size="2">"EndDate"</font><font size="2">, </font><font color="#0000ff" size="2">true</font><font size="2">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000ff" size="2">return</font><font size="2"> _enddate.Text;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000ff" size="2">set<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font size="2">{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CanWriteProperty(</font><font color="#800000" size="2">"EndDate"</font><font size="2">, </font><font color="#0000ff" size="2">true</font><font size="2">);<br></font><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#0000ff" size="2">if</font><font size="2"> (!_enddate.Equals(</font><font color="#0000ff" size="2">value</font><font size="2">))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_enddate.Text
= </font><font color="#0000ff" size="2">value</font><font size="2">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PropertyHasChanged(</font><font color="#800000" size="2">"EndDate"</font><font size="2">);<br></font><font size="2">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">&nbsp;</font><font color="#ff0000">&nbsp;&nbsp; ValidationRules.CheckRules(</font></font><font color="#ff0000" size="2">"StartDate"</font><font size="2"><font color="#ff0000">);<br></font></font><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br></font><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>}<br>
</font></p>
<p><font size="2">Cheers,<br>
</font></p>
<p><font size="2">Des Nolan<br>
</font></p></div></BLOCKQUOTE><br><br>You do it the other way because the validation check has to come before the PropertyChanged event raised by PropertyHasChanged().<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Tian replied on Friday, September 01, 2006</h2><P>&nbsp;</P>
<P>It works now.&nbsp; :-)</P>
<P>Thanks for you guys&nbsp;help.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Sunday, September 03, 2006</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>Brian Criswell:</strong></div><div><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>DesNolan:</strong></div><div>Not too familar with the use of&nbsp;<font size="2"><font color="#ff0000"> ValidationRules.CheckRules...</font></font><font size="2"><font color="#ff0000"><br></font>&nbsp; <br>
but it appears you may&nbsp; not be doing it at the end o the setter as
previously advised, you're calling the check rules before you set&nbsp;
the value, try<br>
</font><br>
<p>public<font size="2"> </font><font color="#0000ff" size="2">string</font><font size="2"> StartDate <br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000ff" size="2">get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font size="2">{&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CanReadProperty(</font><font color="#800000" size="2">"StartDate"</font><font size="2">, </font><font color="#0000ff" size="2">true</font><font size="2">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000ff" size="2">return</font><font size="2"> _startDate.Text;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000ff" size="2">set<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font size="2">{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CanWriteProperty(</font><font color="#800000" size="2">"StartDate"</font><font size="2">, </font><font color="#0000ff" size="2">true</font><font size="2">);<br></font><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#0000ff" size="2">if</font><font size="2"> (!_startDate.Equals(</font><font color="#0000ff" size="2">value</font><font size="2">))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_startDate.Text = </font><font color="#0000ff" size="2">value</font><font size="2">;<br>
&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff0000">&nbsp; </font></font><font size="2"><font color="#ff0000"><font size="2">ValidationRules.CheckRules(</font><font size="2">"EndDate"</font><font size="2">);</font><br></font></font><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged(</font><font color="#800000" size="2">"StartDate"</font><font size="2">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>}<br>
</font></p>
<p><font size="2">OR EVEN<br>
</font></p>
<font size="2">
</font>
<p><font color="#0000ff" size="2">public</font><font size="2"> </font><font color="#0000ff" size="2">string</font><font size="2"> EndDate<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000ff" size="2">get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font size="2">{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CanReadProperty(</font><font color="#800000" size="2">"EndDate"</font><font size="2">, </font><font color="#0000ff" size="2">true</font><font size="2">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000ff" size="2">return</font><font size="2"> _enddate.Text;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000ff" size="2">set<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font size="2">{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CanWriteProperty(</font><font color="#800000" size="2">"EndDate"</font><font size="2">, </font><font color="#0000ff" size="2">true</font><font size="2">);<br></font><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#0000ff" size="2">if</font><font size="2"> (!_enddate.Equals(</font><font color="#0000ff" size="2">value</font><font size="2">))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_enddate.Text
= </font><font color="#0000ff" size="2">value</font><font size="2">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PropertyHasChanged(</font><font color="#800000" size="2">"EndDate"</font><font size="2">);<br></font><font size="2">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">&nbsp;</font><font color="#ff0000">&nbsp;&nbsp; ValidationRules.CheckRules(</font></font><font color="#ff0000" size="2">"StartDate"</font><font size="2"><font color="#ff0000">);<br></font></font><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br></font><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>}<br>
</font></p>
<p><font size="2">Cheers,<br>
</font></p>
<p><font size="2">Des Nolan<br>
</font></p></div></BLOCKQUOTE><br><br>You do it the other way because the validation check has to come before the PropertyChanged event raised by PropertyHasChanged().<br></div></BLOCKQUOTE><br><br>Sorry, I meant that the first one is the one I would choose so that _endDate has the correct value and the rule check is made before the PropertyChangedEvent.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
