<html><header><title>Trying to Start Simple</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Trying to Start Simple</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2999.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>SimpleCSLA posted on Thursday, June 07, 2007</h2>It took over two weeks, but I've finally gotten remoting to work and gotten Project Tracker to work - during much ridicule of my fellow programmers at my job.&nbsp; To get started in anything I personally need to start simple and work my way up to the more complicated.<br><br>So now I'm reading carefully through the book to write a very simple class that will get data through a StoredProcedure.&nbsp; However, every example in the book seems to rely on another object (projectList.vb relies on Project.vb / RoleList relies on Role).&nbsp; I can't seem to find an example of one class returning a value that doesn't rely on another class.<br><br><i>Here's a recommendation for Rocky's next book:</i> Put in a "Getting Started" chapter, which ignores the MasterWebPage and Themes, and walks the user through creating three simple classes (one that reads values from a table, one that updates that data and one that inserts data).&nbsp; Then write one ASPX page that uses each of those three classes.&nbsp; Once we're done with the "Getting Started" chapter, lead us into the child objects.<br><br>I would GREATLY appreciate it if someone could tell me where my code is
wrong below (wrong because i can't seem to call it from an aspx page
and returned the values).<br><br>
Also, if anyone has some simple classes written in VB they'd like to share, that would be very helpful - or even tell me a page # of the book.&nbsp; On on page 542 (no I didn't fully read the first 541 pages, most of it is WAYYY over my head) and while Project Tracker works perfectly, the CSLA Data Source tool is not showing in my Toolbox (so that would also be great if someone could tell me how to get that to show up).&nbsp; <br><br>&lt;Serializable()&gt; _<br>&nbsp;&nbsp;&nbsp; Public Class <b>Test</b><br>&nbsp;&nbsp;&nbsp; Inherits Csla.NameValueListBase(Of Integer, String)<br><br>#Region " Business Methods "<br><br>&nbsp;&nbsp;&nbsp; Public Shared Function UserList() As Integer<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim list As Test = GetList()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If list.Count &gt; 0 Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return list.Items(0).Key<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br><br>&nbsp;&nbsp;&nbsp; End Function<br><br>#End Region<br><br>#Region " Factory Methods "<br><br>&nbsp;&nbsp;&nbsp; Private Shared mList As Test<br><br>&nbsp;&nbsp;&nbsp; Public Shared Function GetList() As Test<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If mList Is Nothing Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mList = DataPortal.Fetch(Of Test) _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (New Criteria(GetType(Test)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return mList<br><br>&nbsp;&nbsp;&nbsp; End Function<br><br>&nbsp;&nbsp;&nbsp; Public Shared Sub InvalidateCache()<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mList = Nothing<br><br>&nbsp;&nbsp;&nbsp; End Sub<br><br>&nbsp;&nbsp;&nbsp; Private Sub New()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' require use of factory methods<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>#End Region<br>#Region " Data Access "<br><br>&nbsp;&nbsp;&nbsp; Private Overloads Sub DataPortal_Fetch(ByVal criteria As Criteria)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.RaiseListChangedEvents = False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Using cn As New SqlConnection(Database.TestConnection)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cn.Open()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Using cm As SqlCommand = cn.CreateCommand<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cm.CommandType = CommandType.StoredProcedure<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cm.CommandText = "getUserList"<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Using dr As New SafeDataReader(cm.ExecuteReader)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsReadOnly = False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; With dr<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; While .Read()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.Add(New NameValuePair( _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .GetInt32("UserID"), .GetString("UserName")))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End While<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End With<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsReadOnly = True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Using<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Using<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Using<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.RaiseListChangedEvents = True<br><br>&nbsp;&nbsp;&nbsp; End Sub<br><br>#End Region<br><br>End Class<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, June 07, 2007</h2><P>A couple of things.</P>
<P>First, you have over<EM>loads</EM> instead of over<EM>rides</EM> for your DataPortal_Fetch.&nbsp; This is why things aren't working as you expect.&nbsp; Its a shame VB.Net makes you use a keyword to overload a function, especially with the overrides keyword..</P>
<P>Second, you can simplify the DP.F call to this:</P>
<P>mList = DataPortal.Fetch(Of Test) ()</P>
<P>If&nbsp;you simpifly like above, you would declare the DataPortal_Fetch as such:</P>
<P>Private Sub DataPortal_Fetch() </P>
<P>End Sub</P>
<P>HTH</P>
<P>Andy</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mr_lasseter replied on Thursday, June 07, 2007</h2><P>Every example in the book does not depend on another object.&nbsp; The ProjectList depends on the ProjectInfo class. The Project Class does not depend on any other classes, except for the Project Resources class, which you don't have to implement if you want one simple class.&nbsp; You should be able to use it as an example of how to get it to work.&nbsp; As for your code below are you getting any errors or is it just not loading the data?&nbsp; Have you stepped through the code using the debugger to see what is going on?</P>
<P>To get the CslaDataSource in the toolbox do the following:</P>
<P>Right click in the toolbox and select Choose Items.<BR>When the Choose toolbox Items window appears click browse.&nbsp; Find the Csla.dll on your machine and select it. <BR>Click ok and the items will be added to the toolbox.&nbsp; </P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
