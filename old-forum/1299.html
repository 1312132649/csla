<html><header><title>Stack overflow</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Stack overflow</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1299.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Thursday, September 21, 2006</h2>Ok, I've overriden methods to prevent adding or removing (or setting via indexer) objects in a BuisnessListBase. <br><br>Of course, when loading the list, I got an exception.&nbsp; Not suprising.&nbsp; So I added a private IsLoading flag, much like IsReadOnly on ReadOnlyListBase.<br><br>I'm hitting a weird problem now..<br><br>Here's the load method<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff"> private void</font> LoadSelf( <font color="#008000">PriceList </font>priceList ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#008000">List</font>&lt;Data.Quoting.<font color="#008000">ProductPrice</font>&gt; results;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Data.<font color="#008000">DataSearcher</font>&lt;Data.Quoting.<font color="#008000">ProductPrice</font>&gt; searcher;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Data.<font color="#008000">SelectionCriteria</font> crit;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; crit = <font color="#0000ff">new </font>Data.<font color="#008000">SelectionCriteria</font>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#ff0000">"PriceListId"</font>, Data.<font color="#008000">Operator</font>.Equals );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; crit.Values.Add( priceList.PriceListId );<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; searcher = <font color="#0000ff">new </font>Data.<font color="#008000">DataSearcher</font>&lt;Data.Quoting.<font color="#008000">ProductPrice</font>&gt;();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; searcher.AddSelectionCriteria( crit );<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; results = searcher.Find();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsLoading = <font color="#0000ff">true</font>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000ff">foreach </font>( Data.Quoting.<font color="#008000">ProductPrice</font> price <font color="#0000ff">in</font> results ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add( <font color="#008000">ProductPrice</font>.<font color="#000000">GetProductPrice</font>( price ) );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsLoading = <font color="#0000ff">false</font>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>And here's the InsertItem override (which is apparently fired by the call to Add):<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000ff">protected override</font> <font color="#0000ff">void </font>InsertItem( <font color="#0000ff">int </font>index, <font color="#008000">ProductPrice </font>item ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000ff">if </font>( IsLoading ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000ff">base</font>.Insert( index, item );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000ff">else </font>{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000ff">throw new</font> <font color="#008000">NotSupportedException</font>( <font color="#ff0000">"Price cannot be inserted."</font> );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>This bombs with a StackOverflowException.&nbsp; For some reason, base.Insert is causing a problem.&nbsp; I press F11 to 'step into' the code, which should lead me to the Csla BusinessListBase.InsertItem method, but for some reason that doesn't happen, and the cursor appears right back on base.Insert.&nbsp; It seems like instead of calling base, its calling this. <br><br>Any ideas?<br>Thanks<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, September 21, 2006</h2>Opps, nevermind!<br><br>I had Insert instead of InsertItem... doh!<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
