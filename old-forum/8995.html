<html><header><title>Interdependent properties csla 4.0</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Interdependent properties csla 4.0</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8995.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Natasha posted on Wednesday, May 26, 2010</h2><p>Hello, Rocky! </p>
<p>Could &nbsp;you answer my question about Interdependent properties. We have trouble with &quot;AddDependent Property&quot;. Is it exist in CSLA.NET 4.0 version? Was it changed or removed?</p>
<p>Natasha.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Wednesday, May 26, 2010</h2><p>It is removed. Rules now have the concept of an &quot;affected property&quot; that provides similar functionality. A rule is attached to one primary property, but when that rule is complete, all rules for any affected properties are then executed.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pneurohr replied on Thursday, June 03, 2010</h2><p>How do you add Properties to the AffectedProperties collection on the rule?&nbsp; I only see a getter and no accessor.</p>
<p>&nbsp;</p>
<p>Thanks,</p>
<p>Peter</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Thursday, June 03, 2010</h2><p>You use the Add() method on the collection:</p>
<p>AffectedProperties.Add(YourProperty);</p>
<p>See the last class in this file:</p>
<p><a href="http://www.lhotka.net/cslacvs/viewvc.cgi/core/trunk/Source/Csla.test/ValidationRules/ValidationTests.cs?view=markup">http://www.lhotka.net/cslacvs/viewvc.cgi/core/trunk/Source/Csla.test/ValidationRules/ValidationTests.cs?view=markup</a></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pneurohr replied on Friday, June 04, 2010</h2><p>I was trying to do it as part of the call to add rule.&nbsp; The property needs to be placed in to the constructor.&nbsp; </p>
<p>I have another question though.&nbsp; When I try to use context.AddOutValue to&nbsp;modify another property on the business object, an exception is thrown since the property is not in the affected properties collection.&nbsp; I thought that collection was used to fire related rules not list the properties that can be changed.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, June 04, 2010</h2><p>It is used for both.</p>
<p>If your rule changes a value, it is important to trigger the rules for that output property, otherwise you end up with a rule on PropertyA putting what is effectively an invalid value into PropertyB, and nobody would know.</p>
<p>Forcing out values to be in the affected property list ensures you can&#39;t get into that hard-to-debug situation.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pneurohr replied on Monday, June 07, 2010</h2><p>Hopefully I have one final question.&nbsp; I am trying to write a rule that runs async but it uses a property in a child business object for both input and output.&nbsp; I can&#39;t seem to get it work correctly.&nbsp;I tried making the backing field internal and passing that into the rule constructor but it resulted in a strange type mismatch when the SetOutValue was called.&nbsp; Is there anything else I should try?</p>
<p>&nbsp;</p>
<p>Thanks</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, June 07, 2010</h2><p>Unfortunately that&#39;s not a supported scenario. That would require inventing some string-based binding syntax to describe a path through the object graph, and incurs a bunch of risk around the child object moving while the rule was running (if you added/removed other items in a list, etc) - so it would also require some external object identity marker for all objects (like a Guid). In short, it gets very complex very fast.</p>
<p>The answer is to either put the property on your parent object, or put the rule in the child object and have the parent invoke a method on the child that runs the rule.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
