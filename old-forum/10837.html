<html><header><title>CSLA 4.x data virtualization to suport modern UI components?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA 4.x data virtualization to suport modern UI components?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10837.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>JCardina posted on Tuesday, November 01, 2011</h2><p>I&#39;m trying to match up the Telerik WPF GridView component to my CSLA business object lists.</p>
<p>They suggest binding to a LINQ source using their VirtualQueryableCollectionView object which essentially takes the users filtering and sorting and paging choices in the grid and creates a LINQ query which, if the back end was LINQ based, would issue the query to the sql server I guess automatically to cut down on the data transferred.</p>
<p>I think they assume that the back end is a LINQ to SQL or Entity Framework or something, they refer to it as binding the grid to a &quot;LINQ context&quot;.&nbsp; </p>
<p>I&#39;m confused about this or how to support it in CSLA.&nbsp; I&#39;m using the grid with read only business object collections and normally I do not use LINQ to SQL or EF or anything like that.&nbsp; I use and require encapsulated DAL for performance. </p>
<p>I&#39;m&nbsp; lost on this at the moment.&nbsp; Any theories or ideas or suggestions to get me looking in the right direction would be highly appreciated.</p>
<p>Is the world moving this way and I need to suck it up and use LINQ to SQL or something to take advantage of new UI components and just accept a loss of performance or is there some way to take advantage of it just for this scenario exactly in a small way or...?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Curelom replied on Tuesday, November 01, 2011</h2><p>There are samples(that can be&nbsp;downloaded with CSLA itslef)&nbsp;and ebooks at the store&nbsp;for using linq to sql and/or Entity Framework within CSLA.</p>
<p>This does bring up a question about the direction of the next version of Asp.net where Microsoft looks like it is moving toward using IQueryable as detailed in Scott Guthrie&#39;s blog&nbsp; <a href="http://weblogs.asp.net/scottgu/archive/2011/09/05/web-forms-model-binding-part-1-selecting-data-asp-net-vnext-series.aspx">http://weblogs.asp.net/scottgu/archive/2011/09/05/web-forms-model-binding-part-1-selecting-data-asp-net-vnext-series.aspx</a></p>
<p>Will CSLA be able to take advantage of this or would we be accessing CSLA the same way we do today?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JCardina replied on Tuesday, November 01, 2011</h2><p>There are a *lot* of people complaining about the performance and amount of code you have to still write for entity framework.&nbsp; </p>
<p>It scares me off it completely for my application.</p>
<p>I think I need to roll my own solution still, there is just nothing as fast as direct queries from the business objects themselves in an encapsulated scenario.</p>
<p>Maybe&nbsp; I should look into implementing an IQueryable interface in by business collection objects that would work through to the db.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Curelom replied on Tuesday, November 01, 2011</h2><p>Thanks Johnny</p>
<p>&nbsp;</p>
<p>JCardina,</p>
<p>I don&#39;t think I&#39;ve experience having to write more code with EF than ADO.NET.&nbsp; As far as performance is concerned, I am pretty sure I could write more efficient queries than EF, but the performance hasn&#39;t been bad.&nbsp; I believe you could also mix the two, using direct queries where speed is crucial.&nbsp; </p>
<p>Back to the Telerik Grid, I&#39;ve been using Telerik for a couple years now, I don&#39;t see how you load the data into your CSLA Business Objects matters at all to the Grid.&nbsp; I&#39;ve bound&nbsp;business lists to the grid in all sorts of ways, including&nbsp;directly to the ItemsSource, through a CollectionViewSource&nbsp;bound to the ItemsSource or IEnumerable results from business lists to the grid without any issues.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JCardina replied on Tuesday, November 01, 2011</h2><p>Curelom, EF seems adequate for trivial applications, it seems like a huge mistake for any application of a large size and complexity with a huge database behind it.</p>
<p>A common complaint I came across about EF is that if you want any kind of performance anywhere you have to hand tweak.&nbsp; I&#39;m not willing to accept sub par performance in my application because my users&#39; aren&#39;t.&nbsp; I&#39;m also not comfortable with giving up control over the queries and I&#39;m absolutely not comfortable putting an unnecessary layer between the data and my business objects.&nbsp; To me it just seems silly on the face of it, no need to even have any other reason despite there being apparently many.</p>
<p>Yes the Telerik grid can be bound directly to the business object until, again, you have a non trivial application where the users are faced with gigabytes of data potentially at the back end, and they need to be able to sort, filter in complex ways (with preset filter values like &quot;This month&quot; or &quot;A-H&quot;) and page through the data.&nbsp; This then becomes problematic.&nbsp; </p>
<p>I have a very highly performant, grid agnostic, way of doing it in the original web and winform UI&quot;s for the app that I&#39;m replacing. </p>
<p>I&#39;m trying to replicate that with the Telerik wpf grid and it was going great up until I discovered there&#39;s no event for when a user removes a filter so that was what triggered my asking Telerik and them telling me basically &quot;don&#39;t worry about it, just bind to a LINQ source and it&#39;s all automatic&quot;.&nbsp; </p>
<p>I&#39;m not doing it that way and I&quot;m not some code cubicle jockey.&nbsp; I hand craft software to perform as fast as possible and in the way the user thinks as much as possible in a task oriented manner and that precludes almost any automatic hand holding junk from Microsoft or anyone else which seems created for the sole purpose of allowing companies to hire the least knowledgeable possible developers.</p>
<p>I don&#39;t want every click in my app to be a *request* for something to happen.&nbsp; I want it to be an instantaneous action that happens now, not when all the intervening &quot;happy helper&quot; layers decide it&#39;s allowed to happen.</p>
<p>Sorry for the rant but I&#39;m frustrated with the whole plug and play approach to programming that is churning out so much crap these days and as professionals I think we should all strive to do the best possible by our users, that&#39;s what the job is really about.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Curelom replied on Tuesday, November 01, 2011</h2><p>I have several applications that deal with millions of records using EF and the Telerik grid and work with databases with 10s of thousands of tables.&nbsp; I&#39;ve been programing for nearly 30 years.&nbsp; I am not some partially employed developer who learned how to program with a c# for dummies book and is completely clueless.&nbsp; Partially clueless, maybe <img src="http://forums.lhotka.net/emoticons/emotion-5.gif" alt="Wink" />.&nbsp; </p>
<p>I do not believe they were talking about binding it to a &quot;Linq to Sql&quot; source, but rather the&nbsp;a&nbsp;linq result of an in memory collection&nbsp;bound to controls on the window.&nbsp; It is hard to know from the little details you have given whether you want&nbsp;some or all of the filtering to occur on the server side or client side, so I don&#39;t know how to give concrete examples.&nbsp; Having middlemen objects in the middle doesn&#39;t always suggest that it will be slower either.&nbsp; Linq uses the yield statement extensively under the covers and only pulls what data you ask for, when you ask for it.&nbsp; If you read through the series on the ScottGu&nbsp;blog mentioned in an&nbsp;earlier&nbsp;thread, you&#39;ll see how using&nbsp;IQueryable provides an easy way for doing the filtering and paging on the database side with less work needed from the developer.&nbsp; Performance should be good and this gives you more time to work on the more important &quot;interesting windows&quot;.</p>
<p>If you&#39;re uncomfortable putting any unnecessary layers in, get rid of CSLA.&nbsp; You can always argue your way back to assembly.&nbsp; These additional layers can provide readability, maintainability, and flexibility of an application, which are also important concerns for users.&nbsp; Especially when the users tell you the one thing they would never change, they now want changed.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JCardina replied on Tuesday, November 01, 2011</h2><p>Sorry if I gave the impression I was directing my rant at you specifically, I wasn&#39;t, it&#39;s just a general rant.&nbsp; And I&quot;m not asking how to do it, I already have a working solution (in use commercially for many years now world wide in over 50 countries at last check. :)&nbsp; Not that I too am not partially clueless because I&#39;m certain I am clueless about a lot of things or I&#39;d be a crappy developer. :) ).&nbsp; </p>
<p>Despite your experience to the contrary it seems a pretty common theme from my research online that EF has major problems at every level and seems to be something to avoid if possible.&nbsp; This is typical in it&#39;s complaints: http://efvote.wufoo.com/forms/z7x3p9/</p>
<p>I&#39;m just trying to determine if there are any other options out there that would be better than what I&#39;m doing now.</p>
<p>(I&#39;ve never seen a database with 10&#39;s of thousands of tables, didn&#39;t even imagine such a thing existed before now.&nbsp; I can certainly see why you&#39;d want to use something like EF, my problem is sort of the other way around: a properly normalized business domain database consisting of only about 50 tables but often a huge amount of data. And a major requirement to be able to slice and dice the data in interesting ways at the UI level.)</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Curelom replied on Tuesday, November 01, 2011</h2><p>The application I work with that has all those tables is Oracle Apps.&nbsp; That is Oracle&#39;s ERP solution and is my bread and butter.&nbsp; I agree, EF has LOTS of problems and has a way to go before it can be considered a mature technology.&nbsp; I also don&#39;t use EF for all those tables, that would be a nightmare.&nbsp; Oracle already has forms for dealing with most of them.&nbsp; I build extensions that users can use that aren&#39;t addressed by Oracle.</p>
<p>The tables that I use containing millions of records are in a custom data warehouse we built.&nbsp; I addressed most of the performance issues&nbsp;on the database side, using properly partitioned and indexed tables.&nbsp; Also&nbsp;use&nbsp;Materialized Views to get speedy aggregate information.&nbsp; I don&#39;t know what Materialized Views are called in Sql Server, but I believe it has them.&nbsp;&nbsp;Parallel Partitioning is absolutely vital.&nbsp; I then give the users a large subset of the data and let them filter on the client side to&nbsp;a smaller subset.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, November 01, 2011</h2><p>Quote from ScottGu&#39;s blog post:</p>
<p><i>We could have returned the categories from our <em>GetCategories()</em> method using an <em>IEnumerable&lt;Category&gt;</em> &ndash; or a type that implements that interface like <em>List&lt;Category&gt;</em>.&nbsp; Instead, though, we returned the categories using an <em>IQueryable&lt;Category&gt;</em> interface:</i></p>
<p><i>  </i></p>
<blockquote>
<p style="line-height:normal;margin:0in 0in 0pt;" class="MsoNormal"><i><span style="font-family:Consolas;"><span style="background-image:none;background-attachment:scroll;background-repeat:repeat;background-position:0% 0%;"><span style="color:#0000ff;"><span style="font-size:10pt;">public</span></span></span><span style="font-size:10pt;"><span style="background-image:none;background-attachment:scroll;background-repeat:repeat;background-position:0% 0%;"> </span><span style="background-image:none;background-attachment:scroll;background-repeat:repeat;background-position:0% 0%;"><span style="color:#2b91af;">IQueryable</span></span><span style="background-image:none;background-attachment:scroll;background-repeat:repeat;background-position:0% 0%;">&lt;</span><span style="background-image:none;background-attachment:scroll;background-repeat:repeat;background-position:0% 0%;"><span style="color:#2b91af;">Category</span></span></span><span style="background-image:none;background-attachment:scroll;background-repeat:repeat;background-position:0% 0%;"><span style="font-size:10pt;">&gt; GetCategories() {</span></span></span></i></p>
<p style="line-height:normal;margin:0in 0in 0pt;" class="MsoNormal"><i><span style="background-image:none;background-attachment:scroll;background-repeat:repeat;background-position:0% 0%;"><span style="font-family:Consolas;"><span style="font-size:10pt;">&nbsp;</span></span></span></i></p>
<p style="line-height:normal;margin:0in 0in 0pt;" class="MsoNormal"><i><span style="font-family:Consolas;"><span style="background-image:none;background-attachment:scroll;background-repeat:repeat;background-position:0% 0%;"><span><span style="font-size:10pt;">&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:10pt;"><span style="background-image:none;background-attachment:scroll;background-repeat:repeat;background-position:0% 0%;"><span style="color:#0000ff;">var</span></span><span style="background-image:none;background-attachment:scroll;background-repeat:repeat;background-position:0% 0%;"> northwind = </span><span style="background-image:none;background-attachment:scroll;background-repeat:repeat;background-position:0% 0%;"><span style="color:#0000ff;">new</span></span><span style="background-image:none;background-attachment:scroll;background-repeat:repeat;background-position:0% 0%;"> </span><span style="background-image:none;background-attachment:scroll;background-repeat:repeat;background-position:0% 0%;"><span style="color:#2b91af;">Northwind</span></span></span><span style="background-image:none;background-attachment:scroll;background-repeat:repeat;background-position:0% 0%;"><span style="font-size:10pt;">();</span></span></span></i></p>
<p style="line-height:normal;margin:0in 0in 0pt;" class="MsoNormal"><i><span style="font-family:Consolas;"><span style="background-image:none;background-attachment:scroll;background-repeat:repeat;background-position:0% 0%;"><span><span style="font-size:10pt;">&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:10pt;"><span style="background-image:none;background-attachment:scroll;background-repeat:repeat;background-position:0% 0%;"><span style="color:#0000ff;">return</span></span></span><span style="background-image:none;background-attachment:scroll;background-repeat:repeat;background-position:0% 0%;"><span style="font-size:10pt;"> northwind.Categories.Include(c =&gt; c.Products);</span></span></span></i></p>
<p style="line-height:13pt;margin:0in 0in 10pt;" class="MsoNormal"><i><span style="background-image:none;line-height:12pt;background-attachment:scroll;background-repeat:repeat;background-position:0% 0%;"><span style="font-family:Consolas;"><span style="font-size:10pt;">}</span></span></span><span style="line-height:12pt;" lang="EN-AU"></span></i></p>
</blockquote>
<p><i>  The
 benefit of returning IQueryable&lt;T&gt; is that it enables deferred 
execution on the query, and allows a data-bound control to further 
modify the query before executing it.&nbsp; </i></p>
<p><i><br /></i>Csla 3.8.x and som previous version supported the IQueryable interface and in-memory indexing. The benefit of using IQueryable with EF/L2S is that you get closer to the data access code and this can change the resulting SQL. Not quite so easy in tiered application to let expression trees flow down to the data access. My assumption is that CSLA will acess data the same way it does today and that when a web app will get a list like that example you will either send the &quot;paging&quot; parameters to the data access layer or use EF / L2S directly in your app.</p>
<p>&nbsp;</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
