<html><header><title>Telerik RadGridView</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Telerik RadGridView</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6896.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Code7 posted on Monday, May 04, 2009</h2><P>Hi,</P>
<P class=MsoNormal><SPAN><FONT face=Arial>We are using the CSLA as our base framework and evaluating Telerik's Winform controls. Using Telerik's RadGridView control that is bound to a custom object, when trying to use the Grids add new row functionally we receive the following message:<o:p></o:p></FONT></SPAN></P>
<P class=MsoNormal><SPAN><FONT face=Arial>System.MissingMethodException: Constructor on type ‘MyObject.whatever’ not found. At System.runtimeType.CreateInstanceimp(Binding…..<o:p></o:p></FONT></SPAN></P>
<P class=MsoNormal><SPAN><o:p><FONT face=Arial>&nbsp;</FONT></o:p></SPAN></P>
<P class=MsoNormal><SPAN><FONT face=Arial>Since the object’s constructor is defined as private (using Class in-charge model) I can understand the error but not a solution. Any help greatly appreciated.<o:p></o:p></FONT></SPAN></P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tetranz replied on Monday, May 04, 2009</h2>I haven't used the Telerik grid but I think the problem will be solved if you override AddNewCore in the collection class.<br><br>protected override object AddNewCore()<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyObject item = MyObject.NewMyObject();<br>&nbsp;&nbsp;&nbsp; &nbsp; this.Add(item);<br>&nbsp;&nbsp;&nbsp; &nbsp; return item;<br>}<br><br>That's the standard way if your objects don't have a public default constructor.<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tom_W replied on Tuesday, May 05, 2009</h2>The only other thing worth noting on AddNewCore is that it's a parameterless method, so if your objects constructor doesn't have a zero parameter constructor you will need to either introduce one, or else set the mandatory values within AddNewCore, without passing the values into AddNewCore.<br><br>I only mention this as it tripped me up for a while and I thought it might save you some pain!<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Code7 replied on Thursday, May 07, 2009</h2><P>Excellent. Thanks for the info I will try the suggestions.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Code7 replied on Thursday, May 07, 2009</h2><P>I overrode the AddNewCore method in the ObjectList which elimiated the error.&nbsp; Now I have the Add New row displayed but where does one save the object back to the database? I have tried the RowChanging and RowChanged events but the New object is empty and the Grid Data is not available.</P>
<P>Any suggestion greatly appreciated.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tom_W replied on Friday, May 08, 2009</h2>Just as a double check:&nbsp; In the grid can you edit and save changes to existing rows (i.e. existing custom business objects) correctly?&nbsp; Are these changes persisted to the database?<br><br>Also are these child objects or root objects?&nbsp; If they are child objects they you will need to invoke a save on the parent to get the data back to the database obviously.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Code7 replied on Friday, May 08, 2009</h2><P>No, edits are not saved to the database nor the grid.&nbsp; This is a root object that has no children.&nbsp; Secondly I have since switched to binding the Telerik RadGridView to a BindingSource which is bound to the BO. Still no success.</P>
<P>Thanks for taking the time to respond.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tom_W replied on Friday, May 08, 2009</h2>Does it work correctly if you bind a standard Windows DataGridView to the bindingsource?<br /><br />Couple of other questions: what exactly do you mean when you say 'edits are not saved to the grid'? Do you mean the underlying BO is not getting updated with the values from the grid (I.e. even before attempting the save)?<br /><br />Also, how are you invoking the BO.Save() method, is there a save button on the form?   </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Code7 replied on Friday, May 08, 2009</h2><P>Interesting....I thought of the same idea. I did not try the BO bound to a Windows DataGridView. I am in the process of testing that out. Be back in a moment.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Code7 replied on Friday, May 08, 2009</h2><P><FONT size=2>&nbsp;</FONT>I changed over to a Standard Windows DataGridview that is bound to a bindingsource that is bound to a BO.&nbsp;I have&nbsp;almost the same results so I must be missing the f<FONT face=Arial size=2>undamentals</FONT>. &nbsp;</P>
<P>I set the datasource of the bindingsource to the BO in the forms load event:</P>
<P>boProducts= ieserv.Products.GetListOfProducts() </P>
<P>BOBindingSource=boProducts</P>
<P>All product information is disaplyed no issues.</P>
<P>In the Products Object I have the following:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Protected</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Overrides</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Function</FONT></FONT><FONT size=2> AddNewCore() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Object</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Dim</FONT></FONT><FONT size=2> newProduct </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> ieServ.Products = ieSerrv.NewProduct()</FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me</FONT></FONT><FONT size=2>.Add(newProductt)</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Return</FONT></FONT><FONT size=2> newProduct</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Function</FONT></FONT></P>
<P><FONT color=#000000>When I click the new row region of the DataGrid the AddNewCore method is called and I can&nbsp;enter values into the fields. Now when I move off the New Row, I was assumming that the bindingsource would take care of saving the results back to database but this is not the case. Although the DataGrid shows the newly added row since I did add the new Product Object to the list in the AddNewCore method.&nbsp; Also when I&nbsp;move off the New Row, a second call is made and another empty row is added to the grid and the Product List (AddNewCore is called again).</FONT></P>
<P><FONT color=#000000>Thanks again for your help.</FONT></P>
<P><FONT size=2><FONT color=#0000ff></FONT>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tom_W replied on Saturday, May 09, 2009</h2>Hiya<br><br>OK, that helps narrow it down a bit, as you say it sounds like it's an issue with the objects rather than the grid control.<br><br>What type of object is boProjects?&nbsp; Is it a standard Windows collection or a CSLA collection?&nbsp; If it's a CSLA collection, which one is it (BusinessListBase, EditableRootListBase, etc?)<br><br><BLOCKQUOTE><div><br><font color="#000000">When I click the new row region of the DataGrid
the AddNewCore method is called and I can&nbsp;enter values into the fields.
Now when I move off the New Row, I was assumming that the bindingsource
would take care of saving the results back to database but this is not
the case. <br></div></BLOCKQUOTE><br>For normal Windows or CSLA collections that isn't the default behaviour, you need to call an explicit save somewhere.&nbsp; In CSLA if these objects are child to the parent collection then you can Save the parent and the children should save.&nbsp; If the previous sentence is new to you then I would suggest you need to read Rocky's Expert 2008 Business Objects book before going any further with CSLA.<br><br>If you have read Expert 2008 BOs then I would suggest re-reading the stuff on Dynamic Editable Collection (page 190).&nbsp; I haven't used these but they sound like they might be what you need if you don't want a save button on the form.<br><br>As a side note, and I'm sure you know this; in this instance the bindingsource is only a way of connecting the data in an object (e.g. product) or collection of objects (e.g. products) to the controls on your form.&nbsp; A lot of what the binding source does is simply calling methods on your underlying objects using standard Windows binding interfaces.&nbsp; <br><br>This is quite separate from the data access side of things (e.g. database CRUD) which would normally be initiated by your business objects and handled by your data layer.&nbsp; In a lot of cases you would not want changes made on a grid to be immediately stored to the database (for example if you want to use n-level undo).<br><br><BLOCKQUOTE><div><br>Also
when I&nbsp;move off the New Row, a second call is made and another empty
row is added to the grid and the Product List (AddNewCore is called
again).</font><br></div></BLOCKQUOTE><br>That's plain weird!&nbsp; Can you trace where the two calls are coming from by looking at the call stack?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>vbbojan replied on Saturday, May 09, 2009</h2>Maybe you are missing AllowNew = True in the constructor of your Products object:<br><br>Private sub New()<br>&nbsp; AllowNew = True<br>End Sub<br><br>Regards,<br>Bojan<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
