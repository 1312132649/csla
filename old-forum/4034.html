<html><header><title>CRUD Implementation for data access layer </title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CRUD Implementation for data access layer </h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4034.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Hetal posted on Thursday, December 13, 2007</h2><P>I have downloaded Rocky's presentation "Deep Data" that explains his thoughts on implementation of Fetch operation for a parent-child relationship in a seperate data access layer. </P>
<P>We would like to implement a Data Access Layer using Data Transfer Objects approach.&nbsp;I am interested in identifying how&nbsp;the data access layer&nbsp;would handle the insert, update and delete operations for root-childen relationship&nbsp;data transfer objects.</P>
<P>For e.g. Looking at the same example that Rocky discussed in his presentation about, Orders -&gt; Line Items -&gt; LineItemDetail, if I had different data transfer objects for each of these, How could the Order Root DTO object determine inserting/updating/deleting itself and its children Items and its grandchildren LineItemDetail. We want to implement transactions to ensure ACIDity is maintained.</P>
<P>Our&nbsp;initial thought was to have stateful DTO objects just like the business objects do so that the root object can start a transaction if it has changed state (is new/dirty) and save only those child objects whose state is new/dirty. In this manner, we achieve persisting objects if required and also identifying which operation(insert/update) is applicable.</P>
<P>Is this a suitable approach? Does Rocky have any presentations on his thoughts of implementing other CRUD operations in the data access layer?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, December 14, 2007</h2><P>To support insert/update/delete you need to pass the IsNew/IsDeleted values from your business objects through to the DAL.</P>
<P>The easiest way to do this (and I think best way) is to include those properties in the DTOs.</P>
<P>Alternately you could create some "context" object that would keep those values and pass both that "context" object and the DTO to the DAL.</P>
<P>But I think you should view the DTOs as messages, not objects. In other words, the DataPortal_XYZ methods are sending messages to the DAL, and the DAL then does its work. The messages should be self-contained, and that means that they would need not only the business data, but also the metadata like IsNew and IsDeleted.</P>
<P>The reason the message approach is best, is because it translates well to a service-oriented model, meaning that your "DAL" could actually be a set of web services, WCF services, etc. And this technique doesn't prevent you from using LINQ to SQL or ADO.NET EF.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
