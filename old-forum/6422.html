<html><header><title>Suggestion - more events for ExtendedBindingList: InsertingItem, ItemInserted, ItemRemoved</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Suggestion - more events for ExtendedBindingList: InsertingItem, ItemInserted, ItemRemoved</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6422.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>oscarmorasu posted on Friday, February 13, 2009</h2><P>Hello,</P>
<P>Right now all our collections inherit from BusinessListBase. We have a parent class "P" that contains a BusinessListBase "L".</P>
<P>Under many scenarios I want P to know if an item is being inserted, was inserted, is being removed&nbsp;or was removed from L. CSLA 3.6.1 already has an event ExtendedBindingList.RemovingItem that triggers from the override of RemoveItem. Any subscriber can hook up to that event and execute some logic (such as validation) before the item is removed from the list.</P>
<P>I think it would be very helpful to have an InsertingItem and ItemInserted events in the override of InsertItem, before and after calling base.InsertItem(), as well as an ItemRemoved event in the override of RemoveItem, after base.RemoveItem() is called.</P>
<P>Thanks.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, February 13, 2009</h2><P>The reason I added RemovingItem is that it was impossible to get a reference to the item being removed from the ListChanged event, since that event only provides an index - which is invalid by the time you get the event.</P>
<P>I suppose I could see RemovedItem having some value, and if there's a compelling real scenario for it I'll consider it.</P>
<P>Insert, Move&nbsp;and Set&nbsp;operations can be handled by ListChanged, because in those cases the index values are valid and give you access to the item(s) affected.</P>
<P>Realistically, this whole list model is a little up in the air though, due to the conflict between WPF and Windows Forms. That's covered rather extensively in a different thread from a couple weeks ago.</P>
<P>So in all honesty, I'm unlikely to make changes to the existing collection types (other than bug fixes) until I know how I'm going to address the BindingList&lt;T&gt; base vs ObservableCollection&lt;T&gt; base issue.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>oscarmorasu replied on Monday, February 23, 2009</h2><P>Thanks for the answer Rocky.</P>
<P>Just like you said, the RemovingItem is very helpful since it provides the item before it's removed. However, in my scenario the parent class has to know when the item was already removed from the collection. ListChanged only provides the index of the item, which is no longer valid.</P>
<P>Also, ListChanged doesn't cover the ItemInserting scenario. In this case I want the parent class to be notified an item is being inserted, and run some logic and validation before the insert actually takes place.</P>
<P>I understand you are not able to include these changes in your current version. Just keep it in mind&nbsp;as a possible future&nbsp;enhancements. In the meantime I'm overriding InsertItem and RemoveItem to include the events mentioned above.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
