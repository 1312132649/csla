<html><header><title>SqlBulkCopy vs inserts?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>SqlBulkCopy vs inserts?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2506.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>sune42 posted on Monday, March 12, 2007</h2><P>Have anyone tried to use the <FONT size=2>SqlBulkCopy operation to do multiple inserts into a database?<BR></FONT><FONT size=2><BR>For example if I want to insert 100 rows into&nbsp;a database?</P></FONT>
<P><FONT size=2>Is it faster ? than doing single inserts in a&nbsp;loop?&nbsp; (where single inserts could be&nbsp;call to a StoredProc that does the insert)</FONT></P>
<P>Or is it so that what is sent over to the database is still single inserts, but its more a programmatic way to send multiple stuff to the DB?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>phowatt replied on Monday, March 12, 2007</h2>I am developing a deployment package in which I have to add small amounts of data to a SQLExpress database that is being created in the deployment process.&nbsp; I am using bulk copy to do the task but in my reasearch I discovered that using Bulk Copy or SqlBulkCopy is faster than single inserts and in my testing I find the Bulk Copy to be very fast.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Monday, March 12, 2007</h2>I had to import some HUGE text files in one app as a regulare process in one app. The files weren't CSVs, they had custom formatting rules. So I implemented IDataReader in a class for reading these custom txt files and passed that to the SqlBulkCopy and it was amazingly fast.<br><br>I hear there's a way to tell a dataadapter to batch inserts which makes that go faster too, but I don't recall what the property was...<br><br>Andr√©s<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DW_CT replied on Monday, March 12, 2007</h2><P>Be aware that the SQLBulkCopy leverages the old bcp utility. As such, it typically performs "minimally-logged" inserts, and by default does not support full transactional capabilities. There is information regarding this in the help files. If you're using SQLBulkCopy to do something like a large nightly data load, I'd recommend doing a full DB backup, the bulk copy, and another full DB backup if there were no errors (or a restore if there were). If you're using it for small inserts, I'd think hard about what you might be losing in data integrity if it fails mid-way through a batch.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
