<html><header><title>PropertyHasChanged and Bindingsource problem</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>PropertyHasChanged and Bindingsource problem</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8986.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>KevinR posted on Tuesday, May 25, 2010</h2><p><b>Winforms, Visual Studio 2008, CSLA 2.1.1.0</b></p>
<p>Hello, I have a problem with a DataGridView with a combobox.</p>
<p>The grid is bound to a BusinessListBase via a bindingsource and the comboboxes list comes from another bindingsource which is bound to a different business list base collection. The items in the combobox datasource are a property of the containing data grid view&#39;s datasource.</p>
<p>Now, on the current changed event of the combobox I set the apropriate property of the current row, in the setter for this property I call PropertyHasChanged. The issue is that calling PropertyHasChanged ultimately results in the OnListChanged event of the main collection being raised, which - via the magic of databinding - calls the CurrentChanged event again resulting in the selected value being replaced by a blank item.</p>
<p>If I remove the PropertyHasChanged call the property is set but obviously my IsDirty is not set and the Validation is not called.</p>
<p>Any ideas?</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Tuesday, May 25, 2010</h2><p>You should at least upgrade to the latest 3.0.x version of CSLA. Many, many bugs, especially around Windows Forms data binding, were addressed in the 3.0 version of CSLA.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>KevinR replied on Tuesday, May 25, 2010</h2><p>Hi Rocky,</p>
<p>Unfortunately that is not under my control and, at the moment, not an option. I&#39;m not sure it is a bug, it might be something I am doing wrong.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, May 25, 2010</h2><p>I&#39;m 95% sure that is a bug that was fixed. It sounds very familiar, and has to do with the PropertyChanged event from child objects messing with datagrid controls. It was one of the things fixed in 3.0.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>KevinR replied on Tuesday, May 25, 2010</h2><p>OK&nbsp; thanks Rocky. I&#39;ll try that in isolation, but the project I&#39;m working on is big so upgrading anything is difficult. I&#39;ll suggest it though. </p>
<p>In the meantime I&#39;ve overridden the PropertyHasChanged event in my business object&nbsp; so that it doesn&#39;t call the OnPropertyChanged method in the base class method&nbsp; - this suits my specific requirements as it happens and now works just as I wanted.</p>
<p>Thanks for the info about version 3.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
