<html><header><title>User.IsInRole</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>User.IsInRole</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2411.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>joel posted on Thursday, February 22, 2007</h2><P>I'm having trouble getting my custom principal's IsInRole method to work in my web page's code behind.&nbsp; Shouldn't I expect to be able to call User.IsInRole in a page's code behind?&nbsp; I'm testing with the following in a page's load event...</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> bln </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean</FONT><FONT size=2> = User.IsInRole(</FONT><FONT color=#a31515 size=2>"Web-View All Reports"</FONT><FONT size=2>)</P>
<P>Response.Write(</FONT><FONT color=#a31515 size=2>"&lt;br&gt;User.IsInRole(""Web-View All Reports"") = "</FONT><FONT size=2> &amp; bln.ToString)</FONT></P>
<P><FONT size=2>I get false even though the custom principal loaded the role when it was fetched.</FONT></P>
<P><FONT size=2>I notice the projecttracker application always relies on the business objects to check roles.&nbsp; I see the logic in this, however I thought the reason we were implementing the custom principal was so both layers of the app could benefit from it?</FONT></P>
<P><FONT size=2>I also get an InvalidCastException when I&nbsp;try&nbsp;this...</FONT></P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> MyPrincipal </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> VMIS.Business.Principal = User</P>
<P>Response.Write(</FONT><FONT color=#a31515 size=2>"&lt;br&gt;MyPrincipal.IsInRole(""Web-View All Reports"") = "</FONT><FONT size=2> &amp; bln.ToString)</FONT></P>
<P><FONT size=2>Did I code the identity, principal, login wrong, or are my expectations about how this works wrong?</P></FONT>
<P><FONT size=2>Joel</FONT></P>
<P><FONT size=2>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, February 22, 2007</h2><P>Did you reload the principal in global.asax? The required code is shown in Chapter 10 of the 2005 book.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>joel replied on Thursday, February 22, 2007</h2><P>Thanks! That was it.</P>
<P>Joel</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
