<html><header><title>Inserting parent and child objects and transactions</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Inserting parent and child objects and transactions</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8190.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>tiptop posted on Monday, December 21, 2009</h2>Hello All<br /><br />Hope you can point me in the right direction. <br /><br />After a lot of debugging and putting break points everywhere, I finally discovered why my form was not saving.<br /><br />I have a form that has :<br /><br />Parent1<br />---Child 1<br />------Child2<br /><br />The data portal child insert is working fine on Child 2 and new identity value is returned. But when I come to come insert Child 1, it fails on a referential integrity error. This is because the whole insert ( starting at Parent 1 ) is working via a transaction. Therefore, even though Child 2 has inserted a record correctly and it has returned a new id. If Child 1 uses the new ID it fails, because it doesn't actually physically exist in the foreign key table.<br /><br />How do I get around this? Any hints would be appreciated.<br /><br /><br />PS : For any other newbies to CSLA, I had an initial error where the parent object was coming back with a "Is not valid" error during the Save process. I finally worked out that each property must have a valid value as defined by the database schema.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tiptop replied on Monday, December 21, 2009</h2>Ok. I sussed it out.<br /><br />You need to use " using (BypassPropertyChecks)" in your DataPortal_Insert method. <br /><br />This doesn't do the referential integrity checks for each child but it should still work as one whole transaction.<br /><br /></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
