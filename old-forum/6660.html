<html><header><title>SmartInt and other Smart data types</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>SmartInt and other Smart data types</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6660.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Nemisis posted on Tuesday, March 24, 2009</h2>Hi all, i have created a SmartInt datatype, which is nearly the same as the SmartDate found in the csla library, but i am getting an error in the following routine<br /><br />public static object CoerceValue(Type desiredType, Type valueType, object oldValue, object value)<br /><br />The error is<br /><br />Invalid cast from 'System.Int32' to 'SamplePropertyApplication.SmartInt'.<br /><br />Am i right in thinking that for any new datatype like SmartInt i would have to manually add it to<br /><br />public static object CoerceValue(Type desiredType, Type valueType, object oldValue, object value)<br /><br />I am using the Managed backing fields option and not private backing fields, as recommended.  I would like to create other Smart datatypes as our application requires them, but wondered if there was something i have done wrong?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Nemisis replied on Tuesday, March 24, 2009</h2>encase a stack trace is needed, here it is<br /><br /><br />[InvalidCastException: Invalid cast from 'System.Int32' to 'SamplePropertyApplication.SmartInt'.]<br />   System.Convert.DefaultToType(IConvertible value, Type targetType, IFormatProvider provider) +7567404<br />   System.Int32.System.IConvertible.ToType(Type type, IFormatProvider provider) +36<br />   System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider) +7599280<br />   System.Convert.ChangeType(Object value, Type conversionType) +32<br />   Csla.Utilities.CoerceValue(Type desiredType, Type valueType, Object oldValue, Object value) in C:\BslStore\Doc\My Software\cslacs\Csla\Utilities.cs:199<br />   Csla.Utilities.CoerceValue(Type valueType, Object oldValue, Object value) in C:\BslStore\Doc\My Software\cslacs\Csla\Utilities.cs:238<br />   Csla.Core.BusinessBase.LoadPropertyConvert(PropertyInfo`1 propertyInfo, F newValue) in C:\BslStore\Doc\My Software\cslacs\Csla\Core\BusinessBase.cs:2436<br /><br />[PropertyLoadException: Property load or set failed for property Number (Invalid cast from 'System.Int32' to 'SamplePropertyApplication.SmartInt'.)]<br />   Csla.Core.BusinessBase.LoadPropertyConvert(PropertyInfo`1 propertyInfo, F newValue) in C:\BslStore\Doc\My Software\cslacs\Csla\Core\BusinessBase.cs:2440<br />   SamplePropertyApplication.Company.DataPortal_Fetch(SingleCriteria`2 criteria) in C:\BslStore\Doc\Visual Studio 2008\Websites\SamplePropertyApplication\SamplePropertyApplication\App_Code\Company.vb:119<br />   dm(Object , Object[] ) +74<br />   Csla.Reflection.MethodCaller.CallMethod(Object obj, DynamicMethodHandle methodHandle, Object[] parameters) in C:\BslStore\Doc\My Software\cslacs\Csla\Reflection\MethodCaller.cs:298<br /><br />[CallMethodException: DataPortal_Fetch method call failed]<br />   Csla.Reflection.MethodCaller.CallMethod(Object obj, DynamicMethodHandle methodHandle, Object[] parameters) in C:\BslStore\Doc\My Software\cslacs\Csla\Reflection\MethodCaller.cs:302<br />   Csla.Reflection.MethodCaller.CallMethod(Object obj, String method, Object[] parameters) in C:\BslStore\Doc\My Software\cslacs\Csla\Reflection\MethodCaller.cs:226<br />   Csla.Reflection.LateBoundObject.CallMethod(String method, Object[] parameters) in C:\BslStore\Doc\My Software\cslacs\Csla\Reflection\LateBoundObject.cs:86<br />   Csla.Server.SimpleDataPortal.Fetch(Type objectType, Object criteria, DataPortalContext context) in C:\BslStore\Doc\My Software\cslacs\Csla\Server\SimpleDataPortal.cs:125<br /><br />[DataPortalException: DataPortal.Fetch failed (Property load or set failed for property Number (Invalid cast from 'System.Int32' to 'SamplePropertyApplication.SmartInt'.))]<br />   Csla.DataPortal.Fetch(Type objectType, Object criteria) in C:\BslStore\Doc\My Software\cslacs\Csla\DataPortal.cs:262<br />   Csla.DataPortal.Fetch(Object criteria) in C:\BslStore\Doc\My Software\cslacs\Csla\DataPortal.cs:173<br />   SamplePropertyApplication.Company.GetEditableRoot(Int32 id) in C:\BslStore\Doc\Visual Studio 2008\Websites\SamplePropertyApplication\SamplePropertyApplication\App_Code\Company.vb:84<br /><br />[TargetInvocationException: Exception has been thrown by the target of an invocation.]<br />   System.RuntimeMethodHandle._InvokeMethodFast(Object target, Object[] arguments, SignatureStruct&amp; sig, MethodAttributes methodAttributes, RuntimeTypeHandle typeOwner) +0<br />   System.RuntimeMethodHandle.InvokeMethodFast(Object target, Object[] arguments, Signature sig, MethodAttributes methodAttributes, RuntimeTypeHandle typeOwner) +71<br />   System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture, Boolean skipVisibilityChecks) +261<br />   System.Reflection.RuntimeMethodInfo.Invoke(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture) +29<br />   System.Web.UI.WebControls.ObjectDataSourceView.InvokeMethod(ObjectDataSourceMethod method, Boolean disposeInstance, Object&amp; instance) +488<br />   System.Web.UI.WebControls.ObjectDataSourceView.ExecuteSelect(DataSourceSelectArguments arguments) +1247<br />   System.Web.UI.DataSourceView.Select(DataSourceSelectArguments arguments, DataSourceViewSelectCallback callback) +19<br />   System.Web.UI.WebControls.DataBoundControl.PerformSelect() +142<br />   System.Web.UI.WebControls.BaseDataBoundControl.DataBind() +73<br />   System.Web.UI.WebControls.DetailsView.DataBind() +4<br />   System.Web.UI.WebControls.BaseDataBoundControl.EnsureDataBound() +82<br />   System.Web.UI.WebControls.DetailsView.EnsureDataBound() +184<br />   System.Web.UI.WebControls.CompositeDataBoundControl.CreateChildControls() +72<br />   System.Web.UI.Control.EnsureChildControls() +87<br />   System.Web.UI.Control.PreRenderRecursiveInternal() +44<br />   System.Web.UI.Control.PreRenderRecursiveInternal() +171<br />   System.Web.UI.Control.PreRenderRecursiveInternal() +171<br />   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +842<br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Nemisis replied on Tuesday, March 24, 2009</h2>Never mind, a TypeConvertor needs to be created! Cheers anyway</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
