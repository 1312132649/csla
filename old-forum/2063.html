<html><header><title>Implicit Operator and Binding</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Implicit Operator and Binding</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2063.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>cultofluna posted on Tuesday, January 02, 2007</h2>Hello everyone,<br><br>I have two BO's: Country and Street.<br><br>Country has a string value property that contains the ISO countrycode. It also uses an implicit operator to assign and read this value.<br><br>Street has a string value property that contains the streetname and a Country property that contains the country.<br><br>I want to use the Street in my form and edit it using binding. So I have two textboxes, one bound to the string property and one to the Country property. I also use an errorprovider to notify of any broken rules.<br><br>When I first access the BO the value of the Country is shown without any problems. So here the implicit operator seems to work. However when assigning the errorprovider shows an "Invalid cast System.String to Library.Country". <br><br>Can binding only be used with properties of the same type as the property of the control it's bound to?<br><br>It seems like it has something todo with formatting the value...<br><br>System.FormatException: Invalid cast from 'System.String' to 'H2O.Library.Type.Country'. ---&gt; System.InvalidCastException: Invalid cast from 'System.String' to 'H2O.Library.Type.Country'.<br>&nbsp;&nbsp; at System.Convert.DefaultToType(IConvertible value, Type targetType, IFormatProvider provider)<br>&nbsp;&nbsp; at System.String.System.IConvertible.ToType(Type type, IFormatProvider provider)<br>&nbsp;&nbsp; at System.Convert.ChangeType(Object value, Type conversionType, IFormatProvider provider)<br>&nbsp;&nbsp; at System.Windows.Forms.Formatter.ChangeType(Object value, Type type, IFormatProvider formatInfo)<br>&nbsp;&nbsp; --- End of inner exception stack trace ---<br>&nbsp;&nbsp; at System.Windows.Forms.Formatter.ChangeType(Object value, Type type, IFormatProvider formatInfo)<br>&nbsp;&nbsp; at System.Windows.Forms.Formatter.ParseObjectInternal(Object value, Type targetType, Type sourceType, TypeConverter targetConverter, TypeConverter sourceConverter, IFormatProvider formatInfo, Object formattedNullValue)<br>&nbsp;&nbsp; at System.Windows.Forms.Formatter.ParseObject(Object value, Type targetType, Type sourceType, TypeConverter targetConverter, TypeConverter sourceConverter, IFormatProvider formatInfo, Object formattedNullValue, Object dataSourceNullValue)<br>&nbsp;&nbsp; at System.Windows.Forms.Binding.ParseObject(Object value)<br>&nbsp;&nbsp; at System.Windows.Forms.Binding.PullData(Boolean reformat, Boolean force)<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cultofluna replied on Tuesday, January 02, 2007</h2>OK, I figured it out, it was the formattingEnabled parameter in the binding:<br><br>this.valueTextBox1.DataBindings.Add(new System.Windows.Forms.Binding("Text", this.streetBindingSource, "Country", <b><font color="#ff0000"><i>false</i></font></b>));<br><br>Still not completely solved however, it's seems like because the implicit creates a new instance the binding is lost as well...<br><br>I'll be back with the answer to that..<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cultofluna replied on Tuesday, January 02, 2007</h2>OK, I think this is a cool feature, where you can use implicit operators to create BO datatypes that can be used in the same manner you use for example a string datatype!<br><br>The trick was adding an extra function called BindControls in the form. Here I define binding for the textboxes that bind to BO datatypes and specify the format and parse events for the binding.<br><br>Now I can use BO datatypes with implicit operators combined with formatting!<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tiago replied on Tuesday, August 12, 2008</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>cultofluna:</strong></div><div>OK, I think this is a cool feature, where you can use implicit operators to create BO datatypes that can be used in the same manner you use for example a string datatype!<BR><BR>The trick was adding an extra function called BindControls in the form. Here I define binding for the textboxes that bind to BO datatypes and specify the format and parse events for the binding.<BR><BR>Now I can use BO datatypes with implicit operators combined with formatting!<BR><BR><BR></div></BLOCKQUOTE></P>
<P>Can you explaina bit how you solved it?</P>
<P>TIA</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cultofluna replied on Tuesday, August 12, 2008</h2>hello tiago,<br><br>well actually I stopped using it... :)<br><br>It costed to many hours in maintaining all the code, so the deadline of my project won from this solution...<br><br>I'm sorry I don't have the code anymore, maybe I will try again in future.<br><br>Good luck!<br><br>CoL<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
