<html><header><title>problem with cancel addnew in winforms databinding using sorted/filtered list with csla 3.7.1.0</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>problem with cancel addnew in winforms databinding using sorted/filtered list with csla 3.7.1.0</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7741.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Reto posted on Wednesday, October 07, 2009</h2>Dear Rocky<br /><br />To cancel a addnew i used the mBindingSource.RemoveCurrent() statment.<br />This code fails with the csla 3.7.1.0 version with an 'index out of range' exeption in OriginalIndex() called from ICancelAddNew.cancelNew code.<br /><br /> void ICancelAddNew.CancelNew(int itemIndex)<br />    {<br />      ICancelAddNew can = _list as ICancelAddNew;<br />      if (can != null)<br />          can.CancelNew(OriginalIndex(itemIndex) ); <br />      else<br />        _list.RemoveAt(OriginalIndex(itemIndex));<br />    }<br /><br />For my understanding, in this case, there is no originalIndex since the AddNew just added a new item to the end of the list.<br /> When i replace the OriginalIndex(itemIndex) with itemIndex your code runs fine.<br /><br />[winforms databinding, sorted/filtered EditableRootListBase, vs 2008 - vb, csla 3.7.1.0]<br /><br />regards reto</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, October 07, 2009</h2><P>So you've done this:</P>
<OL>
<LI>wrapped an EditableRootListBase collection with SortedBindingList</LI>
<LI>bound it to a datagrid</LI>
<LI>moved to the last row of the grid to add a new row</LI>
<LI>pressed ESC to cancel the add</LI></OL>
<P>Is that accurate?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Reto replied on Wednesday, October 07, 2009</h2>Dear Rocky<br /><br />I have done this:<br /><br />1. wrapped an EditableRootListBase collection with SortedBindingList <br />2. bound it to some textboxes<br />3. do some filtering<br />4. bindingsource.addnew<br />5. bindingsource.removeCurrent (to cancel the addNew)<br /><br />The exeption is an argumentOutofRange-exeption in OriginalIndex() called from ICancelAddNew.endNew code in the sortedbindigList.cs resp. filterdbindingList.cs.<br /><br />regards reto</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, October 08, 2009</h2>As your last step, maybe you should be calling CancelEdit on the bindingsource?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Reto replied on Thursday, October 08, 2009</h2>CancelEdit leave a ghost record (empty record) at the beginning of the list - so the only solution working for me so far (prior to 3.7.1.0) was to call removeCurrent.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, October 08, 2009</h2>The thing to do is to make sure you are doing whatever the datagrid does. That's the scenario ERLB is designed to support - anything outside that scenario might or might not work unless your code emulates the datagrid behavior.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
