<html><header><title>Business object for pivoted data</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Business object for pivoted data</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4158.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>wjcomeaux posted on Friday, January 11, 2008</h2><P>Hello all:</P>
<P>Is it possible (or even a good idea) to design business objects that allow for pivoted data? For example, I have a timesheet editable root object. timesheet has an editable root list of timesheetdetails</P>
<P>I've also got a timesheetdetails editable root object with the properties of EmployeeId, Date, HoursWorked.</P>
<P>Binding this to a grid is simple. However, our users want to see a grid that pivots the date across a range of days. For instance, they would load timesheet for a two week period and they want to see a grid where the columns are like this</P>
<P>EmployeeId&nbsp;&nbsp;| Date1&nbsp;| HoursWorked1&nbsp;| Date2 |&nbsp;HoursWorked2&nbsp;| Total Hours&nbsp;| Other stuff</P>
<P>So, their grid will always have 2 + (2 * numDaysSelected).</P>
<P>How would you go about this with CSLA?&nbsp;We are just doing case studies now so our BOs are still bery simple.</P>
<P>Thanks in advance,</P>
<P>Will</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>KKoteles replied on Wednesday, January 16, 2008</h2><P>Will,</P>
<P>Can you 'restrict' the date range choice (like 'Last Week', 'Last 2 Weeks', etc) or is it wide open (Start Date - End Date)?&nbsp; If you can 'restrict' it, then you should be able to create the associated business object for each selection (since you know the 'properties' you will need to support each grid).&nbsp; </P>
<P>If you can't restrict it, then I would try to see if I could influence their UI a little.&nbsp; Make the first grid EmployeeId | Date1 | Date2 | Total Hours | Other stuff.&nbsp; The second grid would be the 'details' grid for one particular row of the first grid - being EmployeeId | Date | Hours | Other stuff (where there would be one entry listed for every date worked - or even every date within the date range where Hours would be 0 for those dates not worked).</P>
<P>If it truly needs to be dynamic, then I'm at a loss as to how you would accomplish this with a CSLA object...</P>
<P>Ken</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pinchers1jm replied on Wednesday, January 16, 2008</h2><P><FONT face=Arial>Another option is to create a ReadOnlyList of the required properties (EmployeeId, EntryDate, HoursWorked, OtherStuff).&nbsp;The list could then&nbsp;have a&nbsp;function that returns a DataTable. The function would look something like this.</FONT></P>
<P>public DataTable GetPivotTable()<BR>{<BR>&nbsp;&nbsp;&nbsp; string keyColumn = "EmployeeId", nameColumn = "EmployeeName";<BR>&nbsp;&nbsp;&nbsp; string totalColumn = "Total", otherColumn = "OtherStuff";<BR>&nbsp;&nbsp;&nbsp; DataTable dt = new DataTable();<BR>&nbsp;<BR>&nbsp;&nbsp;&nbsp; dt.Columns.Add(keyColumn, typeof(Guid));<BR>&nbsp;&nbsp;&nbsp; dt.Columns.Add(nameColumn, typeof(string));<BR>&nbsp;&nbsp;&nbsp; dt.Columns.Add(otherColumn, typeof(string));<BR>&nbsp;&nbsp;&nbsp; dt.Columns.Add(totalColumn, typeof(decimal));<BR>&nbsp;&nbsp;&nbsp; dt.PrimaryKey = new DataColumn[] { dt.Columns[keyColumn] };</P>
<P>&nbsp;&nbsp;&nbsp; //dt.BeginLoadData();<BR>&nbsp;&nbsp;&nbsp; foreach (ItemInfo info in this)<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string pivotColumn = info.EntryDate.ToShortDateString();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!dt.Columns.Contains(pivotColumn))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt.Columns.Add(pivotColumn, typeof(decimal));</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Look for primary key <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataRow row = dt.Rows.Find(info.EmployeeId);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (row == null)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; row = dt.NewRow();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; row[keyColumn] = info.EmployeeId;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; row[nameColumn] = info.EmployeeId;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; row[otherColumn] = info.EmployeeId;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; row[totalColumn] = Convert.ToDecimal(row[totalColumn]) + info.HoursWorked;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; row[pivotColumn] = info.HoursWorked;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dt.Rows.Add(row);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; row[pivotColumn] = info.HoursWorked;<BR>&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; //dt.EndLoadData();</P>
<P>&nbsp;&nbsp;&nbsp; return dt;<BR>}</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>KKoteles replied on Friday, January 18, 2008</h2><P>pinchers1jm,</P>
<P>Interesting solution!&nbsp; I <U>love</U> the intellect demonstrated daily by those participating in this forum.&nbsp; There is always more than one way to 'skin a cat' - and I am greatful how everyone here keeps forcing me to think outside the box I keep placing myself in with deadline tunnel vision...</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>wjcomeaux replied on Friday, January 18, 2008</h2><P>Thanks guys. We have decided that limiting the timeframe would be easily acceptable. This definitely makes it easier to design.</P>
<P>&nbsp;</P>
<P>Will</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
