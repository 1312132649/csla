<html><header><title>ManyToOne nullable relationship, how to achieve that?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ManyToOne nullable relationship, how to achieve that?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9162.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>elber73 posted on Friday, July 02, 2010</h2><p>Hello, when we have the follow scenario:</p>
<ol>
<li>We have a SwitchableObject named Destination maped to a table.</li>
<li>We have a EditableRoot named Country maped to another table.</li>
<li>The SwitchableObject Destination have a property CountryMember that is a ManyToOne relation pointing to the Country object.</li>
<li>The FK on Destination table pointing to Country table is a nullable index.</li>
</ol>
<p>COUNTRY (ER) &lt;--(nullable FK)--&nbsp;DESTINATION (ECL + SWObj)</p>
<p>What is the best&nbsp;approach to write the CountryMember on Destination object, as we can access some properties of its parent? (we have the problem that the FK is nullable, and sometimes the parent will exists and sometimes the parent&nbsp;will not&nbsp;exists).</p>
<p>For example:</p>
<p>private static readonly PropertyInfo&lt; Country &gt; _countryMemberProperty = RegisterProperty&lt; Country &gt;(p =&gt; p.CountryMember, Csla.RelationshipTypes.Child);<br />public Country CountryMember {<br />&nbsp; get {<br />&nbsp;&nbsp;&nbsp; if(!FieldManager.FieldExists(_countryMemberProperty)) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var criteria = new Sample_FK_Nullable.Library.CountryCriteria {};<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(CountryFk.HasValue) criteria.Identification = CountryFk.Value;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(IsNew || (!CountryFk.HasValue) || !Sample_FK_Nullable.Library.Country.Exists(criteria))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LoadProperty(_countryMemberProperty, Sample_FK_Nullable.Library.Country.NewCountry());<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LoadProperty(_countryMemberProperty, Sample_FK_Nullable.Library.Country.GetByIdentification(CountryFk.Value));<br />&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; return GetProperty(_countryMemberProperty); <br />&nbsp; }<br />}</p>
<p>When the parent object exists, it is ok, we load its reference, but what to do when no parent exists? <br /><strong><br />create a new one and load its new reference</strong>? <br />(<span style="text-decoration:underline;">problem</span>:&nbsp;<em>really we dont want to create a new parent, only access its properties, but only if it&nbsp;exists</em>)&nbsp;&nbsp;<br /><strong><br />load null into the property</strong>? <br />(<span style="text-decoration:underline;">problem</span>: <em>if we&nbsp;load null value we will have to validate if its null all the times before we can access its Country properties</em>)</p>
<p>What people do in that case?</p>
<p>Thank you very much.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RobBracken replied on Friday, July 02, 2010</h2><p>I wouldn&#39;t be happy if the object created a new &quot;parent&quot; object automatically. My view is that if the key value is null, the property should return a null object, not create a new one.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
