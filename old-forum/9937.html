<html><header><title>Criteria Not Serializing?  Server Not Found?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Criteria Not Serializing?  Server Not Found?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9937.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>mosgath posted on Wednesday, January 12, 2011</h2><p>I am working in CSLA 4.0 with Silverlight.&nbsp; I have a created a command object derived from CommandBase that will be called to lock an order for a given user so others don&#39;t update it and returns the Order object in the proper state (ie readonly, editable).&nbsp; It uses a CriteriaBase object for parameters.&nbsp; If I do not use the OnGetState, OnSetState, OnGetChildren, OnSetChildren methods, the calls goes through, but the properties of the criteria object are null.&nbsp; Some of the properties are of&nbsp;a type derived from BusinessBase.&nbsp; If we call this using the aforementioned methods, we get a Server return error: Not Found in the silverlight client.&nbsp; The silverlight client is able to call other DataPortal methods without any issues.&nbsp; From other code samples I have seen, the logic for the on Children appear to be correct.&nbsp; Below is the sample from the Command object.&nbsp; The Criteria object implements the functions in a simliar manner.&nbsp; The data is when the OnGetChildren is set.&nbsp; The OnSetChildren creates new (blank) objects.&nbsp; Any thoughts on where I should look?</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected override void OnGetChildren(Csla.Serialization.Mobile.SerializationInfo info, Csla.Serialization.Mobile.MobileFormatter formatter)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.OnGetChildren(info, formatter);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (this.CurrentOrder!= null)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var fmt = formatter.SerializeObject(this.CurrentOrder);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; info.AddChild(&quot;Order&quot;, fmt.ReferenceId);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var _criteriaFmt = formatter.SerializeObject(this.Criteria);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; info.AddChild(&quot;OrderCheckOutCriteria&quot;, _criteriaFmt.ReferenceId);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected override void OnSetChildren(Csla.Serialization.Mobile.SerializationInfo info, Csla.Serialization.Mobile.MobileFormatter formatter)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (info.Children.ContainsKey(&quot;Order&quot;))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var data = info.Children[&quot;Order&quot;];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.CurrentOrder = (Order)formatter.GetObject(data.ReferenceId);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var _criteriaData = info.Children[&quot;OrderCheckOutCriteria&quot;];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.Criteria = (OrderCheckOutCriteria)formatter.GetObject(_criteriaData.ReferenceId);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.OnGetChildren(info, formatter);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Wednesday, January 12, 2011</h2><p>If you are subclassing CriteriaBase why wouldn&#39;t you just use managed backing fields and let CSLA do the work for you? You shouldn&#39;t have to manually do that serialization gunk - that&#39;s what the base classes are for...</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mosgath replied on Thursday, January 13, 2011</h2><p>I have switched everything back over to using the managed properties and removed all the OnGetChildren and OnSetChildren.&nbsp; However, I still get the Server Not Found Error.&nbsp; As I mentioned before, Before making the call to this command, I am able to call into my BusinessBase objects without issues.&nbsp; I did have a enum as a datatype that I switched to an Integer to see if that helped, but it didn&#39;t.</p>
<p>{: The remote server returned an error: NotFound.<br />&nbsp;&nbsp; at System.ServiceModel.AsyncResult.End[TAsyncResult](IAsyncResult result)<br />&nbsp;&nbsp; at System.ServiceModel.Channels.ServiceChannel.EndCall(String action, Object[] outs, IAsyncResult result)<br />&nbsp;&nbsp; at System.ServiceModel.ClientBase`1.ChannelBase`1.EndInvoke(String methodName, Object[] args, IAsyncResult result)<br />&nbsp;&nbsp; at Csla.WcfPortal.WcfPortalClient.WcfPortalClientChannel.EndUpdate(IAsyncResult result)<br />&nbsp;&nbsp; at Csla.WcfPortal.WcfPortalClient.Csla.WcfPortal.IWcfPortal.EndUpdate(IAsyncResult result)<br />&nbsp;&nbsp; at Csla.WcfPortal.WcfPortalClient.OnEndUpdate(IAsyncResult result)<br />&nbsp;&nbsp; at System.ServiceModel.ClientBase`1.OnAsyncCallCompleted(IAsyncResult result)<br />: The remote server returned an error: NotFound.<br />&nbsp;&nbsp; at System.Net.Browser.AsyncHelper.BeginOnUI(SendOrPostCallback beginMethod, Object state)<br />&nbsp;&nbsp; at System.Net.Browser.BrowserHttpWebRequest.EndGetResponse(IAsyncResult asyncResult)<br />&nbsp;&nbsp; at System.ServiceModel.Channels.HttpChannelFactory.HttpRequestChannel.HttpChannelAsyncRequest.CompleteGetResponse(IAsyncResult result)<br />: The remote server returned an error: NotFound.<br />&nbsp;&nbsp; at System.Net.Browser.BrowserHttpWebRequest.InternalEndGetResponse(IAsyncResult asyncResult)<br />&nbsp;&nbsp; at System.Net.Browser.BrowserHttpWebRequest.&lt;&gt;c__DisplayClass5.&lt;EndGetResponse&gt;b__4(Object sendState)<br />&nbsp;&nbsp; at System.Net.Browser.AsyncHelper.&lt;&gt;c__DisplayClass2.&lt;BeginOnUI&gt;b__0(Object sendState)<br />}</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Thursday, January 13, 2011</h2><p>Is it possible that the size of the serialized byte stream is extremely large and has blown out the size limits on WCF? That is a primary cause of the &quot;Not Found&quot; error.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mosgath replied on Thursday, January 13, 2011</h2><p>Thanks Rocky.&nbsp; That was definitely it.&nbsp; We set the following in the web.config of the service project that this resolved the issue.&nbsp; However, long term I am going to look at the compression option as well since we are using Silverlight.</p>
<p><span style="font-family:Courier New;">httpRuntime maxRequestLength=&quot;8192&quot; enable=&quot;true&quot; executionTimeout=&quot;60&quot; </span><br /></p>
<p>Related Post:</p>
<p><span style="color:#800000;font-size:x-small;"><span style="color:#800000;font-size:x-small;"><a href="http://forums.lhotka.net/forums/p/6463/31321.aspx">http://forums.lhotka.net/forums/p/6463/31321.aspx</a></span></span></p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
