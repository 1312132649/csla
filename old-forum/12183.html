<html><header><title>Hybrid DAL design to allow swappable DAL using Encapsulated Invocation</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Hybrid DAL design to allow swappable DAL using Encapsulated Invocation</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/12183.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>cwinkelmann posted on Monday, October 14, 2013</h2><p>I&#39;d like to see the CSLA creator&#39;s views of this hybrid of Factory and Encapsulated design to implement swappable DAL.</p>
<p>In this case, I have a BusinessObjects dll. In it, I have the Library and DAL namespace. Library contains all the sub name spaces for the actual CSLA Business Objects. They will implement the &quot;Encapsulated Invocation&quot; Model as detailed by the &quot;Using CSLA 4 Data Access&quot; book, BUT in this case the invocation is &quot;Coding to Interface&quot; instead of &quot;Coding to Implementation&quot; </p>
<p>Because there is a clear dependency between the DAL having to accept Business Objects as parameters and usually returning a DTO, the interfaces defining the contract for the DAL must be in the same assembly as the Library classes. If not, there would be a circular dependency that could only be broken by using exclusively DTO&#39;s for passing the data between assemblies. In this case the Library would be dependent on the DTO assembly and the DAL interfaces assembly. </p>
<p>The DAL interface will provide a DALLoader which reads the assembly config file to determine what assembly to create an instance in for a static field in the DAL namespace. This field / property can be reset and if the DAL instance is accessed again, the Loader will once again read the config file and create a new instance. I am also considering allowing the DALLoader to be specified by the config file or be set by application. </p>
<p>I have something working at the moment but it is directly against a SQL database and I have not made a DAL.Mock assembly yet... </p>
<p>I&#39;m curious if those who are experts here have points or criticism on this idea. I&#39;m not sure it can be incorporated in CSLA because it is executed within the DataPortal_xyz methods either in the Business Objects or the Object Factories. It can be used on either side Client/Server so it just seems too specific to the DAL design, but I&#39;d like to share the idea once it gets tested and comments given to improve on it... </p>
<p>Thanks very much ! </p>
<p>Chris</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, October 15, 2013</h2><p>Hi,</p>
<p>You may want to look at the<i> trunk\Samples\MEFSamples\Repository</i> sample i CslaContrib for an alternate version of how you can embed DI techniques inside the business base classes. Just select download to get all the source code on this page: </p>
<p><a href="http://cslacontrib.codeplex.com/SourceControl/latest">http://cslacontrib.codeplex.com/SourceControl/latest</a></p>
<p>The sample use MEF for DI but could easily be modified to use any DI container.&nbsp; This is based on working code in some of our applications. There is also another sample that shows ObjectFactory pattern with MEF.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
