<html><header><title>Editing child object in seperate window?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Editing child object in seperate window?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7647.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Thursday, September 17, 2009</h2>Hi,<br /><br />Using Csla 3.7.  I have what I would like to be a child object (BLB).  This collection could be large memory, and not used much, so I'd like to have it lazy loaded.  The UI is WinForms, and when editing this list I'd like to open another window.<br /><br />My question revolves around how to handle things so the edit levels stay synced.  Since the list will be in a seperate window, and I want lazy loading, I can't setup a binding source like I would usually for a child list.<br /><br />Is this feasible?  How would I set this up when I try to save the root object?  When the child window closes, do the EndEdit and unbind just this particular child list from the window, and no changes needed in the main form?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, September 17, 2009</h2><P>This is pretty hard due to the way WinForms data binding operates, unless this edit window is modal. That makes it possible at least.</P>
<P>Even with a modal form it is tough though, because the bindingsource for that form needs to be a child of the bindingsource on your main form. This pretty much means the bindingsource needs to be declared on the main form, and you'll pass a reference to that bindingsource to the modal edit form.</P>
<P>It probably helps if you also use the binding helpers Miguel wrote for CslaActionExtender, because then you can provide the modal form with a binding helper node associated with that child bindingsource. That way you can easily (and correctly) call Cancel() or Apply() as the modal form closes.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, September 17, 2009</h2><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>RockfordLhotka:</strong></div><div><P>This is pretty hard due to the way WinForms data binding operates, unless this edit window is modal. That makes it possible at least.</P></div></BLOCKQUOTE><br /><br />Yes, my intention is that the form would be modal.<br /><br /><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>RockfordLhotka:</strong></div><div><P>Even with a modal form it is tough though, because the bindingsource for that form needs to be a child of the bindingsource on your main form. This pretty much means the bindingsource needs to be declared on the main form, and you'll pass a reference to that bindingsource to the modal edit form.</P></div></BLOCKQUOTE><br /><br />This is the part that concerns me; I would expect that this setup would then cause the child collection property to be read, which defeats the purpose of the lazy loading.  Or maybe it would only load if the binding source is used to display something?<br /><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>RockfordLhotka:</strong></div><div><P>It probably helps if you also use the binding helpers Miguel wrote for CslaActionExtender, because then you can provide the modal form with a binding helper node associated with that child bindingsource. That way you can easily (and correctly) call Cancel() or Apply() as the modal form closes.</P></div></BLOCKQUOTE><br /><br />Yes, I've been starting to use the BindingSourceNode and BindingSourceHelper, and they have simplfied some of the forms I already have, very useful.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pabloing900 replied on Thursday, December 10, 2009</h2>Hi, I have the same problem <strong>ajj3085</strong> but i am using a wizard . It is a headache.<br>This is my thread<br>http://forums.lhotka.net/forums/thread/37809.aspx <br>but i get nothing. 0 Answer :-(<br>In my first screen i show the root then the user press Next button and fill child info.<br>When the user click next button for me&nbsp; or open/close a child form for you, we need to call applyedit without saving the bo and then rebind.<br>Then when the user close all forms for you or get finish screen wizzard for me, we can save the bo.<br>My code looks like this:<br><br><br>&nbsp;Private Sub RebindUI(ByVal saveObject As Boolean, ByVal rebind As Boolean)<br><br>&nbsp;&nbsp;&nbsp; ' disable events<br>&nbsp;&nbsp;&nbsp; Me.ProjectBindingSource.RaiseListChangedEvents = False<br>&nbsp;&nbsp;&nbsp; Me.ResourcesBindingSource.RaiseListChangedEvents = False<br>&nbsp;&nbsp;&nbsp; Try<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' unbind the UI<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UnbindBindingSource(Me.ResourcesBindingSource, saveObject, False)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UnbindBindingSource(Me.ProjectBindingSource, saveObject, True)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.ResourcesBindingSource.DataSource = Me.ProjectBindingSource<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' apply or cancel changes<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If saveObject Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mProject.ApplyEdit()<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mProject.CancelEdit()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br><br>&nbsp;&nbsp;&nbsp; Finally<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' rebind UI if requested<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If rebind Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BindUI()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' restore events<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.ProjectBindingSource.RaiseListChangedEvents = True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.ResourcesBindingSource.RaiseListChangedEvents = True<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If rebind Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' refresh the UI if rebinding<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.ProjectBindingSource.ResetBindings(False)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.ResourcesBindingSource.ResetBindings(False)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp; End Try<br><br>&nbsp; End Sub<br><br>In form_closing event of your last form you need to call save method. The trick is donÂ´t call save method and call&nbsp; BO.ApplyEdit() each time you show or close a form so you business object(BO) is always in consistent state. In the code you must to call RebindUI(true,true).<br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
