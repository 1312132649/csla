<html><header><title>Who is responsible?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Who is responsible?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/626.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Friday, July 14, 2006</h2>Hi all,<br><br>I'm reworking my PhoneNumbers and Phone objects to be able to 'belong' to any other root object; currently that is just a Contact, but I'm going to be adding PhoneNumbers to Company and Department objects.<br><br>In the database, I have&nbsp; Phone and PersonPhone (and soon CompanyPhone and DepartmentPhone).&nbsp; Its pretty clear the Phone object maintains the Phone table.&nbsp; It also doesn't seem like PhoneNumbers should know at all about PersonPhone. <br><br>So my question is, is it appropriate to have Contact (and Department and Company) manage the PersonPhone table?&nbsp; It seems reasonable to me, what does everyone else think?<br><br>Note that the changes from the UIs perspective would only be the addition of PhoneNumbers to Department and Company, so I think the BO design is good... just wanted to know what others have done to handle this.<br><br>Thanks<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonM replied on Saturday, July 15, 2006</h2><P>Andy,</P>
<P>I would recommend just having one table of phone numbers.&nbsp; I would also create a phoneNumbers child collection of editable child objects that you would reuse on each object you wanted to have phoneNumbers.&nbsp; The phoneNumber objects simply needs a foreign key to attach them to their parent (the CompanyID, PhoneID, or DepartmentID).&nbsp; If you are using integers for primary keys you may have to add an extra column to denote which group the number belongs to.&nbsp; If you are using GUIDs for primary keys then you should be all set.&nbsp; This is basically what I have done for my own system reguarding phone numbers (or ContactInfo), addresses, and contacts.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, July 17, 2006</h2>Jon,<br><br>I thought of this approach and I'm using ints for keys.&nbsp; The problem with this method is that you lose foreign key constriants, and it makes joins much messier (since i have to hardcode a typeId to join on).<br><br>I came up with what I think is a workable solution over the weekend; basically, I'll change my PhoneNumbers class from sealed to abstract.&nbsp; I'll add two methods, OnItemDeleting and OnItemSaved (with OnItemDeleted and OnItemSaving potentials for addition later) which will fire just before the number is about to be deleted or after its saved.&nbsp; I can then create subclasses, which will be internal to the assembly only, that provide implementation of those.&nbsp; In those methods, I'll handling working with the link tables.<br><br>Sounds reasonable to me, what about everyone else?<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>vargasbo replied on Monday, July 17, 2006</h2>How are you losing FK constraints? I haven't seen this issue before, so I'm curious. I did my phone number the way Jon talked about, so if I'm going to run into issue down the line, I would like to know now :-)<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, July 17, 2006</h2>You've denormalized some of the data, so you have a column, OwnerId (int).&nbsp; The owner could be a Department, Company or Contact.&nbsp; Since I have seperate Department, Company or Contact tables, I can't now create a foreign key constraint in Sql Server from OwerId to the parent table.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>vargasbo replied on Monday, July 17, 2006</h2>If you found something that works for you great! I don't have all the biz requirements in front of me, but I also if I need to know who my parent is, I set that when I load my child collection. Then you don't have to lose who the parent is.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tom Cooley replied on Monday, July 17, 2006</h2>Andy,<br><br><br>I would consider creating an IPhoneOwner interface:<br><br>interface IPhoneOwner<br>{<br>&nbsp;&nbsp;&nbsp; int OwnerId {get;set;}<br>&nbsp;&nbsp;&nbsp; string InsertSP {get;set;}<br>&nbsp;&nbsp;&nbsp; string UpdateSP {get;set;}<br>&nbsp;&nbsp;&nbsp; string DeleteSP {get;set;}<br>}<br><br>This way you can strongly type which root objects can own a phone number and abstract the few pieces that are different for each.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, July 17, 2006</h2>I use a DAL, so I wouldn't be able to work that approach since my BOs talk to 'data aware' objects without really know how its getting the data.&nbsp; I implemented the idea I came up with over the weekend, and it seems to work well.&nbsp; In the future when I need to let Departments and Companies have Phone Numbers, all I need to do is create the subclass and implement two short methods.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pelinville replied on Saturday, July 15, 2006</h2><DIV>I agree with JonM.&nbsp; Have one object of PhoneNumber.&nbsp;&nbsp; Have one collection definition PhoneNumbers. </DIV>
<DIV>&nbsp;</DIV>
<DIV>Person has a PhoneNumbers, Department has a PhoneNumbers etc.</DIV>
<DIV>&nbsp;</DIV>
<DIV>This means the PhoneNumbers maintains the Phone table.&nbsp; Each of the containing object then implements the rules for it with regards to PhoneNumber maintenance.</DIV>
<DIV>&nbsp;</DIV>
<DIV>Person, Department ect would have a linking table to denote what PhoneNumbers they have (PersonID, PhoneID)</DIV></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
