<html><header><title>Validation</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Validation</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9989.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ksavoie posted on Wednesday, January 26, 2011</h2><p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">Hi </span></p>
<p><span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">We are using CSLA version 2.0 on .NET 2.0 VS2005.&nbsp; In my project, I&#39;m using a datagridview, with child data.&nbsp; In the design, we add extra rows to the datagridview on the Fetch.&nbsp;&nbsp; We do this so that the user doesn&#39;t have to add&nbsp;additional rows; they are only allowed a certain number.&nbsp; Any ways that works great, I specify the mandatory fields (all the ID&#39;s that I need), and the rows are added to my Datagridview.</span></span></p>
<p><span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">In the datagridview, we have a column which does the calculation of other columns.&nbsp; So I created a new property&nbsp;&quot;</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Public</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">ReadOnly</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Property</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> TotalEstCost() </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">As</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">String</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">&quot;.&nbsp; Here is the bit of code...</span></span><span></span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Private</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> _totalEstCost </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">As</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">String</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> = </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">String</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">.Empty</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;"></span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Public</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">ReadOnly</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Property</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> TotalEstCost() </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">As</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">String<br />Get<br /></span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:green;font-size:10pt;">&#39;Declare the variables<br /></span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Dim</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> decTaxAmount </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">As</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Decimal<br />Dim</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> decEstimCost </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">As</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Decimal<br />Dim</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> decTotalEstCost </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">As</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Decimal<br />Dim</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> strTotalEstCost </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">As</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">String</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;"></span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">If</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> GSTHSTAmount &lt;&gt; </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:maroon;font-size:10pt;">&quot;&quot;</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Then<br /></span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">decTaxAmount = </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Decimal</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">.Parse(GSTHSTAmount)<br /></span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Else<br /></span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">decTaxAmount = 0<br /></span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">End</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">If</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;"></span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">If</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> CstAmtDlrsStr &lt;&gt; </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:maroon;font-size:10pt;">&quot;&quot;</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Then<br /></span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">decEstimCost = </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Decimal</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">.Parse(CstAmtDlrsStr)<br /></span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Else<br /></span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">decEstimCost = 0<br /></span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">End</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">If </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;"></span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">decTotalEstCost = decTaxAmount + decEstimCost</span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">If</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> decTotalEstCost = 0 </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Then<br /></span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">strTotalEstCost = </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">String</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">.Empty<br /></span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Else<br /></span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">strTotalEstCost = decTotalEstCost<br /></span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">End</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">If </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;"></span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">_totalEstCost = </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:maroon;font-size:10pt;">&quot;0.00&quot; </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;"></span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Return </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">strTotalEstCost </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;"></span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">End</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Get</span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">there might be some unnecessary coding... but I&#39;m trying everything now...&nbsp; Like I said everything works fine,&nbsp;until I add the Validation rules. </span></p>
<p><span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">These are my validation rule that&#39;s giving me problems...</span></span></p>
<p><span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:green;font-size:10pt;">&#39; Total Cost<br />&#39; Rule # 2008<br /></span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">ValidationRules.AddRule(</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">AddressOf</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> Csla.Validation.CommonRules.StringRequired, </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:maroon;font-size:10pt;">&quot;TotalEstCost&quot;</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">)</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;"></span></span>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">ValidationRules.AddRule(</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">AddressOf</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> Csla.Validation.CommonRules.RegExMatch, </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">New</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> Csla.Validation.CommonRules.RegExRuleArgs(</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:maroon;font-size:10pt;">&quot;TotalEstCost&quot;</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">, </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:maroon;font-size:10pt;">&quot;^\d{1,11}(?:\.\d\d)?$&quot;</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">))</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;"></span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">ValidationRules.AddRule(</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">AddressOf</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> Csla.Validation.CommonRules.StringMaxLength, </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">New</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> Csla.Validation.CommonRules.MaxLengthRuleArgs(</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:maroon;font-size:10pt;">&quot;TotalEstCost&quot;</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">, 13))</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;"></span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">When I load my windows form, I keep getting the red warning on the empty rows and when I try to save it obviously doesn&#39;t save because of validation issue.</span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">Can anybody help me with this one.&nbsp;&nbsp;Am I&nbsp;making a mistake i the way I created my property or my declaration of my variable.&nbsp; Any help would be&nbsp;greatly appreciated.</span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">Thanks</span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">Kat&nbsp;</span></p>
</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
