<html><header><title>ObjectFactoryAttribute</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ObjectFactoryAttribute</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5387.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jmcd posted on Thursday, September 11, 2008</h2>I have been trying to get an implementation of the ObjectFactoryAttribute working (based on Rocky's blog post http://www.lhotka.net/weblog/CSLANETObjectFactoryAttribute.aspx).<br /><br />Unfortunately, I'm having trouble with the following:<br />1. How does the Create method create a new instance of a BusinessObject without calling a public constructor or calling the static Create method (which would recall the object factory resulting in an infinite loop)?<br />2. In the Fetch method, how do you populate a business object with values obtained from the DataLayer (as these fields are private)?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>sergeyb replied on Thursday, September 11, 2008</h2>I guess it all depends why you are following factory pattern.<br />1. Activator class should create an instance of your object in .NET even if it only has a private constructor.<br />2. I think you would need to create an internal method in your class that would accept field values and populate them, or you can simply set the public properties, which is easier.  When you are done, just mark object as old - you have a helper method for that in base factory class as in MarkOld(target) where target is an instance of your class.<br /><br />Sergey Barskiy<br />Principal Consultant<br />office: 678.405.0687 | mobile:&#160;404.388.1899<br />Magenic &#174;<br />Microsoft Worldwide Partner of the Year | Custom Development Solutions, Technical Innovation<br />-----Original Message-----<br />From: jmcd [mailto:cslanet@lhotka.net] <br />Sent: Thursday, September 11, 2008 8:16 AM<br />To: Sergey Barskiy<br />Subject: [CSLA .NET] ObjectFactoryAttribute<br /><br />I have been trying to get an implementation of the ObjectFactoryAttribute working (based on Rocky's blog post http://www.lhotka.net/weblog/CSLANETObjectFactoryAttribute.aspx).<br /><br />Unfortunately, I'm having trouble with the following:<br />1. How does the Create method create a new instance of a BusinessObject without calling a public constructor or calling the static Create method (which would recall the object factory resulting in an infinite loop)?<br />2. In the Fetch method, how do you populate a business object with values obtained from the DataLayer (as these fields are private)?<br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Friday, September 12, 2008</h2><P>The simplest solution to both questions is an internal constructor on your business object that accepts a data reader or whatever you are using with data access.&nbsp; You could optionally have the constructor accept a dictionary so that it isn't tied to a specific data access technology.&nbsp; I've extended DataMapper to include methods to map a data reader to a dictionary for just such a purpose.</P>
<P>The approach Sergey describes is certainly valid as well.&nbsp; Here you could have a private constructor (or protected if you see the next for extensibility) that is used by the Activator.&nbsp; Then have an internal&nbsp; or protected internal (or even public) Initialize method that accepts a dictionary or NameValueCollection of property/value pairs to populate the object.</P>
<P>Be careful of the scope you choose depending on whether the factory is in the same assembly or not.</P>
<P>HTH</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
