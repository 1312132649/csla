<html><header><title>Accessing data upwards</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Accessing data upwards</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7091.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>whelzer posted on Friday, June 12, 2009</h2>Hi,<br><br>I got the following situation<br><br>Customer (BB)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IndividualList (BLB)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Individual (BB)<br><br>I need access to Customer properties from Individual (within Validation Rules in particluar).<br><br>Am using csla 3.5/vb 2008.&nbsp; Any help much appreciated.<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;  &nbsp; <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tom_W replied on Saturday, June 13, 2009</h2>This thread covers reading grandparent properties from a grandchild:&nbsp; <a HREF="/forums/thread/27073.aspx">http://forums.lhotka.net/forums/thread/27073.aspx</a><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>whelzer replied on Saturday, June 13, 2009</h2>Tom,<br><br>Thanks for te reply, I had spotted that thread but its not happening for me, I've put this in the chld list (Individuals):<br><br>Friend ReadOnly Property MyParent() As CustomerEdit<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return Me.Parent<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Property<br><br>And in the Individual object I've got this in a rule method:<br><br>&nbsp;If Not target.Parent Is Nothing Then<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim objParent As Individuals = CType(target.Parent, Individuals)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If objParent.MyParent.SourceId = 1 Then<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If target._email = "" Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.Description = "Email Required."<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return True<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br><br>I get a "Object reference not set to an instance of an object" exception when I attempt to access the Myparent.SourceId ..think it could be small enough issue - I've just spent far too long looking at it!!<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tom_W replied on Saturday, June 13, 2009</h2>What you're doing looks right to me.&nbsp; Is there any chance that 'target' hasn't been set correctly?&nbsp; I'm assuming that target is a parameter passed into the rule function and is of type Individual?&nbsp; <br><br>If you stick a breakpoint in code somewhere (before calling the rule) can you inspect the parent Customer and check that it's Individuals collection has correctly got it's parent set to the Customer collection?<br><br>If that works, then if you stick a breakpoint in the rule, and then look at target and target.Parent do these have values, and do they refer to the same objects as you saw from the breakpoint in the Individuals collection's constructor?<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>whelzer replied on Sunday, June 14, 2009</h2>Its the new property on Individuals.<br><br>&nbsp;Friend ReadOnly Property MyParent() As CustomerEdit<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return Me.Parent<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Property<br><br>It always returns nothing - for existing objects, when creating new ones, etc.<br><br>Whilst I'm using v 3.52 I still using 3.0.4 syntax could this be a factor?<br><br>Has anybody successfully implemented this structure to access Root Parent properties.<br><br>If there are better approaches I'll happily look at them (events? ) I badly need this working asap.<br><br>Thanks<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>acgritt replied on Monday, June 15, 2009</h2>One thing you could try is hooking up the On List Changed event to the list of Individuals in the Customer object and then when a child is modified catch the event and have the Validation Rule exist on your Customer object.&nbsp; You just have to make sure that you reconnect the OnListChanged event in the override for OnDeserialized so that when the Business Object go across the wire it will reset the event hookup.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>whelzer replied on Monday, June 15, 2009</h2>Came up with a <b>horrible </b>solution - I put SourceId on object Individual, in the property of SourceId on CustomerEdit...<br><br>For each i as individual in _myIndividuals<br>&nbsp;&nbsp;&nbsp; i.SourceId = _SourceId<br>next i <br><br>Its not pretty but it done the job...for now, will only ever have 3 or 4 individuals max.<br><br>We plan on converting this set of objects to use 3.52/3.6 properly in about a months time - so I'll revisit issue then. Hopefully I'll be up to stratch on the new property Info stuff and the new Parent/Child features.<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tom_W replied on Tuesday, June 16, 2009</h2>Congratulations on finding a solution.<br><br>I finally got a chance to try this with ProjectTracker and it seemed like the Parent property had the same issue with returning nothing when I was looking at the ProjectResources collection, so I'm guessing there's a step we're missing somewhere to get the Parent property working correctly.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
