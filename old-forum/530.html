<html><header><title>Sorting FilterableCollectionBase</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Sorting FilterableCollectionBase</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/530.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>pmaher posted on Monday, July 03, 2006</h2><FONT size=2>
<P>I've created a reusable UI control that encapsulates a DataGridView and allows filtering with the FilterableCollectionBase.</P>
<P>I wanted to make the class generic in order to specify a RootList for the rows and a Child type to reflect upon for enabling features of the control. I ran into the problem that VisualStudio2005 will not allow me to put a control implemented as a generic class into the ToolBox. To get around this problem I created a "generic method" so the UI developer can still specify a list and child type.</P>
<P>public void SetDataSource&lt;T&gt;(IList&lt;T&gt; list, Type type )</P>
<P>I can set the datasource to the full list or to a filtered list depending on user input through the control. The user can use the column headers to sort based on the column values. This works well for sorting 'OR' for filtering. The problem I've encountered is when the user filters the original list and then clicks the column header of the DataGridView to sort the filtered rows. The DataGridView throws an exception stating "DataGridView control cannot be sorted if it is bound to an IBindingList that does not support sorting." </P>
<P>It appears that the FilterableCollectionBase returns a collection that does not support sorting. It would seem that an easy solution would be to pass the filtered collection through SortedBindingList&lt;T&gt; to get a sortable collection before setting it to the datasource of the DataGridView. My problem here is that the type inference &lt;T&gt; is only valid within the generic method.</P>
<P>Is there a way to instantiate a SortedBindingList&lt;T&gt; with only a reference to the list?</P>
<P>Has anyone made FilterableCollectionBase sortable?</P>
<P>Has anyone else out there run into similar problems? </P>
<P>Any help would be appreciated.</P>
<P>Thanks,</P>
<P>Pat</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, July 18, 2006</h2>You might try the (not yet released) FilteredBindingList&lt;&gt; that is coming in version 2.1. The C# code is in cvs (<A href="http://www.lhotka.net/cslacvs">www.lhotka.net/cslacvs</A>) under the 2.1 branch.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pmaher replied on Wednesday, July 19, 2006</h2><P>I went to <A href="http://www.lhotka.net/cslacvs">www.lhotka.net/cslacvs</A> but can't find a 2.1 branch</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, July 19, 2006</h2>First get into the csla20cs subfolder, then you can use the Sticky Tag combobox to choose the V2-1 branch.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, July 19, 2006</h2>I should point out that you need several files - FilteredBindingList, IFilterable, FilterProvider and DefaultFilter.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>markmconel replied on Friday, July 21, 2006</h2><P>Maybe I'm lacking investigative skills, however, I'm unable to find the 2.1 branch in cvs. I was hoping to play around with and possibly finish the incomplete FilteredBindingList&lt;&gt;. Is this missing or am I blind? Thanks in advance.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>markmconel replied on Friday, July 21, 2006</h2>Sorry about this post. I am also lacking reading ability since I didn't read the entire thread before responding.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, July 21, 2006</h2>For those interested, the VB version of FilteredBindingList is now in the V2-1 branch of cvs as well.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
