<html><header><title>Specifying criteria when using codesmith?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Specifying criteria when using codesmith?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5612.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>reagan123 posted on Thursday, October 16, 2008</h2>Hello,<br>I've finally had a few minutes to mess around with some of the CSLA templates for CodeSmith.&nbsp; I have run into an issue that I was hoping someone could help me with.<br><br>Is there a way to specify the criteria used for our fetch for classes generated from&nbsp; ReadOnlyRootList.cst.&nbsp; It looks like the criteria is just an empty class so the fetch will get all of the records.&nbsp; I'd like to be able to fetch a list based on a guid and also fetch one based on a string.<br><br>Hopefully i'm just overlooking something.<br><br>Thanks as usual.<br><br><i>I'm using the CSLAcontrib-41428 templates<br>VB<br>CSLA 2.0<br></i><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>reagan123 replied on Thursday, October 16, 2008</h2>Here is the generated code so far....<br><br>=================================================<br>Imports System<br>Imports System.Data<br>Imports System.Data.SqlClient<br>Imports Csla<br>Imports Csla.Data<br><br>Namespace BusinessObjects.Person<br><br>&nbsp;&nbsp; &nbsp;&lt;Serializable()&gt; _<br>&nbsp;&nbsp; &nbsp;Public Class PersonInfoList<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Inherits&nbsp; Csla.ReadOnlyListBase(Of PersonInfoList, PersonInfo)<br><br>#Region " Authorization Rules "<br><br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Public Shared Function CanGetObject() As Boolean<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;'TODO: Define CanGetObject permission in PersonInfoList<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Return True<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;'If Csla.ApplicationContext.User.IsInRole("PersonInfoListViewGroup") Then<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;'&nbsp;&nbsp; &nbsp;Return True<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;'End If<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;'Return False<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;End Function<br><br>#End Region ' Authorization Rules<br><br>#Region " Factory Methods "<br><br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Private Sub New()<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;'require use of factory method<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;End Sub<br><br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Public Shared Function GetPersonInfoList() As PersonInfoList <br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;If Not CanGetObject() Then<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;throw new System.Security.SecurityException("User not authorized to view a PersonInfoList")<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;End If<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Return DataPortal.Fetch(Of PersonInfoList)(New FilterCriteria())<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;End Function<br><br>#End Region ' Factory Methods<br><br>#Region " Data Access "<br><br>#Region " Filter Criteria "<br><br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;Serializable()&gt; _<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Private Class FilterCriteria<br><br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Public Sub New()<br><br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;End Sub<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;End Class<br><br>#End Region<br><br><br>#Region " Data Access - Fetch "<br><br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;Transactional(TransactionalTypes.TransactionScope)&gt; _ <br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Private Overloads Sub DataPortal_Fetch(ByVal criteria As FilterCriteria)<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;RaiseListChangedEvents = False<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;IsReadOnly = False<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Using cn As SqlConnection = New SqlConnection(Database.UAS_WBConnection)<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;cn.Open()<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;ExecuteFetch(cn, criteria)<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;End Using<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;IsReadOnly = True<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;RaiseListChangedEvents = True<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;End Sub<br><br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Private Sub ExecuteFetch(ByVal cn As SqlConnection, ByVal criteria As FilterCriteria)<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Using cm As SqlCommand = cn.CreateCommand()<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;cm.CommandType = CommandType.StoredProcedure<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;cm.CommandText = "esp_personinfolist_select"<br><br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Using dr As SafeDataReader = New SafeDataReader(cm.ExecuteReader())<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;While dr.Read()<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;Me.Add(PersonInfo.GetPersonInfo(dr))<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;End While<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;End Using<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;End Using<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;End Sub<br><br>#End Region ' Data Access - Fetch<br>#End Region ' Data Access<br><br>&nbsp;&nbsp; &nbsp;End Class<br><br>End Namespace</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, October 17, 2008</h2><P>I have not worked with the community version of the templates in a long time.</P>
<P>A key concept is that they are a "starting point" for you. Most developers then enhance them for their specific environment and coding styles.</P>
<P>So if you DB has&nbsp;a PK of GUID and UniqueIndex of String then you can point to a table and have the template add the extra Criteria classes and factory methods to your code. (Of course you have to write the extra template code to do this and then it will work for all tables that have those constraints.)</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>reagan123 replied on Friday, October 17, 2008</h2>Thanks for the reply... I assumed I would have to modify the existing template to get something like this to work, but wasn't 100% how to to actually do this.&nbsp; :)<br><br>Atleast I was on the right track.&nbsp; I'll start messing around with the template to see if I can get it.<br><br>On another note, would anyone here be willing to share what their custom templates look like?&nbsp; I'd be curious to see what types of things people are doing with their CSLA classes.<br><br>Or maybe just a description of some of the customizations you have done?<br><br>Thanks!<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
