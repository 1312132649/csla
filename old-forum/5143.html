<html><header><title>Binding DataGridView column to a Child object property</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Binding DataGridView column to a Child object property</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5143.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>sroberts posted on Wednesday, July 23, 2008</h2><P><FONT face=Arial>I've run into a problem that I fear may be a limitation of the current Microsoft DataGridView control.</FONT></P>
<P><FONT face=Arial>The limitation being that I can't seem to bind a <STRONG>DataGridViewComboBoxColumn</STRONG> to the property of a child object exposed through a parent object.</FONT></P>
<P><FONT face=Arial>To further clarify, I have the DataGridView bound to a Binding Source that is bound to a parent object called <STRONG>Association</STRONG>.</FONT></P>
<P><FONT face=Arial>Each <STRONG>Association</STRONG> object&nbsp;exposes various standard get/set type&nbsp;properties of the base types (int, string etc) and the Data Grid works fine for these, however one of the properies is a child object called <STRONG>Role</STRONG>.</FONT></P>
<P><FONT face=Arial>The <STRONG>Role</STRONG> object is used to represent an ID selectable property, that also provides a ToString equivalent and also a function to provide the lookup list of values to the UI. </FONT></P>
<P><FONT face=Arial><FONT size=2><EM>(just a quick note why I'm using a child object here...I prefer to handle the provision of providing the correct lookup list in the Business Object as opposed to placing this code in all the UI's that bind to it. Therefore my role object wraps up an ID&nbsp;property get/set accessor, a ToString()&nbsp;function&nbsp;and&nbsp;a LookupList() function that is used by the UI's to bind a combobox to)</EM></FONT></FONT></P>
<P><FONT face=Arial>I've bound the <STRONG>DataPropertyName</STRONG> of the colum to <STRONG>Role</STRONG>.ID, which via the binding source on the parant object, I was hoping would resolve down through the child (<STRONG>Role</STRONG>) to it's ID property.</FONT></P>
<P><FONT face=Arial>The combobox column binds the list of values using LookupList and the combo box populates with the correct list of values, and when I select a value the text appears in the grid, however I have a breakpoint on the Set of the ID field within the <STRONG>Role</STRONG> object and this never fires, so I can tell the ID of the selected combobox entry is not getting pushed down to the object.</FONT></P>
<P><FONT face=Arial>I've done some searching on the internet and found various posts that refer to what I need to do, but the workarounds seem to involve hacks that I don't think will work for CSLA </FONT></P>
<P><FONT face=Arial>(</FONT><A href="http://www.developer-corner.com/Resources/KnowledgeBase/tabid/118/articleType/ArticleView/articleId/28/DataGridView-how-to-bind-nested-objects.aspx"><FONT face=Arial>http://www.developer-corner.com/Resources/KnowledgeBase/tabid/118/articleType/ArticleView/articleId/28/DataGridView-how-to-bind-nested-objects.aspx</FONT></A><FONT face=Arial>)</FONT></P>
<P><FONT face=Arial>Or a posting back in 2006 from <SPAN class=inlineLink>Mark Rideout</SPAN>&nbsp;(the then '<SPAN>DataGridView Program Manager') that "...<SPAN>The DataGridView does not support databinding to child properties like you want. You'll need to resort to using the toString workaround..." (<A href="http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=94640&amp;SiteID=1">http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=94640&amp;SiteID=1</A>)</SPAN><o:p></o:p></SPAN></FONT></P>
<P><FONT face=Arial>Has anyone else had to tackle this with CSLA and succeeded ?</FONT></P>
<P><FONT face=Arial>Regards,</FONT></P>
<P><FONT face=Arial>S.Roberts</FONT></P>
<P><FONT face=Arial></FONT>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
