<html><header><title>New row cancell problem with Infragistics UltraGrid</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>New row cancell problem with Infragistics UltraGrid</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4160.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>cslafish posted on Friday, January 11, 2008</h2><P>I'm using a ultragrid binding to a child businesslist. Since I used a factory method in the parent class to create new item and the default constructor is private so I have to overwrite the grid's BeforeRowInsert event in which I call the factory method to create a new item then invoke e.calcel = true.</P>
<P>The problem is if there exists row(s) in the grid, everything is fine, but if there's no row in the grid, if I click the bottom row to insert a new row, then click off it, it's not removed.</P>
<P>Anyone any point will be appreciated.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Dawn replied on Saturday, January 12, 2008</h2>Hi cslafish,<br><br>Forgive me not understand you clearly. <br><br>1. If you want the UltraGrid to allow add new row, you can override child businesslist 's AddNewCore method, and in the child businesslist's constructor set AllowNew to true, then set the UltraGrid.Displayout.Override.AllowAddNew to corrsponding value.<br><br>2. If you want to cancel the new row, just press ESCAPE twice, the the UltraGrid will call the business child's CancelEdit, which will remove it from it's parent collection. But I found it work on CSLA 2.0.3.&nbsp; For CSLA 3.0.2 it's doen't .&nbsp; And this is what&nbsp; I want to ask Rocky:<br><br>In CSLA 2.0.3, when the grid call BusinessBase's IEditableObject.BeginEdit(), will incur the CopyState call(), the below line will cascade the call to child business list object:<br><br><font color="#008000">// this is a child object, cascade the call<br>&nbsp;((Core.IUndoableObject)value).CopyState();<br><br><font color="#000000">but in 3.0.2, it's change to<br><br><font color="#006400">// this is a child object, cascade the call<br>&nbsp;if (!_bindingEdit)<br>&nbsp;&nbsp;&nbsp;&nbsp; ((Core.IUndoableObject)value).CopyState(this.EditLevel + 1);<br><br><font color="#000000">And in BusinessBase's </font></font></font></font>IEditableObject.BeginEdit(), you have set <br>&nbsp;&nbsp;&nbsp; <font color="#008000">if (!_disableIEditableObject &amp;&amp; !BindingEdit)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BindingEdit = true;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BeginEdit();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</font><br>this means the child's CopyState will not called when Control call the BO's IEditableObject.BeginEdit(),&nbsp;&nbsp; so, Rocky, why if not bindingEdit, then get child's<br>CopyState call?<br><br>Thanks.<br><font color="#008000"><font color="#000000"><br></font></font><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Dawn replied on Saturday, January 12, 2008</h2>Find a solution to last post.<br><br>I found when the BO's IEditableObject.CancelEdit called, which will finally get BindableBase's OnUnknownPropertyChanged get called, the 3.0.2 implemention of this methods is :<br><br><font color="#006400">OnPropertyChanged(string.Empty);<br><br><font color="#000000">which case UltraGrid to call the child object' IEditableObject.BeginEdit, so the child's EditLevel back to origion,&nbsp; it's doesn't remove it self from the parent collection.&nbsp; But in 2.0.3 the implement is :<br><br><font color="#006400">PropertyInfo[] properties =<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GetType().GetProperties(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BindingFlags.Public | BindingFlags.Instance);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (PropertyInfo item in properties)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OnPropertyChanged(item.Name);</font><br><br>this doesn't&nbsp; incur the IEditableObject.BeginEdit. So,&nbsp; which I can do is Drive from 3.02&nbsp; BusinessBase, override it's </font></font>OnUnknownPropertyChanged.&nbsp; I'm using Infragistics V6.3.<br>Good luck.<br><font color="#006400"><font color="#000000"><br></font></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cslafish replied on Saturday, January 12, 2008</h2><P>Hi Dwan, thank you for the reply, I didn't use the way of overwriting AddNewCore method of BusinessList because we have to call the factory method of its parent BusinessObj to create new child since some properies of child are calculated by parent's propertis.&nbsp;That's why I catch BeforeRowInsert event of UltraGrid. And also pressing 'ESC' twice doesn't work since usually the scenario is when user view the form, if he clicks the bottom row by mistake and then click off that row, the new row should be removed, should not force user to press 'ESC' to cancel since he's not intent to create a new row.</P>
<P>The problem now is when there's at least 1 row in the grid, everything works fine, click the bottom and then click on any other place, the row can be removed automatically, but if there's no row in it, click to add new row then click off, that new row won't be cancelled. Wondering&nbsp;if anybody used&nbsp;BeforeRowInsert event before.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Dawn replied on Saturday, January 12, 2008</h2>Hi, Cslafish<br>which i mentioned can cancel the new row automatically if you just click other place.&nbsp; I think this is more uniform methods. Beacuse even the child need it's parent to create it , you can cache the Parent&nbsp; in BusinessList when it's get created, so overrides the businessList's AddNewCore, you'll get the information about parent, you don't blending business logic to UI.&nbsp; press 'ESC' twice apply to the newly added row even is modified by user in UltraGrid, othrewise you click other place it's will cancel it automatically.<br><br>Hope this help.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, January 14, 2008</h2>Well the whole idea behind overriding AddNewCore is so that you can create the object via its factory method.&nbsp; I would try doing that, and not doing the BeforeRowInitialize, or whatrever you're doing now.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cslafish replied on Monday, January 14, 2008</h2>Likely BeforeRowInsert is problematic, I'll do AddNewCore. Thank you guys.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
