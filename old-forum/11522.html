<html><header><title>Edit level mismatch in Object while taking caption from Resource (Random Error)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Edit level mismatch in Object while taking caption from Resource (Random Error)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11522.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Snehal posted on Thursday, August 09, 2012</h2><p>Hi,</p>
<p>i am getting random error while initialize an object. when am opening form some times its giving above error and some time not. While debugging i found error is coming in following place.</p>
<p>In DataPortal_Create i check for&nbsp; ValidationRules.CheckRules()</p>
<p>On validation rules its goes to following function</p>
<p>Private Shared Function AccountExist(ByVal target As Consignment, ByVal e As Csla.Validation.RuleArgs) As Boolean<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim RetVal As Boolean<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Account.Exists(target.AccountCode) Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RetVal = True<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RetVal = False<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>e.Description = InfoCenter.GetDisplayTextFromResource(&quot;AccountisRequired&quot;)</b><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return RetVal<br /><br />&nbsp;&nbsp;&nbsp; End Function</p>
<p>for above function it goes to false part and trying to get msg from resource. below is resource function.</p>
<p>&nbsp;</p>
<p>Public Shared Function GetDisplayTextFromResource(ByVal Key As String) As String<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim loc As WPFLocalizeExtension.Extensions.LocTextExtension = Nothing<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim strRetVal As String = &quot;&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; loc = New WPFLocalizeExtension.Extensions.LocTextExtension() &#39; &quot;ResourceAssembly:resCommon:&quot; &amp; Key)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; loc.Assembly = &quot;ResourceAssembly&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; loc.Dict = &quot;resCommon&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; loc.Key = Key<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>loc.ResolveLocalizedValue(strRetVal)</b><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return strRetVal<br /><br /><br />&nbsp;&nbsp;&nbsp; End Function</p>
<p>&nbsp;</p>
<p>I am getting over on bold line that &quot;Edit level mismatch in Object&quot;. if i open same form again its not firing any error. can anybody help me...!!!</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, August 09, 2012</h2><p>You should look closely at the Ioc container configuration (and possibly a singelton instance?) . </p>
<p>It would seem that the Ioc resolves into an already existing object that is likely to be active in databinding. <br />The exception is typically thrown from BeginEdit/CancelEdit/ApplyEdit and these methods are mostly called by DataBinding. </p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
