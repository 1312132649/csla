<html><header><title>Windows Authentication but Custom Authorization</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Windows Authentication but Custom Authorization</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2439.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>RobKraft posted on Tuesday, February 27, 2007</h2><P>I feel what I am attempting should be reasonably simple but I keep getting stumped on every approach.&nbsp; I would like to use Windows Authentication for my web app, but then take the Windows LogonID and map it to a Custom LogonID in a database to obtain permissions.&nbsp; I created a Custom Principal and&nbsp;a Customer Identity (modeled after PTTracker) and I can assign them both to Csla.<FONT color=#2b91af>ApplicationContext</FONT>.User.&nbsp; However, they don't stay there.&nbsp; Am I supposed to be able to get them to stay there?&nbsp; Each time Application_AuthenticateRequest is called, the Csla.<FONT color=#2b91af>ApplicationContext</FONT>.User has been replaced with WindowsIdentity and WindowsPrincipal.</P>
<P>My goal is to capture the user's windows logon info, then build a GenericIdentity and GenericPrincipal that I can use on server or client side anywhere within the app.&nbsp; I feel I am missing something very basic.&nbsp; Any guidance would be greatly appreciated.&nbsp; I've spent days on trying to do this.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, February 28, 2007</h2>What is your CslaAuthentication set as in your .config file?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RobKraft replied on Wednesday, February 28, 2007</h2><P>Thanks for the reply.&nbsp; I checked and I did not have any entry in my web.config.&nbsp; However, adding the entry did not help (regardless of the value).&nbsp; That led me to checking other things though and I discovered that I was missing a command like this:</P><FONT color=#2b91af size=2>
<P>HttpContext</FONT><FONT size=2>.Current.Session[</FONT><FONT color=#a31515 size=2>"CslaPrincipal"</FONT><FONT size=2>] = Csla.</FONT><FONT color=#2b91af size=2>ApplicationContext</FONT><FONT size=2>.User;</FONT></P>
<P><FONT size=2><FONT size=3>And I think that was the source of my problem.&nbsp; I also was putting code in <FONT size=2>Application_AuthenticateRequest </FONT></FONT></FONT>but I needed to move it to Session_Start (not sure why yet).</P>
<P>Anyway, I am moving forward and I will post my results when I get all the kinks worked out.&nbsp; My goal is to have an app that can use Windows or Forms Auth.&nbsp; If it is Windows Auth, then the app will generate a token for the user and actually use Forms Auth.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tarekahf replied on Monday, April 14, 2008</h2>RobKraft,<br><br>I am interested in the method you followed to use Windows Authentication and Custom Role Authorization with CSLA.<br><br>I appreciate it if you could post the details.<br><br>Regards ...<br><br>Tarek.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
