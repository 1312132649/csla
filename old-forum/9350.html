<html><header><title>Binding PropertyStatus to an indexer</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Binding PropertyStatus to an indexer</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9350.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>smumcounty posted on Tuesday, August 10, 2010</h2><p>I am using CSLA with Silverlight and trying to bind a PropertyStatus control to a property using an indexer: </p>
<p>&nbsp;</p>
<p><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><font face="Consolas" size="2" color="#0000ff"><font face="Consolas" size="2" color="#0000ff"><font face="Consolas" size="2" color="#0000ff">
<p>&lt;</p>
</font></font></font></span><font face="Consolas" size="2" color="#0000ff"><font face="Consolas" size="2" color="#0000ff">
<p>&nbsp;</p>
</font></font></span><font face="Consolas" size="2" color="#0000ff">
<p>&nbsp;</p>
</font></span></p>
<p><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;">csla</span></span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">:</span></span></span><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;">PropertyStatus</span></span></span><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"> </span></span></span><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;">Property</span></span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">=&quot;{</span></span></span><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;">Binding</span></span></span><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"> Path</span></span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">=Model.Custom[CustomText].Value}&quot;</span></span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">/&gt;</span></span></span></p>
<p><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">
<p><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"></span></span></span></p>
</span></span></span>
<p>I&#39;m getting an &quot;Object instance not set to an instance of an object&quot; error when I do this. It looks like the PropertyStatus.GetRealSource method can&#39;t make sense of the indexer syntax. </p>
<p>Is there a binding syntax I can use to get this to work or will the PropertyStatus control simply not work with an indexer?</p>
</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Tuesday, August 10, 2010</h2><p>Quite a few things don&#39;t work with indexers - PropertyStatus being just one of them. I don&#39;t think any managed backing fields, or PropertyInfo&lt;T&gt; or any of that infrastructure would work either.</p>
<p>Indexers are a way of creating a collection-like interface. If you need such an interface, you should put the elements into a BusinessListBase so they can be managed as a collection. Or if you don&#39;t need all the BLB functionality, you can use MobileList&lt;T&gt;.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>smumcounty replied on Tuesday, August 10, 2010</h2><p>My application, allows clients to create their own custom properties associated with a business entity. I was attempting to create a child Custom class that would hold the custom properties. Each of the custom properties would be accessed through the indexer of the Custom class using the name of the property. Each CustomProperty class contains a Value and a Label property. I have no problem binding prompts to Custom[CustomPropertyName].Value and Custom[CustomPropertyName].Label.&nbsp; So that works well. The Value property is a managed field which can have broken rules so my hope was to bind the PropertyStatus control to Custom[CustomPropertyName].Value. But as you note the PropertyStatus control is not designed to handle the indexer syntax.</p>
<p>How could I use the BusinessListBase in this scenario to allow me to bind to the PropertyStatus control?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>smumcounty replied on Tuesday, August 10, 2010</h2><p>A little more information: </p>
<p>The Custom class has a CustomProperties property which is derived from BusinessListBase and whose members are of type CustomProperty which is derived from BusinessBase. The indexer on the Custom class essentially returns the CustomProperty from CustomProperties with the indicated name.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, August 10, 2010</h2><p>I am not against PropertyStatus supporting an indexer. But you must realize that in CSLA 4 the PropertyStatus control only works with registered properties (it relies on getting a PropertyInfo&lt;T&gt;), so I suspect the issue is deeper than just the control.</p>
<p>.NET defines a model for what you are trying to do - a dynamic type descriptor. I don&#39;t think that concept translated to Silverlight - and maybe it never will now that the DLR exists. I&#39;m bringing these technologies into the conversation, because you should try and infer (as much as possible) where Microsoft is likely to go with dynamic types over time, so your code can enjoy the benefits of their work.</p>
<p>I rather suspect that they&#39;ll adopt the DLR dynamic object approach - I know ASP.NET MVC 3 uses it for example. If that ends up being the way .NET/SL move, that&#39;ll be the way CSLA will move too.</p>
<p>In other words, I may end up devising a scheme by which a dynamic type with dynamic properties can have dynamic registration of those properties. Hopefully that&#39;s not too hard - but it isn&#39;t something I&#39;ve explored.</p>
<p>Again, I&#39;m rambling on about this to provide you with food for thought. None of this is high on my list right now, as my focus is on three things:</p>
<ol>
<li>CSLA 4 ebooks</li>
<li>CSLA 4 videos</li>
<li>CSLA 4 for Windows Phone</li>
</ol>
<p>If you want to explore some ideas around dynamic types and registering properties and enhancing PropertyStatus to support them, I&#39;d welcome your input.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MAN-U replied on Friday, August 13, 2010</h2><p style="text-justify:inter-ideograph;margin:0in 0in 0pt;text-align:justify;" class="MsoNormal"><span style="font-size:10pt;color:black;font-family:Verdana;">Can you provide a code snippet or more clarity on &lsquo;</span><span style="font-size:10pt;color:black;font-family:Verdana;mso-bidi-font-family:Arial;mso-ansi-language:EN;" lang="EN">devising a scheme by which a dynamic type with dynamic properties can have dynamic registration of those properties&rsquo;<span style="mso-spacerun:yes;">&nbsp; </span></span></p>
<p style="text-justify:inter-ideograph;margin:0in 0in 0pt;text-align:justify;" class="MsoNormal"><span style="font-size:10pt;color:black;font-family:Verdana;mso-bidi-font-family:Arial;mso-ansi-language:EN;" lang="EN">&nbsp;</span></p>
<p style="text-justify:inter-ideograph;margin:0in 0in 0pt;text-align:justify;" class="MsoNormal"><span style="font-size:10pt;color:black;font-family:Verdana;mso-bidi-font-family:Arial;mso-ansi-language:EN;" lang="EN">We have a registered property in our Business Class of type PropertyCollection, which holds the custom fields defined by our customer. <span style="mso-spacerun:yes;">&nbsp;</span>Customers can define the name, data type and validation rules of the custom fields. <span style="mso-spacerun:yes;">&nbsp;</span>I&rsquo;m looking for a way to validate the custom fields using property status. <span style="mso-spacerun:yes;">&nbsp;</span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, August 13, 2010</h2><p>I used the phrase &quot;devising a scheme&quot; because this isn&#39;t something I&#39;ve thought through. Since I haven&#39;t thought it through, I surely can&#39;t provide a code snippet <img src="http://forums.lhotka.net/emoticons/emotion-2.gif" alt="Big Smile" /></p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
