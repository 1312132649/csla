<html><header><title>Parameterless constructor -- MethodCaller.CreateInstance or Activator.CreateInstance?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Parameterless constructor -- MethodCaller.CreateInstance or Activator.CreateInstance?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6750.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong posted on Tuesday, April 07, 2009</h2><P>Well i think i got the answer myself, but just to share information and to get confirmation im right about this :) I've found a page with information about the differend types of constructing, my thanks go to Haibo.</P>
<P><A href="http://blogs.msdn.com/haibo_luo/archive/2005/11/17/494009.aspx">http://blogs.msdn.com/haibo_luo/archive/2005/11/17/494009.aspx</A></P>
<P>Gladly CSLA has a helper class called "MethodCaller" which is public :)<BR><BR>It seems that MethodCaller.CreateInstance only allows parameterless constructing.<BR>So it can be only used instead of Activator.CreateInstance when constructing objects with a parameterless constructor.<BR><BR>So which approach does MethodCaller.CreateInstance use behind the screens?<BR><BR>If u follow the link and look at the code behind MethodCaller it seems to use the "<STRONG>DynamicMethod + Delegate</STRONG> approach".</P>
<P>I'll be using MethodCaller.CreateInstance alot, since i'm using the objectfactory model. Which requires to create objectfactory's and business objects ourself.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong replied on Tuesday, April 07, 2009</h2><P>PS: Only use MethodCaller.CreateInstance for&nbsp;objects that are created often, since it creates delegates and cache them in memory.<BR><BR>Now i do have&nbsp;a question:<BR><BR>Why isn't CSLA using MethodCaller.CreateInstance instead of Activator.CreateInstance in several situations?</P>
<P>FactoryDataPortal.FactoryLoader<BR><FONT size=2>(</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>IObjectFactoryLoader</FONT></FONT><FONT size=2>)</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Activator</FONT></FONT><FONT size=2>.CreateInstance(</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Type</FONT></FONT><FONT size=2>.GetType(setting, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>true</FONT></FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>true</FONT></FONT><FONT size=2>));</P></FONT>
<P>Csla.DataPortal<BR><FONT color=#0000ff size=2><FONT color=#0000ff size=2>return</FONT></FONT><FONT size=2> (DataPortalClient.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>IDataPortalProxy</FONT></FONT><FONT size=2>)</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Activator</FONT></FONT><FONT size=2>.CreateInstance(_proxyType);</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, April 07, 2009</h2><P>Much of the answer is the same as it was in this post: </P>
<P><A HREF="/forums/permalink/32390/32391/ShowThread.aspx#32391">http://forums.lhotka.net/forums/permalink/32390/32391/ShowThread.aspx#32391</A></P>
<P>And (though this is a little dated now) this article is still largely valid, and certainly applies for the creation of things like the factory object:</P>
<P><A href="http://www.lhotka.net/Article.aspx?area=4&amp;id=4320e7f2-dd14-4928-b552-4eb0cb82cd68">http://www.lhotka.net/Article.aspx?area=4&amp;id=4320e7f2-dd14-4928-b552-4eb0cb82cd68</A></P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong replied on Tuesday, April 07, 2009</h2><P>The "Why" i understand now, and u are right, it's called way too less, thanks for the link (even if it's outdated)</P>
<P>I'm just glad that MethodCaller.CreateInstance() is public ;)</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
