<html><header><title>How to create a broken rule not property related</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How to create a broken rule not property related</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1589.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tommybouy posted on Wednesday, October 25, 2006</h2><P>In our old app we used to have an mdi parent that would open a root object form. From that form you could open a child form and because they were both mdi children you couldn't go modal on the child form. To ensure that the root object form wasn't closed while a child form was open we would simply apply a broke rule to the root like this; <FONT size=2>mobject.m_valid.RuleBroken(</FONT><FONT color=#800000 size=2>"Child form needs to be closed!"</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>True</FONT><FONT size=2>). Once the form was closed we would remove the rule. </FONT></P>
<P><FONT size=2>This seemed to work great but with the new release of CSLA it seems all rules are associated to a property of the object. How do people handle the opening of a child form and not allow the parent to be closed or is there a way to do what we used to do - add a broken rule when the child form is opened.</FONT></P>
<P><FONT size=2>On a side note, I have searched for details on VB subclassing of the baseobjects and most examples are in C#. Is there a link to examples or detailed discussions anywhere about VB subclassing.</FONT></P>
<P><FONT size=2>Thanks</FONT></P>
<P><FONT size=2>Tom</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, October 25, 2006</h2>You shouldn't be using business rules in this way.&nbsp; What you should do is open the child window, and set the window with the root object's Enable to false.<br><br>The rule that the root window cannot be closed is not a business rule, that's a ui constraint; for example, this wouldn't work at all in the web world.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tommybouy replied on Wednesday, October 25, 2006</h2><P>Thanks for your reply ajj3085. </P>
<P>We handled it this way because a parent object that has say 3 different child collections could very well have 3 different child forms open. Adding a rule for each then gave the user a visual description of why the parent can't be closed, specifically the names of all of the open child forms. Our users in many cases have muliple child forms open at the same today.</P>
<P>I suppose this issue is win form specfic as you couldn't do this in a web UI.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, October 25, 2006</h2>You could disable the saving / closing of the form if it knows one of the child windows is open.&nbsp; <br><br>Track via booleans in the parent window which child windows are open.&nbsp; Handle the Closing event on the parent form, and if any of these are true, cancel the close.&nbsp; You can also add a textual lable somewhere that appears to tell the user why the window was not closed.<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, October 25, 2006</h2><P><FONT size=2>"VB subclassing of the baseobjects "</FONT></P>
<P><FONT size=2>I know I posted some VB samples for BusinessBase and BusinessListBase.</FONT></P>
<P><FONT size=2></FONT>&nbsp;</P>
<P><FONT size=2>&lt;Serializable()&gt; _<BR>&nbsp; Public MustInherit Class MyBusinessBase(Of T As MyBusinessBase(Of T))<BR>&nbsp;&nbsp;&nbsp; Inherits BusinessBase(Of T)</FONT></P>
<P><FONT size=2></FONT>&nbsp;</P>
<P><FONT size=2> &lt;Serializable()&gt; _<BR>&nbsp; Public MustInherit Class MyBusinessListBase(Of T As MyBusinessListBase(Of T, C), C As <FONT size=2>IBusinessObject</FONT>)<BR>&nbsp;&nbsp;&nbsp; Inherits BusinessListBase(Of T, C)</FONT></P>
<P><FONT size=2>Note: C As <FONT size=2>IBusinessObject can be changed to whatever you need it to be - some other Interface or ...</FONT></FONT></P>
<P><FONT size=2>Joe</FONT></P>
<P><FONT size=2></FONT>&nbsp;</P>
<P><FONT size=2></FONT>&nbsp;</P>
<P><FONT size=2></FONT>&nbsp;</P>
<P><FONT size=2></FONT>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
