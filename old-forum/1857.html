<html><header><title>(CSLA 1.4) DLL Hell in .NET after all?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>(CSLA 1.4) DLL Hell in .NET after all?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1857.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson posted on Tuesday, November 28, 2006</h2><P>I'm modifiying an old CSLA 1.4 app in which I had been including the CSLA project in my solution.&nbsp; I decided to to start by simplifying a bit and removed that project (after confirming the source location).&nbsp; Then I added references to the debug versions of the library components (only four of them in 1.4) in the two remaining projects that require them.</P>
<P>Now my Task list in VS 2003, I see a pair of&nbsp;these error messages:</P>
<P>Warning: the dependency 'CSLA.Server.DataPortal, Version=1.4.2523.20457, Culture=neutral, PublicKeyToken=87a33c0b07abb16c' in project 'NpUtility' cannot be copied ot the run directory because it would overwrite the reference 'CSLA.Server.DataPortal, Version=1.4.2523.19211,Culture=nuetral,PublicKeyToken=87a33c0b07abb16c'.</P>
<P>I've got a pair of them for ServicedDataPortal too (different versions referenced, though: 20460&nbsp;and 19220).</P>
<P>And I've even got trouble with SQLDMO:</P>
<P>Cannot copy assembly 'Interop.SQLDMO' to file 'D:\V_Projects\NpUtility\NpUtilityWin\bin\Interop.SQLDMO.dll'.&nbsp; Access is denied.</P>
<P>I only have one version of 1.4 on this machine (although I have 1.52 and have been careful NOT to reference it).</P>
<P>What have I done?&nbsp; And, more importantly I guess, what can I&nbsp;do to fix this so that I can get back to work?&nbsp; (I actually tried deleting the dlls from the projects'&nbsp; bin folders, but when I rebuild those same older versions are being written back into them from somewhere!)</P>
<P>Thanks in advance.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, November 28, 2006</h2>Q,<br><br>Sounds like your project is referencing 1.4.2523.20457, but one of the OTHER references wants version 1.4.2523.19211.<br><br>Fire up Net Reflector and look at what versions of assemblies the references actually want.<br><br>HTH<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fintanv replied on Tuesday, November 28, 2006</h2><P>A few suggestions [I feel your pain ;-)].</P>
<P>1. Check the references path for each of the projects.</P>
<P>2.&nbsp;Make sure the dll's you are referencing from all projects reside in a single location (ex. Lib sub-dir), and add that sub-dir to your references path.&nbsp; This should be done even if your production app will use the dlls from a GAC reference.&nbsp; This applies not only to CSLA dll's but any and all third party dll's you will use in your app.</P>
<P>3. Fire up notepad2 and take a look at the proj and sln files to see if there are hidden references to the offending dll's.</P>
<P>Regards, Fintan</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RBrown replied on Tuesday, November 28, 2006</h2><P>I concur with the previous posts.&nbsp; Had the same issue in an non-Csla project once and had to trace back through every reference in the app&nbsp;as well as any references in the library projects being used.&nbsp; I have&nbsp;used the Reflector tool, which is probably a better tool, but the poor man's version is to simply double click the references in VS and view the referenced&nbsp;DLLs and versions.&nbsp; You'll find the culprit that way, adjust, and recompile.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, November 28, 2006</h2><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>RBrown:</strong></div><div>I have&nbsp;used the Reflector tool, which is probably a better tool, but
the poor man's version is to simply double click the references in VS
and view the referenced&nbsp;DLLs and versions.</div></BLOCKQUOTE><br><br>Well, Reflector is free, so even the poor man can use it.&nbsp; <img src="/emoticons/emotion-5.gif" alt="Wink [;)]" /><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson replied on Monday, December 04, 2006</h2><P>Thanks for the help, guys.&nbsp; I finally worked out the cause of my problem and was able to cure it.</P>
<P>By the time I had a handle on it I had already made it <STRONG>worse</STRONG> instead of better.&nbsp; I was fighting myself in two significant ways.&nbsp; First, the combination of VSS source code control and the Wise setup project in my solution were trying to keep the same version of dlls in my run directory.&nbsp; And by including CLSA's components as <STRONG>projects</STRONG> rather than lib dlls, I was changing version numbers while I was building all the time.&nbsp; I think at one point I had switched from referencing the projects to referencing their output dlls for one or more of the components and you can imagine the chaos that this caused.&nbsp; </P>
<P>I finally just started with a blank solution and built&nbsp;another from scratch with copies of the source files, figured out the plumbing issues, corrected them in my original project, deleted the contents in the run directory and rebuilt successfully.</P>
<P>Thanks for getting me pointed in the right direction!&nbsp; The upgrade is shipping today!</P>
<P>Best of the season to you all.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
