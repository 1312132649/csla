<html><header><title>AddDependantProperty - WPF</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>AddDependantProperty - WPF</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3381.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>marciak posted on Wednesday, August 15, 2007</h2><P>I am just begininng to use AddDependantProperty and as a test, I added a test rule that if a last name is entered a first name must also be entered.&nbsp; If I enter a last name, the first name and last name controls are both being correctly marked as invalid.&nbsp; When I enter the first name, the first name control is being marked as valid but the last name control continues to be marked as invalid.&nbsp; Has anyone else seen this behavior?</P>
<P>&nbsp;</P>
<P>Thanks,</P>
<P>marciak</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Curelom replied on Wednesday, August 15, 2007</h2>I have been having difficulty with adddependentproperty and the csla wpf validator as well, though I haven't spent enough time yet in figuring out the exact misbehavior that is occuring.&nbsp; It's been my experience so far that the validator does not fire for me at all when these rules are invalidated.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>McManus replied on Wednesday, August 15, 2007</h2><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>marciak:</strong></div><div>
<P>I am just begininng to use AddDependantProperty and as a test, I added a test rule that if a last name is entered a first name must also be entered.&nbsp; If I enter a last name, the first name and last name controls are both being correctly marked as invalid.&nbsp; When I enter the first name, the first name control is being marked as valid but the last name control continues to be marked as invalid.&nbsp; Has anyone else seen this behavior?</P>
<P></div></BLOCKQUOTE></P>
<P>Marciak,</P>
<P>Probably you have set up the rules as follows:</P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp;ValidationRules.AddRule(TestRule, "FirstName");<BR>&nbsp;&nbsp;&nbsp;ValidationRules.AddRule(TestRule, "LastName");<BR>&nbsp;&nbsp;&nbsp;ValidationRules.AddDependantProperty("LastName", "FirstName");</FONT></P>
<P>The first line says that the TestRule must be executed when FirstName changes, the second line says that TestRule must be executed when LastName changes and the third line says that when LastName changes, all rules coupled to FirstName must be excuted as well.</P>
<P>So, when you fill in LastName, TestRule is executed twice (once for LastName and once for FirstName). If you then fill in FirstName, TestRule is only executed for FirstName, marking the FirstName property as being valid. However, LastName is still invalid because it still has a BrokenRule attached to it.</P>
<P>Changing the third line to:</P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp;ValidationRules.AddDependantProperty("LastName", "FirstName", <STRONG>true</STRONG>);</FONT></P>
<P>should solve your problem, because now it says: When LastName changes, execute all rules coupled to FirstName as well and when FirstName changes, execute all rules coupled to LastName as well.</P>
<P>Hope this helps!</P>
<P>Herman</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Curelom replied on Wednesday, August 15, 2007</h2>This doesn't seem to be my&nbsp;problem.&nbsp; My Library fires correctly in non wpf apps.&nbsp; I have debugged this in wpf and the validation error does fire, but it looks like the Validator isn't catching it.&nbsp; I think it might have something to do with&nbsp;_haveRecentChange in the Validator is returning false for all the bindings.&nbsp; It does return true if I use a regular validation rule.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>marciak replied on Thursday, August 16, 2007</h2><P>Herman,</P>
<P>Thanks for your reply.&nbsp;&nbsp;I do have the third line coded with True for the isBiDirectional parameter.</P>
<P>Marciak</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
