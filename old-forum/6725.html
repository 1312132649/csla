<html><header><title>CLSA 3.6.2 - Type Coercion from Int16 to Nullable&lt;Enum&gt; is not supported?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CLSA 3.6.2 - Type Coercion from Int16 to Nullable&lt;Enum&gt; is not supported?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6725.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong posted on Thursday, April 02, 2009</h2><P>I have an enumeration defined like:</P>
<P>public enum MyColor<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;red&nbsp;= 1,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;white = 2,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blue = 3<BR>}</P>
<P>From my datareader i have an value as valuetype System.Int16<BR>In my businessobject i have a property Nullable&lt;MyColor&gt;<BR><BR>Using LoadProperty(), Doing TypeCoerce, it can't convert to the desired type.<BR><BR>Why?</P>
<P>Is this not supported or a missing Coercion?<BR>I traced the code and at cnv.CanConvertFrom(valueType) it steps into the else statement.<BR><BR>cnv = "System.ComponentModel.EnumConverter"<BR>desiredType = "MyNameSpace.MyColor"<BR>valueType = "System.Int16"<BR>value =&nbsp;"1"<BR><BR><FONT size=2></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>catch<BR></FONT></FONT><FONT size=2>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>TypeConverter</FONT></FONT><FONT size=2> cnv = </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>TypeDescriptor</FONT></FONT><FONT size=2>.GetConverter(desiredType);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>if</FONT></FONT><FONT size=2> (cnv != </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>null</FONT></FONT><FONT size=2> &amp;&amp; cnv.CanConvertFrom(valueType))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>return</FONT></FONT><FONT size=2> cnv.ConvertFrom(value);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>throw</FONT></FONT><FONT size=2>;<BR>}</P></FONT>
<P>I really don't know and i must use the type coercion since it's my generic mapper calling LoadProperty without knowing which type a property is.<BR>I've no other option then converting it myself first before calling LoadProperty.<BR><BR>Why can't the EnumConverter convert from Int16 ?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong replied on Thursday, April 02, 2009</h2><P>Ok i know why:<BR><A href="http://msdn.microsoft.com/en-us/library/at9d6zbw.aspx">http://msdn.microsoft.com/en-us/library/at9d6zbw.aspx</A></P>
<DIV>"This converter can only convert an enumeration object to and from a string."<BR><BR><BR>In this case i want to ask if the type coerce functionality&nbsp;can be extended with support to convert from int to enum, please.</DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, April 02, 2009</h2>I'll add this to the wish list.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
