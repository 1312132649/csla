<html><header><title>SelectedIndexChanged not fired by bound listbox when starting deleting first entries</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>SelectedIndexChanged not fired by bound listbox when starting deleting first entries</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2655.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>stefan posted on Wednesday, April 04, 2007</h2>Hi,<br><br>I have a Listbox bound to a BusinessListBase through a bindingsource.<br>There is a button near, that enables the user to delete items from the BusinessListBase.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void btnDeleteCriteria_Click(object sender, EventArgs e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_currentCrit != null) _query.criteria.Remove(_currentCrit);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>The _currentCrit child reference is set in the listbox' SelectedIndexChanged event handler.<br>The listbox behaves as expected when I choose to delete the last entry from the list. <br>The selected entry is deleted from the list, and thanks to the SelectedIndexChanged event firing,&nbsp; <br>_currentCrit is set to the next (= previous) item in the list, so the user could go on deleting from the list.<br><br>As soon as I want to delete an item that's not the last in the list, SelectedIndexChanged is not <br>fired, although the listbox apparently seems to select the next (= next in line) item, which is not <br>the case. My reference is still set to the previously deleted object.<br><br>What am I doing wrong here?<br><br>As I wrote this, I realized that actually the index of the selected item is never going to change <br>when not deleting the last position....dumb me. <br>Is there any chance of getting a 'SelectedItemChanged' equivalent for the listbox control?<br><br>Stefan<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Wednesday, April 04, 2007</h2>Why don't you replace your _currentCrit reference with an _currentIndex variable?<br><br>;-)<br><br>Bayu<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>stefan replied on Wednesday, April 04, 2007</h2>Hi Bayu!<br><br>Relying on the index doesn't sound as a goog idea to me, because the index of an object could <br>change. I feel better having an extra reference to the current object, as I need it to hook and unhook <br>PropertyChanged event handlers on it.<br><br>Anyway, I solved my issue by coding the following check for "-1":<br>private void btnDeleteCriteria_Click(object sender, EventArgs e)<br>{<br>&nbsp;if (_currentCrit != null) _query.criteria.Remove(_currentCrit);<br>&nbsp;// when not deleting the last item in the list, _currentCrit is not reset automatically<br>&nbsp;// to the current listselection, because 'SelectedIndexChanged' did not fire,<br>&nbsp;// and _currentCrit still points to the deleted object!<br>&nbsp;if (criteriaListBox.Items.IndexOf(_currentCrit) == -1)<br>&nbsp;{<br>&nbsp; UserQueryCriteria _selectedCrit = criteriaListBox.SelectedItem as UserQueryCriteria;<br>&nbsp; if (_selectedCrit != null) UpdateCriteriaEditArea(_selectedCrit);<br>&nbsp;}<br>}<br><br>Thanks for your support!<br><br>Stefan<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
