<html><header><title>Windows UI problem if user adds new child and cancels before save.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Windows UI problem if user adds new child and cancels before save.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2452.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tommybouy posted on Thursday, March 01, 2007</h2><P>&nbsp;&nbsp;&nbsp;From the reading I have been doing it appears that child collections and the methods within child objects are designed to&nbsp;handle when&nbsp; the collection is databound to a grid. Specifically for adding and deleting new records. The question I have is, when a user chooses to add a new child object we open an editable form using the ShowDialog method and depending upon whether the user Saves or Cancels would determine whether the object would get added to the collection. If we use the AddNew method the object is already added to the collection and even if the user chooses to cancel the add, we would then need to go thru the collection and remove the new object. Is this correct?</P>
<P>&nbsp;&nbsp;&nbsp;I have seen use of the Assign method where an ID is passed to add an object to a collection but in that case the object being added already exists in the database. </P>
<P>&nbsp;&nbsp;&nbsp;Does someone have an example of how they add a child to a collection via code where a CancelEdit on the child form would not add it to the collection?</P>
<P>Thanks</P>
<P>Tom</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Thursday, March 01, 2007</h2>In cases where I needed such functionality, I opted to have a way to create a child without adding it to the collection. You can either add a public factory method on the child or you can add a public (non-shared) function to the collection that returns a new child. I usually use the 2nd option.<br><br>So, it would be like this (very pseudocode):<br>Dim collection as ListObject = ListObject.GetListObject()<br><br>==============<br>Dim child as ChildObject<br>child = collection.CreateNew()<br>EditChild(child)<br>============<br>Public Sub EditChild(ByVal child as ChildObject)<br>If ShowEditForm(child) = DialogResult.OK Then<br>&nbsp;&nbsp;&nbsp; child.applyedit()<br>&nbsp;&nbsp;&nbsp; If Not collection.Contains(child) Then<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; collection.Add(child)<br>&nbsp;&nbsp;&nbsp; End If<br>Else<br>&nbsp;&nbsp;&nbsp; child.CancelEdit<br>End If<br>End Sub<br><br>I use something like that edit child method to handle editing of existing items and adding of new items in scenarios like yours.<br><br>Andr√©s<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jimbo replied on Saturday, March 03, 2007</h2>You might want to review Rocky's comments in post 12807 etc regarding
new child objects...&nbsp; which basically says that Andres method is
possibly not the best way to do it.&nbsp; That was my approach before I
needed to refer to the parent in the child dialog and Rocky&nbsp;
provided the reasons why..<br>
<br>
<br>
<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
