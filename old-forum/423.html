<html><header><title>Extending NameValueListBase</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Extending NameValueListBase</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/423.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>mtavares posted on Tuesday, June 20, 2006</h2>Is it possible to inherit NameValueListBase and extend it such that it will store a third column for each item?&nbsp; And if so, if someone has an example I could follow, I would greatly appreciate it, since i'm a little shaky with inheriting generics.&nbsp; So what I'm hoping to achieve are classes inherited from this 3 column base class such that they are declared like:<br><br>Class MyLookupList<br>&nbsp;&nbsp;&nbsp; Inherits MyNameValueListBase(Of Integer, String, Boolean)<br><br>End Class<br><br>instead of :<br><br>Class MyNameValueList<br>&nbsp;&nbsp;&nbsp; Inherits NameValueListBase(Of Integer, String)<br><br>End Class<br><br>Thanks,<br>Mike<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Tuesday, June 20, 2006</h2>Well... then It would stop being a name value list... It would be a Name Value Value list!! <img src="/emoticons/emotion-2.gif" alt="Big Smile [:D]" /><br><br>You should really consider a ReadOnlyList for this case, but in case you know what you're doing:<br><br>What you can do is build a structure for your purpose:<br><br>Public Struct SomeStruct<br>Private mSomeString as String<br>Private mSomeBool as Boolean<br><br>Public Readonly Property SomeString As String<br>...<br>End Property<br>Public Readonly Property SomeBool As Boolean<br>...<br>
End Property<br><br>Public Sub New(ByVal someString as String, ByVal someBool as Boolean)<br>&nbsp;&nbsp;&nbsp; mSomeString = someString<br>&nbsp;&nbsp;&nbsp; mSomeBool = someBool<br>End Sub<br>End Struct<br><br>Now, you can declare your nvl like:<br><br>Class MyLookupList<br>&nbsp;&nbsp;&nbsp; Inherits MyNameValueListBase(Of Integer, SomeStruct)<br><br>You should probably override Equals(), GetHashCode() and ToString() inside the struct so that everything works as expected. (Otherwise you're likely to have trouble when binding to ie. comboboxes)<br><br>I hope that helps.<br><br>Andr√©s<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mtavares replied on Tuesday, June 20, 2006</h2>Thanks for the responses. Unfortunately the other requirement for me is for the extra value to be a separate field to bind to.&nbsp; I am trying to adapt the lookup to use a custom web control that&nbsp; actually takes a 3rd column used to determine which row is displayed as a default.&nbsp; Unless i'm mistaken, the option you gave me Andres would still only give me 2 bindable columns.<br><br>I guess my options then are either use a readonlycollection with the custom control or forget using the custom control and use the namvaluelist with a regular combobox and just use a shared method to get the default option.<br><br>If there is a way to make the NameValue list bindable to 3 columns, let me know, otherwise i'll just stick with one of the other options.<br><br>Thanks,<br>Mike<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, June 20, 2006</h2>You should be able to bind to the other colums;<br><br>You binding to Value.MyString or Value.MyBool.&nbsp; It should work.. at least I'm pretty sure it does in .Net 2.0...<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, June 20, 2006</h2>Xal suggestion is what I would recommend (defining another class to hold the string / boolean).<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
