<html><header><title>Simplifying the process of adding common rules</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Simplifying the process of adding common rules</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1149.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>David posted on Thursday, September 07, 2006</h2><P>I have a lot of business rules to add for time and date validation and I am trying to write some code that will simplify the addition of these rules. I am trying to use the new generic common rules from 2.1&nbsp;which help, but I have the following issue:</P>
<P>I am adding a rule to test that a time value does not exceed 6pm as follows. I have split this up into several lines to make it more readable:</P>
<P>&nbsp;Dim MyRuleArg As New MaxValueRuleArgs(Of DateTime)("FinishTime", TimeSerial(18, 0, 0))<BR>&nbsp;ValidationRules.AddRule(AddressOf MaxValue(Of DateTime), MyRuleArg)</P>
<P>This works, but the message is not so good: "FinishTime can not exceed 1/01/0001 6:00:00PM"</P>
<P>Specifically I need to do something about the way it is formatting my maximum time value. Is there an easy way to do this?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoOfMetL replied on Thursday, September 07, 2006</h2><br>
A solution would be to create your own MaxValue rule. What would allow you to personalize the message. <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Thursday, September 07, 2006</h2><P>Another option, if you are willing to alter the default CSLA objects, is to provide an overloaded constructor to the MaxValueRuleArgs class that accepts a format string.&nbsp; Then you can simply add such a string to the code you've included and accomplish your goal.&nbsp; (You'll want to change the ToString method to use the format string, too!)</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoOfMetL replied on Thursday, September 07, 2006</h2>Yes&nbsp; it's a better solution<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, September 07, 2006</h2>Yeah, that's a very good idea - I'll add it to my list of "things to do in a future release"<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>David replied on Thursday, September 07, 2006</h2><P>I looked into this suggestion (overloaded constructor to the MaxValueRuleArgs class) but&nbsp;there is one problem. When the code in the MaxValue function formats the message, it declares a variable of type T, assigns the max value to this variable and then calls the ToString method. So I have no way of intercepting the formatting&nbsp;process.</P>
<P>So what I did was to&nbsp;create my own MaxValue function as well as my own MaxValueRuleArgs(OF T) class. I then added a read only property FormattedMaxValue&nbsp;to&nbsp;MaxValueRuleArgs that inspected the current type and value&nbsp;and&nbsp;did the type specific formatting&nbsp;I required. I then altered MaxValue to call this property instead of the current method (using ToString).</P>
<P>This works nicely for me, and rather than changing CSLA I have just renamed these and included the code in my project.</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
