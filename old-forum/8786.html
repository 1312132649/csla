<html><header><title>Using BusinessListBase with multi-table Object</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Using BusinessListBase with multi-table Object</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8786.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>strangerd posted on Friday, April 09, 2010</h2><p>Hi</p>
<p>I&#39;m required to design an object which uses a couple of tables.</p>
<p>My parent table is table 1</p>
<p>Table 2, 3 and 4 should be the child. (If you run a query on these joined tables, you already get multiple records)</p>
<p>Is it possible to create objects that work in this fashion? If so, does anyone have examples on how this can be done, as the CSLA book has only basic examples where the object is dealing only with children of itself, not a joined object comprising of multiple tables.</p>
<p>I seem to get it right to a point. But I&#39;m using LINQ and when you get to the fetch_child and so forth, you have to bring in a LINQ table, where as with my situation, I have to use mutiple.</p>
<p>Thank you</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Friday, April 09, 2010</h2><p>There are really two options.</p>
<p>One is to use a join in your query so you get back one row of data per child. That complicates the query of course, but is usually the most efficient solution because it minimizes database queries.</p>
<p>Two is to do multiple queries to the database. You may be able to get the Table 2 data in one query (for all child objects), and then in each Child_Fetch() you&#39;d do two more queries to get the data from the other two tables. Obviously this is less efficient because it requires more database queries, but it avoids the (potentially) complex join of the first option.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>strangerd replied on Friday, April 09, 2010</h2><p>Hi</p>
<p>Thanks for the reply. Do you have any examples on the Editable root collection and Editable child collection, like in your book on page 180?</p>
<p>Do you have an example also on your second option?</p>
<p>Thank you</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Friday, April 09, 2010</h2><p>The DeepData sample might help, though it is old. I&#39;m pretty sure I have a parent-child-grandchild sample in the code for the Core 3.8 video series.</p>
<p>Ultimately this isn&#39;t really a CSLA question though. It is a question about how to efficiently get at data from your database. The techniques vary depending on your database and its API. SQL Server supports some nice features, such as multiple result sets and MARS - though they come with tradeoffs in terms of performance and complexity.</p>
<p>Multiple result sets are something I use a lot, but they are only really useful for parent-child relationships. If the parent is a list, or you have grandchild data, this isn&#39;t a useful technique.</p>
<p>MARS allows you to do multiple overlapping queries using the same connection. I&#39;ve heard MARS has bad perf impact, but don&#39;t really know (I&#39;m not a database expert). The alternative is to use multiple connections, and that&#39;s typically what I do - if for no other reason that it is easy. The ConnectionManager (and similar manager types) in Csla.Data supports this by allowing you to specify a label on the GetManager() call - use a label for your secondary connection to avoid conflicting with the default connection used to get the parent data.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>strangerd replied on Monday, April 12, 2010</h2><p>Hi</p>
<p>The DeepData example is not what I am looking for. I am just looking for an example piece of code for the Rootlist and child classes, where mutiple tables are involved. I just need it as a start.</p>
<p>I can&#39;t be expected to pay $300 for just one example piece of code. </p>
<p>Is there any other way you can help me out? </p>
<p>Thank you</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, April 12, 2010</h2><p>I still don&#39;t understand what you are asking. I answered your original question in my first answer. It isn&#39;t hard, and it is all about data access, not objects.</p>
<p>private void DataPortal_Fetch(...)<br />{<br />&nbsp; // query to get root data<br />&nbsp; // load root properties<br />&nbsp; // query to get list of child data<br />&nbsp; Children = DataPortal.FetchChild&lt;Children&gt;(childData);<br />}</p>
<p>in list</p>
<p>private void Child_Fetch(ChildDataListType childData)<br />{<br />&nbsp;&nbsp;// foreach through childData<br />&nbsp; // call Add() on each new child created with<br />&nbsp; // DataPortal.FetchChild<br />}</p>
<p>in child</p>
<p>private void Child_Fetch(ChildDataType childData)<br />{<br />&nbsp; // load properties from childData<br />&nbsp; // query Table 3<br />&nbsp; // load properties from Table 3<br />&nbsp; // query Table 4<br />&nbsp; // load properties from Table 4<br />}</p>
<p>I&#39;m obviously missing the point of your question, because this is really not hard.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>strangerd replied on Monday, April 12, 2010</h2><p>Hi</p>
<p>All I want to do is populate a grid with a list of records which I get directly from the object (comprising of multiple tables which return multiple records when you query them). </p>
<p>I have the couple of tables. But all the tables are on the same level. In terms of root and child. </p>
<p>I just want to return a list of the objects by using businesslistbase. Currently BusinessBase only allows for the single retrieval of data.</p>
<p>I am new to this, so my conclusion was that I would need to use the BusinessListBase if i want to do deferred operations.</p>
<p>Thank you</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, April 15, 2010</h2><p>That is true, if you are just getting a list of child objects, then your root object will be a BLB. But the idea is the same as in my previous post - just a little easier:</p>
<p>private void DataPortal_Fetch()<br />{<br />&nbsp; // open the database<br />&nbsp; // do a query to get the data (joining your tables I assume)<br />&nbsp;&nbsp;// foreach through&nbsp;the resulting data<br />&nbsp; // call Add() on each new child created with<br />&nbsp; // DataPortal.FetchChild<br />}</p>
<p>in child</p>
<p>private void Child_Fetch(ChildDataType childData)<br />{<br />&nbsp; // load properties from childData<br />}</p>
<p>This is exactly what I show in the book and in many examples - you are just doing a join to get the data from several tables instead of one table - that&#39;s simple database stuff.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
