<html><header><title>Update Properties with values from database without creating infinite loop on Child_Changed event.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Update Properties with values from database without creating infinite loop on Child_Changed event.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11276.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>cwinkelmann posted on Monday, April 02, 2012</h2><p>Once again relying on the expertise of the CSLA community... </p>
<p>I have a parent / child collection / grandchild collection object graph. When any of the child, grandchild objects change it calls the Child_Changed event where the parent object will call Save() which calls FieldManager.UpdateChildren(); </p>
<p>When any of the children are saved, the trip to the database invokes an SP which has output parameters like TimeStamp, (if new then the object Database Identity), and some occasional text fields that will revert to defaults. The problem is the BusinessBase does not expose BypassPropertyChecks as it is &quot;internal&quot; and also the method &quot;MarkOld()&quot; is &quot;protected&quot; so I&#39;m not sure if there is any support native to CSLA to allow a DAL assembly to load properties of the BusinessBase...</p>
<p>I can write methods that accept parameters of the values that come back from the SP and then the BusinessBase class can set the internal &quot;private backing fields&quot; or use LoadProperty(),,,, BUT is there any support or design in CSLA to load values from an external process?</p>
<p>&nbsp;</p>
<p>Thanks greatly as always for your expertise! :-)</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cwinkelmann replied on Tuesday, April 03, 2012</h2><p>Poring over the search results I found something that has potential!!!!</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>http://forums.lhotka.net/forums/p/171/1001.aspx#1001</p>
<p><strong><a>malloc1024</a></strong>
                                
                                <span class="ForumPostTitleDate">
                                        <a>replied on</a>
                                        
                                                Fri, May 26 2006 12:06 PM                              
                                                 
                                                               
                                        
                                    </span>
                                </p>
<div>
                                        <a>
                                                <img style="border-width:0px;" align="absmiddle" border="0" alt="" /> 
                                                rated by 0 users
                                            </a>
                                    </div>
<p>  
                                
                                
                            
                             							
                            Why not use a separated interface approach instead of DTOs?<span>&nbsp; </span><span>This will allow you to load the object directly
from the DAL.<span>&nbsp; </span>The trick, </span>use explicit interfaces instead on implicit
interfaces.<span>&nbsp; </span>Create an explicit interface
for each object and add them to the DAL.<span>&nbsp;
</span>Have each object implement their respective interface.<span>&nbsp; </span>Add a LoadingFromDAL flag to each interface.<span>&nbsp; </span>Setting this flag before loading an object
will allow you to load your object directly without evoking
broken rules, MarkDirty etc.<span>&nbsp; </span>Further, it
also allows you to load ReadOnly properties.<span>&nbsp;
</span>Using explicit interfaces will also allow you to load private properties
from the DAL.<span>&nbsp;&nbsp; </span>The only way to access
these private properties (not including reflection) is through casting to the
interface. However, since the interface resides in the DAL, the presentation
layer will never be able to access these private properties.<span>&nbsp; </span>Using explicit interfaces solves most of the
problems that are associated the separated interface method.&nbsp; Does anyone see any potential problems with this? </p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>This is pretty much what I need, but I have some coding to do. The last thing I need is an update to occur and then the DAL having to pass back a value which triggers an update while the DAL is still updating the BB. </p>
<p>&nbsp;</p>
<p>I would love to see other comments on how people prefer the interface to work. Pass a DAL and let the object load output values, or pass each value???</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Tuesday, April 03, 2012</h2><p>Use the ObjectFactory base class to create an accessor class. </p>
<p>This will allow f.ex MarkOld and LoadProperty from external class.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
