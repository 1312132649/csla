<html><header><title>Different ways to validate dates with a SmartDate backing field and public string property</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Different ways to validate dates with a SmartDate backing field and public string property</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9397.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>bmmathe posted on Wednesday, August 18, 2010</h2><p>I recently had an issue with date validation in WPF using the Csla 3.8.2 framework.&nbsp; I have a date property that is exposed as a string publicly but has a SmartDate backing field.&nbsp; This seems to be the most common way to expose dates for UI purposes.&nbsp; The only problem is if the user types letters into the textbox, the SmartDate throws an exception and doesn&#39;t give a chance to be broken by a business rule.&nbsp; </p>
<p>I would like the user experience to be like so:&nbsp; The user is prompted to enter a date however the date is not required.&nbsp; If the user types in something that is invalid and can&#39;t be parsed to a date, I would like a business rule to break and a property status validation message to show.</p>
<p>There are a few dirty workarounds I have thought of so far like exposing the date as a separate public string variable with a string backing field or using a converter to parse out a datetime in ConvertBack and create a separate datetime validator for a textbox.&nbsp; I don&#39;t like either of these solutions.</p>
<p>Has anyone else solved this problem in a more elegant way?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Wednesday, August 18, 2010</h2><p><div style='padding-left: 50px;background-color:silver'><b>Brett Mathe<br></b>I have a date property that is exposed as a string publicly but has a SmartDate backing field.</div></p>
<p>That sounds like you have a private backing field of type SmartDate with a Property of type String.&nbsp; How about trying this:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static PropertyInfo&lt;SmartDate&gt; DateModifiedProperty = RegisterProperty(new PropertyInfo&lt;SmartDate&gt;(&quot;DateModified&quot;, &quot;Modification Date&quot;, new SmartDate(SmartDate.EmptyValue.MinDate)));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public SmartDate DateModified<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return GetProperty(DateModifiedProperty); }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string DateModifiedString<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return GetPropertyConvert&lt;SmartDate, string&gt;(DateModifiedProperty); }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set { SetPropertyConvert(DateModifiedProperty, value); }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>Jav</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>bmmathe replied on Wednesday, August 18, 2010</h2><p>That would have the same issue as the original SmartDate backing field with a public string using the SetPropertyConvert.</p>
<p>The problem is that we bind to the string property so in the WPF in your scenario we would bind a textbox to the DateModifiedString.</p>
<p>As soon as the user types &quot;abc&quot; and tabs off the textbox, the DateModifiedString setter would get called and value &quot;abc&quot; would try to be parsed by the SmartDate object and the exception would be thrown.</p>
<p>A variation on your suggestion and what seems to work (but very dirty) is to have a public csla style string like DateModifiedString but with a string backing field.&nbsp; We would then add a business rule that would validate the string to make sure it is a date.&nbsp; If the string validates then the SmartDate backing field for the &quot;real&quot; property would be set.&nbsp; You basically have to manually synchronize both properties depending on which property is being set.&nbsp; I really don&#39;t like this solution.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, August 18, 2010</h2><p>I think if you need to handle this case, you just use string for your type.&nbsp; Then have a validation rule which passes if the string parses as a date, and fails otherwise.&nbsp; Then when you store or retreive the value, you do your conversion there.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
