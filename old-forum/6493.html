<html><header><title>Problems with edit levels when data binding DynamicRootList and child screen.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Problems with edit levels when data binding DynamicRootList and child screen.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6493.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>breiec posted on Monday, February 23, 2009</h2>Using CSLA Version 3.6.1<br><br>I am having problems with edit levels when data binding a DynamicRootList to a grid. Then from the grid I open screen with the child collection. For example.<br><br>I have the following objects.<br>AdhesiveTypes (DynamicRootList)<br>AdhesiveType (DynamicRoot)<br>AdhesiveTypeCategories (EditableChildList)<br>AdhesiveTypeCategory (EditableChild)<br><br>I have a Windows form that has a grid of AdhesiveTypes and when a user clicks on a link in the grid I am opening a new edit window that displays a list of AdhesiveTypeCategories. When opening the edit window I am passing in the AdhesiveType to the constructor of the form and then calling the BeginEdit() on it and then set it to the binding source. This form has two datasources, one for AdhesiveType and another for AdhesiveTypeCategories. However, editing only occurs on AdhesiveTypeCategories on this form.<br><br>When the user makes change and then click a cancel button I am calling the mAdhesive.CancelEdit() and closing the form. Problem is that the CancelEdit seems not to work. The edit level doesn't rollback. When the form loads the edit level is at 1, when begin edit is called it goes to 2, when cancel is called, it stays at 2.<br><br>Here is the pertinent code on the parent grid:<br><br>Private Sub EditCategories(ByVal adhesiveId As Integer)<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Dim adhesiveType As AdhesiveType = mAdhesiveTypes.GetItem(adhesiveId)<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Dim categoriesEditForm As New SelectCategoriesListForm(adhesiveType)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; categoriesEditForm.ShowDialog()<br>End Sub<br><br>Then on the child screen:<br><br>Public Sub New(ByRef adhesive As AdhesiveType)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; InitializeComponent()<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mAdhesive = adhesive<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mAdhesive.BeginEdit()<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; AdhesiveBindingSource.DataSource = mAdhesive<br>End Sub<br><br>The cancel looks like this:<br><br>&nbsp;&nbsp;&nbsp; Private Sub Cancel_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Cancel.Click<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CategoriesBindingSource.RaiseListChangedEvents = False<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; AdhesiveBindingSource.RaiseListChangedEvents = False<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; BindingHelper.UnbindBindingSource(CategoriesBindingSource, False, False)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; BindingHelper.UnbindBindingSource(AdhesiveBindingSource, False, True)<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CategoriesBindingSource.DataSource = AdhesiveBindingSource<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; mAdhesive.CancelEdit()<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CategoriesBindingSource.RaiseListChangedEvents = True<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; AdhesiveBindingSource.RaiseListChangedEvents = True<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Me.Close()<br><br>&nbsp;&nbsp;&nbsp; End Sub<br><br>Note that if instead of passing in the item from the bound dynamic root list, I declare a local instance of the list and then pass the item to the child form it works correctly. I am guessing it has something to do with passing in the root item that is bound, but that is just a guess at this point. Any pointers on how to handle this scenario?<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
