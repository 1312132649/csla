<html><header><title>Data Binding a combo box to multiple fields</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Data Binding a combo box to multiple fields</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3869.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dlabar posted on Thursday, November 08, 2007</h2><P>I have a Customer CSLA Business Object that contains a Customer Name, and a Customer Id.&nbsp; I'd like to be able bind both fields to a single ComboBox with the format "Customer Name - Customer Id" and I'm having some troubles.&nbsp; I can add a new property to the Customer Business object that does this for me, but I doesn't really belong there.</P>
<P>I'm using .Net 2008 and was wondering if there was a possiblity of using Method Extensions.&nbsp; Created one, but it is a method, and I can't data bind to a method.&nbsp; Is there anyway to make an Property Extension?&nbsp;&nbsp;I'm I missing something painfully obvious?&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Curelom replied on Thursday, November 08, 2007</h2>Are you using WPF or Forms?&nbsp; in WPF, you would just bind the object to the dropdown and use a template to display the data in the way you like.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dlabar replied on Thursday, November 08, 2007</h2>I'm currently Using Forms.&nbsp; There is nothing&nbsp;keeping&nbsp;me from switching to&nbsp;WPF.&nbsp; Is that a major jump?&nbsp;</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DavidDilworth replied on Friday, November 09, 2007</h2><P>Is the BO you are talking about a Name-Value List?&nbsp;&nbsp;&nbsp; That is the CSLA class designed specifically for binding to ListBox style controls.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dlabar replied on Friday, November 09, 2007</h2>No it is not.&nbsp; 90% of the time these BO are used for backend processing and they don't need these "User Friendly" display values.&nbsp; </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JBergdahl replied on Friday, November 09, 2007</h2><P>Why not just override the ToString() function to return the string in a format you want?</P>
<P>Regards;<BR>/jb</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dlabar replied on Friday, November 09, 2007</h2>I don't think it&nbsp;was possible to databind to ToString().&nbsp; If there is a way, please let me know.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AAKLebanon replied on Saturday, November 10, 2007</h2><P>in reality you can, this is an exampe:</P><FONT color=#0000ff size=2>
<P>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> BusinessObject</P>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> ToString() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#a31515 size=2>"ToString"</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P>
<P>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT></P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>Public</FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2><FONT color=#000000> BusinessObjectsList</FONT></P>
<P></FONT><FONT color=#0000ff size=2>Inherits</FONT><FONT size=2> System.ComponentModel.BindingList(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> BusinessObject)</P></FONT><FONT color=#0000ff size=2>
<P>End</FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2>Class</FONT></P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>Public</FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2><FONT color=#000000> Form1</FONT></P>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> list </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> BusinessObjectsList</P>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> Form1_Load(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.Object, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.EventArgs) </FONT><FONT color=#0000ff size=2>Handles</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>MyBase</FONT><FONT size=2>.Load</P>
<P>list.Add(</FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> BusinessObject)</P>
<P>list.Add(</FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> BusinessObject)</P>
<P>BusinessObjectsListBindingSource.DataSource = list</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P>
<P>End</FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2>Class</FONT></P>
<P><FONT color=#0000ff size=2>you must add a Combobox to your form and bind it to BusinessObjectList (by creating a new object data source from the Data sources pane.</FONT></P>
<P><FONT color=#0000ff size=2>now when you run the application, you will notice that the combobox is filled with 2 objects named ToString :)</FONT></P>
<P><FONT color=#0000ff size=2>&nbsp;</P></FONT></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dlabar replied on Monday, November 12, 2007</h2><P>I think that is about as close as I can come given my current setup.&nbsp; Thanks.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DavidDilworth replied on Friday, November 09, 2007</h2><P>So I would suggest that the Use Case you have here is for a specific "user-friendly" string in a ListBox for a specific UI requirement.&nbsp; </P>
<P>It's a different BO to the other one.</P>
<P>Use the NVL class, or something similar.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Curelom replied on Friday, November 09, 2007</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>dlabar:</strong></div><div>I'm currently Using Forms.&nbsp; There is nothing&nbsp;keeping&nbsp;me from switching to&nbsp;WPF.&nbsp; Is that a major jump?&nbsp;</div></BLOCKQUOTE></P>
<P>It is a huge jump.&nbsp; If your applicaiton is already using Forms, I wouldn't make the jump.&nbsp; If you are just starting out and have some extra time(a lot of extra time) for the learning curve, it might be worth it.&nbsp; In either case, I echo the other comments to this post of creating an nvl object for this&nbsp;use case.&nbsp; You would generally use the nvl in WPF as well as it is more light weight.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
