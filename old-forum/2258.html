<html><header><title>Object Oriented VS. Data Binding.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Object Oriented VS. Data Binding.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2258.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>AAKLebanon posted on Thursday, February 01, 2007</h2><P>Let's say that i have an OrderDetails object, that is composed of OrderDetail objects. Each OrderDetail object(that is an Editable Child) have a Price field of type Money.</P>
<P>Money is a normal class that hold an Amount field of type integer...</P>
<P>I&nbsp;think that this is a normal object oriented design ! Money encapsulate different thinks related to money:Amount,Currency ... and it have a clear responsibility:Converting from currency to another for example, And (or) formating the Amount value to a string value...</P>
<P>Now the problem is in data binding. I can't bind any control to this field. the TextBox control for example require a field of a primitive type(integer,double,string...).</P>
<P>I am now obliged to create a new control that accept a Money object (the same problem exist with DataGridView). or I am obliged to create 2 properties in the OrderDetail object, one of type Decimal, and the other of type Money, so when the value of the first property change, the second property also change. and this is not a good design. the same problem exist when I try to fetch the Money property value from the DataBase. it is persisted as a Decimal data type, so I am obliged to create 2 properties, one is Private and of Decimal data type, and the other is public of Money data type. when the first change, the second automatically change ... ( I am obliged to use this technic because I use an object persistence framework...).</P>
<P>so what&nbsp;I should do in this situation, what is the best solution, specially when i think that CSLA is about creating "Data Collector Objects", that is, an object that is responsible to collect data and valiadte it( it is similar to DataSet !), so CSLA always deal with data binding...</P>
<P>&nbsp;</P>
<P>Sorry for my bad english...</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>malloc1024 replied on Thursday, February 01, 2007</h2>

<p class="MsoNormal">You could try to wrap your OrderDetail object in a fa√ßade that
would flatten your design.&nbsp; This would make binding easier.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pelinville replied on Thursday, February 01, 2007</h2><DIV>And here is a definition of the pattern malloc speaks of.</DIV>
<DIV>&nbsp;</DIV>
<DIV><A href="http://www.dofactory.com/Patterns/PatternFacade.aspx">http://www.dofactory.com/Patterns/PatternFacade.aspx</A></DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AAKLebanon replied on Thursday, February 01, 2007</h2>I think this is not the solution, because if I create an object&nbsp;that wrap my OrderDetail object, I will not benefit from CSLA features at all ! for example, broken rules will not be able to show an error icon near of a TextBox, because the broken rule is in OrderDetail and not in the new object.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, February 02, 2007</h2>Your facade could be a BO as well, and you wouldn't lose any of the benefits.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>hurcane replied on Thursday, February 01, 2007</h2>We have two "money" objects in our system. As you described, money has a currency and an amount property (e.g 3 Yen, 2 US Dollars, etc.). We also have a MoneyUnit, which also includes a unit of measure (UOM). This is used for unit pricing and costing (e.g. 2 US Dollars per square meter, 3 Yen "each", etc.), and it handles conversions between compatible units of measure.<br><br>These objects are mostly kept inside business objects. Maintenance UIs want to provide separate fields for these properties. The two straightforward techniques are to expose the money object to the UI or to present simple data types and use the setters on the business object to keep the internal money objects in sync. Exposing the money object makes the business object simpler, but makes the UI more complex because it has to handle binding multiple objects and keeping the binding relationships in sync. Exposing the simple fields makes the UI simpler, but it means putting code in the busines object to keep the Money objects in sync.<br><br>The decision really depends on the use case. In our system, an order line has a price and a cost, both of which are money units. The order entry use cases dictates that the UOM property of price and cost are always the same (currency is defined at the order level, which is a different design problem). The user only wants to fill in three fields. This requirement led us to the obvious decision that we should map the fields in the object.<br><br>In another use case, where there is only a single money amount being edited, the choice is not as clear. We found that&nbsp; the majority of our use cases involving money had requirements similar to the order entry use case. We have chosen to standardize on this technique (exposing only simple data types) when the design choice is not clear.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Friday, February 02, 2007</h2><P>Maybe I'm missing something in&nbsp;the discussion,&nbsp;but I have many custom&nbsp;value types (structs) defined in our framework, Currency being one of them.&nbsp; I do not have a problem databinding to properties of these types.</P>
<P>Only thing I can think of causing a problem is if you have not overriden the ToString() method.&nbsp; All of my value types implement IConvertible, override ToString and have an implicit conversion to string that delegates to the ToString method.&nbsp; Maybe your problem lies somewhere in here.</P>
<P>HTH</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jupp replied on Friday, February 02, 2007</h2><P>I think you should implement a I<SPAN class=clsSubhead>CustomTypeDescriptor on your Detail class. For details please visit. </SPAN></P>
<P><SPAN class=clsSubhead><A href="http://msdn.microsoft.com/msdnmag/issues/05/04/NETMatters/">http://msdn.microsoft.com/msdnmag/issues/05/04/NETMatters/</A></SPAN><BR><A href="http://msdn.microsoft.com/msdnmag/issues/05/05/NETMatters/">http://msdn.microsoft.com/msdnmag/issues/05/05/NETMatters/</A></P>
<P>For a collection of Details you could implement ITypeList</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AAKLebanon replied on Monday, February 05, 2007</h2><P>thinks for all the participants in this discussion and i found the solution.</P>
<P>Simply a create a MoneyConverter class that inherits from TypeConverter:</P><FONT color=#0000ff size=2>
<P>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> MoneyConverter</FONT></P>
<P><FONT color=#0000ff size=2>Inherits</FONT><FONT size=2> System.ComponentModel.TypeConverter</P>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> CanConvertFrom(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> context </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.ComponentModel.ITypeDescriptorContext, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> sourceType </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.Type) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean</P></FONT><FONT size=2>
<P>Debug.WriteLine(</FONT><FONT color=#a31515 size=2>"CanConvertFrom "</FONT><FONT size=2> &amp; sourceType.ToString)</P>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> sourceType </FONT><FONT color=#0000ff size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>GetType</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> CanConvertTo(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> context </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.ComponentModel.ITypeDescriptorContext, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> destinationType </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.Type) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean</P></FONT><FONT size=2>
<P>Debug.WriteLine(</FONT><FONT color=#a31515 size=2>"CanConvertTo "</FONT><FONT size=2> &amp; destinationType.ToString)</P>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> destinationType </FONT><FONT color=#0000ff size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>GetType</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> ConvertFrom(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> context </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.ComponentModel.ITypeDescriptorContext, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> culture </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.Globalization.CultureInfo, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> value </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</P></FONT><FONT size=2>
<P>Debug.WriteLine(</FONT><FONT color=#a31515 size=2>"ConvertFrom "</FONT><FONT size=2> &amp; value.ToString)</P>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> Money(value.ToString)</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> ConvertTo(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> context </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.ComponentModel.ITypeDescriptorContext, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> culture </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.Globalization.CultureInfo, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> value </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> destinationType </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.Type) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</P></FONT><FONT size=2>
<P>Debug.WriteLine(</FONT><FONT color=#a31515 size=2>"ConvertTo "</FONT><FONT size=2> &amp; value.ToString &amp; </FONT><FONT color=#a31515 size=2>"("</FONT><FONT size=2> &amp; destinationType.ToString &amp; </FONT><FONT color=#a31515 size=2>")"</FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> value.ToString</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT></P>
<P><FONT color=#0000ff size=2>End Class</FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#000000>Now i will decorate my Money class with this attribute: <FONT size=2></P>
<P>&lt;System.ComponentModel.TypeConverter(</FONT><FONT color=#0000ff size=2>GetType</FONT><FONT size=2>(MoneyConverter))&gt; </FONT></P>
<P>I have tested this in a DataGridView and it is worked fine !!</P>
<P>Think's again and good luck...</FONT></FONT><FONT color=#0000ff size=2></P></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
