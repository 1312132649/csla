<html><header><title>Override Static Methods...</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Override Static Methods...</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1754.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Wbmstrmjb posted on Monday, November 13, 2006</h2><P>So obviously you cannot override static methods but my question is if there might be some way around it?&nbsp; </P>
<P>I am building a base class that will wrap&nbsp;the CSLA BusinessBase and handle the CRUD in a uniform way.&nbsp; Then my classes will all inherit from this base and set their own properties so that the base class knows what properties each object has.&nbsp; </P>
<P>The base class needs to be able to define the CanAdd, CanEdit, CanGet, etc. so that each object can have it's own permissions.&nbsp; These functions are static as they are called by the factory methods (which are obviously static).&nbsp; </P>
<P>Any ideas on getting around this issue without having to move all the test logic up to each of the inheriting classes?&nbsp; </P>
<P>Thanks, </P>
<P>Michael</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Tuesday, November 14, 2006</h2><BLOCKQUOTE><div><img src="/Themes/alternate1/images/icon-quote.gif"> <strong>Wbmstrmjb:</strong></div><div><p>So obviously you cannot override static methods but my question is if there might be some way around it?&nbsp; </p>
<p>I am building a base class that will wrap&nbsp;the CSLA BusinessBase and handle the CRUD in a uniform way.&nbsp; Then my classes will all inherit from this base and set their own properties so that the base class knows what properties each object has.&nbsp; </p>
<p>The base class needs to be able to define the CanAdd, CanEdit, CanGet, etc. so that each object can have it's own permissions.&nbsp; These functions are static as they are called by the factory methods (which are obviously static).&nbsp; </p>
<p>Any ideas on getting around this issue without having to move all the test logic up to each of the inheriting classes?&nbsp; </p>
<p>Thanks, </p>
<p>Michael</p></div></BLOCKQUOTE><br><br>Use a generic method which accepts the Type of object for which you wish to know the CanAdd/CanEdit/etc. flag:<br><br>Public Shared Function CanAdd(Of TObject) As Boolean<br><br>You can compare the TObject (or TObject.ToString) against a database table to determine to permissions for this particular type of object.<br><br>Tip: load the permissions only once into a hashtable or dictionary and cache it there. ;-)<br><br>Bayu<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Wbmstrmjb replied on Wednesday, November 15, 2006</h2><P>Thank you so much for your responses.&nbsp; I guess I am having a hard time with grasping the suggestion by Bayu.&nbsp; The way I read it, I'd put all of my checking in the base class and therefore it would need to know about all the different possible types of objects I may create that inherit that class (obviously I could just have it load a collection of objects from a DB and then it would "know" based on the DB).</P>
<P>But what if the objects don't all "work" that way?&nbsp; Can I not write custom CanAdd, Can Edit, etc. functions in the derived classes that can "override" the base functionality?&nbsp; My creative juices have run out.</P>
<P>Thanks,</P>
<P>Mike</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, November 16, 2006</h2>Here's some "code for thought"<br><br>&nbsp; public abstract class ABase<br>&nbsp; {<br>&nbsp;&nbsp;&nbsp; private static Dictionary&lt;Type, bool&gt; _list = new Dictionary&lt;Type, bool&gt;();<br>&nbsp;&nbsp;&nbsp; public static bool CanAdd&lt;T&gt;()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_list.ContainsKey(typeof(T)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return _list[typeof(T)];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw new Exception("Type not available");<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; protected static void SetCanAdd(Type type, bool value)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _list.Add(type, value);<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp; }<br><br>&nbsp; public class AChild : ABase<br>&nbsp; {<br>&nbsp;&nbsp;&nbsp; static AChild()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetCanAdd(typeof(AChild), true);<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp; }<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoOfMetL replied on Tuesday, November 14, 2006</h2><br><i>in the base class : </i><br><br>public static bool CanAddObject()<br>{<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return true;<br>}<br><br><i>for the object which inherits of the base class</i><br><br>&nbsp;public static <b>new</b> bool CanAddObject() <br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ......<br>}<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, November 14, 2006</h2>I wouldn't recommend this method, as using new breaks some OO principals pretty badly. <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Tuesday, November 14, 2006</h2><BLOCKQUOTE><div><img src="/Themes/alternate1/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>I wouldn't recommend this method, as using new breaks some OO principals pretty badly. <br></div></BLOCKQUOTE><br><br>The C# new keyword equals VB's Shadows right? In that case I certainly go along with this recommendation. <br><br>Bayu<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, November 14, 2006</h2>Not too familar with VB, but I believe that's correct.&nbsp; new in C# allows you to 'override' anything, marked virtual or not, and allows you to change the method signature as well.&nbsp; I think that's what Shadows does, correct?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Tuesday, November 14, 2006</h2><BLOCKQUOTE><div><img src="/Themes/alternate1/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>Not too familar with VB, but I believe that's correct.&nbsp; new in C# allows you to 'override' anything, marked virtual or not, and allows you to change the method signature as well.&nbsp; I think that's what Shadows does, correct?<br></div></BLOCKQUOTE><br><br>Yups.<br><br><br>So I guess my original suggestion (several posts up in this thread) remains a valid one. At least one that so far sustained the scrutiny of design-guys like Andy. <img src="/emoticons/emotion-5.gif" alt="Wink [;)]" /><br><br>Regards,<br>Bayu<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoOfMetL replied on Tuesday, November 14, 2006</h2><br>Why don't you recommended this method ?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, November 14, 2006</h2>It breaks inheritance.&nbsp; Normally you have the same static method on base and subclasses.&nbsp; With new, thats no longer true, because you can change the methods access or return values.&nbsp; This is probably more true with instance members than static ones.<br><br>There's really no reason to declare the method in the base class, unless the base class is not abstract.&nbsp; If the base class can be used as is, then its acceptable to declare security members there.&nbsp; But if its abstract, its better just to leave it off, because you'll probably want to ask the subclasses what security is allowed anyway.&nbsp; You can't inherit static members, so there's no reason to include 'base functionality.'<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pelinville replied on Tuesday, November 14, 2006</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>Wbmstrmjb:</strong></div><div>
<P>So obviously you cannot override static methods but my question is if there might be some way around it?&nbsp; </P>
<P>I am building a base class that will wrap&nbsp;the CSLA BusinessBase and handle the CRUD in a uniform way.&nbsp; Then my classes will all inherit from this base and set their own properties so that the base class knows what properties each object has.&nbsp; </P>
<P>The base class needs to be able to define the CanAdd, CanEdit, CanGet, etc. so that each object can have it's own permissions.&nbsp; These functions are static as they are called by the factory methods (which are obviously static).&nbsp; </P>
<P>Any ideas on getting around this issue without having to move all the test logic up to each of the inheriting classes?&nbsp; </P>
<P>Thanks, </P>
<P>Michael</P>
<DIV></div></BLOCKQUOTE></DIV>
<DIV>&nbsp;</DIV>
<DIV>A couple of other options.</DIV>
<DIV>&nbsp;</DIV>
<DIV>1. Do they really have to be static/shared?&nbsp; You could create the class then check their CanXXX() methods.&nbsp; This way you could use simple inheritance. Expanding on the this you could define an interface then have your classes implement the interface.</DIV>
<DIV>&nbsp;</DIV>
<DIV>3. An alternative is to use attributes.&nbsp;</DIV>
<DIV>&nbsp;</DIV>
<DIV>4.&nbsp; Don't override.&nbsp; In the base class&nbsp;method&nbsp;&nbsp;retrieve the values from a store (config file, DB etc) based on the type of the subclass calling it.&nbsp;(Or&nbsp;use the static method to read the attributes of the subclass.)&nbsp;&nbsp;</DIV>
<DIV>&nbsp;</DIV>
<DIV>5. Use shadows.&nbsp; From what I understand the main problem with it is that you might call the wrong method (the base classes instead of the sub class).&nbsp; But if you limit the scope of the methods to protected and the base class is MustInherit&nbsp;then the chances of this happening are not real likely.&nbsp; </DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, November 14, 2006</h2>I think Bayu's early suggestion is the best overall option, and it is one I considered - and may reconsider - for the framework itself. I didn't feel confident enough in the overall concept when I was writing the book, but Magenic now has a project using this technique and it is working quite well.<br><br>The problem of course, is that the methods really do need to be static/Shared. Otherwise the UI would be required to create a "dummy" instance of the object to enable/disable top level menu options or links - and that seems quite odd. The UI should be able to ask whether the user can do basic operations without having to first instantiate the business object.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Wednesday, November 15, 2006</h2><BLOCKQUOTE><div><img src="/Themes/alternate1/images/icon-quote.gif"> <strong>RockfordLhotka:</strong></div><div>I think Bayu's early suggestion is the best overall option, and it is one I considered - and may reconsider - for the framework itself. I didn't feel confident enough in the overall concept when I was writing the book, but Magenic now has a project using this technique and it is working quite well.<br><br></div></BLOCKQUOTE><br><br>Yey! I 'won'! ......&nbsp; <img src="/emoticons/emotion-11.gif" alt="Cool [H]" /><br><br>Just kidding. ;-)<br>Great start of my day. <img src="/emoticons/emotion-4.gif" alt="Stick out tongue [:P]" /><br>Thanks. <br><br>Bayu<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
