<html><header><title>Pre-Transaction Command in a [Transactional(TransactionalTypes.TransactionScope)] method?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Pre-Transaction Command in a [Transactional(TransactionalTypes.TransactionScope)] method?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5075.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>agartee posted on Wednesday, July 09, 2008</h2><P>If I have a method that has the "[Transactional(TransactionalTypes.TransactionScope)]" attribute(DataPortal_Insert, DataPortal_Update, DataPortal_Delete) and I want to run a command&nbsp;before the transaction is started (specifically, calling the SQL "sp_setapprole" stored procedure to active a SQL Application Role), how could I go about doing that?</P>
<P>I am trying to keep the code nice and elegant and don't really want to exclude the transaction attribute&nbsp;to handle the transaction myself if I can help it.&nbsp; Is there something in the CSLA framework that is designed to handle this kind of activity?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, July 09, 2008</h2>I think your only option is to handle transactions manually in that case.&nbsp;&nbsp; You can still use TransactionScope, just not have Csla use the object on your behalf via the attribute.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, July 10, 2008</h2><P>This is exactly right - if you want more control over the transaction (setting isolation levels for example) or if you want to have some code in the transaction and other code outside the transaction or if you want multiple transactions, then you need to manually set up the transaction yourself.</P>
<P>The good news here is that when it comes to using a TransactionScope, CSLA is only saving you 3 lines of code, two of which are { and }&nbsp;&nbsp; :)&nbsp;&nbsp;&nbsp; </P>
<P>I almost didn't even add this support at all - why bother to save such simple code - but it provided parity with the pre-existing model from CSLA 1.x and so I decided to provide the support.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
