<html><header><title>Property Grid, ICustomTypeDescriptor and Data Binding</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Property Grid, ICustomTypeDescriptor and Data Binding</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2926.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>RichMark posted on Tuesday, May 22, 2007</h2><P>I have developed MyGeneration modules to create CSLA objects and SQL Stored Procedures.&nbsp; As part of my implementation I have included code so that the objects are totally accessible from a Property Grid.&nbsp; I have included Lazy Loading of related data, and all of this works as expected, no small thanks to Rocky!</P>
<P>I am now at the point where I would like to integrate security.&nbsp; I would like the PropertyGrid to show the CSLA security though CanWriteProperty.&nbsp; To do this, I was planning to use ICustomTypeDescriptor to specify a ReadOnly attribute.&nbsp; </P>
<P>I was able to add the ICustomTypeDesciptor and it did what I wanted to the PropertyGrid.&nbsp; However, when I try to use data binding, the object no longer appears in my list of data binding sources.&nbsp; If I comment out the ",ICustomTypeDesciptor" interface declaration (not any of the supporting code, simply the declaration) the object is accessible from the data binding sources.</P>
<P>I realize this is not an issue with CSLA, but, I was hoping that someone might have an idea how to make fields in a propertygrid read-only based upon CanWriteProperty.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RichMark replied on Friday, May 25, 2007</h2><P>Just after I posted this yesterday, I found&nbsp;this item on Microsoft that explains why.&nbsp;</P>
<P><A href="http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=93944">http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=93944</A></P>
<P>&nbsp;However, I am working on a solution.&nbsp; It involves creating a CustomTypeDescriptor that encloses the class that I want to use.&nbsp; Then when I want to use it in a property grid I will&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; use&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; th&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e CustomTypeDescriptor.&nbsp; When I want to use DataBinding I simply point to the object itself.&nbsp; I have a test version working, but, I will post a full version when I get it tested.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
