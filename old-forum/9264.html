<html><header><title>How to not use n-level undo</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How to not use n-level undo</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9264.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dg78 posted on Friday, July 23, 2010</h2><p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Hi,</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">I use Csla 3.6 vb for WinForms.</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">I want to use BindingSourceNode and BindingSourceHelper to manage Master-Details display but without using CslaActionExtender because I implement the Save button on a ToolBar (as Rocky wrote in his book).</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">I don&rsquo;t want to use n-level undo but I don&rsquo;t understand how to do that (not use n-level undo).</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">My BO inherits from BusinessBase which implements IEditableBusinessObject which implements ISupportUndo so&nbsp;my BO&nbsp;use always n-level undo.</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">In BindingSourceNode, there are such lines :</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Dim</span> root <span style="color:blue;">As</span> Core.ISupportUndo = <span style="color:blue;">TryCast</span>(objectToBind, Core.ISupportUndo)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">If</span> root <span style="color:blue;">IsNot</span> <span style="color:blue;">Nothing</span> <span style="color:blue;">Then</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>root.BeginEdit()</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">End</span> <span style="color:blue;">If</span></span></p>
<p><span lang="EN-US" style="mso-ansi-language:EN-US;">
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><br /><span style="font-size:small;"><span style="font-family:Calibri;">So always my BO (objectToBind) use n-level undo.<br /><span lang="EN-US" style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;font-size:11pt;mso-ansi-language:EN-US;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:&#39;Times New Roman&#39;;mso-bidi-theme-font:minor-bidi;mso-fareast-language:EN-US;mso-bidi-language:AR-SA;">How to not use n-level undo ?</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;">&nbsp;</p>
</span><span style="font-size:small;"><span style="font-family:Calibri;"><span lang="EN-US" style="mso-ansi-language:EN-US;">I saw that there is the </span><span lang="EN-US" style="mso-ansi-language:EN-US;mso-bidi-font-family:TheSansMonoConSemiLight;">NotUndoable </span><span lang="EN-US" style="mso-ansi-language:EN-US;mso-bidi-font-family:Utopia-Regular;">attribute but it is for a field and I want the same for the whole BO.</span><span lang="EN-US" style="mso-ansi-language:EN-US;"></span></span></span></p>
<p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Thanks for help </span></span></span></p>
</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Friday, July 23, 2010</h2><p>In your constructor you can set the DisableIEditableObject property to prevent data binding from interacting with n-level undo.</p>
<p>You must be aware that data binding <i>expects</i> the object to honor IEditableObject, but there are some scenarios where you can disable the behavior and still get a workable UI.</p>
<p>In other words, you are about to go down a road where you&#39;ll be fighting with data binding. If you fully understand how data binding works, and what it expects and what happens when it doesn&#39;t get what it expects, you can construct a UI that works with IEditableObject disabled.</p>
<p>I strongly recommend creating some very basic test apps with test scenarios to see what does and doesn&#39;t work, so you can learn the limits of this scenario.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dg78 replied on Saturday, July 24, 2010</h2><p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Thanks Rocky for your answer.</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">I want to use the databinding with IEditableObjet.</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">I don&rsquo;t understand why n-level undo is lied with databinding.</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Databinding uses IEditableObjet (from framework). This interface has 3 methods : BeginEdit, CancelEdit and EndEdit.</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">N-level undo uses ISupportUndo (from Csla). This interface has 3 methods : BeginEdit, CancelEdit and ApplyEdit. Why do you use the same name for the methods BeginEdit and CancelEdit ?</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Why there is not a flag DisabledUndo ?<br />With a such flag, we could disabled only undo and keep the databinding (and its IEditableObjet).</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 10pt;background:#cedefd;"><span style="font-family:Calibri;"><span lang="EN-US" style="color:#333333;font-size:12pt;mso-ansi-language:EN-US;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-bidi-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;">For instance, in the code inside BindingSourceNode :</span><span lang="EN" style="font-family:&#39;Times New Roman&#39;,&#39;serif&#39;;color:#333333;font-size:12pt;mso-ansi-language:EN;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;background:#cedefd;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">Dim</span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"> root </span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">As</span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"> Core.ISupportUndo = </span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">TryCast</span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">(objectToBind, Core.ISupportUndo)</span><span lang="EN" style="font-family:&#39;Times New Roman&#39;,&#39;serif&#39;;color:#333333;font-size:12pt;mso-ansi-language:EN;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;background:#cedefd;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">If</span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"> root </span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">IsNot</span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"> </span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">Nothing</span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"> </span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">Then</span><span lang="EN" style="font-family:&#39;Times New Roman&#39;,&#39;serif&#39;;color:#333333;font-size:12pt;mso-ansi-language:EN;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;background:#cedefd;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>root.BeginEdit()</span><span lang="EN" style="font-family:&#39;Times New Roman&#39;,&#39;serif&#39;;color:#333333;font-size:12pt;mso-ansi-language:EN;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 6pt;background:#cedefd;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">End</span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"> </span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">If</span><span lang="EN" style="font-family:&#39;Times New Roman&#39;,&#39;serif&#39;;color:#333333;font-size:12pt;mso-ansi-language:EN;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">We could add :</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;background:#cedefd;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">Dim</span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"> root </span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">As</span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"> Core.ISupportUndo = </span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">TryCast</span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">(objectToBind, Core.ISupportUndo)</span><span lang="EN" style="font-family:&#39;Times New Roman&#39;,&#39;serif&#39;;color:#333333;font-size:12pt;mso-ansi-language:EN;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;background:#cedefd;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">If</span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"> not(DisabledUndo) and (root </span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">IsNot</span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"> </span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">Nothing)</span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"> </span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">Then</span><span lang="EN" style="font-family:&#39;Times New Roman&#39;,&#39;serif&#39;;color:#333333;font-size:12pt;mso-ansi-language:EN;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;background:#cedefd;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>root.BeginEdit()</span><span lang="EN" style="font-family:&#39;Times New Roman&#39;,&#39;serif&#39;;color:#333333;font-size:12pt;mso-ansi-language:EN;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 6pt;background:#cedefd;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">End</span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:#333333;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"> </span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;">If</span><span lang="EN" style="font-family:&#39;Times New Roman&#39;,&#39;serif&#39;;color:#333333;font-size:12pt;mso-ansi-language:EN;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-fareast-language:FR;"></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">It is sure, I can add it but I don&rsquo;t want to change Csla. <br />Over more, I think that if you don&rsquo;t do it, there is a good reason. Thanks to explain.</span></span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Saturday, July 24, 2010</h2><p>IEditableObject requires that the implementor (CSLA) take a snapshot of the object state when BeginEdit is called, so it can revert to that snapshot when CancelEdit is called. That is what n-level undo does, so CSLA uses its n-level undo behavior to implement IEditableObject.</p>
<p>Actual n-level undo is <i>never used unless you invoke it</i>. So there&#39;s no reason to have a flag to disable n-level undo, because that&#39;d be ridiculous. N-level undo is never used <i>unless you use it</i>. So why would CSLA implement a flag so you can turn off a feature you explicitly wrote code to use?</p>
<p>If anything, CslaActionExtender might need a way to indicate that it shouldn&#39;t offer support for a top-level Cancel button. I actually thought it had that already, but perhaps not.</p>
<p>For example, look at the Csla.Xaml.ViewModelBase or Csla.Xaml.CslaDataProvider - both of which have a ManageObjectLifetime flag so you can indicate whether you want those components to automatically use n-level undo to make it possible for you to have a top-level Cancel button.</p>
<p>In other words, whether n-level undo is called (outside IEditableObject) is a UI concern, not an object concern. The <i>only</i> reason there&#39;s a flag to disable IEditableObject is that it is impossible to prevent Windows Forms from invoking that interface, so the object has to be able to ignore it to accomplish certain edge case scenarios in Windows Forms.</p>
<p>Thankfully all the modern UI technologies work much better with binding than Windows Forms, so eventually much of that stuff will be able to go away from CSLA (or so I hope).</p>
<p>So back to CslaActionExtender. If it doesn&#39;t have the equivalent to ManageObjectLifetime, it probably should. Unfortunately Windows Forms support in CSLA is in bug-fix-only mode. I view it as a legacy technology at this point - almost by necessity, since I can barely keep up with everything that&#39;s changing in the modern UI technologies,..</p>
<p>Of course CSLA is open source, so if you&#39;d like to enhance CslaActionExtender along this line (and sign a contributor agreement), I am absolutely willing to consider accepting a patch along that line.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dg78 replied on Saturday, July 24, 2010</h2><p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Thanks Rocky for your explanations.</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">In a few weeks, I hope to have a little of free time so I&rsquo;ll see to do a patch and I shall send you.</span></span></span></p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
