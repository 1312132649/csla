<html><header><title>Another Undo Question - Individual property undos.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Another Undo Question - Individual property undos.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/548.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>slipmat posted on Wednesday, July 05, 2006</h2>Hi all,<br>I am fairly new to CSLA (reading book currently).<br>Rocky has put a lot of effort into the n-level undo functionality, but it seems only to be used to take one snapshot of an object before the user makes changes to the object as a whole. I would like to be able to undo individual property sets (Nested Undos?). Has anyone implemented the undo operations this way with CSLA?<br>My apologies if I'm missing something obvious, but it seems to achieve this I need to catch events on editing controls (e.g. Textbox) or bindings and call BeginEdit, which is fine. But then after (n) number of BeginEdits I also have to call ApplyEdit the same number of times before I can save (otherwise the object cannot be saved because it is being edited), which seems messy. And what if the user wants to undo a change after they have saved? Correct me if I'm wrong, but hasn't the undo stack been cleared by calling ApplyEdit n times?<br><br>Again, I'm sorry if I've missed something obvious, as the framework is a lot to take in at first.<br>So basically, if I'm wrong, could someone please point in the right direction, otherwise<br>make some suggestions as to a clever way to implement nested undos. Cheers.<br><br>Full credit Rocky and everyone involved, the framework is is incredible!<br><br>Thanks<br>Matt<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, July 06, 2006</h2>Matt,<br><br>You can certainly add this functionality yourself, perhaps by creating a BeginEdit( string propertyName ) method (and corrisponding Cancel and Accept).&nbsp; This would likely be quite a bit of overheard (as each property needs to store a stack of changes).<br><br>Calling ApplyEdit a number of time equal to Begin edit really isn't that big a deal.&nbsp; You are right, once Accept is called, those changes can no longer be undone.&nbsp; But that is the purpose of Accepting changes; the user has decided that they want to keep those changes.<br><br>Also, once you accept changes, it doesn't make sense to allow any more undos; otherwise, why did the user accept the changes to begin with?&nbsp; I suppose if you really wanted to you could reload the object instead of saving it and thus 'undo' back to the state of the database.<br><br>HTH<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>hurcane replied on Thursday, July 06, 2006</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>slipmat:</strong></div><div>Hi all,<br>So basically, if I'm wrong, could someone please point in the right direction, otherwise<br>make some suggestions as to a clever way to implement nested undos. Cheers.<br></div></BLOCKQUOTE><br><br>I don't think anybody has come up with a clever way to handle undo/redo of property-level changes. It's practically impossible to implement an undo/redo with a generic algorithm. It is not uncommon for a property Set to have side-effects, such as filling other fields with default values. Are these side effects reversed individually, or are they reversed as a group?<br><br>Most Undo patterns involve the use of command objects. The command objects have an Execute and Undo method, which invokes the necessary logic for the particular action. The command object needs to keep state, and the business object would have to provide methods for undoing the action. <br><br>For more information, you might want to check <a href="http://www.cs.mcgill.ca/%7Ehv/classes/CS400/01.hchen/doc/command/command.html">this page</a>.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jojo33333 replied on Tuesday, October 12, 2010</h2><p>Times change.&nbsp; UndoEngine at <a target="_blank" href="http://www.undomadeeasy.com">www.undomadeeasy.com</a>&nbsp;has a generic algorithm that I have found really easy to use</p>
<p>All the best</p>
<p>JoJo33333</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>slipmat replied on Sunday, July 09, 2006</h2>Thanks for your input.<br>I'm glad I haven't missed some aspect of the framework.<br><br>Cheers<br>Matt<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
