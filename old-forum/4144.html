<html><header><title>Adding a 'Choose One' item to combo box</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Adding a 'Choose One' item to combo box</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4144.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonM posted on Thursday, January 10, 2008</h2><P>In a search window I have a read-only collection of possible types to be used as a paramter in my search.&nbsp; However, I want to add an extra item to the combo like 'Choose One'.&nbsp; If set to 'Choose One' it would actually be null and I would know not to use this parameter in the search.&nbsp; So far the only way I've found to achieve this is to muck up my read only collection in order to get it to add an extra.&nbsp; Any ideas on this one?&nbsp; It seems to me like it would be a common thing you would want to do.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, January 10, 2008</h2><P>This has been discussed many times. There are some interesting solutions posted too. You should be able to find them with a Search.</P>
<P>As I recall there is one very nice solution which abstracts this whole idea nd lets you add whatever the phrase of the day is - "Choose One", "blank", "Add New", "Pick anything but me", etc.</P>
<P>I usually have 2 methods on my NVL which tell me to retrieve the data or add the "fake first row" and then then&nbsp;retrieve the data.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mr_lasseter replied on Thursday, January 10, 2008</h2><P>Look about half way down for the HeaderedBindingList.</P>
<P><A HREF="/forums/2/4613/ShowThread.aspx">http://forums.lhotka.net/forums/2/4613/ShowThread.aspx</A></P>
<P>&nbsp;</P>
<P>mike</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JohnB replied on Thursday, January 10, 2008</h2><font face="Verdana" size="2">Here is one method of doing it.<br><br>Let's assume that we wish to fill a combo with customers so I would have the following:<br><br><span>&lt;Serializable()&gt; _</span><br><span>Public Class CustomerComboList</span><br><span>&nbsp;&nbsp;&nbsp; Inherits Csla.ReadOnlyListBase(Of CustomerComboList, CustomerComboInfo)</span><br><br><span>&nbsp;&nbsp;&nbsp; Public Shared Function GetCustomerComboList(Optional ByVal FirstItemInList As String = "") As CustomerComboList</span><br><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return Csla.DataPortal.Fetch(Of CustomerComboList)(New Criteria(FirstItemInList))</span><br><br><span>&nbsp;&nbsp;&nbsp; End Function</span><br><br><span>In my Criteria object for the CustomerComboList I would have the following:</span><br><br><span>Private Class Criteria</span><br><br><span>&nbsp;&nbsp;&nbsp; Private _firstItemInList As String = String.Empty</span><br><br><span>&nbsp;&nbsp;&nbsp; Public ReadOnly Property FirstItemInList() As String</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return _firstItemInList</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get</span><br><span>&nbsp;&nbsp;&nbsp; End Property</span><br><br><span>&nbsp;&nbsp;&nbsp; Public Sub New(ByVal FirstItemInList As String)</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _firstItemInList = FirstItemInList</span><br><span>&nbsp;&nbsp;&nbsp; End Sub</span><br><br><span>End Class</span><br><br><span>Finally the Fetch:</span><br><br><span>&nbsp; <span>Private Sub Fetch(ByVal criteria As Criteria)</span></span><br><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RaiseListChangedEvents = False</span><br><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Using cn As New SqlConnection(MyConfig.DataConnection)</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cn.Open()</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Using cm As SqlCommand = cn.CreateCommand</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; With cm</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .CommandType = CommandType.StoredProcedure</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .CommandText = "SomeProcName"</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Using dr As New Csla.Data.SafeDataReader(.ExecuteReader)</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsReadOnly = False</span><br><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '-- Check to see if we need to add a custom first item to the list</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If criteria.FirstItemInList.Length &gt; 0 Then</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim firstItem As CustomerComboInfo = New LocationInfo(-1, criteria.FirstItemInList)</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.Add(firstItem)</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If</span><br><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; While dr.Read()</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim info As New CustomerComboInfo(dr.GetInt32(0), dr.GetString(1), dr.GetInt32(2))</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.Add(info)</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End While</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsReadOnly = True</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Using</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End With</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Using</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Using</span><br><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RaiseListChangedEvents = True</span><br><br><span>&nbsp; End Sub</span><br><br><span>End Class</span><br><br><span>I used -1 to distinguish the new entry but you could use whatever you want here.</span><br><br><span>I'm sure there are many ways of doing this but hopefully it helps you out!</span></font></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
