<html><header><title>Controling Order of Properties Returned in PropertyDescriptionCollection</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Controling Order of Properties Returned in PropertyDescriptionCollection</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3661.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Biceman posted on Sunday, October 07, 2007</h2><font face="Tahoma">I'm developing an application using DevExpress grids.&nbsp; Each time I associated a grid with one of my business object lists, the column collection created by the grid was in some seeming random order.&nbsp; I would then have to go through and manually fix the order to something more reasonable (e.g., column order in my SQL table that I have memorized).&nbsp; <br><br>After doing some research, I (finally) came across an <a href="http://http://www.sturmnet.org/blog/archives/2005/03/03/properties-order/">article</a> Oliver Strum posted a couple of years ago which gave a C# example on how you can overcome this problem using custom property descriptors.<br><br>The summarized steps are: <br></font><ul><li><font face="Tahoma">create a custom attribute which allows you to designate an explicit sort sequence number for each property,</font></li><li><font face="Tahoma">subclass the PropertyDescriptor class to include a Sort Sequence Number property, <br></font></li><li><font face="Tahoma">create a helper class which makes use of the above two items, and</font></li><li><font face="Tahoma">implement the ITypedList interface for your business object lists<br></font></li></ul><span><br>I took his C# code and converted it to VB and made a few minor modifications, namely I added a subsort such that if the Sort Sequence Number values are equal, the Property's Name breaks the tie.&nbsp; <br><br>As a result, my grid's column order now defaults to MY desired order.&nbsp; My system has ~100 tables so this made the initial grid design much quicker.<br><br>You can do as little as implementing the ITypedList interface (i.e., not apply the custom attribute to any of your properties) and you'll get your properties returned in alphabetical order (which is at least predictable!)&nbsp; The sort sequence number for each Property without the attribute will default to Int32.Max.&nbsp; Since the sort sequence numbers will all be the same, the "break the tie by Property Name" condition will kick-in.<br><br>The ITypedList is simple and consists of:<br><br><font size="2">Public Function GetItemProperties(ByVal listAccessors() As PropertyDescriptor) As PropertyDescriptorCollection Implements ITypedList.GetItemProperties<br>&nbsp;&nbsp; Return SortedPropertyDescriptorCollectionHelper.GetPropertyCollection(GetType(&lt;ListItem ComponentType&gt;))<br>End Function</font><br><br>where &lt;ListItemComponentType&gt; is the "C" parameter in the "Inherits BusinessListBase(Of T, C)"&nbsp; <br><br><font size="2">Public Function GetListName(ByVal listAccessors() As PropertyDescriptor) As String Implements ITypedList.GetListName<br>&nbsp;&nbsp; Return Me.GetType.Name<br>End Function</font><br><br>Note that the listAccessors parameter is ignored currently.&nbsp; For my use this was not an issue and I believe that's the way Oliver had it in his example.<br><br>Also, I noticed today when I was upgraded to v3.02 of the framework a method in the Utilities module called GetChildItemType.&nbsp; This takes the type of a list/collection as input and outputs the type of the child item.&nbsp; Using this function would allow the </span><span><font size="2">GetType(&lt;ListItem ComponentType&gt;) <font size="3">code to become generic for each list.<br><br><font size="3">The helper function is Shared/Singleton in nature.&nbsp; It caches each Property Descriptor Collection it creates to speed processing for repeated calls.<br><br>Figured I would offer it up to other folks that might find it helpful.</font><br></font></font></span></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
