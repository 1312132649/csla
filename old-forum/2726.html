<html><header><title>Csla and Oracle</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Csla and Oracle</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2726.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Nika posted on Wednesday, April 18, 2007</h2><H2><FONT color=#800000><FONT face=Arial><FONT size=2>I try to use Csla framework with Oracle database. I created web application and try to establish connection using Enterprise Services (created and registered dll) but in execution time I have error message “<I>Could not load file or assembly 'EnterpriseServicesHostvbora' or one of its dependencies. The system cannot find the file specified”<o:p></o:p></I></FONT></FONT></FONT></H2>
<H2><FONT face=Arial><FONT size=2><I><FONT color=#800000>That error was in </FONT></I><SPAN>Csla\DataPortal\Client\DataPortal.vb&nbsp;&nbsp;&nbsp;</SPAN></FONT></FONT></H2><PRE><SPAN><FONT face=Arial><FONT size=2>Line 417: mPortal = DirectCast(Activator.CreateInstance(assemblyName, _<o:p></o:p></FONT></FONT></SPAN></PRE><PRE><SPAN><FONT face=Arial><FONT size=2>Line 418:<SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>typeName).Unwrap, DataPortalClient.IDataPortalProxy)</FONT></FONT></SPAN><o:p><FONT face=Arial size=2>&nbsp;</FONT></o:p></PRE>
<P class=MsoNormal><FONT face=Arial size=2>Is somebody use csla framework with Oracle database? What is the best way?</FONT></P>
<P class=MsoNormal><FONT face=Arial size=2></FONT>&nbsp;</P>
<P class=MsoNormal><FONT face=Arial size=2>Thank you.</FONT></P>
<P class=MsoNormal><o:p><FONT face=Arial size=1>&nbsp;</FONT></o:p></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, April 18, 2007</h2><P>I use Oracle and SQL Server.</P>
<P>You do NOT need Enterprise Services at all.</P><FONT size=2>
<P>Just set a reference to System.Data.OracleClient and you can use all the same features that SqlClient uses.</P><FONT size=2>
<P>SqlCommand&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT size=2>OracleCommand</FONT></P><FONT size=2><FONT size=2>
<P>SqlConnection&nbsp;&nbsp;&nbsp; <FONT size=2>OracleConnection</FONT></P><FONT size=2><FONT size=2>
<P>SqlDataAdapter&nbsp; <FONT size=2>OracleDataAdapter</FONT></P><FONT size=2><FONT size=2>
<P>SqlParameter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT size=2>OracleParameter</P></FONT></FONT></FONT></FONT></FONT></FONT></FONT></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Nika replied on Wednesday, April 18, 2007</h2><P><FONT size=2><FONT face=Arial>Thank you,<o:p></o:p></FONT></FONT></P>
<P><FONT size=2><FONT face=Arial>I use OracleClient and also I start to use Oracle.NET tool for Microsoft Visual Studio.<o:p></o:p></FONT></FONT></P>
<P class=MsoNormal><FONT size=2><FONT face=Arial>But I like to use Csla feturs and get result (ref cursor) from Oracle procedure using </FONT></FONT></P>
<P class=MsoNormal><FONT size=2><FONT face=Arial><SPAN>Return</SPAN><SPAN> DataPortal.Fetch(<SPAN>Of</SPAN> PrList)(<SPAN>New</SPAN> Criteria).</SPAN></FONT></FONT></P>
<P class=MsoNormal><FONT size=2><FONT face=Arial><SPAN></SPAN></FONT></FONT>&nbsp;</P>
<P class=MsoNormal><FONT size=2><FONT face=Arial><SPAN>Can I use this functionalily?</SPAN></FONT></FONT></P>
<P class=MsoNormal><FONT size=2><FONT face=Arial><SPAN></SPAN></FONT></FONT>&nbsp;</P>
<P class=MsoNormal><FONT size=2><FONT face=Arial><SPAN></SPAN></FONT></FONT>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Yang replied on Wednesday, April 18, 2007</h2><P>You can use that functionality. The usage of CSLA should not be any different by using Oracle.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Nika replied on Wednesday, April 18, 2007</h2><P class=MsoNormal><SPAN>Thank you, for your help.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>I use Oracle 10g and Oracle Data Privider for .NET.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>I created sample project and I do not have any connection problem.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>Only problem I have when try to get result using Csla functionallity.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>And also I like to know how you control transuctions.&nbsp;</SPAN><SPAN><o:p>&nbsp;</o:p></SPAN></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Yang replied on Wednesday, April 18, 2007</h2>that depends on what you want to accomplish. You can check out the System.Transactions if you want to be fancy. I believe in Oracle, this will be a COM+ transaction and will incur some overhead. If you use SQLServer 2005, this works great.&nbsp;For me, I just implement friend save methods in my child business objects that accepts a DBTransaction parameter and an instance of the DAAB Database and handle the commit and rollback from the parent business list object. </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Nika replied on Friday, April 20, 2007</h2><BLOCKQUOTE dir=ltr><FONT face=Arial size=2>
<P class=MsoNormal><SPAN>I like to share my experience working with Csla and Oracle.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>Unfortunately class <SPAN>SafeDataReader does not suport Oracle data type.<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN>I was able to get result from Oracle RefCursor only with OracleDataReader.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>I have another problem to visualize all result in GridView control. For example I have 400 records and need to use paging. Is CslaDataSource support paging in interface level?<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><o:p><FONT face="Times New Roman" size=3>&nbsp;</FONT></o:p></P>
<P class=MsoNormal></FONT><o:p><FONT face=Arial size=2>&nbsp;</FONT></o:p></P></BLOCKQUOTE>
<P class=MsoNormal><o:p><FONT face=Arial></FONT></o:p>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, April 20, 2007</h2>In version 2.1.4, CslaDataSource allows you to implement paging in the GridView control, in the SelectObject event handler, in your object's factory method, in your object's DataPortal_Fetch method or in a stored procedure (or other database construct). You can choose which location is the most efficient for your particular requirements.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Nika replied on Friday, April 20, 2007</h2><P class=MsoNormal><SPAN>Thank you,<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>It was very easy. <o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>I used SelectObject event to populate business object and created small procedure DisplayCurrentPage&nbsp;and called from </SPAN></P>
<P class=MsoNormal><SPAN></SPAN><SPAN>GridView1_PageIndexChanged and GridView1_SelectedIndexChanged events.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Sub</SPAN><SPAN> DisplayCurrentPage()<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Dim</SPAN> i <SPAN>As</SPAN> <SPAN>Integer<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>GridView1.DataBind()<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>If</SPAN> GridView1.PageCount &gt; 0 <SPAN>Then<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>For</SPAN> i = 0 <SPAN>To</SPAN> GridView1.PageCount - 1<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Dim</SPAN> pageNumber <SPAN>As</SPAN> <SPAN>Integer</SPAN> = i + 1<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Dim</SPAN> item <SPAN>As</SPAN> ListItem = <SPAN>New</SPAN> <SPAN>&nbsp;</SPAN>ListItem(pageNumber.ToString())<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>If</SPAN> i = GridView1.PageIndex <SPAN>Then<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>item.Selected = <SPAN>True<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>End</SPAN> <SPAN>If<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Next</SPAN> i<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Dim</SPAN> currentPage <SPAN>As</SPAN> <SPAN>Integer</SPAN> = GridView1.PageIndex + 1<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Me</SPAN>.Label5.Text = <SPAN>"Page "</SPAN> &amp; currentPage.ToString &amp; <SPAN>" of "</SPAN> &amp; GridView1.PageCount.ToString<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>End</SPAN> <SPAN>If<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN><SPAN>End</SPAN> <SPAN>Sub<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Yang replied on Wednesday, April 18, 2007</h2><P>What version of Oracle are you using? I believe that if you use version 9 and up you can use ODP.NET (Oracle Data Provider for .NET). This is provided by&nbsp;Oracle&nbsp;and is "supposed" to be&nbsp;better than the one provided by Microsoft.&nbsp;I use the Microsoft's Ent Lib Data Access Block where we have a custom Database Class to handle ODP.NET driver.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
