<html><header><title>FilteredBindingList : Multiple ApplyFilter() Is this an issue ?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>FilteredBindingList : Multiple ApplyFilter() Is this an issue ?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2262.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jabadoo posted on Friday, February 02, 2007</h2><P>I would expect the ApplyFilter() to&nbsp;act as an AND operator when doing it multiple times?</P>
<P>for example :</P>
<BLOCKQUOTE dir=ltr>
<P><FONT face=Garamond color=#006400>_filteredList.ApplyFilter("field1",value1);</FONT></P>
<P><FONT face=Garamond color=#006400>_filteredList.ApplyFilter('field2", value2);</FONT></P></BLOCKQUOTE>
<P>resulting in <FONT color=#006400>(field1=value1 AND field2=value2)</FONT></P>
<P>This works when the first ApplyFilter has results. </P>
<P>But, in my case, when the first ApplyFilter has zero results, the second one could have results.</P>
<P>I guess this is a bug in the FilteredBindingList ?</P>
<P>As a workaround, I need to count the previous results, and only do the second ApplyFilter when the first has zero results.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fsjohn replied on Friday, December 07, 2007</h2>same to me</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fsjohn replied on Friday, December 07, 2007</h2>same to me</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, December 07, 2007</h2><P>Offhand, I would say you are doing it wrong.</P>
<P>You should set up your filter once and then call it.</P>
<P>Something like this:</P><FONT color=#0000ff size=2>
<P>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetDataSource(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> key </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Long</FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> FilteredBindingList(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> SomeBO)<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> filteredList </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> FilteredBindingList(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> SomeBO)<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> filterValue </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object<BR>&nbsp; </FONT><FONT size=2>filteredList = </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> FilteredBindingList(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> SomeBO)(mSomeColl)</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp; If</FONT><FONT size=2> filteredList </FONT><FONT color=#0000ff size=2>IsNot</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Nothing</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>filteredList.FilterProvider = </FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> MyFilter<BR>&nbsp;&nbsp;&nbsp; filterValue = key<BR>&nbsp;&nbsp;&nbsp; filteredList.ApplyFilter(</FONT><FONT color=#ff00ff size=2>""</FONT><FONT size=2>, filterValue)<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If<BR><BR>&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> filteredList</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>'The primary requirement is that the method signature conform to the FilterProvider delegate. </FONT><FONT color=#008000 size=2>The method must 'return True for items that should be included in the filtered view, and False for those that should not.</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> MyFilter(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> item </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> filterValue </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean<BR></FONT><FONT color=#008000 size=2>'You need to implement code here to check the value of the item parameter based on your rules, <BR></FONT><FONT color=#008000 size=2>'along with any criteria provided through the filterValue parameter.<BR></FONT><FONT color=#008000 size=2>'Remember that the item parameter could be the value of a specific property, or it could be a reference to the actual business object. <BR></FONT><FONT color=#008000 size=2>'And keep in mind that the filterValue parameter is of type Object, and so it could be any value youâ€™d like, even a complex object.</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Dim</FONT><FONT size=2> result </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean</FONT><FONT size=2> = </FONT><FONT color=#0000ff size=2>False</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp; If</FONT><FONT size=2> item </FONT><FONT color=#0000ff size=2>IsNot</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Nothing</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>AndAlso</FONT><FONT size=2> filterValue </FONT><FONT color=#0000ff size=2>IsNot</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Nothing</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> obj </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> SomeBO = </FONT><FONT color=#0000ff size=2>DirectCast</FONT><FONT size=2>(item, SomeBO)<BR>&nbsp;&nbsp;&nbsp;<FONT color=#008000> ' Here is where you can compare multiple properties if you want:</FONT><BR>&nbsp;&nbsp;&nbsp; result = (obj.Key = </FONT><FONT color=#0000ff size=2>CLng</FONT><FONT size=2>(filterValue))<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Return</FONT><FONT size=2> result</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fsjohn replied on Monday, December 10, 2007</h2><font size="3">I solved filtering the previous filtered collection:<br><br></font><font color="#006400" face="Garamond">_filteredList.ApplyFilter("field1",value1);<br>_filteredList = New Csla.FilteredBindingList(Of yourBO)(_filteredList)<br></font><font color="#006400" face="Garamond">_filteredList.ApplyFilter('field2", value2);<br><br><br><br>fs<br></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, December 10, 2007</h2>The current behavior is by design. If you want to filter on multiple columns I recommend creating a custom filter provider.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>McManus replied on Monday, December 10, 2007</h2><P><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>RockfordLhotka:</strong></div><div>The current behavior is by design. If you want to filter on multiple columns I recommend creating a custom filter provider.</div></BLOCKQUOTE></P>
<P>Another option is to use the ObjectListView, which can be found in CSLAContrib</P>
<P>Cheers,<BR>Herman</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
