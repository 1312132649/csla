<html><header><title>Apply sort withing the BOL?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Apply sort withing the BOL?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3243.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ballistic posted on Saturday, July 21, 2007</h2><P>I have an XML&nbsp;db field which I use to store the name of a country.</P>
<P>&lt;countries&gt;<BR>&nbsp;&lt;country lang="en"&gt;United States&lt;/country&gt;<BR>&lt;country lang="es"&gt;Estados Unidos&lt;/country&gt;<BR>&lt;/countries&gt;<BR><BR>I then have a <FONT size=2>ReadOnlyListBase class (<FONT size=2>CountryInfoList</FONT>) which gets the field and based on the current language will get the correct value from the xml.<BR><BR>Since I cannot count on the DB to be able to order base on the selected language, I have to sort the list myself.<BR><BR>In the examples I've seen, the ordering is done in the GUI, however, I would like to hide that detail from the UI and just provide it an ordered list based on the selected language.<BR><BR><FONT color=#0000ff size=2><FONT color=#000000>So is there a way to sort on the BOL?<BR><BR>Thank you!<BR><BR>&nbsp;- Andy</FONT></P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Sunday, July 22, 2007</h2>Use the SortedBindingList or ObjectListView.&nbsp; Search the forums for examples of how to use them.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ballistic replied on Sunday, July 22, 2007</h2><P><FONT face=Verdana size=2>Thank you Brian, I ended up using the SortedBindingList to sort the list after I get it from the db:</FONT></P>
<P><FONT size=2><FONT face=Verdana><FONT color=#0000ff>Public</FONT> <FONT color=#0000ff>Shared</FONT> <FONT color=#0000ff>Function</FONT> GetCountryInfoList(<FONT color=#0000ff>ByVal</FONT> Language <FONT color=#0000ff>As</FONT> <FONT color=#0000ff>String</FONT>) <FONT color=#0000ff>As</FONT> SortedBindingList(<FONT color=#0000ff>Of</FONT></FONT><FONT face=Verdana> CountryInfo)</FONT></FONT></P>
<P><FONT face=Verdana><FONT size=2><FONT color=#0000ff>If</FONT> (_Countries.Item(Language) <FONT color=#0000ff>Is</FONT> <FONT color=#0000ff>Nothing</FONT>) <FONT color=#0000ff>Then<BR></FONT></FONT></FONT><FONT face=Verdana><FONT size=2><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp; Dim</FONT> unSorted <FONT color=#0000ff>As</FONT> CountryInfoList = DataPortal.Fetch(<FONT color=#0000ff>Of</FONT> CountryInfoList)(<FONT color=#0000ff>New</FONT> Language_Criteria(Language)) <FONT color=#008000>'Get Unsorted List<BR></FONT></FONT></FONT><FONT color=#0000ff><FONT face=Verdana><FONT size=2><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp; </FONT>Dim</FONT></FONT></FONT><FONT size=2><FONT face=Verdana> sorted <FONT color=#0000ff>As</FONT> SortedBindingList(<FONT color=#0000ff>Of</FONT> CountryInfo) = <FONT color=#0000ff>New</FONT> SortedBindingList(<FONT color=#0000ff>Of</FONT></FONT><FONT face=Verdana> CountryInfo)(unSorted)<BR></FONT></FONT><FONT size=2><FONT face=Verdana><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp; </FONT>sorted.ApplySort(</FONT><FONT face=Verdana color=#a31515>"Name"</FONT></FONT><FONT face=Verdana size=2>, ComponentModel.ListSortDirection.Ascending)<BR></FONT><FONT size=2><FONT face=Verdana><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp; </FONT>_Countries.Item(Language) = sorted</FONT><FONT color=#008000><FONT face=Verdana><BR></FONT></FONT></FONT><FONT face=Verdana><FONT size=2><FONT color=#0000ff>End</FONT> <FONT color=#0000ff>If<BR></FONT></FONT></FONT><FONT size=2><FONT face=Verdana><FONT color=#0000ff>Return</FONT> <FONT color=#0000ff>CType</FONT>(_Countries.Item(Language), SortedBindingList(<FONT color=#0000ff>Of</FONT></FONT><FONT face=Verdana> CountryInfo))<BR><BR></FONT></FONT><FONT face=Verdana><FONT size=2><FONT color=#0000ff>End</FONT> </FONT></FONT><FONT color=#0000ff><FONT face=Verdana><FONT size=2>Function<BR><BR><FONT color=#000000>The only part I'm not too fond of is that I have to return </FONT><FONT color=#000000>SortedBindingList(</FONT><FONT color=#0000ff>Of</FONT></FONT></FONT><FONT face=Verdana color=#000000 size=2> CountryInfo).&nbsp; Ideally I would be returning a sorted CountryInfoList, but I'm not able to convert one to the other.<BR><BR>Is this possible?<BR><BR>&nbsp;- Andy</FONT></P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Sunday, July 22, 2007</h2><P>Andy,</P>
<P>One idea would be to create a 2nd instance of CountryInfoList using New and then loop over the sorted collection and add each object to your New instance. </P>
<P>Seems like a lot of trouble compared to the 1.x way of directly sorting the collection. But Rocky had said that the original method caused all kinds of problems. </P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ballistic replied on Monday, July 23, 2007</h2><P><FONT face=Verdana size=2>Joe,<BR><BR>I tried your suggestion and it worked, but you are right, it is too much work :)<BR><BR>&nbsp;- Andy</FONT></P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
