<html><header><title>bug in SortedIndex (SortedBindingList)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>bug in SortedIndex (SortedBindingList)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8602.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dg78 posted on Wednesday, March 03, 2010</h2><p><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB">
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">Hi Rocky,</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">&nbsp;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">In SortedBindingList (in the last version 3.8.3), there is :</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">&nbsp;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>private int SortedIndex(int originalIndex)</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>{</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>int result = 0;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (_sorted)</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>for (int index = 0; index &lt; _sortIndex.Count; index++)</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (_sortIndex[index].BaseIndex == originalIndex)</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;</span>result = index;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>break;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (_sortOrder == ListSortDirection.Descending)</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>result = _sortIndex.Count - 1 - result;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>else</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>result = originalIndex;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-family:Times New Roman;"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:11pt;">return result;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;"><span style="font-family:Times New Roman;">&nbsp;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">Or in the VB version (it is the same but I prefer) :</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">&nbsp;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp; </span>Private Function SortedIndex(ByVal originalIndex As Integer) As Integer</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">&nbsp;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>Dim result As Integer</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>If _sorted Then</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>For index As Integer = 0 To _sortIndex.Count - 1</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If _sortIndex(index).BaseIndex = originalIndex Then</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>result = index</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Exit For</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>End If</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Next</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If _sortOrder = ListSortDirection.Descending Then</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>result = _sortIndex.Count - 1 - result</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>End If</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>Else</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>result = originalIndex</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>End If</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>Return result</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">&nbsp;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp; </span>End Function</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">&nbsp;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">Everything is good if<span style="mso-spacerun:yes;">&nbsp; </span>originalIndex<span style="mso-spacerun:yes;">&nbsp; </span>exist in _sortIndex.</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">But what happen if it is not the case : the function returns either 0 or _sortIndex.Count &ndash; 1.</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">&nbsp;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">It is not good so I add :</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">&nbsp;</span></span></p>
<h3 style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>Dim result As Integer = -1</span></h3>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>If _sorted Then</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>For index As Integer = 0 To _sortIndex.Count - 1</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If _sortIndex(index).BaseIndex = originalIndex Then</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>result = index</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Exit For</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>End If</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Next</span></span></p>
<h3 style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If result = -1 then Return result</span></h3>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>If _sortOrder = ListSortDirection.Descending Then</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&hellip;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">&nbsp;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">I use <span style="mso-spacerun:yes;">&nbsp;</span>-1 because you use -1 in :</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">&nbsp;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>public int Find(PropertyDescriptor property, object key)</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>{</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (_supportsBinding)</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return SortedIndex(_bindingList.Find(property, key));</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>else</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return -1;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">&nbsp;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">I think that it is a bug.</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="mso-spacerun:yes;"></span></span></span><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">&nbsp;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">Dominique</span></span></p>
<p class="MsoNormal">&nbsp;</p>
</span></p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">&nbsp;</p>
<p class="MsoNormal">&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, March 03, 2010</h2><p>Can that happen thought? Is there a scenario where the index of an item needs to be translated into the indexed position, and where the item is somehow in the list, but not in the sorted index?</p>
<p>If that can happen the bug isn&#39;t in the SortedIndex() method, it is in whatever code allowed an item to get into the list, and not into the sorted index.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dg78 replied on Wednesday, March 03, 2010</h2><p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">I came in this situation looking a key using&nbsp;:</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">&nbsp;</span></span></p>
<p style="background:#cedefd;margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-family:Times New Roman;"><span style="font-size:11pt;color:#333333;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>public int Find(PropertyDescriptor property, object key)</span><span style="color:#333333;mso-ansi-language:EN-GB;" lang="EN-GB"></span></span></p>
<p style="background:#cedefd;margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-family:Times New Roman;"><span style="font-size:11pt;color:#333333;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>{</span><span style="color:#333333;mso-ansi-language:EN-GB;" lang="EN-GB"></span></span></p>
<p style="background:#cedefd;margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-family:Times New Roman;"><span style="font-size:11pt;color:#333333;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (_supportsBinding)</span><span style="color:#333333;mso-ansi-language:EN-GB;" lang="EN-GB"></span></span></p>
<p style="background:#cedefd;margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-family:Times New Roman;"><span style="font-size:11pt;color:#333333;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return SortedIndex(_bindingList.Find(property, key));</span><span style="color:#333333;mso-ansi-language:EN-GB;" lang="EN-GB"></span></span></p>
<p style="background:#cedefd;margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-family:Times New Roman;"><span style="font-size:11pt;color:#333333;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>else</span><span style="color:#333333;mso-ansi-language:EN-GB;" lang="EN-GB"></span></span></p>
<p style="background:#cedefd;margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-family:Times New Roman;"><span style="font-size:11pt;color:#333333;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return -1;</span><span style="color:#333333;mso-ansi-language:EN-GB;" lang="EN-GB"></span></span></p>
<p style="background:#cedefd;margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-family:Times New Roman;"><span style="font-size:11pt;color:#333333;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>}</span><span style="color:#333333;mso-ansi-language:EN-GB;" lang="EN-GB"></span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">&nbsp;</span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;">The key doesn&#39;t exist then<span style="mso-spacerun:yes;">&nbsp;&nbsp; </span><span style="color:#333333;">_bindingList.Find(property, key) return -1<span style="mso-spacerun:yes;">&nbsp; </span>but<span style="mso-spacerun:yes;">&nbsp; </span><span style="mso-spacerun:yes;">&nbsp;</span>SortedIndex(_bindingList.Find(property, key)) return<span style="mso-spacerun:yes;">&nbsp; </span>0.</span></span></span></p>
<p style="margin:0cm 0cm 0pt;" class="MsoNormal"><span style="font-size:11pt;mso-ansi-language:EN-GB;" lang="EN-GB"><span style="font-family:Times New Roman;"><span style="color:#333333;">Then for my code, the key exist at index 0 and it is not true.</span></span></span></p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Wednesday, March 03, 2010</h2><p>OK, that makes sense. I&#39;ll add this to the bug list.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, March 04, 2010</h2><p>Hi, </p>
<p>I&#39;d rather change the code in Find to</p>
<p style="margin:0cm 0cm 0pt;background:#cedefd none repeat scroll 0% 0%;-moz-background-clip:border;-moz-background-origin:padding;-moz-background-inline-policy:continuous;" class="MsoNormal"><span style="font-family:Times New Roman;"><span style="font-size:11pt;color:#333333;" lang="EN-GB"><span>&nbsp;&nbsp;&nbsp; </span>public int Find(PropertyDescriptor property, object key)</span><span style="color:#333333;" lang="EN-GB"></span></span></p>
<p style="margin:0cm 0cm 0pt;background:#cedefd none repeat scroll 0% 0%;-moz-background-clip:border;-moz-background-origin:padding;-moz-background-inline-policy:continuous;" class="MsoNormal"><span style="font-family:Times New Roman;"><span style="font-size:11pt;color:#333333;" lang="EN-GB"><span>&nbsp;&nbsp;&nbsp; </span>{</span><span style="color:#333333;" lang="EN-GB"></span></span></p>
<p style="margin:0cm 0cm 0pt;background:#cedefd none repeat scroll 0% 0%;-moz-background-clip:border;-moz-background-origin:padding;-moz-background-inline-policy:continuous;" class="MsoNormal"><span style="font-family:Times New Roman;"><span style="font-size:11pt;color:#333333;" lang="EN-GB"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (_supportsBinding)</span></span></p>
<p style="margin:0cm 0cm 0pt;background:#cedefd none repeat scroll 0% 0%;-moz-background-clip:border;-moz-background-origin:padding;-moz-background-inline-policy:continuous;" class="MsoNormal"><span style="font-family:Times New Roman;"><span style="font-size:11pt;color:#333333;" lang="EN-GB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br /></span></span></p>
<p style="margin:0cm 0cm 0pt;background:#cedefd none repeat scroll 0% 0%;-moz-background-clip:border;-moz-background-origin:padding;-moz-background-inline-policy:continuous;" class="MsoNormal"><span style="font-family:Times New Roman;"><span style="font-size:11pt;color:#333333;" lang="EN-GB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int originalIndex = </span></span><span style="font-family:Times New Roman;"><span style="font-size:11pt;color:#333333;" lang="EN-GB">_bindingList.Find(property, key);</span></span></p>
<p style="margin:0cm 0cm 0pt;background:#cedefd none repeat scroll 0% 0%;-moz-background-clip:border;-moz-background-origin:padding;-moz-background-inline-policy:continuous;" class="MsoNormal"><span style="font-family:Times New Roman;"><span style="font-size:11pt;color:#333333;" lang="EN-GB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return (originalIndex &gt; -1) ? <span></span>SortedIndex(originalIndex) : -1;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>
<p style="margin:0cm 0cm 0pt;background:#cedefd none repeat scroll 0% 0%;-moz-background-clip:border;-moz-background-origin:padding;-moz-background-inline-policy:continuous;" class="MsoNormal"><span style="font-family:Times New Roman;"><span style="font-size:11pt;color:#333333;" lang="EN-GB">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /></span></span></p>
<p style="margin:0cm 0cm 0pt;background:#cedefd none repeat scroll 0% 0%;-moz-background-clip:border;-moz-background-origin:padding;-moz-background-inline-policy:continuous;" class="MsoNormal"><span style="font-family:Times New Roman;"><span style="font-size:11pt;color:#333333;" lang="EN-GB"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>else</span><span style="color:#333333;" lang="EN-GB"></span></span></p>
<p style="margin:0cm 0cm 0pt;background:#cedefd none repeat scroll 0% 0%;-moz-background-clip:border;-moz-background-origin:padding;-moz-background-inline-policy:continuous;" class="MsoNormal"><span style="font-family:Times New Roman;"><span style="font-size:11pt;color:#333333;" lang="EN-GB"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return -1;</span></span></p>
<p style="margin:0cm 0cm 0pt;background:#cedefd none repeat scroll 0% 0%;-moz-background-clip:border;-moz-background-origin:padding;-moz-background-inline-policy:continuous;" class="MsoNormal"><span style="font-family:Times New Roman;"><span style="font-size:11pt;color:#333333;" lang="EN-GB">&nbsp;&nbsp;&nbsp; }<br /></span></span></p>
<p>&nbsp; as OriginalIndex is also used for sending events to the UI that should never get -1 as index and may introduce new bugs. </p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Friday, March 05, 2010</h2><p>Hi Dominique, </p>
<p>I have updated the SortedBindingList in $/core/branches/V3-8-x (and 4.0) with changes to Find and better databinding behavior.</p>
<p>If you have time please download changes and verify that it solves your issues.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
