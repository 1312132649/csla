<html><header><title>Hierarchial GridEX and N-Level Undo</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Hierarchial GridEX and N-Level Undo</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1905.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jschwalm7 posted on Tuesday, December 05, 2006</h2><font size="2"><font face="Verdana">Hi Guys,<br><br>&nbsp;&nbsp;&nbsp; I'm using version 1.5 of the CLSA framework. I'm having problems with a root object that contains a collection of business objects where each contains two  child collections. I'm allowing users to edit all of this info in a hierachial GridEX object (Janus Systems). The problem is apparent after CancelEdit() is invoked the root object (the user cancels changes).&nbsp;&nbsp; In most cases, there exists 1 or more child or grandchild objects with EditLevel values &gt; 0 after undo when all objects initially began with an EditLevel of 0. The control is invoking IEditableObject.BeginEdit() WITHOUT a complementary call to </font></font><font size="2"><font face="Verdana">either IEditableObject.EndEdit() or </font></font><font size="2"><font face="Verdana">IEditableObject.CancelEdit().</font></font><font size="2"><font face="Verdana"> This is causing havoc in the object because some of the child objects are completely "undone" whereas others are only partially "undone". I'm curious if anyone else has experienced similar problems with 3rd party controls and how the problem was resolved. <br><br>Thanks<br>Josh<br></font></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, December 06, 2006</h2>I think that the Janis grid behaves badly with data binding.&nbsp; Search the forum, this has come up before IIRC.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jschwalm7 replied on Friday, December 08, 2006</h2><font size="1">&nbsp;&nbsp; <font size="2">I believe I've found a solution to this problem and willing to share if anyone is interested (when I have more time). The out of balance EditLevels stemmed from the fact Janus uses a CurrencyManager for each table in the hierarchy. So far, testing confirms that invoking CancelEdit or EndEdit on each CurrencyManager (obtained through the Form's BindingContext property) used by the GridEX instance coupled w/ a CancelEdit or ApplyEdit on the root object results in a balanced root object after the form exits. <br></font></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, December 08, 2006</h2>Please do, I'm sure others using the Janus grid have run across this as well.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
