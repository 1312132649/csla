<html><header><title>OT:  reliable archiving of messages</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>OT:  reliable archiving of messages</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8353.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Thursday, January 14, 2010</h2><P>Hi,</P>
<P>I have my main (Csla based) application, part of which is a CRM.&nbsp; One of the requirements is that emails received or sent to customers are logged with that customer.&nbsp; Currently I have an Outlook plugin which does just that, using some Csla business objects.</P>
<P>The problem is that if that underlying database changes, I need the users to install an update package which installs updated Csla based assemblies that work with the new schema.&nbsp; This has proven to be a pain to do, and I can't use ClickOnce to deploy the add-in because we're on outlook 2003.&nbsp; </P>
<P>Its also not reliable; if the network connection goes down between the buildings, emails can still be sent and received because each location has its own internet connection, but without the link between buildings, no way to contact the database server, so any emails exchanged don't get logged.</P>
<P>The proposed solution I've come up with is this:&nbsp; the Outlook add-in will continue to write out the .msg file, along with some metadata stored in Xml.&nbsp; Both these files will be placed in a known location.&nbsp; A service running on the client will watch this location, and simply move the sets of files to a known server location.</P>
<P>A service running on the server will process the files and import the .msg file into the application database.&nbsp; </P>
<P>In this way, if network connectivity between locations is lost, the files will simply stay on the client until restored.&nbsp; Also, if I change the database schema again, I'll only need to update the service running on the server.&nbsp; This will make deployments much easier.</P>
<P>I'm not sure I see any better way to proceed, so I thought I'd post here and see if anyone had a better idea.&nbsp; So, what else could I do that would 1) simplify deployment and 2) increase reliablity</P>
<P>Thanks!</P>
<P>Andy</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
