<html><header><title>OT:  Data Output </title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>OT:  Data Output </h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7546.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>whelzer posted on Tuesday, September 01, 2009</h2>We have the following issue. <br>Using VB 2008/Windows Forms/CSLA 3.6.2 (but 99% of our code was done under 3.0.4 - in fact we're still using the older templpates and have just started exploring the newer stuff).<br><br>I need to produce some "odd" files from DP_Insert &amp; _update<br><br>Assuming I had an object like this:<br><br>private _Id as integer<br>private _DOB as date<br>private _address as string<br>private _cusName as string<br><br>The resulting file&nbsp; from DP_update would be this:<br>&nbsp;&nbsp;&nbsp;<i> Header Stuff<br>&nbsp;&nbsp;&nbsp; 1<br>&nbsp;&nbsp;&nbsp; 2351 'the property_Id<br>&nbsp;&nbsp;&nbsp; 2<br>&nbsp;&nbsp;&nbsp; John Doe ' the property _cusName<br>&nbsp;&nbsp;&nbsp; 3<br>&nbsp;&nbsp;&nbsp; 125 My Street ' the propety _Address<br>&nbsp;&nbsp;&nbsp; 4<br>&nbsp;&nbsp;&nbsp;&nbsp; 01/01/1974 ' yes _dob</i><br><br>&nbsp;&nbsp;&nbsp; and so on<br><br>In DP_Insert the resulting file is similar but crucially different<br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; <i>Header Stuff<br>&nbsp;&nbsp;&nbsp; 2352<br>&nbsp;&nbsp;&nbsp; Jane Doe<br>&nbsp;&nbsp;&nbsp; 111 A Road<br>&nbsp;&nbsp;&nbsp; 02/02/1978<br></i>&nbsp;&nbsp;&nbsp;&nbsp; <br>Basically the order in the "insert file" must be conistent with the actual numbers on the "update" file.<br><br>Ideally I'd like to do something like the following:<br><br>1) Associate a number with each property"<br><br>2) Protected Overrides Sub DataPortal_Update()<br><br>&nbsp;&nbsp;&nbsp;&nbsp; output header stuff <br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp; loop through properties in Me order by associated number <br>&nbsp;&nbsp; &nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;  output property number<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  output property value<br>&nbsp;&nbsp;&nbsp;&nbsp; end loop<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&nbsp;  <br>&nbsp;&nbsp;&nbsp; output footer stuff <br>&nbsp;&nbsp;&nbsp; &nbsp; <br>End Sub<br><br>DP_Insert would be very similar.&nbsp; <br><br>Any ideas would be much appreciated.<br><br>FYI - the insert and update files are for feeding a 1970s DOS based Banking System!<br><br><br><br><br><br><br><br><br><br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
