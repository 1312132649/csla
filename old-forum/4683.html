<html><header><title>How to update a ROLB?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How to update a ROLB?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4683.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>selim51 posted on Sunday, April 13, 2008</h2><P>Hello All!</P>
<P>In my database i have a parent table and a child table. Child table has a mandatory foreign key to the parent table. That means a child can't live for its own, it has to be associated with a parent.</P>
<P>So my <FONT face="Courier New" size=2>Child</FONT> class has an <FONT face="Courier New" size=2>internal static&nbsp;NewChild()</FONT> factory method. Childs should only created by parents to allocate them to their parent in this way: <FONT face="Courier New" size=2>parent.Childs.NewChild()</FONT>. This method calls the <FONT face="Courier New" size=2>Child.NewChild()</FONT> factory method and adds the returned child object into the list.</P>
<P>I wanted to prevent the user to make mistakes like this one:</P>
<P><FONT face="Courier New" size=2>Child child = aParent.Childs.NewChild();<BR>// change some properties of child<BR>child.Name = "a child name";<BR>anotherParent.Childs.Add(child);<BR>aParent.Save();<BR>anotherParent.Save();</FONT></P>
<P>One can argue that last comes wins, but I don't like that. So I decided to make the Childs list a ROLB. This time I can control that the user can't do the mistake. Changing the parent of a child could be achieved in this way:</P>
<P><FONT face="Courier New" size=2>Child child = aParent.Childs.NewChild();<BR>aParent.Childs.ReallocateChild(child, anotherParent);</FONT></P>
<P>Reallocating a child means removing it from one list, adding it to the other list, and changing it's foreign key field.</P>
<P>Now this is where the problem starts. Assume that parent is self not dirty, but some of the childs in the read only list are. <FONT face="Courier New" size=2>parent.IsDirty</FONT> returns false, because ROLB does not implement <FONT face="Courier New" size=2>ITrackStatus</FONT> interface, so it is skiped looking wether its items are dirty or not.</P>
<P>Overwriting methods like add and remove and so on of BLB&nbsp;seems for me the wrong way. The only "right way" I see is that parent should have a private BLB which is kept synchronized with ROLB so that in the next save the childs could be saved, too.</P>
<P>Is that the right way? Has anybody another cleaner solution?</P>
<P>Yavuz</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, April 14, 2008</h2>If you can add and remove children, ROLB isn't the proper subclass to use.&nbsp; Use BLB.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>selim51 replied on Monday, April 14, 2008</h2><P>And then overwriting the add method throwing a NotImplementedException as you (I think you was) have suggested in a similar thread?</P>
<P>That's the way I wanted to try next.</P>
<P>Thank you.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
