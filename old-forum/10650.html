<html><header><title>Silverlight: ReadOnlyList Recommendation</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Silverlight: ReadOnlyList Recommendation</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10650.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>MadGerbil posted on Monday, August 29, 2011</h2><p>I&#39;ve read only list that is used as the datasource&nbsp;for a&nbsp;combobox that appears in a datagrid.</p>
<p>How would you recommend that I fill that read only list?</p>
<p>I could fill it and use it as a property off the BusinessListBase.&nbsp; I don&#39;t care for that a whole lot because it doesn&#39;t seem to belong there and I may need to use this list in other places.</p>
<p>I could fill it and stick it in the cache but I don&#39;t care for that because the list can change (it is configurable based on the contents of another list).</p>
<p>The most logical place seems to be as a property on the ViewModel because it would be easy to plug in on other ViewModels - which is really selling me on the MVVM pattern now that I think about it.</p>
<p>How does that sound?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MadGerbil replied on Monday, August 29, 2011</h2><p>I&#39;m a little worried about syncronization here.</p>
<p>What happens if the objects in the datagrid are retrieved and the datagrid populated before my combobox items are retrieved and populated?&nbsp; I&#39;d have two async operations running and there is no guarantee one will get done before the other.&nbsp;&nbsp; Is this an issue?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Monday, August 29, 2011</h2><p>Hi, </p>
<p>That is one of the resons why we often use the UnitOfWork (UOW) pattern. </p>
<p>The UOW would consist of a UOWRoot object that is responsible for retrieving</p>
<ul>
<li>all the lists for combobox&#39;es</li>
<li>the business object(s) </li>
</ul>
<p>This also simplifies setup of datasources as you do not have to worry about syncronization. </p>
<p>The UOW object will usually be a readonly root object and contain an EditableRoot or EditableRootList object to be saved later on. </p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MadGerbil replied on Wednesday, September 07, 2011</h2><p>Thank you for that response.</p>
<p>I&#39;ve managed to set my objects up that way and I&#39;ve part of it working but I&#39;ve run into what I hope is a minor roadblock.&nbsp;&nbsp; I&#39;m using a ReadOnlyBase object that has an EditableRootList and a ReadOnlyList.&nbsp;&nbsp; The EditableRootList is the ItemsSource for a SilverLight 4.0 DataGrid and it works very well.&nbsp; The part that hurts my head is that I&#39;m not sure how to set the combobox to the ReadOnlyList.</p>
<p>It isn&#39;t the combobox that is the problem - I understand how to use them and I&#39;ve them working successfully elsewhere in the project (static data sources).&nbsp; The problem is with Silverlight because the DataContext on the DataGrid is set to the EditableRootList and the combobox has no way to get back up the object graph to get to the ReadOnlyList.</p>
<p>So, the ReadOnlyRoot object is the DataContext for the UserControl and the EditbleRootList is the datacontext for the DataGrid.</p>
<p>How do I wire up the combobox (child of the datagrid) to the ReadOnlyBase.ReadOnlyList?</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>MadGerbil replied on Wednesday, September 07, 2011</h2><p>Got it working by using a collectionviewsource as a staticresource.</p>
<p>Thanks Again.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, September 07, 2011</h2><p>That&#39;s exactly what I do. Frequently I find that a CVS resource can index into properties of my &quot;root&quot; model object or viewmodel in ways that you can&#39;t do with a binding expression.</p>
<p>And I don&#39;t mind that, because the CVS adds sorting and that sort of thing, so it is generally a benefit.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MadGerbil replied on Wednesday, September 07, 2011</h2><p>Another problem: When I change the value of one combobox they change for the entire grid.</p>
<p>In my resource dictionary for the usercontrol I have this:</p>
<p><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">&lt;</span></span></span><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;">CollectionViewSource</span></span></span><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"> x</span></span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">:</span></span></span><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;">Key</span></span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">=&quot;Users&quot;</span></span></span><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"> Source</span></span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">=&quot;{</span></span></span><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;">Binding</span></span></span><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"> Path</span></span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">=UserDisplays}&quot;/&gt;</span></span></span></p>
<p><span style="font-size:x-small;">In my datagrid I&#39;ve got this code:</span></p>
<p><span style="font-family:Consolas;font-size:x-small;">&lt;sdk:DataGridTemplateColumn Width=&quot;120&quot; Header=&quot;Assigned&quot;&gt;<br />&lt;sdk:DataGridTemplateColumn.CellTemplate&gt;<br />&lt;DataTemplate&gt;<br />&lt;ComboBox <br />SelectedValue=&quot;{Binding Path=ContactUserId, Mode=TwoWay}&quot;<br />ItemsSource=&quot;{Binding Source={StaticResource Users}}&quot; <br />DisplayMemberPath=&quot;Name&quot; <br />SelectedValuePath=&quot;Id&quot;&gt;<br />&lt;/ComboBox&gt;<br />&lt;/DataTemplate&gt;<br />&lt;/sdk:DataGridTemplateColumn.CellTemplate&gt;<br />&lt;/sdk:DataGridTemplateColumn&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>
<p><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="color:#000000;"></span></span></span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, September 07, 2011</h2><p>Just like in Windows Forms, XAML has this concept of currency when it comes to any list. Something manages currency (which item is current), and that&#39;s the CVS.</p>
<p>So if you need multiple concepts of currency, you need multiple currency managers.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MadGerbil replied on Thursday, September 08, 2011</h2><p>I&#39;ll be honest.</p>
<p>I&#39;m shocked at how difficult it is to get a freakin&#39; combobox to work in a datagrid.&nbsp;&nbsp; I&#39;ve done windows forms development, asp development and so forth for the past 10 years and I cannot believe the hacks one has to go through to get such a simple control to work in Silverlight 4.&nbsp;&nbsp; The team has really, really failed on that point - it&#39;s really that bad.&nbsp;&nbsp; I&#39;ve got a regular observable collection working on a datagrid as the itemssource for a combobox but I&#39;m having real issues with getting a list gathered from the database to work.</p>
<p>There is so much I love about Silverlight but after making so much progress on the learning curve only to be stymied by a combobox for 3 days - it&#39;s incredibly frustrating.&nbsp;&nbsp; Every single hack/workaround I&#39;ve tried has been a failure - it&#39;s like the tech blocks anything/everything.&nbsp;&nbsp; Some of the hacks I&#39;ve found on the web I just don&#39;t want to use because I shouldn&#39;t have to write a 200 line derived class to repair what should be a very basic, easy to use control.</p>
<p>Sorry about the rant but it&#39;s enough to make me can the entire project and just use different technology.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MadGerbil replied on Thursday, September 08, 2011</h2><p>1: You should be able to bind a combobox in a datagrid to an ancestor of the datagrid but this cannot be done in Silverlight.&nbsp;&nbsp; It&#39;s my understanding that ElementID works in WPF but not Silverlight.</p>
<p>2: You should be able to create a static resource from the datacontext of the host usercontrol and then use that static resourceto act as the ItemSource of the combobox contained within the datagrid but I&#39;ve not been able to discover a way to make that happen.</p>
<p>3: As a workaround I created a class with a static property on a do-nothing class that holds my list.&nbsp; The list is populated when the ViewModel is created and I create a staticresource from that static property (I know &#39;static&#39; in those two instances doens&#39;t mean the same thing) and use that staticresource as the ItemsSource for my combobox.&nbsp; It works fine.</p>
<p>Sometimes I hate my job.</p>
<p>I&#39;d quit Silverlight but it looks so wonderful and it&#39;s still better than the hell that is HTML.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
