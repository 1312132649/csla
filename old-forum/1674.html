<html><header><title>OT:  Can't see business assembly in Add New Data Source wizard</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>OT:  Can't see business assembly in Add New Data Source wizard</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1674.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Friday, November 03, 2006</h2>Hi,<br><br>Made some changes to my business assembly.&nbsp; Now in the UI layer I'm trying to update some forms, but I can no longer see the assembly in the Add New Data Source Wizard.<br><br>Anyone know what causes this?&nbsp; I can see the other business assembly (I have two).<br><br>Thanks<br>andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Saturday, November 04, 2006</h2><P>I'm guessing by "made some changes" that you added some new classes.</P>
<P>Sometimes the compiled DLLs in other projects in the solution don't get updated as they should by Visual Studio.&nbsp; I've found that if I delete the DLLs and rebuild the solution the problem usually clears right up.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, November 06, 2006</h2>I renamed a couple of classes, then created a new class which was the name of one of the classes before it was renamed.<br><br>I tried cleaning the solution a few time, with no luck.&nbsp; I even tried creating a blank project, adding a reference, then running the wizard.. same thing.<br><br>So the wizard doesn't seem to like something in my assembly... but I don't know what.&nbsp; It works fine via the testing dll... no unusual warnings.<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, November 06, 2006</h2>No one has run into this except me?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jlazanowski replied on Monday, November 06, 2006</h2><P>I've run into this before but for the life of me I can't remember what it was I did to fix the problem.</P>
<P>The only thing that I can recall was that at one point I created some folders, moved some of my classes into them and updated the name spaces. Visual studio then took it upon itself to remove the public attribute from the beginning of my classes. However you said that you're unit tests are running so I doubt that's your issue.</P>
<P>Can you reference them in UI code without the data source wizard?</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, November 07, 2006</h2>Yes, I can reference them in code fine.&nbsp; <br><br>I did get it to see the assembly again, although it seems spotty.<br><br>I'm not sure exactly what I did... as I tried a few things.<br><br>I ran FxCop, and oneof my property setters was setting the property value instead of the field.&nbsp; I fixed that, and cleaned up some other stuff.<br><br>I added references to some assemblys that the business assembly depends on (previously I just set Reference paths in the project properties, and that had worked fine).<br><br>I fiddled with the copy local setting on the reference... setting it to true seems to have caused it to show up.. <br><br>I'm not sure what did it, and I tried narrowing it down only to have it disappear again.. its there now... now I just want to know how to keep it there.<br><br>The other business assembly my UI uses is there constantly; I don't reference its dependancies directly, nor is the Copy local set to true.. its wierd.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, November 07, 2006</h2>So it seems that I need to directly reference a couple of assemblies, which my business assembly uses, for the Add New Data Source wizard to see my business assembly.<br><br>I think I may have inavertantly exposed a DAL object in my changes.. I'm going to look at that and report back.<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, November 07, 2006</h2>Ok, so it was something stupid.<br><br>I had exposed some of my DAL layer though the business layer.&nbsp; Obviously then those classes can't be examined unless you have references to the DAL assemblies.<br><br>Once I fixed that little problem, I can now see my business assembly with no problem.<br><br>Thanks to those that were posting, it really helped me work though the problem.&nbsp; Chalk one up for non-thinking on my part..<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, November 07, 2006</h2>You mean nothingin the root of the solution which you are running the wizard in, or in the business assembly project?<br><br>I ran into something similar as well, but I think I was getting a Null reference exception trying to run the wizard.&nbsp; Having an object in the projects root fixed that issue.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Monday, November 06, 2006</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>david.wendelken:</strong></div><div>
<P>I'm guessing by "made some changes" that you added some new classes.</P>
<P>Sometimes the compiled DLLs in other projects in the solution don't get updated as they should by Visual Studio.&nbsp; I've found that if I delete the DLLs and rebuild the solution the problem usually clears right up.</P>
<P></div></BLOCKQUOTE></P>
<P>Not clear from your posts whether you tried the above suggestion...</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, November 07, 2006</h2><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>david.wendelken:</strong></div><div>Not clear from your posts whether you tried the above suggestion...</div></BLOCKQUOTE><br><br>From my initial reply to your post:<br><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>I tried cleaning the solution a few time, with no luck.&nbsp; I even tried
creating a blank project, adding a reference, then running the wizard..
same thing.</div></BLOCKQUOTE><br><br>By cleaning I meant both using the Clean build option and also closing VS2005 and manually deleting the obj and bin folders for all projects under the solution.&nbsp;&nbsp; I should have been more clear by my definition of cleaning. <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai replied on Tuesday, November 07, 2006</h2>This may not be the case for you but I just had a problem where I couldn't get the Data Sources window to work with my assembly either.&nbsp; The reason was that I had moved all my classes inside folders within Visual Studio and had nothing at the root level of the project.&nbsp; As soon as I added an empty class at the project root level the Data Sources window worked again.&nbsp; Some sort of VS bug I guess.&nbsp; HTH.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
