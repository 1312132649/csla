<html><header><title>Ignore the result of the Async call</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Ignore the result of the Async call</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10562.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Lazaro posted on Tuesday, July 26, 2011</h2><p style="margin:0in 0in 0pt;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;">Hello all,</span></span></p>
<p style="margin:0in 0in 0pt;" class="MsoNormal"><span style="font-size:small;font-family:Calibri;"></span></p>
<p style="margin:0in 0in 0pt;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;">I know we cannot cancel an asynchronous call to the DataPortal, but we need the ability to at a minimum ignore it. We are in the process of converting to CSLA 4 and we used to have this ability in our asynchronous logic and we need it still (otherwise we will have to change a lot of our UI code).</span></span></p>
<p style="margin:0in 0in 0pt;" class="MsoNormal"><span style="font-size:small;font-family:Calibri;">&nbsp;</span></p>
<p style="margin:0in 0in 0pt;" class="MsoNormal"><span style="text-decoration:underline;"><span style="font-size:small;"><span style="font-family:Calibri;">Here is our scenario:</span></span></span></p>
<p style="margin:0in 0in 0pt;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;">We have forms and controls (search forms, loaded on demand controls, etc.) that get loaded asynchronously. While they are being loaded the User may close the forms/controls and since we cannot tell the asynchronous call logic to ignore the results, we get exceptions that objects are null. Furthermore, when it comes to searches, the user have the ability to stop the call (ignore results if the asynchronous call already started) and search again with different criteria. This means that they could have canceled 3 calls and be waiting for the 4th to come back. I&rsquo;m mentioning this to show that just putting code in the callback/event to ignore without know which call is being returned would not help.</span></span></p>
<p style="margin:0in 0in 0pt;" class="MsoNormal"><span style="font-size:small;font-family:Calibri;">&nbsp;</span></p>
<p style="margin:0in 0in 0pt;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;">I could probably come up with a solution, but I do not want to reinvent the wheel if someone has already done something to make this feasible, since I would think it is not that uncommon for user to want to cancel asynchronous calls (or have the appearance of canceling-ignoring) without having to kill the entire application.&nbsp;&nbsp;</span></span></p>
<p style="margin:0in 0in 0pt;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;"></span></span></p>
<p style="margin:0in 0in 0pt;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;">The answer to the last question in this post (<a href="http://forums.lhotka.net/forums/t/3570.aspx">http://forums.lhotka.net/forums/t/3570.aspx</a>) may be what we are looking for.&nbsp;</span></span></p>
<p style="margin:0in 0in 0pt;" class="MsoNormal"><span style="font-size:small;font-family:Calibri;">&nbsp;</span></p>
<p style="margin:0in 0in 0pt;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;">Thank you</span></span></p>
<p style="margin:0in 0in 0pt;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;">Lazaro</span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, July 26, 2011</h2><p>The async dataportal calls uses a BackgroundWorker but the internal BackgroundWorker is not exposed to you.</p>
<p>I would suggest that you use the <b>Csla.Threading.BackgroundWorker</b> to do the async call.</p>
<p>Create new instance of Backgroundworker for each async call and keep the latest in a variable (CurrentBW).<br />Set CurrentBW.WorkerSupportsCancellation to true and a <b>syncronous </b>DataPortal call in the DoWork method (already on a background thread). <br />When user wants to cancel the running request your code should call the CanceAsync() method on the BackgroundWorker. </p>
<p>In the RunWorkerCompleted (when async call returns to the UI thread) you should test for e.Cancelled before updating the UI.</p>
<p>Your DoWork and RunWorkerCompleted methods would be defined in your form and can be reused. </p>
<p>Please be aware that</p>
<ul>
<li>call CurrentBW.DunWorkerAsync(criteria) with a single criteria object)</li>
<li>DoWork should NOT read/write any member variables. </li>
<li>DoWork sdould only set the e.Result to the fetched object. </li>
<li>RunWorkerCompleted must test for Cancelled and Error before trying to get the e.Result.</li>
</ul>
<p>BackgroundWorker will throw an Exception if you try to read e.Result when e.Error is NOT NULL. </p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
