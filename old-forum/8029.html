<html><header><title>the new MERGE statement in SQL Server 2008</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>the new MERGE statement in SQL Server 2008</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8029.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dg78 posted on Monday, November 23, 2009</h2><P class=MsoNormal><SPAN>Hi,<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Now, with SQL Server 2008, it is possible de pass easily a table to a store procedure and then, with the new MERGE statement, it is possible to insert, update and delete rows in the table in the database with a few code.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Is anybody use it with CSLA ?<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>I think that it could be useful for small BLB.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>And you, what are your thoughts about that ?<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Rocky, do you plan to use it in the future ? <SPAN>&nbsp;</SPAN>is it useful ?<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Dominique</SPAN><SPAN><o:p></o:p></SPAN></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dlambert replied on Monday, November 23, 2009</h2>I think this would be a lot more appropriate for apps that use DataSets to carry state.  In CSLA, chances are your're going to have business objects that are managing the state and data access for each of those rows individually, right?<br /><br />You'd almost have to build an extra layer (adding on or modifying the DataPortal) to intercept a bunch of updates and aggregate them into a table which would then be sent to a stored proc to be merged, wouldn't you?<br /><br />If you've got an object that's already managing tabular data directly, though, I don't see that there's anything that would stop you from doing this.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, November 23, 2009</h2><P>I don't see what CSLA would do to help this. You can already do this by overriding DataPortal_Update() in your BLB, or by using an object factory.</P>
<P>As always, the hard part is reconciling the results you get back from SQL Server - all the new primary keys, timestamps, etc - these must be merged back into your object graph after a successful SQL Server call.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
