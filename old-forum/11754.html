<html><header><title>Customer driven business rules - &quot;additionally required fields&quot;.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Customer driven business rules - &quot;additionally required fields&quot;.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11754.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 posted on Monday, December 17, 2012</h2><p>I think I know the answer to my question on how this will need to work but am wondering if anyone else has solved this in a different manner.</p>
<p>We use CSLA 4.x in production and CSLA 4.5 in development presently.&nbsp; </p>
<p>We are growing the ability for clients to be able to indicate: &quot;we want these additional fields (propertyinfos) to be required&quot;.&nbsp; Obviously, each client will have a different configuration of what those fields are.</p>
<p>On the client side, overriding AddBusinessRules would probably work; but on the server side, this cannot work - there is only one &quot;static&quot; Organization class for all clients to be using.&nbsp; </p>
<p>I&#39;m contemplating adding a business rule for every property info (dynamically)&nbsp;that may or may not end up enforcing &quot;requiredness&quot;.&nbsp; It would look at the current client&#39;s definition on whether it should be required and then treat it as such.&nbsp; If it&#39;s not required, the rule just passes.</p>
<p>I don&#39;t necessarily see this as a problem performance wise - I can&#39;t see it being a burden to check - for example - 40 business rules of this fashion even if CheckRules() for all properties is called.</p>
<p>I also don&#39;t really see an alternative approach if I want the propertyinfos to &quot;just work&quot;.</p>
<p>Any input appreciated - thanks!</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Monday, December 17, 2012</h2><p>A collegue of mine mentioned RuleSets and it looks like those are static once established... we will be providing an interface to change which fields are required within the application so that wouldn&#39;t quite work.&nbsp; (It doesn&#39;t look like you can &quot;re-initialize&quot; an object&#39;s business rules by wiping them out and re-initializing them once the object has called AddBusinessRules once)</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Monday, December 17, 2012</h2><p>Two additional option:</p>
<p>1. Use RuleSets - IE: Create a ruleset for each &quot;client&quot; and load all rules on the server for all clients. In DataPortal_Create/DataPortal_Fetch set the RuleSet name to the client id. However. this will not provide a dynamic behavior.</p>
<p>2. Hook into the PropertyHasChanged event and run an ObjectLevel rule that checks ALL the custom required field. Less obtrusive (just add one rule and override PropertyHasChanged and then check all the possible additional properties). This is similar to using a 3rd party rule engine and check rules in an external engine. </p>
<p>Your suggested solution will also work fine and will provide a dynamic behavior - per property.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Monday, December 17, 2012</h2><p>Thanks for your response, Johnny.&nbsp; Will the object level rule provide any way to mark properties as having broken rules?&nbsp; Right now we have our nice little propertystatus controls next to each entry field and the expected behavior will be for me to have those lit up showing where information is required and hasn&#39;t been supplied.</p>
<p>My guess is that the object level rule won&#39;t provide for this, right?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Monday, December 17, 2012</h2><p>Both ObjectRules and PropertyRules can add broken rules to other properties. </p>
<p>Just be aware that any existing broken rules from this rule is removed before the rule is rerun again - so you need to provide a complete set of BroenRules for each run - no difference here between ObjectRules or PropertyRules.</p>
<p>This is supported from CSLA 4.3 (IIRC). </p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Monday, December 17, 2012</h2><p>I think I follow - sounds like I&#39;d have to iterate across all 40-50 property values&nbsp;whenever the rule is run if I had 40-50 property infos, and then add broken rules for any invalid ones each time.&nbsp; So each property change could be a little heavier weight.</p>
<p>I ended up adding a boolean to my BusinessBase for &quot;ApplyConditionallyRequiredRules&quot; - which, when true for a business object, will add a conditionally required rule for each nullable typed propertyinfo (including string).&nbsp; This rule basically looks into a managed set of information by client about what properties are required by what clients and examine its value *if required* to determine its validity.</p>
<p>Seems to work just fine.&nbsp; Thanks again for your input.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
