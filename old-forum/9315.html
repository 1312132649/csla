<html><header><title>Lost with BusinessListBase addnig New item to collection</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Lost with BusinessListBase addnig New item to collection</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9315.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>vbbeta posted on Monday, August 02, 2010</h2><p>Hi to anyone who read this Post..........Im really lost !!!!!!!</p>
<p>fo rthe past week im trying to bind a chilLidtBase to one of its parents or it should be EditableRootList, but when ever im binding the dataGridSource to the DataItem of my parent Class and the dataSource AddNew is turned on (True) at runtime im getting this exception i have searched for it but nothing refrences the Csla Framework does anyone know how to over come this problem</p>
<p>&nbsp;&quot;Exception&quot;</p>
<p>&nbsp;AddNew cannot be called on the &#39;SSS.Library.Child&#39; type. This type does not have a public default constructor. You can call AddNew on the &#39;SSS.Library.Child&#39; type if you handle the AddingNew event and create the appropriate object.</p>
<p>&nbsp;PLEASE SOMEONE HELP ME </p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, August 03, 2010</h2><p>Hi, </p>
<p>Which version of CSLA do you use?</p>
<p>Add the following code to your child list class to create a new object using static factory method (orDataPortal) and add the new object to your list. :</p>
<pre id="code-result" class="brush:vbnet">Protected Overrides Function AddNewCore() As Object<br />        &#39;  create an new instance of your Child <br />        &#39; or call DataPortal.CreateChild for create <br />	&#39;  Dim item = DataPortal.CreateChild(Of SSS.Library.ChildType)()<br />        Dim item = SSS.Libray.ChildType.NewChildType()<br />        &#39; add to list <br />	Me.Add(item)<br />        &#39; return the item<br />	Return item<br />End Function<br /></pre></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>vbbeta replied on Tuesday, August 03, 2010</h2><p>Hi Jonny thanks for your answere</p>
<p>&nbsp;</p>
<p>im using CSLA 4 i have tried yur solution but i dont know why this is not working his function is not getting Triggered at all i placed a brekpoint ant this is not being called by the UI the eception is still the same i dont know what to do</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Biceman replied on Friday, August 13, 2010</h2><p>Vbbeta, how were you able to override AddNewCore as <b>OBJECT</b>?&nbsp; I&#39;m using v4 (with VB) and the only AddNewCore available to be overridden for a BLB is explicitly typed as the items in my list.</p>
<p>I overroad AddNewCore and when I invoke MyList.AddNew from my code, it calls AddNewCore and everything works fine.&nbsp; However, when I bind my list to a DataGridView and click in any cell of the &quot;New Row&quot;, the exception you described occurs.&nbsp; The stack trace shows the BindingSource.AddNew reporting the exception.</p>
<p>Am I missing something?</p>
<p><strong><br /></strong></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, August 13, 2010</h2><p>CSLA 4 is different from previous versions, in that AddNewCore is now strongly typed. That&#39;s a good thing, or should be, because the list is strongly typed anyway, and this change means the compiler will help you avoid what would have been a runtime exception.</p>
<p>CSLA 4 is also different in that it provides a default implementation of AddNewCore that invokes DataPortal.CreateChild to create a new child object. In other words, it works by default, though you can always override AddNewCore if you need a different implementation.</p>
<p>In earlier versions of CSLA you needed to override AddNewCore if you wanted it to work - otherwise the .NET behavior is to just do &quot;new x()&quot; - which of course fails because typical CSLA objects have a non-public default constructor - specifically so you know you should have called DataPortal.CreateChild instead.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Biceman replied on Friday, August 13, 2010</h2><p>I commented out the AddNewCore override in the BLB but I get the same error.&nbsp; The List.AddNew still works when called from code and as you mentioned Rocky it calls the CreateChild&nbsp; automatically.&nbsp;</p>
<p>Regarding overriding the AddNewCore function, I was mimicking the Role/Roles classes in the ProjectTracker example.</p>
<p>Has anyone else seen this behavior with a DataGridView and CSLA4?</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, August 13, 2010</h2><p>Oh wait - datagridview - so web forms?</p>
<p>Yeah, web forms is a different thing from everything else. I don&#39;t think that the datagridview does the add operation the same way - it doesn&#39;t use IBindingList, and therefore doesn&#39;t use AddNew...</p>
<p>It has been too long, and I don&#39;t remember how to do an add in that control...</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>Biceman replied on Saturday, August 14, 2010</h2><p>In my case the DataGridView is on a <i><b>Win </b></i>form.&nbsp; It is the BindingSource that throws the error when it tries to execute &quot;AddNew&quot; (at the request of the DataGridView).&nbsp; If I try and execute BindingSource.AddNew via code I get the same error:</p>
<p style="padding-left:30px;">{&quot;AddNew cannot be called on the &#39;Test.Customer&#39; type. This type does not have a public default constructor. You can call AddNew on the &#39;Test.Customer&#39; type if you handle the AddingNew event and create the appropriate object.&quot;}</p>
<p>Based on the error message I researched the AddingNew event of the BindingSource.&nbsp; This event fires after AddNew is called and allows you to control the creation of a new instance of your business object as such:</p>
<p style="padding-left:30px;">&nbsp;&nbsp;&nbsp; Private Sub CustomerListBindingSource_AddingNew(ByVal sender As Object, ByVal e As AddingNewEventArgs) Handles CustomerListBindingSource.AddingNew<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.NewObject = Customer.NewCustomer<br />&nbsp;&nbsp;&nbsp; End Sub</p>
<p>Of course having to handle the AddingNew event for all my Binding Sources isn&#39;t ideal.&nbsp; </p>
<p>I did try one other thing.&nbsp; I changed my list to be based on Business<b>Binding</b>ListBase.&nbsp; The AddNewCore for this list returns a type of Object.&nbsp; Now when I execute the BindingSource.AddNew no error.</p>
<p>After discovering this I searched the forum and found a discussion on <a title="BusinessListBase vs. BusinessBindingListBase" href="http://forums.lhotka.net/forums/p/9008/42849.aspx#42849">BusinessListBase vs. BusinessBindingListBase</a> .&nbsp; This article suggests that Winforms require the use of BusinessBindingListBase.&nbsp; I was modeling my code on what I saw in the ProjectTracker example which used BLB.&nbsp; </p>
<p>Another lesson learned the hard way! <img src="http://forums.lhotka.net/emoticons/emotion-5.gif" alt="Wink" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>vbbeta replied on Sunday, August 15, 2010</h2><p>Sorry for not responding i wanted to answer you Friday rite when you asked me the question but or some reason i wasn&#39;t able to login to the csla Forums But here i am the thing what you figured out your self this is exactly what i was facing and figured that out my self as well and i wanted to answer you this</p>
<p>&nbsp;</p>
<p>when you have a BLB the addNewCore cannot be as object it have to be from the class type Vs BBLB (or in csla 4 we now have DynamicListBase we could get the same work done) there you have addNewCore as object property &nbsp; </p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Chit Swe replied on Monday, December 29, 2014</h2><p>I am facing the same problem too with csla.net 4. I am trying to implement business list base type and want to bind to grid to support inline editing. But it fail to add new row in databound grid with the following Exception.</p>
<p>AddNew cannot be called on the &#39;Business.Base.ProductBrand&#39; type. This type does not have a public default constructor. You can call AddNew on the &#39;Business.Base.ProductBrand&#39; type if you handle the AddingNew event and create the appropriate object.</p>
<p>I also tried Roles class in ProjectTracker (csla.net 4 ) sample project. Its default implementation is to edit existing Role but not to create new Role. But if I set&nbsp;rolesBindingSource.AllowNew=True and try to add new role from user interface it throw the same Exception as the following.&nbsp;</p>
<p>AddNew cannot be called on the &#39;ProjectTracker.Library.Admin.Role&#39; type. This type does not have a public default constructor. You can call AddNew on the &#39;ProjectTracker.Library.Admin.Role&#39; type if you handle the AddingNew event and create the appropriate object.</p>
<p>In this case, AddNewCore is also override in Roles class.</p>
<p>Do I left something to do to allow add new row in complex databinding with Editable Root Collection stereotype?</p>
<p>Thanks</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Monday, December 29, 2014</h2><p>Hi,</p>
<p>Which base class does your list inherit from? </p>
<p>If WinForms UI then your lists should derive from the XYZBindingListBase classes. Ie: use the BusinessBindingListBase, not the BusinessListBase class.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
