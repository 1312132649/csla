<html><header><title>Parent/child help needed</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Parent/child help needed</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7712.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Vlam100 posted on Thursday, October 01, 2009</h2>Iâ€™ve got a problem where I cannot access the methods and properties  of my parent from one of my child objects. I am new to the framework and was wondering if anybody can help me with this. Thanks<br /><br />My design is as follows<br /><br />ParticipantImport (editable Root)<br />	ParticipantImportItem(editable child)<br />	ParticipantImportItems(editable child collection of participantImportItem)<br />	GlobalDataItem(editable Child)<br />	GlobalDataItems(editable child collection of ParticipantImportItem)<br /><br />In my parent Object I have 2  business Methods  the first one is Items which is of type of the collection<br /><br />Items (of participantImportItems)<br /><br />The other one is ItemsGlobalData of the globaldataItems Collection<br /><br />ItemsGlobalData (of globaldataItems)<br /><br />From my UI I will invoke the participantImport.Items.assign (parameters)  method which will add the data from the UI  to the BO,  where participantImportItem will represent one record of the collection in this object.<br /><br /> I also check my validation Rules within participantImportItme and one of them is to check if a specific department exists in the department table. If it does not exist I want to add the name of department to the GlobaldataItems object. So that I can report it back to the user but.<br /><br />From within my validation rule in participantImportItem  I call<br /><br />CType(target.Parent, ParticipantImport).ItemsGlobalData.Assign(CompanyId, DivisionName, "Division")<br /><br />The moment it executes this line it gets a null reference exception error and I have also noticed that target.parent is empty, is there another way as to how I should add it to the list or is the parent not available from within this child object ?<br /><br />Both my child objects ( the collections)  are instantiated in the create method of the parent<br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>msk replied on Monday, October 05, 2009</h2>One way to tackle this may be to have your editable root object handle events raised when the child collections are edited.  It could then be responsible for checking for the existence of the ParticipantImportItem in the GlobalDataItems collections and adding it if necessary.  <br /><br />I would only have a rule if I were notifying the user and expecting them to add the GlobablDataItem to fix the problem.  </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Monday, October 05, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>Vlam100:</strong></div><div>...<br /><br />My design is as follows<br /><br />ParticipantImport (editable Root)<br />	ParticipantImportItem(editable child)<br />	ParticipantImportItems(editable child collection of participantImportItem)<br />...<br /></div></BLOCKQUOTE><br /><br />I'm a little confused by this, as it seems like ParticipantImportItem contains a list of itself, unless you meant this:<br /><br />ParticipantImport (editable Root)<br />	ParticipantImportItems(editable child collection of participantImportItem)<br />	ParticipantImportItem(editable child)<br /><br />A quirk of CSLA is that the "interesting" ancestor object of a child in a collection isn't usually the collection, which is the direct parent, but instead is the grandparent, which is parent of the collection. <br /><br />If you are using managed properties, CSLA will assign the parent at the time the object is added to the collection, or, in the case of a direct relationship between a parent and child BO as indicated in your original hierarchy, at the time the child property is set to a child BO. <br /><br />When working with child in a collection, a way to get a child that already has the parent attached is to call AddNew on the collection, which will return the partially populated child. <br /><br /></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
