<html><header><title>CSLA And User Sessions</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA And User Sessions</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/12768.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>donniefitz2 posted on Tuesday, October 07, 2014</h2><p>I am planning to use CSLA as the BL for a web API (similar to ASP.Net MVC). All of the requests to the API must be authenticated and I&#39;m having trouble understanding how CSLA works in this scenario. My web API layer can manage to keep a session in process to identify incoming requests using a token in the HTTP header, so I can know who my users are once they have logged in.&nbsp;</p>
<p>Once a request is made to my API I can pass the credentials to CSLA to authenticate the user. But after the user is authenticated, how do I maintain a session that CSLA is aware of so I don&#39;t have to authenticate the user on each request? Would I have to store and instance of the business layer in session state? Any help would be appreciated.&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, October 08, 2014</h2><p>In your global.asax you&#39;ll wire up an event for AuthenticationHandler, I think that&#39;s the event.&nbsp; You&#39;ll use your token and rebuild your Principal / Identity and set it via Csla.ApplicationContext.User property.&nbsp; </p>
<p>The most flexible way then is to think of the IPrincipal&#39;s IsInRole instead as being a HasPermission call; you then load up the roles of the principal with all the permissions the user has, and your list can then check that the user has the permission to do whatever action.&nbsp; </p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
