<html><header><title>Csla data consolidation advice</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Csla data consolidation advice</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/998.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>kids_pro posted on Wednesday, August 23, 2006</h2>Dear All,<br><br>I plan to migrate my vb6 app to .net using Csla + Sql Server 2000 (C#).<br>My application will be deploy in different region where each region <b>is not</b> connected (LAN/WAN) to the central server (Even if region can contact to the central server through dial-up connection but it to expensive to do data entry this way).&nbsp; <br><br>On monthly basis each region need to submit their update data to the central server for consolidate. I am not sure if anyone had the same experience?<br><br>This is what I want to implement:<br><br>1. I am going to do a <font color="#a52a2a"><b>serialization of EditableRootCollection (this will include in child/grand child)</b></font> and save it to a file(binary format and wrap it inside .zip to save space when send file through slow connection e-mail)<br><br>2. When the data received at the central server user will upload the file. I will do deserialization and verify if the data exist update otherwise insert. <br><br>Does this process make sense or someone has a better approach?<br><br>Thanks,<br>kids<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tiago replied on Thursday, August 24, 2006</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>kids_pro:</strong></div><div>2. When the data received at the central server user will upload the file. I will do deserialization and verify if the data exist update otherwise insert.</div></BLOCKQUOTE></P>
<P>How would the central server know if the data already exists?</P>
<P>Your BOs do have an ID. Correct?</P>
<P>That's what the central server will be using to check for existence. Correct?</P>
<P>In that case, I think you must generate the ID locally. Your problem is a replication problem (there must be a pattern for this but I don't know the name).</P>
<P>I know 2 techniques to solve the replication problem:</P>
<P>A) Use GUID instead of integer autoincrement. The drawback is that GUIDs are bigger than INTs. Your tables will be bigger and your application will be a bit slower.</P>
<P>B) Use manual incremented integers. Example for 9 sites plus central site (total 10)<BR>site 1 - starts with ID=1 and increments by 10 (1,11,21,31,...)<BR>site&nbsp;2 - starts with ID=2 and increments by 10 (2,12,22,32,...)<BR>...<BR>site&nbsp;9 - starts with ID=9 and increments by 10 (9,19,29,39,...)<BR>central server - starts with ID=10 and increments by 10 (10,20,30,40,...)</P>
<P>As you can see, ID will never overlap. Of course you should leave room for expansion so for 10 sites I would use at least 15 or 20 increments, even if my client tells me he's not planning to expand. Any way you could migrate to bigger increments later on. The problem would be to correct all foreign key IDs. But it's feasible.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kids_pro replied on Thursday, August 24, 2006</h2>Tiago,<br><br>I do not have any problem with ID &amp; existing check.<br>I would love to know the pattern that you mention.<br>Since I just take my step into serialize &amp; deserialize in cosolidation process (not yet implement but I think it would work in theory).<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, August 24, 2006</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>kids_pro:</strong></div><div><br><br>1. I am going to do a <font color="#a52a2a"><b>serialization of EditableRootCollection (this will include in child/grand child)</b></font> and save it to a file(binary format and wrap it inside .zip to save space when send file through slow connection e-mail)<br><br>2. When the data received at the central server user will upload the file. I will do deserialization and verify if the data exist update otherwise insert. <br><br>Does this process make sense or someone has a better approach?<br><br></div></BLOCKQUOTE><br><br>I would not take this approach. Business objects are not DTOs (data transfer objects), and what you need is a data transfer object - you are transferring data after all.<br><br>But first, you should consider that data replication is a very old and well understood problem. There are some very good solutions in the database world for data replication. I would first look at data replication solutions (like DTS) before writing your own replication by hand.<br><br>If you decide to write your own replication by hand, I would export the data into the most efficient format possible. That is NOT a serialized object. It is probably a binary format - but that may be too difficult to maintain. The next most efficient is a fixed-length text file, but that may be too restrictive. The next most efficient is a tab-delimited or comma-delimited file, which is relatively easy to maintain and is not overly restrictive. That'd be my first choice, followed by the far less efficient, but even easier, XML file. Then you transfer the file to the server, and have a process that reads the file and puts the data into the database.<br><br>The process of exporting the data can be implemented by CSLA objects. That is a use case after all. Similarly, the process of importing the data can be implemented by CSLA objects - it is also a use case (a different one obviously).<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
