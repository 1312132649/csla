<html><header><title>&quot;Related&quot; business actions</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>&quot;Related&quot; business actions</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5332.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Tuesday, September 02, 2008</h2>Hi,<br><br>I'm now moving to capture inventory information in my quoting / sales application.&nbsp; As part of this, the expectation is that when an order is saved, the appropriate inventory is "locked."&nbsp; Not taken out of inventory, but somehow marked as committed to an order.<br><br>My question is how to plug this functionality into my existing order business objects.&nbsp; I know it needs to be encapsulated out.. but what's the best way to handle this?&nbsp; Just call this other BO which updates the inventory?&nbsp; As the order is changed and saved, the inventory needs to be changed as well.&nbsp; So just include this code as part of the DataPortal Insert / Update methods?<br><br>Thanks<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tmg4340 replied on Tuesday, September 02, 2008</h2><P><FONT face=Tahoma size=2>The first solution that comes to mind is a Command object that locks the inventory.&nbsp; After a successful Save(), you fire off this command.&nbsp; Or, you could fire it off in the DP_ methods of your base order object.&nbsp; Unless locking inventory is part of a use case/user interaction, I wouldn't create a full-fledged BO to do the locking.</FONT></P>
<P><FONT face=Tahoma size=2>HTH</FONT></P>
<P><FONT face=Tahoma size=2>- Scott</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, September 02, 2008</h2>I see the inventory locking as a new step being added to saving a document. It all should happen within the same transaction.<br><br>One thing I didn't mention is that inventory only gets locked if certain conditions about the order are true.&nbsp; So I don't know if that will affect anyone's advice.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tmg4340 replied on Tuesday, September 02, 2008</h2><P><FONT face=Tahoma size=2>I'd still make it a separate Command object.&nbsp; Given these conditions, I'd probably launch the command from the DP_ methods inside your root order object.&nbsp; That way, you can share the transaction that's been set up.&nbsp; And&nbsp;you could&nbsp;pass the order object to your command (via criteria) to let the command determine whether it needs to do anything.&nbsp; That would be the least intrusion into your order codebase.&nbsp; But you could certainly make a case for putting the determination of locking inventory into your order object, and then you don't have to pass it to your inventory command.&nbsp; I guess it depends on how you view the responsibility - it's a bit of a toss-up for me.</FONT></P>
<P><FONT face=Tahoma size=2>- Scott</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, September 03, 2008</h2>Actually that's a pretty good case for the command object.&nbsp; Also, I'll need the same logic when converting the quote to an order as well (quotes can lock inventory too).&nbsp; <br><br>Thanks!<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Wednesday, September 03, 2008</h2><P>Why not implement a workflow that is triggered when your order is saved?&nbsp; Then you can customize what does and doesn't occur as part of the workflow, giving you greater flexibility into the future.</P>
<P>Your&nbsp;workflow activity can make use of a command object as suggested.&nbsp; So, your business logic would trigger the workflow in response to your order being saved, one of the workflow activities would be "LockInventoryActivity" that implements a command object to perform the task in the data store.</P>
<P>This approach will allow you to change the business PROCESS (as opposed to logic) as needed.</P>
<P>P.S. Workflow activities are reusable, so you can add a&nbsp;workflow to your quote and reuse the same activity to lock the inventory!</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
