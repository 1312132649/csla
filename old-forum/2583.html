<html><header><title>WPF Csla.Wpf.CslaDataProvider</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>WPF Csla.Wpf.CslaDataProvider</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2583.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jb_ke posted on Saturday, March 24, 2007</h2><P><FONT size=2>ok,</FONT></P>
<P><FONT size=2>I just started playing around with Rocky's 3.0 <FONT face=Calibri>Csla.Wpf.CslaDataProvider code and I can't seem to get my head around something. (It's 5am and I'm still felling abit woozie after last nights party so maybe that has something todo with it<img src="/emoticons/emotion-2.gif" alt="Big Smile [:D]" />).</FONT></FONT></P>
<P><FONT size=2>I have a namespace called Gizmo.Orms.Core in with I have basicaly all my BO's coded and ready to go. In the Gizmo.Orms.Core.Error class. I have my factory methods, DataPortal methods etc. Pretty basic.</FONT></P>
<P><FONT size=2>As I'm creating a WPF application, I'm trying to get one of the factory methods called on this Gizmo.Orms.Core.Error class called:<BR></FONT><FONT color=#0000ff><BR><FONT size=2>public</FONT></FONT><FONT size=2> <FONT color=#0000ff>static</FONT> <FONT color=#2b91af>Error</FONT> GetErrorByElevatorId(<FONT color=#2b91af>Guid</FONT> ElevatorId){<BR>&nbsp;&nbsp;&nbsp;<FONT color=#0000ff>if</FONT> (!CanGetObject())<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;throw</FONT> <FONT color=#0000ff>new</FONT> <FONT color=#2b91af>SecurityException</FONT>(<FONT color=#a31515>"No authorisation to view error."</FONT>);<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;return</FONT> <FONT color=#2b91af>DataPortal</FONT>.Fetch&lt;<FONT color=#2b91af>Error</FONT>&gt;(<FONT color=#0000ff>new</FONT> <FONT color=#2b91af>Criteria</FONT>(<FONT color=#2b91af>Criteria</FONT>.<FONT color=#2b91af>enuErrorSelectCriteria</FONT>.ElevatorId, ElevatorId));<BR>}<BR><BR>So far so good, all pretty basic again.<BR><BR>In my Elevator.Xaml, which is a ResourceDictionairy, I have a ControlTemplate in which I'd like to bind to a property of the Gizmo.Orms.Core.Error class using a&nbsp;label object's value as input for the factory method.<BR><BR>I tried to get it working with the ObjectDataProvider and, I can see Rocky already frowning his eyebrows, came upon the already discussed problem of the constructors being called instead of the factory methods. Happy as a baby in new dypers when I read about&nbsp; the Csla.Wpf.CslaDataProvider class I was, I took an export of the repository and resseted (if thats even a word) my references from my Gizmo.Orms.Core to the latest Csla binairy.<BR><BR>Now here begins the drama<img src="/emoticons/emotion-6.gif" alt="Sad [:(]" /><BR><BR>Eventhow I consider myself a prety good dev monkey, I cannot seem to figure out how to implement this in the codebehind of the Elevator.Xaml, Elevator.cs. I can instantiate the Csla.Wpf.CslaDataProvider and set the needed properties to the Gizmo.Orms.Core.Error class, but how do I get the factory method called using BeginQuery? As far as I can see it needs to be overriden, but then the question comes to mind... where??<BR><BR>My Gizmo.Orms.Core.Error class derives from BusinessBase&lt;Error&gt; and the Elevator.cs codebind for the Elevator.Xaml can't implement the CslaDataProvider as it is a partial class(due to the g.cs auto generated class, or wotever it's called:P).<BR><BR>Wot am I missing here Rocky? Some codebehind and xaml code examples would be very much apriciated.<BR><BR>Btw, the input for that factory method, ElevatorId, is in a label on the same Xaml.<BR><BR>Oh and guys, pls be gentle if I missed something obvious<img src="/emoticons/emotion-2.gif" alt="Big Smile [:D]" /></FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Paul Czywczynski replied on Sunday, March 25, 2007</h2>Here is a <a href="/forums/thread/10752.aspx">link</a> to a previous post of mine about using CSLA and WPF. I've been using the ObjectDataProvider with CSLA for about 9 months now without an issue. I've been working with Rocky on the CSLA WPF controls but I haven't played much with the CslaDataProvider. Currently I am having some issues with IsAsync set to true that I haven't had time to work out yet. Although honestly I have not had a problem with the ODP to force me to use the CslaDataProvider.<br><br>Here is a piece of code I've been testing with. Note that our providers are all created in code-behind. Currently it is set up to use the ObjectDataProvider but swapping around the commented lines of code quickly switches it to use the CslaDataProvider. <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private ObjectDataProvider _odp = new ObjectDataProvider(); // = new CslaDataProvider();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #region Form databinding<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void DataBindForm()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using (_odp.DeferRefresh())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _odp.ObjectType = typeof(EmployeeDetails);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //_odp.FactoryMethod = "GetEmployeeDetails";<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _odp.MethodName = "GetEmployeeDetails";<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _odp.IsAsynchronous = true;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _odp.DataChanged += new EventHandler(_odp_DataChanged);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //_odp.FactoryParameters.Add(this.CurrentPageJournalItem.PrimaryKey.OriginId);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _odp.MethodParameters.Add(this.CurrentPageJournalItem.PrimaryKey.OriginId);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; void _odp_DataChanged(object sender, EventArgs e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_odp.Error != null)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw _odp.Error;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.DataContext = _odp;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // manually refresh csla panels due to async data provider<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cslaAuthorizationPanel.Refresh();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cslaValidationPanel.Refresh();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #endregion<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
