<html><header><title>newbie question again - multiple criteria in a root list BO</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>newbie question again - multiple criteria in a root list BO</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4042.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>SethSpearman posted on Friday, December 14, 2007</h2><P>I have EditRootList BO.&nbsp; On page 383 of Rocky's book he says:</P>
<P>&nbsp;"If you have a root collection&nbsp;in which your directly retrieving a collection of child object, the Criteria class may not define a single object, but rather act as a search filter that returns the collection populated with all matching child objects."</P>
<P>I want to do this very thing but I am not sure how.&nbsp; Can anyone point me to an example.&nbsp; Specifically I would want to return the children based on 3 different possible criteria.&nbsp; </P>
<P>Specifically, what would the next criteria class look like (example please) and what would the DataPortal_Fetch class look like.&nbsp;&nbsp;</P>
<P>Or could you create more than one nested criteria class and then create 3 overloaded DataPortal_Fetch classes (can you do that???)</P>
<P>Any advice will be appreciated.&nbsp; Thanks for all that you do.</P>
<P>SEth</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael Hildner replied on Friday, December 14, 2007</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>SethSpearman:</strong></div><div>Or could you create more than one nested criteria class and then create 3 overloaded DataPortal_Fetch classes (can you do that???)</div></BLOCKQUOTE></P>
<P>That's what I do, FWIW.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SethSpearman replied on Friday, December 14, 2007</h2><P>Thanks for the reply Micheal...will give it a shot.</P>
<P>Seth</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, December 14, 2007</h2><P>I put my criteria classes in a separate namespace and then re-use them across BOs.</P>
<P>I tried to make them general enough but sometimes it is beter to just create a new one so you can tell what you are passing.</P>
<P>e.g.</P>
<P>Namespace Criteria</P>
<P>'Any BO that needs to pass an interger is the "key" for this criteria class.</P>
<P>&nbsp; &lt;Serializable()&gt; _<BR>&nbsp; Public Class CriteriaIntegerKey<BR>&nbsp;&nbsp;&nbsp; Inherits CSLA.Server.CriteriaBase<BR>&nbsp;&nbsp;&nbsp; Public MethodName As String = ""<BR>&nbsp;&nbsp;&nbsp; Public Key As Integer = 0</P>
<P>&nbsp;&nbsp;&nbsp; Public Sub New(ByVal BOtype As Type, ByVal methodName As String, ByVal key As Integer)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyBase.New(BOtype)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.MethodName = methodName<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.Key = key<BR>&nbsp;&nbsp;&nbsp; End Sub<BR>&nbsp; End Class</P>
<P>'Any BO that needs to pass 2 Strings can use this criteria class.<BR>'But it helps if the Strings are Invoice Niumber and VendorNumber.</P>
<P>&lt;Serializable()&gt; _<BR>&nbsp;Public Class CriteriaInvoiceNumberVendno<BR>&nbsp;&nbsp;&nbsp; Inherits CSLA.Server.CriteriaBase<BR>&nbsp;&nbsp;&nbsp; Public MethodName As String = ""<BR>&nbsp;&nbsp;&nbsp; Public Vendno As String = ""<BR>&nbsp;&nbsp;&nbsp; Public InvoiceNumber As String = ""</P>
<P>&nbsp;&nbsp;&nbsp; Public Sub New(ByVal BOtype As Type, ByVal methodName As String, ByVal invoiceNumber As String, ByVal vendno As String)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyBase.New(BOtype)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.MethodName = methodName<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.Vendno = vendno<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.InvoiceNumber = invoiceNumber<BR>&nbsp;&nbsp;&nbsp; End Sub<BR>&nbsp; End Class</P>
<P>End Namespace</P>
<P>So the first criteria class above is more genral than the 2nd and caqn be used in more BOs.</P>
<P>Factory methods could look like this:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overloads</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetMyBO(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> key </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> MyBO<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>CType</FONT><FONT size=2>(DataPortal.Fetch(</FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> CriteriaIntegerKey(MyBO, "GetMyBO", key)), GetMyBO)<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetMyBOForPO(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> ponumber </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> invnumber </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> GetMyBO<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>CType</FONT><FONT size=2>(DataPortal.Fetch(</FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> CriteriaPONumberInvoiceNumber(GetMyBO, "GetMyBOForPO", ponumber, invnumber)), GetMyBO)<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT>
<P>Now you can branch on either the type of the Criteria or the methodname value. Use methodname when you have 2 or more of the same Crtieria being passed.</P>
<P>e.g.</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> DataPortal_Fetch(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> Criteria </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>TypeOf</FONT><FONT size=2> (Criteria) </FONT><FONT color=#0000ff size=2>Is</FONT><FONT size=2> CriteriaIntegerKey </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> crit </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> CriteriaIntegerKey = </FONT><FONT color=#0000ff size=2>CType</FONT><FONT size=2>(Criteria, CriteriaIntegerKey)<BR>&nbsp; doSomething(crit)<BR><BR></FONT><FONT color=#0000ff size=2>ElseIf</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>TypeOf</FONT><FONT size=2> (Criteria) </FONT><FONT color=#0000ff size=2>Is</FONT><FONT size=2> CriteriaPONumberInvoiceNumber </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> crit </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> CriteriaPONumberInvoiceNumber = </FONT><FONT color=#0000ff size=2>CType</FONT><FONT size=2>(Criteria, CriteriaPONumberInvoiceNumber)<BR>&nbsp; </FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> crit.MethodName = "GetMyBOForPO" </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>doSomething Else(crit)<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT>
<P>'etc.</P>
<P>&nbsp;</P>
<P>The one DataPortal_Fetch becomes a branching point for your code.</P>
<P>You could also write multiple ones with strong typed criteira which should also work.</P>
<P>Joe</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
