<html><header><title>DataPortal.Create Failed</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>DataPortal.Create Failed</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/990.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Joffies posted on Wednesday, August 23, 2006</h2><P><FONT face=Arial>Hi </FONT></P>
<P><FONT face=Arial>I am new to the CSLA framework and I am trying to create and test one&nbsp;editable root&nbsp;business class based on the Project tracker example with CSLA 2.0</FONT></P>
<P><FONT face=Arial>What are the possible reasons for the DataPortal.Create method to fail?</FONT></P><FONT color=#0000ff><FONT face=Tahoma><FONT color=#0000ff>
<P><FONT size=2>Public</FONT></FONT><FONT size=2><FONT color=#000000> </FONT><FONT color=#0000ff>Shared</FONT><FONT color=#000000> </FONT><FONT color=#0000ff>Function</FONT><FONT color=#000000> NewAdministrator() </FONT><FONT color=#0000ff>As</FONT><FONT color=#000000> Administrator</FONT></FONT></P>
<P><FONT size=2><FONT color=#0000ff>If</FONT> <FONT color=#0000ff>Not</FONT> CanAddObject() <FONT color=#0000ff>Then</P></FONT></FONT>
<P><FONT size=2><FONT color=#0000ff>Throw</FONT> <FONT color=#0000ff>New</FONT> System.Security.SecurityException( _</FONT></P>
<P><FONT size=2><FONT color=#800000>"User not authorized to add a administrator"</FONT>)</FONT></P>
<P><FONT size=2><FONT color=#0000ff>End</FONT> <FONT color=#0000ff>If</P></FONT></FONT>
<P><FONT size=2><FONT color=#0000ff>Return</FONT> DataPortal.Create(<FONT color=#0000ff>Of</FONT> Administrator)() <FONT color=#ff0000><STRONG>This is where it fails</STRONG></FONT></FONT></P>
<P><FONT size=2><FONT color=#0000ff>End</FONT> <FONT color=#0000ff>Function</FONT></FONT></P>
<P><FONT face=Arial color=#000000>What are the possible reasons for the DataPortal.Create method to fail?</FONT></P>
<P><FONT face=Arial color=#000000>Thanks in advance</FONT></P>
<P><FONT size=2><FONT color=#0000ff>&nbsp;</P></FONT></FONT></FONT></FONT><FONT face=Tahoma><FONT color=#0000ff size=2></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, August 23, 2006</h2>I think there's a bug in 2.0 where the proper method isn't being looked for; try upgrading to 2.0.3, that may fix this issue.&nbsp; After you upgrade, if this doesn't fix the issue, post back here again.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Joffies replied on Wednesday, August 23, 2006</h2><P><FONT face=Arial size=2>Hi thanks 4 the reply.</FONT></P>
<P><FONT face=Arial size=2>The Project tracker sample app works fine, its only the class in my app thats doesnt work on the DataPortal.Create method.</FONT></P>
<P><FONT face=Arial size=2>I did however donwload the 2.03 version and this obviously doesnt correct the situation <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /></FONT></P>
<P><FONT face=Arial size=2>I have based my class on the Resource class in the Project tracker application.</FONT></P>
<P><FONT face=Arial size=2>Any pointers or ideas what might be wrong?</FONT></P>
<P><FONT face=Arial size=2>Ta</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, August 23, 2006</h2>You might be defining your DataPortal_Create wrong.&nbsp;&nbsp; How are you defining it?&nbsp; Overriding the DataPortal_Create?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Joffies replied on Wednesday, August 23, 2006</h2><FONT size=2></FONT>
<P><FONT face=Arial size=2>Hi Again</FONT></P>
<P><FONT face=Arial size=2>I have the following method defined in the Data Access region. is this the override you are referring to?</FONT></P>
<P><FONT size=1>&lt;<FONT face=Arial>RunLocal()&gt; _</FONT></FONT></P>
<P><FONT size=1><FONT face=Arial><FONT color=#0000ff>Private</FONT> <FONT color=#0000ff>Overloads</FONT> <FONT color=#0000ff>Sub</FONT> DataPortal_Create(<FONT color=#0000ff>ByVal</FONT> criteria <FONT color=#0000ff>As</FONT></FONT><FONT face=Arial> Criteria)</FONT></FONT></P>
<P><FONT face=Arial size=1>ValidationRules.CheckRules()</FONT></P>
<P><FONT face=Arial><FONT size=1><FONT color=#0000ff>End</FONT> <FONT color=#0000ff>Sub</FONT></FONT></FONT></P>
<P><FONT face=Arial><FONT size=1><FONT color=#0000ff><FONT color=#000000 size=2>Anything i need to change here?</FONT></P></FONT></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, August 23, 2006</h2>Hmm... I'm not a vb guru, but I think you need:<br><br>Protected Overrides etc etc.<br><br>You have Private OverLOADS.<br><br>If that doesn't work, then try<br><br>Private Sub DataPortal_Create()<br>End Sub<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Wednesday, August 23, 2006</h2>The problem is that you're calling DataPortal.Create(Of xyz)() 'Without params.<br>If you don't pass criteria to the create, you must use the standard:<br><br>Protected Overrides Sub DataPortal_Create(ByVal criteria As Object)<br><br>you're doing:<br>Protected Overloads Sub DataPortal_Create(ByVal criteria As Criteria) 'Specifying criteria type.<br><br>There's nothing wrong in having a strong typed criteria in the method definition, but it won't work if you don't pass criteria.<br><br>The dataportal probes for dataportal methods in your object by trying to match the signature of the method (that's the name of the method and the types of the criteria). If you don't pass criteria, it always falls back to the standard methods defined in businessbase (which all take Object as the type of criteria)<br><br>So, you can either pass a criteria (that could be empty) object to dataportal.create or change the signature of your method. The same applies to DataPortal.Fetch(Of xyz)()<br><br>I hope it clarifies matters a bit.<br><br>Andr√©s<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dt_matthews replied on Tuesday, September 11, 2007</h2><P><FONT face=Verdana size=1>hi, sorry for being slow here but I have te same problem and am trying to follow the thread advice without much joy!</FONT></P>
<P><FONT face=Verdana size=1>My BO has this Factory method so as you see I am passing an Id (since I have read the data from an LLBLGen DAO layer) and then want to set the other properties from the LLBLGen object on the Business Object.</FONT></P>
<P><FONT face=Verdana size=1>The exception thrown follows the method sig.</FONT></P>
<P><FONT face=Verdana size=1>I'd really apprecaite any advice.</FONT></P>
<P><FONT face=Verdana size=1>Thanks, dan</FONT></P>
<P><FONT face=Verdana size=1>&nbsp;&nbsp;&nbsp; Public Shared Function NewPdaSyncHistory(ByVal id As Integer) As PdaSyncHistory</FONT></P>
<P><FONT face=Verdana size=1>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not CanAddObject() Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Throw New System.Security.SecurityException("User not authorized to add a PdaSyncHistory")<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return DataPortal.Create(Of PdaSyncHistory)(New Criteria(id))<BR>&nbsp;&nbsp;&nbsp; End Function</FONT></P><FONT face=Verdana size=1><FONT size=1>
<P>&lt;RunLocal()&gt; _</P>
<P></FONT><FONT color=#0000ff size=1>Protected</FONT><FONT size=1> </FONT><FONT color=#0000ff size=1>Overloads</FONT><FONT size=1> </FONT><FONT color=#0000ff size=1>Sub</FONT><FONT size=1> DataPortal_Create(</FONT><FONT color=#0000ff size=1>ByVal</FONT><FONT size=1> criteria </FONT><FONT color=#0000ff size=1>As</FONT><FONT size=1> </FONT><FONT color=#0000ff size=1>Object</FONT><FONT size=1>)</P>
<P></FONT><FONT color=#0000ff size=1>&nbsp;&nbsp;&nbsp;MyBase</FONT><FONT size=1>.DataPortal_Create()</P>
<P>&nbsp;&nbsp;&nbsp;mSyncEventId = 0</P>
<P>&nbsp;&nbsp;&nbsp;ValidationRules.CheckRules()</P>
<P></FONT><FONT color=#0000ff size=1>End</FONT><FONT size=1> </FONT><FONT color=#0000ff size=1>Sub</P></FONT></FONT>
<P><FONT face=Verdana size=1>====================</FONT></P>
<P><FONT face=Verdana size=1>Csla.DataPortalException was unhandled by user code<BR>&nbsp; Message="DataPortal.Fetch failed (Csla.DataPortalException: DataPortal.Fetch failed (Csla.DataPortalException: DataPortal.Create failed (System.NotSupportedException: Invalid operation - create not allowed<BR>&nbsp;&nbsp; at Csla.Core.BusinessBase.DataPortal_Create() in C:\Artemis2i\csla\Core\BusinessBase.vb:line 1185<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistory.DataPortal_Create(Object criteria) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistory.vb:line 181) ---&gt; Csla.Server.CallMethodException: DataPortal_Create method call failed ---&gt; System.NotSupportedException: Invalid operation - create not allowed<BR>&nbsp;&nbsp; at Csla.Core.BusinessBase.DataPortal_Create() in C:\Artemis2i\csla\Core\BusinessBase.vb:line 1185<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistory.DataPortal_Create(Object criteria) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistory.vb:line 181<BR>&nbsp;&nbsp; --- End of inner exception stack trace ---<BR>&nbsp;&nbsp; at Csla.Core.BusinessBase.DataPortal_Create() in C:\Artemis2i\csla\Core\BusinessBase.vb:line 1185<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistory.DataPortal_Create(Object criteria) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistory.vb:line 181<BR>&nbsp;&nbsp; at Csla.MethodCaller.CallMethod(Object obj, MethodInfo info, Object[] parameters) in C:\Artemis2i\csla\DataPortal\MethodCaller.vb:line 123<BR>&nbsp;&nbsp; at Csla.Server.SimpleDataPortal.Create(Type objectType, Object criteria, DataPortalContext context) in C:\Artemis2i\csla\DataPortal\Server\SimpleDataPortal.vb:line 52<BR>&nbsp;&nbsp; --- End of inner exception stack trace ---<BR>&nbsp;&nbsp; at Csla.Core.BusinessBase.DataPortal_Create() in C:\Artemis2i\csla\Core\BusinessBase.vb:line 1185<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistory.DataPortal_Create(Object criteria) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistory.vb:line 181<BR>&nbsp;&nbsp; at Csla.MethodCaller.CallMethod(Object obj, MethodInfo info, Object[] parameters) in C:\Artemis2i\csla\DataPortal\MethodCaller.vb:line 123<BR>&nbsp;&nbsp; at Csla.Server.SimpleDataPortal.Create(Type objectType, Object criteria, DataPortalContext context) in C:\Artemis2i\csla\DataPortal\Server\SimpleDataPortal.vb:line 52<BR>&nbsp;&nbsp; at Csla.DataPortal.Create(Type objectType, Object criteria) in C:\Artemis2i\csla\DataPortal\Client\DataPortal.vb:line 121<BR>&nbsp;&nbsp; at Csla.DataPortal.Create[T](Object criteria) in C:\Artemis2i\csla\DataPortal\Client\DataPortal.vb:line 67<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistory.NewPdaSyncHistory(Int32 id) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistory.vb:line 120<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistoryList.Fetch(DateTime dateFilter) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistoryList.vb:line 91<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistoryList.DataPortal_Fetch(Criteria criteria) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistoryList.vb:line 60) ---&gt; Csla.Server.CallMethodException: DataPortal_Fetch method call failed ---&gt; Csla.DataPortalException: DataPortal.Create failed (System.NotSupportedException: Invalid operation - create not allowed<BR>&nbsp;&nbsp; at Csla.Core.BusinessBase.DataPortal_Create() in C:\Artemis2i\csla\Core\BusinessBase.vb:line 1185<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistory.DataPortal_Create(Object criteria) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistory.vb:line 181) ---&gt; Csla.Server.CallMethodException: DataPortal_Create method call failed ---&gt; System.NotSupportedException: Invalid operation - create not allowed<BR>&nbsp;&nbsp; at Csla.Core.BusinessBase.DataPortal_Create() in C:\Artemis2i\csla\Core\BusinessBase.vb:line 1185<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistory.DataPortal_Create(Object criteria) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistory.vb:line 181<BR>&nbsp;&nbsp; --- End of inner exception stack trace ---<BR>&nbsp;&nbsp; at Csla.Core.BusinessBase.DataPortal_Create() in C:\Artemis2i\csla\Core\BusinessBase.vb:line 1185<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistory.DataPortal_Create(Object criteria) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistory.vb:line 181<BR>&nbsp;&nbsp; at Csla.MethodCaller.CallMethod(Object obj, MethodInfo info, Object[] parameters) in C:\Artemis2i\csla\DataPortal\MethodCaller.vb:line 123<BR>&nbsp;&nbsp; at Csla.Server.SimpleDataPortal.Create(Type objectType, Object criteria, DataPortalContext context) in C:\Artemis2i\csla\DataPortal\Server\SimpleDataPortal.vb:line 52<BR>&nbsp;&nbsp; --- End of inner exception stack trace ---<BR>&nbsp;&nbsp; at Csla.Core.BusinessBase.DataPortal_Create() in C:\Artemis2i\csla\Core\BusinessBase.vb:line 1185<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistory.DataPortal_Create(Object criteria) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistory.vb:line 181<BR>&nbsp;&nbsp; at Csla.MethodCaller.CallMethod(Object obj, MethodInfo info, Object[] parameters) in C:\Artemis2i\csla\DataPortal\MethodCaller.vb:line 123<BR>&nbsp;&nbsp; at Csla.Server.SimpleDataPortal.Create(Type objectType, Object criteria, DataPortalContext context) in C:\Artemis2i\csla\DataPortal\Server\SimpleDataPortal.vb:line 52<BR>&nbsp;&nbsp; at Csla.DataPortal.Create(Type objectType, Object criteria) in C:\Artemis2i\csla\DataPortal\Client\DataPortal.vb:line 121<BR>&nbsp;&nbsp; at Csla.DataPortal.Create[T](Object criteria) in C:\Artemis2i\csla\DataPortal\Client\DataPortal.vb:line 67<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistory.NewPdaSyncHistory(Int32 id) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistory.vb:line 120<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistoryList.Fetch(DateTime dateFilter) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistoryList.vb:line 91<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistoryList.DataPortal_Fetch(Criteria criteria) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistoryList.vb:line 60<BR>&nbsp;&nbsp; --- End of inner exception stack trace ---<BR>&nbsp;&nbsp; at Csla.Core.BusinessBase.DataPortal_Create() in C:\Artemis2i\csla\Core\BusinessBase.vb:line 1185<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistory.DataPortal_Create(Object criteria) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistory.vb:line 181<BR>&nbsp;&nbsp; at Csla.MethodCaller.CallMethod(Object obj, MethodInfo info, Object[] parameters) in C:\Artemis2i\csla\DataPortal\MethodCaller.vb:line 123<BR>&nbsp;&nbsp; at Csla.Server.SimpleDataPortal.Create(Type objectType, Object criteria, DataPortalContext context) in C:\Artemis2i\csla\DataPortal\Server\SimpleDataPortal.vb:line 52<BR>&nbsp;&nbsp; at Csla.DataPortal.Create(Type objectType, Object criteria) in C:\Artemis2i\csla\DataPortal\Client\DataPortal.vb:line 121<BR>&nbsp;&nbsp; at Csla.DataPortal.Create[T](Object criteria) in C:\Artemis2i\csla\DataPortal\Client\DataPortal.vb:line 67<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistory.NewPdaSyncHistory(Int32 id) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistory.vb:line 120<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistoryList.Fetch(DateTime dateFilter) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistoryList.vb:line 91<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistoryList.DataPortal_Fetch(Criteria criteria) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistoryList.vb:line 60<BR>&nbsp;&nbsp; at Csla.MethodCaller.CallMethod(Object obj, MethodInfo info, Object[] parameters) in C:\Artemis2i\csla\DataPortal\MethodCaller.vb:line 123<BR>&nbsp;&nbsp; at Csla.Server.SimpleDataPortal.Fetch(Type objectType, Object criteria, DataPortalContext context) in C:\Artemis2i\csla\DataPortal\Server\SimpleDataPortal.vb:line 116<BR>&nbsp;&nbsp; --- End of inner exception stack trace ---<BR>&nbsp;&nbsp; at Csla.Core.BusinessBase.DataPortal_Create() in C:\Artemis2i\csla\Core\BusinessBase.vb:line 1185<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistory.DataPortal_Create(Object criteria) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistory.vb:line 181<BR>&nbsp;&nbsp; at Csla.MethodCaller.CallMethod(Object obj, MethodInfo info, Object[] parameters) in C:\Artemis2i\csla\DataPortal\MethodCaller.vb:line 123<BR>&nbsp;&nbsp; at Csla.Server.SimpleDataPortal.Create(Type objectType, Object criteria, DataPortalContext context) in C:\Artemis2i\csla\DataPortal\Server\SimpleDataPortal.vb:line 52<BR>&nbsp;&nbsp; at Csla.DataPortal.Create(Type objectType, Object criteria) in C:\Artemis2i\csla\DataPortal\Client\DataPortal.vb:line 121<BR>&nbsp;&nbsp; at Csla.DataPortal.Create[T](Object criteria) in C:\Artemis2i\csla\DataPortal\Client\DataPortal.vb:line 67<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistory.NewPdaSyncHistory(Int32 id) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistory.vb:line 120<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistoryList.Fetch(DateTime dateFilter) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistoryList.vb:line 91<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistoryList.DataPortal_Fetch(Criteria criteria) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistoryList.vb:line 60<BR>&nbsp;&nbsp; at Csla.MethodCaller.CallMethod(Object obj, MethodInfo info, Object[] parameters) in C:\Artemis2i\csla\DataPortal\MethodCaller.vb:line 123<BR>&nbsp;&nbsp; at Csla.Server.SimpleDataPortal.Fetch(Type objectType, Object criteria, DataPortalContext context) in C:\Artemis2i\csla\DataPortal\Server\SimpleDataPortal.vb:line 116<BR>&nbsp;&nbsp; at Csla.DataPortal.Fetch(Type objectType, Object criteria) in C:\Artemis2i\csla\DataPortal\Client\DataPortal.vb:line 204<BR>&nbsp;&nbsp; at Csla.DataPortal.Fetch[T](Object criteria) in C:\Artemis2i\csla\DataPortal\Client\DataPortal.vb:line 148<BR>&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistoryList.GetPdaSyncHistoryList() in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistoryList.vb:line 19<BR>&nbsp;&nbsp; at Artemis2i.Library.Nurse.DataPortal_Fetch(Criteria criteria) in C:\Artemis2i\Artemis2iLib\Nurse\Nurse.vb:line 375)"<BR>&nbsp; Source="Csla"<BR>&nbsp; StackTrace:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.Core.BusinessBase.DataPortal_Create() in C:\Artemis2i\csla\Core\BusinessBase.vb:line 1185<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistory.DataPortal_Create(Object criteria) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistory.vb:line 181<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.MethodCaller.CallMethod(Object obj, MethodInfo info, Object[] parameters) in C:\Artemis2i\csla\DataPortal\MethodCaller.vb:line 123<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.Server.SimpleDataPortal.Create(Type objectType, Object criteria, DataPortalContext context) in C:\Artemis2i\csla\DataPortal\Server\SimpleDataPortal.vb:line 52<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.DataPortal.Create(Type objectType, Object criteria) in C:\Artemis2i\csla\DataPortal\Client\DataPortal.vb:line 121<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.DataPortal.Create[T](Object criteria) in C:\Artemis2i\csla\DataPortal\Client\DataPortal.vb:line 67<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistory.NewPdaSyncHistory(Int32 id) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistory.vb:line 120<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistoryList.Fetch(DateTime dateFilter) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistoryList.vb:line 91<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistoryList.DataPortal_Fetch(Criteria criteria) in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistoryList.vb:line 60<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.MethodCaller.CallMethod(Object obj, MethodInfo info, Object[] parameters) in C:\Artemis2i\csla\DataPortal\MethodCaller.vb:line 123<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.Server.SimpleDataPortal.Fetch(Type objectType, Object criteria, DataPortalContext context) in C:\Artemis2i\csla\DataPortal\Server\SimpleDataPortal.vb:line 116<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.DataPortal.Fetch(Type objectType, Object criteria) in C:\Artemis2i\csla\DataPortal\Client\DataPortal.vb:line 204<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.DataPortal.Fetch[T](Object criteria) in C:\Artemis2i\csla\DataPortal\Client\DataPortal.vb:line 148<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Artemis2i.Library.PdaSyncHistoryList.GetPdaSyncHistoryList() in C:\Artemis2i\Artemis2iLib\Pda\PdaSyncHistoryList.vb:line 19<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Artemis2i.Library.Nurse.DataPortal_Fetch(Criteria criteria) in C:\Artemis2i\Artemis2iLib\Nurse\Nurse.vb:line 375<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.MethodCaller.CallMethod(Object obj, MethodInfo info, Object[] parameters) in C:\Artemis2i\csla\DataPortal\MethodCaller.vb:line 123<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.Server.SimpleDataPortal.Fetch(Type objectType, Object criteria, DataPortalContext context) in C:\Artemis2i\csla\DataPortal\Server\SimpleDataPortal.vb:line 116<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.DataPortal.Fetch(Type objectType, Object criteria) in C:\Artemis2i\csla\DataPortal\Client\DataPortal.vb:line 204<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.DataPortal.Fetch[T](Object criteria) in C:\Artemis2i\csla\DataPortal\Client\DataPortal.vb:line 148<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Artemis2i.Library.Nurse.GetNurse(Int32 ID) in C:\Artemis2i\Artemis2iLib\Nurse\Nurse.vb:line 265<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Artemis2i.PL.NursePL.Nurse_Select(Int32 NurseId) in C:\Artemis2i\Artemis2iPL\NursePL.vb:line 15<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at WebControls_NurseDetails.PopulateNurseDetailsForm(Int32 NurseId) in C:\Artemis2i\Web\WebControls\NurseMainDetails.ascx.vb:line 82<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at WebControls_NurseDetails.Page_Load(Object sender, EventArgs e) in C:\Artemis2i\Web\WebControls\NurseMainDetails.ascx.vb:line 146<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.UI.Control.OnLoad(EventArgs e)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.UI.Control.LoadRecursive()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.UI.Control.LoadRecursive()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.UI.Control.LoadRecursive()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.UI.Control.LoadRecursive()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.UI.Control.LoadRecursive()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.UI.Control.LoadRecursive()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.UI.Control.LoadRecursive()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)<BR></FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>richardb replied on Tuesday, September 11, 2007</h2><P>Looking at your code, you don't need the MyBase.DataPortal_Create as you are not getting any defaults here for your object from the database.&nbsp; Although if you did want to, you'd just write code like the stuff typically placed in the Fetch statement.</P>
<P>Here's a C# version.</P><FONT color=#008000 size=2>
<P>//If you don't need to go to DataSource to get defaults, specify the RunLocal attribute<BR></FONT><FONT color=#008000 size=2>//as this optimises and removes the call to the DataPortal.<BR></FONT><FONT color=#008000 size=2>//If you do make a DataPortal call you MUST remove the RunLocal attribute.<BR></FONT><FONT size=2>[RunLocal()]<BR></FONT><FONT color=#0000ff size=2>protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>override</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> DataPortal_Create()<BR>{<BR>_id = Guid.NewGuid();<BR>_publishdate.Date = DateTime.Today;<BR>ValidationRules.CheckRules();<BR>}</FONT></P>
<P><FONT size=2>Richard.</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, September 11, 2007</h2><P>If you look in Chapter 4 of the book, you'll see that the base class implementations of the DataPortal_XYZ methods all throw exceptions. This is on purpose, as it helps debug scenarios where you forgot to overload/override the base method.</P>
<P>A side-effect of this, is that you can't call the base implementation - because doing so will result in that exception being thrown.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dt_matthews replied on Wednesday, September 12, 2007</h2><P>thanks Rocky! if my co-developer hadn't borrowed my book and not returned it I would have hopefully found it out for myself!!!!</P>
<P>&nbsp;</P>
<P>regards,</P>
<P>dan</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>elnoegarcia replied on Tuesday, September 11, 2007</h2>Hi!!<br><br>The problem is that the editor shows an error if you try to override that method, no matter if you specify the parameter or not. The message says: <br><br>"sub 'Dataportal_Create' cannot be declared 'Overrides' because it does not override a sub in a base class"<br><br>The editor offer 2 solutions, change Overrides for Overloads or left the signature without Overrides or Overloads (just Private Sub Dataportal_Create()). <br><br>I recommend that Joffies only has to use Overloads and delete the argument from the declaration of DataPortal_Create() or specify a new Criteria object when he calls the DataPortal.Create function (method).<br><br>I don't understand why this is happenin' because I review the clases in the CSLA framework (the generic BusinessBase class and BusinessBase class in the Core namespace) and the methods are marked with "Protected Overridable" and I don't know what's going on...<br><br>No√©<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, September 11, 2007</h2>






 

 
  
 




<div class=Section1>

<p class=MsoNormal><span>To override a method you must use the exact same method
signature of the base class. This is not what you are trying to do.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>Instead, you are trying to create a new method with the same
name, but a different signature. This is an overload.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>VB requires that you use the Overloads keyword in that case to
explicitly state your intent to overload the base class method. This is for clarity
of code.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>C# does not have a comparable overloads keyword, which I think
is less explicit (doesn&#8217;t show the developer&#8217;s intent), but does
save some typing.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>In any case, if you aren&#8217;t matching the method signature
of the base class method, then you aren&#8217;t overriding, you are
overloading.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>Rocky<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<div>

<p class=MsoNormal><b><span>From:</span></b><span> elnoegarcia
[mailto:cslanet@lhotka.net] <br>
<b>Sent:</b> Tuesday, September 11, 2007 12:13 PM<br>
<b>To:</b> rocky@lhotka.net<br>
<b>Subject:</b> Re: [CSLA .NET] DataPortal.Create Failed<o:p></o:p></span></p>

</div>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Hi!!<br>
<br>
The problem is that the editor shows an error if you try to override that
method, no matter if you specify the parameter or not. The message says: <br>
<br>
&quot;sub 'Dataportal_Create' cannot be declared 'Overrides' because it does
not override a sub in a base class&quot;<br>
<br>
The editor offer 2 solutions, change Overrides for Overloads or left the
signature without Overrides or Overloads (just Private Sub
Dataportal_Create()). <br>
<br>
I recommend that Joffies only has to use Overloads and delete the argument from
the declaration of DataPortal_Create() or specify a new Criteria object when he
calls the DataPortal.Create function (method).<br>
<br>
I don't understand why this is happenin' because I review the clases in the
CSLA framework (the generic BusinessBase class and BusinessBase class in the
Core namespace) and the methods are marked with &quot;Protected
Overridable&quot; and I don't know what's going on...<br>
<br>
No√É¬©<br>
<br>
<br>
<o:p></o:p></p>

</div>



</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>elnoegarcia replied on Wednesday, September 12, 2007</h2>You're right Rocky!!<img src="/emoticons/emotion-21.gif" alt="Yes [Y]" /><br><br>I changed a method in one of my projects to the same signature (using Protected and Overrides) for the DataPortal_Create() (without parameters), i noticed that the problem was in the visibility modifier (Protected).<br><br>best regards...<br>Noe<img src="/emoticons/emotion-2.gif" alt="Big Smile [:D]" /><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
