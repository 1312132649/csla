<html><header><title>Smart Client with local (database) cache</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Smart Client with local (database) cache</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1621.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Mat posted on Sunday, October 29, 2006</h2>I've been fiddling about with CSLA and am quite happy with it so far. It seems somewhat more versatile than other frameworks I've tried. There are a few related forum posts, but nothing concrete on the following scenario, which must be fairly common?<br><br>I want to create a Smart Client application with a full-fledged local SQL Server Express (or similar) database cache. The scenario is many clients connecting to a central database server, where each client will only replicate the (small) portion of the database in which it is interested.<br><br>The basic premise is that the client tries to retrieve data from the local
cache. If it cannot be found, it connects to the server to get the
data, dumps it in the local cache, return it to the user. Simple enough, but how would this fit into CSLA?<br><br>I'm thinking along the following lines, but is there a better way? Have I missed something obvious?<br><ol><li>Catch missing data exceptions in the DataPortal_Fetch function (this seems most promising)<br></li><li>Catch missing data exceptions from the data portal in the factory methods (with this I'd end up putting my remote database access code in the 'wrong' place)<br></li><li>Catch missing data  in 1 or 2 in another way than exceptions (this could be faster?)<br></li><li> Jiggery-pokery inside the framework to support multiple locations to load data from (haven't a clue about this one)</li></ol>Replication of updates to the central database can be handled in a similar manner, with the server-end catching collisions between users, etc.<br><br>I'd appeciate any comments on the above, is this even sensible and do-able?<br><br>Thanks<br><br>Mat<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Sunday, October 29, 2006</h2>First of all, create a second database connection in your Database object (check the PTracker example for an example of the Database object).&nbsp; Each object that could be fetched from both locations would implement an Exists method (check PTracker for examples).&nbsp; In your fetch method, call Exists() to check if the item exists in the local cache.&nbsp; If it exists, use the local connection, otherwise, use the remote connection.&nbsp; This does mean an extra database call, but it will be to your local database, so the performance hit should be negligible.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Mat replied on Monday, October 30, 2006</h2>Thanks Brian, I'll take a look at that as soon as I get round some other niggles I've been getting bogged down in today (DataBinding EditLevels).<br><br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
