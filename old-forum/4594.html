<html><header><title>Nitbits in code</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Nitbits in code</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4594.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Cine posted on Tuesday, April 01, 2008</h2>Removed redundant type qualifiers, removed redundant event creators, remove redundant initial values. Fix some code to use new get;set; Kill some uncalled code.<br>Index: BusinessBase.cs<br>===================================================================<br>--- BusinessBase.cs&nbsp;&nbsp;&nbsp; (revision 2235)<br>+++ BusinessBase.cs&nbsp;&nbsp;&nbsp; (working copy)<br>@@ -236,7 +236,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/returns&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; protected static PropertyInfo&lt;P&gt; RegisterProperty&lt;P&gt;(PropertyInfo&lt;P&gt; info)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Core.FieldManager.PropertyInfoManager.RegisterProperty&lt;P&gt;(typeof(T), info);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Core.FieldManager.PropertyInfoManager.RegisterProperty(typeof(T), info);<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; #endregion<br>Index: BusinessListBase.cs<br>===================================================================<br>--- BusinessListBase.cs&nbsp;&nbsp;&nbsp; (revision 2235)<br>+++ BusinessListBase.cs&nbsp;&nbsp;&nbsp; (working copy)<br>@@ -512,7 +512,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DeleteChild(child);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INotifyPropertyChanged c = child as INotifyPropertyChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (c != null)<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c.PropertyChanged -= new PropertyChangedEventHandler(Child_PropertyChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c.PropertyChanged -= Child_PropertyChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>@@ -543,7 +543,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; protected override void SetItem(int index, C item)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; C child = default(C);<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!(ReferenceEquals((C)(this[index]), item)))<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!(ReferenceEquals(this[index], item)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; child = this[index];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // replace the original object with this new<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // object<br>@@ -568,7 +568,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.RaiseListChangedEvents = oldRaiseListChangedEvents;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (child != null)<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!child.Equals(default(C)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CopyToDeletedList(child);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (RaiseListChangedEvents)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OnListChanged(new ListChangedEventArgs(ListChangedType.ItemChanged, index));<br>@@ -652,12 +652,6 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _indexSet.RemoveItem(item);<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp; private void RemoveIndexItem(C item, string property)<br>-&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DeferredLoadIndexIfNotLoaded();<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _indexSet.RemoveItem(item, property);<br>-&nbsp;&nbsp;&nbsp; }<br>-<br>&nbsp;&nbsp;&nbsp;&nbsp; private void ReIndexItem(C item, string property)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DeferredLoadIndexIfNotLoaded();<br>@@ -710,13 +704,6 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _positionMap.InsertIntoMap(child, position);<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp; private void AddToMap(C child)<br>-&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DeferredLoadPositionMapIfNotLoaded();<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _positionMap.AddToMap(child);<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>-&nbsp;&nbsp;&nbsp; }<br>-<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// Determines the position of a specific item from the list<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br>@@ -747,10 +734,10 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IEnumerable&lt;C&gt; sourceEnum = this.AsEnumerable&lt;C&gt;();<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IEnumerable&lt;C&gt; sourceEnum = this.AsEnumerable();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //IQueryable&lt;C&gt; sourceQuery = this.AsQueryable&lt;C&gt;();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //var result = sourceQuery.Where&lt;C&gt;(expr.Compile());<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var result = sourceEnum.Where&lt;C&gt;(expr.Compile());<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var result = sourceEnum.Where(expr.Compile());<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (C item in result)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; yield return item;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>@@ -785,7 +772,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; #region IsChild<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; [NotUndoable()]<br>-&nbsp;&nbsp;&nbsp; private bool _isChild = false;<br>+&nbsp;&nbsp;&nbsp; private bool _isChild;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// Indicates whether this collection object is a child object.<br>@@ -877,7 +864,7 @@<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; private static PropertyDescriptorCollection _propertyDescriptors;<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp; private PropertyDescriptor GetPropertyDescriptor(string propertyName)<br>+&nbsp;&nbsp;&nbsp; private static PropertyDescriptor GetPropertyDescriptor(string propertyName)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_propertyDescriptors == null)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _propertyDescriptors = TypeDescriptor.GetProperties(typeof(C));<br>@@ -904,7 +891,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; child.SetParent(this);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INotifyPropertyChanged c = child as INotifyPropertyChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (c != null)<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c.PropertyChanged += new PropertyChangedEventHandler(Child_PropertyChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c.PropertyChanged += Child_PropertyChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (Core.IEditableBusinessObject child in DeletedList)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; child.SetParent(this);<br>@@ -1265,9 +1252,6 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; #region LinqIntegration<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; [NonSerialized]<br>-&nbsp;&nbsp;&nbsp; IQueryProvider _queryProvider;<br>-<br>-&nbsp;&nbsp;&nbsp; [NonSerialized]<br>&nbsp;&nbsp;&nbsp;&nbsp; Expression _expression;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; internal void SetCurrentExpression(Expression ex)<br>@@ -1275,11 +1259,6 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _expression = ex;<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp; private void LoadProviderIfNotLoaded()<br>-&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _queryProvider = new Csla.Linq.CslaQueryProvider&lt;T, C&gt;(this);<br>-&nbsp;&nbsp;&nbsp; }<br>-<br>&nbsp;&nbsp;&nbsp;&nbsp; #region IQueryable Members<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>Index: Core/BusinessBase.cs<br>===================================================================<br>--- Core/BusinessBase.cs&nbsp;&nbsp;&nbsp; (revision 2235)<br>+++ Core/BusinessBase.cs&nbsp;&nbsp;&nbsp; (working copy)<br>@@ -497,7 +497,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; [EditorBrowsable(EditorBrowsableState.Advanced)]<br>&nbsp;&nbsp;&nbsp;&nbsp; public virtual bool CanReadProperty(string propertyName)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bool result = true;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bool result;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VerifyAuthorizationCache();<br>&nbsp;<br>@@ -602,7 +602,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; [EditorBrowsable(EditorBrowsableState.Advanced)]<br>&nbsp;&nbsp;&nbsp;&nbsp; public virtual bool CanWriteProperty(string propertyName)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bool result = true;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bool result;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VerifyAuthorizationCache();<br>&nbsp;<br>@@ -730,7 +730,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; public virtual bool CanExecuteMethod(string methodName)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bool result = true;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bool result;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VerifyAuthorizationCache();<br>&nbsp;<br>@@ -1490,7 +1490,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/returns&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; protected static PropertyInfo&lt;P&gt; RegisterProperty&lt;P&gt;(Type objectType, PropertyInfo&lt;P&gt; info)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Core.FieldManager.PropertyInfoManager.RegisterProperty&lt;P&gt;(objectType, info);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Core.FieldManager.PropertyInfoManager.RegisterProperty(objectType, info);<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; #endregion<br>@@ -1517,7 +1517,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/remarks&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; protected P GetProperty&lt;P&gt;(string propertyName, P field, P defaultValue)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return GetProperty&lt;P&gt;(propertyName, field, defaultValue, Security.NoAccessBehavior.SuppressException);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return GetProperty(propertyName, field, defaultValue, Security.NoAccessBehavior.SuppressException);<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>@@ -1561,7 +1561,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/remarks&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; protected P GetProperty&lt;P&gt;(PropertyInfo&lt;P&gt; propertyInfo, P field)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return GetProperty&lt;P&gt;(propertyInfo.Name, field, propertyInfo.DefaultValue, Security.NoAccessBehavior.SuppressException);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return GetProperty(propertyInfo.Name, field, propertyInfo.DefaultValue, Security.NoAccessBehavior.SuppressException);<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>@@ -1585,7 +1585,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/remarks&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; protected P GetProperty&lt;F, P&gt;(PropertyInfo&lt;F&gt; propertyInfo, F field)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Utilities.CoerceValue&lt;P&gt;(typeof(F), null, GetProperty&lt;F&gt;(propertyInfo.Name, field, propertyInfo.DefaultValue, Security.NoAccessBehavior.SuppressException));<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Utilities.CoerceValue&lt;P&gt;(typeof(F), null, GetProperty(propertyInfo.Name, field, propertyInfo.DefaultValue, Security.NoAccessBehavior.SuppressException));<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>@@ -1612,7 +1612,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/remarks&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; protected P GetProperty&lt;F, P&gt;(PropertyInfo&lt;F&gt; propertyInfo, F field, Security.NoAccessBehavior noAccess)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Utilities.CoerceValue&lt;P&gt;(typeof(F), null, GetProperty&lt;F&gt;(propertyInfo.Name, field, propertyInfo.DefaultValue, noAccess));<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Utilities.CoerceValue&lt;P&gt;(typeof(F), null, GetProperty(propertyInfo.Name, field, propertyInfo.DefaultValue, noAccess));<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>@@ -1631,7 +1631,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/remarks&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; protected P GetProperty&lt;P&gt;(PropertyInfo&lt;P&gt; propertyInfo)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return GetProperty&lt;P&gt;(propertyInfo, Security.NoAccessBehavior.SuppressException);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return GetProperty(propertyInfo, Security.NoAccessBehavior.SuppressException);<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>@@ -1654,7 +1654,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/remarks&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; protected P GetProperty&lt;F, P&gt;(PropertyInfo&lt;F&gt; propertyInfo)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Utilities.CoerceValue&lt;P&gt;(typeof(F), null, GetProperty&lt;F&gt;(propertyInfo, Security.NoAccessBehavior.SuppressException));<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Utilities.CoerceValue&lt;P&gt;(typeof(F), null, GetProperty(propertyInfo, Security.NoAccessBehavior.SuppressException));<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>@@ -1680,7 +1680,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/remarks&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; protected P GetProperty&lt;F, P&gt;(PropertyInfo&lt;F&gt; propertyInfo, Security.NoAccessBehavior noAccess)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Utilities.CoerceValue&lt;P&gt;(typeof(F), null, GetProperty&lt;F&gt;(propertyInfo, noAccess));<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Utilities.CoerceValue&lt;P&gt;(typeof(F), null, GetProperty(propertyInfo, noAccess));<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>@@ -1702,9 +1702,9 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/remarks&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; protected P GetProperty&lt;P&gt;(PropertyInfo&lt;P&gt; propertyInfo, Security.NoAccessBehavior noAccess)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; P result = default(P);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; P result;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (CanReadProperty(propertyInfo.Name, noAccess == Csla.Security.NoAccessBehavior.ThrowException))<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = ReadProperty&lt;P&gt;(propertyInfo);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = ReadProperty(propertyInfo);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = propertyInfo.DefaultValue;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return result;<br>@@ -1755,7 +1755,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// PropertyInfo object containing property metadata.&lt;/param&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; protected P ReadProperty&lt;F, P&gt;(PropertyInfo&lt;F&gt; propertyInfo)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Utilities.CoerceValue&lt;P&gt;(typeof(F), null, ReadProperty&lt;F&gt;(propertyInfo));<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Utilities.CoerceValue&lt;P&gt;(typeof(F), null, ReadProperty(propertyInfo));<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>@@ -1768,7 +1768,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// PropertyInfo object containing property metadata.&lt;/param&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; protected P ReadProperty&lt;P&gt;(PropertyInfo&lt;P&gt; propertyInfo)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; P result = default(P);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; P result;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.IFieldData data = FieldManager.GetFieldData(propertyInfo);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (data != null)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>@@ -1781,7 +1781,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = propertyInfo.DefaultValue;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.LoadFieldData&lt;P&gt;(propertyInfo, result);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.LoadFieldData(propertyInfo, result);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return result;<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>@@ -1867,7 +1867,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/remarks&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; protected void SetProperty&lt;P, V&gt;(PropertyInfo&lt;P&gt; propertyInfo, ref P field, V newValue)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetProperty&lt;P, V&gt;(propertyInfo, ref field, newValue, Security.NoAccessBehavior.ThrowException);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetProperty(propertyInfo, ref field, newValue, Security.NoAccessBehavior.ThrowException);<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>@@ -1896,7 +1896,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/remarks&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; protected void SetProperty&lt;P, V&gt;(PropertyInfo&lt;P&gt; propertyInfo, ref P field, V newValue, Security.NoAccessBehavior noAccess)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetProperty&lt;P, V&gt;(propertyInfo.Name, ref field, newValue, noAccess);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetProperty(propertyInfo.Name, ref field, newValue, noAccess);<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>@@ -1919,9 +1919,9 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (field == null)<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (field.Equals(default(P)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (newValue != null)<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!newValue.Equals(default(P)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OnPropertyChanging(propertyName);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; field = newValue;<br>@@ -1930,7 +1930,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if (!(field.Equals(newValue)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (newValue is string &amp;&amp; newValue == null)<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (newValue is string &amp;&amp; newValue.Equals(default(P)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newValue = Utilities.CoerceValue&lt;P&gt;(typeof(string), field, string.Empty);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OnPropertyChanging(propertyName);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; field = newValue;<br>@@ -1974,9 +1974,9 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (field == null)<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (field.Equals(default(P)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (newValue != null)<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!newValue.Equals(default(P)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OnPropertyChanging(propertyName);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; field = Utilities.CoerceValue&lt;P&gt;(typeof(V), field, newValue);<br>@@ -1985,7 +1985,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if (!(field.Equals(newValue)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (newValue is string &amp;&amp; newValue == null)<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (newValue is string &amp;&amp; newValue.Equals(default(P)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newValue = Utilities.CoerceValue&lt;V&gt;(typeof(string), null, string.Empty);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OnPropertyChanging(propertyName);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; field = Utilities.CoerceValue&lt;P&gt;(typeof(V), field, newValue);<br>@@ -2032,7 +2032,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/remarks&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; protected void SetProperty&lt;P, F&gt;(PropertyInfo&lt;P&gt; propertyInfo, F newValue)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetProperty&lt;P, F&gt;(propertyInfo, newValue, Security.NoAccessBehavior.ThrowException);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetProperty(propertyInfo, newValue, Security.NoAccessBehavior.ThrowException);<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>@@ -2053,12 +2053,12 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; P oldValue = default(P);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; P oldValue;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var fieldData = FieldManager.GetFieldData(propertyInfo);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (fieldData == null)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oldValue = propertyInfo.DefaultValue;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fieldData = FieldManager.LoadFieldData&lt;P&gt;(propertyInfo, oldValue);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.LoadFieldData(propertyInfo, oldValue);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>@@ -2068,7 +2068,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oldValue = (P)fieldData.Value;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LoadPropertyValue&lt;P&gt;(propertyInfo, oldValue, Utilities.CoerceValue&lt;P&gt;(typeof(F), oldValue, newValue), true);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LoadPropertyValue(propertyInfo, oldValue, Utilities.CoerceValue&lt;P&gt;(typeof(F), oldValue, newValue), true);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>@@ -2098,12 +2098,12 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; P oldValue = default(P);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; P oldValue;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var fieldData = FieldManager.GetFieldData(propertyInfo);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (fieldData == null)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oldValue = propertyInfo.DefaultValue;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fieldData = FieldManager.LoadFieldData&lt;P&gt;(propertyInfo, oldValue);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.LoadFieldData(propertyInfo, oldValue);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>@@ -2113,7 +2113,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oldValue = (P)fieldData.Value;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LoadPropertyValue&lt;P&gt;(propertyInfo, oldValue, newValue, true);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LoadPropertyValue(propertyInfo, oldValue, newValue, true);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>@@ -2163,12 +2163,12 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; P oldValue = default(P);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; P oldValue;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var fieldData = FieldManager.GetFieldData(propertyInfo);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (fieldData == null)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oldValue = propertyInfo.DefaultValue;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fieldData = FieldManager.LoadFieldData&lt;P&gt;(propertyInfo, oldValue);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.LoadFieldData&lt;P&gt;(propertyInfo, oldValue);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>@@ -2178,7 +2178,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oldValue = (P)fieldData.Value;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LoadPropertyValue&lt;P&gt;(propertyInfo, oldValue, Utilities.CoerceValue&lt;P&gt;(typeof(F), oldValue, newValue), false);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LoadPropertyValue(propertyInfo, oldValue, Utilities.CoerceValue&lt;P&gt;(typeof(F), oldValue, newValue), false);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>@@ -2208,12 +2208,12 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; P oldValue = default(P);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; P oldValue;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var fieldData = FieldManager.GetFieldData(propertyInfo);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (fieldData == null)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oldValue = propertyInfo.DefaultValue;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fieldData = FieldManager.LoadFieldData&lt;P&gt;(propertyInfo, oldValue);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.LoadFieldData(propertyInfo, oldValue);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>@@ -2223,7 +2223,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oldValue = (P)fieldData.Value;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LoadPropertyValue&lt;P&gt;(propertyInfo, oldValue, newValue, false);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LoadPropertyValue(propertyInfo, oldValue, newValue, false);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>@@ -2233,9 +2233,9 @@<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; private void LoadPropertyValue&lt;P&gt;(PropertyInfo&lt;P&gt; propertyInfo, P oldValue, P newValue, bool markDirty)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var valuesDiffer = false;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (oldValue == null)<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; valuesDiffer = newValue != null;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bool valuesDiffer;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (oldValue.Equals(default(P)))<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; valuesDiffer = !newValue.Equals(default(P));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; valuesDiffer = !(oldValue.Equals(newValue));<br>&nbsp;<br>@@ -2244,20 +2244,20 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (typeof(IEditableBusinessObject).IsAssignableFrom(propertyInfo.Type))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // remove old event hook<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (oldValue != null)<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!oldValue.Equals(default(P)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INotifyPropertyChanged pc = (INotifyPropertyChanged)oldValue;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pc.PropertyChanged -= new PropertyChangedEventHandler(Child_PropertyChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pc.PropertyChanged -= Child_PropertyChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (markDirty)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OnPropertyChanging(propertyInfo.Name);<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.SetFieldData&lt;P&gt;(propertyInfo, newValue);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.SetFieldData(propertyInfo, newValue);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged(propertyInfo.Name);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.LoadFieldData&lt;P&gt;(propertyInfo, newValue);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.LoadFieldData(propertyInfo, newValue);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IEditableBusinessObject child = (IEditableBusinessObject)newValue;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (child != null)<br>@@ -2269,26 +2269,26 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; child.EditLevelAdded = this.EditLevel;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // hook child event<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INotifyPropertyChanged pc = (INotifyPropertyChanged)newValue;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pc.PropertyChanged += new PropertyChangedEventHandler(Child_PropertyChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pc.PropertyChanged += Child_PropertyChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if (typeof(IEditableCollection).IsAssignableFrom(propertyInfo.Type))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // remove old event hooks<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (oldValue != null)<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!oldValue.Equals(default(P)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IBindingList pc = (IBindingList)oldValue;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pc.ListChanged -= new ListChangedEventHandler(Child_ListChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pc.ListChanged -= Child_ListChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (markDirty)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OnPropertyChanging(propertyInfo.Name);<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.SetFieldData&lt;P&gt;(propertyInfo, newValue);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.SetFieldData(propertyInfo, newValue);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged(propertyInfo.Name);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.LoadFieldData&lt;P&gt;(propertyInfo, newValue);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.LoadFieldData(propertyInfo, newValue);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IEditableCollection child = (IEditableCollection)newValue;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (child != null)<br>@@ -2301,7 +2301,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UndoableBase.ResetChildEditLevel(undoChild, this.EditLevel, this.BindingEdit);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IBindingList pc = (IBindingList)newValue;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pc.ListChanged += new ListChangedEventHandler(Child_ListChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pc.ListChanged += Child_ListChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>@@ -2309,12 +2309,12 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (markDirty)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OnPropertyChanging(propertyInfo.Name);<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.SetFieldData&lt;P&gt;(propertyInfo, newValue);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.SetFieldData(propertyInfo, newValue);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged(propertyInfo.Name);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.LoadFieldData&lt;P&gt;(propertyInfo, newValue);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.LoadFieldData(propertyInfo, newValue);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>@@ -2384,7 +2384,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; eo.SetParent(this);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; INotifyPropertyChanged pc = (INotifyPropertyChanged)item;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pc.PropertyChanged += new PropertyChangedEventHandler(Child_PropertyChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pc.PropertyChanged += Child_PropertyChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>@@ -2393,7 +2393,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; el.SetParent(this);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IBindingList bl = (IBindingList)item;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bl.ListChanged += new ListChangedEventHandler(Child_ListChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bl.ListChanged += Child_ListChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>Index: DataPortal/Client/DataPortal.cs<br>===================================================================<br>--- DataPortal/Client/DataPortal.cs&nbsp;&nbsp;&nbsp; (revision 2235)<br>+++ DataPortal/Client/DataPortal.cs&nbsp;&nbsp;&nbsp; (working copy)<br>@@ -1,5 +1,6 @@<br>&nbsp;using System;<br>&nbsp;using System.ComponentModel;<br>+using Csla.DataPortalClient;<br>&nbsp;using Csla.Reflection;<br>&nbsp;using Csla.Properties;<br>&nbsp;<br>@@ -482,8 +483,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var method = Server.DataPortalMethodCache.GetMethodInfo(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; objectType, "DataPortal_Delete", criteria);<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataPortalClient.IDataPortalProxy proxy;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; proxy = GetDataPortalProxy(method.RunLocal);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IDataPortalProxy proxy = GetDataPortalProxy(method.RunLocal);<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dpContext = new Server.DataPortalContext(GetPrincipal(), proxy.IsServerRemote);<br>&nbsp;<br>Index: DataPortal/Hosts/EnterpriseServicesPortal.cs<br>===================================================================<br>--- DataPortal/Hosts/EnterpriseServicesPortal.cs&nbsp;&nbsp;&nbsp; (revision 2235)<br>+++ DataPortal/Hosts/EnterpriseServicesPortal.cs&nbsp;&nbsp;&nbsp; (working copy)<br>@@ -89,8 +89,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // this is a workaround for a bug in the .NET runtime<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AppDomain currentDomain = AppDomain.CurrentDomain;<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; currentDomain.AssemblyResolve += <br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new ResolveEventHandler(ResolveEventHandler);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; currentDomain.AssemblyResolve += ResolveEventHandler;<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; private static Assembly ResolveEventHandler(<br>Index: EditableRootListBase.cs<br>===================================================================<br>--- EditableRootListBase.cs&nbsp;&nbsp;&nbsp; (revision 2235)<br>+++ EditableRootListBase.cs&nbsp;&nbsp;&nbsp; (working copy)<br>@@ -151,7 +151,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.ComponentModel.INotifyPropertyChanged c = item as System.ComponentModel.INotifyPropertyChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (c != null)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c.PropertyChanged -= new System.ComponentModel.PropertyChangedEventHandler(Child_PropertyChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c.PropertyChanged -= Child_PropertyChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.RemoveItem(index);<br>@@ -238,7 +238,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.ComponentModel.INotifyPropertyChanged c = child as System.ComponentModel.INotifyPropertyChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (c != null)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c.PropertyChanged += new System.ComponentModel.PropertyChangedEventHandler(Child_PropertyChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c.PropertyChanged += Child_PropertyChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>Index: FilteredBindingList.cs<br>===================================================================<br>--- FilteredBindingList.cs&nbsp;&nbsp;&nbsp; (revision 2235)<br>+++ FilteredBindingList.cs&nbsp;&nbsp;&nbsp; (working copy)<br>@@ -12,7 +12,7 @@<br>&nbsp;&nbsp; /// &lt;typeparam name="T"&gt;The type of the objects contained<br>&nbsp;&nbsp; /// in the original list.&lt;/typeparam&gt;<br>&nbsp;&nbsp; public class FilteredBindingList&lt;T&gt; :<br>-&nbsp;&nbsp;&nbsp; IList&lt;T&gt;, IBindingList, IEnumerable&lt;T&gt;,<br>+&nbsp;&nbsp;&nbsp; IList&lt;T&gt;, IBindingList,<br>&nbsp;&nbsp;&nbsp;&nbsp; ICancelAddNew<br>&nbsp;&nbsp; {<br>&nbsp;<br>@@ -20,24 +20,14 @@<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; private class ListItem <br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private object _key;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private int _baseIndex;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public object Key { get; private set; }<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public object Key<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return _key; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int BaseIndex { get; set; }<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int BaseIndex<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return _baseIndex; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set { _baseIndex = value; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>-<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public ListItem(object key, int baseIndex)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _key = key;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _baseIndex = baseIndex;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Key = key;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BaseIndex = baseIndex;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public override string ToString()<br>@@ -94,7 +84,7 @@<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #region IDisposable Support<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private bool _disposedValue = false; // To detect redundant calls.<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private bool _disposedValue; // To detect redundant calls.<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // IDisposable<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected virtual void Dispose(bool disposing)<br>@@ -679,7 +669,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; private bool _filtered;<br>&nbsp;&nbsp;&nbsp;&nbsp; private PropertyDescriptor _filterBy;<br>&nbsp;&nbsp;&nbsp;&nbsp; private object _filter;<br>-&nbsp;&nbsp;&nbsp; FilterProvider _provider = null;<br>+&nbsp;&nbsp;&nbsp; FilterProvider _provider;<br>&nbsp;&nbsp;&nbsp;&nbsp; private List&lt;ListItem&gt; _filterIndex = <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new List&lt;ListItem&gt;();<br>&nbsp;<br>@@ -695,8 +685,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _supportsBinding = true;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _bindingList = (IBindingList)_list;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _bindingList.ListChanged += <br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new ListChangedEventHandler(SourceChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _bindingList.ListChanged += SourceChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>@@ -826,7 +815,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_filtered)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int listIndex;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int filteredIndex = -1;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int filteredIndex;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T newItem;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object newKey;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; switch (e.ListChangedType)<br>@@ -835,10 +824,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; listIndex = e.NewIndex;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // add new value to index<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newItem = _list[listIndex];<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_filterBy != null)<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newKey = _filterBy.GetValue(newItem);<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newKey = newItem;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newKey = _filterBy != null ? _filterBy.GetValue(newItem) : newItem;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _filterIndex.Add(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new ListItem(newKey, listIndex));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; filteredIndex = _filterIndex.Count - 1;<br>@@ -855,10 +841,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (filteredIndex != -1)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newItem = _list[listIndex];<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_filterBy != null)<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newKey = _filterBy.GetValue(newItem);<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newKey = newItem;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newKey = _filterBy != null ? _filterBy.GetValue(newItem) : newItem;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _filterIndex[filteredIndex] =<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new ListItem(newKey, listIndex);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>Index: Linq/LinqBindingList.cs<br>===================================================================<br>--- Linq/LinqBindingList.cs&nbsp;&nbsp;&nbsp; (revision 2235)<br>+++ Linq/LinqBindingList.cs&nbsp;&nbsp;&nbsp; (working copy)<br>@@ -15,7 +15,7 @@<br>&nbsp;&nbsp; /// &lt;typeparam name="T"&gt;The type of the objects contained<br>&nbsp;&nbsp; /// in the original list.&lt;/typeparam&gt;<br>&nbsp;&nbsp; public class LinqBindingList&lt;T&gt; :<br>-&nbsp;&nbsp;&nbsp; IList&lt;T&gt;, IBindingList, IEnumerable&lt;T&gt;,<br>+&nbsp;&nbsp;&nbsp; IList&lt;T&gt;, IBindingList,<br>&nbsp;&nbsp;&nbsp;&nbsp; ICancelAddNew, IQueryable&lt;T&gt;<br>&nbsp;&nbsp; {<br>&nbsp;<br>@@ -23,24 +23,14 @@<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; private class ListItem <br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private object _key;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private int _baseIndex;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public object Key { get; private set; }<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public object Key<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return _key; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int BaseIndex { get; set; }<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int BaseIndex<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return _baseIndex; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set { _baseIndex = value; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>-<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public ListItem(object key, int baseIndex)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _key = key;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _baseIndex = baseIndex;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Key = key;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BaseIndex = baseIndex;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public override string ToString()<br>@@ -546,8 +536,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _supportsBinding = true;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _bindingList = (IBindingList)_list;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _bindingList.ListChanged += <br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new ListChangedEventHandler(SourceChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _bindingList.ListChanged += SourceChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>@@ -590,7 +579,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object sender, ListChangedEventArgs e)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int listIndex;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int filteredIndex = -1;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int filteredIndex;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T newItem;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object newKey;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; switch (e.ListChangedType)<br>@@ -599,10 +588,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; listIndex = e.NewIndex;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // add new value to index<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newItem = _list[listIndex];<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_filterBy != null)<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newKey = _filterBy.GetValue(newItem);<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newKey = newItem;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newKey = _filterBy != null ? _filterBy.GetValue(newItem) : newItem;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //check to see if it is in the filter<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ItemShouldBeInList(newItem))<br>@@ -622,10 +608,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (filteredIndex != -1)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newItem = _list[listIndex];<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_filterBy != null)<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newKey = _filterBy.GetValue(newItem);<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newKey = newItem;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newKey = _filterBy != null ? _filterBy.GetValue(newItem) : newItem;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ItemShouldBeInList(newItem))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _filterIndex[filteredIndex] =<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new ListItem(newKey, listIndex);<br>Index: NameValueListBase.cs<br>===================================================================<br>--- NameValueListBase.cs&nbsp;&nbsp;&nbsp; (revision 2235)<br>+++ NameValueListBase.cs&nbsp;&nbsp;&nbsp; (working copy)<br>@@ -16,7 +16,7 @@<br>&nbsp;&nbsp; [Serializable()]<br>&nbsp;&nbsp; public abstract class NameValueListBase&lt;K, V&gt; : <br>&nbsp;&nbsp;&nbsp;&nbsp; Core.ReadOnlyBindingList&lt;NameValueListBase&lt;K, V&gt;.NameValuePair&gt;, <br>-&nbsp;&nbsp;&nbsp; ICloneable, Core.IBusinessObject, Server.IDataPortalTarget<br>+&nbsp;&nbsp;&nbsp; ICloneable, Server.IDataPortalTarget<br>&nbsp;&nbsp; {<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; #region Core Implementation<br>@@ -152,34 +152,25 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; [Serializable()]<br>&nbsp;&nbsp;&nbsp;&nbsp; public class NameValuePair<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private K _key;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private V _value;<br>-<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// The Key or Name value.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public K Key<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return _key; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public K Key { get; private set; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// The Value corresponding to the key/name.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public V Value<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return _value; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public V Value { get; private set; }<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// Creates an instance of the object.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name="key"&gt;The key.&lt;/param&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name="value"&gt;The value.&lt;/param&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public NameValuePair(K key, V value)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _key = key;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _value = value;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Key = key;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Value = value;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>@@ -188,7 +179,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public override string ToString()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return _value.ToString();<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Value.ToString();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>Index: SortedBindingList.cs<br>===================================================================<br>--- SortedBindingList.cs&nbsp;&nbsp;&nbsp; (revision 2235)<br>+++ SortedBindingList.cs&nbsp;&nbsp;&nbsp; (working copy)<br>@@ -14,32 +14,21 @@<br>&nbsp;&nbsp; /// the original list or collection.<br>&nbsp;&nbsp; /// &lt;/typeparam&gt;<br>&nbsp;&nbsp; public class SortedBindingList&lt;T&gt; : <br>-&nbsp;&nbsp;&nbsp; IList&lt;T&gt;, IBindingList, IEnumerable&lt;T&gt;, ICancelAddNew<br>+&nbsp;&nbsp;&nbsp; IList&lt;T&gt;, IBindingList, ICancelAddNew<br>&nbsp;&nbsp; {<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; #region ListItem class<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; private class ListItem : IComparable&lt;ListItem&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public object Key { get; private set; }<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private object _key;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private int _baseIndex;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int BaseIndex { get; set; }<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public object Key<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return _key; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>-<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int BaseIndex<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return _baseIndex; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set { _baseIndex = value; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>-<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public ListItem(object key, int baseIndex)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _key = key;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _baseIndex = baseIndex;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Key = key;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BaseIndex = baseIndex;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int CompareTo(ListItem other)<br>@@ -49,20 +38,14 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (Key is IComparable)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return ((IComparable)Key).CompareTo(target);<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (Key == null)<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (Key == null)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (target == null)<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return -1;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if (Key.Equals(target))<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return -1;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (Key.Equals(target))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Key.ToString().CompareTo(target.ToString());<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Key.ToString().CompareTo(target.ToString());<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public override string ToString()<br>@@ -138,7 +121,7 @@<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #region IDisposable Support<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private bool _disposedValue = false; // To detect redundant calls.<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private bool _disposedValue; // To detect redundant calls.<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // IDisposable<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected virtual void Dispose(bool disposing)<br>@@ -743,8 +726,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _supportsBinding = true;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _bindingList = (IBindingList)_list;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _bindingList.ListChanged += <br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new ListChangedEventHandler(SourceChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _bindingList.ListChanged += SourceChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>@@ -760,10 +742,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (e.NewIndex == _list.Count - 1)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object newKey;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_sortBy != null)<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newKey = _sortBy.GetValue(newItem);<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newKey = newItem;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newKey = _sortBy != null ? _sortBy.GetValue(newItem) : newItem;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_sortOrder == ListSortDirection.Ascending)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _sortIndex.Add(<br>Index: Windows/BindingSourceRefresh.cs<br>===================================================================<br>--- Windows/BindingSourceRefresh.cs&nbsp;&nbsp;&nbsp; (revision 2235)<br>+++ Windows/BindingSourceRefresh.cs&nbsp;&nbsp;&nbsp; (working copy)<br>@@ -30,8 +30,8 @@<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; #region Property Fields<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp; private Exception _exception = null;<br>-&nbsp;&nbsp;&nbsp; private Binding _binding = null;<br>+&nbsp;&nbsp;&nbsp; private Exception _exception;<br>+&nbsp;&nbsp;&nbsp; private Binding _binding;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; #endregion<br>&nbsp;<br>@@ -96,7 +96,7 @@<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; #region Property Fields<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp; private ContainerControl _host = null;<br>+&nbsp;&nbsp;&nbsp; private ContainerControl _host;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; #endregion<br>&nbsp;<br>@@ -169,7 +169,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// Required designer variable.<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br>-&nbsp;&nbsp;&nbsp; private System.ComponentModel.IContainer components = null;<br>+&nbsp;&nbsp;&nbsp; private System.ComponentModel.IContainer components;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt; <br>&nbsp;&nbsp;&nbsp;&nbsp; /// Clean up any resources being used.<br>@@ -254,16 +254,16 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // If we are to register the events the do so.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (register)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; container.DataBindings.CollectionChanged += new CollectionChangeEventHandler(DataBindings_CollectionChanged);<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; container.ControlAdded += new ControlEventHandler(Container_ControlAdded);<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; container.ControlRemoved += new ControlEventHandler(Container_ControlRemoved);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; container.DataBindings.CollectionChanged += DataBindings_CollectionChanged;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; container.ControlAdded += Container_ControlAdded;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; container.ControlRemoved += Container_ControlRemoved;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Else unregister them.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; container.DataBindings.CollectionChanged -= new CollectionChangeEventHandler(DataBindings_CollectionChanged);<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; container.ControlAdded -= new ControlEventHandler(Container_ControlAdded);<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; container.ControlRemoved -= new ControlEventHandler(Container_ControlRemoved);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; container.DataBindings.CollectionChanged -= DataBindings_CollectionChanged;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; container.ControlAdded -= Container_ControlAdded;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; container.ControlRemoved -= Container_ControlRemoved;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Reigster the binding complete events for the control.<br>@@ -281,17 +281,17 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name="control"&gt;The control whose binding complete events are to be registered.&lt;/param&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name="register"&gt;True to register the events, false to unregister them.&lt;/param&gt;<br>-&nbsp;&nbsp;&nbsp; private void RegisterBindingEvents(Control control, bool register)<br>+&nbsp;&nbsp;&nbsp; private void RegisterBindingEvents(IBindableComponent control, bool register)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (Binding binding in control.DataBindings)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (register)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; binding.BindingComplete += new BindingCompleteEventHandler(Control_BindingComplete);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; binding.BindingComplete += Control_BindingComplete;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; binding.BindingComplete -= new BindingCompleteEventHandler(Control_BindingComplete);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; binding.BindingComplete -= Control_BindingComplete;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>@@ -379,7 +379,7 @@<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; #region ISupportInitialize Interface<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp; private bool _isInitialising = false;<br>+&nbsp;&nbsp;&nbsp; private bool _isInitialising;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// BeginInit() is called when the component is starting to be initialised. BeginInit() simply sets the initialisation flag to true.<br>Index: Windows/ReadWriteAuthorization.cs<br>===================================================================<br>--- Windows/ReadWriteAuthorization.cs&nbsp;&nbsp;&nbsp; (revision 2235)<br>+++ Windows/ReadWriteAuthorization.cs&nbsp;&nbsp;&nbsp; (working copy)<br>@@ -138,15 +138,13 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bool couldRead = ctl.Enabled;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ctl.Enabled = true;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; binding.Format -= <br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new ConvertEventHandler(ReturnEmpty);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; binding.Format -= ReturnEmpty;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!couldRead) binding.ReadValue();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ctl.Enabled = false;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; binding.Format += <br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new ConvertEventHandler(ReturnEmpty);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; binding.Format += ReturnEmpty;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // clear the value displayed by the control<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyInfo propertyInfo = <br>@@ -213,13 +211,10 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; private static bool IsPropertyImplemented(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object obj, string propertyName)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (obj.GetType().GetProperty(propertyName,<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BindingFlags.FlattenHierarchy |<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BindingFlags.Instance |<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BindingFlags.Public) != null)<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return obj.GetType().GetProperty(propertyName,<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BindingFlags.FlattenHierarchy |<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BindingFlags.Instance |<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BindingFlags.Public) != null;<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp; }<br>&nbsp;}<br>Index: Wpf/Authorizer.cs<br>===================================================================<br>--- Wpf/Authorizer.cs&nbsp;&nbsp;&nbsp; (revision 2235)<br>+++ Wpf/Authorizer.cs&nbsp;&nbsp;&nbsp; (working copy)<br>@@ -24,7 +24,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; typeof(VisibilityMode), <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; typeof(Authorizer),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new FrameworkPropertyMetadata(VisibilityMode.Collapsed), <br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new ValidateValueCallback(IsValidVisibilityMode));<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsValidVisibilityMode);<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; // Define method to validate the value<br>&nbsp;&nbsp;&nbsp;&nbsp; private static bool IsValidVisibilityMode(object o)<br>@@ -85,8 +85,8 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name="prop"&gt;The data bound DependencyProperty.&lt;/param&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; protected override void FoundBinding(Binding bnd, FrameworkElement control, DependencyProperty prop)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetRead(bnd, (UIElement)control, _source);<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetWrite(bnd, (UIElement)control, _source);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetRead(bnd, control, _source);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetWrite(bnd, control, _source);<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; private void SetWrite(Binding bnd, UIElement ctl, IAuthorizeReadWrite source)<br>Index: Wpf/CslaDataProvider.cs<br>===================================================================<br>--- Wpf/CslaDataProvider.cs&nbsp;&nbsp;&nbsp; (revision 2235)<br>+++ Wpf/CslaDataProvider.cs&nbsp;&nbsp;&nbsp; (working copy)<br>@@ -24,8 +24,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _commandManager = new CslaDataProviderCommandManager(this);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _factoryParameters = new ObservableCollection&lt;object&gt;();<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _factoryParameters.CollectionChanged += <br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new System.Collections.Specialized.NotifyCollectionChangedEventHandler(_factoryParameters_CollectionChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _factoryParameters.CollectionChanged += _factoryParameters_CollectionChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; void _factoryParameters_CollectionChanged(<br>@@ -36,7 +35,7 @@<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; #region Properties<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp; private Type _objectType = null;<br>+&nbsp;&nbsp;&nbsp; private Type _objectType;<br>&nbsp;&nbsp;&nbsp;&nbsp; private bool _manageLifetime;<br>&nbsp;&nbsp;&nbsp;&nbsp; private string _factoryMethod = string.Empty;<br>&nbsp;&nbsp;&nbsp;&nbsp; private ObservableCollection&lt;object&gt; _factoryParameters;<br>@@ -157,13 +156,15 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; QueryRequest request = new QueryRequest();<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request.ObjectType = _objectType;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request.FactoryMethod = _factoryMethod;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request.FactoryParameters = _factoryParameters;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request.ManageObjectLifetime = _manageLifetime;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; QueryRequest request = new QueryRequest<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ObjectType = _objectType,<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FactoryMethod = _factoryMethod,<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FactoryParameters = _factoryParameters,<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ManageObjectLifetime = _manageLifetime<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; };<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (IsAsynchronous)<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (IsAsynchronous)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Threading.ThreadPool.QueueUserWorkItem(DoQuery, request);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DoQuery(request);<br>@@ -179,7 +180,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // get factory method info<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BindingFlags flags = BindingFlags.Static | BindingFlags.Public | BindingFlags.FlattenHierarchy;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; const BindingFlags flags = BindingFlags.Static | BindingFlags.Public | BindingFlags.FlattenHierarchy;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MethodInfo factory = request.ObjectType.GetMethod(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request.FactoryMethod, flags, null, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MethodCaller.GetParameterTypes(parameters), null);<br>@@ -241,22 +242,10 @@<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; private class QueryRequest<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private Type _objectType;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public Type ObjectType { get; set; }<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public Type ObjectType<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return _objectType; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set { _objectType = value; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string FactoryMethod { get; set; }<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private string _factoryMethod;<br>-<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string FactoryMethod<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return _factoryMethod; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set { _factoryMethod = value; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>-<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private ObservableCollection&lt;object&gt; _factoryParameters;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public ObservableCollection&lt;object&gt; FactoryParameters<br>@@ -265,14 +254,8 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set { _factoryParameters = <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new ObservableCollection&lt;object&gt;(new List&lt;object&gt;(value)); }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private bool _manageLifetime;<br>&nbsp;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public bool ManageObjectLifetime<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return _manageLifetime; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set { _manageLifetime = value; }<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>-&nbsp;&nbsp;&nbsp; <br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public bool ManageObjectLifetime { get; set; }<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; #endregion<br>Index: Wpf/DataDecoratorBase.cs<br>===================================================================<br>--- Wpf/DataDecoratorBase.cs&nbsp;&nbsp;&nbsp; (revision 2235)<br>+++ Wpf/DataDecoratorBase.cs&nbsp;&nbsp;&nbsp; (working copy)<br>@@ -85,8 +85,8 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; public DataDecoratorBase()<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.DataContextChanged += new DependencyPropertyChangedEventHandler(Panel_DataContextChanged);<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.Loaded += new RoutedEventHandler(Panel_Loaded);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.DataContextChanged += Panel_DataContextChanged;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.Loaded += Panel_Loaded;<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>@@ -132,7 +132,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; private void UnHookDataContextEvents(object oldValue)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // unhook any old event handling<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object oldContext = null;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object oldContext;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataSourceProvider provider = oldValue as DataSourceProvider;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (provider == null)<br>@@ -141,7 +141,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; provider.DataChanged -= new EventHandler(DataProvider_DataChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; provider.DataChanged -= DataProvider_DataChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oldContext = provider.Data;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UnHookPropertyChanged(oldContext as INotifyPropertyChanged);<br>@@ -155,7 +155,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; private void HookDataContextEvents(object newValue)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // hook any new event<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object newContext = null;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object newContext;<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataSourceProvider provider = newValue as DataSourceProvider;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (provider == null)<br>@@ -164,7 +164,7 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; provider.DataChanged += new EventHandler(DataProvider_DataChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; provider.DataChanged += DataProvider_DataChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newContext = provider.Data;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HookPropertyChanged(newContext as INotifyPropertyChanged);<br>@@ -178,39 +178,37 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; private void UnHookPropertyChanged(INotifyPropertyChanged oldContext)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (oldContext != null)<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oldContext.PropertyChanged -= new PropertyChangedEventHandler(DataObject_PropertyChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oldContext.PropertyChanged -= DataObject_PropertyChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; private void HookPropertyChanged(INotifyPropertyChanged newContext)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (newContext != null)<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newContext.PropertyChanged += new PropertyChangedEventHandler(DataObject_PropertyChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newContext.PropertyChanged += DataObject_PropertyChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; private void UnHookBindingListChanged(IBindingList oldContext)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (oldContext != null)<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oldContext.ListChanged -= new ListChangedEventHandler(DataObject_ListChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oldContext.ListChanged -= DataObject_ListChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; private void HookBindingListChanged(IBindingList newContext)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (newContext != null)<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newContext.ListChanged += new ListChangedEventHandler(DataObject_ListChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newContext.ListChanged += DataObject_ListChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; private void UnHookObservableListChanged(INotifyCollectionChanged oldContext)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (oldContext != null)<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oldContext.CollectionChanged -=<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new NotifyCollectionChangedEventHandler(DataObject_CollectionChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; oldContext.CollectionChanged -= DataObject_CollectionChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; private void HookObservableListChanged(INotifyCollectionChanged newContext)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (newContext != null)<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newContext.CollectionChanged +=<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new NotifyCollectionChangedEventHandler(DataObject_CollectionChanged);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; newContext.CollectionChanged += DataObject_CollectionChanged;<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; private void Panel_Loaded(object sender, RoutedEventArgs e)<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Skafa replied on Tuesday, April 01, 2008</h2><br>This won't work:<br><br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (child != null)<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!child.Equals(default(C)))<br><br>and<br><br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (field == null)<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (field.Equals(default(P)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (newValue != null)<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!newValue.Equals(default(P)))<br><br>etc.<br><br>if child/field or newValue IS null, a call to Equals() will fail with a NullReferenceException.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dpetrancuri replied on Tuesday, April 01, 2008</h2><P>What is all of this? And why is it posted in such a 'cryptic' manner?</P>
<P>The innately curious are dying to know.</P>
<P>Thank you.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, April 02, 2008</h2><P>He used a unified diff program to display the changes between files.</P>
<P>But it is important to remember that CSLA .NET is now around 8 years old, and has evolved rather a lot over that time. While I do dearly love to have clean, consistent code, it is also true that changing perfectly working code just to look better is an expensive proposition that comes with the risk of accidentally introducing bugs into code that has otherwise been working fine for years (and thus breaking people <EM>using</EM> CSLA .NET too).</P>
<P>So I clean code when I'm working with it, but I don't plan to do any wholesale cleaning/updating of code throughout the code base. The risk/expense is simply too high.</P>
<P>For example, the poster kindly showed the C# changes, but what about the VB changes? And as was pointed out, the changes would have introduced a bug. And I didn't look that closely, but I'm not sure the changes include consistent use of type inference, which I now believe to be a preferred coding approach.</P>
<P>I'm sure I'll do a&nbsp;bunch of code cleanup as I work through the code for the <EM>Expert 2008 Business Objects</EM> book, but even then it won't be gratuitous, because of the risk/expense.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
