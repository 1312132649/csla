<html><header><title>How to tigger PropertyStatus UpdateStatus on demand?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How to tigger PropertyStatus UpdateStatus on demand?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8497.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Andreas posted on Tuesday, February 09, 2010</h2><p><span lang="EN-US" style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;mso-bidi-font-size:11.0pt;mso-ansi-language:EN-US;">Hi,</span></p>
<p><span lang="EN-US" style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;mso-bidi-font-size:11.0pt;mso-ansi-language:EN-US;">I need a way&nbsp;</span><span lang="EN-US" style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;mso-bidi-font-size:11.0pt;mso-ansi-language:EN-US;">to delay the validation of properties for a&nbsp;web form like use case where the validation rules should be&nbsp;executed only</span></p>
<p><span lang="EN-US" style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;mso-bidi-font-size:11.0pt;mso-ansi-language:EN-US;">1. when a single property&nbsp;is changed during&nbsp;user input </span></p>
<p><span lang="EN-US" style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;mso-bidi-font-size:11.0pt;mso-ansi-language:EN-US;">2. On demand, for example the user wants to proceed to the next step by pressing the &ldquo;Next Step&rdquo;-Button.&nbsp;At that point&nbsp;at time all fields of the form should be validated and PropertyStatus should indicate broken rules to the user</span></p>
<p><span lang="EN-US" style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;mso-bidi-font-size:11.0pt;mso-ansi-language:EN-US;">The first one was easy: I set SuppressRuleChecking=true&nbsp;by overriding Child_Create</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;font-size:10pt;mso-bidi-font-size:11.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">protected</span> <span style="color:blue;">override</span> <span style="color:blue;">void</span> Child_Create()</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;font-size:10pt;mso-bidi-font-size:11.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;font-size:10pt;mso-bidi-font-size:11.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">this</span>.ValidationRules.SuppressRuleChecking = <span style="color:blue;">true</span>;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;font-size:10pt;mso-bidi-font-size:11.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">base</span>.Child_Create();</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;font-size:10pt;mso-bidi-font-size:11.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">this</span>.ValidationRules.SuppressRuleChecking = <span style="color:blue;">false</span>;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;font-size:10pt;mso-bidi-font-size:11.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p><span lang="EN-US" style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;mso-bidi-font-size:11.0pt;mso-ansi-language:EN-US;">But I couldn&rsquo;t figure out a way how to trigger UpdateStatus() later on without forcing a PropertyChanged events for each property. Calling CheckRules doesn&rsquo;t have any effect on PropertyStatus.&nbsp;Any ideas?</span></p>
<p><span lang="EN-US" style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;mso-bidi-font-size:11.0pt;mso-ansi-language:EN-US;">Regards,</span></p>
<p><span lang="EN-US" style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;mso-bidi-font-size:11.0pt;mso-ansi-language:EN-US;">Andreas</span><span lang="EN-US" style="line-height:115%;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;font-size:10pt;mso-bidi-font-size:11.0pt;mso-ansi-language:EN-US;">&nbsp;</span></p>
<p><span lang="EN-US" style="line-height:115%;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;font-size:10pt;mso-bidi-font-size:11.0pt;mso-ansi-language:EN-US;"></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Andreas replied on Wednesday, February 10, 2010</h2><p>Hi,</p>
<p>here is&nbsp;my&nbsp;fix to&nbsp;get the required behavior: I&nbsp;simply added/removed a ListChanged handler to&nbsp;the BrokenRulesCollection&nbsp;in&nbsp;AttachSource()/DetachSource()&nbsp;of PropertyStatus.cs. It does exactly what I want. Any problems related with it? If not,&nbsp;should it become a feature request for CSLA4?</p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">private</span> <span style="color:blue;">void</span> AttachSource(<span style="color:blue;">object</span> source)</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">this</span>._source = source;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">INotifyBusy</span> busy = source <span style="color:blue;">as</span> <span style="color:#2b91af;">INotifyBusy</span>;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (busy != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>busy.BusyChanged += <span style="color:blue;">new</span> <span style="color:#2b91af;">BusyChangedEventHandler</span>(source_BusyChanged);</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">INotifyPropertyChanged</span> changed = source <span style="color:blue;">as</span> <span style="color:#2b91af;">INotifyPropertyChanged</span>;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (changed != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>changed.PropertyChanged += <span style="color:blue;">new</span> <span style="color:#2b91af;">PropertyChangedEventHandler</span>(source_PropertyChanged);</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><strong><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">BusinessBase</span> businessObject = _source <span style="color:blue;">as</span> <span style="color:#2b91af;">BusinessBase</span>;</strong></span></p>
<p class="MsoNormal"><strong><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;color:blue;font-size:9pt;mso-bidi-font-size:12.0pt;mso-no-proof:yes;">if</span><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-no-proof:yes;"> (businessObject != <span style="color:blue;">null</span>)</span></strong></p>
<p class="MsoNormal"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-no-proof:yes;"><strong><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</strong></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><strong><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>businessObject.BrokenRulesCollection.ListChanged -= BrokenRulesCollection_ListChanged;</strong></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><strong><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>businessObject.BrokenRulesCollection.ListChanged += BrokenRulesCollection_ListChanged;</strong></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><strong><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</strong></span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">private</span> <span style="color:blue;">void</span> DetachSource(<span style="color:blue;">object</span> source)</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">INotifyBusy</span> busy = source <span style="color:blue;">as</span> <span style="color:#2b91af;">INotifyBusy</span>;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (busy != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>busy.BusyChanged -= <span style="color:blue;">new</span> <span style="color:#2b91af;">BusyChangedEventHandler</span>(source_BusyChanged);</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">INotifyPropertyChanged</span> changed = source <span style="color:blue;">as</span> <span style="color:#2b91af;">INotifyPropertyChanged</span>;</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (changed != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>changed.PropertyChanged -= <span style="color:blue;">new</span> <span style="color:#2b91af;">PropertyChangedEventHandler</span>(source_PropertyChanged);</span></p>
<p class="MsoNormal"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;">&nbsp;</span></p>
<h2 class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">BusinessBase</span> businessObject = _source <span style="color:blue;">as</span> <span style="color:#2b91af;">BusinessBase</span>;</span></h2>
<h2 class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span>(businessObject!=<span style="color:blue;">null</span>)</span></h2>
<h2 class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>businessObject.BrokenRulesCollection.ListChanged -= BrokenRulesCollection_ListChanged;</span></h2>
<h2 class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;">&nbsp;</span></h2>
<h2 class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>}</span></h2>
<h2 class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;">&nbsp;</span></h2>
<h2 class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">void</span> BrokenRulesCollection_ListChanged(<span style="color:blue;">object</span> sender, <span style="color:#2b91af;">ListChangedEventArgs</span> e)</span></h2>
<h2 class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-no-proof:yes;">{</span></h2>
<h2 class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">this</span>.UpdateState();</span></h2>
<h2 class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:12.0pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>}</span></h2>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Friday, February 12, 2010</h2><p>Try calling OnUnknownPropertyChanged() after CheckRules() - that should raise appropriate PropertyChanged events to get the PropertyStatus controls to update.</p>
<p>BrokenRulesCollection and its behavior will likely change quite a bit in CSLA 4, so I&#39;m not convinced it is wise to listen to its change events like that - it will probably cause some odd &quot;UI flicker&quot; effects in the future - though I can&#39;t say for sure since I haven&#39;t gotten quite that far in the business rules rewrite.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
