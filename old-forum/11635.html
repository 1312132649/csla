<html><header><title>Error after applying multi-property sort</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Error after applying multi-property sort</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11635.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>JasonG posted on Tuesday, October 09, 2012</h2><p>Hello, I wonder if this error (bottom of post)&nbsp;i&#39;m getting is &quot;normal&quot;. First I&#39;ll give you some background info.</p>
<p><br />I&#39;m using CSLA 4.3.</p>
<p>I have a Windows UI with a Datagridview that is databound to a SortedBindingList property. Because of a business rule the list is a DynamicBindingListBase&lt;Child&gt;.</p>
<p>I&#39;m using the SortedBindingList so that the user can also sort by clicking the column headers.</p>
<p>Everythings works until after I apply the sort. After considerable searching the only way I found to do a multi-propery search is using Dynamic Linq. </p>
<p>But the problem if I sort using Dynamic Linq I get this error. Should I be expecting this? or is there something I&#39;m doing wrong?</p>
<p>This is how I implement the sort..</p>
<p>bindingSource.DataSource = New SortedBindingList&lt;child&gt;(data.AsQueryable().OrderBy(&quot;&quot;).ToList());</p>
<p>I know there has been numberous post regarding sorting and Dynamic Linq, and I&#39;ve read them all hoping to find an answer or something that would lead me in the right direction but I found nothing that helped.</p>
<p>This is the error that&nbsp;I get.</p>
<p><img src="http://ca.f1610.mail.yahoo.com/ya/download?mid=2%5f0%5f0%5f1%5f233525%5fAOHci2IAAVyAUGxIcQZh90xyIkk&amp;pid=2&amp;fid=Inbox&amp;inline=1&amp;appid=YahooMailNeoCL" id="yui_3_2_0_1_1349788618417141" alt="" /></p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, October 09, 2012</h2><p>You can use linq for all the filtering and sorting - however you must add the code to sort and wont get it automatically. </p>
<p>You can also use MultiColumn sorting in SortedBindingList by implementing you own PropertyDescriptor class that will return a GetValue combined of several fields.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JasonG replied on Tuesday, October 09, 2012</h2><p>thanks for your reply. </p>
<p>The sort actually works using linq, but I eventually get this error. </p>
<p>Could you&nbsp;give me a&nbsp;simple example of how i could implement a PropertyDescriptor class?</p>
<p>thanks.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, October 09, 2012</h2><p>I had a chat with the developer that actually did this and he chose to implement this a &quot;virtual&quot; MultiSortProperty that can be defined in the list and implement IComparable so that he can compare each individual property of the correct type. That is also under the assumption that it a type of &quot;pre-defined&quot; sortorder that the list should/could have knowledge of and maybe even specify sortorder per field. </p>
<p><i>using System;<br />using System.Collections.Generic;<br />using System.ComponentModel;<br /><br />namespace MyBusiness.Logic<br />{<br />&nbsp;&nbsp;&nbsp; public class MultiSortProperty : IComparable<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #region Private properties<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly List&lt;IComparable&gt; _properties;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private readonly List&lt;ListSortDirection&gt; _directions;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #endregion<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #region Public properties<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int PropertyCount<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return _properties.Count; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #endregion<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #region Constructors<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public MultiSortProperty()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _properties = new List&lt;IComparable&gt;();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _directions = new List&lt;ListSortDirection&gt;();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public MultiSortProperty(IComparable one, IComparable two) : this()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddProperty(one, ListSortDirection.Ascending);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddProperty(two, ListSortDirection.Ascending);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public MultiSortProperty(IComparable one, IComparable two, ListSortDirection directionOne, ListSortDirection directionTwo)&nbsp; : this()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddProperty(one, directionOne);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddProperty(two, directionTwo);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public MultiSortProperty(IComparable one, IComparable two, IComparable three)&nbsp; : this()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddProperty(one, ListSortDirection.Ascending);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddProperty(two, ListSortDirection.Ascending);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddProperty(three, ListSortDirection.Ascending);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public MultiSortProperty(IComparable one, IComparable two, IComparable three, IComparable four): this()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddProperty(one, ListSortDirection.Ascending);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddProperty(two, ListSortDirection.Ascending);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddProperty(three, ListSortDirection.Ascending);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddProperty(four, ListSortDirection.Ascending);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public MultiSortProperty(IComparable one, IComparable two, IComparable three, ListSortDirection directionOne, ListSortDirection directionTwo, ListSortDirection directionThree) : this()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddProperty(one, directionOne);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddProperty(two, directionTwo);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddProperty(three, directionThree);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public MultiSortProperty(IComparable one, IComparable two, IComparable three,IComparable four, ListSortDirection directionOne, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ListSortDirection directionTwo, ListSortDirection directionThree , ListSortDirection directionFour) : this()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddProperty(one, directionOne);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddProperty(two, directionTwo);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddProperty(three, directionThree);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddProperty(four, directionFour);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #endregion<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #region Business methods<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public void AddProperty(IComparable element, ListSortDirection direction)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _properties.Add(element);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _directions.Add(direction);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public IComparable GetProperty(int index)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return _properties[index];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public IComparable GetListSortDirection(int index)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return _directions[index];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private int CompareToRecursive(MultiSortProperty that, int i)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Make sure we have identical objects<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (that == null || that._properties.Count != _properties.Count) return -1;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var res = _properties<img src="http://forums.lhotka.net/emoticons/emotion-55.gif" alt="Idea" />.CompareTo(that._properties<img src="http://forums.lhotka.net/emoticons/emotion-55.gif" alt="Idea" />);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (res == 0)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // They equal, check next property in list<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_properties.Count &gt; i + 1) return CompareToRecursive(that, i + 1);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return 0; // All elements equal<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // They don&#39;t equal - return 1 or -1 depending on ListSortDirection<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_directions<img src="http://forums.lhotka.net/emoticons/emotion-55.gif" alt="Idea" /> == ListSortDirection.Descending) res = 0 - res;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return res;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #endregion&nbsp; <br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #region IComparable Members<br />&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int CompareTo(object obj)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_directions.Count == 0) return 0;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var that = obj as MultiSortProperty;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (that == null) return -1;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return CompareToRecursive(that, 0);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #endregion<br />&nbsp;&nbsp;&nbsp; }<br />}<br /></i><br />Usage in a list:<br /><i>&nbsp; public MultiSortProperty MyMultiSortProperty<br />&nbsp; {<br />&nbsp;&nbsp; get { return new MultiSortProperty(Property1, Property2, Property3); }<br />&nbsp; }<br /></i>&nbsp; <br />And then apply sort on the list field<br /><i>&nbsp; &lt;sortedBindingList&gt;.ApplySort(MyMultiSortProperty);<br /></i></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JasonG replied on Tuesday, October 09, 2012</h2><p>this is good, thanks.</p>
<p>but i have a couple futher questions due to my lack of&nbsp;programming knowledge. </p>
<p>What do you mean by &quot;usage in a list&quot;? you mean add this property to the child class or the DynamicBindingListBase class or something else? Also, the SortBindingList I&#39;m using doesn&#39;t accept &quot;MyMultiSortProperty&quot; has a parameter.</p>
<p>thanks. </p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, October 09, 2012</h2><p>You add the MultiSortProperty to the item in the list. </p>
<p>The use the MultiSortProperty.Name as input to the ApplySort method.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dg78 replied on Wednesday, February 20, 2013</h2><p>Hello Jonny,</p>
<p>I try to convert your code in VB and I have a problem with the lines :</p>
<p><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var res = _properties<img src="http://forums.lhotka.net/emoticons/emotion-55.gif" alt="Idea" />.CompareTo(that._properties<img src="http://forums.lhotka.net/emoticons/emotion-55.gif" alt="Idea" />);<br /><br />...<br /></em><em>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_directions<img src="http://forums.lhotka.net/emoticons/emotion-55.gif" alt="Idea" /> == ListSortDirection.Descending) res = 0 - res;</em></p>
<p>what is the bright idea&nbsp;&nbsp;<img src="http://forums.lhotka.net/emoticons/emotion-55.gif" alt="Idea" />&nbsp; ?</p>
<p>Thanks in advance for help </p>
<p>Dominique</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dg78 replied on Wednesday, February 20, 2013</h2><p>I found the answer :&nbsp;&nbsp; i replace the idea by&nbsp; (i),&nbsp; IE change (i) by the symbol &#39;idea&#39;</p>
<p>and it is OK</p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp; </span><span style="color:blue;">Private</span> <span style="color:blue;">Function</span> CompareToRecursive(<span style="color:blue;">ByVal</span> that <span style="color:blue;">As</span> MultiSortProperty, <span style="color:blue;">ByVal</span> i <span style="color:blue;">As</span> <span style="color:blue;">Integer</span>) <span style="color:blue;">As</span> <span style="color:blue;">Integer</span></span></i></p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:green;">&#39; Make sure we have identical objects</span></span></i></p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">If</span> that <span style="color:blue;">Is</span> <span style="color:blue;">Nothing</span> <span style="color:blue;">OrElse</span> that._properties.Count &lt;&gt; _properties.Count <span style="color:blue;">Then</span></span></i></p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Return</span> -1</span></i></p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">End</span> <span style="color:blue;">If</span></span></i></p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Dim</span> res <span style="color:blue;">As</span> <span style="color:blue;">Integer</span> = _properties(i).CompareTo(that._properties(i))</span></i></p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">If</span> res = 0 <span style="color:blue;">Then</span></span></i></p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:green;">&#39; They equal, check next property in list</span></span></i></p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">If</span> _properties.Count &gt; i + 1 <span style="color:blue;">Then</span></span></i></p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Return</span> CompareToRecursive(that, i + 1)</span></i></p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">End</span> <span style="color:blue;">If</span></span></i></p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:green;">&#39; All elements equal</span></span></i></p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Return</span> 0</span></i></p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">End</span> <span style="color:blue;">If</span></span></i></p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:green;">&#39; They don&#39;t equal - return 1 or -1 depending on ListSortDirection</span></span></i></p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">If</span> _directions(i) = ListSortDirection.Descending <span style="color:blue;">Then</span></span></i></p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>res = 0 - res</span></i></p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">End</span> <span style="color:blue;">If</span></span></i></p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Return</span> res</span></i></p>
<p class="MsoNormal"><i style="mso-bidi-font-style:normal;"><span lang="EN-US" style="line-height:115%;font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp; </span></span></i><i style="mso-bidi-font-style:normal;"><span style="line-height:115%;font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-no-proof:yes;">End</span></i><i style="mso-bidi-font-style:normal;"><span style="line-height:115%;font-family:&#39;Courier New&#39;;font-size:8pt;mso-no-proof:yes;"> <span style="color:blue;">Function</span></span></i><i style="mso-bidi-font-style:normal;"><span lang="EN" style="line-height:115%;font-size:8pt;mso-ansi-language:EN;"></span></i></p>
<p>Wonderful code</p>
<p>Thanks Jonny</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
