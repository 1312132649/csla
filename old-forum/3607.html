<html><header><title>Binding EditableRootListBase objects to DataGridView</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Binding EditableRootListBase objects to DataGridView</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3607.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bob posted on Thursday, September 27, 2007</h2><P>I have a collection of objects based on EditableRootListBase each object being based on BusinessBase.</P>
<P>I retrieve a collection from the db and bind it to a data grid view. On editing I add a row which violates the business rules and the errors show on the dgv margins as the should.</P>
<P>However if I advance off the row with the invalid data the Save() method is called on the object which then throws an unhandled exception because IsValid is false. </P>
<P>I have tried to couple the object IsValid property to the dgv's validating and rowvalidate events but the object Save method seems to be called before the events.</P>
<P>Of course I can override the Save method and only call the base method if IsValid is true but then the grid allows me to keep on adding several invalid rows.</P>
<P>Obviously I'm doing something very wrong. Any ideas what?</P>
<P>&nbsp;</P>
<P>Bob</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tetranz replied on Thursday, September 27, 2007</h2>I think this has come up before and there is no perfect answer. I haven't used <span id="ctl00_ctl01_bcr_PostForm___ForumDescription">DataGridView for a while so I don't remember if it shows errors exposed via </span>IDataErrorInfo.<br>
<br>
I'm using the Janus grid and I override SaveItem in the collection so that it only attempts to save if the child is valid. That works pretty well
because the user sees the red exclaimation points indicating errors and
they know that anything with an error has not been saved.<br>
<br>
Ross<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tray replied on Sunday, September 30, 2007</h2><P><FONT face=Arial size=2>Hi Bob,</FONT></P>
<P><FONT face=Arial size=2>The DataGridView does have a DataError event which is fired if&nbsp;the bound&nbsp;object throws an exception when the control calls code in the object (in your case, the Save method on the object is throwing an exception when it tries to save an invalid object).<BR>If you use this event, you can catch the exception and handle it (maybe popping up a messagebox to the user to inform them that the item is not valid and cannot be saved and displaying the errors). Check out <A href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.datagridview.dataerror.aspx">http://msdn2.microsoft.com/en-us/library/system.windows.forms.datagridview.dataerror.aspx</A>.</FONT></P>
<P><FONT face=Arial size=2>If you want to be able to leave the invalid object in the DGV, you may want to follow tetranz idea. This would be a perfectly usable solution. Note that the user may think that they have been able to save an invalid object, which is not the case.</FONT></P>
<P><FONT face=Arial size=2>Hope this helps<BR>Tray</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jhw replied on Sunday, September 30, 2007</h2><P>I have tried both ways, handling datarow error and overriding save to handle invlalid state. In the end I went with handling the datarow error. If the object throws another error(like a database constraint), then it will be an unhandled exception unless you handle the dataerror event. </P>
<P>&nbsp;</P>
<P>Heath</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Devi replied on Tuesday, March 25, 2008</h2><P>I&nbsp;am also using a DataGridView with EditableRootListBase class. And used DataError event of DataGridView. While deleting it catches an exception related to database. Till this event it working properly.. </P>
<P>But after that when&nbsp;I clicking another row in the Grid, it shows an DataPortal.Update Error while working DataPortal.Delete method. This method working with the same data that of&nbsp;I clicked first time in the grid for deleting....</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
