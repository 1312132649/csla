<html><header><title>Unhandled CommunicationException in Silverlight 3-Tier App</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Unhandled CommunicationException in Silverlight 3-Tier App</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10297.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>thaehn posted on Friday, April 22, 2011</h2><p>I am writing a 3-tier Silverlight app.&nbsp; I fetch the data from the database and return the result back to the UI app and get a CommunicationException in this EndFetch method of the Service Reference class (Reference.cs):</p>
<p>System.ServiceModel.CommunicationException was unhandled by user code<br />&nbsp; Message=An error occurred while trying to make a request to URI &#39;http://localhost:56515/WcfSlPortal.svc&#39;. This could be due to attempting to access a service in a cross-domain way without a proper cross-domain policy in place, or a policy that is unsuitable for SOAP services. You may need to contact the owner of the service to publish a cross-domain policy file and to ensure it allows SOAP-related HTTP headers to be sent. This error may also be caused by using internal types in the web service proxy without using the InternalsVisibleToAttribute attribute. Please see the inner exception for more details.<br />&nbsp; StackTrace:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.AsyncResult.End[TAsyncResult](IAsyncResult result)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Channels.ServiceChannel.EndCall(String action, Object[] outs, IAsyncResult result)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.ClientBase`1.ChannelBase`1.EndInvoke(String methodName, Object[] args, IAsyncResult result)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.WcfPortal.WcfPortalClient.WcfPortalClientChannel.EndFetch(IAsyncResult result)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.WcfPortal.WcfPortalClient.Csla.WcfPortal.IWcfPortal.EndFetch(IAsyncResult result)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.WcfPortal.WcfPortalClient.OnEndFetch(IAsyncResult result)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.ClientBase`1.OnAsyncCallCompleted(IAsyncResult result)<br />&nbsp; InnerException: System.Security.SecurityException<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Message=&quot;&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StackTrace:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Net.Browser.AsyncHelper.BeginOnUI(SendOrPostCallback beginMethod, Object state)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Net.Browser.BrowserHttpWebRequest.EndGetResponse(IAsyncResult asyncResult)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Channels.HttpChannelFactory.HttpRequestChannel.HttpChannelAsyncRequest.CompleteGetResponse(IAsyncResult result)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InnerException: System.Security.SecurityException<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Message=Security error.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StackTrace:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Net.Browser.BrowserHttpWebRequest.InternalEndGetResponse(IAsyncResult asyncResult)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Net.Browser.BrowserHttpWebRequest.&lt;&gt;c__DisplayClass5.&lt;EndGetResponse&gt;b__4(Object sendState)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Net.Browser.AsyncHelper.&lt;&gt;c__DisplayClass4.&lt;BeginOnUI&gt;b__1(Object sendState)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InnerException:</p>
<p>Any ideas what I am doing wrong?</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Friday, April 22, 2011</h2><p>The exception contains the answer:</p>
<p>&quot;An error occurred while trying to make a request to URI &#39;http://localhost:56515/WcfSlPortal.svc&#39;. <strong>This could be due to attempting to access a service in a cross-domain way </strong>without a proper cross-domain policy in place, or a policy that is unsuitable for SOAP services. <strong>You may need to contact the owner of the service to publish a cross-domain policy file and to ensure it allows SOAP-related HTTP headers to be sent.</strong>&quot;</p>
<p>If you call a service located at a different URL than the location the SL app came from, that other service needs a cross-domain policy file. You can find numerous examples of this file in the CSLA samples, or with a simple Internet search.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>thaehn replied on Friday, April 22, 2011</h2><p>Rocky,</p>
<p>It is running&nbsp;from the same web project as the silverlight control (the one auto generated when the silverlight project was created).&nbsp; It is all running on the development server in Visual Studio.</p>
<p>Todd</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Saturday, April 23, 2011</h2><p>The most common issue is that it is the SL project that is set as the startup project, not the web project. In that case Visual Studio runs the SL app in a separate URL from the web app, causing the issue you are seeing.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>thaehn replied on Monday, April 25, 2011</h2><p>Rocky,</p>
<p>That was not the problem.&nbsp; I had the wrong port number on one of the endpoints in the web config file, which when corrected fixed the problem.&nbsp; Thank you for your help.&nbsp; I appreciate the way you monitor this forum and respond to questions so quickly.&nbsp; When&nbsp;I am hung up on a problem and can&#39;t go on, it&nbsp;is very frustrating.</p>
<p>Todd</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
