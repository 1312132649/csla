<html><header><title>Using LINQ to sort a ReadOnly list</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Using LINQ to sort a ReadOnly list</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8587.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ballistic posted on Saturday, February 27, 2010</h2><p>I have CountryInfoList which is a ReadOnlyListBase&lt;CountryInfoList, ICountryInfo&gt;. This class implements both it&#39;s own interface ICountryInfoList and IReportTotalRowCount.<br /><br />I am attempting to sort a list of type ICountryInfoList using LINQ, but get &quot;Can&#39;t resolve symbol OrderBy&quot;<br /><br />I am using Dependency Injection to resolve the ICountryInfoList to the concrete implementation CountryInfoList.<br /><br />var unsortedList = IoC.Resolve&lt;ICountryInfoList&gt;().FindActive(languageCode, args);<br /><br />var query = from j in unsortedList<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; orderby j.NameByLanguage<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; select j;<br /><br />If I change it from having IoC resolve the interface and instead create an instace of CountryInfoList and call it&#39;s FindActive(languageCode, args), the query will work.</p>
<p>It looks that by having the interface, I am removing some functionality.<br /><br />Is there a specific way I am suppose to have the interface so that LINQ can work against the returned list?</p>
<p>&nbsp;- Andy</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>tmg4340 replied on Sunday, February 28, 2010</h2><p>LINQ is designed to work against some collection interfaces - IEnumerable&lt;T&gt;, IQueryable&lt;T&gt;, etc.&nbsp; So if you want your ICountryInfoList interface to work in LINQ, it needs to derive from one of those interfaces (I would probably choose IEnumerable&lt;T&gt;.)&nbsp; I think that also means your ICountryInfoList interface will need to be a generic interface as well.&nbsp; While your IOC tool should be able to handle that well enough, that obviously changes how you work with it in your app.</p>
<p>HTH</p>
<p>- Scott</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ballistic replied on Sunday, February 28, 2010</h2><p>CountryInfoList uses the ReadOnlyListBase, which itself has 
&quot;IEnumerable&lt;C&gt; Where&quot;, having&nbsp; CountryInfoList inherit from 
ReadOnlyListBase&lt;CountryInfoList, ICountryInfo&gt; does provide me 
the functionality. However, when I start returning list of my own 
interface (ICountryInfoList), that&#39;s when I loose the LINQ 
functionality.</p>
<p>I tried to have my ICountryInfoList implement IEnumerable&lt;ICountryInfo&gt;, but obviously I need to define each of the methods in the interface (Current, Reset, MoveNext, etc). </p>
<p>Is there a way I can leverage the functionality built into CSLA and not have to define each of the methods in my CountryInfoList which would simple call the methods in the base class? (looks like simply implementing IReadOnlyCollection does not do it)</p>
<p>Sorry if these questions are obvious, but first time I try to work with interfaces (for testing purposes) and LINQ (since SortedBindingList has now been replaced by LINQ).</p>
<p>Thank you,<br /> - Andy</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>tmg4340 replied on Sunday, February 28, 2010</h2><p>You won&#39;t try to implement the interface on your ICountryInfoList interface.&nbsp; You would turn it into a generic interface and have it derive from IEnumerable - something like this:</p>
<p><code>interface ICountryInfoList&lt;T&gt; : IEnumerable&lt;T&gt;</code></p>
<p>That way, you can assign ROLB-based objects to your interface, and you can also use your&nbsp;interface in LINQ queries.&nbsp; ROLB has an implementation of IEnumerable&lt;T&gt; already, so everything will just work.</p>
<p>Where this is going to potentially &quot;get you&quot; is that your interface is now a generic interface, so you have to provide a type.&nbsp; Given how your ROLB list is defined, that type can probably be ICountryInfo, but that&#39;s a guess - I&#39;d have to see a little more of how you&#39;re using it to really know that for sure.&nbsp; Regardless, your IOC container should be able to resolve the&nbsp;generic type easily enough.&nbsp; But&nbsp;this also changes how you&nbsp;work with&nbsp;your interface in your app.</p>
<p>HTH</p>
<p>- Scott</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
