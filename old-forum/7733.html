<html><header><title>Test Class Assert.AreEqual Fails</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Test Class Assert.AreEqual Fails</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7733.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dentjas posted on Tuesday, October 06, 2009</h2><br>I am creating a TestClass for a child business object.<br>I am using CSLA version 3.5<br><br>Parent Class: Survey<br>Collection of Children located on the Parent: QuestionnaireCollection<br>Child Class: Quesitonnaire<br><br>Here are the steps I take.<br><br>I create a new Survey called Parent<br>I create a new Questionnaire called target<br>I add this new questionnaire to the QuestionnaireCollection located on the Survey.<br><br>target = parent.Questionnaires.AddNew(parent.Id)<br><br>Now, I add the properties to the questionnaire and save the Survey to the database.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim temp As Survey = parent.Clone()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; parent = temp.Save()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; target = parent.Questionnaires(0)<br><br>I set target = to the questionniare I just saved.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; target = parent.Questionnaires(0)<br><br>Now I get the info I just saved to the DB and store it in target2<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim getSurvey As Survey = Survey.GetSurvey(parent.Id)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim target2 As Questionnaire = getSurvey.Questionnaires(0)<br><br>Now I call the following<br><br>Assert.AreEqual(target, target2, "New Questionnaire did not save correctly to the database")<br><br>For some reason the Assert.AreEqual always fails. When I do a DIFF on target and target2<br>_readresultcache and _WriteResutlCache variables never appear to be equal.<br><br>Not sure what these are for and why they would be different.<br><br>Any help would be much appreciated.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Tuesday, October 06, 2009</h2><P>I suggest comparing specific properties of the Questionnaire BOs to each other. Like ID and description or something. Rather than the entire BO.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dentjas replied on Thursday, October 08, 2009</h2>Thanks for the suggestion. If I can't figure out how to fix it, I will need to go to this solution. However, it would be much simpler if I could figure out why it isn't working. <br>I have manually verified that everything that is saved and retrieved from the database (all the properties I have created for this business object) are equal. It is properties I didn't create or care about that are causing the problem.<br><br>Thanks<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, October 09, 2009</h2><P>In earlier versions of CSLA Rocky created GetIDValue so that he could provide overrides as base class methos for Equals among other simple methods. He had to abandon this concept when WPF came out as Microsoft changed the way they define Equals. If it was not the same reference then MS compared every single value of one object to the other (sounds like what you are experiencing.) Rocky argued forcefully for the concept of logical equality (two objects with the same ID property are Equal) but lost. </P>
<P>That is why I suggested you compare key property values yourself.</P>
<P>Joe</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
