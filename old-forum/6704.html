<html><header><title>Recommended pattern for returning server-side broken rules to client?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Recommended pattern for returning server-side broken rules to client?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6704.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 posted on Tuesday, March 31, 2009</h2><P>Since CSLA moved toward auto-cloning and saving of the clone object while leaving the original untouched, I'm trying to find the best way to handle the special case where an object appears "valid" before being sent&nbsp;over the data portal, and then server-side rules are run and the object is broken on the server. </P>
<P>Throwing an exception is apparently useless, because when you do this the broken object isn't returned to the client.</P>
<P>For now, I've implemented this via a CommandBase derived class that will ferry the BO over to the server, attempt to save it, and return both the broken BO and result of the save operation. It catches any exception thrown server side, rolls back the transaction, and returns the broken BO,&nbsp; indication of success/failure, and the exception itself, if serializable. This is exposed from our base BO class as an instance method:</P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>bool</FONT></FONT><FONT size=2> Save(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>out</FONT></FONT><FONT size=2> T resultBO, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>out</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Exception</FONT></FONT><FONT size=2> e)...</FONT></P>
<P><FONT size=2>How are others handling this type of requirement?</FONT></P>
<P><FONT size=2><FONT size=3></FONT>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, March 31, 2009</h2><P>When you throw an exception on the server, the object <EM>is returned to the client</EM> through the DataPortalException.</P>
<P>The object graph, as it was when the exception occurred, is returned as a property of the exception so it is available to client-side code (most notably your factory method or Save() override).</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Tuesday, March 31, 2009</h2><P>How did I miss that?&nbsp; That's perfect, as long as any exception thrown server-side during a normal Create/Update/Delete type operation&nbsp;ends up wrapped in a DataPortalException. </P>
<P>Thanks for straightening me out.. </P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
