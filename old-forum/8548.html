<html><header><title>DataPortal.Update failed System.Data.SqlClient.SqlException: Timeout expired</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>DataPortal.Update failed System.Data.SqlClient.SqlException: Timeout expired</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8548.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Softech posted on Wednesday, February 17, 2010</h2><p>I am using CSLA 3.0 and .Net Framework 3.0. I&nbsp;am working in Siliverlight application references to WCF&nbsp;service&nbsp;and WCF service&nbsp;references to CSLA classes. My application runs successfully, Insert and update running successfully but sometime I am getting this error of Timeout in DataPortal.Update. When I debug the code Error comes at <br /><br /><span style="font-size:x-small;color:#0000ff;"><span style="font-size:x-small;color:#0000ff;">private</span></span><span style="font-size:x-small;color:#0000ff;"><span style="font-size:x-small;color:#0000ff;">void&nbsp;</span></span><span style="font-size:x-small;">DataPortal_Insert()<br /></span><span style="font-size:x-small;">{<br /></span><span style="font-size:x-small;">...<br /></span><span style="font-size:x-small;">database.ExecuteNonQuery(command);<br /></span>}<br /><br />DataPortal.Update failed (System.Data.SqlClient.SqlException: Timeout expired.&nbsp; The timeout period elapsed prior to completion of the operation or the server is not responding.<br />&nbsp;&nbsp; at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)<br />&nbsp;&nbsp; at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)<br />&nbsp;&nbsp; at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj)<br />&nbsp;&nbsp; at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)<br />&nbsp;&nbsp; at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)<br />&nbsp;&nbsp; at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async)<br />&nbsp;&nbsp; at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, DbAsyncResult result)<br />&nbsp;&nbsp; at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe)<br />&nbsp;&nbsp; at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()<br />&nbsp;&nbsp; at ExecuteNonQuery(SqlCommand command) in C:\Projects\OrderMIS\CSLA\Framework\Data\SqlDatabase.cs:line 439<br />&nbsp;&nbsp; at OrderDAL.Customers.DataPortal_Insert() in C:\Projects\OrderMIS\OrderDAL\Customers.cs:line 433)</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Marjon1 replied on Wednesday, February 17, 2010</h2><p>Have you attempted to time the command when run manually?&nbsp;</p>
<p>The default timeout is 30 seconds, you could try to set the CommandTimeout property to be a higher value (or for testing purposes, set it 0 for infinite timeout).</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Softech replied on Wednesday, February 17, 2010</h2><p>Please give me some hint of code where and in which file&nbsp;to set CommandTimeout property.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Marjon1 replied on Wednesday, February 17, 2010</h2><p>Somewhere within your code, I assume that there will a line where the commandText for the commandObject will be set.</p>
<p>The code <i><b>may </b></i><b><i>look like this </i></b>with in your DataPortal_Update()</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;Using cm As SqlCommand = cn.Connection.CreateCommand</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;With cm</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.CommandText = &quot;[hrm].[mergeNote]&quot;</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.CommandType = CommandType.StoredProcedure</p>
<p><strong>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.CommandTimeout = 60</strong></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.Parameters.AddWithValue(&quot;@EmployeeId&quot;, EmpId)</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.Parameters.AddWithValue(&quot;@Note&quot;, _Note)</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.ExecuteNonQuery()</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;End With</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp;End Using</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Gort replied on Wednesday, January 25, 2012</h2><p>Is it possible to change the default CommandTimeout value of the SqlCommand object via the config file?&nbsp; Our connection string has a timeout value in it which is not honored by the SqlCommand.&nbsp; I don&#39;t want to have to manually change every use of the SqlCommand object in order to increase my default timeout from 30 to 60.</p>
<p>Thanks.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, January 25, 2012</h2><p>One easy solution is to use a factory object/method to create your command:</p>
<p style="padding-left:30px;">public static class CommandFactory<br />{<br />&nbsp; public static SqlCommand GetCommand(SqlConnection cn)<br />&nbsp; {<br />&nbsp;&nbsp;&nbsp; var result = cn.CreateCommand();<br />&nbsp;&nbsp;&nbsp; // initialize command here<br />&nbsp;&nbsp;&nbsp; return result;<br />&nbsp; }<br />}</p>
<p>Then just use this method to create your commands app-wide.</p>
<p>Of course maybe not so easy if you already have a lot of code in your codebase...</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Gort replied on Tuesday, March 06, 2012</h2><p>We are getting our SQL timeout errors with the following message: <span style="line-height:115%;font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;font-size:11pt;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:&#39;Times New Roman&#39;;mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA;"><em>DataPortal.Fetch failed (Timeout expired.<span style="mso-spacerun:yes;">&nbsp; </span>The timeout period elapsed prior to completion of the operation or the server is not responding.)</em><span style="mso-spacerun:yes;">&nbsp; </span></span></p>
<p><span style="line-height:115%;font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;font-size:11pt;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:&#39;Times New Roman&#39;;mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA;"><span style="mso-spacerun:yes;">Is it possible to update the code to&nbsp;be able to tell what object is actually failing?&nbsp; </span></span></p>
<p><span style="line-height:115%;font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;font-size:11pt;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:&#39;Times New Roman&#39;;mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA;"><span style="mso-spacerun:yes;"></span></span></p>
<p><span style="line-height:115%;font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;font-size:11pt;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:&#39;Times New Roman&#39;;mso-bidi-theme-font:minor-bidi;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA;"><span style="mso-spacerun:yes;">Tks.</span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, March 06, 2012</h2><p>The inner exception might provide you with that information. There&#39;s usually a lot of info deeper in the exception tree.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
