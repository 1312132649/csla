<html><header><title>email regex</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>email regex</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/205.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka posted on Thursday, May 25, 2006</h2>From what I've seen on the regex web sites, I'm risking life and limb by asking this question - but here goes...<br><br>The regex I used in CommonRules to validate email addresses is not quite right, because it only works against upper-case email addresses. I could fix this in RegExMatch() by upper-casing the property value, but that would be a hack.<br><br>This is the regex I am using:<br><br>\b[A-Z0-9._%-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b<br><br>Is there a better expression that works for all email addresses - including lower-case ones?<br>&nbsp;I'm not a regex person - but would this work?<br><br>\b[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}\b<br><br>or is that total garbage?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cds replied on Thursday, May 25, 2006</h2><P>Hey Rocky</P>
<P>From what I know of regex expressions that should work fine. </P>
<P>Don't get too worried about them - they're very elegant but the syntax is hardly rememberable. I used to teach them to students a dozen or so years ago and I always have to look them up, and it's always trial and error to get them right unless you're using them on a daily basis.</P>
<P>Craig</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tetranz replied on Thursday, May 25, 2006</h2>Here's what I've been happily using for a few years.<br><br>(([A-Za-z0-9]+_+)|([A-Za-z0-9]+\-+)|([A-Za-z0-9]+\.+)|([A-Za-z0-9]+\++))*[A-Za-z0-9]+@((\w+\-+)|(\w+\.))*\w{1,63}\.[a-zA-Z]{2,6}<br><br>I think it came from a regex recipe site. I've never really tried to understand it.<br><br>I have heard rumors and folklore about addresses of the form x@xx which are theoretically possible if someone puts an MX on the TLD for a country. The above regex fails on those but so far it hasn't been a problem. <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /><br><br>Cheers<br>Ross<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>zythra replied on Thursday, May 25, 2006</h2>Here is one I've used and have written several tests against:<br><br>^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$<br><br>Handles upper and lower casing as well as allowed positioning of numbers within an address.&nbsp; The following is a list of some variations that pass and fail with it:<br><br>Pass:<br>john_smith@domain.com<br>john.smith@domain.com.au<br><br>Fail:<br>john_smith.domain.com.au<br>john smith@domain.com.au<br>john_smith@domain<br>john_smith@<br><br>It's long and ugly, but I've never gotten a false positive or negative with it.&nbsp; <br><br>Ross' looks like it would probably do a good job as well.<br><br>Dustin<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fabio replied on Thursday, May 25, 2006</h2>I find this one<br>^[a-zA-Z][\w\.-]*[a-zA-Z0-9]@[a-zA-Z0-9][\w\.-]*[a-zA-Z0-9]\.[a-zA-Z][a-zA-Z\.]*[a-zA-Z]$<br><br>bye.<br>Fabio.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pfeds replied on Friday, May 26, 2006</h2><P>Well that would explain why my e-mail property was invalid when I tried that yesterday ;o)</P>
<P>Rocky, as you said, the following RegEx would solve the upper/lowercase issue:</P>
<P>\b[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}\b<BR></P>
<P>The problem I find&nbsp;with RegExes that you find on the internet is that they are normally over complex and long-winded.&nbsp; I *think* the above RegEx would resolve almost all e-mail addresses (I can't think of any exceptions to the rule).</P>
<P>A tool that I find very useful (and very usefully free)&nbsp;is the Sells Brothers RegexDesigner, which can be found here:</P>
<P><A href="http://www.sellsbrothers.com/tools/#regexd">http://www.sellsbrothers.com/tools/#regexd</A></P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pfeds replied on Friday, May 26, 2006</h2><P>Infact, this would be better:</P>
<P>^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$</P>
<P>This is because the previous regex would validate something like this:</P>
<P>"John Doe@hotmail.com"</P>
<P>This is because it will ignore the "John " and simply validate the "Doe@hotmail.com"</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Dave.Erwin replied on Friday, May 26, 2006</h2><P>I found this on CodeProject at <A href="http://www.codeproject.com/csharp/rfc822validator.asp">http://www.codeproject.com/csharp/rfc822validator.asp</A>. I was concerned that some of the simpler expressions would miss something or not allow something. Since this purports to handle RFC822 I'm assuming it's pretty complete and will handle some of the possible oddball email addresses.&nbsp;He based his C# version on an expression done by Jeffrey Friedl (author of Mastering Regular BLOCKED EXPRESSION.&nbsp;I translated it to VB.NET and modified it slightly since it seemed like StringBuilder would help.</P>
<P>I'm no regex guru so this expression is a little beyond me &lt;g&gt; but it has worked well here. Someday when I have time I'd like to tear it apart and see how it works. I haven't had any bad addresses show up and no complaints that a valid address couldn't be entered. That said I'm only using it internally at a very small company so "buyer beware".</P>
<P>I don't see a way to attach a file otherwise I'd send you a copy of the VB.NET version. I'd post the code in the message but it's about 300 lines which would be kind of annoying. If you'd like a copy I can email it to you.</P>
<P>I can't even begin to tell you how much help your CSLA books have been to me. Thanks for the effort in putting them out. I'm sure some days it would be easier just to develop CSLA for your own use and not bother with the books.</P>
<P>Thanks again.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael Hildner replied on Friday, June 02, 2006</h2><P>I won't pretend to offer a solution, but this is a pretty good read <A href="http://www.regular-expressions.info/email.html">http://www.regular-expressions.info/email.html</A></P>
<P>It also claims to to have a valid RFC 822 regex, although it's different than the one posted above. I like how the article explains why email regexes are a tradeoff, and why you may not want to target RFC 822 in the first place.</P>
<P>Mike</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tetranz replied on Tuesday, June 06, 2006</h2>Something that managed to bite me this morning on this subject is that you need to allow addresses with an apostrophe in the name for names like O'Reilly etc. Apparently it is legal but lots of systems reject it.<br><br>Ross<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SoftwareArchitect replied on Friday, June 09, 2006</h2>what if I want to validate against a regex pattern (such as email) ONLY if the user supplied a value?&nbsp; In other words, my email property is NOT required but if the user enters it it should be validated.<br><br>This has got to be simple...do I need to create my own version of RegExMatch that ignores a zero length string?&nbsp; Or should my email pattern specify that?&nbsp; If so, how would I get that email expression to allow it?<br><br>Thanks,<br>Mike<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Friday, June 09, 2006</h2>You could create a rule that checks the length and if it's zero return true and if not, call the email validation rule...<br><br><br>Andr√©s<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SoftwareArchitect replied on Monday, June 12, 2006</h2>Thanks much.&nbsp; That is exactly what I will do.<br><br>Mike<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mcfin replied on Friday, September 22, 2006</h2><P>Was reading this thread looking for a way to do the same thing.</P>
<P>If you add the following to your regular expression it will match on an empty string as well as the match you are looking for:</P>
<P>|^[/S/s]{0,0}$</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Skafa replied on Friday, September 22, 2006</h2>there's an official regex for email-addresses, but it's kinda useless (around 6300 characters). see http://www.regular-expressions.info/email.html (last paragraph).&nbsp; <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pelinville replied on Friday, September 22, 2006</h2><DIV>That is funny.</DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Adam replied on Wednesday, July 08, 2009</h2>Hi peeps<br><br>Just a note on something I have noticed when using the regex match with the default common email regex the email field becomes mandatory is this correct even for nullable email fields? I have updated mine as follows but wondered if this was desired functionality?<br><br>ValidationRules.AddRule(CommonRules.RegExMatch, new CommonRules.RegExRuleArgs(SalesContactEmailProperty, @"^$|^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$"));<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, July 08, 2009</h2><P>I'll be removing all "default" expressions from the next release of CSLA. </P>
<P>There are so many variations and opinions on expressions that it is clear to me that I can't win. And there's no value to me in trying - the RegEx rule lets you specify the expression directly, so there's simply no value at all in CSLA providing "default" expressions that (from what I can tell) most people find to be insufficient.</P>
<P>Clearly there's just no industry-wide concencus on how to validate anything :)</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
