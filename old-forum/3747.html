<html><header><title>Crosstab Query Results and CSLA</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Crosstab Query Results and CSLA</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3747.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>CyclingFoodmanPA posted on Friday, October 19, 2007</h2><P>I am trying to figure out how to create a business object that is based on a crosstab query.&nbsp; The rows are not a problem but I am trying how to utilize the CSLA architecture for the crosstab query.&nbsp; All the CSLA objects that are lists inherit from ReadOnlyListBase and have an Info object associated with them (for example, ProjectList and ProjectInfo).&nbsp; ProjectInfo knows an Id and a Name is going to come to it.&nbsp; How do you work these when you do not know how many columns are going to come back as the crosstab query can return anywhere from 2 to n columns?&nbsp; By the way, I am utilizing Itzik Ben-Gan's article "PIVOT on Steroids" (SQL Server Magazine, January 2007) for a crosstab query that is dynamic and it is great.</P>
<P>Anyway, any help or thoughts to lead me in the right direction would be appreciated.</P>
<P>Keith S. Safford<BR></P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>KKoteles replied on Wednesday, October 24, 2007</h2><P>Keith,</P>
<P>I'm not sure you can (nor that you should).&nbsp; CSLA objects are "static" in design and not dynamic - all the properties are fixed and set so you know what you have.&nbsp; That is not to say that the end result might not be a "crosstab" based on your database; however, the properties of your object are known (at least the ones I've designed to date).&nbsp; I have had a situation where a message could belong to one or more lines of business - and they wanted to display that information in a grid.&nbsp; It is pretty easy to do; however, when they add another line of business on me I am going to have to redesign my object to contain that new line of business.&nbsp; I'm not sure how else you would do it.</P>
<P>Here is an example of the select statement I use to "denormalize" the database to what I needed for my object:</P><FONT color=#0000ff size=2>
<P><SPAN>SELECT</SPAN><SPAN><FONT color=#000000> <BR><SPAN>&nbsp;&nbsp;&nbsp; </SPAN>Message</FONT><SPAN>.</SPAN><FONT color=#000000>Active</FONT><SPAN>,<BR></SPAN><FONT color=#000000><SPAN>&nbsp;&nbsp;&nbsp; </SPAN>MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>LineOfBusiness2</FONT><SPAN>,<BR></SPAN><FONT color=#000000><SPAN>&nbsp;&nbsp;&nbsp; </SPAN>MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>LineOfBusiness1</FONT><SPAN>,<BR></SPAN><FONT color=#000000><SPAN>&nbsp;&nbsp;&nbsp; </SPAN>dMessage</FONT><SPAN>.</SPAN><FONT color=#000000>Creator</FONT><SPAN>,<BR></SPAN><SPAN><FONT color=#000000>&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN>IsNull</SPAN><SPAN>(</SPAN><FONT color=#000000>Message</FONT><SPAN>.</SPAN><FONT color=#000000>Created</FONT><SPAN>,</SPAN><FONT color=#000000> </FONT><SPAN>GetDate</SPAN><SPAN>())</SPAN><FONT color=#000000> </FONT><SPAN>AS</SPAN><FONT color=#000000> Created</FONT><SPAN>,<BR></SPAN><FONT color=#000000><SPAN>&nbsp;&nbsp;&nbsp; </SPAN>MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>LineOfBusiness3</FONT><SPAN>,<BR></SPAN><FONT color=#000000><SPAN>&nbsp;&nbsp;&nbsp; </SPAN>MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>LineOfBusiness4</FONT><SPAN>,<BR></SPAN><FONT color=#000000><SPAN>&nbsp;&nbsp;&nbsp; </SPAN>Message</FONT><SPAN>.</SPAN><FONT color=#000000> MessageID</FONT><SPAN>,<BR></SPAN><FONT color=#000000><SPAN>&nbsp;&nbsp;&nbsp; </SPAN>Message</FONT><SPAN>.</SPAN><FONT color=#000000>MessageBodyText</FONT><SPAN>,<BR></SPAN><FONT color=#000000><SPAN>&nbsp;&nbsp;&nbsp; </SPAN>Message</FONT><SPAN>.</SPAN><FONT color=#000000>MessageTitleText<BR><BR></FONT><SPAN>FROM</SPAN><FONT color=#000000> Message<BR></FONT><SPAN>LEFT</SPAN><FONT color=#000000> </FONT><SPAN>JOIN</SPAN><FONT color=#000000> </FONT><SPAN>(</SPAN><SPAN>SELECT</SPAN><FONT color=#000000> MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>MessageID</FONT><SPAN>,<BR></SPAN><SPAN><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN>MIN</SPAN><SPAN>(</SPAN><SPAN>CASE</SPAN><FONT color=#000000> MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>LineofBusinessTypeID <BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>WHEN</SPAN><FONT color=#000000> 1 <BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>THEN</SPAN><FONT color=#000000> </FONT><SPAN>IsNull</SPAN><SPAN>(</SPAN><FONT color=#000000>dMessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>LineofBusinessActiveIndicator</FONT><SPAN>,</SPAN><FONT color=#000000> </FONT><SPAN>'N'</SPAN><SPAN>)</SPAN><FONT color=#000000> <BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>END</SPAN><SPAN>)</SPAN><FONT color=#000000> LineOfBusiness1</FONT><SPAN>,<BR></SPAN><SPAN><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN>MIN</SPAN><SPAN>(</SPAN><SPAN>CASE</SPAN><FONT color=#000000> MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>LineofBusinessTypeID <BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>WHEN</SPAN><FONT color=#000000> 2 <BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>THEN</SPAN><FONT color=#000000> </FONT><SPAN>IsNull</SPAN><SPAN>(</SPAN><FONT color=#000000>MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>LineofBusinessActiveIndicator</FONT><SPAN>,</SPAN><FONT color=#000000> </FONT><SPAN>'N'</SPAN><SPAN>)</SPAN><FONT color=#000000> <BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>END</SPAN><SPAN>)</SPAN><FONT color=#000000> LineOfBusiness2</FONT><SPAN>,<BR></SPAN><SPAN><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN>MIN</SPAN><SPAN>(</SPAN><SPAN>CASE</SPAN><FONT color=#000000> MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>LineofBusinessTypeID <BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>WHEN</SPAN><FONT color=#000000> 3 <BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>THEN</SPAN><FONT color=#000000> </FONT><SPAN>IsNull</SPAN><SPAN>(</SPAN><FONT color=#000000>MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>LineofBusinessActiveIndicator</FONT><SPAN>,</SPAN><FONT color=#000000> </FONT><SPAN>'N'</SPAN><SPAN>)</SPAN><FONT color=#000000> <BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>END</SPAN><SPAN>)</SPAN><FONT color=#000000> LineOfBusiness3</FONT><SPAN>,<BR></SPAN><SPAN><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN>MIN</SPAN><SPAN>(</SPAN><SPAN>CASE</SPAN><FONT color=#000000> MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>LineofBusinessTypeID <BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>WHEN</SPAN><FONT color=#000000> 4 <BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>THEN</SPAN><FONT color=#000000> </FONT><SPAN>IsNull</SPAN><SPAN>(</SPAN><FONT color=#000000>MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>LineofBusinessActiveIndicator</FONT><SPAN>,</SPAN><FONT color=#000000> </FONT><SPAN>'N'</SPAN><SPAN>)</SPAN><FONT color=#000000> <BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>END</SPAN><SPAN>)</SPAN><FONT color=#000000> LineOfBusiness4<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>FROM</SPAN><FONT color=#000000> MessageLineofBusiness<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>GROUP</SPAN><FONT color=#000000> </FONT><SPAN>BY</SPAN><FONT color=#000000> MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000> MessageID</FONT><SPAN>)</SPAN><FONT color=#000000> MessageLineofBusiness </FONT><SPAN>ON<BR></SPAN><FONT color=#000000><SPAN>&nbsp;&nbsp;&nbsp; </SPAN>Message</FONT><SPAN>.</SPAN><FONT color=#000000>MessageID </FONT><SPAN>=</SPAN><FONT color=#000000> MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>MessageID<BR></FONT><SPAN>WHERE</SPAN><FONT color=#000000> </FONT><SPAN><BR>EXISTS</SPAN><FONT color=#000000> <BR><SPAN>&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>(</SPAN><SPAN><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN>SELECT</SPAN><FONT color=#000000> </FONT><SPAN>TOP</SPAN><FONT color=#000000> 1<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>MessageID<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>FROM</SPAN><FONT color=#000000> MessageLineofBusiness<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>WHERE</SPAN><FONT color=#000000> MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>MessageID </FONT><SPAN>=</SPAN><FONT color=#000000> Message</FONT><SPAN>.</SPAN><FONT color=#000000>MessageID </FONT><SPAN>AND<BR></SPAN><FONT color=#000000><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>LineofBusinessActiveIndicator </FONT><SPAN>=</SPAN><FONT color=#000000> </FONT><SPAN>'Y'</SPAN><FONT color=#000000> </FONT><SPAN>AND<BR></SPAN><SPAN><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN>(</SPAN><FONT color=#000000>MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>LineofBusinessTypeID </FONT><SPAN>=</SPAN><FONT color=#000000> 1 </FONT><SPAN>OR</SPAN><FONT color=#000000> <BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>LineofBusinessTypeID </FONT><SPAN>=</SPAN><FONT color=#000000> 2 </FONT><SPAN>OR</SPAN><FONT color=#000000> <BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>&nbsp;&nbsp;</SPAN>MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>LineofBusinessTypeID </FONT><SPAN>=</SPAN><FONT color=#000000> 3 </FONT><SPAN>OR</SPAN><FONT color=#000000> <BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>MessageLineofBusiness</FONT><SPAN>.</SPAN><FONT color=#000000>LineofBusinessTypeID </FONT><SPAN>=</SPAN><FONT color=#000000> 4</FONT><SPAN>)<BR></SPAN><SPAN><FONT color=#000000>&nbsp;&nbsp;&nbsp; </FONT></SPAN><SPAN>)<BR></SPAN><SPAN>ORDER</SPAN><FONT color=#000000> </FONT><SPAN>BY<BR></SPAN><FONT color=#000000><SPAN>&nbsp;&nbsp;&nbsp; </SPAN>Message</FONT><SPAN>.</SPAN><FONT color=#000000>MessageCreateDate</FONT><BR><BR></SPAN></FONT><FONT size=2>Ken</P></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
