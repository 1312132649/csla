<html><header><title>COM/Csla 2 issue</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>COM/Csla 2 issue</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/713.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai posted on Monday, July 24, 2006</h2><P>Hi guys.</P>
<P>I have a requirement to be able to automate my application from&nbsp;several non-dotnet applications.&nbsp; This means that technologies like remoting are not available to use.&nbsp; It looks as if Com (shudder) is the only option.&nbsp; It is fairly easy to get Com up and running and I was able to create a simple dotnet class that I could call into from a test VBS script using something like</P>
<P>set o = GetObject("", "MyNamespace.MyClass")</P>
<P>This actually gets a new instance of my class rather than one within my running application.&nbsp;It turns out I needed to create an instance of my class from my application and register it in the running object table.&nbsp; Then when I run the above VBS it gets a reference to the actual object I created within my dotnet app.&nbsp; So far so good.&nbsp; But when I try to call a method on that object to show a form that uses Csla objects I get the good old "Principal must be of type BusinessPrincipal, not System.Security.Principal.GenericPrincipal" error when it tries to call a Csla Factory method.&nbsp; The application does the standard Logout/Login combo at startup and I have checked that after the app has started up the principal is correct.&nbsp; It seems like it must be some sort of threading issue i.e. the Com call is running on a different thread that has not had the principal set on it.&nbsp; Anyone got any suggestions as to how to avoid this problem or even better how to provide automation without Com!</P>
<P>Hope someone can help!</P>
<P>John.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fintanv replied on Tuesday, July 25, 2006</h2><P>I had the same issue using CSLA 1.4.&nbsp; I wanted to make some of the functionality of my application available from within the .net MDI GUI, as well as start up specific forms from within Excel.&nbsp; Since my code was encapsulated within a dll, there is no way to get the app.config file read.&nbsp; Since we use windows integrated security in our org, the solution I went with was to modify the DataPortal code so that the default security implementation was windows security rather than CSLA security.&nbsp; This change allowed me to get up and running.</P>
<P>As a further note, I also ran in to issues with dependancies since my COM invoked dll held a form that inherited from a base in a second dll.&nbsp; COM could not find the second dll and it was not appropriate to add it to the GAC.&nbsp; The resolution was to use the /codebase option on regasm (my dll's are all signed).&nbsp; Now everything is working fine.</P>
<P>Regards, Fintan</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
