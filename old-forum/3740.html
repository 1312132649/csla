<html><header><title>ProjectTracker.NHibernate and NHibernate v1.2</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ProjectTracker.NHibernate and NHibernate v1.2</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3740.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>fernandoacorreia posted on Thursday, October 18, 2007</h2>I found DavidDilworth's excellent ProjectTracker.NHibernate project on CodePlex and I'm planning to use its framework on my next project.<br><br>I wonder if anyone has upgraded NHibernate support for CSLA to version 1.2 of NHibernate.<br><br>If anyone could share some information on this, I'd appreciate. I plan on upgrading the current <span id="ctl00_ctl00_Content_TabContentPanel_Content_ChangeSetList_ctl08_CommentLabel">ProjectTracker.NHibernate (May 3 at 6:30 AM) to </span>NHibernate <span id="ctl00_ctl00_Content_TabContentPanel_Content_ChangeSetList_ctl08_CommentLabel">1.2 and post it back on CodePlex.<br><br>I'd specially like to hear what David thinks about this.<br><br>Thanks and best regards.<br><br>Fernando.<br></span></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DavidDilworth replied on Tuesday, October 23, 2007</h2><P>Seems like an excellent idea to me.&nbsp; </P>
<P>We have been stuck using the older version of NHibernate as we are doing project specific work right now.&nbsp; We don't have the time to go back and re-engineer the framework to the new NHibernate v1.20.</P>
<P>Give it a try!</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fernandoacorreia replied on Wednesday, October 24, 2007</h2>Thank you for your feedback. I've uploaded the updated version to CodePlex as a patch. Currently it doesn't show on the "Recent Check-Ins" page, but it is listed on the "Patches" page and can be downloaded with this URL:<br><br>http://www.codeplex.com/CSLAcontrib/Project/Download/FileDownload.aspx?DownloadId=20672<br><br>Release notes:<br><br>* Updated to NHibernate 1.2<br>* Updated to CSLA 3.0.2.<br>* Folder PTData: Contains SQL Server database scripts that should be used to create the PTracker and the Security databases.<br>* Source code reformated with ReSharper.<br>* Tested with ProjectTracker 3.0.2. Web and WinForms interfaces were tested using local DataPortal. Not successful with WCF DataPortal.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DavidDilworth replied on Thursday, October 25, 2007</h2><P>I took the ZIP and it builds fine for me.</P>
<P>Did you make any code changes?&nbsp; Or did you just update the references?</P>
<P>Did you change any code to take advantage of any of the new features in NHibernate v1.2 to support generics?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fernandoacorreia replied on Thursday, October 25, 2007</h2>These modifications were required to make it work with NHibernate 1.2:<br><ul><li>Update DLLs required by NHibernate.<br></li><li>Add xmlns='urn:nhibernate-configuration-2.2' to some XML files.</li><li>Add Lazy = false to class attributes.</li></ul>I'm sorry about all the reformatting. I realize it makes it impossible to review my changes. But they can be easily applied to the original version. Just search for urn:nhibernate-configuration-2.2 and Lazy = false and you'll see where I made these changes.<br><br>I did not try to add support for generics right now. Actually I'm creating another framework based on this one that will use the DAL pattern to avoid binding the business object to NHibernate. That way the BO could be used on Silverlight 1.1 without requiring NHibernate on the client.<br><br>Cheers!<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DavidDilworth replied on Thursday, October 25, 2007</h2><P>Don't worry about the formatting.&nbsp; We obviously have different style settings for R#, since that's what we use as well.</P>
<P>I,&nbsp;incorrectly as it turns out, assumed that you were also going to look at how to use the new generics stuff as well.</P>
<P>That will obviously have to wait for another day!</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>lonely7345 replied on Friday, February 15, 2008</h2>&nbsp;Why is&nbsp;&nbsp; not successful with WCF DataPortal?<BR></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DavidDilworth replied on Tuesday, February 19, 2008</h2><P>There should be no reason why it shouldn't work with WCF.&nbsp; NHibernate is used only to populate the objects with data from the data base.</P>
<P>If you have a problem with remoting and WCF then it's likely that you haven't configured the various parts of the Data Portal functionality correctly.</P>
<P>Double check all your WCF configuration settings and make sure you can get the Data Portal working without NHibernate.&nbsp; Then add NHibernate into the picture.&nbsp; That might help you isolate the problem.</P>
<P>However, having said all that we haven't gone up to the latest version of CSLA yet that takes advantage of the WCF stuff.&nbsp; So there may be a problem that we haven't seen yet.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>lonely7345 replied on Tuesday, February 19, 2008</h2><P>ProjectList.cs</P>
<P>protected override void SetNHibernateCriteria(object businessCriteria, ICriteria nhibernateCriteria){</P>
<P>&nbsp;// Cast the criteria back to the strongly-typed version<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Criteria criteria = businessCriteria as Criteria;</P>
<P>&nbsp;&nbsp; // If it's a valid criteria object then check for filters<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!ReferenceEquals(criteria, null))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <STRONG>// Set a reference to the NHibernate ICriteria (for local use only)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _iCriteria = nhibernateCriteria;</STRONG></P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Name<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!String.IsNullOrEmpty(criteria.Name))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddCriterionName(criteria.Name);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</P>
<P>}</P>
<P>&nbsp;</P>
<P>I think something is wrong here.when i remark these ,it's all right.</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DavidDilworth replied on Wednesday, February 20, 2008</h2><P>Well there's nothing wrong with that line of code specifically.&nbsp; And you've not given any idea of what the problem is and how it's being manifested.</P>
<P>However, that line of code is just doing a simple assignment operation to a private field, so that the AddCriterionName() method can use the field.</P>
<P>It can be refactored easily so that the ICriteria is passed as a parameter to the AddCriterionName(ICriteria nhibernateCriteria, string Name) method instead.&nbsp; Then the private field can be removed.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>lonely7345 replied on Saturday, February 23, 2008</h2><P>some details is here</P>
<P><A HREF="/forums/thread/20880.aspx">http://forums.lhotka.net/forums/thread/20880.aspx</A></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DavidDilworth replied on Tuesday, March 04, 2008</h2><P>I read the other thread.&nbsp; And yes, it sounds to me like you found the right problem - Serialization.</P>
<P>Any BO that needs to move via the Data Portal has to be Serializable.&nbsp; And sometimes that means you might need to mark specific fields with the [NonSerialized] attribute.</P>
<P>I hope you solved your problem.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>andy replied on Friday, August 29, 2008</h2>Hi David,<br>I have reviewed your implementation ProjectTrackerNHibernate solution.<br>It looks very good to me.&nbsp; Any code base template for it?<br>I am just started to work with NH.&nbsp; The learning curve is quite steep, but did find a lot of resources to help me with along the way.<br>Currently I am using CSLA framework for my project and would like to leverage ORM framework to do the CRUD operations.&nbsp; This could lead to 90% code reduction for data access code in dataportal_xyz operations.&nbsp; The remaining 10% might be dealing with sharp edges.<br>I am current testing NH 1.2 and it required all properties and methods of POCO to be virtual.<br>No biggy, I can use mygenerate tool to do the dirty works.:)<br>I am using ORALC Eand ODP.NET for my environment.&nbsp; There are very limited on internet about the topic.&nbsp; <br>Seems you had experienced using NH &amp; CLSA in your project.<br>Any "gothcha"(i.e session manager, lazy loading, etc) that I should be concerned?<br>I appreciate you sharing your knowledge and time.<br><br>Andy<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Philip replied on Wednesday, October 15, 2008</h2><P>I am looking into writing some templates to support NHibernate in Code Complete. I am not very familiar with NHibernate so I have a couple of questions and I would appreciate any help:</P>
<P>1- How is NH used with CSLA i.e. does everyone use the version by&nbsp;David Dilworth available on CodePlex?</P>
<P>2- Which version is currently available as a release?</P>
<P>Thanks</P>
<P>Philip</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DavidDilworth replied on Wednesday, October 15, 2008</h2><P>I'm just replying to this so that people who come to this thread will find out that I have moved on to a new job and I am no longer involved in the project that used CSLA and NH together.&nbsp; As it happens, I'm still using NH, but with an in-house developed middle tier.&nbsp; I still get the occasional CSLA&nbsp;email and I do check back onto the forums occasionally - there are some very knowledgable people on here!</P>
<P>So in answer to your questions:</P>
<P>(1) I don't know, but I expect some people will have taken the original CodePlex code and modified it for their own projects.&nbsp; That's great, it was always meant to be a starting point to give people an idea of how CSLA and NH could be integrated together.</P>
<P>(2) NHibernate is at version 1.2.1.&nbsp; Check out the <A href="http://www.hibernate.org/343.html">NHibernate</A>&nbsp;website for the latest updates.&nbsp; As for the latest version of the CSLA/NH extensions - I'm not sure anymore.</P>
<P>HTH</P>
<P>And good luck!</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Cine replied on Monday, April 14, 2008</h2>Anyone looked into upgrading to 2.0 (alpha 1 at this point in time)?<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
