<html><header><title>Binding BOs to Tree View control?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Binding BOs to Tree View control?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2102.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>maurera posted on Tuesday, January 09, 2007</h2><P class=MsoNormal>We have a need to have&nbsp;a BO that can bind to a Tree View control.<SPAN>&nbsp; </SPAN>Perhaps my “Google Fu” is week, but I was unable to find a solution on CLSA Contrib, or these forums and was hoping someone could point us in the right direction.</P>
<P class=MsoNormal><SPAN></SPAN>&nbsp;</P>
<P class=MsoNormal>Let me give you guys a little background.<SPAN>&nbsp; </SPAN>We are creating a Recipe management application.<SPAN>&nbsp; </SPAN>The design calls for a form that will contain a tree view control “coupled” with a list box control which will be used primarily for navigation; similar to how the windows explorer works except the Tree View control will display a list of Recipes and Sub Recipes instead of folders, and the List Box control will display a list of ingredient(s), Package(s), and Step(s) associated with the currently selected recipe in the Tree View control, instead of a list of files contained within the currently selected folder.</P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>A key concept here is that a Recipe will contain Sub Recipe(s) which, themselves, can also contain sub recipe(s) and so on to the <I>n </I>level.<SPAN>&nbsp; </SPAN>Further complicating the scenario (although I don’t think it is relevant to the discussion) is that a Sub Recipe can be contained within multiple Sub Recipes that are part of the same parent Recipe…let me explain.<SPAN>&nbsp; </SPAN>Recipe A contains recipe B and C as Sub Recipes.<SPAN>&nbsp; </SPAN>Recipe C contains Sub Recipe D as one of its Sub Recipes.<SPAN>&nbsp; </SPAN>Both Recipe B and Recipe D contain Recipe E as one of their sub recipes.</P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>I believe we have come up with a conceptually sound design to accomplish the “recipe explorer”, where the TreeView control will be bound to a “RecipeHierarchy” object.<SPAN>&nbsp; </SPAN>The “Companion ListBox” will be bound to a filterable, bindable, list object called “RecipePartList”.<SPAN>&nbsp; </SPAN>Clicking on a Node in the Tree would filter the RecipePartList by the RecipeID of that node.</P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>The problem we are facing is, how would we go about binding the “RecipeHierarchy” object to a tree view or, more generically, how would you create an object that is able to be bound to a Tree View?</P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>Please keep in mind that we are a VB .NET shop.</P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>Thanks in advance,</P>
<P class=MsoNormal>Adam</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Tuesday, January 09, 2007</h2><P>I created heirarchical coding for use with Csla, and I ended up implementing some interfaces...</P>
<P>Google for IHierarchicalDataSource and I suspect you may find what you're looking for.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Tuesday, January 09, 2007</h2><P>by the way, this interface appears to be directed towards ASP.Net. Hope that's what you need it for :). </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>maurera replied on Tuesday, January 09, 2007</h2>I was just about to respond to you regarding that very same subject.&nbsp; The application is a windows application, so I don't think we can use the interface.&nbsp; I am in the process of researching this further to see if it can work for a windows Tree View control.&nbsp; It would strike me as very odd that&nbsp;Microsoft would not provide some sort of bindable interface for&nbsp;a Windows tree view control.&nbsp; Also, I would be very suprised if someone else using the CSLA would not need the same functionality...</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Tuesday, January 09, 2007</h2>Do a search of the forums for TreeNode.&nbsp; I will be out of contact for the rest of the week, but I may be able to help next week.<br><br>Also, send a private message to FireGarden, as I think he implemented a version of this from my examples.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>maurera replied on Tuesday, January 09, 2007</h2><P>one step ahead of ya ;-)<o:p></o:p></P>
<P>I already did a search on TreeNode.&nbsp; The results were somewhat helpful and led me down the path of creating the TreeNodeBase, ObjectTreeNodeBase, and ListTreeNodeBase classes.&nbsp; The only code&nbsp;I was able to find was C# code, which I was able to translate into VB.NET with relative ease.&nbsp; I did however run into a road block as the ListTreeNodeBase class was inheriting from ObjectListView which is a much more complex class&nbsp;written in C# created by Brain Criswell for the CSLA community.<o:p></o:p></P>
<P>I have posted a reply to his latest Update thread asking him if there is a VB.NET version of this code as we don't currently have time to "re-invent" the wheel (as it is we have spent more time then we want on this problem).&nbsp; He just responded not that long ago that, once the class(es) is(are) stable, he would be providing a VB.NET version.&nbsp; Unfortunately for us, his timeline for that (2-3 weeks at lest) is a little outside of our needs.&nbsp; His suggestion to create a CSLA C# build that would reference the CLSA VB build was our only option and in fact was a point of discussion when we received his respone.&nbsp; And then...<o:p></o:p></P>
<P>One of us was able to find a third party vendor (Infragistics) that has a windows tree control&nbsp;which supports the IList(of T), IBindingList interfaces...although I feel WEEEAK resorting to this solution, it is the path of least resistance since we should be able to use objects that inherit the SortedBindingList class as datasources directly (without having to jump through any hoops).<o:p></o:p></P>
<P>Hey man, I want to thank you for taking the time out of your day to look at this with us.&nbsp; It is very much appreciated.&nbsp; If you think of anything else feel free to post it hear for the benefit of others that have the same problem and aren't WEAK (or more accurately have the time on their hand to not be WEAK) heh heh.<SPAN><o:p></o:p></SPAN></P>
<P class=MsoNormal>On a side note:</P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>Admittedly, I still wasn’t clear exactly how the Databinding was occurring using these classes and I was looking forward to finding out.<SPAN>&nbsp; </SPAN>Once I have some “spare” time on my hands I think I would like to play around a bit more with this concept, as I think knowledge of how to provide a solution would be helpful to say the least.</P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>It looked to me, without actually having a working set of classes, that the “TreeNode” classes were hooked into the list objects property changed events to directly manipulate the Windows Tree View control…does this sound right?</P>
<P><FONT size=2>Further Side Note (Upon Edit):</FONT></P>
<P><FONT size=2>heh heh, I didn't even realize I was responding to you Brian, but thank you as well&nbsp;:-)</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Wednesday, January 10, 2007</h2>By the way, you do not need the ObjectListView to make this system work.&nbsp; You could just give it an array or List of your business object.&nbsp; The only reason I used it was because I had a single list of objects that were used as the children of nodes and I used the filters to show which items belonged to which parent nodes.&nbsp; So if you were loading a hierarchical list that already had the children joined to the correct parent, you would not need it.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>maurera replied on Wednesday, January 10, 2007</h2><P>Good timing :-)<o:p></o:p></P>
<P>We just finished up a design session where we came to the same conclusion.&nbsp; Your ObjectListView would be helpful for our "PartsList" though.&nbsp; Our Hierarchy Parent Child structure will be directly bindable to the Infragistics Tree View&nbsp;control&nbsp;as is (since the BuisnessListBase&nbsp;class inherits from System.ComponentModel.BindingList which in turn implements the interfaces required by the Infragistics Tree View Control for binding), without the need of filtering.<o:p></o:p></P>
<P>However, our "PartList" will be filtered to all parts except item type recipe (Ingredient, Package, Step) when bound to the "companion list box".&nbsp; That being said, we also have a need to bind the "PartList" to a grid on a separate tab (in the same form) called components.&nbsp; Under this context, the "PartList" will need to be filtered to&nbsp;display only item types Ingredient and Recipe.&nbsp; Similarly there will be two other tabs "Packages" and "Steps" that need to filter the list based on Item Type Package and Steps respectively.<o:p></o:p></P>
<P>Not a day goes by that I don't admire the inherent beauty of the CSLA heh heh.<o:p></o:p></P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
