<html><header><title>Multiple objects, single transaction.  N-Tier</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Multiple objects, single transaction.  N-Tier</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6847.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>martin_s posted on Saturday, April 25, 2009</h2>In the scenario of a client/application server with WCF communications.&nbsp; The client application makes changes to multiple objects, some of which are not related in a parent/child relationship.&nbsp; Is it possible to serialize all the objects, dispatch them to the server to be updated in a single database transaction, or can only objects with relationships be included in a transaction.<br><br>If this is explained in the C# 2008 book feel free to direct me to the appropriate chapter.<br><br>Thanks.<br>Martin.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DocJames replied on Saturday, April 25, 2009</h2><br />Hello,<br /><br />You can take a look at this Wiki entry here:<br /><br />http://www.lhotka.net/cslanet/faq/(S(rm1rki45kyfvdk55hcxgjoj5))/SaveMultipleRootObjects.ashx<br /><br />Jimmy<br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>martin_s replied on Saturday, April 25, 2009</h2>Excellent - that clears up a big question mark for me :)<br><br>Thank you.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Saturday, April 25, 2009</h2><P>I suppose that's one way to do it, but it seems to require you to compose your objects in a way that matches the transaction you want to do. </P>
<P>We don't use the TransactionScope attribute but instead manage our transactions manually, with all saving taking place using a "TransactionContext" class&nbsp; passed around as a parameter. (Server side of data portal only)</P>
<P>So, while the client calls Save(), this ends up in an Update(TransactionContext) method server side. </P>
<P>All of our BO's implement Update(TransactionContext), so it is possible to execute arbitrary compositions of object updates server side in the same transaction without any change in the object design. </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>martin_s replied on Sunday, April 26, 2009</h2>I can see how the TransactionContext would work, but how do you transport multiple root objects from client to server in a single network trip ?<br><br>Also, can I just ask about generating update statements.&nbsp; In our current Delphi OPF we have a data access layer which constructs the update SQL containing only the property values which have changed since the load.&nbsp; Is this something that people have implemented.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Sunday, April 26, 2009</h2><P>In our case, what typically&nbsp;happens is that the server-side Update() method may either create&nbsp;or fetch and then&nbsp;update other "root" BO's during the server side processing. </P>
<P>If they need to be fetched client side and transported over, then they indeed need to be part of the object graph as suggested in the FAQ. </P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
