<html><header><title>I hereby nominate ObjectListView... new entries are welcome</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>I hereby nominate ObjectListView... new entries are welcome</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1040.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>FireGarden posted on Saturday, August 26, 2006</h2><P>If you have not yet downloaded ObjectListView you should. Its available here:</P>
<P><A href="http://www.codeplex.com/SourceControl/DownloadSourceCode.aspx?ProjectName=CSLAcontrib&amp;changeSetId=3610">http://www.codeplex.com/SourceControl/DownloadSourceCode.aspx?ProjectName=CSLAcontrib&amp;changeSetId=3610</A></P>
<P>It allows you to easily filter and sort business collections. A good example of where I use it is in populating a TreeView control. The problem with populating a treeview control is in populating the children.</P>
<P>Typically all children come from the same table but have a differnt parent id. ObjectListView makes it easy to filter&nbsp;the children collection by parent id and sort it. This filtered list is what is used to generate the appropreiate child notes on the tree for that parent id. </P>
<P>Filtering &amp; sorting&nbsp;is so&nbsp;simple because out of the box you can filter by any public property exposed by the underlying BusinessList object. </P>
<P>Are there any alternatives to using ObjectListView that I don't know about to get a filtered &amp; sorted view of&nbsp;an IList / BO?</P>
<P>Regards,</P>
<P>Rob Wheeldon</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dean replied on Sunday, August 27, 2006</h2>Rocky's SortedList(of t) and FilteredList(of t) in csla 2.1 are working pretty well but I haven't tried objectlistview for comparison purposes.<br><br>Dean<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Sunday, August 27, 2006</h2><P>Maybe I'm using it wrong (and that's not unlikely!), but I don't really like using SortedBindingList.</P>
<P>In an unsorted form, I cache the collection object.&nbsp; That cached object is passed to the grid and it is also available for use in various events that I might raise in the form.</P>
<P>When I return a SortedBindingList instead of the object collection and cache it, I can pass it to the grid just fine.&nbsp; But it is useless for handling any object-specific events.&nbsp; At least it is to me, because I can't find a way to "un-cast" it back to the original object its sorting.</P>
<P>So, my questions are:</P>
<P>1) Does using ObjectListView have the same problem?</P>
<P>2) How could I use SortedBindingList so I don't have that problem?&nbsp; (Cache both the object collection and the sortedbindinglist?)</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Sunday, August 27, 2006</h2>You could create the sortedbindinglist just to bindo to the grid and pass the collection to whereever it is you use it... the sortedbl and the other objects will be linked to the same list, and any changes you make there will be impacted in both places, because the reference is the same.<br>Sorting is &lt;with some exceptions&gt; more of a UI thing, so it's perfectly normal to just create the sorted list just to bind to your grid.<br><br>Anyway, you can still add / remove / edit items from the sorted list. You could also have a property in your bo that returns a sorted list for your current list. That way you can pass around the original list and still use the sorted list whenever you find that neccesary...<br><br>Andr√©s<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>FireGarden replied on Sunday, August 27, 2006</h2><FONT face=Arial size=2>Object List View&nbsp;is passed&nbsp;a reference to your BO upon creation </FONT><BR><BR><FONT color=#0000ff size=2>
<P>new</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>ObjectListView</FONT><FONT size=2>(Business.</FONT><FONT color=#008080 size=2>Accounts</FONT><FONT size=2>.GetAccounts(), </FONT><FONT color=#800000 size=2>"GroupID="</FONT><FONT size=2> + accountGroupInfo.ID)</FONT></P>
<P><FONT size=2><FONT face=Arial>This example is an overload with a filter passed in as the second parameter. You can filter and sort&nbsp;the OLV. It sounds like the 2.1 solution uses two differnt objects to accomplish this? <FONT size=2>SortedList &amp; FilteredList(of t)?</FONT></FONT></FONT></P>
<P><FONT face=Arial size=2>The ObjectListView then subscribes to the BO list changed event:</FONT></P><FONT size=2>
<P>_iBindingList = (</FONT><FONT color=#008080 size=2>IBindingList</FONT><FONT size=2>)list;</P>
<P>_iBindingList.ListChanged += </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>ListChangedEventHandler</FONT><FONT size=2>(_iBindingList_ListChanged);</FONT></P>
<P><FONT size=2><FONT face=Arial>ObjectListView is now ready to use in you UI databinding and will raise an event when the business object changes. Subscribe to&nbsp;the OLV event from your UI control and implement the apropreiate refresh.</FONT> </FONT></P>
<P><FONT size=2>_list.ListChanged += <FONT color=#0000ff>new</FONT> <FONT color=#008080>ListChangedEventHandler</FONT>(_list_ListChanged); </FONT></P>
<P><FONT face=Arial><FONT size=2>As a&nbsp;specific example&nbsp;I use this&nbsp;event to update the nodes in a treeview based on the <FONT color=#008080>ListChangedEventArgs</FONT> e class.</FONT></FONT></P><FONT face=Arial><FONT size=2><FONT color=#0000ff size=2>
<P><FONT face="Times New Roman">switch</FONT></FONT><FONT face="Times New Roman"><FONT size=2> (e.ListChangedType)<BR></FONT><FONT color=#0000ff size=2>case</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>ListChangedType</FONT></FONT><FONT face="Times New Roman"><FONT size=2>.ItemAdded:<BR></FONT><FONT color=#0000ff size=2>case</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>ListChangedType</FONT></FONT><FONT face="Times New Roman"><FONT size=2>.ItemDeleted:<BR></FONT><FONT color=#0000ff size=2>case</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>ListChangedType</FONT><FONT size=2>.ItemMoved:</P></FONT></FONT></FONT></FONT>
<P><FONT face=Arial size=2>Regards,</FONT></P>
<P><FONT face=Arial size=2>Rob Wheeldon</FONT></P>
<P><FONT size=2></FONT>&nbsp;</P><FONT face=Arial size=2></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
