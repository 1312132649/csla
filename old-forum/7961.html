<html><header><title>Slow Data Access Problems</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Slow Data Access Problems</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7961.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>NickTaylor posted on Saturday, November 07, 2009</h2><P>Hi,</P>
<P>I wonder if anyone can&nbsp;throw any light on this problem please ? Its causing me some real frustration so any offers of help would be most welcome.</P>
<P>I am&nbsp;currently converting a legacy FoxPro application to dotnet and csla. As the old application is still live I have to access data stored in FoxPro ver 2.6 free tables via the VFPOLEDB driver. For business objects returning a&nbsp;single record I dont have any real data access issues, but I am now writing some list objects which have to perform a small amount of processing&nbsp;as part of their DataPortal_Fetch code. In cases where I wish to return 100 records from a table containing 500K records, the data access appears to be painfully slow ( i.e. 8-seconds or more ). I cant seem to fathom out what is actually causing the problem, and I have even tried&nbsp;writing some DLL based code which performs the query directly in FoxPro and then returns&nbsp;XML data to&nbsp;dotnet, but&nbsp;this doesn't seem to&nbsp;offer any real performance advantage.</P>
<P>If we look at the following code ( located in the DataPortal_Fetch method ):-</P><FONT size=2>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>// Open the connection</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>OleDbConnection</FONT></FONT><FONT size=2> connection = </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>KELplanAPP</FONT></FONT><FONT size=2>.Connection;</P>
<P></P>
<P>connection.Open();</P>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>// Create command object</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>OleDbCommand</FONT></FONT><FONT size=2> command = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>OleDbCommand</FONT></FONT><FONT size=2>(selectCMD, connection);</P>
<P></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>OleDbDataReader</FONT></FONT><FONT size=2> dr = command.ExecuteReader();</P>
<P>connection.Close();</P></FONT>
<P>This takes about 5-seconds to execute, but if I repeat the code twice i.e.:-</P><FONT size=2>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>// Open the connection</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>OleDbConnection</FONT></FONT><FONT size=2> connection = </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>KELplanAPP</FONT></FONT><FONT size=2>.Connection;</P>
<P></P>
<P>connection.Open();</P>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>// Create command object</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>OleDbCommand</FONT></FONT><FONT size=2> command = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>OleDbCommand</FONT></FONT><FONT size=2>(selectCMD, connection);</P>
<P></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>OleDbDataReader</FONT></FONT><FONT size=2> dr = command.ExecuteReader();</P>
<P>connection.Close();</P>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>// Open the connection</P></FONT></FONT><FONT size=2>
<P>connection = </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>KELplanAPP</FONT></FONT><FONT size=2>.Connection;</P>
<P>connection.Open();</P>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>// Create command object</P></FONT></FONT><FONT size=2>
<P>command = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>OleDbCommand</FONT></FONT><FONT size=2>(selectCMD, connection);</P>
<P>dr = command.ExecuteReader();</P>
<P>connection.Close();</P>
<P></FONT>The second time around takes only about 1-second to complete!</P>
<P>I dont understand why this should be,&nbsp;but somehow I need to speed up the access to the data - why should it consistently take different lengths of time to complete the same query ? I'm not sure if anyone out there has experienced problems like this, but I would welcome any suggestions on offer...</P>
<P>Many thanks,</P>
<P>Nick&nbsp;&nbsp;</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
