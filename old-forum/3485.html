<html><header><title>Logging and Tracking Object Activity</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Logging and Tracking Object Activity</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3485.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ltgrady posted on Wednesday, September 05, 2007</h2><P>We have a couple of apps using our brand and project objects.&nbsp; It's a product database holding product catalog information that is searched and reported on.&nbsp; That's a very, very over simplified statement about what the app does.</P>
<P>We want to start adding tracking and logging for a lot of our biz functions.&nbsp; For instance, every time a user submits a search (either on search aspx page, through web service, or some other source) then we want our SearchResults business object to track the critiera, and the products returned.&nbsp; Every time a user downloads a hi res image from our Search Results page or our Image Vault we want to track the User, the date, the time, the image name.&nbsp; Etc..</P>
<P>So essentially we want to create some kind of logging/tracking system.&nbsp; I'm not sure whether to go forward in one of three ways:</P>
<P>1.&nbsp; Build a Tracking/Logging Biz object.&nbsp; A very generic object that takes information and saves it into some kind of table that can be retrieved for reporting later.&nbsp; There would have to be Log Types and several different tables for different kinds of information, but try to use a single Object or service to do the tracking/saivng on info.</P>
<P>2.&nbsp; Build into my Data Access of existing objects to save to the log tables.&nbsp; For instance, search would get search results and save those results into log table.&nbsp; I'm afraid of performance issues here.&nbsp; </P>
<P>3.&nbsp; Use some kind of 3rd party or MS block that already does a lot of this work/plumbing.&nbsp; Something easy to use with good performance and easy to integrate into my CSLA objects.</P>
<P>&nbsp;</P>
<P>Anyone doing this already, have any suggestions? Thanks, larry</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ltgrady replied on Thursday, September 06, 2007</h2><P>After doing some more reading i'm considering either using the Enterprise Library and referencing it in my CSLA object, or, I've been reading about Service Broker in SQL 2005.&nbsp; Service Broker sounds interesting, having my CSLA object stored procedures send asynchronous messages that can save my auditing/logging informaiton and not hold up my process at all.&nbsp; </P>
<P>Anyone used either of these before, anyone have any suggestions or has anyone done anything similar?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Thursday, September 06, 2007</h2><P>Not sure that Service Broker would do the job when you want to have logging initiated by user actions.&nbsp; You'd still need some way to trigger the Service Broker.&nbsp; But maybe...</P>
<P>Aside from that, I've handled this a couple of ways in this past:</P>
<P>1. Utilize the existing Trace feature.&nbsp; In this case, I defined a custom SqlTraceListener that interacted with my Log business object to create and store log info in the app's data store.&nbsp; The benefit of this approach is that the notification system is in place already.&nbsp; There's no need to wire-up event handers to the various&nbsp;objects (following the good ol' observer patterns) to receive notifications when and what to log.&nbsp; All you need to do is add Trace.WriteXYZ calls into your code where you want something logged.&nbsp; Down side is that you have no way to block unexpected things from being logged as any Trace statement will trigger the process.</P>
<P>2.&nbsp;I've also gone the custom&nbsp;Logger-type object route.&nbsp; That object is responsible for the actual logging part.&nbsp; It's up to the business objects or other code (such as Command objects) to interact with the Logger and call the WriteToLog method where needed.&nbsp;&nbsp;The benefit of this is greater control over how it's used.</P>
<P>HTH</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Professor Rotwang replied on Friday, September 07, 2007</h2>SonOfPirate,<br>As an aside, for the custom Logger approach, how did you handle the case where the WriteToLog was called via one of the data portal methods? For example, if the log output was a file on the client, then the write would fail if called on the server-side. <br><br>I'm also about to start looking into logging activity, not as an audit but just to aid performance and error analysis. The only thing I've come up with so far is having a singleton Logger which would be local to the client, and another one that would be local to the server. The real work would then be in merging the two logs to give a genuine, properly ordered trace of what happened and when.<br><br>Sorry if I've hijacked this thread, but it may also be useful for the OP.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
