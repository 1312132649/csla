<html><header><title>Using RegisterProperty(Expression) in base class errors out for VB.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Using RegisterProperty(Expression) in base class errors out for VB.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6929.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Killian35 posted on Monday, May 11, 2009</h2>Hello, <br><br>There seems to be a difference between the way VB and C# deal with creating an expression. I'm working on both C# and VB projects and I'm upgrading the VB project to Csla 3.6.2. I really love the expression declaration used in the RegisterProperty method, so I was changing those over and found that in VB using that approach generates a run-time error if the RegisterProperty is declared in a base class. Here is an example that reproduces the error for VB. The exact same C# version runs as expected. <br><br>Module Module1<br><br>&nbsp;&nbsp;&nbsp; Sub Main()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim p As Person = Person.NewPerson<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.WriteLine(p.Age)<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>End Module<br><br>&lt;Serializable()&gt; _<br>Public MustInherit Class BaseClass(Of T As BaseClass(Of T))<br>&nbsp;&nbsp;&nbsp; Inherits BusinessBase(Of T)<br><br>&nbsp;&nbsp;&nbsp; Protected Sub New()<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>&nbsp;&nbsp;&nbsp; Private Shared AgeProperty As PropertyInfo(Of Integer) = RegisterProperty(Of Integer)(Function(c) c.Age)<br>&nbsp;&nbsp;&nbsp; Public Property Age() As Integer<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return GetProperty(AgeProperty)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As Integer)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetProperty(AgeProperty, value)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>&nbsp;&nbsp;&nbsp; Protected Overrides Sub DataPortal_OnDataPortalInvokeComplete(ByVal e As Csla.DataPortalEventArgs)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If e.Operation = DataPortalOperations.Create Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.Age = 5<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp; End Sub<br>End Class<br><br>&lt;Serializable()&gt; _<br>Public Class Person<br>&nbsp;&nbsp;&nbsp; Inherits BaseClass(Of Person)<br><br>&nbsp;&nbsp;&nbsp; Private Sub New()<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>&nbsp;&nbsp;&nbsp; Public Shared Function NewPerson() As Person<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return DataPortal.Create(Of Person)()<br>&nbsp;&nbsp;&nbsp; End Function<br><br>End Class<br><br>Is there a difference in how VB handles lambda expressions from C#?<br><br>Thank you for any help!<br>Kelly<br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
