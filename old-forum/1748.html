<html><header><title>Is it Root, Parent or Child?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Is it Root, Parent or Child?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1748.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ppcuban posted on Monday, November 13, 2006</h2><P>I have an object&nbsp;inheriting from&nbsp;BusinessBase. We are having a hard time trying to determine if we should MarkAsChild the object since it can be directly retrieved or updated via the dataportal (Root)&nbsp;and it's gonna be contained by another business object (child)&nbsp;as well.</P>
<P>I bought the book c# 2005 business object and i honestly find it really confusing. The sample project ProjectTracker is very specific to that situation and doesn't expose all the possible combinations. I am a 8 years experienced oop programmer and truly i am having a hard time with Csla. is there any tutorial about Csla.</P>
<P>I really need to get to understand this framework since my boss is sticked with it and there is nothing i can do about it.</P>
<P>Thanks in advance!!!</P>
<P>Rocky!!! Save Me!!!!</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, November 13, 2006</h2>Hi,<br><br>First, take a look at your design.&nbsp; What you're describing is a switchable object, which usually indicates a problem with your design.&nbsp; Its rare that a business object can be both a child (only updated withing the scope of its parent) and a parent (updated by itself).&nbsp; You probably should have two different objects.<br><br>Many people have problems because they are focused on designing objects around data, where Csla you design your objects around behavior.&nbsp; The behavior the objects describe are there to fulfill one use case.&nbsp; If one object can fulfil two use cases, that's ok, but it the behavior must be identical between both use cases.&nbsp; This is rare as well.<br><br>The Project Tracker sample is very specific, you're right.&nbsp; That's how you're supposed to design your objects.. directly from your use cases.&nbsp; <br><br>So look at your use case, design your objects around what needs to be done in the use case.&nbsp; Move on to your next one.&nbsp; Create all new objects to fulfill that case.&nbsp; Repeat until you have implemented all use cases.&nbsp; Only then should you look at sharing objects between use cases, and only if the object fulfills the exact same behavior in both cases.<br><br>Try going slower through the book; this is something all of us have problems we.&nbsp; We're used to thinking in terms of normalizing data, and focusing on code reuse.&nbsp; As Rocky has said here before, we to focus on the use case and the behavior it describes.&nbsp; Code reuse can be a nice side benefit, but is not our goal.<br><br>HTH<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ppcuban replied on Monday, November 13, 2006</h2><P>Ok. I am going to be more specific.</P>
<P>I have a User object that inherits from BusinessBase&lt;User&gt;. We want to try to use all the functionalities of Csla with this object so we can use it for our whole new system we are trying to create now.</P>
<P>My&nbsp;doubts started when we wanted create a Users list inheriting from BusinnesListBase. Should User be a Child() of Users neccesarily or not? We need the collection of User for sure but at the same time we want to be able to edit directly the object User without&nbsp;using a parent collection. It makes sense so far? If I mark User as Child then i won't be able to directly update or make changes to the object due to the restriction applied when an object is Child.</P>
<P>Any idea about this?</P>
<P>Thanks</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, November 13, 2006</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ppcuban:</strong></div><div><p>My&nbsp;doubts started when we wanted create a Users list inheriting from BusinnesListBase. Should User be a Child() of Users neccesarily or not? We need the collection of User for sure but at the same time we want to be able to edit directly the object User without&nbsp;using a parent collection. It makes sense so far? If I mark User as Child then i won't be able to directly update or make changes to the object due to the restriction applied when an object is Child.</p></div></BLOCKQUOTE><br><br>The problem you are facing is that you are focusing on the data, not on your use cases.<br><br>You are describing two different use cases, one where you are editing a single user, and one where you are retrieving a collection of users (presumably not for editing).<br><br>In Chapter 6 I try to lay out the design process you should follow for your objects - focusing not on data, but on the behavior and relationships between objects.<br><br>If "User" has the responsibiilty of "Editing data about a user" then it shouldn't be used in a collection to display data - it should only be used for editing data.<br><br>So if you also need to display a list of users, then you'd build a ReadOnlyListBase-derived list, with ReadOnlyBase-derived child objects, possibly called UserList and UserInfo.<br><br>Now if you, for some odd reason, have two use cases where you are allowing editing of user data (which would be odd, but users come up with wierd stuff...), then you have a tougher challenge. But that's always the case with strange requirements...<br><br>In CSLA .NET 2.1 there's a new base class: EditableRootListBase. This class exists so you can retrieve a collection of root objects, bind that collection to a grid, and allow the user to edit those root objects. The ERLB class takes care of immediately calling Save() on each root object as the user leaves the row, so any insert/update/delete actions are immediate.<br><br>ERLB may or may not be what you are after, but it helps in some cases.<br><br>If you need single-object editing AND deferred collection editing, then you might be back at using a switchable object. As Andy points out, this usually indicates a flawed object model - but it could indicate wierd user requirements too...<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ppcuban replied on Monday, November 13, 2006</h2><P>So, practically i have to create 2 similars objects? I am looking at the ProjectTracker and Resource and ResourceInfo have the same fields almost. It seems to me a little odd because i already have an object that i could use no matter the use case, BUT if this the way it should be done in Csla, then i will create them. Maybe there is my problem. I think that one User class is enough for everything about it.</P>
<P>So, in order to get this. If i have a scenario where i am going to edit by itself an object, then it's BusinessBase BUT if the same object is going to be used as an item in a collection, i should create an object similar inheriting from ReadOnlyBase with the fields i want to show in that collection.</P>
<P>Now, it seems interesting that EditableRootListBase, i am gonna try it. By the way, Congratulations, great work. I just find it confusing the whole framework&nbsp;but i guess i need more time dealing with it until i feel comfortable.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael Hildner replied on Monday, November 13, 2006</h2><P>Yes, you'd create two similar objects. Although they're similar only in that they share some of the same data. They don't share the same behaviour, so you need multiple objects.</P>
<P>I started with CSLA a few months ago, and was incredibly confused by the very same thing. Especially because previously I was using a business object framework where there was only one bo for everything you needed to do (although some folks around here might say that wasn't a real bo framework).</P>
<P>My thinking was why would I need two different object when they share the same data? Aren't I duplictating code? In a way you are, but it's much easier to maintain if a bo doesn't have multiple reasons to change. So you're going to end up with a lot more objects than you first thought.</P>
<P>Mike</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ppcuban replied on Monday, November 13, 2006</h2>Where can I download the 2.1 version? can't find it in the website.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ppcuban replied on Monday, November 13, 2006</h2>I FOUND IT. Thanks.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, November 13, 2006</h2><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>ppcuban:</strong></div><div>So, practically i have to create 2 similars objects? I am looking at the ProjectTracker and Resource and ResourceInfo have the same fields almost. It seems to me a little odd because i already have an object that i could use no matter the use case, BUT if this the way it should be done in Csla, then i will create them. Maybe there is my problem. I think that one User class is enough for everything about it.</div></BLOCKQUOTE><br><br>We all struggled with that.&nbsp; Its because you're thinking in terms of data and / or code reuse, which really isn't the idea behind OO, which is modeling behavior.&nbsp; <br><br>Don't worry about many classes; each one should exist to fulfill a use case in your system.&nbsp; It should do that (or help do that, as some use cases will need more than one object) and do that well.&nbsp; <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ppcuban replied on Monday, November 13, 2006</h2><P>Since i am new to the Csla Framework, should i use the 2.o version or go straight to the 2.1?</P>
<P>I have the book, so, my common sense tells me to stick with the version of the book. What do you suggest to me?</P>
<P>&nbsp;</P>
<P>thanks in advance.</P>
<P>Jose</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, November 13, 2006</h2>Go with 2.1; there are enough new and compelling features.&nbsp; Most of the framework is the same as covered in the book.&nbsp; The one big difference that sticks out for me is type level authorization and validation rules, which can yield pretty substancial memory gains, among other things.<br><br>Also, Rocky will soon have a 2.1 ebook out, which will be a supplement to the paper book and just cover the changes.&nbsp; I think its due out soon.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael Hildner replied on Monday, November 13, 2006</h2><P>Funny, I was going to recommend staying with the version that matches the book. I think that Andy's right that there are enough new and compelling features in 2.1, but I fear the frustration of not having an explanation of the new stuff.</P>
<P>Just that I think if you're brand new to CSLA, there enough stuff to learn without getting confused by things that aren't documented.</P>
<P>Also note that there's a bunch of errata in the book - there's a link to the errata for both VB and C# from Rocky's home page. I printed it out, attached it to my book, and marked the relevant pages so I wouldn't miss anything.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ppcuban replied on Monday, November 13, 2006</h2><P>Well, i will stick with the current version of the book but i will look at the other. I am gonna read the book page by page calmly. You are right, i skipped a lot of chapter just looking what i thought was most important but obviously, that was my down fall.</P>
<P>I appreciate all the time you dedicated to me about this topic.</P>
<P>Thanks you all.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ppcuban replied on Tuesday, November 14, 2006</h2><P>For what i understood from chapter 6, Use Cases can be translated&nbsp;as a&nbsp;Form view?</P>
<P>&nbsp;</P>
<P>For example, one form for updating the user is an use case, one for viewing all the user is another use case... am i right?</P>
<P>it makes sense then to design classes for each form SINCE i think we only need to create one form and reuse it everytime we need that use case. am i right?</P>
<P>Good morning... by the way</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, November 14, 2006</h2>Good morning.<br><br>Not quite.&nbsp; See, you don't want to model you business objects after UI requirements.&nbsp; So true requirements won't include any specification at all on the UI.&nbsp; The use case simply will say 'user edits a project,' or in your case, a user.<br><br>So you have a use case for updating a user, a use case for viewing user data, and neither of those should mention the UI at all.<br><br>Does that make sense?<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ppcuban replied on Friday, November 17, 2006</h2><P>Good morning. </P>
<P>Ok. i have a new problem now about the same thing. We have end-of-the-day processing. We have to go through every record in a database and make some changes to some fields. We are talking about 1 million records or more. My plan is to load chunks of those records in a collection, modify them depend on the criteria, and submit it back to the database server.. Ok.</P>
<P>This is what i think. Create a BLB class wich is the collection and another new class ( i already have User, UserInfo) let's call it... UserX wich inherits from BB and make it Child() of the collection so i can update it from the collection. Is that OK?</P>
<P>I wonder how many classes i will need for a system with an almost 300 tables database... </P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, November 17, 2006</h2>I recommend using the concept of "stereotypes" in your object design. A stereotype is a description of common behaviors your objects require to do their job.<br><br>The CSLA base classes support around a dozen stereotypes that should help guide you on which to use. BusinessBase supports the "Editable root" and "Editable child" stereotypes, BLB the "Editable root list" and "Editable child list" stereotypes, etc.<br><br>For batch processing, the reality is that BB and BLB offer a whole lot of features you don't want or need. They exist, in large part, to support some UI concepts like data binding, n-level undo and so forth. The authorization support is probably not too useful for batch processing either.<br><br>Of course they also support validation, which you may want to leverage.<br><br>The thing is, BB and BLB can be used to implement <i>other</i> stereotypes as well - but the coding structure of <i>your </i>business classes would differ from the standard Editable stereotypes. What you need is a "Batch item" stereotype, with a "Batch root list" stereotype.<br><br>The collection structure wouldn't vary much. But your child objects - the Batch items - would have a different structure from a typical editable child.<br><br>Specifically, I wouldn't put calls to CanReadProperty, CanWriteProperty or PropertyHasChanged in your property code. In the property set block I'd call MarkDirty directly, thus bypassing the validation rules and data binding concepts - because they aren't needed there in a batch mode.<br><br>Then I'd explicitly call ValidationRules.CheckRules() just before the object is saved. You might consider creating a Validate() method on your batch objects (and your collection) so you can call myCollection.Validate() to trigger all the rule checking on your whole batch. Then you can decide whether you can save that batch, or the individual items in that batch.<br><br>What I'm getting at is that the Editable root/child stereotype is designed to support interactive UI scenarios. It is not efficient for a batch scenario, because in a batch scenario you typically don't need to check authorization on every property, and you can often just load the object and then check all its rules once right before commiting the data.<br><br>But perhaps more importantly, I recommend implementing batch processing using stored procedures if at all possible. The overhead of moving all your data out of the db, processing it and putting the data back into the db is pretty high. If you can do the work directly in the db you'll get much better overall performance in most cases.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ppcuban replied on Friday, November 17, 2006</h2><P>When you mention "stereotypes" you actually mean Interface and derived classes? So, the combination of those abstract class and Interfaces would create a stereotype?</P>
<P>We know there is a Consulting company close to our area Duluth. We would like them to mentor us about the whole csla framework. Could you give us directions on how to contact them.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, November 17, 2006</h2>




<DIV align=left><SPAN class=378365020-17112006><FONT face=Arial color=#0000ff size=2>No, the term "stereotype" is an OO design term, meaning a 
way of grouping similar objects together.</FONT></SPAN></DIV>
<DIV align=left><SPAN class=378365020-17112006><FONT face=Arial color=#0000ff size=2></FONT></SPAN>&nbsp;</DIV>
<DIV align=left><SPAN class=378365020-17112006><FONT face=Arial color=#0000ff size=2>The technique is useful, because you can often create 
framework support for a stereotype, and this is what I've done with the base 
classes in CSLA. I find it very valuable to look at an object model and to group 
the objects by stereotype (editable objects, read-only objects, root objects, 
child objects, process objects, name/value list objects, 
etc.).</FONT></SPAN></DIV>
<DIV align=left><SPAN class=378365020-17112006><FONT face=Arial color=#0000ff size=2></FONT></SPAN>&nbsp;</DIV>
<DIV align=left><SPAN class=378365020-17112006><FONT face=Arial color=#0000ff size=2>In some object models there will be objects that don't fit 
the common CSLA stereotypes. I am suggesting that you have that case, because 
there are no batch-oriented CSLA stereotypes. However, it is quite realistic to 
create support for a batch-oriented stereotype that would fit within the overall 
structure of CSLA, and that is what I was suggesting.</FONT></SPAN></DIV>
<DIV align=left><SPAN class=378365020-17112006><FONT face=Arial color=#0000ff size=2></FONT></SPAN>&nbsp;</DIV>
<DIV align=left><SPAN class=378365020-17112006><FONT face=Arial color=#0000ff size=2>You can contact Magenic's Atlanta office with the 
information on this page</FONT></SPAN></DIV>
<DIV align=left><SPAN class=378365020-17112006><FONT face=Arial color=#0000ff size=2><A href="http://www.magenic.com/Default.aspx?tabid=411">http://www.magenic.com/Default.aspx?tabid=411</A></FONT></SPAN></DIV>
<DIV align=left><SPAN class=378365020-17112006><FONT face=Arial color=#0000ff size=2></FONT></SPAN>&nbsp;</DIV>
<DIV align=left><SPAN class=378365020-17112006><FONT face=Arial color=#0000ff size=2>Rocky</FONT></SPAN></DIV><BR>
<BLOCKQUOTE>
  <DIV class=OutlookMessageHeader align=left>
  <HR>
  <FONT face=Tahoma size=2><B>From:</B> ppcuban [mailto:cslanet@lhotka.net] 
  <BR><B>Sent:</B> Friday, November 17, 2006 10:13 AM<BR><B>To:</B> 
  rocky@lhotka.net<BR><B>Subject:</B> Re: [CSLA .NET] Is it Root, Parent or 
  Child?<BR></FONT><BR></DIV>
  <DIV></DIV>
  <P>When you mention "stereotypes" you actually mean Interface and derived 
  classes? So, the combination of those abstract class and Interfaces would 
  create a stereotype?</P>
  <P>We know there is a Consulting company close to our area Duluth. We would 
  like them to mentor us about the whole csla framework. Could you give us 
  directions on how to contact them.</P>
  <P>&nbsp;</P><BR><BR><BR></BLOCKQUOTE></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, November 13, 2006</h2>Ok, then you need to ask yourself this:<br><br>What do you need a list of users for?&nbsp; Probably just display I'm assuming.&nbsp; So you'd have a ReadOnlyListBase (Users) and a ReadOnlyBase (UserInfo) to fulfill this requirement, including authorization rules on who may view the data at all.<br><br>Then you probably only edit one user at a time (which is a seperate use case, I would guess).&nbsp; This would be a User object, which subclasses BusinessBase.&nbsp; It has all the knowledge on how to edit a user, including authorization rules.<br><br>Do you ever load a list of users and edit them in one shot?&nbsp; Not likely.&nbsp; If you do, each change to a user is likely independant to changes to another user.&nbsp; In this case, you may want to check out EditableRootList and subclass that.<br><br>Does that help you at all?&nbsp; The more information on your use case you give, the more specific suggestions we can give.<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Monday, November 13, 2006</h2><P>I usually think in terms of Root and Child BOs.</P>
<P>Simple definitions:</P>
<P>Root = BO that can be retrieved and saved to the DB on its own.</P>
<P>Child = BO that is contained by a Root BO (or Collection) and can not be retrieved or saved directly to the DB.</P>
<P>Parent = Any BO that contains other BOs. </P>
<P>e.g. The Root BO is the Parent of the contained collection which is the Parent of the the contained child BOs.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ppcuban replied on Monday, November 13, 2006</h2><P>Expert c# 2005 Business Objects / page 120.</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
