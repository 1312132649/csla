<html><header><title>How check for duplicate records based on nullable properties?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How check for duplicate records based on nullable properties?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7286.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>superkuton posted on Thursday, July 16, 2009</h2>I have a Student BO which has LastName, FirstName, MiddleName and SuffixName properties.<br>SuffixName is nullable.<br><br>I am implementing an ExistsCommand to check whether a duplicate name exists.<br><br>My problem is, how should I query for the duplicate name?<br><br>Thanks.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Thursday, July 16, 2009</h2>Are you just asking how to check for a NULL value of a field in the database? <br /><br />If you are generating the SQL yourself, you typically have to include the condition  IS NULL in your WHERE clause.  You can't use "=" (a common oops). Nothing ever "=" NULL, not even NULL. </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>superkuton replied on Friday, July 17, 2009</h2>I have this query in my DP_Execute in my Exists command:<br><br>&nbsp;_exists = (From p In ctx.DataContext.Students Where p.LastName &amp; p.FirstName &amp; p.MiddleName = _namestring).Count &gt; 0<br><br><br>I did not include the check on SuffixName because it is nullable. When the query encounters a null value, of course, the whole&nbsp; query will result to null.<br><br>How can I include the check for a SuffixName in my query? I am afraid that if I query first for the value of the SuffixName before I query for the whole name that I will be creating two queries.<br><br>How should I query for the duplicate name considering the nullable SuffixName, using only a single query if it is possible?<br><br>If there is a better strategy for checking if a duplicate name exists, please tell me.<br><br>Thanks.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Friday, July 17, 2009</h2><P>Interesting. </P>
<P>I haven't waded into LINQ to SQL yet, but evidently == to an explict null will translate properly:</P>
<P>&nbsp;</P>
<H3 class=subHeading>Null semantics</H3>
<DIV class=subsection>
<P>LINQ to SQL does not impose null comparison semantics on SQL. Comparison operators are syntactically translated to their SQL equivalents. For this reason, the semantics reflect SQL semantics that are&nbsp;defined by server or connection settings. For example, two null values are considered unequal under default SQL Server settings, but you can change&nbsp;the settings to change&nbsp;the semantics. LINQ to SQL does not consider server settings when it translates queries. </P>
<P>A comparison with the literal null is translated to the appropriate SQL version (<SPAN><SPAN class=input><FONT color=#0000ff>is null</FONT></SPAN></SPAN> or <SPAN><SPAN class=input><FONT color=#0000ff>is not null</FONT></SPAN></SPAN>). </P>
<P><A href="http://msdn.microsoft.com/en-us/library/bb399342.aspx">http://msdn.microsoft.com/en-us/library/bb399342.aspx</A></P>
<P>---------------</P>
<P>So, I would think you could use this to check for your SuffixName in your exists command. With my knowledge of LINQ syntax, the easiest way would be to have two different statements. If SuffixName.HasValue, then include the explicit comparison in the first statement, otherwise have a second statement that includes SuffixName == null.</P>
<P>&nbsp;</P></DIV></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
