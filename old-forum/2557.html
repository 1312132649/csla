<html><header><title>AddNewCore, DataGridView Binding, and AllowNew=True</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>AddNewCore, DataGridView Binding, and AllowNew=True</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2557.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dlim posted on Tuesday, March 20, 2007</h2>I have a child list (parent is Product and it loads the list) that inherits BusinessListBase:<br><br><font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ConfigItemList : Csla.BusinessListBase&lt;ConfigItemList, ConfigItem&gt;<br><br></font>I have overridden the AddNewCore method in it to call the Factory NewConfigItem() method in the child object.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font face="Courier New" size="2">protected override object AddNewCore()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ConfigItem item = ConfigItem.NewConfigItem();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add(item);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return item;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br></font><br>In the constructors of the ConfigItemList I've added code to set the AllowNew property to true;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font face="Courier New" size="2">private ConfigItemList()<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.AllowNew = true;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; MarkAsChild();<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; private ConfigItemList(SafeDataReader dr)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.AllowNew = true;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; MarkAsChild();<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Fetch(dr);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</font><br><br>I've created an ObjectDataSource for the Product and a BindingSource (configItemsBindingSource) that uses the Product as the ObjectDataSource and it's ConfigItems list Property as the ValueMember.&nbsp; I have a DataGridView whose DataSource is configItemsBindingSource.&nbsp; I've set the AllowNew property on configItemsBindingSource to true as well.<br><br>I get a new item row in my DataGridView, but short of catching the AddingNew event, I cannot add a new row to the data source without getting an exception saying the constructor of ConfigItem is undefined.&nbsp; The AddNewCore method is never called.&nbsp; <br><br>Am I missing something?&nbsp; Based on all of the documentation (incl Expert C# 2K5) I've read, all I should have to do to use a factory method in the ConfigItem object is override AddNewCore.&nbsp; Anyone else have this problem?<br><br>I'm using the newest version of CSLA and the .NET 2.0 framework.<br><font face="Courier New" size="2"><br><br></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dlim replied on Tuesday, March 20, 2007</h2>Nevermind.&nbsp; It was a stupid mistake.&nbsp; I had forgot to update the DataSource of the BindingSource to point to the actual instance of my collection.&nbsp; Once I added the line<br><br><font face="Courier New" size="2">configItemsBindingSource.DataSource = _currentProduct.ConfigItems;</font><br><br>the problem went away.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
