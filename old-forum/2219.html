<html><header><title>Per Type Rule Example Does Not Compile</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Per Type Rule Example Does Not Compile</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2219.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 posted on Saturday, January 27, 2007</h2><P>The example of per type rules that relate to a specific type (not Common Rules) does not compile.</P>
<P>Can someone please re-write a version of this that works?</P><FONT size=2>
<P>&lt;Serializable()&gt; _<BR></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> Attendee<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Inherits</FONT><FONT size=2> BusinessBase(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> Attendee)</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Private</FONT><FONT size=2> mAge </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer<BR></FONT><FONT color=#0000ff size=2>&nbsp; Private</FONT><FONT size=2> mDrinkingBadge </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean<BR><BR>&nbsp; </FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetIdValue() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> 1<BR>&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>&nbsp; ' other code goes here</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>&nbsp; 'JF fails to compile<BR>&nbsp; </FONT><FONT color=#008000 size=2>'Protected Overrides Sub AddBusinessRules()<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008000 size=2>' ValidationRules.AddRule(AddressOf AllowedToDrink(Of Attendee), "DrinkingBadge")<BR>&nbsp; </FONT><FONT color=#008000 size=2>'End Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> AddBusinessRules()<BR>&nbsp;&nbsp;&nbsp; ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> Attendee)(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> AllowedToDrink(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> Attendee), </FONT><FONT color=#ff00ff size=2>"DrinkingBadge"</FONT><FONT size=2>)<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>'JF fails to compile<BR>&nbsp; </FONT><FONT color=#008000 size=2>'Private Shared Function AllowedToDrink(Of T)(ByVal target As T, ByVal e As Validation.RuleArgs) As Boolean<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008000 size=2>' If target.mAge &lt; 21 AndAlso target.mDrinkingBadge Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008000 size=2>' e.Description = "Can not drink if under 21"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008000 size=2>' Return False<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008000 size=2>' Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008000 size=2>' Return True<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008000 size=2>' End If<BR>&nbsp; </FONT><FONT color=#008000 size=2>'End Function</FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#008000>'JF fails to compile - mAge is not a member of Attendee</FONT><BR>&nbsp; Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> AllowedToDrink(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> Attendee)(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> target </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Attendee, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Validation.RuleArgs) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> target.mAge &lt; 21 </FONT><FONT color=#0000ff size=2>AndAlso</FONT><FONT size=2> target.mDrinkingBadge </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>e.Description = </FONT><FONT color=#ff00ff size=2>"Can not drink if under 21"<BR>&nbsp; &nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>False<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>True<BR>&nbsp; &nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>' other code goes here</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</P></FONT>
<P>&nbsp;</P>
<P>Joe</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
