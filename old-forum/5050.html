<html><header><title>All business logic in a root BO?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>All business logic in a root BO?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5050.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jureleskovec posted on Wednesday, July 02, 2008</h2>This is a general questions which arose as a problem in my project i don't know how to solve (properly).<br><br>REQUIREMENTS:<br>Let's say we have 3 BOs (classes):<br>- 'Root' class with properties 'P1' (of type Child1) and 'P2' (of type Child2)<br>- 'Child1' class with property 'Value'.<br>- 'Child2' with property 'Value'<br><br>When 'root.P1.Value' changes to true, the 'root.P2' should be set to some other 'XXX' object (maybe a new one).<br>Child1 class should also have the validation rule which includes also check of the 'root.P2.Value':<br>if (root.P2.Value)<br>{....}<br>Also (which is obvious), this validation method (in Child1) should also be triggered by the change of the 'root.P2.value'.<br><br><br>PROBLEM(S):<br>The first problem is that Child1 can't reference the root nor the root.P2 objects since this would result into a circular reference which as far as I know are in csla forbidden.<br><br>The second one is about the fact that validation method will invoke before the 'PropertyHasChanged' where the 'root.P2' is set when property 'Child1.Value' has changed -&gt; validation method will be checkin the 'root.P2.Value' of the old 'root.P2'.<br><br><br>Thx for any help,<br>-- jure<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>triplea replied on Thursday, July 03, 2008</h2><P>Well as you say in your subject why not move the logic from the child BOs to the parent? I would do the following:</P>
<UL>
<LI>In OnPropertyChanged of P1 you raise an event say P1ValueChanged which 'Root' subscribes to.</LI>
<LI>Write a handler in 'Root' for P1Valuechanged (dont forget to += in all appropriate locations) which does whatever you want it to do on Root.P2</LI>
<LI>Write your validation rule on 'Root' rather than P1 or P2</LI></UL>
<P>That should do the trick?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jureleskovec replied on Thursday, July 03, 2008</h2>Thanks, man<br><br>So, do you thing that in general all the business rules should be defined in root BO? In my case the Child1 should (is responsible for) actually create/update root.P2, or....<br><br>And about the validation method. If validation method validates values of properties of the Child1 class then it should be defined in the 'Child1':<br>- it should be called by the 'Child' object when needed (in Child_Create, ...).<br>- in WPF i have binding set to the 'root.P1' and I supose the only way the error provider can work is to have the validation method in the class of the 'root.P1'.<br><br>-- Jure<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, July 03, 2008</h2><P>In general the root BO should have only its own rules plus those rules which require coordination between its children. The child BOs should validate themsleves internally most of the time.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>triplea replied on Friday, July 04, 2008</h2><P>Well Joe gave you the definition.</P>
<P><STRONG>So, do you thing that in general all the business rules should be defined in root BO?</STRONG><BR>No and I will quote Joe: "the root BO should have only its own rules plus those rules which require coordination between its children"</P>
<P><STRONG>In my case the Child1 should (is responsible for) actually create/update root.P2<BR></STRONG>No (again :-) ) in my view Child1 is responsible for generating the trigger for creating/updating Child2. Root is responsible of noticing the trigger went off and create/update Child2. Remember that Child2 "belongs" to Root so Root can access and modify it whereas Child1 can't and shouldn't.</P>
<P>Regarding the validation... From what I understood from your previous post, your validation goes something like this: If Root.Child1.Value = true then Root.Child2.Value = "something" (or anyway something liek that). This rule fits in Root. If you are purely validating Child1 properties and dont care about Child2 then indeed it fits in Child1.<BR>Finally, I havent played too much with WPF yet so cant help you there. But from what I understand, yuor issue is how to notify the user that Child2 is invalid if the rule gets implemented in Root. Well you cant but since Child2 is set by your business rule/logic, you cant expect the user&nbsp; to do much about it since it would be a bug! So just get it right and dont worry about the error provider in this instance :-)</P>
<P>Anyway the above are just my view. I am sure you can take the points you need and make them work for you.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jureleskovec replied on Monday, July 07, 2008</h2>Thanks folks, this makes sense but it is a complicated solution. It's a pitty circular references are not allowed.<br>As for validation rules, they are in general 'bound' to particular property. So they should be defined in class that has that property. My example is more complex because a validation method for some property takes into account also some property from another object.<br><br><br>-- Jure<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
