<html><header><title>Validation Rule Flexibility</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Validation Rule Flexibility</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1914.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>MadGerbil posted on Wednesday, December 06, 2006</h2><P>I've an object that can be one of three different 'modes'.&nbsp; It can be an employee, a student, or a private individual - just for an example.&nbsp;&nbsp; Each one of these has a different set of business rules so when the object is created I ask what 'version' of the object is required and set the validation rules as the object is being created.</P>
<P>This is happening on the web in a wizard, so when the person goes onto step 2 if they decide to back track and change the mode from employee to student I want to be able to clear out the current validation rules and place a different set in there.</P>
<P>The current validation rules object doesn't have a 'clear' method.</P>
<P>Is there a way to make this work?&nbsp; I don't wanna use inheritance because the differences between these three types is only 3-6 rules out of 20.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Wednesday, December 06, 2006</h2>I would add all the rules and inside the rule do something like:<br><br>If target.mMode &lt;&gt; "Student" Then<br>&nbsp;&nbsp;&nbsp; Return True&nbsp; <br>End If<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Wednesday, December 06, 2006</h2>Sorry, I unintentionally hit "post".<br><br>Anyway, as for the reason, if you use type rules, the rules are only "created" once and apply to all objects of the same type. Creating a rule (by calling AddRules) takes far more time than that conditional check inside your rule, even when the rule may run several times.<br><br>Andrés<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MadGerbil replied on Wednesday, December 06, 2006</h2><P>Dude, that idea rocks!</P>
<P>Thanks a bunch - I can see how that would be much more flexible in the long run and much easier to work with over all.&nbsp; Thanks a bunch.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, December 06, 2006</h2>Andres suggestion is fine, but be careful.&nbsp; It almost sounds like you have different use cases (adding a student, employee or private individual).&nbsp; This could lead to problems down the road when the behavior of student becomes wildly different than employee or private person.&nbsp; Not saying its for sure, only you know your requirements, but it is something you should watch for.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Wednesday, December 06, 2006</h2>Yes Andy, I tend to agree that if you have very different use cases, you need different objects, but his scenario is more similar to something like:<br><br>If the client lives in an appartment building, specify which floor, otherwise, it's not required.<br><br>So the rule would look like:<br><br>Private Shared Function .....<br>If Not target.mLivesInAnAppartmentBuilding Then<br>&nbsp;&nbsp;&nbsp; Return True<br>End If<br>If target.mFloor.Equals(String.Empty) Then<br>&nbsp;&nbsp;&nbsp; e.Description = "Specify a floor"<br>&nbsp;&nbsp;&nbsp; Return False<br>Else<br>&nbsp;&nbsp;&nbsp; Return True<br>End If <br>End Function<br><br>Yeah, I know it's not the perfect example, but the point remains, you're not going to make 2 Client objects just because one could live in an appartment and the other in a house...<br><br>Andrés<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, December 06, 2006</h2>I agree, but just thought a warning was in order anyway.&nbsp; Just from the names of the classes, it seems like its at least possible that there are things you can do with a student that you can't with an employee, such as generate a transcript.  <br><br>Actually your example is quite a good one to show how rules can change based on the state of the BO.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Wednesday, December 06, 2006</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>MadGerbil:</strong></div><div>
<P>I've an object that can be one of three different 'modes'.&nbsp; It can be an employee, a student, or a private individual - just for an example.&nbsp;&nbsp; Each one of these has a different set of business rules so when the object is created I ask what 'version' of the object is required and set the validation rules as the object is being created.</P>
<P></div></BLOCKQUOTE></P>
<P>My wife is BOTH an employee of a&nbsp;university and a student.&nbsp;&nbsp; In addition, in some of her dealings with the university, she is acting as an employee (reporting grades for her students), in others she is acting as a private individual (donating books to the university library from our own library).</P>
<P>So, I have to ask you, are you sure that a person can only be one of those three things at any one point in time?&nbsp;&nbsp; Or is mode representing the role the person is acting within at a given point in time?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MadGerbil replied on Thursday, December 07, 2006</h2><P>The concerns brought up by some posters in this thread are all valid; and that is because I wasn't very thorough in describing the object with which I'm working.</P>
<P>I have a check object (like a purchase order) and the type of payee can be student, employee, or business - so address I wish to collect may have some different options based upon whether or not I'm collecting a single name (for a business) or a first and last name for an individual.</P>
<P>Obviously I don't want to show the first name/last name field on a voucher that is of type Business - nor do I want to validate those fields. (or the validation should always return true)</P>
<P>The type of payee is important only for the address and some reporting purposes and the type of payee is a property of the object itself - not so much a description of separate objects.&nbsp; That is to say, I don't have a student object, an employee object, and a staff object because there is no need for that.</P>
<P>So the concerns brought up in this thread are valid - if I were actually trying to somehow merge a student/employee/business into one object.&nbsp; In that case, inheritance would make more sense and with that the business rules would obviously work themselves out.</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, December 07, 2006</h2>Ahh, that does make much more sense.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Thursday, December 07, 2006</h2><P>I had an object that was used to display a variety of different transaction types.&nbsp; Each transaction type had its own set of properties (some of which were used by more than one transaction type).</P>
<P>I only wanted my UI control to display the relevant properties for that transaction type (plus the headers).&nbsp; So, I set up my object with a set of Show&lt;PropertyName&gt; booleans.&nbsp; If the property applied to that transaction type, I set the Show&lt;PropertyName&gt; for it to true, otherwise I set it to false.&nbsp; All the logic to set those booleans was in one function, and each property that might change what I could do called it after setting the new value.&nbsp; (Plus, of course, the Fetch routine for loading it from the database.)</P>
<P>For the items in the control, I set the visible property on or off based upon the show property.&nbsp; Worked very well.&nbsp; Was even able to turn rows on or off (inserts/deletes just needed to show new data, updates needed to show new and old values) using this trick.</P>
<P>You could also put logic in the set properties to verify that the property is applicable before accepting the value, in case you don't trust your GUI programmers.&nbsp;&nbsp; I never do - even if it's me. :)</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
