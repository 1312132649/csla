<html><header><title>Binding multiple views to a single BO</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Binding multiple views to a single BO</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11928.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>c_manboy posted on Tuesday, April 09, 2013</h2><p>I&#39;m doing some multiple bindings to&nbsp;a single BO in WPF and would appreciate some feedback in case I&#39;m going down a bad path.</p>
<p>I have created a &quot;ViewModelConductor(of M)&quot; which will import child &quot;ViewModel(of M)&quot;.&nbsp;&nbsp;The conductor will be responsible for the fetch/save/cancel/etc. and for setting the child ViewModel&#39;s model property.&nbsp;So far everything works very well.&nbsp; Fetch sets all child model properties, and save calls ApplyEdit on all child model properties&nbsp;followed by a&nbsp;beginsave on the conductor model.&nbsp; </p>
<p>(I should add that my viewmodel(of M) is cslacontrib screenwithmodel(of M) for use with caliburn micro.&nbsp; And my conductor is really a modification of CM conductor class which conducts the screenwithmodel class and contains its own model property).</p>
<p>My issue is with Cancel.&nbsp; Depending on various combinations of canceledit and beginedit, cancel will either work periodically or fail outright.&nbsp; Either way it fails to work consistently.</p>
<p>I read <a href="http://forums.lhotka.net/forums/p/9721/45746.aspx#45746" title="this post">this post</a> which states that n-level undo is unsupported in these scenarios.&nbsp; But in <a href="http://forums.lhotka.net/forums/p/10814/50425.aspx" title="this post">this post</a> I read that v4 supports multiple binding scenarios.</p>
<p>My current workaround is this method on my conductor DoCancel override:</p>
<pre style="font-size:13px;font-family:Consolas;background:white;color:black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">For</span>&nbsp;<span style="color:blue;">Each</span>&nbsp;item&nbsp;<span style="color:blue;">In</span>&nbsp;<span style="color:blue;">Me</span>.Items
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">If</span>&nbsp;item.IsScreenCreated&nbsp;<span style="color:blue;">Then</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Dim</span>&nbsp;screen&nbsp;=&nbsp;<span style="color:blue;">TryCast</span>(item.Screen,&nbsp;<span style="color:#2b91af;">ScreenWithModel</span>(<span style="color:blue;">Of</span>&nbsp;<span style="color:#2b91af;">TModel</span>))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">If</span>&nbsp;screen&nbsp;<span style="color:blue;">IsNot</span>&nbsp;<span style="color:blue;">Nothing</span>&nbsp;<span style="color:blue;">AndAlso</span>&nbsp;screen.Model&nbsp;<span style="color:blue;">IsNot</span>&nbsp;<span style="color:blue;">Nothing</span>&nbsp;<span style="color:blue;">Then</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Dim</span>&nbsp;undoable&nbsp;=&nbsp;<span style="color:blue;">TryCast</span>(screen.Model,&nbsp;<span style="color:#2b91af;">ISupportUndo</span>)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">If</span>&nbsp;undoable&nbsp;<span style="color:blue;">IsNot</span>&nbsp;<span style="color:blue;">Nothing</span>&nbsp;<span style="color:blue;">Then</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;undoable.CancelEdit()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">End</span>&nbsp;<span style="color:blue;">If</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;screen.Model&nbsp;=&nbsp;<span style="color:blue;">Nothing</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">End</span>&nbsp;<span style="color:blue;">If</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">End</span>&nbsp;<span style="color:blue;">If</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">Next</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:green;">&#39;call&nbsp;canceledit&nbsp;and&nbsp;beginedit&nbsp;on&nbsp;conductor&nbsp;model</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">MyBase</span>.DoCancel()</pre>
<pre style="font-size:13px;font-family:Consolas;background:white;color:black;"><pre style="font-size:13px;font-family:Consolas;background:white;color:black;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:green;">&#39;set&nbsp;children&nbsp;model&nbsp;property&nbsp;to&nbsp;conductor&nbsp;model</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ChangeModel(<span style="color:blue;">Nothing</span>,&nbsp;<span style="color:blue;">Me</span>.Model)</pre>
<pre style="font-size:13px;font-family:Consolas;background:white;color:black;"></pre>
<pre style="font-size:13px;font-family:Consolas;background:white;color:black;"><p>This code seems to work, but I would appreciate any feedback concerning this process.</p></pre>
</pre></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
