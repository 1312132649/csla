<html><header><title>CSLA inheritance problem</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA inheritance problem</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/206.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>kucing posted on Friday, May 26, 2006</h2>I have inheritance that looks like this:<br>Base class: animal<br>Children classes: cat, dog<br><br>My animal class looks like this (some codes omitted):<br><br><blockquote>public class Animal&lt;T&gt; : BusinessBase&lt;T&gt; where T : Animal&lt;T&gt;<br>{<br>&nbsp;&nbsp; &nbsp;...<br>}<br></blockquote><br>Cat looks like this:<br><blockquote>public class Cat : Animal &lt;Cat&gt;<br>{<br>&nbsp;&nbsp; &nbsp;[Serializable()]<br>&nbsp;&nbsp; &nbsp;private class Criteria {}<br><br>&nbsp;&nbsp; &nbsp;[RunLocal()]<br>&nbsp;&nbsp; &nbsp;private void DataPortal_Create(Criteria criteria){}<br><br>&nbsp;&nbsp; &nbsp;private void DataPortal_Fetch(Criteria criteria) {}<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;[Transactional(TransactionalTypes.TransactionScope)]<br>&nbsp;&nbsp; &nbsp;protected override void DataPortal_Insert() {}<br><br>&nbsp;&nbsp; &nbsp;[Transactional(TransactionalTypes.TransactionScope)]<br>&nbsp;&nbsp; &nbsp;protected override void DataPortal_Update() {}<br>&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;[Transactional(TransactionalTypes.TransactionScope)]<br>&nbsp;&nbsp; &nbsp;private void DataPortal_Delete(Criteria criteria) {}<br>}<br></blockquote><br>So the only functions that Cat has are the data access ones.<br><br>Class Animal contains: <br><br><blockquote>[RunLocal()]<br>public static T NewAnimal()<br>{<br>&nbsp;&nbsp; &nbsp;if (!CanAddObject())<br>&nbsp;&nbsp; &nbsp;{<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;throw new System.Security.SecurityException("User not authorized to breed an animal");<br>&nbsp;&nbsp; &nbsp;}<br>&nbsp;&nbsp; &nbsp;return DataPortal.Create&lt;T&gt;();<br>}<br><br>public static T GetAnimal(Guid id)<br>{<br>&nbsp;&nbsp; &nbsp;if (!CanGetObject())<br>&nbsp;&nbsp; &nbsp;{<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;throw new System.Security.SecurityException("User not authorized to view an animal");<br>&nbsp;&nbsp; &nbsp;}<br>&nbsp;&nbsp; &nbsp;return DataPortal.Fetch&lt;T&gt;(new Criteria(id));<br>}<br><br>public static void DeleteAnimal(Guid id)<br>{<br>&nbsp;&nbsp; &nbsp;if (!CanDeleteObject())<br>&nbsp;&nbsp; &nbsp;{<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;throw new System.Security.SecurityException("User not authorized to kill an animal");<br>&nbsp;&nbsp; &nbsp;}<br>&nbsp;&nbsp; &nbsp;DataPortal.Delete(new Criteria(id));<br>}<br><br>public override T Save()<br>{<br>&nbsp;&nbsp; &nbsp;...<br>&nbsp;&nbsp; &nbsp;return base.Save();<br>}<br></blockquote><br>Whenever I call Animal.NewAnimal to create a new animal, it works nicely. Saving also works.<br><br>However, if I try to fetch or delete, I always get this error message:<br><span>Cannot create an instance of Animal`1[T] because Type.ContainsGenericParameters is true.</span><br>on DataPortal.Fetch and DataPortal.Delete.<br><br>What is happening?<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>glenntoy replied on Friday, May 26, 2006</h2>Hmm.. try removing your constraints in your Animal class first and see what happens if you have the same error. </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Friday, May 26, 2006</h2>Your criteria is in your animal class? Dataportal gets the type you want to load from the criteria. Although it should pay attention to the generic param in Fetch&lt;whatever&gt;(). I think Rocky said he'd fix that.<br><br>Also, if you're trying to create an instance of the animal class (even unvoluntarily), you can't because it has generic parameters that you need to provide. Do your subclasses define criteria and their own dataportal methods, or you're using the base class's criteria and methods?<br><br>Are you by any chance doing something like Animal.GetAnimal(id) and expecting it to return the correct type?<br><br>Andrés<br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, May 26, 2006</h2><P>If you want Criteria to be in your base class, you need to have it inherit from CriteriaBase. This allows you to specify the specific type of object the data portal should create.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kucing replied on Friday, May 26, 2006</h2>Glenntoy: I tried removing the constraint before and I am sure it will throw some errors about not being able to use BusinessBase functions since T is not restricted.<br><br>xal: I never try creating animal object. The subclasses does not define their own criteria but they have the data portal methods. I always create cat and dog by: Cat obj = Cat.NewAnimal();<br><br>xal + Rocky: Yes, my criteria is in my base class. I had suspicion that somehow criteria is causing the problem but I did not know how to fix it.<br><br>So to fix my problem I have to make sure that Criteria inherits from CriteriaBase (since it is located in class Animal)? I'll try that next week! :)<br><br>Thanks for the replies guys!</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tsaltd replied on Monday, January 08, 2007</h2><P>I suppose the answer is "it depends on the Use Case", but I'll ask anyway .... are there pros / cons re: maintaining an Animal.Type in the Animal class ??&nbsp;</P>
<P>The Type would be a literal "cat" or a code that would reference a lookup table of Animal Types.</P>
<P>Any debate on the subject or an accepted best practice ???</P>
<P>Thanks,</P>
<P><BR>Steve</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, January 09, 2007</h2>It does depend on the use case.&nbsp; If a Cat object will have different behaviors than a Fish object (for example, they both implement Move, but differently) then you'll want subclasses or possibly seperate classes (an Animal would becoming IAnimial).&nbsp; If the behavior of your Cat and Fish class will be the same then a type property + NVL would be more appropriate.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>thornfield_he replied on Thursday, July 21, 2011</h2><p><span><span title="点击可显示其他翻译" class="hps">I am</span>&nbsp;<span title="点击可显示其他翻译" class="hps">confused</span>&nbsp;<span title="点击可显示其他翻译" class="hps">on how to</span>&nbsp;<span title="点击可显示其他翻译" class="hps">implement generic</span>&nbsp;<span title="点击可显示其他翻译" class="hps">inheritance in csla.net</span><span title="点击可显示其他翻译">,</span>&nbsp;since<span title="点击可显示其他翻译" class="hps">&nbsp;read your</span>&nbsp;<span title="点击可显示其他翻译" class="hps">code</span><span title="点击可显示其他翻译">,</span>&nbsp;<span title="点击可显示其他翻译" class="hps">I understood how.Thank you!</span></span></p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
