<html><header><title>Csla with Wcf Compression on remote host fails</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Csla with Wcf Compression on remote host fails</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9739.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Savij posted on Wednesday, November 10, 2010</h2><p>Hello,</p>
<p>I followed the instructions in the F.A.Q. about setting up compression. I am using Siverlight 4, Csla 4.0.0 and .net 4 in Visual Studio 2010. When using localhost everything works and compress/decompress is fine. I am using the cSharpZipLib as stated in the F.A.Q. as well.</p>
<p>When I move this to a remote host Wcf fails. The failure is an http 500 and the message I get back is &quot;NOTFOUND&quot;. If I remove the compression, the project runs fine. So, it has something to do with the compression (I am thinking it might be configuration). </p>
<p>Here is my web.config Wcf section:</p>
<p>&nbsp; &lt;system.serviceModel&gt;<br />&nbsp;&nbsp;&nbsp; &lt;services&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;service behaviorConfiguration=&quot;WcfPortalBehavior&quot; name=&quot;TaskManagement.Library.Compression.CompressedHost&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;endpoint address=&quot;&quot; binding=&quot;basicHttpBinding&quot; contract=&quot;Csla.Server.Hosts.Silverlight.IWcfPortal&quot; bindingConfiguration=&quot;BasicHttpBinding_IWcfPortal&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;identity&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;dns value=&quot;Stage01&quot; /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/identity&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/endpoint&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/service&gt;<br />&nbsp;&nbsp;&nbsp; &lt;/services&gt;<br />&nbsp;&nbsp;&nbsp; &lt;behaviors&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;serviceBehaviors&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;behavior name=&quot;returnFaults&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;serviceDebug includeExceptionDetailInFaults=&quot;true&quot; /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/behavior&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;behavior name=&quot;WcfPortalBehavior&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;serviceMetadata httpGetEnabled=&quot;true&quot; /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;serviceDebug includeExceptionDetailInFaults=&quot;true&quot; /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;serviceAuthorization impersonateCallerForAllOperations=&quot;true&quot; /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/behavior&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/serviceBehaviors&gt;<br />&nbsp;&nbsp;&nbsp; &lt;/behaviors&gt;<br />&nbsp;&nbsp;&nbsp; &lt;bindings&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;basicHttpBinding&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;binding name=&quot;BasicHttpBinding_IWcfPortal&quot; maxBufferSize=&quot;10000000&quot; maxReceivedMessageSize=&quot;10000000&quot; receiveTimeout=&quot;00:10:00&quot; sendTimeout=&quot;00:10:00&quot; openTimeout=&quot;00:10:00&quot; closeTimeout=&quot;00:10:00&quot; useDefaultWebProxy=&quot;false&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;readerQuotas maxBytesPerRead=&quot;10000000&quot; maxArrayLength=&quot;10000000&quot; maxStringContentLength=&quot;10000000&quot; /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;security mode=&quot;TransportCredentialOnly&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;transport clientCredentialType=&quot;Windows&quot; /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/security&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/binding&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/basicHttpBinding&gt;<br />&nbsp;&nbsp;&nbsp; &lt;/bindings&gt;<br />&nbsp; &lt;/system.serviceModel&gt;</p>
<p>I also change the svc file to point to :<br />TaskManagement.Library.Compression.CompressedHost<br />(Same as the Service name)</p>
<p>I also add the&nbsp;&nbsp;Csla.DataPortal.ProxyTypeName in the silverlight application.</p>
<p>Again everything works till I move it to my Stage01 server.</p>
<p>I am stuck on this. Can anyone help shed some light?</p>
<p>Thanks,</p>
<p>Jeff</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, November 10, 2010</h2><p>You changed your svc file to use the new host type?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Savij replied on Wednesday, November 10, 2010</h2><p>Yes, the svc file is set to the same thing as the Service Name:</p>
<p>&lt;%@ ServiceHost Language=&quot;C#&quot; Debug=&quot;true&quot; Service=&quot;TaskManagement.Library.Compression.CompressedHost&quot; %&gt;</p>
<p>I stated that in my first email, but it may not have been clear. The above line is in place though and it doesnt work when not on localhost.</p>
<p>&nbsp;</p>
<p>-Jeff</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, November 10, 2010</h2><p>Some people have reported issues with that compression library in SL4 and .NET 4. I haven&#39;t personally encountered issues, but others have. Perhaps you should try a different compression library.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Savij replied on Monday, November 15, 2010</h2><p>I was working on this from a co-workers machine at the time. For some reason, I moved to my computer and did the same steps and it worked like a charm. I could not see any typos but it is possible there was one?? I don&#39;t know why it didnt work before, but it&#39;s now in production and working well. I can&#39;t say that I love the performance on slower machines, but after talking to Microsoft support about the performance issues, I learned that although Silverlight is supported by older computers, performance is not good on them. First time renders are really slow (up to 12 seconds on some of them when looking via Fiddler or httpWatch) and round trip WCF calls are a&nbsp;few seconds each time as well. On new fast machines performance is not bad at all though.According to Microsoft support, there is no way to speed up the render time for the first screen on slower processor machines (I am talking about P4 CPU&#39;s with sub 2ghz speeds).</p>
<p>That part is not a CSLA thing, I just wanted to pass along what I learned. I implemented compression because of performance, so I thought the info was relevant. Hope it&#39;s informative to others.</p>
<p>-Jeff</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>richardb replied on Tuesday, November 16, 2010</h2><p>Interesting info on the performance aspect, as I&#39;m finding similar things on a full blown WPF Windows application.&nbsp; Much of our PC base is old (3 / 4 years old - not many iCore&#39;s in sight) and while getting the data out into our CSLA objects is fine, the WPF rendering/binding performance is shocking.&nbsp; For our users with newer machines it&#39;s an order magnitude better and then some.</p>
<p>A similar WIndows Winforms app runs lovely on same machines - WPF rendering just really needs decent kit (dedicated graphics card) to be useable.</p>
<p>Seems we are due a Windows 7 / PC rollout next year so looking forward to better WPF performance.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Savij replied on Tuesday, November 16, 2010</h2><p>Yeah we are also rolling out new PC&#39;s next year sometime so it should be better. We also are using a Winforms app on the same box and performance there is really good, even on the same slow pc&#39;s. The main difference is that on those pc&#39;s we are using Remoting instead of WCF. We tried WCF instead at one point but we have remote locations one from Florida to Las Vegas and the Vegas office performance was terrible compared to Remoting. We tried tweaking everything we could but Remoting was so much faster, we opted to stay with the older technology.</p>
<p>Once you get used to coding in Silverlight/WPF it&#39;s hard to go back. Databinding and such is so nice compared to Winforms. I also love the Silverlight deployment model. I just wish Microsoft would do something about the rendering and WCF performance. I am using transparancies and gradients all over my winforms app and even the simplest Silverlight view renders poorly (performance wise that is) compared to the winforms view. I guess if Microsoft at least would tell us what CPU/GPU to use minimum to get good performance we could follow that and maybe not make a choice to use the technology till we upgrade the older pc&#39;s. I asked and they couldnt tell me. They just said it was pure CPU power as far as rendering the first view.</p>
<p>-Jeff</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
