<html><header><title>Getting broken rules for individual property</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Getting broken rules for individual property</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4384.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>vdhant posted on Thursday, February 21, 2008</h2><P class=MsoNormal><FONT face=Arial color=#000000>Hi guys <BR>I was just wondering if anyone has any idea (and i might have missed something so it might be really obvious) how to get the broken rules for an individual property. What i would like to have is a tool tip that lists the broken rules for an individual field on the form as well as the main list of rules. Also in addition to this whether an individual property is valid or not.<BR><BR>I know I would loop through the broken rules collection for this information but it seems like a bit of a roundabout way of doing it.</FONT></P><SPAN><FONT face=Arial><FONT color=#000000><SPAN>&nbsp;</SPAN><BR>Thanks <BR>Anthony</FONT></FONT> </SPAN></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, February 21, 2008</h2>Databinding actually uses the interface System.ComponentModel.IDataErrorInfo which is also implemented by CSLA BusinessObjects - but you must explicitly cast your object to the interface in order to use these methods. <br><br>Using this interface you can get error messages for a given Item (Property) or Error (the entire object). It is this interface that the ErrorProvider control uses to get broken rules messages for a given property in a form. <br><br>More info on this interface is available here:<br>http://msdn2.microsoft.com/en-us/library/system.componentmodel.idataerrorinfo_members.aspx<br><br>/jonny <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>vdhant replied on Thursday, February 21, 2008</h2><P>Hey Jonny<BR>Thanks for the reply. I have seen this interface and know what you are getting at but the problem is that this only returns the first message. I need the list of errors/messages avaiable so that i can use them.<BR>Any ideas on doing this??<BR>Thanks <BR>Anthony</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, February 21, 2008</h2><P>In CSLA 2.x there is this method: (not sure about what is CSLA 3.x yet.)</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overloads</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> ToString(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> severity </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> RuleSeverity) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> result </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> System.Text.StringBuilder()<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> item </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> BrokenRule<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> first </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean</FONT><FONT size=2> = </FONT><FONT color=#0000ff size=2>True</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp; For</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Each</FONT><FONT size=2> item </FONT><FONT color=#0000ff size=2>In</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Me<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> item.Severity = severity </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> first </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>first = </FONT><FONT color=#0000ff size=2>False<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>result.Append(Environment.NewLine)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If<BR>&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>result.Append(item.Description)<BR>&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Next</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Return</FONT><FONT size=2> result.ToString<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT></P>
<P><FONT size=2><FONT color=#000000>1. You&nbsp; can write a similar method and pass in a Property name instead of a rule severity. By adding a new method to CSLA you always have access to it.</FONT></FONT></P>
<P><FONT size=2>2. Suggest the above to Rocky - so you do not have to maintain it. &lt;g&gt;</FONT></P>
<P><FONT size=2>Joe</FONT></P>
<P><FONT size=2>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, February 21, 2008</h2><FONT color=#0000ff size=2>
<P>var</FONT><FONT size=2> broken = </FONT><FONT color=#0000ff size=2>from</FONT><FONT size=2> r </FONT><FONT color=#0000ff size=2>in</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.BrokenRulesCollection </FONT><FONT color=#0000ff size=2>where</FONT><FONT size=2> r.Property = IdProperty.Name </FONT><FONT color=#0000ff size=2>select</FONT><FONT size=2> r;</P></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
