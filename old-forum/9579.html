<html><header><title>CSLA 4.0 - Binding  ViewModel&lt;T&gt; properties with Main ToolBar</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA 4.0 - Binding  ViewModel&lt;T&gt; properties with Main ToolBar</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9579.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>HK.Lee posted on Monday, September 27, 2010</h2><p>Hi All,</p>
<p>Let&#39;s say 1 view acts just as layout container with toolbar and can contain other kind of views. Imagine layout view as outlookbar style view which has panelbar menus in right side and&nbsp;CRUD button toolbar on top side. &nbsp;Whenever right menu clicked, each view opened in left tabbed region,but each view has no CRUD button. </p>
<p>On&nbsp;CAB/SCSF days, I had a&nbsp;base presenter&nbsp;interfaced with&nbsp;state proeprties and related method&nbsp;such as ViewModel does&nbsp;, then layout view&#39;s presenter or&nbsp;controller&nbsp;&nbsp;can&nbsp;transfer command to related view&#39;s presenter&nbsp;without knowing&nbsp;each type as followings ;</p>
<p style="padding-left:30px;">IView activeView = myLeftRegion.GetActiveView();&nbsp;&nbsp;</p>
<p style="padding-left:30px;">&nbsp;IPresenter presenter = activeView.Presenter;</p>
<p style="padding-left:30px;">presenter.Save();</p>
<p>&nbsp;and&nbsp;toolbar&nbsp;button enability also sticked with presenter&#39;s CanXXX state.</p>
<p>However in&nbsp;ViewModelBase&lt;T&gt;,&nbsp;it&nbsp;already&nbsp;&nbsp;has all necessary method and properties, that is, if I can grab which ViewModelBase&lt;T&gt; is now active view&#39;s one then&nbsp;everything looks fine. So I&nbsp; created layout viewmodel acting as a controller and&nbsp;&nbsp;inherited from DependancyObject. However I am stucked how to declare a property which can hold active view&#39;s viewmodel. </p>
<p>Is there a way to declare ViewModel&lt;T&gt;&nbsp;&nbsp;as followings such as MVVM 4.0 SlDemo does ?</p>
<p>&nbsp;public class EmployeeItemViewModel: DependencyObject<br />&nbsp; {<br />&nbsp;&nbsp;&nbsp; public static readonly DependencyProperty ModelProperty =<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DependencyProperty.Register(&quot;Model&quot;, typeof(Library.EmployeeEdit), typeof(EmployeeItemViewModel), null);</p>
<p>&nbsp;&nbsp;&nbsp; public Library.EmployeeEdit Model<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return (Library.EmployeeEdit)GetValue(ModelProperty); }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set { SetValue(ModelProperty, value); }<br />&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;Or Should I follow old way creating specific interface nearly same with ViewModelBase&nbsp;?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>Any advice would be appreciated. Thank you in advance.</p>
<p>HK.Lee</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, September 30, 2010</h2><p>I haven&#39;t tried this, so I don&#39;t have a firm answer.</p>
<p>Data binding ignores interfaces, and uses reflection against the target object. So for data binding it really won&#39;t matter if your property uses an interface type or a concrete type or even an abstract type. At runtime data binding will use reflection to get/set any property values you use in a binding expression.</p>
<p>Which means that you should be able to make your property be of type object or DependencyObject and it should work.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>HK.Lee replied on Friday, October 01, 2010</h2><p>Thank you, Rocky.</p>
<p>I created interface nearly same with ViewModelBase&lt;T&gt;&#39;s CanXXX properties and events as did before and attached it in my subclassed viewmodel base class. Now outside layoutview can configure which viewmodel he should handles and get CanXXX values.</p>
<p>RGDS</p>
<p>HK.Lee&nbsp;</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
