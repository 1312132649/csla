<html><header><title>LinqBindingList and join query</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>LinqBindingList and join query</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7081.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>tchimev posted on Thursday, June 11, 2009</h2>I use CSLA 3.6.3<br>I would like to use LinqBindingList so I can bind the result from a linq query to a win form control through Visual Studio designer.<br><br>I have two collections:<br><br>BLBEmployees1&lt;BO.User&gt;<br>BLBEmployees2&lt;BO.User&gt;<br><br>The collections contain different employees.<br>I want my linq query to return only employees that are contained in both collections.<br><br>So my query look like this:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LinqBindingList&lt;BO.User&gt; result = (from e1 in BLBEmployees1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; join e2 in BLBEmployees2 on e1.ID equals e2.ID<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; orderby e1.Name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; select e1) as LinqBindingList&lt;BO.User&gt;;<br><br>But after I run the query the 'result' is null!<br><br>If I rewrite that query to return IQuerable&lt;BO.User&gt; I get a valid result but I cannot bind it to a control through the Visual Studio designer.<br><br>Could someone help me with that query?<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tchimev replied on Thursday, June 11, 2009</h2>Any help is welcome.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, June 12, 2009</h2><P>You can't get a LinqBindingList from a join, it simply can't work. LinqBindingList is a view over an underlying collection - a join involves two collections and we can't create a live view over two collections.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tchimev replied on Friday, June 12, 2009</h2>Thank you Rocky!<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tchimev replied on Monday, June 15, 2009</h2>I am looking to find a good way to use advanced filter operation, but I cannot come up with any.<br><br>I would like to filter a BLB or ROL collection over another collection, using linq query, store the result to a property and then bind that property to a win form control.<br>It will be nice if that property can be bound through the Visual Studio designer.<br><br>I found some projects on CodePlex about linq binding, like 'BindableLinq', 'ContinuousLinq', 'Obtics', but<br>some of them return interface as a result from a query, and I cannot bind property of type interface&nbsp; through the studio designer. <br>'ContinuousLinq' wants me to wrap my collection with it's own collection and then use linq query over it.<br>I'm looking for something simpler like LingBindingList but with advanced filtering.<br><br>Is that possible and how should I achieve it?<br>Has anyone faced such a requirement?<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Monday, June 15, 2009</h2>Here is one idea which may or may not work for you:<br /><br />Dig in to the CSLA LinqBindingList Code and see if you can modify it to meet your requirements. As Rocky stated the LBL maintains a view over your original list. <br /><br />But while it is constructing the cross reference index it creates a "subset" which is a new list. It grabs the indexes from this subset and aligns them with your original list to build the cross reference.<br /><br /> Then it "throws away" the subset. <br /><br />It may be useful to you if you can find a way to keep the subset around and use it.<br /><br />Joe<br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tchimev replied on Monday, June 15, 2009</h2>Thank you Joe,<br><br>I will look at linqBindingList code,<br>any other ideas are welcome.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ThomasP replied on Thursday, June 18, 2009</h2>Hi,<br /><br />I think it should be easy to create a wrapper class for the IEnumerable<> and INotifyCollectionChanged interfaces. The class could accept such an interface as parameter for its constructor. It could simply pass through the methods and events from these interfaces. The class would give you a concrete type to bind to.<br /><br />All you need to do then is return an instance of your wrapper class from your property instead of the original interface. <br /><br />Regs,<br /><br />Thomas.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
