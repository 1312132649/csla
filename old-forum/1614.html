<html><header><title>CSLA 1.53 - Collection Object error during Fetch</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA 1.53 - Collection Object error during Fetch</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1614.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson posted on Friday, October 27, 2006</h2><P>The code in my GetCollection shared method is trivial - I added the Try/Catch just to catch the problem at the source:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> </FONT><FONT color=#808000 size=2>Fetch</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> </FONT><FONT color=#808000 size=2>dr</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#808000 size=2>SafeDataReader</FONT><FONT size=2>)</P>
<P></FONT><FONT color=#008000 size=2>' create a child object for each row in the data source, this guy is only</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>' called by his own Shared Method - so Private works fine</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>While</FONT><FONT size=2> </FONT><FONT color=#808000 size=2>dr</FONT><FONT size=2>.</FONT><FONT color=#808000 size=2>Read</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Try</P></FONT><FONT size=2>
<P></FONT><FONT color=#808000 size=2>List</FONT><FONT size=2>.</FONT><FONT color=#808000 size=2>Add</FONT><FONT size=2>(</FONT><FONT color=#808000 size=2>RenewalNotice</FONT><FONT size=2>.</FONT><FONT color=#808000 size=2>GetRenewalNotice</FONT><FONT size=2>(</FONT><FONT color=#808000 size=2>dr</FONT><FONT size=2>))</P>
<P></FONT><FONT color=#0000ff size=2>Catch</FONT><FONT size=2> </FONT><FONT color=#808000 size=2>ex</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#808000 size=2>Exception</P></FONT><FONT size=2>
<P></FONT><FONT color=#808000 size=2>MsgBox</FONT><FONT size=2>(</FONT><FONT color=#808000 size=2>ex</FONT><FONT size=2>.</FONT><FONT color=#808000 size=2>ToString</FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Try</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>While</FONT>
<P><FONT color=#008000 size=2></P></FONT><FONT size=2></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT>
<P>Every time List.Add() is called the following error msg is generated (it is line 162):</P>
<P>System.Exception: Parent value can only be set for child objects<BR>&nbsp;&nbsp; at CSLA.BusinessBase.SetParent(BusinessCollectionBase parent) in C:\Visual Studio Projects\CSLA_1_52\Csla10\CSLA\BusinessBase.vb:line 239<BR>&nbsp;&nbsp; at CSLA.BusinessCollectionBase.OnInsert(Int32 index, Object value) in C:\Visual Studio Projects\CSLA_1_52\Csla10\CSLA\BusinessCollectionBase.vb:line 425<BR>&nbsp;&nbsp; at System.Collections.CollectionBase.System.Collections.IList.Add(Object value)<BR>&nbsp;&nbsp; at TagTrackerLibrary.RenewalNoticeCollection.Fetch(SafeDataReader dr) in C:\Visual Studio Projects\TagTracker\TagTrackerLibrary\RenewalNoticeCollection.vb:line 162</P>
<P>What am I doing wrong here?</P>
<P>Thanks,</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, October 27, 2006</h2>Your private constructor in RenewalNotice should be calling MarkAsChild.<font color="#808000" size="2"><br></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson replied on Friday, October 27, 2006</h2><P>Bless you! Bless you!</P>
<P>I actually looked at that possibility on the collection class, but not on the child class.&nbsp; </P>
<P>The really alarming thing here for me is that this is <STRONG>generated</STRONG> code.&nbsp; I made&nbsp;a template six or eight months from which this one is a descendant and I can't figure out where I've screwed it up.&nbsp; But I better be very careful about re-generating&nbsp;any of my recent projects until I do a little research, eh?</P>
<P>Thanks so very much.&nbsp; </P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
