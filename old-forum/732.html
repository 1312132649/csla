<html><header><title>Crystal and BusinessBase</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Crystal and BusinessBase</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/732.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael Hildner posted on Wednesday, July 26, 2006</h2><P>Anyone ever try to use a root object (not a list) for a Crystal Report? I can use a list just fine, but I get an error trying to use the ReportClass.SetDataSource() with an editable root. (Edit: the exception says "The data source object is invalid.") Here's the code:</P><FONT size=2>
<P>report.SetDataSource(transaction);</P></FONT>
<P>I'm assuming this is because BusinessBase doesn't implement any of the overloads for .SetDataSource() - DataSet, DataTable, IDataReader or IEnumerable, but it compiles, which seems strange.</P>
<P>For example, here's the code I used to see if my business object was one of those types:</P><FONT size=2>
<P></FONT><FONT color=#008080 size=2>Debug</FONT><FONT size=2>.WriteLine(transaction </FONT><FONT color=#0000ff size=2>is</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>DataSet</FONT><FONT size=2>);</P>
<P></FONT><FONT color=#008080 size=2>Debug</FONT><FONT size=2>.WriteLine(transaction </FONT><FONT color=#0000ff size=2>is</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>DataTable</FONT><FONT size=2>);</P>
<P></FONT><FONT color=#008080 size=2>Debug</FONT><FONT size=2>.WriteLine(transaction </FONT><FONT color=#0000ff size=2>is</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>IDataReader</FONT><FONT size=2>);</P>
<P></FONT><FONT color=#008080 size=2>Debug</FONT><FONT size=2>.WriteLine(transaction </FONT><FONT color=#0000ff size=2>is</FONT><FONT size=2> System.Collections.</FONT><FONT color=#008080 size=2>IEnumerable</FONT><FONT size=2>);</P></FONT>
<P>And all are false. Yet again, I don't get any compile-time errors.</P>
<P>Thanks,</P>
<P>Mike</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael Hildner replied on Wednesday, July 26, 2006</h2><P>I'm&nbsp;guess Crystal won't take a BusinessBase for a report data source - I may have to make a list object that just contains one child.</P>
<P>This is kinda odd - I don't think I've seen it before. Apologies for getting away from CSLA a bit, but it is interesting.</P>
<P>The intellisense for .SetDataSource is strange. When you initially choose SetDataSource, it says "void ReportDocument.SetDataSource (DataSet dataSet) + 4 overloads". So there should be five methods total. Yet it only give you four once you type in the first open parenthesis.</P>
<P>I can pass any object to .SetDataSource and it compiles, so there must be an overload that takes an object. Strange that the intellisense when you're picking the methods says there are 5 methods, but then later tells you there's only four.</P>
<P>I wonder what would cause that?</P>
<P>Mike</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, July 26, 2006</h2>Certainly seems odd, you wouldn't think they'd require a list.&nbsp; You can create a Report in VS2005 which is a client side Reporting services report, and it handles a single object just fine.&nbsp; I've done this to allow users to print a 'contact card' should they need to print the data.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael Hildner replied on Wednesday, July 26, 2006</h2><P>Yeah, in my case I'm printing a credit card receipt - just one row of data.</P>
<P>I created a list just to hold it's only child, and that works. I don't like the idea of having to create a list when I don't really need a list, though. Seems like bad design/don't need a list for my use case. But seeing as we're using Crystal and that's what Crystal needs, I'll roll with it for now.</P>
<P>Mike</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, July 26, 2006</h2><P>I'd view this list as a UI artifact - not part of your business layer. It is not uncommon to have to create extra objects at the UI layer to accomodate various display requirements - and then perhaps it won't feel like so&nbsp;much of a hack.</P>
<P>Microsoft's reporting services tool takes a single object, that's true - but I had a conversation about this with a Msft person a long time ago, and as I recall, they just detect that you gave them a single object and they wrap it in a list on your behalf. Certainly thats what the BindingSource control does, because it only operates against collections...</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael Hildner replied on Thursday, July 27, 2006</h2><P>&gt;&gt;I'd view this list as a UI artifact - not part of your business layer. It is not uncommon to have to create extra objects at the UI layer to accomodate various display requirements - and then perhaps it won't feel like so&nbsp;much of a hack.</P>
<P>That's pretty interesting, I hadn't thought about it like that. So now I need my child object(s) used in a "regular" list and used in a list that only allows one child. I made another list object that takes a primary key of the child.</P>
<P>Does that make sense or instead should I make another factory method in my original list that takes the PK? Trying to figure out which way makes more sense. On the one hand my new list exists solely for a report, so I thought it should be a different object. But it kinda seems like overkill. It's really just a filter.</P>
<P>Regards,</P>
<P>Mike</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kdubious replied on Friday, July 28, 2006</h2><P><BLOCKQUOTE><div><img src="/Themes/alternate1/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>... You can create a Report in VS2005 which is a client side Reporting services report, and it handles a single object just fine.&nbsp; I've done this to allow users to print a 'contact card' should they need to print the data.<BR></div></BLOCKQUOTE></P>
<P>Can you elaborate on this?&nbsp; i had to create a report that takes parameters, and pass the parameters in because I could NOT get the new Report to take a BusinessBase (Must implement IEnumerable).</P>
<P>I'd like to avoid the parameter approach.... Please tell me how you did this.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, August 01, 2006</h2>I just created the report (rdlc) and setup the datasources.&nbsp; I ended up using the First function to read the values from the object.&nbsp; You need to setup reportdatasource objects, and set the datasource to a BindingSource control, whose DataSource you set to your object.<br><br>Andy<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
