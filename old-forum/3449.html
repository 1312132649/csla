<html><header><title>MarkOld, IsDirty, and Child Collections?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>MarkOld, IsDirty, and Child Collections?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3449.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>gartnerj posted on Wednesday, August 29, 2007</h2><P>Folks,<BR>I'm having a bit of trouble understanding how to have a BO with a collection of Child objects to be marked IsDirty=false on create when I have added items to the child collection.</P>
<P>I have done the override of:</P><FONT color=#0000ff size=2>
<P>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>override</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>bool</FONT><FONT size=2> IsDirty</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>get</FONT><FONT size=2> { </FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>base</FONT><FONT size=2>.IsDirty || _contactsList.IsDirty; }</P>
<P>}</P>
<P>but when I do the MarkOld() before returning from the BO, it looks to the UI like the BO is marked Dirty (and since on create I have done an Add to the list, I'm guessing it would be.&nbsp; )</P>
<P>How do I set the _contactList.IsDirty to false in this case (since IsDirty on the list is only a get parm)??</P>
<P>Thanks,</P>
<P>Jim</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, August 29, 2007</h2><P>The child object you add to the list must also be not dirty. Collections are dirty or not dirty based entirely on the state of their children (and the deletedList, which doesn't matter here).</P>
<P>So make that new child be not dirty and you should be set.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, August 29, 2007</h2>One warning though - because if you do make that child not dirty, and the user never <EM>edits the child</EM> then it would never get saved (not changed after all). So you may have to come up with a scheme by which you always save child objects even if they aren't dirty or something.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>gartnerj replied on Wednesday, August 29, 2007</h2><P>Thanks Rocky -- the save actually builds XML from all of the objects in the BO to save to the db, so the "children" don't save themselves for this object&nbsp;-- only the parent.</P>
<P>I did check the children of list, and that object has a MarkOld() on create/fetch (i was pretty sure from the book that was what I needed to do), so I'm not sure why this is still flagging the parent as IsDirty -- I'll have to do some more investigation.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>culprit replied on Thursday, August 30, 2007</h2>I have a similar setup but I am having trouble making the Data_Update routine fire even though the childlist shows it to be dirty and I overrode the IsDirty flag as you did. Does anyone know what I might be doing wrong here?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>alex.williamson@grampianfasteners.com replied on Wednesday, October 15, 2008</h2><P><FONT face=Arial size=2>Did you solve this? I'm having the same problem, currently can't get my parent BO to update when I call save and it has a new child object. </FONT></P>
<P><FONT face=Arial size=2>I have a parent BO which has a list of children which is populated through the parent correctly. Do I call parent-&gt;list-&gt;AddNew() and work with the object? I'm sure I've got this to work before. I'm working in VB.</FONT></P>
<P><FONT face=Arial size=2>Or should it be created through the UI:</FONT></P>
<P><FONT face=Arial size=2>Dim temp_childitem as childitem = New ChildItem<BR>Dim existing_parentitem.listofchildren.add(temp_childitem)<BR></FONT><FONT face=Arial size=2>editform_open_withchild(childitem)</P></FONT><FONT face=Arial size=2></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>alex@alexw.co.uk replied on Wednesday, August 24, 2011</h2><p>Answer to this of course was to override AddNewCore()</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
