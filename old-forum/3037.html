<html><header><title>Using a DataProvider achitecture with CSLA.NET</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Using a DataProvider achitecture with CSLA.NET</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3037.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Matthew Yost posted on Wednesday, June 13, 2007</h2><P>I'm trying to use the CSLA.NET framework&nbsp;with my companies existing data provider architecture.&nbsp; The architecture is that we have a data provider component that handles all database interaction and is configurable using a configuration file to switch the database and data provider it will use.&nbsp; The problem I am having is that in the examples, all data access code was written in the Business Objects themselves and I can't do this.&nbsp; What is the best way for me to be able to implement this framework w/o having the SQL in the BO?&nbsp; Below is a code sample:</P>
<P>&nbsp;</P>
<DIV>
<P><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;1</SPAN>&nbsp;<SPAN>using</SPAN> System;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;2</SPAN>&nbsp;<SPAN>using</SPAN> System.Collections.Generic;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;3</SPAN>&nbsp;<SPAN>using</SPAN> System.Text;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;4</SPAN>&nbsp;<SPAN>using</SPAN> Csla;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;5</SPAN>&nbsp;<SPAN>using</SPAN> Csla.Data;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;6</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;7</SPAN>&nbsp;<SPAN>namespace</SPAN> TPL</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;8</SPAN>&nbsp;{</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;9</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; [<SPAN>Serializable</SPAN>]</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;10</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>class</SPAN> <SPAN>TPLAgency</SPAN> : <SPAN>BusinessBase</SPAN>&lt;<SPAN>TPLAgency</SPAN>&gt;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;11</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;12</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>int</SPAN> _intAgencyID;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;13</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>string</SPAN> _strAgencyName;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;14</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>string</SPAN> _strAgencyContact;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;15</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>string</SPAN> _strAddressLine1;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;16</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>string</SPAN> _strAddressLine2;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;29</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;30</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> TPLAgency()</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;31</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;32</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _intAgencyID = 0;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;33</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;34</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;35</SPAN>&nbsp;<SPAN>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; #region</SPAN> Properties</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;36</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;summary&gt;</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;37</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> Gets or sets the agency ID.</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;38</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;/summary&gt;</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;39</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;value&gt;</SPAN><SPAN>The agency ID.</SPAN><SPAN>&lt;/value&gt;</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;40</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [System.ComponentModel.<SPAN>DataObjectField</SPAN>(<SPAN>true</SPAN>,<SPAN>true</SPAN>)]</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;41</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>int</SPAN> AgencyID</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;42</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;43</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>get</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;44</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;45</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CanReadProperty(<SPAN>"AgencyID"</SPAN>, <SPAN>true</SPAN>);</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;46</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN> _intAgencyID;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;47</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;48</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>set</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;49</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;50</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CanWriteProperty(<SPAN>"AgencyID"</SPAN>, <SPAN>true</SPAN>);</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;51</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _intAgencyID = <SPAN>value</SPAN>;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;52</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;53</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;54</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;55</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;summary&gt;</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;56</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> Gets or sets the name of the agency.</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;57</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;/summary&gt;</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;58</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;value&gt;</SPAN><SPAN>The name of the agency.</SPAN><SPAN>&lt;/value&gt;</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;59</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>string</SPAN> AgencyName</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;60</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;61</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>get</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;62</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;63</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CanReadProperty(<SPAN>"AgencyName"</SPAN>, <SPAN>true</SPAN>);</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;64</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN> _strAgencyName;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;65</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;66</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>set</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;67</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;68</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CanWriteProperty(<SPAN>"AgencyName"</SPAN>, <SPAN>true</SPAN>);</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;69</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _strAgencyName = <SPAN>value</SPAN>;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;70</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;71</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;72</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;73</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;summary&gt;</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;74</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> Gets or sets the agency contact.</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;75</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;/summary&gt;</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;76</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;value&gt;</SPAN><SPAN>The agency contact.</SPAN><SPAN>&lt;/value&gt;</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;77</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>string</SPAN> AgencyContact</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;78</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;79</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>get</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;80</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;81</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CanReadProperty(<SPAN>"AgencyContact"</SPAN>, <SPAN>true</SPAN>);</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;82</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN> _strAgencyContact;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;83</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;84</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>set</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;85</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;86</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CanWriteProperty(<SPAN>"AgencyContact"</SPAN>, <SPAN>true</SPAN>);</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;87</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _strAgencyContact = <SPAN>value</SPAN>;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;88</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;89</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;90</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;91</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;summary&gt;</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;92</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> Gets or sets the address line1.</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;93</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;/summary&gt;</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;94</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;value&gt;</SPAN><SPAN>The address line1.</SPAN><SPAN>&lt;/value&gt;</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;95</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>string</SPAN> AddressLine1</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;96</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;97</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>get</SPAN></P>
<P><SPAN>&nbsp;&nbsp;&nbsp;98</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;&nbsp;99</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CanReadProperty(<SPAN>"AddressLine1"</SPAN>, <SPAN>true</SPAN>);</P>
<P><SPAN>&nbsp;&nbsp;100</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN> _strAddressLine1;</P>
<P><SPAN>&nbsp;&nbsp;101</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;102</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>set</SPAN></P>
<P><SPAN>&nbsp;&nbsp;103</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;104</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CanWriteProperty(<SPAN>"AddressLine1"</SPAN>, <SPAN>true</SPAN>);</P>
<P><SPAN>&nbsp;&nbsp;105</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _strAddressLine1 = <SPAN>value</SPAN>;</P>
<P><SPAN>&nbsp;&nbsp;106</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;107</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;108</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;109</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;summary&gt;</SPAN></P>
<P><SPAN>&nbsp;&nbsp;110</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> Gets or sets the address line2.</SPAN></P>
<P><SPAN>&nbsp;&nbsp;111</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;/summary&gt;</SPAN></P>
<P><SPAN>&nbsp;&nbsp;112</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;value&gt;</SPAN><SPAN>The address line2.</SPAN><SPAN>&lt;/value&gt;</SPAN></P>
<P><SPAN>&nbsp;&nbsp;113</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>string</SPAN> AddressLine2</P>
<P><SPAN>&nbsp;&nbsp;114</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;115</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>get</SPAN></P>
<P><SPAN>&nbsp;&nbsp;116</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;117</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CanReadProperty(<SPAN>"AddressLine2"</SPAN>, <SPAN>true</SPAN>);</P>
<P><SPAN>&nbsp;&nbsp;118</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN> _strAddressLine2;</P>
<P><SPAN>&nbsp;&nbsp;119</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;120</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>set</SPAN></P>
<P><SPAN>&nbsp;&nbsp;121</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;122</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CanWriteProperty(<SPAN>"AddressLine2"</SPAN>, <SPAN>true</SPAN>);</P>
<P><SPAN>&nbsp;&nbsp;123</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _strAddressLine2 = <SPAN>value</SPAN>;</P>
<P><SPAN>&nbsp;&nbsp;124</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;125</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;324</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;325</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>protected</SPAN> <SPAN>override</SPAN> <SPAN>object</SPAN> GetIdValue()</P>
<P><SPAN>&nbsp;&nbsp;326</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;327</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>return</SPAN> _intAgencyID;</P>
<P><SPAN>&nbsp;&nbsp;328</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;329</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;330</SPAN>&nbsp;<SPAN>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; #endregion</SPAN></P>
<P><SPAN>&nbsp;&nbsp;</SPAN><SPAN>370</SPAN>&nbsp;<SPAN>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; #region</SPAN> Factory Methods</P>
<P><SPAN>&nbsp;&nbsp;371</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;372</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>static</SPAN> <SPAN>TPLAgency</SPAN> NewAgency()</P>
<P><SPAN>&nbsp;&nbsp;373</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;374</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; <SPAN>return</SPAN> <SPAN>DataPortal</SPAN>.Create&lt;<SPAN>TPLAgency</SPAN>&gt;();</P>
<P><SPAN>&nbsp;&nbsp;375</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;376</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;377</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>static</SPAN> <SPAN>TPLAgency</SPAN> GetAgency(<SPAN>int</SPAN> id)</P>
<P><SPAN>&nbsp;&nbsp;378</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;379</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; <SPAN>return</SPAN> <SPAN>DataPortal</SPAN>.Fetch&lt;<SPAN>TPLAgency</SPAN>&gt;(<SPAN>new</SPAN> <SPAN>Criteria</SPAN>(id));</P>
<P><SPAN>&nbsp;&nbsp;380</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;381</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;382</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>static</SPAN> <SPAN>void</SPAN> DeleteAgency(<SPAN>int</SPAN> id)</P>
<P><SPAN>&nbsp;&nbsp;383</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;384</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; <SPAN>DataPortal</SPAN>.Delete(<SPAN>new</SPAN> <SPAN>Criteria</SPAN>(id));</P>
<P><SPAN>&nbsp;&nbsp;385</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;386</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;387</SPAN>&nbsp;<SPAN>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; #endregion</SPAN></P>
<P><SPAN>&nbsp;&nbsp;388</SPAN>&nbsp;<SPAN>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; #region</SPAN> Data Access</P>
<P><SPAN>&nbsp;&nbsp;389</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;390</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [<SPAN>Serializable</SPAN>()]</P>
<P><SPAN>&nbsp;&nbsp;391</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>class</SPAN> <SPAN>Criteria</SPAN></P>
<P><SPAN>&nbsp;&nbsp;392</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;393</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>int</SPAN> mId;</P>
<P><SPAN>&nbsp;&nbsp;394</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> <SPAN>int</SPAN> Id</P>
<P><SPAN>&nbsp;&nbsp;395</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;396</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>get</SPAN></P>
<P><SPAN>&nbsp;&nbsp;397</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; { <SPAN>return</SPAN> mId; }</P>
<P><SPAN>&nbsp;&nbsp;398</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;399</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>public</SPAN> Criteria(<SPAN>int</SPAN> id)</P>
<P><SPAN>&nbsp;&nbsp;400</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; { mId = id; }</P>
<P><SPAN>&nbsp;&nbsp;401</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;402</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;403</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [<SPAN>RunLocal</SPAN>()]</P>
<P><SPAN>&nbsp;&nbsp;404</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>protected</SPAN> <SPAN>override</SPAN> <SPAN>void</SPAN> DataPortal_Create()</P>
<P><SPAN>&nbsp;&nbsp;405</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;406</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; AgencyID = 0;</P>
<P><SPAN>&nbsp;&nbsp;407</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;408</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;409</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>void</SPAN> DataPortal_Fetch(<SPAN>Criteria</SPAN> criteria)</P>
<P><SPAN>&nbsp;&nbsp;410</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;411</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>TPLAgency</SPAN> a = <SPAN>CoreGlobal</SPAN>.DBInterface.GetAgency(criteria.Id);</P>
<P><SPAN>&nbsp;&nbsp;412</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _intAgencyID = a.AgencyID;</P>
<P><SPAN>&nbsp;&nbsp;413</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _strAgencyName = a.AgencyName;</P>
<P><SPAN>&nbsp;&nbsp;414</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _strAgencyContact = a.AgencyContact;</P>
<P><SPAN>&nbsp;&nbsp;415</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _strAddressLine1 = a.AddressLine1;</P>
<P><SPAN>&nbsp;&nbsp;416</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _strAddressLine2 = a.AddressLine2;</P>
<P><SPAN>&nbsp;&nbsp;417</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _strAddressLine3 = a.AddressLine3;</P>
<P><SPAN>&nbsp;&nbsp;418</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _strAddressLine4 = a.AddressLine4;</P>
<P><SPAN>&nbsp;&nbsp;419</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _strAddressLine5 = a.AddressLine5;</P>
<P><SPAN>&nbsp;&nbsp;420</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _strTown = a.Town;</P>
<P><SPAN>&nbsp;&nbsp;421</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _strProvince = a.Province;</P>
<P><SPAN>&nbsp;&nbsp;422</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _strRegion = a.Region;</P>
<P><SPAN>&nbsp;&nbsp;423</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _strTelephone = a.Telephone;</P>
<P><SPAN>&nbsp;&nbsp;424</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _strFax = a.Fax;</P>
<P><SPAN>&nbsp;&nbsp;425</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _strEmail = a.Email;</P>
<P><SPAN>&nbsp;&nbsp;426</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _objCountry = a.Country;</P>
<P><SPAN>&nbsp;&nbsp;427</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;428</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;429</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>protected</SPAN> <SPAN>override</SPAN> <SPAN>void</SPAN> DataPortal_Insert()</P>
<P><SPAN>&nbsp;&nbsp;430</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;431</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// TODO: insert object's data</SPAN></P>
<P><SPAN>&nbsp;&nbsp;432</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;433</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;434</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>protected</SPAN> <SPAN>override</SPAN> <SPAN>void</SPAN> DataPortal_Update()</P>
<P><SPAN>&nbsp;&nbsp;435</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;436</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// TODO: update object's data</SPAN></P>
<P><SPAN>&nbsp;&nbsp;437</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;438</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;439</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>protected</SPAN> <SPAN>override</SPAN> <SPAN>void</SPAN> DataPortal_DeleteSelf()</P>
<P><SPAN>&nbsp;&nbsp;440</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;441</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; DataPortal_Delete(<SPAN>new</SPAN> <SPAN>Criteria</SPAN>(_intAgencyID));</P>
<P><SPAN>&nbsp;&nbsp;442</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;443</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;444</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>private</SPAN> <SPAN>void</SPAN> DataPortal_Delete(<SPAN>Criteria</SPAN> criteria)</P>
<P><SPAN>&nbsp;&nbsp;445</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</P>
<P><SPAN>&nbsp;&nbsp;446</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <SPAN>// TODO: delete object's data</SPAN></P>
<P><SPAN>&nbsp;&nbsp;447</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;448</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;449</SPAN>&nbsp;<SPAN>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; #endregion</SPAN></P>
<P><SPAN>&nbsp;&nbsp;450</SPAN>&nbsp;</P>
<P><SPAN>&nbsp;&nbsp;451</SPAN>&nbsp;&nbsp;&nbsp;&nbsp; }</P>
<P><SPAN>&nbsp;&nbsp;452</SPAN>&nbsp;}</P></DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Wednesday, June 13, 2007</h2>Your DataPortal_Fetch method is more or less correct.&nbsp; Just replace the example's SqlDataProvider code with your companies data access code.&nbsp; In general however, you will <br>want to keep the other method calls in the examples that are not directly related to the SqlDataProvider.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>nermin replied on Thursday, June 14, 2007</h2>I believe you are looking for "Deep Data" example (a solution).  It is somewhere on lhotka.net - I downloaded it couple of months ago but I am having hard time finding it now.<br /> <br />Basically nothing is preventing you from calling your DataProvider objects from Csla serialization methods, and populating updating your Csla objects that way.<br /> <br /> <br />Nermin Dibek<br />Magenic Technologies<br /> <br />Nobody's more serious about Microsoft.<br /><br />________________________________<br /><br />From: Matthew Yost [mailto:cslanet@lhotka.net]<br />Sent: Wed 6/13/2007 11:05 AM<br />To: Nermin Dibek<br />Subject: [CSLA .NET] Using a DataProvider achitecture with CSLA.NET<br /><br /><br /><br />I'm trying to use the CSLA.NET framework with my companies existing data provider architecture.  The architecture is that we have a data provider component that handles all database interaction and is configurable using a configuration file to switch the database and data provider it will use.  The problem I am having is that in the examples, all data access code was written in the Business Objects themselves and I can't do this.  What is the best way for me to be able to implement this framework w/o having the SQL in the BO?  Below is a code sample:<br /><br /> <br /><br />    1 using System;<br /><br />    2 using System.Collections.Generic;<br /><br />    3 using System.Text;<br /><br />    4 using Csla;<br /><br />    5 using Csla.Data;<br /><br />    6 <br /><br />    7 namespace TPL<br /><br />    8 {<br /><br />    9     [Serializable]<br /><br />   10     public class TPLAgency : BusinessBase<br /><br />   11     {<br /><br />   12         private int _intAgencyID;<br /><br />   13         private string _strAgencyName;<br /><br />   14         private string _strAgencyContact;<br /><br />   15         private string _strAddressLine1;<br /><br />   16         private string _strAddressLine2;<br /><br />   17         private string _strAddressLine3;<br /><br />   18         private string _strAddressLine4;<br /><br />   19         private string _strAddressLine5;<br /><br />   20         private string _strTown;<br /><br />   21         private string _strProvince;<br /><br />   22         private string _strRegion;<br /><br />   23         private string _strPostalCode;<br /><br />   24         private string _strCounty;<br /><br />   25         private string _strTelephone;<br /><br />   26         private string _strFax;<br /><br />   27         private string _strEmail;<br /><br />   28         private TPLCountry _objCountry = TPLCountry.NewDPLCountry();<br /><br />   29 <br /><br />   30         public TPLAgency()<br /><br />   31         {<br /><br />   32             _intAgencyID = 0;<br /><br />   33         }<br /><br />   34 <br /><br />   35         #region Properties<br /><br />   36         /// <br /><br />   37         /// Gets or sets the agency ID.<br /><br />   38         /// <br /><br />   39         /// The agency ID.<br /><br />   40         [System.ComponentModel.DataObjectField(true,true)]<br /><br />   41         public int AgencyID<br /><br />   42         {<br /><br />   43             get<br /><br />   44             {<br /><br />   45                 CanReadProperty("AgencyID", true);<br /><br />   46                 return _intAgencyID;<br /><br />   47             }<br /><br />   48             set<br /><br />   49             {<br /><br />   50                 CanWriteProperty("AgencyID", true);<br /><br />   51                 _intAgencyID = value;<br /><br />   52             }<br /><br />   53         }<br /><br />   54 <br /><br />   55         /// <br /><br />   56         /// Gets or sets the name of the agency.<br /><br />   57         /// <br /><br />   58         /// The name of the agency.<br /><br />   59         public string AgencyName<br /><br />   60         {<br /><br />   61             get<br /><br />   62             {<br /><br />   63                 CanReadProperty("AgencyName", true);<br /><br />   64                 return _strAgencyName;<br /><br />   65             }<br /><br />   66             set<br /><br />   67             {<br /><br />   68                 CanWriteProperty("AgencyName", true);<br /><br />   69                 _strAgencyName = value;<br /><br />   70             }<br /><br />   71         }<br /><br />   72 <br /><br />   73         /// <br /><br />   74         /// Gets or sets the agency contact.<br /><br />   75         /// <br /><br />   76         /// The agency contact.<br /><br />   77         public string AgencyContact<br /><br />   78         {<br /><br />   79             get<br /><br />   80             {<br /><br />   81                 CanReadProperty("AgencyContact", true);<br /><br />   82                 return _strAgencyContact;<br /><br />   83             }<br /><br />   84             set<br /><br />   85             {<br /><br />   86                 CanWriteProperty("AgencyContact", true);<br /><br />   87                 _strAgencyContact = value;<br /><br />   88             }<br /><br />   89         }<br /><br />   90 <br /><br />   91         /// <br /><br />   92         /// Gets or sets the address line1.<br /><br />   93         /// <br /><br />   94         /// The address line1.<br /><br />   95         public string AddressLine1<br /><br />   96         {<br /><br />   97             get<br /><br />   98             {<br /><br />   99                 CanReadProperty("AddressLine1", true);<br /><br />  100                 return _strAddressLine1;<br /><br />  101             }<br /><br />  102             set<br /><br />  103             {<br /><br />  104                 CanWriteProperty("AddressLine1", true);<br /><br />  105                 _strAddressLine1 = value;<br /><br />  106             }<br /><br />  107         }<br /><br />  108 <br /><br />  109         /// <br /><br />  110         /// Gets or sets the address line2.<br /><br />  111         /// <br /><br />  112         /// The address line2.<br /><br />  113         public string AddressLine2<br /><br />  114         {<br /><br />  115             get<br /><br />  116             {<br /><br />  117                 CanReadProperty("AddressLine2", true);<br /><br />  118                 return _strAddressLine2;<br /><br />  119             }<br /><br />  120             set<br /><br />  121             {<br /><br />  122                 CanWriteProperty("AddressLine2", true);<br /><br />  123                 _strAddressLine2 = value;<br /><br />  124             }<br /><br />  125         }<br /><br />  126 <br /><br />  127         /// <br /><br />  128         /// Gets or sets the address line3.<br /><br />  129         /// <br /><br />  130         /// The address line3.<br /><br />  131         public string AddressLine3<br /><br />  132         {<br /><br />  133             get<br /><br />  134             {<br /><br />  135                 CanReadProperty("AddressLine3", true);<br /><br />  136                 return _strAddressLine3;<br /><br />  137             }<br /><br />  138             set<br /><br />  139             {<br /><br />  140                 CanWriteProperty("AddressLine3", true);<br /><br />  141                 _strAddressLine3 = value;<br /><br />  142             }<br /><br />  143         }<br /><br />  144 <br /><br />  145         /// <br /><br />  146         /// Gets or sets the address line4.<br /><br />  147         /// <br /><br />  148         /// The address line4.<br /><br />  149         public string AddressLine4<br /><br />  150         {<br /><br />  151             get<br /><br />  152             {<br /><br />  153                 CanReadProperty("AddressLine4", true);<br /><br />  154                 return _strAddressLine4;<br /><br />  155             }<br /><br />  156             set<br /><br />  157             {<br /><br />  158                 CanWriteProperty("AddressLine4", true);<br /><br />  159                 _strAddressLine4 = value;<br /><br />  160             }<br /><br />  161         }<br /><br />  162 <br /><br />  163         /// <br /><br />  164         /// Gets or sets the address line5.<br /><br />  165         /// <br /><br />  166         /// The address line5.<br /><br />  167         public string AddressLine5<br /><br />  168         {<br /><br />  169             get<br /><br />  170             {<br /><br />  171                 CanReadProperty("AddressLine5", true);<br /><br />  172                 return _strAddressLine5;<br /><br />  173             }<br /><br />  174             set<br /><br />  175             {<br /><br />  176                 CanWriteProperty("AddressLine5", true);<br /><br />  177                 _strAddressLine5 = value;<br /><br />  178             }<br /><br />  179         }<br /><br />  180 <br /><br />  181         /// <br /><br />  182         /// Gets or sets the town.<br /><br />  183         /// <br /><br />  184         /// The town.<br /><br />  185         public string Town<br /><br />  186         {<br /><br />  187             get<br /><br />  188             {<br /><br />  189                 CanReadProperty("Town", true);<br /><br />  190                 return _strTown;<br /><br />  191             }<br /><br />  192             set<br /><br />  193             {<br /><br />  194                 CanWriteProperty("Town", true);<br /><br />  195                 _strTown = value;<br /><br />  196             }<br /><br />  197         }<br /><br />  198 <br /><br />  199         /// <br /><br />  200         /// Gets or sets the province.<br /><br />  201         /// <br /><br />  202         /// The province.<br /><br />  203         public string Province<br /><br />  204         {<br /><br />  205             get<br /><br />  206             {<br /><br />  207                 CanReadProperty("Province", true);<br /><br />  208                 return _strProvince;<br /><br />  209             }<br /><br />  210             set<br /><br />  211             {<br /><br />  212                 CanWriteProperty("Province", true);<br /><br />  213                 _strProvince = value;<br /><br />  214             }<br /><br />  215         }<br /><br />  216 <br /><br />  217         /// <br /><br />  218         /// Gets or sets the region.<br /><br />  219         /// <br /><br />  220         /// The region.<br /><br />  221         public string Region<br /><br />  222         {<br /><br />  223             get<br /><br />  224             {<br /><br />  225                 CanReadProperty("Region", true);<br /><br />  226                 return _strRegion;<br /><br />  227             }<br /><br />  228             set<br /><br />  229             {<br /><br />  230                 CanWriteProperty("Region", true);<br /><br />  231                 _strRegion = value;<br /><br />  232             }<br /><br />  233         }<br /><br />  234 <br /><br />  235         /// <br /><br />  236         /// Gets or sets the postal code.<br /><br />  237         /// <br /><br />  238         /// The postal code.<br /><br />  239         public string PostalCode<br /><br />  240         {<br /><br />  241             get<br /><br />  242             {<br /><br />  243                 CanReadProperty("PostalCode", true);<br /><br />  244                 return _strPostalCode;<br /><br />  245             }<br /><br />  246             set<br /><br />  247             {<br /><br />  248                 CanWriteProperty("PostalCode", true);<br /><br />  249                 _strPostalCode = value;<br /><br />  250             }<br /><br />  251         }<br /><br />  252 <br /><br />  253         public string Telephone<br /><br />  254         {<br /><br />  255             get<br /><br />  256             {<br /><br />  257                 CanReadProperty("Telephone", true);<br /><br />  258                 return _strTelephone;<br /><br />  259             }<br /><br />  260             set<br /><br />  261             {<br /><br />  262                 CanWriteProperty("Telephone", true);<br /><br />  263                 if (_strTelephone != value)<br /><br />  264                 {<br /><br />  265                     _strTelephone = value;<br /><br />  266                     PropertyHasChanged();<br /><br />  267                 }<br /><br />  268             }<br /><br />  269         }<br /><br />  270 <br /><br />  271         public string Fax<br /><br />  272         {<br /><br />  273             get<br /><br />  274             {<br /><br />  275                 CanReadProperty("Fax", true);<br /><br />  276                 return _strFax;<br /><br />  277             }<br /><br />  278             set<br /><br />  279             {<br /><br />  280                 CanWriteProperty("Fax", true);<br /><br />  281                 if (_strFax != value)<br /><br />  282                 {<br /><br />  283                     _strFax = value;<br /><br />  284                     PropertyHasChanged();<br /><br />  285                 }<br /><br />  286             }<br /><br />  287         }<br /><br />  288 <br /><br />  289         public string Email<br /><br />  290         {<br /><br />  291             get<br /><br />  292             {<br /><br />  293                 CanReadProperty("Email",true);<br /><br />  294                 return _strEmail;<br /><br />  295             }<br /><br />  296             set<br /><br />  297             {<br /><br />  298                 CanWriteProperty("Email",true);<br /><br />  299                 if (_strEmail != value)<br /><br />  300                 {<br /><br />  301                     _strEmail = value;<br /><br />  302                     PropertyHasChanged();<br /><br />  303                 }<br /><br />  304             }<br /><br />  305         }<br /><br />  306 <br /><br />  307         /// <br /><br />  308         /// Gets or sets the country.<br /><br />  309         /// <br /><br />  310         /// The country.<br /><br />  311         public TPLCountry Country<br /><br />  312         {<br /><br />  313             get<br /><br />  314             {<br /><br />  315                 CanReadProperty("Country", true);<br /><br />  316                 return _objCountry;<br /><br />  317             }<br /><br />  318             set<br /><br />  319             {<br /><br />  320                 CanWriteProperty("Country", true);<br /><br />  321                 _objCountry = value;<br /><br />  322             }<br /><br />  323         }<br /><br />  324 <br /><br />  325         protected override object GetIdValue()<br /><br />  326         {<br /><br />  327             return _intAgencyID;<br /><br />  328         }<br /><br />  329 <br /><br />  330         #endregion<br /><br />  331 <br /><br />  332         #region Validation Rules<br /><br />  333 <br /><br />  334         protected override void AddBusinessRules()<br /><br />  335         {<br /><br />  336             // TODO: add validation rules<br /><br />  337         }<br /><br />  338 <br /><br />  339         #endregion<br /><br />  340 <br /><br />  341         #region Authorization Rules<br /><br />  342 <br /><br />  343         protected override void AddAuthorizationRules()<br /><br />  344         {<br /><br />  345             // TODO: add authorization rules<br /><br />  346         }<br /><br />  347 <br /><br />  348         public static bool CanAddObject()<br /><br />  349         {<br /><br />  350             return true;<br /><br />  351         }<br /><br />  352 <br /><br />  353         public static bool CanGetObject()<br /><br />  354         {<br /><br />  355             return true;<br /><br />  356         }<br /><br />  357 <br /><br />  358         public static bool CanDeleteObject()<br /><br />  359         {<br /><br />  360             return true;<br /><br />  361         }<br /><br />  362 <br /><br />  363         public static bool CanEditObject()<br /><br />  364         {<br /><br />  365             return true;<br /><br />  366         }<br /><br />  367 <br /><br />  368         #endregion<br /><br />  369 <br /><br />  370         #region Factory Methods<br /><br />  371 <br /><br />  372         public static TPLAgency NewAgency()<br /><br />  373         {<br /><br />  374           return DataPortal.Create();<br /><br />  375         }<br /><br />  376 <br /><br />  377         public static TPLAgency GetAgency(int id)<br /><br />  378         {<br /><br />  379           return DataPortal.Fetch(new Criteria(id));<br /><br />  380         }<br /><br />  381 <br /><br />  382         public static void DeleteAgency(int id)<br /><br />  383         {<br /><br />  384           DataPortal.Delete(new Criteria(id));<br /><br />  385         }<br /><br />  386 <br /><br />  387         #endregion<br /><br />  388         #region Data Access<br /><br />  389 <br /><br />  390         [Serializable()]<br /><br />  391         private class Criteria<br /><br />  392         {<br /><br />  393             private int mId;<br /><br />  394             public int Id<br /><br />  395             {<br /><br />  396                 get<br /><br />  397                 { return mId; }<br /><br />  398             }<br /><br />  399             public Criteria(int id)<br /><br />  400             { mId = id; }<br /><br />  401         }<br /><br />  402 <br /><br />  403         [RunLocal()]<br /><br />  404         protected override void DataPortal_Create()<br /><br />  405         {<br /><br />  406             AgencyID = 0;<br /><br />  407         }<br /><br />  408 <br /><br />  409         private void DataPortal_Fetch(Criteria criteria)<br /><br />  410         {<br /><br />  411             TPLAgency a = CoreGlobal.DBInterface.GetAgency(criteria.Id);<br /><br />  412             _intAgencyID = a.AgencyID;<br /><br />  413             _strAgencyName = a.AgencyName;<br /><br />  414             _strAgencyContact = a.AgencyContact;<br /><br />  415             _strAddressLine1 = a.AddressLine1;<br /><br />  416             _strAddressLine2 = a.AddressLine2;<br /><br />  417             _strAddressLine3 = a.AddressLine3;<br /><br />  418             _strAddressLine4 = a.AddressLine4;<br /><br />  419             _strAddressLine5 = a.AddressLine5;<br /><br />  420             _strTown = a.Town;<br /><br />  421             _strProvince = a.Province;<br /><br />  422             _strRegion = a.Region;<br /><br />  423             _strTelephone = a.Telephone;<br /><br />  424             _strFax = a.Fax;<br /><br />  425             _strEmail = a.Email;<br /><br />  426             _objCountry = a.Country;<br /><br />  427         }<br /><br />  428 <br /><br />  429         protected override void DataPortal_Insert()<br /><br />  430         {<br /><br />  431             // TODO: insert object's data<br /><br />  432         }<br /><br />  433 <br /><br />  434         protected override void DataPortal_Update()<br /><br />  435         {<br /><br />  436             // TODO: update object's data<br /><br />  437         }<br /><br />  438 <br /><br />  439         protected override void DataPortal_DeleteSelf()<br /><br />  440         {<br /><br />  441             DataPortal_Delete(new Criteria(_intAgencyID));<br /><br />  442         }<br /><br />  443 <br /><br />  444         private void DataPortal_Delete(Criteria criteria)<br /><br />  445         {<br /><br />  446             // TODO: delete object's data<br /><br />  447         }<br /><br />  448 <br /><br />  449         #endregion<br /><br />  450 <br /><br />  451     }<br /><br />  452 }<br /><br /><br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, June 14, 2007</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>nermin:</strong></div><div>I believe you are looking for "Deep Data" example (a solution). It is somewhere on lhotka.net - I downloaded it couple of months ago but I am having hard time finding it now.</div></BLOCKQUOTE></P>
<P>I do have a search page on my site</P>
<P><A href="http://www.lhotka.net/Search.aspx">http://www.lhotka.net/Search.aspx</A></P>
<P><img src="/emoticons/emotion-2.gif" alt="Big Smile [:D]" /></P>
<P><A href="http://www.lhotka.net/Article.aspx?area=11&amp;id=65c98c98-f0e0-477d-b45b-7a1e7d5768ee">Click here </A>to get to the download page you are looking for.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>harmar replied on Saturday, June 16, 2007</h2>There's a very good video on dnrTV featuring rocky, where he talks about the deepdata project and gives answers to your questions.<br><br>http://dnrtv.com/default.aspx?showID=60<br><br>enjoy!<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
