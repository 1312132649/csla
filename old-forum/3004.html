<html><header><title>ListChanged in Remoting</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ListChanged in Remoting</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3004.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Skeeboe posted on Thursday, June 07, 2007</h2>In 2.1.1.0 and 2.1.1.4 the ListChanged event does NOT get called in remoting mode. Even as a test, I've created a small root&gt;collection&gt;child object and pop a msgbox when the listchanged event is called. It works great until you try to do it with remoting. Once in remoting mode, I can get the collection to fill but if I make a change the msgbox never pops. I know its not popping on the server since the program responds as expected and isn't hung waiting on a msgbox to close on the server.<br><br>I posted about this back in 1.53 for .net 2.0 days but I'm all 2.1+ now and I still can't get it to work. <br><br>I need that event to fire so I know when to calculate new payment value based on the something in the children changing.<br><br>Thanks.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Friday, June 08, 2007</h2>Would it be possible for you to post some code showing where and how you hook up the event handler and what code you expect would trigger the ListChanged event?&nbsp; Writing to a log file may also be a bit better than trying to show a message box.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>McManus replied on Friday, June 08, 2007</h2><P>Hi Skeeboe,</P>
<P>Did you override OnDeserialized in the root object?</P>
<P>You should call collection.ListChanged += new ListChangedEventHandler(&lt;handler&gt;) in OnDeserialized.</P>
<P>Cheers,</P>
<P>Herman</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Skeeboe replied on Wednesday, June 13, 2007</h2><P>K, that worked. Finally, I've been asking that for about two years in 1.53 and didn't know&nbsp;I had to rehook those on a deserialized event call. Someone elaborated on that before but not as specific. </P>
<P>So in 2.1.1.x I do this:</P>
<P class=MsoNormal><SPAN>Protected</SPAN><SPAN> <SPAN>Overloads</SPAN> <SPAN>Overrides</SPAN> <SPAN>Sub</SPAN> OnDeserialized(<SPAN>ByVal</SPAN> context <SPAN>As</SPAN> System.Runtime.Serialization.StreamingContext)<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>&nbsp;&nbsp;&nbsp; <SPAN>AddHandler</SPAN> <SPAN>Me</SPAN>.ListChanged, <SPAN>AddressOf</SPAN> Children_ListChanged<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>End</SPAN><SPAN> <SPAN>Sub</SPAN></SPAN><SPAN><o:p></o:p></SPAN></P>
<P>in 1.53 I do this:</P>
<P>Protected Overrides Sub Deserialized()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyBase.Deserialized()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddHandler MyChild.ListChanged, AddressOf Children_ListChanged<BR>End Sub</P>
<P>Thanks!</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
