<html><header><title>Inheritance and design question.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Inheritance and design question.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7757.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>wjcomeaux posted on Friday, October 09, 2009</h2><P>We have a very generic hierarchy structure that we've defined. The database consists of Hierarchy, HierarchyNode. I've got CSLA objects generated against those tables.</P>
<P>Now, what we want is the ability to do Hierarchy&lt;Merchant&gt; myMerchantHierarchy but this isn't something the CodeSmith templates will allow.</P>
<P>My next proposition was<BR>public class GenericHierarchy&lt;T&gt; :&nbsp; Hierarchy<BR>However, this won't work either because Hierarchy, being CSLA is created with factory methods and don't expose a constructor.<BR><BR>What I currently have is<BR>GenericHierarchy&lt;T&gt;<BR>{<BR>&nbsp;&nbsp;&nbsp;public Hierarchy _internalHierarchy;<BR>}<BR>Along with some functions that facilitate the ability to get the data from a node by instantiating an instance of T and calling the LoadData function passing it the dataKey of whatever the current HierarchyNode is. <BR>The problem with this approach is that it forces T to be of a certain type. It can't be an interface because you can't declare instances of an interface.<BR><BR>The solution works except that all of my T objects must now inherit from my AbstractHierarchyNodeData object which means they can no longer inherit from anything else (something a lot of our ojects, like Merchant, already do).<BR>In order to then get a Hierarchy of Merchants we'd have to build a Merchant wrapper that inherits from AbstractHierarchyNodeData.<BR><BR>Also, all of that work and I still can't treat my GenericHierarchy as an actual hierarchy, since it's nothing more than a wrapper around a hierarchy object. Subtle but important difference there.<BR><BR>Any ideas?<BR>Thanks,<BR>Will</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>wjcomeaux replied on Monday, October 12, 2009</h2><P>Ok, I did end up writing a workable solution for this. The end result is you can create an instance of T where T implements some interface.</P>
<P>You just can't do new T() without adding new() to the specification of the generic parameter or you can use Activator.CreateInstance(typeof(T)).</P>
<P>However, my supervisor still wants me to do this<BR>public class Hierarchy : BusinessBase<BR>public class GenericHierarchy&lt;T&gt; : Hierarchy</P>
<P>Inheriting directly from CSLA objects won't work because CSLA goes through the factory methods and don't expose a public constructor (at least not a usable one from the code generator). What would we have to do in order to expose the public constructor for our Hierarchy object and not run into any problems with how the DataPortal does its work?<BR><BR>He's thinking that just dropping this code into the constructor would work.<BR><FONT color=#0000ff size=2><FONT color=#0000ff size=2>return</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>DataPortal</FONT></FONT><FONT size=2>.Fetch&lt; </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Hierarchy</FONT></FONT><FONT size=2> &gt;(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>HierarchyCriteria</FONT></FONT><FONT size=2>(requiredParameters));<BR><FONT size=3>Obviously, this won't work, but there has to be a way to accomplish the same chore in the constructor that doesn't take everything away from how CSLA works.</FONT></P></FONT>
<P>Thanks,<BR>Will</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Monday, October 12, 2009</h2>Why not just change Hierarchy to Hierarchy[T]  -- use <>, I can't get this to format right in this editor -- so that the generic parameter T is used in the entire class chain?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>wjcomeaux replied on Tuesday, October 13, 2009</h2><P>Because Hierarchy is a CSLA object generated with CodeSmith. Making it generic would require that I edit all of the generated code as well which was not a direction we wanted to go with, although it would make the most readible and logical code...</P>
<P>Will</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, October 13, 2009</h2>Why not just create a new codesmith template designed to your needs?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>wjcomeaux replied on Tuesday, October 13, 2009</h2><P>That's purely a matter of the development effort involved. I'd have to write a template (set of templates) that generate a CSLA object that is generic. All the development and testing involved in that would put me way past my deadline. It would also mean having to keep up with even more differences between the Codesmith.CSLA templates and our custom templates.</P>
<P>Will</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
