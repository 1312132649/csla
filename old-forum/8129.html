<html><header><title>Updating Child objects on Save()</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Updating Child objects on Save()</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8129.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jsavold posted on Friday, December 11, 2009</h2>OrderCollection orders = OrderCollection.New();<br />Order order = Order.New();<br /><br />orders.Add(order);<br />orders = orders.Save();<br /><br />The order object get a temp id until it is saved through the parent. After Save() is called the child object in the collection has the new id from the DB but the original object still has the temp id. How do get the order object and the child order to point to the same object?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jrose replied on Friday, December 11, 2009</h2>Please help.  I am having the same problem and I am really stuck.  My parent's id matches the children's id . . .until sometime during the save process.  . . it appears to be 'flipping' the parent id there anyway.  Any suggestions would be greatly appreciated.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, December 11, 2009</h2><P>I suggest you read chapters 1-5 (in particular 4-5) of the <EM>Expert 2008 Business Objects</EM>&nbsp;book, as it walks through parent-child class relationships pretty clearly. You might also look at chapter 18, which discusses data access.</P>
<P>The Core CSLA .NET 3.8 video series (videos 2 and 3) also cover parent-child relationships in some detail.</P>
<P>The root object is the only thing directly saved by the data portal. The root object needs to call the data portal (or in a BusinessBase the FieldManager, or in the case of a BusinessListBase, the base class) so the data portal invokes Child_XZY methods on each child object.</P>
<P>Only the root object will have DataPortal_XYZ methods, the child objects will have Child_XYZ methods.</P>
<P>Normally the root object passes a reference to itself to the data portal when saving the child objects, so the child objects have access to the root object's properties (like its Id property).</P>
<P>This only works, of course, if you've already set the root object's Id property before triggering the save of the child objects.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rxelizondo replied on Saturday, December 12, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>jsavold:</strong></div><div><br />The order object get a temp id until it is saved through the parent. After Save() is called the child object in the collection has the new id from the DB but the original object still has the temp id. How do get the order object and the child order to point to the same object?<br /></div></BLOCKQUOTE><br /><br />Assuming that I understood your question correctly..... <br /><br />Just like the "orders" object its a *new* object after the call: <br /><br />orders = orders.Save();<br /><br />The child objects in the "orders" collection are also all new. Once you call the Save() method and get the new "orders" object all reference to the previously existing "orders" object and any of its children have to be updated.<br /></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
