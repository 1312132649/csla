<html><header><title>DataGridView error saving businesslistbase</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>DataGridView error saving businesslistbase</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10869.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>gwilliams posted on Saturday, November 12, 2011</h2><p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I have a simple collection that is loaded from a flat file. This needs to be displayed on a read only grid then saved to a db. As long as I do not bind the list to a datagridview it will exit the save properly. If the datasource of the grid is set to the list then I get an error : &lsquo;DataPortal.Update failed (Csla.Validation.ValidationException: Object is still being edited and can not be saved&rsquo;</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I have tried setting the datagridview.datasource to null and still no luck. Tried changing the base to a childbase and I get : cant save a child directly.(something like that)</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Binding from the form: </span></span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">displayClaimsList = <span style="color:#2b91af;">ClaimsListing</span>.GetClaimsListing(path);</span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">dataGridView1.DataSource = displayClaimsList;</span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">displayClaimsList.Save();</span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">in the businesslistbase</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:9.5pt;">protected</span><span style="font-family:Consolas;font-size:9.5pt;"> <span style="color:blue;">override</span> <span style="color:blue;">void</span> DataPortal_Update()</span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">foreach</span> (<span style="color:blue;">var</span> item <span style="color:blue;">in</span> <span style="color:blue;">this</span>)</span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">bool</span> what = item.IsNew;//checking to make sure all items are marked as new.</span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>item.Save();</span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">In the businessbase it is hitting the dataportal_Insert. (when it has not been bound to the datagrid)</span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">Any ideas. What am I missing&hellip;&hellip; </span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">also i am not using a winpart or anything.. just a form with 2 buttons, one to load the data into the listing and bind to the datagridview... the other to save</span></p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Saturday, November 12, 2011</h2><p>This is Windows Forms right? You need to unbind the object from the UI before saving, otherwise data binding maintains currency to one item in the collection. As a result, the edit level for that one item is elevated - hence the exception you are seeing.</p>
<p>There is a specific way you need to unbind. This is discussed in the <em>Using CSLA .NET 3.0</em> ebook, and is demonstrated in ProjectTracker in the version 3.0.5 download.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>gwilliams replied on Saturday, November 12, 2011</h2><p>thanks for the prompt reply. I will grab the 3.0.5 download and purchase the 3.0 ebook. I have the video&#39;s and was going to review them as well. </p>
<p>We are in year 2 of a medical transport app witht he business objects done in CSLA. The team was new to CSLA and we have ran into some implementation problems along the way. the main challenge in the project has been the dynamic nature of the rules which are based on contracts, and where some of the rules are determined from an external rules application. Are there any video&#39;s or tutorials that walk through implementation or discuss which &quot;Base&quot; object is a better choice over another.? this applicaton is more business centric as the data is compliled from disperse sysetems.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Sunday, November 13, 2011</h2><p>Hi Greg, </p>
<p>As a general rule for WindowsForms I recommed to use BindingSource as an intermediate beetween DataGridView and your BO. </p>
<p>Also take a look at the Csla.Windows.BindingSourceExtensions.cs in CslaContrib trunk. (<a href="http://cslacontrib.codeplex.com">http://cslacontrib.codeplex.com</a>).<br />This class contains helper method to bind/unbind your BO properly.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>gwilliams replied on Sunday, November 13, 2011</h2><p>thanks JonnyBee. I am having some trouble finding the file. i downloaded the lates Contrib project but do not see it nor do i see it in a previous one. is this a single file download? i am missing something. but will keep looking.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>gwilliams replied on Sunday, November 13, 2011</h2><p>found it.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>gwilliams replied on Tuesday, November 15, 2011</h2><p>everything is working now that i am unbinding per the instructions. thanks all.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
