<html><header><title>BeginRefresh design</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>BeginRefresh design</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8164.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Cine posted on Tuesday, December 15, 2009</h2>I am wondering why the VievModelBase.BeginRefresh was designed the way it was...<br><br>The current one requires me to make code like this: <br>BeginRefresh("GetList", 0);<br><br>Whereas I have a hard time accepting random string references, and would much rather have something like:<br>BeginRefresh(evt =&gt; mymodel.GetList(0, evt));<br>a little extra typing, but typesafe and rename safe<br><br>Or with no extra params its just<br>BeginRefresh(mymodel.GetList)<br><br>Index: ViewModelBase.cs<br>===================================================================<br>--- ViewModelBase.cs&nbsp;&nbsp;&nbsp; (revision 4491)<br>+++ ViewModelBase.cs&nbsp;&nbsp;&nbsp; (working copy)<br>@@ -555,6 +555,25 @@<br>&nbsp;&nbsp;&nbsp;&nbsp; /// Creates or retrieves a new instance of the <br>&nbsp;&nbsp;&nbsp;&nbsp; /// Model by invoking a static factory method.<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br>+&nbsp;&nbsp;&nbsp; /// &lt;param name="action"&gt;A call to the static factory method.&lt;/param&gt;<br>+&nbsp;&nbsp;&nbsp; protected virtual void BeginRefresh(Action&lt;EventHandler&lt;DataPortalResult&lt;T&gt;&gt;&gt; action)<br>+&nbsp;&nbsp;&nbsp; {<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Error = null;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsBusy = true;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; action(QueryCompleted);<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Error = ex;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsBusy = false;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>+&nbsp;&nbsp;&nbsp; }<br>+&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>+&nbsp;&nbsp;&nbsp; /// Creates or retrieves a new instance of the <br>+&nbsp;&nbsp;&nbsp; /// Model by invoking a static factory method.<br>+&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name="factoryMethod"&gt;Name of the static factory method.&lt;/param&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp; protected virtual void BeginRefresh(string factoryMethod)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>@@ -569,15 +588,13 @@<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return handler;<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br>-<br>-&nbsp;&nbsp;&nbsp; private void QueryCompleted(object sender, EventArgs e)<br>+&nbsp;&nbsp;&nbsp;&nbsp; private void QueryCompleted(object sender, DataPortalResult&lt;T&gt; e)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsBusy = false;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var eventArgs = (IDataPortalResult)e;<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (eventArgs.Error == null)<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Model = (T)eventArgs.Object;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (e.Error == null)<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Model = e.Object;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Error = eventArgs.Error;<br>+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Error = e.Error;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OnRefreshed();<br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>lukky replied on Tuesday, December 15, 2009</h2>I like the version using lambda better.<br /><br />My $0.02</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>triplea replied on Tuesday, December 15, 2009</h2>That would be cool. A bit like the improvement in 3.6.2 where RegisterProperty overloads were added using Lambdas instead of strings.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, December 15, 2009</h2>This is a good idea, I will add it to the wish list.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
