<html><header><title>GUID or not?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>GUID or not?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/448.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonM posted on Thursday, June 22, 2006</h2>Hey everyone, I'm looking for quick opinion of what other people are doing.&nbsp; I'm currently working on a medium size CSLA project.&nbsp; So far the project has been built using GUIDs as the primary key.&nbsp; The main reasoning behind this is that we may eventually want offline versions and will use merge replication.&nbsp; However, more and more, I seem to think that the offline version is less important.&nbsp; Most new smartphones can be connected over the internet, and you can even buy high-speed EVDO cards for tablets/laptops.&nbsp; Does it make more sense just to use integer/autonumber type primary keys and forget about offline modes?&nbsp; I guess I'm worried that in the long-term guid keys will give me database slowdown&nbsp;(sql server 2005)&nbsp;over a integer key.&nbsp; Any suggestions on this?&nbsp; I'm still at a point where I can convert, however once data is live it will be nearly impossible to switch.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bill replied on Thursday, June 22, 2006</h2>Merge replication requires the presence of ROWGUIDCOL, but it doesn't have to be the primary key.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Thursday, June 22, 2006</h2>Guids also have the advantage of not having to be retrieved after an insert and being unique for shared data across applications.&nbsp; I have an application two applications synchronising data with integer PKs and I really wish that the original architect had gone with Guids.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>BMStroh replied on Thursday, June 22, 2006</h2><P>I've seen an article somewhere that proposed something called a COMB - it was GUID-ish, but was much more index-friendly to the database, because it wasn't entirely random.</P>
<P>I'm not an expert in this area by a long shot, so I've always been curious to learn if the idea was as sensible as it seemed at the time when I was reading it.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brettswift replied on Thursday, June 22, 2006</h2>I noticed one small perk to having a GUID.&nbsp;&nbsp; I created a TreeView control which has objects and subsets of objects etc etc.&nbsp;&nbsp;&nbsp; I don't have to get the type of each one in the looping and compare it to each of my BO types to figure out which I'm dealing with - or use reflection or something along those lines, I simply just compare it to the GUID I'm looking for to find the right treenode that I want to deal with...&nbsp;&nbsp; <br><br>A specific example, but should give you an idea of a GUIDS versatility. <br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>guyroch replied on Friday, June 23, 2006</h2>Read the following thread... http://www.searchcsla.com/Details.aspx?msn_id=22852 <br><br>and read this article too... http://www.informit.com/articles/article.asp?p=25862&amp;seqNum=7&amp;rl=1<br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonM replied on Sunday, June 25, 2006</h2>Thanks for the responses everyone.&nbsp; I really wanted to make sure I wasn't doing something that was going to bite me in the near future.&nbsp; This application may be up and running for a long 5-10 years.&nbsp; (Applications always seem to like twice as long as you think).&nbsp; Also, it would be a nightmare to convert the system from guid to integer (or vise versa) once the system is online with production data that uses those primary keys for relation.&nbsp; With the good possibility of a mobile extension to the application coming the next 1-2 years, already having a guid key will keep from having to add columns (and increasing the row size).&nbsp; It looks like I might even be able to use that new sql anywhere microsoft keeps talking about.&nbsp; As anyone figured this new database edition out?&nbsp; It sounds like mobile edition to me (the version for tablet and pocket pcs).</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>odie replied on Monday, June 26, 2006</h2><P>Here is the COMB guid function I converted from an article I read on performance issues using full guids and indexing in a database. If I converted it correctly that is? It is functioning OK in the programs I have developed over the past year or two.</P>
<P>This function takes the first portion of a standard guid and combines it with the byte values of a portion of the Today.ToFileTimeUtc function.</P>
<P>I will have to see if I can dig up the article as a reference to read...</P>
<P>Additionally, with this function part of the guid remains constant for each day you generate them, and though it does slightly increase the possiblity of a duplicate guid being generated it is still fairly remote.</P>
<P>Here is a sample of guids generated:<BR><FONT face="Courier New" size=2>2d92f21a-f13f-4afb-9fc1-37c2e598c601<BR>a9e2a31d-df4d-45a8-a16f-37c2e598c601<BR>0b24591b-77d6-47f9-94dc-37c2e598c601<BR>a7d99d1b-3270-4f78-b118-37c2e598c601<BR>455d5db7-f3a7-443f-b5da-37c2e598c601</FONT></P>
<P><FONT size=2></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> Guids</P>
<P></FONT><FONT color=#008000 size=2>''' </FONT><FONT color=#808080 size=2>&lt;summary&gt;</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>''' Custom guid: Returns a mofidied guid paritially based on current date</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>''' </FONT><FONT color=#808080 size=2>&lt;/summary&gt;</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>''' </FONT><FONT color=#808080 size=2>&lt;returns&gt;</FONT><FONT color=#008000 size=2>Custom Guid</FONT><FONT color=#808080 size=2>&lt;/returns&gt;</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>''' </FONT><FONT color=#808080 size=2>&lt;remarks&gt;</FONT><FONT color=#008000 size=2>Using this guid reduces database seek times with large number of records compared to standard guids</FONT><FONT color=#808080 size=2>&lt;/remarks&gt;</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> CustomGuid() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Guid</P>
<P></FONT><FONT color=#008000 size=2>'Function to generate custom GUID's</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> nGuid </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Guid</P>
<P>nGuid = Guid.NewGuid</P>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> DateByteArray </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Byte</FONT><FONT size=2>()</P>
<P>DateByteArray = System.BitConverter.GetBytes(Today.ToFileTimeUtc)</P>
<P></FONT><FONT color=#008000 size=2>'need to get the first 10 bytes of nGuid and the last 6 of DateByteArray</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> GuidByte </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Byte</FONT><FONT size=2>() = nGuid.ToByteArray</P>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> index </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>For</FONT><FONT size=2> index = 0 </FONT><FONT color=#0000ff size=2>To</FONT><FONT size=2> 5</P>
<P>GuidByte(10 + index) = DateByteArray(index + 2)</P>
<P></FONT><FONT color=#0000ff size=2>Next</P></FONT><FONT size=2>
<P>nGuid = </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> Guid(GuidByte)</P>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> nGuid</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</P></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
