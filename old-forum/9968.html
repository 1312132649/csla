<html><header><title>how to process Async FetchChild? No BeginFetchChild method?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>how to process Async FetchChild? No BeginFetchChild method?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9968.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ddredstar posted on Friday, January 21, 2011</h2><p>As we know, Csla has FetchChild for Child Object.</p>
<p>anyone please tell me how to process Async FetchChild.</p>
<p>Thanks</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Friday, January 21, 2011</h2><p>Create an &lt;Object&gt;Accessor (a ReadOnlyRoot or CommandBase derivate) that implements the DataPortal call (and can run Async) and creates the chuld object on the &quot;logical serverside&quot; and returns it to the client. </p>
<p>This technique is described in the <a href="http://download.lhotka.net/Default.aspx?t=UsingCsla4">Csla4 EBook Creating Business Object</a>s and I highly recommend buying it. </p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>OscarLauroba replied on Tuesday, January 25, 2011</h2><p>I have the book and I didn&#39;t find any sample that shows how to use FetchChild. </p>
<p>My problem is that I have a read-only child list that I want to load in a asynchronous lazy way. The book shows how to use a &quot;child object creator&quot;, but doesn&#39;t show how this object creator gets a read-only child list from its data access region.(I&#39;ve gotten&nbsp;0 matches when searching FetchChild in the pdf).</p>
<p>&nbsp;It would be very interesting to see how it can be done. Maybe the book is uncomplete yet?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, January 25, 2011</h2><p>So the lazy loaded property would look something like this:</p>
<pre style="font-family:consolas;">&nbsp;&nbsp;&nbsp; <span style="color:blue;">public</span>&nbsp;<span style="color:blue;">static</span>&nbsp;<span style="color:blue;">readonly</span>&nbsp;<span style="color:#2b91af;">PropertyInfo</span>&lt;<span style="color:#2b91af;">AddressEditList</span>&gt;&nbsp;AddressesProperty&nbsp;=<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RegisterProperty&lt;<span style="color:#2b91af;">AddressEditList</span>&gt;(c&nbsp;=&gt;&nbsp;c.Addresses,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2baf9a;">RelationshipTypes</span>.Child&nbsp;|&nbsp;<span style="color:#2baf9a;">RelationshipTypes</span>.LazyLoad);<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">public</span>&nbsp;<span style="color:#2b91af;">AddressEditList</span>&nbsp;Addresses<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">get</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">if</span>&nbsp;(!FieldManager.FieldExists(AddressesProperty))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">DataPortal</span>.BeginFetch&lt;<span style="color:#2b91af;">AddressListCreator</span>&gt;((o,&nbsp;e)&nbsp;=&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">if</span>&nbsp;(e.Error&nbsp;!=&nbsp;<span style="color:blue;">null</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">throw</span>&nbsp;e.Error;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">else</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Addresses&nbsp;=&nbsp;e.Object.Result;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">return</span>&nbsp;<span style="color:blue;">null</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">else</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">return</span>&nbsp;GetProperty(AddressesProperty);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">private</span>&nbsp;<span style="color:blue;">set</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoadProperty(AddressesProperty,&nbsp;<span style="color:blue;">value</span>);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OnPropertyChanged(AddressesProperty);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}</pre>
<p>and the AddressListCreator would be like this:</p>
<pre style="font-family:consolas;">&nbsp;&nbsp;[<span style="color:#2b91af;">Serializable</span>]<br />&nbsp;&nbsp;<span style="color:blue;">public</span>&nbsp;<span style="color:blue;">class</span>&nbsp;<span style="color:#2b91af;">AdresslistCreator</span>&nbsp;:&nbsp;<span style="color:#2b91af;">ReadOnlyBase</span>&lt;<span style="color:#2b91af;">AdresslistCreator</span>&gt;<br />&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">public</span>&nbsp;<span style="color:blue;">static</span>&nbsp;<span style="color:blue;">readonly</span>&nbsp;<span style="color:#2b91af;">PropertyInfo</span>&lt;<span style="color:#2b91af;">AddressEditList</span>&gt;&nbsp;ResultProperty&nbsp;=&nbsp;RegisterProperty&lt;<span style="color:#2b91af;">AddressEditList</span>&gt;(c&nbsp;=&gt;&nbsp;c.Result);<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">public</span>&nbsp;<span style="color:#2b91af;">AddressEditList</span>&nbsp;Result<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">get</span>&nbsp;{&nbsp;<span style="color:blue;">return</span>&nbsp;GetProperty(ResultProperty);&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">set</span>&nbsp;{&nbsp;LoadProperty(ResultProperty,&nbsp;<span style="color:blue;">value</span>);&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">private</span>&nbsp;<span style="color:blue;">void</span>&nbsp;DataPortal_Fetch(<span style="color:blue;">int</span>&nbsp;criteria)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:green;">//&nbsp;get&nbsp;data&nbsp;from&nbsp;database into repository objects or use L2S / EF ....</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Result&nbsp;=&nbsp;<span style="color:#2b91af;">AddressEditList</span>.GetAddressEditList(addressDataList);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;}<br /><br />and AddressEditList would be like this:  <br /><br />&nbsp; [<span style="color:#2b91af;">Serializable</span>]<br />&nbsp;&nbsp;<span style="color:blue;">public</span>&nbsp;<span style="color:blue;">class</span>&nbsp;<span style="color:#2b91af;">AddressEditList</span>&nbsp;:&nbsp;<span style="color:#2b91af;">BusinessListBase</span>&lt;<span style="color:#2b91af;">AddressEditList</span>,&nbsp;<span style="color:#2b91af;">AddressEdit</span>&gt;<br />&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">internal</span>&nbsp;<span style="color:blue;">static</span>&nbsp;<span style="color:#2b91af;">AddressEditList</span>&nbsp;GetAddressEditList(<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">object</span>&nbsp;childData)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">return</span>&nbsp;<span style="color:#2b91af;">DataPortal</span>.FetchChild&lt;<span style="color:#2b91af;">AddressEditList</span>&gt;(childData);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">private</span>&nbsp;<span style="color:blue;">void</span>&nbsp;Child_Fetch(<span style="color:blue;">object</span>&nbsp;childData)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RaiseListChangedEvents&nbsp;=&nbsp;<span style="color:blue;">false</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">foreach</span>&nbsp;(<span style="color:blue;">var</span>&nbsp;child&nbsp;<span style="color:blue;">in</span>&nbsp;(<span style="color:#2baaaf;">IList</span>&lt;<span style="color:blue;">object</span>&gt;)childData)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">this</span>.Add(<span style="color:#2b91af;">AddressEdit</span>.GetAddressEdit((child)));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RaiseListChangedEvents&nbsp;=&nbsp;<span style="color:blue;">true</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;}<br /><br />and further AddressEdit like this:<br /><br />&nbsp; [<span style="color:#2b91af;">Serializable</span>]<br />&nbsp;&nbsp;<span style="color:blue;">public</span>&nbsp;<span style="color:blue;">class</span>&nbsp;<span style="color:#2b91af;">AddressEdit</span>&nbsp;:&nbsp;<span style="color:#2b91af;">BusinessBase</span>&lt;<span style="color:#2b91af;">AddressEdit</span>&gt;<br />&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">internal</span>&nbsp;<span style="color:blue;">static</span>&nbsp;<span style="color:#2b91af;">AddressEdit</span>&nbsp;GetAddressEdit(<span style="color:blue;">object</span>&nbsp;childData)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">return</span>&nbsp;<span style="color:#2b91af;">DataPortal</span>.FetchChild&lt;<span style="color:#2b91af;">AddressEdit</span>&gt;(childData);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">private</span>&nbsp;<span style="color:blue;">void</span>&nbsp;Child_Fetch(<span style="color:blue;">object</span>&nbsp;childData)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:green;">//&nbsp;</span><span style="font-weight:700;color:darkblue;">TODO:&nbsp;load&nbsp;values</span><br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;}</pre></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ddredstar replied on Wednesday, February 16, 2011</h2><p>Why need <strong><span style="color:#2b91af;">AdresslistCreator</span>&nbsp;?</strong></p>
<p>Why not use <span style="color:#2b91af;"><span style="color:#2b91af;">AddressEditList</span>&nbsp; </span>directly?</p>
<p><span style="color:#2b91af;">DataPortal</span>.BeginFetch&lt;<span style="color:#2b91af;"><span style="color:#2b91af;">AddressEditList</span>&nbsp;</span>&gt;((o,&nbsp;e)&nbsp;=&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">if</span>&nbsp;(e.Error&nbsp;!=&nbsp;<span style="color:blue;">null</span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">throw</span>&nbsp;e.Error;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">else</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Addresses&nbsp;=&nbsp;e.Object.Result;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Wednesday, February 16, 2011</h2><p>AddressEditList in this example is an EditableChildList with EditableChild and would normally NOT have static factory methods nor an implementation of DataPortal_Fetch with criteria object(s).</p>
<p>So the AddressListCreator is &quot;readonly-root&quot; object that accepts parameters, implements DataPortal_Fetch and is responsible for loading a child list.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ddredstar replied on Wednesday, February 16, 2011</h2><p>it seems too lazy, <b>Object.Addresses </b>return null, how to resolve this?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, February 17, 2011</h2><p>Please post your code - impossible to give to good recommendations without a review of your code. </p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ddredstar replied on Thursday, February 17, 2011</h2><p>the code is as your code:</p>
<p>i use it like this in my ViewModel</p>
<p><span style="color:#2b91af;">AddressEditList</span>&nbsp; addresslist=<span style="color:#2b91af;">Object.<span style="color:#2b91af;">AddressEditList</span>&nbsp;;</span></p>
<p><span style="color:#2b91af;"></span></p>
<p><span>and the addresslist is null.</span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, February 17, 2011</h2><p>Do you check e.Error in the client side callback? if your object isn&#39;t there, maybe it is because of an error.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, February 16, 2011</h2><p><div style='padding-left: 50px;background-color:silver'><b>OscarLauroba<br></b>
<p>Maybe the book is uncomplete yet?</p>
<div style="CLEAR:both;"></div>
</div></p>
<p>The preview&nbsp;you have of the&nbsp;<em>Data Access</em> ebook is about 50% complete, so there is a lot more content coming.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
