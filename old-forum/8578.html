<html><header><title>Editable Root List Base (ERLB)  and BusinessListBase for transactions</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Editable Root List Base (ERLB)  and BusinessListBase for transactions</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8578.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>den2005 posted on Thursday, February 25, 2010</h2><p>Hi,</p>
<p>&nbsp;&nbsp;&nbsp; I am new in using CSLA.Net and I am looking to implement System.Transactions where involves inserting or updating multiple records of a single table or multiple records of multiple tables and you can rollback when inserting/updating/deleting a single record causes an error like a banking transaction. How can I accomplished this? What would I used? When EditableRootListBase is used and when &nbsp;BusinessListBase is used? what is the difference between them? Can&nbsp;anyone&nbsp;show sample codes to 3 items?&nbsp;Or in order to implement Transactions I need to do manual implements just like before?? </p>
<p>&nbsp;&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>rsbaker0 replied on Thursday, February 25, 2010</h2><p>Usually, with&nbsp;EditableRootListBase (ERLB) each item in the list is saved independently of the others.&nbsp; This contrasts with BusinessListBase (BLB)&nbsp;where all the changes to the entire list are saved as a single unit.&nbsp; A rollback when saving a BLB object would usually prevent any changes to anything in the list from being saved, while a rollback with ERLB only prevents a single entry in the list from being saved. In both cases, the descendant objects of the particular list object(s) being saved are also saved in the same transaction. So, a failure to write any descendant will rollback the saving of an individual item in ERLB, or the entire list with BLB.</p>
<p>ERLB was actually intended for the comparatively narrow use case of supporting editing of root items in a grid, automatically saving the item as you move from row to row.&nbsp;&nbsp;I&#39;ve used it to emulate some odd scenarios from our legacy software where we allow &quot;part&quot; of a list to be saved (with a flag in each object indicating whether it was saved or not), but this was not its intended use. </p>
<p>CSLA has no built in support for a ERLB being a&nbsp;child or descendant of another object, while BLB was explicitly designed for this purpose and easily supports traditional master/detail scenarios (e.g. a purchase order, which would be a BusinessBase object, containing a list of individual line items in BLB object)</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>den2005 replied on Friday, February 26, 2010</h2><p>thanks rsbaker, can you provide sample codes&nbsp;how I can implement a transaction process in a blb class for multiple tables and multiple records???</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Friday, February 26, 2010</h2><p>I&#39;ll be glad to postcode samples that show&nbsp;specifically&nbsp;what I do, but I&#39;m afraid that it would not be current enough to help. We started with CSLA 2.1, before there was any sort of connection management or child data portal.&nbsp; I also manage transactions manually instead of using the TransactionScope attributes.&nbsp; I haven&#39;t done much if any retrofitting as new features have been added to CSLA to make this easier. </p>
<p>However, if you&#39;re just now starting, I&#39;d suggest that you take an approach (at a high level) something like this. I haven&#39;t actually done this get, so I might not have it exactly right, but I think this is close:</p>
<p>(1) Use managed properties wherever possible</p>
<p>(2) Implement Child_Update() in all of your BusinessBase (BB) child objects (BLB already contains a good implementation that you can override if needed)</p>
<p>(3) In your DataPortal_Update() method of your root BB, and in your Child_Update() method of your child BB&#39;s,&nbsp; call FieldManager.UpdateChildren() at the end of whatever database work you do to save the target object.&nbsp; CSLA will cascade this through all child BLB&#39;s and their contained BB child objects</p>
<p>If the TransactionScope attribute works for you, then just include it on your DataPortal_Update() method. Everything done below via the cascading Child_Update calls will occur in that transaction. </p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>bniemyjski replied on Thursday, February 25, 2010</h2><p>
<p>Hello,</p>
<p>I also wanted to add that I tried to implement this into our templates thinking that I would have finer control to roll back the changes. I found this to be a nightmare and that the built in TransactionScope attributes work pretty good. As it manages the roll back if an exception occurs within the DataPortal method.</p>
<p>Thanks</p>
<p>-Blake Niemyjski</p>
<div></div>
</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
