<html><header><title>Suppress Validation Exceptions for Csla.CommonRules Validation Methods</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Suppress Validation Exceptions for Csla.CommonRules Validation Methods</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7615.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>timdilbert posted on Saturday, September 12, 2009</h2>Quick question; I have a business object and I'm trying to add a few of the default Csla built-in Validation methods but every time one of them is broken, it throws an exception.<br /><br />I dont want exceptions to be thrown, instead the rule to be broken and it add the rule to the BrokenRuleCollection on the object. HELP!!! *See example below*<br /><br />//-> EMAIL ADRESS<br />ValidationRules.AddRule(CommonRules.StringRequired, new RuleArgs(EmailAddressProperty, RuleSeverity.Warning, false));<br /><br />So when I update the EmaillAddress property..<br /><br />object.EmailAddress = string.Empty;<br /><br />The following exception is thrown;<br /><br />Property load or set failed for property Email Address (Validation rule rule://Csla.Validation.CommonRules/StringRequired/Email Address failed in property Email Address)</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Sunday, September 13, 2009</h2>Hi, <br><br>What version of Csla are you using and what is the code for your EMailAddress property.<br><br>Seems to me that there is:<br>a: mismatch between the actual propertyname and the name registered i PropertyDescriptor (=&gt; leads to rule not beeing able to find property)<br>b: AuthorizationRules / override of CanReadProperty/CanWriteProperty&nbsp; protects the property from beeing read/set. <br><br>/jonnybee<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>timdilbert replied on Sunday, September 13, 2009</h2>I'm using version 3.6.1-090204 of Csla.<br /><br />I thought that i had these declared properly, below is the code for the EmailAddress Property<br /><br />private static PropertyInfo EmailAddressProperty = RegisterProperty(typeof(ColUser), new PropertyInfo("Email Address"));<br /><br />Here is the getter/setter for the EmailAddress property (nothing to it really).<br /><br />public string EmailAddress<br />		{<br />			get { return GetProperty(EmailAddressProperty); }<br />			set { SetProperty(EmailAddressProperty, value); }<br />		}//;<br /><br />Now with regards to the editing of the object and permissions go. I never did set it on the per property level, just on the AllowExecute for the methods, so<br /><br />protected override void AddAuthorizationRules()<br />		{<br />			string saveMethodName = "Save";<br />			string deleteMethodName = "Delete";<br /><br />			if (IsNew)<br />				AuthorizationRules.AllowExecute(saveMethodName, new List() { Permissions.CreateUser }.ToArray());<br />			else if (!IsNew)<br />				AuthorizationRules.AllowExecute(saveMethodName, new List() { Permissions.ModifyUser, Permissions.CreateUser }.ToArray());<br /><br /><br />			AuthorizationRules.AllowExecute(deleteMethodName, new List() { Permissions.DeleteUser }.ToArray());<br />			base.AddAuthorizationRules();<br />		}<br /><br /><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>JonnyBee:</strong></div><div>Hi, <br><br>What version of Csla are you using and what is the code for your EMailAddress property.<br><br>Seems to me that there is:<br>a: mismatch between the actual propertyname and the name registered i PropertyDescriptor (=> leads to rule not beeing able to find property)<br>b: AuthorizationRules / override of CanReadProperty/CanWriteProperty&#160; protects the property from beeing read/set. <br><br>/jonnybee<br></div></BLOCKQUOTE></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Sunday, September 13, 2009</h2>Hi,<br><br>Your error is easy to spot:<br><br>private static PropertyInfo EmailAddressProperty = RegisterProperty(typeof(ColUser), new PropertyInfo(<b>"Email Address"</b>));
<br><br>public string <b>EmailAddress</b>
<br>		{
<br>			get { return GetProperty(EmailAddressProperty); }
<br>			set { SetProperty(EmailAddressProperty, value); }
<br>		}//;
<br><br>Your property is <b>NOT </b>named <b>"Email Address"</b>, the property name should be <b>"EmailAddress"</b>.<br>PropertyInfo class has several overloads but the first parameter must always be the exact PropertyName - second parameter may be "friendely property name". So your PropertyInfo should look like this: <br><br>
private static PropertyInfo EmailAddressProperty = RegisterProperty(typeof(ColUser), new PropertyInfo( <b>"EmailAddress", </b><b>"Email Address"</b>));
<br><br>/jonnybee<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>timdilbert replied on Monday, September 14, 2009</h2>You were right, sorry about this..<br /><br /><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>JonnyBee:</strong></div><div>Hi,<br><br>Your error is easy to spot:<br><br>private static PropertyInfo EmailAddressProperty = RegisterProperty(typeof(ColUser), new PropertyInfo(<b>"Email Address"</b>));<br /><br><br>public string <b>EmailAddress</b><br /><br>		{<br /><br>			get { return GetProperty(EmailAddressProperty); }<br /><br>			set { SetProperty(EmailAddressProperty, value); }<br /><br>		}//;<br /><br><br>Your property is <b>NOT </b>named <b>"Email Address"</b>, the property name should be <b>"EmailAddress"</b>.<br>PropertyInfo class has several overloads but the first parameter must always be the exact PropertyName - second parameter may be "friendely property name". So your PropertyInfo should look like this: <br><br><br />private static PropertyInfo EmailAddressProperty = RegisterProperty(typeof(ColUser), new PropertyInfo( <b>"EmailAddress", </b><b>"Email Address"</b>));<br /><br><br>/jonnybee<br><br><br></div></BLOCKQUOTE></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Sunday, September 13, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>timdilbert:</strong></div><div>...<br />The following exception is thrown;<br /><br />Property load or set failed for property Email Address (Validation rule rule://Csla.Validation.CommonRules/StringRequired/Email Address failed in property Email Address)</div></BLOCKQUOTE><br /><br />If you get his error, you're actually getting a runtime exception in the validation rule code itself, not because the validation check itself is deciding the rule doesn't pass. <br /><br />In the debugger, bring up the Exceptions screen and tell it you want to break when an exception is "thrown", not just unhandled. Then it will actually stop at the point of failure and you can see what is wrong. </div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
