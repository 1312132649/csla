<html><header><title>Searchable and sortable binding list in CSLA?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Searchable and sortable binding list in CSLA?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3055.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rayc posted on Wednesday, June 20, 2007</h2><P>I have a class that implements a searchable and sortable binding list (called SearchableSortableBindingList). When I bind such a list to a Datagridview, I get the ability to sort my records in ascending or descending order when I click a column header.</P>
<P>A few weeks later I discovered CSLA and started learning it. I belive in CSLA, you use BusinessListBase when you want a list of your business objects. However, this class does not have the functionality as in my SearchableSortableBindingList class. </P>
<P>Can someone explain to me how I can incorporate my class with CSLA? Or point me in the right direction?</P>
<P>Thanks !</P>
<P>Ray</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonM replied on Wednesday, June 20, 2007</h2><P>You want to use the SortedBindingList.&nbsp; Basically you create it and pass in your BusinessBase Collection.&nbsp; Then you bind the SortedBindingList to the datagridview and now it is sortable!</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, June 20, 2007</h2><P>You can use SortedBindingList and/or FilteredBindingList if you only need single property sorting.</P>
<P>I decided to use the excellent ObjectListView (in CSLA Contrib) because it allows sorting and filtering in the same class with multiple property sorts as an option. Very easy to use.</P>
<P>Bottom line - Rocky decided that modifying the existing List was a bad idea and changed it in CSLA2 so that you can View the list instead. All 3 classes mentioned above support this view concept.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rayc replied on Friday, June 22, 2007</h2><P>I can't seem to find ObjectListView. </P>
<P>Can you tell me where I can find it?</P>
<P>Thanks !</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Saturday, June 23, 2007</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>rayc:</strong></div><div> 
<P>I can't seem to find ObjectListView. </P>
<P>Can you tell me where I can find it?</P>
<P>Thanks !<BR></div></BLOCKQUOTE></P>
<P>This thread discusses it:</P>
<P><A href="/forums/thread/10559.aspx">http://forums.lhotka.net/forums/thread/10559.aspx</A></P>
<P>Code can be found here:</P>
<P><A href="http://www.codeplex.com/CSLAcontrib/SourceControl/ListDownloadableCommits.aspx"><FONT color=#667766>http://www.codeplex.com/CSLAcontrib/SourceControl/ListDownloadableCommits.aspx</FONT></A><BR>Go there and download the most recent version.&nbsp; You should be able to find the necessary files in there.Extract the zip file into folders and delete all the stuff you don't want and keep:</P>
<P>\Csla2Extensions\ObjectListView\CSharp</P>
<P>I copied them to a new folder structure and created a separate project so I could reference the binaries in my real app. It also allowed me to change the namespace to Csla2 the other day and re-compile. I normally like to convert C# to VB but there is a lot of code here and it is fully tested - I would be afraid of introducing a bug. Brian said he was thinking of doing the conversion but it is a lot of work and not really needed as long as you can reference the binaries.</P>
<P>Joe</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rayc replied on Thursday, June 21, 2007</h2><P><FONT face=Arial size=2>From&nbsp;Rocky's book I have the following:</FONT></P>
<P><FONT face="Courier New" size=2>public class InvoiceList : ReadOnlyListBase&lt;InvoiceList, InvoiceInfo&gt;<BR>{<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT face="Courier New" size=2>public static InvoiceList GetInvoiceList()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return DataPortal.Fetch&lt;InvoiceList&gt;(new Criteria());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>...</FONT><FONT face="Courier New" size=2><BR></FONT><FONT face="Courier New" size=2>}</FONT></P>
<P><FONT face=Arial size=2>So I modified it to look like this:</FONT></P>
<P><FONT face="Courier New" size=2>public static InvoiceList GetInvoiceList()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp; InvoiceList _invoiceList = DataPortal.Fetch&lt;InvoiceList&gt;(new Criteria());<BR>&nbsp;&nbsp;&nbsp;&nbsp; SortedBindingList&lt;InvoiceList&gt; sortedList = new SortedBindingList&lt;InvoiceList&gt;(_invoiceList);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return sortedList;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</FONT></P>
<P><FONT face="Courier New" size=2>The problem I'm having is that I'm trying to take the list returned by the DataPortal.Fetch and converting it to a SortedBindingList.</FONT></P>
<P><FONT face="Courier New" size=2>But this doesn't work. The compiler isn't able to convert from one to the other. What am doing wrong?</FONT></P>
<P><FONT face="Courier New" size=2>Thanks in advance</FONT></P>
<P><FONT face="Courier New" size=2></FONT>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Thursday, June 21, 2007</h2>Either do this:<br><br><font face="Courier New" size="2">public static </font><font face="Courier New" size="2">SortedBindingList&lt;Invoice&gt; </font><font face="Courier New" size="2">GetSortedInvoiceList()<br>{<br>&nbsp;&nbsp;&nbsp; InvoiceList _invoiceList = DataPortal.Fetch&lt;InvoiceList&gt;(new Criteria());<br>&nbsp;&nbsp;&nbsp; SortedBindingList&lt;Invoice&gt; sortedList = new&nbsp; SortedBindingList&lt;Invoice&gt;(_invoiceList);<br>&nbsp;&nbsp;&nbsp; return sortedList;<br>}</font><br><br>or this:<br><br><font face="Courier New" size="2">SortedBindingList&lt;Invoice&gt; sortedList = </font><font face="Courier New" size="2">new&nbsp; SortedBindingList&lt;Invoice&gt;(InvoiceList.</font><font face="Courier New" size="2">GetInvoiceList()</font><font face="Courier New" size="2">);</font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rayc replied on Friday, June 22, 2007</h2><P>I had tried that but I kept getting&nbsp;error CS1502:</P>
<P>The best overloaded method match for Csla.SortedBindingList&lt;Accounting.Invoice&gt;.SortedBindingList&lt;System.Collections.Generic.IList&lt;Accounting.Invoice&gt;&gt; has some invalid arguments</P>
<P>The same line also gives me the error CS1503:<BR>Argument '1' cannot convert from 'Accounting.InvoiceList' to 'System.Collections.Generic.IList&lt;Accounting.Invoice'</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Wednesday, June 20, 2007</h2>CSLA comes with two views, FilteredBindingList and SortedBindingList that allow you to filter or sort a list of objects.&nbsp; They are composable, so you can add a list to a SortedBindingList and then add that to a FilteredBindingList.<br><br>Alternatively, you can use the ObjectListView from the CSLAcontrib project. It follows the same semantics as the System.Data.DataView but works on lists of objects.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
