<html><header><title>SL vs WPF going forward - another look</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>SL vs WPF going forward - another look</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11557.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>TSF posted on Wednesday, August 29, 2012</h2><p>I&#39;ve received a lot of good advice from Rocky over the past year through this forum and his blog about future direction between SL &amp; WPF.&nbsp; I also read the white paper at magenic on the SL/WPF/WinRT direction.&nbsp; One of the big points I noticed was that the advice seemed to revolve around staying (or getting) in the best shape to make an easier transition to Win 8 / WinRT.&nbsp; I get that.&nbsp; I also get that SL 5 has pretty much closed the gap on what is possible between both SL &amp; WPF.&nbsp; However, my company hasn&#39;t even finished rolling out Win 7.&nbsp; WinRT just isn&#39;t on the radar, so that transition isn&#39;t really a concern for this next iteration.</p>
<p>As my company begins a 15-month journey next month to rewrite a VB6 LOB app (with tons of info and over a hundred different screens) I am primarily concerned about performance.&nbsp; The app is super quick right now.&nbsp; Mgmt. has already stated that speed cannot be compromised.&nbsp; While it will also be challenging to come up with a good UI using newer metaphors that can display so much data, I&#39;m hopeful we can successfully deal with that.</p>
<p>So, my question about the speed revolves around SL being (at minimum) a 3-tier app, vs WPF being easily deployed as either 2 or 3-tier with a simple config change required.&nbsp; While more scalable as 3-tier...we only have 400-500 users, 1/4 of which are remote around the country.&nbsp; How much does scalability matter when talking about that number and distribution&nbsp;of users?&nbsp; If we go SL and find performance issues from the extra hop, we&#39;re stuck.&nbsp; If we go WPF and find performance issues from the extra hop, we can always reconfigure to a 2-tier (client/server) deployment.&nbsp; Any thoughts on this matter?&nbsp; Am I needlessly worrying about this or focusing on the wrong thing?&nbsp; Thanks for any advice.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>StefanCop replied on Thursday, August 30, 2012</h2><p>Here&#39;re some points that are true for me (our application) regarding performance. </p>
<p>As we will have only few concurrent users (5-50), if it wouldn&#39;t be for internet connectivity and security, I would totally go the 2-tier configuration. </p>
<p>The performance issues we foudn so far: <br />- new UI are slower than WinForms, especially DevExpress WPF (they argue with a lot of features): <br />&nbsp;&nbsp; to open only a view without a view model or even business objects took sometimes too long: &gt;1 sec MS WPF, &gt; 4 sec DevExpress (other like Telerik are in between). <br />- for every non-trivial UI we end with tailored Business Object graphs, otherwise you load too much or have to lazy load, which are additional server calls. </p>
<p>Product manager (talking to existing user base) want a better UI experience but a similar speed as in the old direct 2-tier DB access. <br />- Dropdowns with column data; select by typing in a combobox sometimes on two properties (either text or number) <br />- Filtering, sorting, grouping of datagrids <br />- Validating as much as possible while the user enters/modifies data<br />- Autom. saving and restoring of UI settings (size, filter, sort, groups, collapsed&nbsp;state etc)&nbsp;<br />- Larger UI (more fields due to bigger screens, or better expand/collapse section vs. old-style open a new dialog window) <br />All this ends in loading much more data before the user can begin work. </p>
<p>- We try to cache all &quot;static&quot; (which rarely changes) in UI client<br />- We use user story (screen) tailored object graphs <br />- We use unit-of-work to load all root object lists needed at once</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TSF replied on Thursday, August 30, 2012</h2><p>Thanks, Stefan.&nbsp; Are you drawing a difference between SL &amp; WPF?&nbsp; Or between XAML-based apps and WinForms?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>StefanCop replied on Thursday, August 30, 2012</h2><p>A difference between WPF and WinForms. And even worse, we&#39;ve apparently choosen the lamest components regarding performance (measure &amp; layout): 6 times slower than raw Microsoft WPF. </p>
<p>The VB6 thing crossed my mind: if you plan to build the new app with the VB6 people, just keep in mind that they might not yet know the impact of 3-tier, creating business objects, or service calls. </p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TSF replied on Thursday, August 30, 2012</h2><p>The last VB6 guy left has transitioned already to CSLA / SL.&nbsp; The problem is that a much smaller app we recently did with SL4 (3-tier) &amp; CSLA comes across as slower to people.&nbsp; The project lead has asked us why.&nbsp; It doesn&#39;t help that the DBAs have opted to hit a myriad of individual databases instead of using a single DB server with replicated /consolidated data.&nbsp; So the stored procs themselves are quite sluggish.&nbsp; But beyond the slow procs, I&#39;m just not totally certain that there won&#39;t be some noticeable speed difference with SL over VB6 even if the data pulls aren&#39;t an issue.&nbsp;&nbsp; Hence my question about WPF vs SL, since we could at least configure WPF as 2-tier, if needed.</p>
<p>BTW - we just purchased the Telerik control suite for both SL &amp; WPF.&nbsp; Hopefully that will prove a little better than the DevExpress troubles you noted.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>StefanCop replied on Thursday, August 30, 2012</h2><p>Regarding performance (our simple tests) Telerik was nearly as or equally fast as Microsoft WPF. So, I think this is a good choice. </p>
<p>We wrote a log entry after every DataPortal invocation including the time needed. This helped a lot to identifiy expensive and unnecessary server calls.</p>
<p>I also did measure the size of an avarage CSLA object (a node in a graph).&nbsp;In our app the avarage is around&nbsp;2kB-8kB in memory,&nbsp;about same size&nbsp;using SL MobileFormatter, and 0.1x size using BinaryFormatter (TCP/IP). I have been a bit suprised how much CSLA needs, but using a debugger it&#39;s all reasonable. </p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>StefanCop replied on Thursday, August 30, 2012</h2><p>Ah, another thing we looked at it: 2-tier vs. 3-tier (times are very difficult to reproduce, because of the OS and asynchronous loading of different root objects/lists). <br />But it&#39;s at most&nbsp;&nbsp; 1.2. - 2.0&nbsp;&nbsp; we could gain (we didn&#39;t use the don&#39;t serialize-in-local-portal-mode, so all data is serialized+deserialized in memory). I think we will improve something by not going through any DataPortal for children (at least to many-to-one).</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>StefanCop replied on Thursday, August 30, 2012</h2><p>My success factors from a CSLA perspective are: user story tailored object graphs, also using the unit-of-work idea. And caching of static, catalogue like data.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>richardb replied on Thursday, August 30, 2012</h2><p>This is one of those almost impossible questions to answer <img src="http://forums.lhotka.net/emoticons/emotion-1.gif" alt="Smile" /></p>
<p>If you move to a WPF UI regardless if its SL or desktop, you will need new hardware and a graphics card to ensure that the UI rendering is fast.&nbsp; I had the unpleasant experience of having to deploy onto PC&#39;s with no graphics cards with WPF using software rendering and it was painfully slow&nbsp;at times.</p>
<p>Remember that performance is often an illusion and there are many tricks to make users think it&#39;s fast.&nbsp; The new async model is going to help make your UI feel more responsive.</p>
<p>If you have to go WPF, I&#39;d be looking at Silverlight - it&#39;s the closest model to the future Microsoft strategy.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TSF replied on Thursday, August 30, 2012</h2><p>We had to use software rendering already on an older WPF app and it didn&#39;t seem too bad for in our situation.&nbsp; Just wondering how much the extra hop costs when transferring the object graphs over the wire (using compression) vs being able to hit the database directly via 2-tier in WPF.</p>
<p>Very good point about <em>perception</em> of performance.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>StefanCop replied on Thursday, August 30, 2012</h2><p><div style='padding-left: 50px;background-color:silver'><b>TSF<br></b>We had to use software rendering already on an older WPF app and it didn&#39;t seem too bad for in our situation.&nbsp;</div></p>
<p>I must admit that the critical screens are in my opinion crazy: over 60 fields, drop downs or grids are on it. But new elements like expand/collapse regions could mislead requirement engineers and hide the amount well from our preview users.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, August 30, 2012</h2><p>The &quot;scattered around the country&quot; phrase is something that immediately leads me to think about 3-tier, at least for those users. The use of service protocols over a WAN is almost always better than the less reliable SQL Server raw communication.</p>
<p>It is also the case that WinRT is also a 3-tier only technology. It might not be on your planning horizon now, but it will be a factor within the lifetime of your app (assuming a typical 7-15 year app lifespan). Of course CSLA helps mitigate that 3-tier requirement, so that&#39;s always good :)</p>
<p>My general recommendation at this point is that either WPF or SL are fine choices. Neither of them is going to get any major dev effort inside Microsoft, because all Microsoft&#39;s energies are now focused on WinRT. In other words, they are now equivalent to Windows Forms, in that they are stagnant technologies. Or to use a more positive word, they are _stable_ technologies :)</p>
<p>If you use WPF, that&#39;s a fine choice. I just _strongly_ recommend building your app with some constraints:</p>
<ul>
<li>Use the async data portal - make NO sync server calls</li>
<li>Test in 3-tier mode, even if you are going to deploy in 2-tier</li>
<li>Assume you are using MobileFormatter (avoid private fields - use managed backing fields)</li>
</ul>
<p>If you do those simple things then your business layer and data layer will be positioned to support WinRT. Perhaps more important in the short-term, you&#39;ll also be able to use 3-tier deployments for those users that are remote, and 2-tier for those that are local.</p>
<p>One last thing is to recognize that your UI (the XAML and code-behind, perhaps the viewmodels) won&#39;t translate directly into WinRT. My view is always that presentation layers are expendable, and in this case we <em>know</em> the future, so we know the presentation is expendable. Plan accordingly.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TSF replied on Thursday, August 30, 2012</h2><p>Thanks for the additional advice.&nbsp; The main reason for considering WPF would be the <em>option</em> to go 2-tier for users on the LAN, if we felt it was needed.&nbsp; Just wondering how much of a difference that would make.</p>
<p>Good point about remote users on the WAN.&nbsp; We use the mobile formatter and we do code async.</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>bartol replied on Thursday, August 30, 2012</h2><p>I went through a similar process three years ago and unfortunately we ended up parking the new WPF/CSLA application in part due to not so good performance. This project was not a client/server forms-in-front-of-tables app but more of a raw processing app so your experience may be different. A couple of points:</p>
<p>Watch out for Telerik&#39;s/ComponentOne/Whoever&#39;s components. Do not assume that their performance matches the WPF native controls. Be careful with performance when customizing the native (or other) controls. Also, whenever possible, choose the simplest (as in less flashy) component. Take special attention to grids and charts. They can be very very slow (use paging). If you are using MVVM be on the lookout for unintended loads. That is, components and windows that are using CPU cycles even though they are not visible. If you find yourself in trouble performance-wise try dropping MVVM for that specific window and use good old events and direct command. Also, if performance is that important consider buying and using a profiler right from the start.</p>
<p>Finally, consider not doing the big bang approach. The business will be tempted to add new features on top of the migration since you will be offline for 15 months. Why not package parts of the old app as ActiveX controls and surface them in the new app? It will look terrible for a while but your turnaround will be a lot shorter.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TSF replied on Thursday, August 30, 2012</h2><p>I had not considered an ActiveX strategy before.&nbsp;&nbsp;Does that assume the various parts of the current VB6 app are written as user controls instead of just forms?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>bartol replied on Friday, August 31, 2012</h2><p>Yes, the VB6 application UI elements will have to be exposed as ActiveX controls. If the application is a single executable then I would convert it into one single ActiveX control to simplify things. If, on the other hand, the application is already broken down into&nbsp;ActiveX&nbsp;controls and ActiveX DLLs with a good separation of UI/Backend then you have more options. I would also investigate the various projects that exist out there to assist migration (here is a list&nbsp;<a href="http://msdn.microsoft.com/en-us/vstudio/ms788241">http://msdn.microsoft.com/en-us/vstudio/ms788241</a>).</p>
<p>The current plan for that project I mentioned before is to use the WPF container application as the base (the main window with the menus and toolbar) and mix the new screens that were created in WPF with the old panels that we don&#39;t have time to rebuild now. We are going to re-style the WPF components with the same look as the VB6 components (there are differences in colour here and there) because this is an off the shelf application but an internal app could get away with skipping this part. The hard part will be reconciling the new CSLA backend with the old ORM-ish one. We will probably run everything off the old one and have CSLA call into it for a while but there are some doubts there.</p>
<p>What killed this project was not the migration per se but the temptation to add new functionality during the migration which took 2 years. That coupled with disappointing performance of some WPF components. For example, we had to revert to Microsoft Winforms chart half way through the project because everything else was just too slow (and we tested pretty much everything that was out there).</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
