<html><header><title>System.NotSupportedException: Invalid operation - delete not allowed</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>System.NotSupportedException: Invalid operation - delete not allowed</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6673.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>danielw posted on Wednesday, March 25, 2009</h2><P>I have created a silverlight remote data portal app which is working fine. <BR>We now have a need to delete business base objects.</P>
<P>But keep getting System.NotSupportedException: Invalid operation - delete not allowed error.</P>
<P>Code is as follows</P><FONT color=#808080 size=2><FONT color=#808080 size=2>
<P></FONT></FONT>
<P><FONT color=#808080 size=2><FONT color=#808080 size=2></P></FONT></FONT><FONT size=2></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>static</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>void</FONT></FONT><FONT size=2> DeleteEmployee(</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Int32</FONT></FONT><FONT size=2> sEM_ID,</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>EventHandler</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>DataPortalResult</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Employee</FONT></FONT><FONT size=2>&gt;&gt; handler)<BR>{<BR></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>DataPortal</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Employee</FONT></FONT><FONT size=2>&gt; dp = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>DataPortal</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Employee</FONT></FONT><FONT size=2>&gt;();<BR>dp.DeleteCompleted += handler;<BR>dp.BeginDelete(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Criteria</FONT></FONT><FONT size=2>(sEM_ID));<BR>}</FONT></P><FONT size=2><FONT size=2>
<P>and then</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2></FONT></FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>protected</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>override</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>void</FONT></FONT><FONT size=2> DataPortal_Delete(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2> Crits)<BR>{<BR></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Criteria</FONT></FONT><FONT size=2> crit = (</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Criteria</FONT></FONT><FONT size=2>)Crits;<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>using</FONT></FONT><FONT size=2> (</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>SqlConnection</FONT></FONT><FONT size=2> cn = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>SqlConnection</FONT></FONT><FONT size=2>(</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>DataBase</FONT></FONT><FONT size=2>.MakingSpaceOperationsConnection))<BR>{<BR>cn.Open();<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>using</FONT></FONT><FONT size=2> (</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>SqlCommand</FONT></FONT><FONT size=2> cmd = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>SqlCommand</FONT></FONT><FONT size=2>(</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"JM_Employee_Delete"</FONT></FONT><FONT size=2>, cn))<BR>{<BR></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ApplicationContext</FONT></FONT><FONT size=2>.LocalContext[</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"dpConnection"</FONT></FONT><FONT size=2>] = cn;<BR></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ApplicationContext</FONT></FONT><FONT size=2>.LocalContext[</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"dpCommand"</FONT></FONT><FONT size=2>] = cmd;<BR>cmd.CommandType = System.Data.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>CommandType</FONT></FONT><FONT size=2>.StoredProcedure;</FONT></P>
<P><FONT size=2>cmd.Parameters.AddWithValue(</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"@SEM_ID"</FONT></FONT><FONT size=2>, crit.SEM_ID);<BR></FONT><FONT size=2>onDeletePre(cmd, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>EventArgs</FONT></FONT><FONT size=2>.Empty);<BR>cmd.ExecuteNonQuery();<BR></FONT><FONT size=2>onDeletePost(cmd, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>EventArgs</FONT></FONT><FONT size=2>.Empty);</FONT></P>
<P><FONT size=2>}}}</FONT></P>
<P><FONT size=2>It gives no error and compiles but when run using</FONT></P><FONT color=#2b91af size=2><FONT color=#2b91af size=2>
<P>Employee</FONT></FONT><FONT size=2>.DeleteEmployee(1</FONT><FONT size=2>, DeleteEmployees);</P>
<P></FONT><FONT size=2>It returns the Delete not allowed error. We have stepped throught the code and cannot see anything wrong we seem to have overridden the method successfully.</FONT></P>
<P>&nbsp;</P>
<P>Has anybody got any ideas</P>
<P>Cheers</P>
<P>Daniel</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, March 25, 2009</h2>Don't override; create an overload that accepts a Criteria object.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>danielw replied on Thursday, March 26, 2009</h2><P>Thanks for the reply.<BR></P>
<P>I tried that at first but it did not work. Putting it back gives<BR><FONT size=2>However after more digging I have found that it works fine if I use the singlecriteria but if I try to use my own Criteria it gives the&nbsp; Invalid operation - delete not allowed error</FONT></P>
<P><FONT size=2>I guess I might be setting up my criteria wrong but it works for the fetch fine</FONT></P>
<P><FONT size=2>Anybody else got any ideas</FONT></P>
<P><FONT size=2>Cheers<BR>Daniel</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, March 26, 2009</h2>I think you'll need to put you factory method, dataportal method, and entire criteria class.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
