<html><header><title>OT But really cool - Partial Methods In VB.NET 9</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>OT But really cool - Partial Methods In VB.NET 9</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3282.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>pelinville posted on Friday, July 27, 2007</h2><P><A href="http://blogs.msdn.com/vbteam/archive/2007/03/27/partial-methods.aspx">http://blogs.msdn.com/vbteam/archive/2007/03/27/partial-methods.aspx</A></P>
<P>These are methods that allow for much better code generation.&nbsp; This is something I have dreamed of for some time now.</P>
<P>And while I am on the subject of Partial and code generation I figured out something just a couple of days ago.&nbsp;</P>
<P>Ok, this is probably obvious to most everybody else but it was not for me. So I figure I would share and maybe one or two others might benifit.</P>
<P>I was always under the impression that when doing code generation that I&nbsp;had to&nbsp;pick either inheritance or partial classes.&nbsp;But actually you can combine them.&nbsp; </P>
<P>This is really important.usefule when the templates by default&nbsp;hide certain methods/fields but you find you really need to expose them.</P><FONT color=#008000>
<P>'This is the generated class and I put it in a sub folder.<BR></FONT><FONT color=#0000ff>Public</FONT> <FONT color=#0000ff>Class</FONT> CustomerBase</P>
<P><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Inherits</FONT> Csla.Core.BusinessBase</P>
<P><FONT color=#008000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'I like to make all fields private when generating code.<BR>&nbsp;</FONT><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Private</FONT> lvSomeProtectedVar <FONT color=#0000ff>As</FONT> <FONT color=#0000ff>String</P>
<P>End</FONT> <FONT color=#0000ff>Class</FONT></P>
<P><FONT color=#0000ff>&nbsp;</P>
<P>Public</FONT> <FONT color=#0000ff>Class</FONT> Customer<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#0000ff>Inherits</FONT> CustomerBase</P>
<P><FONT color=#008000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'But somtime I Need to get at or expose lvSomeProtectedVar but can't<BR></FONT><FONT color=#008000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Also don't want to go and modify a tmeplate just to expose this one field this one time.</P></FONT><FONT color=#0000ff>
<P>End</FONT> <FONT color=#0000ff>Class</P>
<P>Partial</FONT> <FONT color=#0000ff>Class</FONT> CustomerBase</P>
<P><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT color=#008000>'So make a Partial Class but only when needed to expose the private fields however you need.</FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp; Public</FONT> <FONT color=#0000ff>Property</FONT> SomeProtectedVar() <FONT color=#0000ff>As</FONT> <FONT color=#0000ff>String<BR></FONT><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff>Return</FONT> lvSomeProtectedVar<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#0000ff>End</FONT> <FONT color=#0000ff>Get<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff>Protected</FONT> <FONT color=#0000ff>Set</FONT>(<FONT color=#0000ff>ByVal</FONT> value <FONT color=#0000ff>As</FONT> <FONT color=#0000ff>String</FONT>)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lvSomeProtectedVar = value<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#0000ff>End</FONT> <FONT color=#0000ff>Set<BR>&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff>End</FONT> <FONT color=#0000ff>Property</P>
<P>End</FONT> <FONT color=#0000ff>Class</P></FONT>
<P>&nbsp;</P>
<P>Like I said I am probably the last one to realize this but still, really cool.</P>
<P><BR>&nbsp;</P>
<P></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MikeHamilton replied on Wednesday, August 01, 2007</h2><P>Actually I have not done much with partial classes and writing objects, Really just getting into more OO abstraction, so it is something I had not thought of or ran into yet so you are nto the only one.</P>
<P>Thanks for posting for that reason,</P>
<P>Mike</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mr_lasseter replied on Friday, December 21, 2007</h2>One thing I don't understand is why VB&nbsp;&nbsp; implemented partial methods the way they did.&nbsp; Look at the following:<br><br>Partial Public Class Person<br><br>&nbsp;&nbsp;&nbsp; Private _name As String<br><br>&nbsp;&nbsp;&nbsp; Partial Private Sub OnNameChanging(ByVal oldValue As String, ByVal newValue As String)<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>&nbsp;&nbsp;&nbsp; Public Property Name() As String<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return _name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As String)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OnNameChanging(_name, value)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _name = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>End Class<br><br>Partial Public Class Person<br><br>&nbsp;&nbsp;&nbsp; Private Sub OnNameChanging(ByVal oldValue As String, ByVal newValue As String)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine(String.Format("Old Value: {0} {2} New Value: {1}", oldValue, newValue, Environment.NewLine))<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>End Class<br><br><br>The non generated class has no way of knowing the OnNameChanging is actually a partial method.&nbsp; To me this is a huge mistake, since someone can rename the method and change the behavior of the class.&nbsp; Looks like the C# team got this right:<br><br>public partial class Person<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; partial void OnNameChanging(string oldValue, string newValue);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private string _name;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string Name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return _name; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OnNameChanging(_name, value);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _name = value;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public partial class Person<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; partial void OnNameChanging(string oldValue, string newValue)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine(string.Format("Old Value: {0} \n New Value: {1}", oldValue, newValue));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>To bad I can't switch to C#...<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
