<html><header><title>Silverlight Lazy Load Children in VB.Net</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Silverlight Lazy Load Children in VB.Net</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7539.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>GregDobbs posted on Sunday, August 30, 2009</h2>Hello all.<br /><br />I am attempting to lazy load children in SL using CSLALight 3.7.0. using VB .Net.<br /><br />The following C# code is from this forum:<br /><br />private bool _loadingScore = false;<br /><br />private static PropertyInfo ScoreInfoProperty = <br />  RegisterProperty(new PropertyInfo("ScoreInfo", "ScoreInfo"));<br />public Score ScoreInfo<br />{<br />  get<br />  {<br />    if (!_loadingScore &amp;&amp; (!FieldManager.FieldExists(ScoreInfoProperty) || ReadProperty(ScoreInfoProperty) == null))<br />    {<br />#if SILVERLIGHT<br />      _loadingScore = true;<br />      Score.GetScore(<br />        ReadProperty(ProfileIDProperty), <br />        ReadProperty(PersonNameProperty), <br />        ReadProperty(NicknameProperty), <br />        ReadProperty(TeamIDProperty),<br />        ((TeamMemberInfoList)this.Parent).ParentTeam.Name, <br />        (o, e) =><br />          {<br />            LoadProperty(ScoreInfoProperty, e.Object);<br />            OnPropertyChanged(ScoreInfoProperty.Name);<br />            _loadingScore = false;<br />          }<br />        );<br />#else<br />      LoadProperty(ScoreInfoProperty, Score.GetScore(<br />        ReadProperty(ProfileIDProperty), <br />        ReadProperty(PersonNameProperty), <br />        ReadProperty(NicknameProperty), <br />        ReadProperty(TeamIDProperty), <br />        ((TeamMemberInfoList)this.Parent).ParentTeam.Name));<br />#endif<br />    }<br />    return GetProperty(ScoreInfoProperty);<br />  }<br />}<br /><br />As I am abysmal in C# (and also not familiar enough with lambdas yet), does anyone have a translation for this or a similar implementation written in VB.Net?<br /><br />Thanks in advance!</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, August 31, 2009</h2><P>This is much harder in VB. There is no multi-line lambda in the current version of VB, so you have to create a different method and pass its address as the callback handler.</P>
<P>You might also need to create an entire new class to act as the "message" between the original code and the callback method.</P>
<P>The result is that you'll write 2-3x more code (and more complex code) to get the same result.</P>
<P>It is a serious PITA, and is the primary reason I stopped maintaining CSLA .NET itself in VB (because this occurs in many places inside the framework).</P>
<P>The good news (fwiw) is that VB 10 has multi-line lambdas, so sometime next year you'll be able to do this the easy way.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
