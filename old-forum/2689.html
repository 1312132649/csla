<html><header><title>MyMembershipProvider class is not being recognized</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>MyMembershipProvider class is not being recognized</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2689.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav posted on Thursday, April 12, 2007</h2><P>I fashioned MyMembershipProvider exactly after the PTMembershipProvider in the book, with one difference.&nbsp; Since I use Web Application Projects, which do not have an App_Code folder, I have the class practically sitting next to the Web.config in the main directory.&nbsp; The config entry is also&nbsp;almost verbatim the same as the book, except for the class name, of course.&nbsp; Unfortunately, when logging in I keep getting a message that says, "MyMembershipProvider is not recognized".</P>
<P>Any ideas what I'm doing wrong</P>
<P>Jav</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, April 12, 2007</h2>I haven't tried what you are doing - but you may consider creating a class library project and putting the code there. That way you can explicitly reference the object by assembly/type name since you control the whole thing.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Thursday, April 12, 2007</h2><P>Thanks Rocky and Chris for your suggestions.</P>
<P>But I am at my wits' end.&nbsp; Here is entry in my Config file.&nbsp; This is the first entry in &lt;system.web&gt; section.</P>
<P dir=ltr>&lt;membership defaultProvider="TessMembershipProvider"&gt;<BR>&nbsp;&nbsp;&nbsp;&lt;providers&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&lt;clear /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&lt;add name="TessMembershipProvider" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; type="TessMembershipProvider, BizCommon" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; connectionStringName="EnvMembershipConnectionString" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enablePasswordRetrieval="false" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enablePasswordReset="true" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; requiresQuestionAndAnswer="true" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; requiresUniqueEmail="true" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; passwordFormat="Clear"/&gt;<BR>&nbsp;&nbsp;&nbsp;&lt;/providers&gt;<BR>&lt;/membership&gt;</P>
<P dir=ltr>Here is the totality of my TessMembershipProvider</P>
<P dir=ltr>Public Class TessMembershipProvider<BR>&nbsp;&nbsp;&nbsp; Inherits System.Web.Security.SqlMembershipProvider</P>
<P dir=ltr>&nbsp;&nbsp;&nbsp; Public Overrides Function ValidateUser( _<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ByVal username As String, ByVal password As String) As Boolean</P>
<P dir=ltr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If TessPrincipal.Login(username, password) Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Web.HttpContext.Current.Session("CslaPrincipal") = _<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Csla.ApplicationContext.User<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return True</P>
<P dir=ltr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return False<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If</P>
<P dir=ltr>&nbsp;&nbsp;&nbsp; End Function<BR><FONT color=#008000>' Non Impelemnted Methods here</FONT><BR>End Class </P>
<P dir=ltr>This class is in an assembly called BizCommon.&nbsp; Here is what I see in the Asp.Net Configuration module when I click the Security Tab:</P>
<P dir=ltr><SPAN id=ctl00_ctl00_content_content_exceptionMessageLabel0>The following message may help in diagnosing the problem: </SPAN><SPAN id=ctl00_ctl00_content_content_exceptionMessageLabel1>Could not load type 'TessMembershipProvider' from assembly 'BizCommon'. (C:\MediWin\web.config line 40)</SPAN> </P>
<P dir=ltr>If I fully qualify the class name as Tess.TessMembershipProvider, the error changes to:</P>
<P dir=ltr><SPAN id=ctl00_ctl00_content_content_exceptionMessageLabel0>The following message may help in diagnosing the problem: </SPAN><SPAN id=ctl00_ctl00_content_content_exceptionMessageLabel1>Could not load type 'Tess.TessMembershipProvider' from assembly 'BizCommon'. (C:\MediWin\web.config line 40)</SPAN> </P>
<P dir=ltr>I can do this in the login page without error<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#0000ff size=2>Dim</FONT><FONT size=2> prov </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Tess.TessMembershipProvider</FONT></P>
<P dir=ltr>Amazingly, for months I have been using this very class with my Web Application Projects witout a single problem.&nbsp; It all turned topsy turvy when I started using Ajax extensions.&nbsp; I started getting some errors in the Source of my Forms.&nbsp; A visit to the Ajax website suggested that I must create an Ajax Enabled Web Application instead of an ordinary App.&nbsp;&nbsp;Since that time (48 hours ago) when&nbsp;I created a brand new Ajax Enabled Application and painfully copied back all my stuff, I have not been able to run the App beyond a look at the Login page. Misery unbounded.</P>
<P dir=ltr>Jav<BR>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Friday, April 13, 2007</h2><P>You're inheriting from System.Web.Security.SqlMembershipProvider instead of simply specifying the interface of MembershipProvider. </P>
<P>Have you done this on purpose? Have you run the utility against the database to create all the necessary tables and stored procedures? </P>
<P>In the book, Rocky inherits MembershipProvider. My custom class does as well. I wonder if your problem is related to your inheritance?</P>
<P>If you are inheriting from SqlMembershipProvider on purpose (assumedly to try to leverage the tables/stored procedures/implementation) have you tried changing your Web.config to temporarily use the SqlMembershipProvider as your default provider? If you've run your utility and your Web.config is set to the SqlMembershipProvider and you still have problems getting into the utility, I would start to wonder if you have something going on with your Web.config that isn't quite right. </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Friday, April 13, 2007</h2><P>Chris,</P>
<P>I think you are on to something here.&nbsp; I pulled out a backup of my old code this morning to see how I had it set up when it was working, and my config file was indeed different. it was:</P>
<P>&nbsp;&nbsp;&lt;membership defaultProvider="TessMembershipProvider"&gt;<BR>&nbsp;&nbsp;&nbsp;&lt;providers&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&lt;clear /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&lt;add name="TessMembershipProvider"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#ff0000>type="System.Web.Security.SqlMembershipProvider"<BR></FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; connectionStringName="EnvMembershipConnectionString"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enablePasswordRetrieval="false"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enablePasswordReset="true"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; requiresQuestionAndAnswer="true"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; requiresUniqueEmail="true"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; passwordFormat="Clear"/&gt;<BR>&nbsp;&nbsp;&nbsp;&lt;/providers&gt;<BR>&nbsp;&nbsp;&lt;/membership&gt;<BR></P>
<P>I am actually using the aspnetdb database.&nbsp; While at the present time I am only using the basic functionalty, I did find some of the other capabilities intriguing for playing around with in the future.</P>
<P>Thank you for your help.&nbsp; This forum - if we didn't have this kind of help, I don't know what we would do at times like this.&nbsp; Thanks again to you and to Rocky.</P>
<P>I am sorry for duplicating the previous message while trying to edit it, I tried deleting one but the forum wouldn't let me.</P>
<P>Jav</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Friday, April 13, 2007</h2><P>Awesome. I'm glad I could help and I couldn't agree more - this forum is one of the reasons I settled on CSLA in the first place.</P>
<P>Enjoy your weekend.</P>
<P>Chris</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Thursday, April 12, 2007</h2><P>Thanks Rocky and Chris for your suggestions.</P>
<P>But I am at my wits' end.&nbsp; Here is entry in my Config file.&nbsp; This is the first entry in &lt;system.web&gt; section.</P>
<P dir=ltr>&lt;membership defaultProvider="TessMembershipProvider"&gt;<BR>&nbsp;&nbsp;&nbsp;&lt;providers&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&lt;clear /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&lt;add name="TessMembershipProvider" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; type="TessMembershipProvider, BizCommon" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; connectionStringName="EnvMembershipConnectionString" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enablePasswordRetrieval="false" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; enablePasswordReset="true" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; requiresQuestionAndAnswer="true" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; requiresUniqueEmail="true" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; passwordFormat="Clear"/&gt;<BR>&nbsp;&nbsp;&nbsp;&lt;/providers&gt;<BR>&lt;/membership&gt;</P>
<P dir=ltr>Here is the totality of my TessMembershipProvider</P>
<P dir=ltr>Public Class TessMembershipProvider<BR>&nbsp;&nbsp;&nbsp; Inherits System.Web.Security.SqlMembershipProvider</P>
<P dir=ltr>&nbsp;&nbsp;&nbsp; Public Overrides Function ValidateUser( _<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ByVal username As String, ByVal password As String) As Boolean</P>
<P dir=ltr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If TessPrincipal.Login(username, password) Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Web.HttpContext.Current.Session("CslaPrincipal") = _<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Csla.ApplicationContext.User<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return True</P>
<P dir=ltr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return False<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If</P>
<P dir=ltr>&nbsp;&nbsp;&nbsp; End Function<BR><FONT color=#008000>' Non Impelemnted Methods here</FONT><BR>End Class </P>
<P dir=ltr>This class is in an assembly called BizCommon.&nbsp; Here is what I see in the Asp.Net Configuration module when I click the Security Tab:</P>
<P dir=ltr><FONT color=#ff0000><SPAN id=ctl00_ctl00_content_content_exceptionMessageLabel0>The following message may help in diagnosing the problem: </SPAN><SPAN id=ctl00_ctl00_content_content_exceptionMessageLabel1>Could not load type 'TessMembershipProvider' from assembly 'BizCommon'. (C:\MediWin\web.config line 40)</SPAN></FONT> </P>
<P dir=ltr>If I fully qualify the class name as Tess.TessMembershipProvider, the error changes to:</P>
<P dir=ltr><FONT color=#ff0000><SPAN id=ctl00_ctl00_content_content_exceptionMessageLabel0>The following message may help in diagnosing the problem: </SPAN><SPAN id=ctl00_ctl00_content_content_exceptionMessageLabel1>Could not load type 'Tess.TessMembershipProvider' from assembly 'BizCommon'. (C:\MediWin\web.config line 40)</SPAN> </FONT></P>
<P dir=ltr>I can do this in the login page without error<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#0000ff size=2>Dim</FONT><FONT size=2> prov </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Tess.TessMembershipProvider</FONT></P>
<P dir=ltr>Amazingly, for months I have been using this very class with my Web Application Projects witout a single problem.&nbsp; It all turned topsy turvy when I started using Ajax extensions.&nbsp; I started getting some errors in the Source of my Forms.&nbsp; A visit to the Ajax website suggested that I must create an Ajax Enabled Web Application instead of an ordinary App.&nbsp;&nbsp;Since that time (48 hours ago) when&nbsp;I created a brand new Ajax Enabled Application and painfully copied back all my stuff, I have not been able to run the App beyond a look at the Login page. Misery unbounded.</P>
<P dir=ltr>Jav<BR>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Thursday, April 12, 2007</h2><P>Hey Jav -</P>
<P>I'm not entirely sure what you did for your custom membership provider, but for mine, I essentially created one that "wraps" another membership provider to leverage all the implementation of it (specifically the SqlMembershipProvider) but it remotes over to the app server to invoke the membership API there. In that case, I need to provide the configuration in the Web.config for the membership provider in the remoting directory's Web.config too. </P>
<P>Both my web directory's and remoting directory's web.config have similar entries within system.web for configuring the membership provider, except that since the web app doesn't use DB settings, I don't need the connection string in the web directory's web.config. </P>
<P>(I happen to use the sample code they released for the SqlMembershipProvider as I liked to see it through the debug - but I could have just wrapped the one in the .Net framework too).</P>
<P>So like I said, I'm not sure exactly what your membership provider is doing, but in case this helps I thought I'd pass it along.</P>
<P>Within the &lt;system.web&gt; tag I have:</P>
<P>&nbsp;&nbsp;&lt;membership defaultProvider="CslaMembershipProvider"&gt;<BR>&nbsp;&nbsp;&nbsp;&lt;providers&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- Note that the connection string is irrelevant on the client side Web app --&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&lt;!-- It is supplied on the remoting site's Web config. SqlMembershipProvider balks if it's not there. --&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&lt;clear/&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&lt;add name="CslaMembershipProvider" type="xxx.CoreSystem.Library.CslaMembershipProvider" connectionStringName="xxx" functionalProvider="Microsoft.Samples.SqlMembershipProvider" passwordFormat="Encrypted" minRequiredNonalphanumericCharacters="0" minRequiredPasswordLength="6" enablePasswordRetrieval="false" requiresUniqueEmail="true" requiresQuestionAndAnswer="true" enablePasswordReset="true" description="Csla enabled membership provider"/&gt;<BR>&nbsp;&nbsp;&nbsp;&lt;/providers&gt;<BR>&nbsp;&nbsp;&lt;/membership&gt;</P>
<P>Good luck,</P>
<P>Chris</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
