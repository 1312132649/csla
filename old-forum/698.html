<html><header><title>Modelling Question - Main Attributes and Language Specific Attributes</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Modelling Question - Main Attributes and Language Specific Attributes</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/698.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>tsouki posted on Friday, July 21, 2006</h2>Hi, all.<br>
<br>
I have a class (let's say Locations) which has some main attributes
like Id, ParentId, Code etc. and some language specific
attributes&nbsp; like Description, History, Abstract (String
attributes).<br>
<br>
My question is how should I model my class. I would like to have something like this:<br>
<br>
myLocation.CurrentLang.Description = "asdf"<br>
myLocation.CurrentLang.Abstract = "asdf" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for the current language loaded<br>
<br>
and<br>
<br>
myLocation.Lang("en").Description = "asdf"<br>

myLocation.Lang("en").Abstract = "asdf" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; for a different Language<br>
<br>
The approach that I have in mind is to have a different class with the
language&nbsp; specific attributes which I get through the properties
CurrentLang or Lang("en"). However what I'd really like to avoid is to
allow the direct instantanation of the new class from outside my
Location class (even if the new one is nested). <br>
<br>
Any implementation ideas or another approach?<br>
<br>
<br>
<br>
<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, July 21, 2006</h2>Do you have a different Location per language, or are you just trying to represent a single Location in different languages?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tsouki replied on Thursday, July 27, 2006</h2><P>Hi, I'm sorry for the delay but I'm on vacations and no internet access is available.</P>
<P>I'm trying to represent a single location in different languages. I tried the following workaround.</P>
<P>I have one class with the language independent attibutes of a Location and one class with language dependent attributes. In the first class I have a property that returns the second class, according to a lang argument. Here's the implementation</P><FONT color=#0000ff size=2>
<P>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> Location</FONT><FONT color=#0000ff size=2></P>
<P>Private</FONT><FONT size=2> _Details </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Dictionary(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>, LocationDetails)</P></FONT>
<P><FONT size=2><FONT size=6>&nbsp;&nbsp;&nbsp;.<BR>&nbsp;&nbsp;&nbsp;.<BR>&nbsp;&nbsp;&nbsp;.</FONT><BR></FONT><FONT size=2><BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>ReadOnly</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</FONT><FONT size=2> Details(</FONT><FONT color=#0000ff size=2>Optional</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> locale </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#800000 size=2>""</FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> LocationDetails<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>Get<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim</FONT><FONT size=2> mLocale </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> locale = </FONT><FONT color=#800000 size=2>""</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>mLocale = MyLanguage.CurrentLanguage<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>mLocale = locale<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</FONT></P>
<P><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim</FONT><FONT size=2> dets </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> LocationDetails<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>._Details.ContainsKey(mLocale) </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>dets = </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>._Details.Item(mLocale)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> LocationDetails.Exists(</FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>._Id, mLocale) </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>dets = LocationDetails.GetLocationDetails(</FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>._Id, mLocale)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>dets = LocationDetails.NewLocationDetails<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dets.LocationId = </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>._Id<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dets.Locale = mLocale<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>._Details.Add(mLocale, dets)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> dets<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Get<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</FONT></P>
<P><FONT color=#0000ff size=6>&nbsp;&nbsp;&nbsp;.<BR>&nbsp;&nbsp;&nbsp;.<BR>&nbsp;&nbsp;&nbsp;.</FONT></P><FONT color=#0000ff size=2>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> Save() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Location<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> Saved </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Location = </FONT><FONT color=#0000ff size=2>MyBase</FONT><FONT size=2>.Save<BR></FONT><FONT color=#008000 size=2><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> i </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Dictionary(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>, LocationDetails).Enumerator<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i = </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>._Details.GetEnumerator()</FONT></P>
<P><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;While</FONT><FONT size=2> i.MoveNext<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.Current.Value.LocationId = </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>._Id<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i.Current.Value.Save()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>While<BR><BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return</FONT><FONT size=2> Saved</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P>
<P></FONT><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT size=6>.<BR>&nbsp;&nbsp;&nbsp;.<BR>&nbsp;&nbsp;&nbsp;.</FONT></P></FONT><FONT color=#0000ff size=2>
<P>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#000000 size=3>In the Save method first I save the Location object, because in case of a new Location a foreign key is required by the LocationDetails class and then I save any LocationDetails object in the _Details dictionary. Both Location and LocationDetails classes inherit from BusinessBase.</FONT></FONT></P>
<P>What do you think?</P>
<P><FONT color=#0000ff size=2>&nbsp;</P></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
