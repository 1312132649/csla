<html><header><title>Session object in MVC</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Session object in MVC</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9319.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>SDM10012 posted on Tuesday, August 03, 2010</h2><p>&nbsp;</p>
<p>&nbsp;</p>
<p>maybe I should check the 4.0 documentation ... but I&#39;m working with 3.8.4 beta&nbsp;... I&#39;ve finished my BO&#39;s and am now integrating into a MVC solution .....</p>
<p>The mvc example does not check the Session Object to see if the current&nbsp;BO is of the type that is&nbsp;&nbsp;being broght into the View ..... In the WebForm world the examples checked to see if the bo being created / read / updated /deleted was of the same type as the bo in Session ...</p>
<p>Is that pattern passe with MVC ??&nbsp; Pros ?? / Cons ??</p>
<p>thx,</p>
<p>Steve</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, August 04, 2010</h2><p>When building a web app, whether MVC or not, you need to decide if your server will be stateless or not.</p>
<p>When I built most (all?) of the Web Forms samples I used a stateful server model - so Session was allowed.</p>
<p>Most MVC apps, in my observation, have stateless servers. So I&#39;ve mostly been building demo/sample MVC code using a stateless approach.</p>
<p>But ultimately it is your choice.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SDM10012 replied on Wednesday, August 04, 2010</h2><p>ok ... so now I am trying to figure out how to pass a business object from one View to another .... I create my Customer on the opening page and want to send it to the customer.invoices page without having to re-instantiate ...</p>
<p>I&#39;m working on the&nbsp;BO layer and my web designer is rather new to asp.net mvc .... </p>
<p>I assume it&#39;s feasible .... looking for&nbsp;examples on passing a model from one view to another ....</p>
<p>having a variable in the Global.asax is one option, I assume ... any other patterns for this ???</p>
<p>thx,</p>
<p>S</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SDM10012 replied on Wednesday, August 04, 2010</h2><p>is this an example of where MVVM would be relevant ???</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, August 04, 2010</h2><p>You need to store the server-side state somewhere between server options. Navigating from one view to another involves at least one postback, which means the server loses all its state (by default) between calls.</p>
<p>Unless you put the object in Session it won&#39;t be there on the postback (the next controller action).</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xAvailx replied on Thursday, August 05, 2010</h2><p>I would avoid using session as much as possible (you will see this the case in almost all MVC examples). </p>
<p>In your scenario, re fetching the Customer should be perfectly fine if you need the customer info again. Your URL would look something like this:</p>
<p>YourApp/Customers/1/Invoices/ &lt;-- for a list of invoices for customer 1.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SDM10012 replied on Thursday, August 05, 2010</h2><p>Thanks ..</p>
<p>Really surprised that there is no way to pass a model (instance of customer) &nbsp;from from one view to another ...&nbsp;&nbsp; I really have to make another database call to see the same instance in another form ???</p>
<p>and about session ...&nbsp; I&#39;ll have to double check ( hard to load the Ptracker MVC demo on machine with MVC2 installed ) ... but what about keeping the CSLA Principal in Session for authentication and permissions ???</p>
<p>Is there a better approach for that ???</p>
<p>Steeve</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xAvailx replied on Friday, August 06, 2010</h2><p>Well, depends what you mean. Is it a completely different view? Or is it a partial view? If it is a partial view, then yeah, what you are saying makes sense.&nbsp;</p>
<p>But you don&#39;t really pass models from views to views. The controller is what feeds the models to the views. Perhaps if you explain your scenario can help better.&nbsp;</p>
<p>And yes, you usually do have to make another call from db if you are on a different page. Remember, web is stateless (unless you store somewhere like in Session or the Db, which is what you are trying to avoid).</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SDM10012 replied on Saturday, August 07, 2010</h2><p>what about using WCF instance management to persist a list of business objects ?</p>
<p>I beleive that it is feasible to engineer a way to persist the in-memory CLR objects ( CSLA BOs ) for all web users in a List&lt;BusinessObject&gt; that is managed by a service outside of the users web session.&nbsp; So instead of re-querying the DB ( or in my case calling a 3rd party ASMX method ) ... why not cache DTO&#39;s or the BO&#39;s themselves behind a WCF facade ???</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>xAvailx replied on Saturday, August 07, 2010</h2><p>You probably should weight and really test whether caching will give you benefits in your scenario. You are calling a 3rd party web service, so maybe it would be best to cache if that is a really expensive call in your scenario. But I would test, before making the assumption caching will be the best as it brings its own set of complexity (like when to refresh, what happens if changes happen and data is still cached, etc...)</p>
<p>If you are dead set on caching, maybe take a look at Windows Server App Fabric (aka Velocity). Scott Hanselmann had a recent post on it:</p>
<p><a href="http://www.hanselman.com/blog/InstallingConfiguringAndUsingWindowsServerAppFabricAndTheVelocityMemoryCacheIn10Minutes.aspx">http://www.hanselman.com/blog/InstallingConfiguringAndUsingWindowsServerAppFabricAndTheVelocityMemoryCacheIn10Minutes.aspx</a></p>
<p><a href="http://msdn.microsoft.com/en-us/windowsserver/ee695849.aspx">http://msdn.microsoft.com/en-us/windowsserver/ee695849.aspx</a></p>
<p>HTH..</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Saturday, August 07, 2010</h2><p>xAvailx is right - premature optimization is an anti-pattern. If you don&#39;t <i>know</i> that you have a problem, don&#39;t try to fix the problem you might or might not have.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
