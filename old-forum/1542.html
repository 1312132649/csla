<html><header><title>Use Case Issue - Different Field Required for Sort</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Use Case Issue - Different Field Required for Sort</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1542.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jkellywilkerson posted on Thursday, October 19, 2006</h2><P>Hello All,</P>
<P>I have a use case that requires an Agent.&nbsp; The agent can be a person or a company.&nbsp; The issue that I have is that I need to order/sort an NVL BO by name or number.&nbsp; I have solved that issue; however, if the agent is a company, the CompanyName field is used and, if the agent is a person, the LastName and FirstName fields are used.&nbsp; Therefore, when the order/sort by name occurs, the "Company Agents" appear in the list first because the LastName and FirstName fields are "String.Empty".</P>
<P>I am using two different stored procedures to return the data for the BO: one that orders by AgentNumber and one that orders by LastName, FirstName, CompanyName.&nbsp; When I use the BO in the UI, I call AgentNVL.GetAgentList(False) to sort by "Number" and AgentNVL.GetAgentList(True) to sort by "Name".</P>
<P>How do I force the CompanyName field to sort with the LastName.&nbsp; For instance, I have the following data:</P>
<P>&nbsp;&nbsp;&nbsp;AgentNumber&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LastName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FirstName&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CompanyName</P>
<P>&nbsp;&nbsp;&nbsp;0001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Williams&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;John&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;0002&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Williams&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Amy</P>
<P>&nbsp;&nbsp;&nbsp;0003&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Winton Corporation</P>
<P>That is how it looks using the order/sort by AgentNumber, but whenever the NVL is ordered/sorted by "Name", I get "0003" listed first, "0002" second, and then "0001".&nbsp; It should be listed with "0002" first,"0001" second, and "0003" last.</P>
<P>Any help is greatly appriciated.</P>
<P>Kelly.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, October 19, 2006</h2>Perhaps you could implement IComparable?&nbsp; <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jkellywilkerson replied on Thursday, October 19, 2006</h2><P>Hey Andy,</P>
<P>I don't think I'm quite ready to tackle that one yet (at least "level-of-knowledge-wise" anyway).&nbsp; I would not even know where to start.&nbsp; Thanks for the idea though; I may have to use that as a last resort.</P>
<P>Kelly.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>malloc1024 replied on Thursday, October 19, 2006</h2><p class="MsoNormal">

</p>
<p class="MsoNormal">You could create a name field that returns a company name
for a company and the last name + first name for a person.<span>&nbsp; </span>You would sort by name.<span>&nbsp; </span>I not sure it this is what you exactly want,
but it is an alternative to what you are doing.</p>

<p class="MsoNormal">
</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jkellywilkerson replied on Thursday, October 19, 2006</h2><P>That is basically what I'm doing.&nbsp; I put a check in for the string.length of the fields and if the company name is &gt; 0 then I use the CompanyName and if the last name is &gt; 0 I use LastName, FirstName.&nbsp; But how do I tell the NVL to sort after the data has been returned from the stored proc?&nbsp; Do I sort the list from the UI or sort in BO after the list is populated?&nbsp; Not sure I know how to do that in the BO.&nbsp; I'm sure that would be the best place to do it because there could be eight or ten thousand agents.&nbsp; I would think that it would take at least a few seconds to sort it in the UI, don't you think?</P>
<P>Kelly.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, October 19, 2006</h2>probably the best bet is to toss the resulting list into a SortedBindingList.&nbsp; Note that the sorting is then done client side and in the UI layer... which is fine, because sorting is a display thing anyway, rarely does the sort really matter to the business layer.<br><br>The sort should go pretty quickly.<br><br>Finally, Implementing IComparable is pretty easy.&nbsp; Its just one method.&nbsp; Basically you woudl figure out what kind of agent the current instance is and what kind the passes instance is, throw the approprate values into two strings, then hand off to string.Compare.<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jkellywilkerson replied on Thursday, October 19, 2006</h2><P>Thanks Andy,</P>
<P>I'll try the SortedBindingList first.&nbsp; Then, I'll try the IComparable route just to see which is better.</P>
<P>Thanks for the advice.</P>
<P>Kelly.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, October 19, 2006</h2>Kelly,<br><br>Either way you'll be using sortedbindinglist I would think.&nbsp; The IComparable method would be instead of creating a third property which picks what to display (fname + lname or company name).<br><br>Andy<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
