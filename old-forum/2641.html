<html><header><title>GUI Form Creation</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>GUI Form Creation</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2641.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Damian posted on Friday, March 30, 2007</h2><P><FONT face=Arial size=2>Does anyone know of a control or a way of auto populating a .net form with controls for all the properties in a business object? I am looking for a fast easy way of generating the front end for a lot of business objects I have. Ideally it would take the business object and create a control based on the underlying datatype of the property anlong with a label for the property name. It should be dynamic in that it builds the controls at runtime. I have came across a control which is&nbsp;quite close called PropertyGrid by VisualHint <A href="http://www.visualhint.com">www.visualhint.com</A>&nbsp;however this only displays the data in grid form, albeit allowing you to control which .net control to use for the underlying data type.</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Friday, March 30, 2007</h2>Hi,<br><br>Recipe:<br><br>- introduce a DisplayInfo attribute (inherits system.attribute)<br>&nbsp;&nbsp;&nbsp; - make it applicable to properties<br>&nbsp;&nbsp;&nbsp; - and add properties as needed for your UI<br>&nbsp;&nbsp;&nbsp; - including an identifier for the type of control to use (dropdown/checkbox/...)<br><br>&lt;AttributeUsage(AttributeTargets.Property)&gt; _<br>Public Class DisplayInfoAttribute<br>&nbsp;&nbsp;&nbsp; Inherits Attribute<br><br>End Class<br><br>- mark all the properties in your BOs that need to be rendered with appropriate DisplayInfo attributes<br><br>- in your UI:<br>&nbsp;&nbsp;&nbsp; - use reflection to get all properties from your BO<br>&nbsp;&nbsp;&nbsp; - filter out those that are marked with DisplayInfo<br>&nbsp;&nbsp;&nbsp; - read the settings on DisplayInfo in order to render the correct visualization in your UI<br><br><br>When you have this working you can take the next step: add support for 'foreign key' properties that are typically edited in your UI using a dropdown that is bound to a name-valuelist:<br>- add a flag (e.g. ForeignKey, or UseNvl) for this <br>- also define the type of the NameValueList that should be used in your UI<br>- still through reflection you can dynamically instantiate an instance of this NVL in your UI<br>&nbsp;&nbsp;&nbsp; - either introduce another attribute to mark your factory method<br>&nbsp;&nbsp;&nbsp; - or use a standard naming convention for your factory methods<br>&nbsp;&nbsp;&nbsp; - either way, you can dynamically create an instance of the NVL by invoking the factory method<br>- all as usual, you can bind this NVL to a new bindingsource and use this to fill a dropdown that enables you edit foreign-key properties<br><br>You know what the best part is?<br>- with just 1 usercontrol you can edit any type of&nbsp; editableroot object, as long as these objects have displayinfo attributes that inform your UI how to render<br>- if this control is debugged and tested basically you have tested all of your editable-root views<br><br>And of course there is a downside:<br>- you will have to get through some reflection to get it all to work<br>- and it can take a while to get this control right, but when you have one you have them all<br><br>Bayu<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Justin replied on Monday, April 02, 2007</h2><P>We also use attributes and a control that at runtime renders the BO but it could just as easily be used to code gen a form instead.</P>
<P>These attributes are not just used for UI generation but rules enforcement as well. For instance&nbsp; Required, Min Length, Max Length, Coded values(NVL), Input mask(string patterns), are all specified in attributes that the UI utilizes and the BO also enforces.</P>
<P>We have tried to stay away from UI specific attributes such as position on form, but are considering doing that as well since they are just suggestions for the UI but can be ignored if the UI chooses. For instance if you use reflection to loop through your properties and display them a inputs on a form they <EM>should</EM> come out in source code order, but we have found that reflection actually caches the propertyinfo reference internally and if you access a propertyinfo of a property out of order before the UI generator gets to it, it will be placed at the top of the cache and come out first. So we are considering adding a TabOrder or DisplayOrder to the attribute to denote specifically which order it is to be rendered, and perhaps even more complex positioning attributes in the future(x,y).</P>
<P>Note this is a great boon to our development as we currently have a winform and RDL renderer for our BO and are working on a ASP.net renderer there by eleminating maintaining 3 UI's (or more) that all represent the BO in the same way but with different technologies.</P>
<P>Justin</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Tuesday, April 03, 2007</h2><BLOCKQUOTE><div><img src="/Themes/alternate1/images/icon-quote.gif"> <strong>Justin:</strong></div><div><p>So we are considering adding a TabOrder or DisplayOrder to the attribute to denote specifically which order it is to be rendered, and perhaps even more complex positioning attributes in the future(x,y).</p>Justin</div></BLOCKQUOTE><br><br>Hey,<br><br>I faced the same issue, and I too did not want my attributes to become too UI-specific. So I did not specify x/y coords, but rather 'logical coords'. <br><br>So I would specify my Contact's Title, FirstName and LastName to appear in the first column at rows 1 to 3 and the Address, PostalCode and City to appear in the second column at rows 1 to 3.<br><br>In WinForms I have two controls:<br>- one that utilises a TableLayoutPanel <br>&nbsp;&nbsp;&nbsp; - it is trivial to translate the logical coords to cells of course<br>&nbsp;&nbsp;&nbsp; - but the panel also supports 2 ways of positioning the label wrt the editor:<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;  - the labels occur left of the editors, than each logical column expands to 2 columns in the tablelayout<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;  - or the labels occurs above the editors, than each logical rows expands to 2 rows and the columns simply match<br><br>- and I have a FlowLayoutPanel because sometimes I don't have room for multiple columns, in that case the logical columns are simply appended below (if the flow is vertical) or next to (if flow is horizontal) each other. Each field that should have appeared in the next column is then preceeded by a separator to maintain some consistency accross panels.<br><br>By using logical coords instead of fixed x/y coords you keep a lot of flexibility in your UI.<br><br>Regards,<br>Bayu<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Justin replied on Tuesday, April 03, 2007</h2><P>I agree that if we did implement some sort of x/y it would be logical and not tied to a specific&nbsp;UI technology. </P>
<P>We are trying to stay away from UI attributes but are starting to question why, beyond it being the "right" way to do things. </P>
<P>For our&nbsp;product it makes more sense to have have the BO define the UI&nbsp;as well since our UI is very regular and we&nbsp;are not large enough to have distinct developers for UI and BO and DB.&nbsp;</P>
<P>Justin</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DansDreams replied on Tuesday, April 03, 2007</h2><P>Danger Will Robinson!&nbsp; (OK, maybe you guys are too young for that).</P>
<P>In my opinion, the statement "For our&nbsp;product it makes more sense to have have the BO define the UI&nbsp;as well" is more likely an indication that you didn't need CSLA in the first place than it is a good way to design enterprise applications.&nbsp; To me that sounds the same as saying "in our company it makes more sense to have the accounting department running the mills on the shop floor."</P>
<P>Don't get me wrong - I built something like that before for a web site and it was very cool and functional, but it was a fairly simple application and definitely not n-tiered.</P>
<P>So, I think the basic premise of having a UI determined at runtime from metadata is sound and potentially useful, but that is UI metadata and not business layer metadata.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Justin replied on Tuesday, April 03, 2007</h2><P>Believe me we are taking a cautious approach, we understand n-tier design and have a successful app written in the "right" way for the time which happend to be com+ windows DNA (remeber that?).</P>
<P>We have realized at&nbsp; least in our application design that most of what makes up the differences between one BO and another's BO UI is simply the data elements and business rules. </P>
<P>If you can infer the order in which the inputs on a form should be displayed from the source code order of the properties why not? Why write another object( a form object)&nbsp;and write glue code to bind the properties of one object to another when you could have just added a little decoration to your BO and the UI has all it needs?</P>
<P>Again these are just suggestions to the UI, should you need to make a different UI you can always code it by hand.</P>
<P>This works well for us because our UI is very regular between most entities, this may not work for others so well.</P>
<P>As I said we already have a functional winform and RDL renderer and they are scaling extremely well and productivity has been amazing with this design and the attributes add very little overhead to the BO.</P>
<P>As far as "in our company it makes more sense to have the accounting department running the mills on the shop floor.", well that is a little extreme but we are small enough that we don't have UI developers, BO developers, and DB developers or DBA's we just have developers and with this model a single developer can makes changes and test&nbsp;all the teirs much more quickly with fewer errors.</P>
<P>Justin</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Friday, March 30, 2007</h2>Oh,<br><br>There is also 'The Microsoft Way'. There is an excellent explanation available in one of the early shows from DotNetRocks TV, check <a href="http://www.dnrtv.com/default.aspx?showID=7">show #7 on www.dnrtv.com</a>.<br><br>This is really fast, but first impressions are misleading. It is a forward-only process, so when your BOs change you can start over. Also: you will have to go through this process for every single BO, everytime again. But what it does do is give you a good impression on how MS would like you to configure your databindings properly.<br><br>Regards,<br>Bayu<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pelinville replied on Friday, March 30, 2007</h2><DIV>I do this for some of my stuff.</DIV>
<DIV>&nbsp;</DIV>
<DIV>Reflection is your friend.&nbsp; I have two forms that can&nbsp;handle 80% of my objects.</DIV>
<DIV>&nbsp;</DIV>
<DIV>It is often kinda ugly and not user friendly.&nbsp; I like Bayus idea of using attributes.&nbsp; They could definatly increase the usability and look of the thing.&nbsp; And they could be code generated.</DIV>
<DIV>&nbsp;</DIV>
<DIV>I have better luck with code generating some of the more basic forms.&nbsp; Much more control and tweakability and not much more work than doing it all at run time.</DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp;</DIV></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
