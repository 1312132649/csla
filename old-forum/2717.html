<html><header><title>Beginner level - creating my Business Object library</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Beginner level - creating my Business Object library</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2717.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>FCazabon posted on Tuesday, April 17, 2007</h2>Hi,<br><br>I am trying to create my first business object library using CSLA.NET.<br><br>I have:<br><ol><li>created a new project and called it Membership.Library.</li><li><span>added in a Reference to CSLA.dll,
      System.Configuration and System.Transactions</span></li><li><span>Added
      a new Windows Class called Database.vb and added code in (based on
      Database.vb)<o:p></o:p></span></li><li><span>Added
      a new Windows Class (Member) and added code in (based on Project.vb)</span></li></ol>When I build the project I get quite a few errors:<br><br>1. Type 'BusinessBase' is not defined. <br><br>This occurs in my definition of the Public Class Member:<br><br>&nbsp;&nbsp;&nbsp; Inherits BusinessBase(Of Member)<br><br>Where is BusinessBase defined?<br><br>2. Likewise I am getting errors that CanReadProperty, CanWriteProperty, PropertyHasChanged have not been declared.<br><br>I'll start off with those, but be warned, I have 54 errors in all :(<br><br>Thanks for any help/insight on what is causing these errors.<br><br>Frank<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>FCazabon replied on Tuesday, April 17, 2007</h2>Interesting...<br>I just tried building the ProjectTracker.Library and got loads of similar errors too!<br><br>Should this be happening?&nbsp; Or have I messed up something?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>FCazabon replied on Tuesday, April 17, 2007</h2>Well, I reinstalled the CSLA stuff from scratch and now the ProjectTracker.Library builds successfully.<br><br>But, my project doesn't :(<br><br>I'm feeling at quite a loss here.&nbsp; Any suggestions on how to approach learning how to use this framework successfully?<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>FCazabon replied on Tuesday, April 17, 2007</h2>If I put an:<br><br>Imports Csla<br><br>at the start of my Member.vb then the problems I was having with the "BusinessBase not defined" is solved.&nbsp; But why do I have to do this when the Sample ProjectTracker Project.vb does not need it?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>awsisme replied on Tuesday, April 17, 2007</h2><P>Did you do a build on the CSLA stuff and generate the binaries? I don't think they are shipped with the framework. Sounds like VB isn't resolving the references properly.</P>
<P>Also, I think I remember having to point the Project Tracker references to a different place when I first installed. It's been a while.</P>
<P>&nbsp;</P>
<P>Andy</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>FCazabon replied on Tuesday, April 17, 2007</h2>Hi Andy,<br><br>I did build the csla project and then set the reference in my project.<br><br>Csla shows up in the object browser and if I type Csla. in the editor intellisense kicks in.<br><br>FWIW, I've got over all my errors! (at least the compile time ones).&nbsp; But I'd still ike to understand why the Imports is necessary in my project and not in the sample.<br><br>So my next step will be to try to build a windows interface to this BO.<br><br>Thanks for your help,<br><br>Frank<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson replied on Tuesday, April 17, 2007</h2><P>&gt;&gt; &nbsp; But I'd still ike to understand why the Imports is necessary in my project and not in the sample. &lt;&lt;<BR><BR>Frank,</P>
<P>This is just a little opportunity for you to learn about setting&nbsp;references in VS.&nbsp; In the sample app, the references to CSLA are set in&nbsp;each &nbsp;PROJECT, so the <STRONG><EM>code files</EM></STRONG> in THOSE projects don't need to use Imports statements.&nbsp; You have evidently NOT set references at the project level, so your code modules require the Imports statements.</P>
<P>Look at the text in the "Setting up the project" section of chapter 8, ppg 408-409.&nbsp; Also note under "PTWin Project Setup" on pg 472 the very good advice offered about references:&nbsp; "...it is best to establish a <FONT size=5><STRONG>file </STRONG></FONT>reference to the framework assembly, but use <FONT size=5><STRONG>project</STRONG></FONT> referecnes between the UI and any business assemblies.&nbsp; This makes debugging easier overall, because it helps prevent accidental changes to the CSLA.NET framework project while enabling fluid changes to both the business objects and UI code." (emphasis is mine, of course)&nbsp; Please note that both of the kinds of references (file and project) he addresses in this text are references that <STRONG><FONT size=4>are set at the project level</FONT></STRONG>.&nbsp; So you won't have to use Imports statements for them for the code files in those projects.&nbsp; I know this is a little confusing so please read it carefully.&nbsp;&nbsp;I'm talking about references set <STRONG><FONT size=4>at </FONT></STRONG>the project level but <STRONG><FONT size=4>to</FONT> </STRONG>either a file or a project depending on the assembly you need.&nbsp; If it was too confusing, let me know and I'll step you through how to set references</P>
<P>One more tip on file references for CSLA in your projects - you probably want to be able to step through the framework code while debugging your own projects (even though you don't have the csla project in your solution).&nbsp; In version 1.x of the framwork you would just get the dll in the obj\debug folder.&nbsp; There appear to be two choices in the 2.x framework:&nbsp; bin\debug and obj\debug.&nbsp; Both have the csla.pdb file that I've heard holds that all-important functionality needed for the stepping through the code.&nbsp; I'm just making the transition to 2.x myself.&nbsp; I'm going with bin\debug for now (because I can see that this is what ProjectTracker.Library uses) and I'll be sure and let you know if that didn't work out as I expected.</P>
<P>One last thing.&nbsp; Your name looks rather familiar.&nbsp; Might you have been a FoxPro programmer back in the bad old ninties?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>FCazabon replied on Wednesday, April 18, 2007</h2>Hi Q,<br><br>yes, I am a VFP developer mainly, but have been digging more and more into .NET over the last year or so.&nbsp; I have a client who wants a VB app done soon, so have been looking into the frameworks available for .NET and CSLA is the first I've looked at.&nbsp; I remember your name as well.&nbsp; Have you moved on from VFP completely?<br><br>I believe I have set a file reference to the csla.dll, here's what I did:<br><br>In My Project | References (of my Membership.library project), I clicked on Add, then the Browse tab, then located the csla.dll in csla20vb\csla\bin\debug.<br><br>Did I do it wrong?<br><br>Thanks for your assistance.<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson replied on Wednesday, April 18, 2007</h2><P>&gt;&gt; I remember your name as well.&nbsp; Have you moved on from VFP completely?&nbsp; &lt;&lt;</P>
<P>Oh yeah.&nbsp; I was only in FoxPro a relatively short time.&nbsp; I most on to VB3 in 1994 and never looked back.&nbsp; In fact, I never even used VFP; my last version was the 2.6 that had a DOS version and a Windows version.<BR><BR>&gt;&gt; In My Project | References (of my Membership.library project), I clicked on Add, then the Browse tab, then located the csla.dll in csla20vb\csla\bin\debug. &lt;&lt;</P>
<P>That's exactly right.</P>
<P>&gt;&gt;Thanks for your assistance. &lt;&lt;</P>
<P>Glad to help!<BR><BR><BR></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>FCazabon replied on Wednesday, April 18, 2007</h2>Hi Q,<br><br>well, if what I did to set the reference was exactly right, why do I need the "Imports" statement?<br><br>:(<br><br>Frank<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, April 18, 2007</h2><P>After you set a reference you can create a Project level Import statement in VS.</P>
<P>If you do this then you do not need one in each file.</P>
<P>If you don't do it, you need one in each file.</P>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>FCazabon replied on Thursday, April 19, 2007</h2>Hi Joe,<br><br>thanks.&nbsp; I have searched the ProjectTracker solution and not found an "Imports Csla" statement anywhere.&nbsp; How do I create the project level Imports statement?<br><br>Frank<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Thursday, April 19, 2007</h2>Go to the project's properties. Open the references tab. You'll see the list of references and then below that a list of imported namespaces. Check the box by Csla and there you go.<br><br>Andr√©s<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>FCazabon replied on Thursday, April 19, 2007</h2>Thanks very much Andres!<br><br>I was never even aware that part of the screen existed. :(<br><br>Frank<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, April 19, 2007</h2><P>See the attached image.</P>
<P>A picture is worth a thousand words.</P>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>FCazabon replied on Thursday, April 19, 2007</h2>Thanks Joe, I got it now.<br><br>Frank<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
