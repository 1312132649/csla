<html><header><title>Possible framework enhancement: Function CanGetProperty(prop As IPropertyInfo) As Boolean etc.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Possible framework enhancement: Function CanGetProperty(prop As IPropertyInfo) As Boolean etc.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7121.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>stefan posted on Wednesday, June 17, 2009</h2>Hi @ all!<br><br>I often run into a situation where I have to check for authorization against multiple properties, e. g.:<br><br><font size="2">Public ReadOnly Property UnitOfQuantity as String<br>&nbsp; Get<br>&nbsp;&nbsp;&nbsp; If CanReadProperty(ItemQuantityProperty.Name) OrElse _&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CanReadProperty(UnitOfQuantityProperty.Name) Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return ReadProperty(Of String)(UnitOfQuantityProperty)<br>&nbsp;&nbsp;&nbsp; Else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return String.Empty<br>&nbsp; &nbsp; End If&nbsp; <br>&nbsp; End Get<br>End Property</font><br><br>I then cannot make use of all the features provided by the framework's GetProperty implementation.<br><br>The problem here is, that this code does not take into account the BypassPropertyChecks-feature.<br>More important yet, in the past many of us have overridden the CanReadProperty/CanWriteProperty <br>implementations, which did not know about BypassPropertyChecks. On the other hand, following the <br>standard pattern with ... return GetProperty(Of String)(UnitOfQuantityProperty), both features are <br>considered (ByPassPropertyChecks AND CanReadProperty).<br><br>I really would like to see functions like <br><b>CanGetProperty(propInfo As IPropertyInfo) As Boolean</b><br>and<br><b>CanSetProperty(propInfo As IPropertyInfo) As Boolean</b><br>that enable us to take full advantage of the BypassPropertyChecks feature.<br>Then we could always call the public properties instead of having to implement special friend/internal <br>methods that bypass authorization!<br><br>Looks like an easy change to me. Only extract the part that already does the checks into these new <br>public functions...<br><br>What do you think, Rocky?<br><br>Stefan<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, June 17, 2009</h2>I'll add this to the wish list. Though another solution is to give you a protected property that tells you whether bypass property checks is turned on/off and allow you to use it as you choose.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
