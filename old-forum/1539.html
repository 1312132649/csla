<html><header><title>Validation rule severity</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Validation rule severity</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1539.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Thursday, October 19, 2006</h2>Hi,<br><br>I'm at a point where I'm finally going to be using warnings instead of errors as rules.<br><br>So, how do I define a warning rule?&nbsp; Is it only within the rule method?&nbsp; That would seem to rule out using StringRequired as a warning rule, correct?&nbsp; Am I missing something else?<br><br>Thanks<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, October 19, 2006</h2><P>When you create your RuleArg instance you can set the Severity to Warning (instead of Error) and then use StringRequired as a warning rule.</P>
<P><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> x </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> RuleArgs = </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> RuleArgs(</FONT><FONT color=#ff00ff size=2>"myProperty"</FONT><FONT size=2>)<BR>x.Severity = Csla2.Validation.RuleSeverity.Warning<BR></FONT><FONT size=2>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> StringRequired, x)</P>
<P></P></FONT>
<P>But this brings up a good point.</P>
<P>Rocky - can you create some overloaded methods for the RUleArgs constructor so we can write 1 line of code instead of the 3 (or more if we need to set other values)&nbsp;above.</P>
<P>e.g.</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> propertyName </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String, <FONT color=#000000>description </FONT><FONT color=#0000ff size=2>As</FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2>String</FONT></FONT><FONT size=2>)<BR>&nbsp; mPropertyName = propertyName<BR>&nbsp; </FONT><FONT size=2>mDescription = description<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT>
<P><FONT size=2><FONT color=#0000ff>Public</FONT> <FONT color=#0000ff>Sub</FONT> <FONT color=#0000ff>New</FONT>(<FONT color=#0000ff>ByVal</FONT> propertyName <FONT color=#0000ff>As</FONT> <FONT color=#0000ff>String, <FONT color=#000000>description </FONT><FONT color=#0000ff>As</FONT><FONT color=#000000> </FONT><FONT color=#0000ff>String, <FONT color=#000000 size=2>severity </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> RuleSeverity</FONT></FONT></FONT>)<BR>&nbsp; mPropertyName = propertyName<BR>&nbsp; mDescription = description<BR>&nbsp; </FONT><FONT size=2><FONT size=2>mSeverity </FONT><FONT color=#0000ff size=2><FONT color=#000000>= severity <BR></FONT></FONT><FONT color=#0000ff>End</FONT> <FONT color=#0000ff>Sub</FONT></FONT></P>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, October 19, 2006</h2>I had overlooked that because i usually use new RuleArgs( "PropertyName" ), didn't think of settng the Serverity there.<br><br>Which brings me to a suggestion..&nbsp; can we have a RuleArgs( string, RuleSeverity ) constructor overload?<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, October 19, 2006</h2><P>LOL.<BR>You posted while I was editing my first response.</P>
<P>We had the same idea at the same time.</P>
<P>I think in the short run I will add overloads to my own RuleArgs class which derives from Rocky's.</P>
<P>Then I can have the right behavior now and tweak my base class later if Rocky adds the overloaded constructors to the framework.</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> MyRuleArgs<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Inherits</FONT><FONT size=2> RuleArgs</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> propertyName </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>Optional</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> description </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#ff00ff size=2>""</FONT><FONT size=2>)<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>MyBase</FONT><FONT size=2>.New(propertyName)<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.Description = description<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> propertyName </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> severity </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> RuleSeverity, </FONT><FONT color=#0000ff size=2>Optional</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> description </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#ff00ff size=2>""</FONT><FONT size=2>)<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>MyBase</FONT><FONT size=2>.New(propertyName)<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.Description = description<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.Severity = severity<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> propertyName </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> severity </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> RuleSeverity, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> stopProcessing </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>Optional</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> description </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#ff00ff size=2>""</FONT><FONT size=2>)<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>MyBase</FONT><FONT size=2>.New(propertyName)<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.Description = description<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.Severity = severity<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.StopProcessing = stopProcessing<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</P></FONT>
<P>Joe</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
