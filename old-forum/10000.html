<html><header><title>MVVM trouble intializing a CollectionViewSource</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>MVVM trouble intializing a CollectionViewSource</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10000.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonM posted on Friday, January 28, 2011</h2><p>I&#39;m working my way through the MVVM video series on a SL4 solution.&nbsp; In my little project I have not yet adopted a navigation framework (like Bxf).&nbsp; Right now I&#39;m just trying to bind a businesslist to a listbox.&nbsp; I&#39;m using the drag and drop of the data sources like in the video.&nbsp; VS created 2 collectionviewsource resources.&nbsp; (ViewModelViewSource and ViewModelModelViewSource)&nbsp; The ViewModelModelViewSource binds to the Model property on ViewModelViewSource.&nbsp; I just can&#39;t figure how to get bind an instance of my ViewModel to ViewModelViewSource.<span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;"></span></span></span></p>
<p>I tried setting the ViewModelViewSource.Source&nbsp;to an instance of my view model but it doesn&#39;t work I get the error:&nbsp;&nbsp; Unsupported type of source for a collection view.</p>
<p>I tried setting the ViewModelViewSource.Source to the model property of my view model.&nbsp; This does not throw an error but my listbox doesn&#39;t populate either.&nbsp; </p>
<p>I&#39;ve missed a step here.&nbsp; Any help would be appreciated.</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>Curelom replied on Friday, January 28, 2011</h2><p>You would normally do this in the Load method of your container object (Control, Page, Window, etc.)</p>
<p>Something similar to this.</p>
<pre style="font-family:consolas;"><span style="color:#2b91af;">CollectionViewSource</span>&nbsp;cvs&nbsp;=<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span style="color:#2b91af;">CollectionViewSource</span>)<span style="color:blue;">this</span>.Resources[<span style="color:#a31515;">&quot;siteInfoListViewSource&quot;</span>];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">SiteInfoList</span>&nbsp;sl&nbsp;=&nbsp;<span style="color:#2b91af;">SiteInfoList</span>.GetSiteInfoListFromCorp01();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cvs.Source&nbsp;=&nbsp;sl;</pre></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Curelom replied on Friday, January 28, 2011</h2><p>One other note...</p>
<p>You would probably want to encapsulate this with the following if statement, so it doesn&#39;t run during design time and give you headaches.</p>
<pre style="font-family:consolas;"><span style="color:blue;">if</span>&nbsp;(!System.ComponentModel.<span style="color:#2b91af;">DesignerProperties</span>.GetIsInDesignMode(<span style="color:blue;">this</span>))&nbsp;{<br /></pre></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonM replied on Friday, January 28, 2011</h2><p>Should it be binding to my ViewModel&lt;T&gt; class?</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
