<html><header><title>WPF DataGrid sorting BusinessListBase</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>WPF DataGrid sorting BusinessListBase</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8199.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Calin posted on Wednesday, December 23, 2009</h2>Hi,<br /><br /> I am little new to CSLA, I've managed to work my way to an nice application using the videos and the book, but I am stuck on a small issue.<br /><br /> I am binding a wpf data grid to a BusinessListBase, al fine, but I can't get sorting to work !<br /><br /> Any idea on how to make sorting work on BusinessListBase ?<br /><br />Thanks,<br />Regards,</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Calin replied on Wednesday, December 23, 2009</h2>My current solution is:<br /><br />public class LoginList : BusinessListBase<br />    {<br />        public static LoginList GetLoginList()<br />        {<br />            LoginList result = DataPortal.Fetch();<br />            return result;<br />        }<br /><br />        public static ObservableCollection GetObservableCollection()<br />        {<br />            ObservableCollection collection = new ObservableCollection(GetLoginList());<br />            return collection;<br />        }<br />}<br /><br />And the DataProvider FactoryMethod uses GetObservableCollection insteed of GetLoginList.<br /><br /> Somehow this does not fill right I am preatty sure there is a better approach to this.<br /><br />Any ideas</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, December 23, 2009</h2><P>This is a known problem with Xaml and Csla.&nbsp; Wpf doesn't support the BindingList (well) and that's the base class of all Csla list objects.&nbsp; This is changing in 4.0 to inherit observablecollection.&nbsp; </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Calin replied on Wednesday, December 23, 2009</h2>Hi,<br /><br /> Thanks for the reply.<br /><br /> Do you know of any possible work around (except the one I have) ?<br /><br />Regards,</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, December 24, 2009</h2><P>You can use Google/Bing to look for answers. The problem is this:</P>
<P>CSLA collections inherit from BindingList&lt;T&gt;, and therefore implement IBindingList.</P>
<P>WPF doesn't work correctly with IBindingList - in fact WPF goes out of its way to block IBindingList from really working.</P>
<P>There are a few solutions people have developed to enable WPF to deal with IBindingList collections - which makes sense because a LOT of collections before .NET 3.0 were IBindingList collections, including things like the DataTable.</P>
<P>In the end though, the workarounds are generally painful, which is why CSLA .NET 4.0 is switching BusinessListBase to inherit from ObservableCollection&lt;T&gt;, and is adding a new BusinessBindingListBase for Windows Forms users.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Calin replied on Friday, December 25, 2009</h2>Thank you for your answer.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Calin replied on Tuesday, January 12, 2010</h2>After more searching I am still not able to implement SortableBusinessListBase.<br /><br />I am even stuck at the basics:<br /><br /> public class SortableBusinessListBase : BusinessListBase<br />        where TList : SortableBusinessListBase<br />        where TBos : BaseBussinesObject<br />{<br />}<br /><br />[Serializable]<br />    public class WeightList : BusinessListBase<br />{<br />}<br /><br />This will throw a Null reference exception.<br /><br />It looks to me that this is a very common scenario. I was hoping to find a sample implementation in the book or at least on your blog.<br /><br />Is there such a sample implementation anywhere ?<br /><br />Thanks, </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, January 12, 2010</h2><P>Normally you'd use SortedBindingList for this, so perhaps your solution would be to take your list, wrap it in a SortableBindingList.. then wrap that in ObservableCollection?</P>
<P>Not sure if it would work, but it's something I'd try (sorting is almost always a UI concern, so your business layer shouldn't usually be worrying about it).</P>
<P>HTH</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, January 12, 2010</h2><P>I'm a little confused - there is no such thing as SortableBusinessListBase in CSLA, so I'm not sure what that is?</P>
<P>The CSLA SortedBindingList is a wrapper over any BindingList&lt;T&gt; that adds sorting features. But WPF doesn't really work well with BindingList&lt;T&gt; collection types.</P>
<P>This has been discussed a few times on the forum - Windows Forms <EM>only</EM> works with BindingList&lt;T&gt; types, and WPF only <EM>sort of works</EM> with them. WPF really wants ObservableCollection&lt;T&gt; types, which absolutely don't work with Windows Forms.</P>
<P>So Microsoft has created a catch-22 situation where frameworks like CSLA can't really provide support for both WPF and Windows Forms at the same time. To date, I've stuck with BindingList&lt;T&gt; because way more people use Windows Forms than WPF.</P>
<P>But in CSLA .NET 4.0 the base types are switching to ObservableCollection&lt;T&gt;, and I'm renaming the existing types (they'll still exist). So you'll have to choose your base class - BusinessBindingListBase for Windows Forms, BusinessListBase for all other UI types.</P>
<P>Then at some point (5.0?) the Windows Forms types will just go away. Eventually Windows Forms will be legacy enough that people still using it will just have to stick with older versions of CSLA .NET.</P>
<P>Right now, today, you'll need to use any one of the hacks that are out there in the world to make WPF talk to a BindingList&lt;T&gt; or IBindingList collection. People have come up with, and blogged, various solutions - none of which are great, but several of which do work.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Calin replied on Tuesday, January 12, 2010</h2>Hi,<br /><br /> SortedBindingList is a class I was planning to implement using information from this blog http://www.wpfmentor.com/2008/12/how-to-sort-bindinglist-using.html, it has nothing to do with the one on the framework.<br /><br /> The think is that when I try to switch the inheritance to SortedBindingList (my class) I get a null pointer reference somewhere in CopyToParent() in BindingListBase.<br /><br /> Where are all the people that use CSLA with WPF, there must be a sample solution out there, but I simply can't find it !<br /><br /> Clsa Contrib has the ProjectTracker implemented with Prism but they don't sort any list there, incredible.<br /><br /> Anyway, thank you for your replies, I still find it weird no sample is around, maybe after I tackel and I have one solution you can consider adding it to the samples folder in downloads.<br /><br />Regards,</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, January 12, 2010</h2>Ya, that was a mistake.&nbsp; I meant SortedBindingList.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Calin replied on Wednesday, January 13, 2010</h2>Ok,<br /><br /> I am trying to extend BusinessListBase. <br /><br />public class ExtendedBusinessListBase : BusinessListBase<br />        where TList : BusinessListBase<br />        where TBos : BusinessBase<br />    {<br />        <br />    }<br /><br />When using the extend class I get a <br /><br />Object reference not set to an instance of an object.<br /><br />on line 259 in CopyState(int parentEditLevel)<br /><br />Any ideea why is this happening ?<br /><br />Regards,</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>chrduf replied on Wednesday, January 13, 2010</h2>Hi<br /><br />This is what I use to extend this class<br /><br />    [System.Diagnostics.CodeAnalysis.SuppressMessage("Microsoft.Naming",<br />"CA1710:IdentifiersShouldHaveCorrectSuffix")]<br />    [Serializable()]<br />#if !(SILVERLIGHT)<br />    public abstract class CPBusinessListBase :<br />Csla.BusinessListBase<br />        where T : CPBusinessListBase<br />        where C : Csla.Core.IEditableBusinessObject<br />#else<br />    public abstract class CPBusinessListBase :<br />Csla.BusinessListBase<br />        where T : CPBusinessListBase<br />        where C : Csla.Core.IEditableBusinessObject<br />#endif<br /><br />Yes I know the two declarations are the same but for Windows apps I actually<br />have a couple of interfaces defined that are not represented in Silverlight.<br /><br /><br /><br />-----Original Message-----<br />From: Calin [mailto:cslanet@lhotka.net] <br />Sent: Wednesday, January 13, 2010 8:08 AM<br />To: chris.dufour@wigets.net<br />Subject: Re: [CSLA .NET] WPF DataGrid sorting BusinessListBase<br /><br />Ok,<br /><br /> I am trying to extend BusinessListBase. <br /><br />public class ExtendedBusinessListBase : BusinessListBase<br />        where TList : BusinessListBase<br />        where TBos : BusinessBase<br />    {<br />        <br />    }<br /><br />When using the extend class I get a <br /><br />Object reference not set to an instance of an object.<br /><br />on line 259 in CopyState(int parentEditLevel)<br /><br />Any ideea why is this happening ?<br /><br />Regards,<br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Calin replied on Wednesday, January 13, 2010</h2>Ok, I will try this. <br /><br />Thanks</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>richardb replied on Wednesday, January 13, 2010</h2><P>While this probably does not help you now, some of the third party grid controls seem to offer a solution.&nbsp; </P>
<P>I'm using the Infragistics WPF grid and am binding to an object that inherits from BusinessListBase and it sorts ascending and descending as I click on the column headings.&nbsp; I've not had to do anything special here.&nbsp; </P>
<P>If that's what you are trying to achieve here and I've understood correctly, might be an option to consider.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
