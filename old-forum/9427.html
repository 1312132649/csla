<html><header><title>Business Rules Chaining</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Business Rules Chaining</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9427.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Turntwo posted on Thursday, August 26, 2010</h2><p>I&#39;m trying to chain business rules under the new 4.0 model, and I&#39;ve run into a problem - I can workaround it, but I want some feedback on the &quot;correct&quot; method to use.&nbsp; </p>
<p>In the example in the blog entry on Rule Chaining we have the following;</p>
<p> if (obj != null &amp;&amp; obj.IsNew) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _innerRule.Execute(context.GetChainedContext(required)); </p>
<p>However, when I attempt to chain a rule this way, the Execute method is not available on _innerRule, because it is protected (I inherited from BusinessRule, and overrode the protected method).&nbsp; </p>
<p>For my own Rules I can change the protected to public using new instead of override, but what if I want to chain Csla CommonRules?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, August 26, 2010</h2><p>Hi, </p>
<p>See my sample code here - your inner rule should be declared as IBusinessRule and that will allow you to call the execute method. </p>
<p>

</p>
<pre style="font-family:consolas;">&nbsp;&nbsp;<span style="color:#cc7832;">public</span>&nbsp;<span style="color:#cc7832;">class</span>&nbsp;<span style="color:#ffc66d;">NewGateRule</span>&nbsp;:&nbsp;<span style="color:#ffc66d;">BusinessRule</span><br />&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#cc7832;">private</span>&nbsp;<span style="color:#2b91af;">IBusinessRule</span>&nbsp;_innerRule;<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#cc7832;">public</span>&nbsp;NewGateRule(Csla.Core.<span style="color:#2b91af;">IPropertyInfo</span>&nbsp;primaryProperty)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;<span style="color:#cc7832;">base</span>(primaryProperty)<br /><pre style="font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:gray;">//&nbsp;create&nbsp;instance&nbsp;of&nbsp;the&nbsp;chained&nbsp;rule&nbsp;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_innerRule&nbsp;=&nbsp;(<span style="color:#2b91af;">IBusinessRule</span>)<span style="color:#cc7832;">new</span>&nbsp;Csla.Rules.CommonRules.<span style="color:#ffc66d;">Required</span>(PrimaryProperty);<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:gray;">//&nbsp;must&nbsp;add&nbsp;input&nbsp;properties from&nbsp;the&nbsp;inner&nbsp;rule&nbsp;&nbsp;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InputProperties&nbsp;=&nbsp;<span style="color:#cc7832;">new</span>&nbsp;<span style="color:#ffc66d;">List</span>&lt;Csla.Core.<span style="color:#2b91af;">IPropertyInfo</span>&gt;();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InputProperties.AddRange(_innerRule.InputProperties);<br />&nbsp;&nbsp;&nbsp;&nbsp;}</pre>
<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#cc7832;">protected</span>&nbsp;<span style="color:#cc7832;">override</span>&nbsp;<span style="color:#cc7832;">void</span>&nbsp;Execute(<span style="color:#ffc66d;">RuleContext</span>&nbsp;context)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#cc7832;">var</span>&nbsp;obj&nbsp;=&nbsp;context.Target&nbsp;<span style="color:#cc7832;">as</span>&nbsp;Csla.Core.<span style="color:#2b91af;">ITrackStatus</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#cc7832;">if</span>&nbsp;(obj&nbsp;!=&nbsp;<span style="color:#cc7832;">null</span>&nbsp;&amp;&amp;&nbsp;obj.IsNew)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_innerRule.Execute(context.GetChainedContext(_innerRule));<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;}<br /><br /></pre>
<p>

</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Turntwo replied on Thursday, August 26, 2010</h2><p>Thanks, I missed that _innerRule was IBusinessRule - which allows calling the Execute.&nbsp; I knew I was doing something wrong.&nbsp; </p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
