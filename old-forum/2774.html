<html><header><title>Validation not running</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Validation not running</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2774.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>FCazabon posted on Wednesday, April 25, 2007</h2>Hi,<br><br>I'm creating my first Windows UI (first time using Visual Studio and CSLA).<br><br>I'm using VB and am trying to create a simple interface to a Member BO and table.<br><br>My Member BO has this code:<br><br>&nbsp;&nbsp;&nbsp; Public Property Mem_FirstName() As String<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;System.Runtime.CompilerServices.MethodImpl(Runtime.CompilerServices.MethodImplOptions.NoInlining)&gt; _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CanReadProperty(True)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return mMem_FirstName<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;System.Runtime.CompilerServices.MethodImpl(Runtime.CompilerServices.MethodImplOptions.NoInlining)&gt; _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal Value As String)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CanWriteProperty(True)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If mMem_FirstName &lt;&gt; Value Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mMem_FirstName = Value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>and also:<br><br>&nbsp;&nbsp;&nbsp; Protected Overrides Sub AddBusinessRules()<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ValidationRules.AddRule( _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddressOf Validation.CommonRules.StringRequired, "mem_FirstName")<br><br>&nbsp;&nbsp;&nbsp; End Sub<br><br>When I edit a first name, deleting all the text, then tabbing to the next control, I do not get the icon indicating a rule has been broken.<br><br>I set a breakpoint on the call to PropertyHasChanged(), but I do not get the option to "Step into" this code, only "Step over".<br><br>Any ideas what I have done wrong and how to step into the PropertyHasChanged subroutine?<br><br>Thanks,<br><br>Frank<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Wednesday, April 25, 2007</h2><P>One thing that jumps out at me is that your rule doesn't have the same casing (mem_FirstName vs Mem_FirstName). I'm not sure if it matters to be honest with you but I'd guess that it does. </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>FCazabon replied on Wednesday, April 25, 2007</h2>Thanks!<br><br>that was it.&nbsp; I didn't think VB had to be case sensitive, but I guess this might actualy be CSLA, not VB.<br><br>Now, if only I could work out how to set focus to the first textbox on a form&nbsp; automatically when the form is initially displayed... :)<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Wednesday, April 25, 2007</h2>Adjust the "TabIndex" property of each of your controls to be in the order you want.<br><br>Andrés<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>FCazabon replied on Wednesday, April 25, 2007</h2>Hi Andres,<br><br>I have tried that and it doesn't work.&nbsp; You can see the same thing in the Project Tracker sample.&nbsp; If you edit the ProjectEdit.vb and set the tab order of the Nametextbox, then run the sample, add a new project and you will see that the focus seems to be somewhere magical as typing any text does nothing.&nbsp; Press Tab and the focus then goes to the NameTextbox, shift and Tab and ot goes to the Close button.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Wednesday, April 25, 2007</h2>TabIndex starts at zero, make sure your first control has that value assigned. Also, you can set 2 controls to the same value, so watch that no other control ahs that same value!!<br><br>Andrés<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>FCazabon replied on Wednesday, April 25, 2007</h2>I had it set to zero (and it was the only one set to zero) and that still wouldn't work.<br><br>I looked at the code in the LoginForm and saw that it specifically set the focus to the UserNameTextbox so I did likewise in my MemberEdit.vb:<br><br>&nbsp; Private Sub MemberEdit_Load( _<br>&nbsp;&nbsp;&nbsp; ByVal sender As System.Object, ByVal e As System.EventArgs) _<br>&nbsp;&nbsp;&nbsp; Handles MyBase.Load<br><br>&nbsp;&nbsp;&nbsp; Me.Mem_FirstNamenameTextBox.Focus()<br><br>&nbsp; End Sub<br><br><br>That seems to do the trick.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Wednesday, April 25, 2007</h2><P>Yeah, there's nothing "Csla" related&nbsp;about thie string comparison issue you bumped into. Generally two strings are equal when taking into account case sensitivity. (Though the property checks I suppose <EM>could</EM> be done without case sensitivity)</P>
<P>Glad I could help. </P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
