<html><header><title>CSLA 3.5 Code-reduction and Interdependent Properties</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA 3.5 Code-reduction and Interdependent Properties</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4763.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Frazer posted on Monday, April 28, 2008</h2>In Chapter 8 of Expert vb2005 Business Objects, Rocky introduces the notion of interdependent properties with the Started and Ended SmartDate properties.<br /><br />In the book's version of the code, he calls ValidationRules.CheckRules on the interdependent property BEFORE calling PropertyHasChanged on the current property (thereby validating the interdependent property first, and then the current property).<br /><br />Having read Rocky's Fe blog post of code reduction in 3.5 - I am unsure how interdependency is implemented when using this coding construct.  <br /><br />Given this as a starting point:<br /><br />    Private Shared StartedProperty As PropertyInfo(Of SmartDate) = RegisterProperty(Of SmartDate)(GetType(Project), New PropertyInfo(Of SmartDate)("Started", New SmartDate(True)))<br />    Private pvStarted As SmartDate = StartedProperty.DefaultValue<br />    Public Property Started() As SmartDate<br />        Get<br />            Return GetProperty(Of SmartDate)(StartedProperty, pvStarted)<br />        End Get<br />        Set(ByVal value As SmartDate)<br />            SetProperty(Of SmartDate)(StartedProperty, pvStarted, value)<br />        End Set<br />    End Property<br /><br />The question is:  where to insert the ValidationRules.CheckRules("Ended") call to ensure the Ended property is validated before the Started property?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, April 29, 2008</h2><P>That technique was obsoleted in version 2.1.</P>
<P>You should add a dependent property in AddBusinessRules() to handle this case - check the <EM>CSLA .NET Version 2.1 Handbook </EM>for details - though be aware that version 3.5 renamed the method to correct confusing spelling.</P>
<P>Also you can look at the current ProjectTracker code (the Project class) to see how this works.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
