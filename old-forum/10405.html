<html><header><title>Name cannot begin with the '&lt;' character, hexadecimal value 0x3C</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Name cannot begin with the '&lt;' character, hexadecimal value 0x3C</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10405.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>tbaldridge posted on Wednesday, June 01, 2011</h2><p>In general, we try to write software that doesn&#39;t throw a lot of exceptions. We recently noticed a very odd set of exceptions in our CSLA.NET based app. We&#39;re making requests from Silverlight. In our server-side code we recently started getting a ton of exceptions:</p>
<p>XmlException:</p>
<p>Name cannot begin with the &#39;&lt;&#39; character, hexadecimal value 0x3C.</p>
<p>&nbsp;</p>
<p>This is being thrown from within WcfProxy.Fetch:</p>
<p>&nbsp;</p>
<p>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>ChannelFactory</span>&lt;<span>IWcfPortal</span>&gt;&nbsp;cf&nbsp;=&nbsp;GetChannelFactory();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>IWcfPortal</span>&nbsp;svr&nbsp;=&nbsp;GetProxy(cf);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>WcfResponse</span>&nbsp;response&nbsp;=&nbsp;<span>null</span>;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>try</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
        // Error is thrown here....</pre>
<pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;svr.Fetch(<span>new</span>&nbsp;<span>FetchRequest</span>(objectType,&nbsp;criteria,&nbsp;context));</pre>
<pre></pre>
<pre></pre>
<p><span>
<pre>Execution continues on just fine, and we haven&#39;t seen any side effects of this error, but we&#39;d rather not&nbsp;</pre>
<pre>get it. Any thoughts on how to remove this exception?  We get around two dozen of these each time our&nbsp;</pre>
<pre>application starts-up.
</pre>
<div></div>
</span></p>
</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, June 01, 2011</h2><p>I haven&#39;t seen that exception. Do you have the full stack trace? With any luck that&#39;ll reveal some more useful information.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tbaldridge replied on Wednesday, June 01, 2011</h2><p>In the actual exception, the stack trace only contains: </p>
<p>&nbsp;&nbsp; at System.Xml.XmlConvert.VerifyNCName(String name, ExceptionType exceptionType)</p>
<p>And there is no inner exception. </p>
<p>&nbsp;</p>
<p>However, the full Call stack from the debugger looks like this: </p>
<p>&gt;&nbsp;Csla.dll!Csla.DataPortalClient.WcfProxy.Fetch(System.Type objectType, object criteria, Csla.Server.DataPortalContext context) Line 148 + 0x2b bytes&nbsp;C#<br />&nbsp;&nbsp;Csla.dll!Csla.DataPortal.Fetch(System.Type objectType, object criteria) Line 215 + 0x12 bytes&nbsp;C#<br />&nbsp;&nbsp;Csla.dll!Csla.Server.Hosts.Silverlight.SilverlightRequestProcessor.Fetch(Csla.Server.Hosts.Silverlight.SilverlightCriteriaRequest request) Line 146 + 0xc bytes&nbsp;C#<br />&nbsp;&nbsp;Csla.dll!Csla.Server.Hosts.Silverlight.WcfPortal.Fetch(Csla.Server.Hosts.Silverlight.CriteriaRequest request) Line 102 + 0xe bytes&nbsp;C#<br />&nbsp;&nbsp;[Lightweight Function]&nbsp;<br />&nbsp;&nbsp;System.ServiceModel.dll!System.ServiceModel.Dispatcher.SyncMethodInvoker.Invoke(object instance, object[] inputs, out object[] outputs) + 0x2f5 bytes&nbsp;<br />&nbsp;&nbsp;System.ServiceModel.dll!System.ServiceModel.Dispatcher.DispatchOperationRuntime.InvokeBegin(ref System.ServiceModel.Dispatcher.MessageRpc rpc) + 0x137 bytes&nbsp;<br />&nbsp;&nbsp;System.ServiceModel.dll!System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage5(ref System.ServiceModel.Dispatcher.MessageRpc rpc) + 0x5e bytes&nbsp;<br />&nbsp;&nbsp;System.ServiceModel.dll!System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage41(ref System.ServiceModel.Dispatcher.MessageRpc rpc) + 0x6c bytes&nbsp;<br />&nbsp;&nbsp;System.ServiceModel.dll!System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage4(ref System.ServiceModel.Dispatcher.MessageRpc rpc) + 0x89 bytes&nbsp;<br />&nbsp;&nbsp;System.ServiceModel.dll!System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage31(ref System.ServiceModel.Dispatcher.MessageRpc rpc) + 0x59 bytes&nbsp;<br />&nbsp;&nbsp;System.ServiceModel.dll!System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage3(ref System.ServiceModel.Dispatcher.MessageRpc rpc) + 0x3b bytes&nbsp;<br />&nbsp;&nbsp;System.ServiceModel.dll!System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage2(ref System.ServiceModel.Dispatcher.MessageRpc rpc) + 0x4e bytes&nbsp;<br />&nbsp;&nbsp;System.ServiceModel.dll!System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage11(ref System.ServiceModel.Dispatcher.MessageRpc rpc) + 0x125 bytes&nbsp;<br />&nbsp;&nbsp;System.ServiceModel.dll!System.ServiceModel.Dispatcher.ImmutableDispatchRuntime.ProcessMessage1(ref System.ServiceModel.Dispatcher.MessageRpc rpc) + 0x34 bytes&nbsp;<br />&nbsp;&nbsp;System.ServiceModel.dll!System.ServiceModel.Dispatcher.MessageRpc.Process(bool isOperationContextSet) + 0xff bytes&nbsp;<br />&nbsp;&nbsp;System.ServiceModel.dll!System.ServiceModel.Dispatcher.ChannelHandler.DispatchAndReleasePump(System.ServiceModel.Channels.RequestContext request, bool cleanThread, System.ServiceModel.OperationContext currentOperationContext) + 0x44b bytes&nbsp;<br />&nbsp;&nbsp;System.ServiceModel.dll!System.ServiceModel.Dispatcher.ChannelHandler.HandleRequest(System.ServiceModel.Channels.RequestContext request, System.ServiceModel.OperationContext currentOperationContext) + 0x127 bytes&nbsp;<br />&nbsp;&nbsp;System.ServiceModel.dll!System.ServiceModel.Dispatcher.ChannelHandler.AsyncMessagePump(System.IAsyncResult result) + 0x43 bytes&nbsp;<br />&nbsp;&nbsp;System.ServiceModel.dll!System.ServiceModel.Dispatcher.ChannelHandler.OnContinueAsyncReceive(object state) + 0x45 bytes&nbsp;<br />&nbsp;&nbsp;System.Runtime.DurableInstancing.dll!System.Runtime.IOThreadScheduler.ScheduledOverlapped.IOCallback(uint errorCode, uint numBytes, System.Threading.NativeOverlapped* nativeOverlapped) + 0x78 bytes&nbsp;<br />&nbsp;&nbsp;System.Runtime.DurableInstancing.dll!System.Runtime.Fx.IOCompletionThunk.UnhandledExceptionFrame(uint error, uint bytesRead, System.Threading.NativeOverlapped* nativeOverlapped) + 0x39 bytes&nbsp;<br />&nbsp;&nbsp;mscorlib.dll!System.Threading._IOCompletionCallback.PerformIOCompletionCallback(uint errorCode, uint numBytes, System.Threading.NativeOverlapped* pOVERLAP) + 0x74 bytes&nbsp;<br />&nbsp;&nbsp;[Native to Managed Transition]&nbsp;<br />&nbsp;&nbsp;[Appdomain Transition]&nbsp;<br />&nbsp;&nbsp;[Native to Managed Transition]&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, June 01, 2011</h2><p>Not super helpful :)</p>
<p>But it does indicate that the origination of the exception if from WCF (System.ServiceModel) during the completion callback (if I read it correctly).</p>
<p>So it is quite possible that something is wrong with the byte stream coming back from the server.</p>
<p>Are you using compression? Have you maxed the various size limits for WCF on client and server? These are important, and are discussed in the FAQ (<a href="http://www.lhotka.net/cslanet/faq/DataPortalFaq.ashx">http://www.lhotka.net/cslanet/faq/DataPortalFaq.ashx</a>) and in the <em>Using CSLA 4: Data Portal Configuration</em> ebook.</p>
<p>If you&#39;ve done those things, the next step is probably to put fiddler on the wire so you can see what is going over the network.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonStonecash replied on Thursday, June 02, 2011</h2><p>I ran into something very similar when I was sending business objects across the wire thru the remote data portal.&nbsp; These objects had several automatic properties.&nbsp; For various reasons, these properties were not in the standard &quot;registered CSLA properties format.&nbsp; The problem was that the names generated by the C# compiler for the internal field that supports each of the properties has a name that contains the &quot;&lt;&quot; character that confuses serialization.&nbsp; I agree that exceptions should be addressed, if possible.&nbsp; I got around these exceptions by switching back to the &quot;old style&quot; properties with an explicit internal field.&nbsp; Not fun, but I did feel more righteous. </p>
<p>&nbsp;</p>
<p>Jon Stonecash</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>StefanCop replied on Monday, October 17, 2011</h2><p>I also recognized this &quot;first chance exception&quot; and narrowed the reason down to some auto property in our classes and ObservableBindingList AllowEdit, AllowNew and AllowRemove. Although this exception is caught be the .NET Framework itself, there are messages in VisualStudio&#39;s Output. </p>
<p>I also was unsure why an XML problem, because we use TCP binding. I analyzed the stack a bit in the debugger, and although im not a WCF expert, I got to the conculsion that some validation is made on XML base before or after the actual encoding (that I guessed from method names on the stack indicating something like &quot;validate&quot;). </p>
<p>So, me too,  back to the &quot;old style&quot; properties with an explicit internal field. That reduces the chatty messages a lot.&nbsp;</p>
<p>Stefan</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>StefanCop replied on Monday, October 17, 2011</h2><p>See this post: <a href="http://forums.lhotka.net/forums/p/10511/50274.aspx#50274">http://forums.lhotka.net/forums/p/10511/50274.aspx#50274</a></p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
