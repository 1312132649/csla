<html><header><title>Reflection of object types when passing into function</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Reflection of object types when passing into function</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5328.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rbellow posted on Friday, August 29, 2008</h2><FONT color=#0000ff size=2>
<P><FONT face="Courier New" color=#000000>I am trying to create a generaized function to manipulate a list object. Below is a simple use of relection that takes the LeadList list object and returns puts in the values into a DataTable. But I get stuck. I want to be able to pass my function&nbsp;any list object without having to declare the specific object type in the function call. Then determine the object type and continue. The 2 areas that I need help on the reflection with are highlighted in <STRONG><FONT color=#ff0000>red and bolded</FONT></STRONG> below.&nbsp;</FONT></P>
<P><FONT face="Courier New" color=#000000>Any help is appreciated.</FONT></P>
<P><FONT face="Courier New"></FONT>&nbsp;</P>
<P><FONT face="Courier New">Function</FONT></FONT><FONT face="Courier New"><FONT size=2> ListToTable(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> List </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> <STRONG><FONT color=#ff0000>CRMBO.LeadList</FONT></STRONG>) </FONT><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2><FONT face="Courier New"> DataTable</FONT></P>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> tbl </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT></FONT><FONT size=2><FONT face="Courier New"> DataTable</FONT></FONT></P>
<P><FONT face="Courier New"><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> col </FONT><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2><FONT face="Courier New"> DataColumn</FONT></P>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> type </FONT><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2><FONT face="Courier New"> Type = List(0).GetType()</FONT></P>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> properties() </FONT><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2><FONT face="Courier New"> System.Reflection.PropertyInfo = type.GetProperties()</FONT></P>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>For</FONT><FONT size=2> i </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2> = 0 </FONT><FONT color=#0000ff size=2>To</FONT></FONT><FONT size=2><FONT face="Courier New"> properties.GetUpperBound(0)</FONT></P>
<P><FONT face="Courier New">col = </FONT></FONT><FONT face="Courier New" color=#0000ff size=2>New</FONT><FONT size=2><FONT face="Courier New"> DataColumn</FONT></P>
<P><FONT face="Courier New">col.ColumnName = properties(i).Name.ToString()</FONT></P>
<P><FONT face="Courier New">tbl.Columns.Add(col)</FONT></P>
<P></FONT><FONT face="Courier New" color=#0000ff size=2>Next</FONT><FONT size=2><FONT face="Courier New"> i</FONT></P>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> row </FONT><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2><FONT face="Courier New"> DataRow</FONT></P>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>For</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Each</FONT><FONT size=2> info </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> <STRONG><FONT color=#ff0000>CRMBO.LeadInfo</FONT></STRONG> </FONT><FONT color=#0000ff size=2>In</FONT></FONT><FONT size=2><FONT face="Courier New"> List</FONT></P>
<P><FONT face="Courier New">row = tbl.NewRow()</FONT></P>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>For</FONT><FONT size=2> i </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2> = 0 </FONT><FONT color=#0000ff size=2>To</FONT></FONT><FONT size=2><FONT face="Courier New"> properties.GetUpperBound(0)</FONT></P>
<P><FONT face="Courier New">row(i) = info.GetType.GetProperty(properties(i).Name).GetValue(info, </FONT></FONT><FONT face="Courier New" color=#0000ff size=2>Nothing</FONT><FONT size=2><FONT face="Courier New">).ToString()</FONT></P>
<P></FONT><FONT face="Courier New" color=#0000ff size=2>Next</FONT><FONT size=2><FONT face="Courier New"> i</FONT></P>
<P><FONT face="Courier New">tbl.Rows.Add(row)</FONT></P>
<P></FONT><FONT face="Courier New" color=#0000ff size=2>Next</FONT><FONT size=2><FONT face="Courier New"> info</FONT></P>
<P></FONT><FONT face="Courier New" color=#0000ff size=2>Return</FONT><FONT size=2><FONT face="Courier New"> tbl</FONT></P>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, August 29, 2008</h2>The class which contains your method should be a Generic class, with two genertic type parameters.&nbsp; One for the list type, one for the type that is contained in the list.. just like BusinessListBase&lt;T, C&gt;<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
