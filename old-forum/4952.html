<html><header><title>CslaDataSource with ASP.NET Step Wizard</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CslaDataSource with ASP.NET Step Wizard</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4952.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius posted on Monday, June 09, 2008</h2><P><FONT color=#000000>I'm new to CSLA and am really struggling with this. I'm wanting to derive a nice way of using an ASP.NET step wizard alongside the CslaDataSource. I've searched hard through the forums, but no one else must be having such a hard time like me ;P</FONT></P>
<P>No matter what I&nbsp;keep running into a wall trying to do this and I always end up throwing a bunch of&nbsp;convoluted code in to get it to&nbsp;do what it needs to. </P>
<P>I keep wanting to be able to call the UpdateObject event when the user clicks the Next button on the wizard, but I can't figure out how&nbsp;I can pass it the UpdateEventArgs object easily...&nbsp; Any help or suggestion is greatly appreciated.&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, June 09, 2008</h2><P>I haven't tried this, so I don't know the answer.</P>
<P>However, the CslaDataSource works exactly like any other data source control. So whatever technique would be used to trigger the event on, for example, ObjectDataSource will work on CslaDataSource.</P>
<P>In any normal scenario <EM>you don't raise the event</EM>. Instead, you interact with a visual control (like the GridView or DetailsView) and <EM>that control </EM>raises the event through the data binding infrastructure.</P>
<P>I don't know that you <EM>can</EM> raise the event directly. I've never seen anyone do it, and I don't think it is a supported concept when programming against any data source control.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius replied on Tuesday, June 10, 2008</h2><P>Thanks for the quick response, Lhotka. </P>
<P>Yes, what I've tried so far is to place separate DetailsView in each step that is connected to the same CslaDataSource. Then I bound the&nbsp;fields related to each step to the&nbsp;appropriate DetailsView. </P>
<P>Ideally I wanted to invoke the UpdateObject event when the user clicks the 'next' button, but am realizing how difficult this might be. Then I figured I could just hide that button and place navigation logic in the "update" button for the details view (essentially turning it into the 'next' button for the wizard). This concept seems sloppy to me, as it nearly defeats the point of using a StepWizard.</P>
<P>Is it at all possible to build an UpdateObjectArgs object from another control and somehow use it to invoke the UpdateObject event? </P>
<P>Maybe using a multiview to streamline a Wizard-Step process might be the way to go... Is this the typical convention that most people use?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>griff replied on Tuesday, June 10, 2008</h2><P>Hi</P>
<P>I do this, without any issues e.g.</P><FONT color=#0000ff size=2>
<P>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> Wizard1_NextButtonClick(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.Web.UI.WebControls.WizardNavigationEventArgs) </FONT><FONT color=#0000ff size=2>Handles</FONT><FONT size=2> Wizard1.NextButtonClick</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Select</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Case</FONT><FONT size=2> e.CurrentStepIndex</P>
<P></FONT><FONT color=#0000ff size=2>Case</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Is</FONT><FONT size=2> = 0</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Case</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Is</FONT><FONT size=2> = 1</P></FONT><FONT size=2>
<P>fv1.UpdateItem(</FONT><FONT color=#0000ff size=2>False</FONT><FONT size=2>)</FONT></P><FONT size=2>
<P><FONT color=#0000ff size=2>Case</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Is</FONT><FONT size=2> = 2</P></FONT><FONT size=2>
<P>fv2.UpdateItem(</FONT><FONT color=#0000ff size=2>False</FONT><FONT size=2>)</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Case</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Else</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Select</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT></P>
<P><FONT color=#0000ff size=2>fv1 is a formsview</FONT></P>
<P><FONT color=#0000ff size=2>The event&nbsp; <FONT color=#000000>fv1.UpdateItem(</FONT><FONT color=#0000ff size=2>False</FONT><FONT color=#000000 size=2>) </FONT>calls the <FONT color=#000000>cslads_Q1 update event (the csla data source object)</FONT></FONT></P><FONT color=#0000ff size=2>
<P>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> cslads_Q1_UpdateObject(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Csla.Web.UpdateObjectArgs) </FONT><FONT color=#0000ff size=2>Handles</FONT><FONT size=2> cslads_Q1.UpdateObject</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> obj </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Q1 = GetQ1()</P>
<P>Csla.Data.DataMapper.Map(e.Values, obj, </FONT><FONT color=#0000ff size=2>True</FONT><FONT size=2>)</P>
<P>e.RowsAffected = Save(obj)</P>
<P></P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT></P>
<P><FONT color=#0000ff size=2></FONT>&nbsp;</P>
<P><FONT color=#0000ff size=2>Not sure if this helps.</FONT></P>
<P><FONT color=#0000ff size=2>Richard</FONT></P>
<P><FONT color=#0000ff size=2>&nbsp;</P></FONT>
<P><FONT color=#0000ff size=2>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius replied on Tuesday, June 10, 2008</h2>fabulous! That was just what I was looking for. Thanks a million.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>thiru_forever replied on Thursday, January 22, 2009</h2>Thanks a lot.. It helped me at right time...<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>vbbeta replied on Thursday, April 19, 2012</h2><p>Hi&nbsp;guys&nbsp;i had the same problem but it did not work in total here is my problem the dataSource &nbsp;triggers the save method but it does not change the object status (isNew- IsDirty) etc unless i&#39;m calling the save strait from the asp form</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
