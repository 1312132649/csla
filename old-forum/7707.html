<html><header><title>formview and allowwrite problem</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>formview and allowwrite problem</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7707.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>robertoenbarcelona posted on Wednesday, September 30, 2009</h2>Hi,<br>i have just a simple question about allowwrite in a formview.<br>i have a BO, Customer, a person with Admin role can edit all fields, a person with Reader role only cannot edit sensible data, cannot for example edit Rank field.<br>i put the allowwrite and allowred rules for them accord to the examples.<br>then i put a formview in an Asp.Net page.. <br>i disable the fields that cannot be edit if a Reader is loged-on.. so they cannot edit, when databind appens the page raise an authorization exception making the e.mapvalue!<br>this sound confusing to me, first of all&nbsp; the field is not changed, so there is no reason to set the same value for this rank field, second this cause the authorization exception when the user didn't try to write this value!<br>where is the error? how is the best pratics for this situations in Asp.Net?<br>thanks&nbsp; <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ozhug replied on Thursday, October 08, 2009</h2>Not sure about best practice;<br /><br />I place controls for both cases on the form and then use the FormView_prerender and the AuthorizationRules to set up which controls on the form are visible to the current user.<br /><br />protected void MyFormView_PreRender(object sender, EventArgs e)<br />{<br />	    //two texboxes on the form one for users allowed to edit and one for others.			<br />            TextBox tb = (TextBox)fv.FindControl("TextBoxNoEdit");<br />            TextBox tbAllowEdit = (TextBox)fv.FindControl("TextBoxAllowEdit");<br />            if (Csla.Security.AuthorizationRules.CanEditObject(typeof(myBO)))<br />            {<br />                     tbAllowEdit.Visible = true;<br />                     tbNoEdit.Visible = false;<br />            }<br /><br />}<br /><br />on the page the TextBoxAllowEdit has visible set to false.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
