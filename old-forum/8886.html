<html><header><title>Exception in Demo007 from the Silverlight Samples</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Exception in Demo007 from the Silverlight Samples</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8886.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Smith866 posted on Wednesday, May 05, 2010</h2><p>Hi,</p>
<p>I am getting an exception while using Demo007 from the Silverlight Samples.&nbsp; I receive the exception when I click on the Delete button in the DataGrid on the &quot;Edit Categories&quot; page.&nbsp; The exception I get is the following:</p>
<p>System.NotSupportedException was unhandled by user code<br />&nbsp; Message=&quot;Method to be executed must have 0 or 2 parameters&quot;<br />&nbsp; StackTrace:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.Silverlight.InvokeMethod.CallMethod(Object sender, EventArgs e)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.Primitives.ButtonBase.OnClick()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.Button.OnClick()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.Primitives.ButtonBase.OnMouseLeftButtonUp(MouseButtonEventArgs e)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Controls.Control.OnMouseLeftButtonUp(Control ctrl, EventArgs e)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at MS.Internal.JoltHelper.FireEvent(IntPtr unmanagedObj, IntPtr unmanagedObjArgs, Int32 argsTypeIndex, String eventName)<br />&nbsp; InnerException:</p>
<p>When I debug this, it looks like the CallMethod function is trying to call the RemoveItem on the CslaDataProvider.&nbsp; The RemoveItem function has 1 parameter, which causes the Exception to occur.</p>
<p>Some of the other pages (like Add Order)&nbsp;in this demo do work.&nbsp; The difference, however is that they don&#39;t use the InvokeMethod way of deleting the items.&nbsp; They do the delete in the code-behind instead.</p>
<p>I have tried using CSLA 3.8.1, 3.8.2, and 3.8.3 (beta 3) with the same results.</p>
<p>Does anybody else have this same issue?&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Thursday, May 06, 2010</h2><p>Those demos were originally created using 3.6 and were later updated for SL3 and 3.7. They have not been updated for 3.8.</p>
<p>InvokeMethod has changed over time, and 3.8 is different from 3.7 - to bring it in line with the new Execute trigger action - so it requires 0 or 2 parameters on the target method. The 2 parameter model is:</p>
<p style="padding-left:30px;">public void TargetMethod(object sender, ExecuteEventArgs e)</p>
<p>You should know that the Execute trigger action is gone in CSLA 4 - because it turns out that the Blend SDK includes the same functionality already. And in 3.8.3 and higher I&#39;ll be recommending people move away from InvokeMethod to the new TriggerAction (which is in CSLA 4, and I just back-ported to 3.8.3) control because it is more powerful and works with the VS10 designer tools.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
