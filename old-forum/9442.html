<html><header><title>&quot;Add New Data Source&quot; - where's my ViewModel?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>&quot;Add New Data Source&quot; - where's my ViewModel?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9442.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 posted on Friday, August 27, 2010</h2><p>Using 3.8.3 right now.</p>
<p>Wanted to add my ViewModel as a data source and then drag it over onto my XAML control, but it doesn&#39;t show up when I browse through the project (to click on and select as a new object data source).</p>
<p>Anyone else run into this?</p>
<p>(This is in &quot;Data Sources&quot;, &quot;Add New Data Source&quot;, &quot;Object&quot;)</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Friday, August 27, 2010</h2><p>The Data Sources window uses reflection to find types. So you have to build your solution before it can reflect against your assemblies. Maybe that&#39;s the issue?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, August 27, 2010</h2><p>Of course this only works in VS10 - so I assume you aren&#39;t trying this in VS08.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Friday, August 27, 2010</h2><p>We have rebuilt &amp; then some, yep. </p>
<p>I manually finagled the file by adding a datasource to something else and editing the actual data source file that got created (I am actually OK now), but my coworker who did a GLV&nbsp;simply sees:</p>
<p>&#39;ProductName.Silverlight.ViewModels.OrganizationViewModel is no longer available. Verify the class name is correct and the reference to this class is still valid.&#39;</p>
<p>I was just going to confirm&nbsp;in this reply&nbsp;that going into the add new data source shows <span style="text-decoration:underline;">everything except the view model</span>, and <em>this time it decides to start showing up</em>.&nbsp; We rebuilt, cleaned solution, closed VS and reentered, refreshed,...&nbsp; I&#39;d swear it wasn&#39;t there earlier. </p>
<p>So now I can see everything properly, including&nbsp;ViewModels, when browsing for data source&nbsp;within Add New Data Source&nbsp;(including ones I just create and then build project) and he can see <em>everything except the view models</em>.</p>
<p>I&#39;m sure we&#39;ll figure it out, but I&#39;m certainly confused.</p>
<p><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">(Yes VS 2010)</span></span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, August 27, 2010</h2><p>I had a problem where I couldn&#39;t find the datasources because there was a type exposed but wasn&#39;t referenced.&nbsp; For example, I was accidently exposing a class from my DAL in my business layer.&nbsp; The UI worked when run because it never invoked anything that actually needed that class, but just the fact that it was publicly visible was enough to screw up VS.&nbsp; </p>
<p>Maybe something similar which you&#39;ve since resolved?&nbsp; I don&#39;t know if that happens in VS2010 though, but I know it was a problem for me in 2008.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Saturday, August 28, 2010</h2><p>I&#39;m not sure what the actual answer was - my coworker had some assemblies in a common public ssemblies directory from some earlier task that he said when removed allowed him to select his ViewModels - and my messing around by adding a datasource to some other class and then manually changing the file seemed to press some magic button for me.</p>
<p>Regardless, both of us can see our ViewModels when adding a new data source now.&nbsp; I&#39;m still not sure exactly what the problem/solution combination was.</p>
<p>Thanks for the replies</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonM replied on Friday, January 28, 2011</h2><p>I&#39;m working on my first CSLA Silverlight MVVM project and I just hit this!&nbsp; If I change my viewmodel class to be a ViewModel&lt;object&gt; instead of ViewModel&lt;MyCSLBusinessClass&gt; and compile it shows up in my data sources window.&nbsp; If I change it back to ViewModel&lt;MyCSLABusinessClass&gt; it doesn&#39;t show up!&nbsp; </p>
<p>That tells me it is something wrong with my business class.&nbsp; ;(</p>
<p>Any suggestions would be appreciated.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, January 28, 2011</h2><p>The VS designer will actually instantiate the type as you do drag-and-drop. So if there&#39;s something blocking the type from instantiating (like it tries to talk to the database when in design mode) that&#39;d cause this issue.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonM replied on Friday, January 28, 2011</h2><p>I took all the code out of my ViewModel except for I made it a ViewModel&lt;MyCustomerCSLAclass&gt;.&nbsp;&nbsp; That was enough to keep it from showing up.&nbsp; So here&#39;s my work around.&nbsp; Change the code to ViewModel&lt;object&gt;.&nbsp; Then it shows up in the list.&nbsp; Add it to your datasources.&nbsp; Then change it back and recompile.&nbsp; It still shows up.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, January 28, 2011</h2><p>Yeah, in that case the problem is almost certainly that your viewmodel&#39;s constructor is calling DoRefresh or BeginRefresh when in design mode - which calls the business object factory, which tries to call the data portal and fails because the data portal isn&#39;t configured to run inside Visual Studio.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
