<html><header><title>Managed Backing Fields with Type Conversion: I can't use the method GetPropertyConvert  in the CSLA 3.5 using VS2008</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Managed Backing Fields with Type Conversion: I can't use the method GetPropertyConvert  in the CSLA 3.5 using VS2008</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7678.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>tutus posted on Thursday, September 24, 2009</h2><P>I try to use this code for one&nbsp;my buisness object properties:</P><PRE class=programlisting>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT color=#0000ff>Private Shared NBR_DOORSProperty As PropertyInfo(Of Nullable(Of Integer)) = RegisterProperty(GetType(Nullable(Of Integer)), New PropertyInfo(Of Nullable(Of Integer))("NBR_DOORS"))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Public Property NBR_DOORS() As Nullable(Of Integer)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return GetPropertyConvert((NBR_DOORSProperty)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal Value As Nullable(Of Integer))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetPropertyConvert(NBR_DOORSProperty, Nothing)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Property</FONT></PRE><PRE class=programlisting>But I get the error that <STRONG>GetPropertyConvert <FONT color=#ff0000>does not exisit</FONT> or something like that !!!</STRONG></PRE><PRE class=programlisting><STRONG>Is that normal ?</STRONG></PRE><PRE class=programlisting><STRONG>The reason why I m using <FONT color=#0000ff>GetPropertyConvert</FONT> is that my property is of type Nullable(Of Integer). </STRONG></PRE><PRE class=programlisting><STRONG>Just to let u know, When I tried to use the regular method: <FONT color=#0000ff>GetProperty, SetProperty</FONT> I got the run time error : </STRONG></PRE><PRE class=programlisting><STRONG><FONT color=#ff0000>Index is out of range</FONT> or something like that; </STRONG></PRE><PRE class=programlisting><STRONG>it seemed like the framework did not allow the creation of GetProperty/SetProperty for type: </STRONG></PRE><PRE class=programlisting><STRONG>nullable(Of Integer).</STRONG></PRE><PRE class=programlisting><STRONG>Therefore, I m trying to use GetPropertyConvert instead (pls correct me If I'm wrong )</STRONG></PRE><PRE class=programlisting><STRONG>I m using version 3.5 of CSLA and VS2008.</STRONG></PRE><PRE class=programlisting><STRONG>Thanks a lot for your time</STRONG></PRE></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tom_W replied on Thursday, September 24, 2009</h2>I'm not sure about 3.5, but certainly in 3.6.x you shouldn't need to a convert to use a nullable type for a property, this code is from our production system (3.6.3) and works fine:<br><blockquote>private static PropertyInfo&lt;int?&gt; AccountNoProperty = RegisterProperty(new PropertyInfo&lt;int?&gt;("AccountNo", "Account No"));<br></blockquote>If you can cut and paste the exact error messages that may help someone who knows 3.5 well track down the issue. <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tom_W replied on Thursday, September 24, 2009</h2>Should your private property declaration read:<br><pre class="programlisting">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">Private Shared NBR_DOORSProperty As PropertyInfo(Of Nullable(Of Integer)) = RegisterProperty(New PropertyInfo(Of Nullable(Of Integer))("NBR_DOORS"))<br></font></pre>(I removed the <font><font color="#0000ff">GetType(Nullable(Of Integer)),&nbsp; </font></font>part of the code) </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, September 24, 2009</h2>Don't use the overload of RegisterProperty that takes Type as its first argument.  <br /><br />The Type argument tell Csla to what .Net type the proeprty is registered, and you're saying it belongs to Int32, when it should belong to your BO.<br /><br />Perhaps Rocky should add that attributre which hides those overloads from Intellisense..</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
