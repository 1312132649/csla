<html><header><title>Guidelines/FAQ for hierchical object model in CSLA (especially parent/child events)?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Guidelines/FAQ for hierchical object model in CSLA (especially parent/child events)?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5036.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 posted on Monday, June 30, 2008</h2><P>I've been in the middle of porting an existing legacy C++ application to CSLA (currently 3.0), but am not finding the guidance in the book with regard to how to handle CSLA-ish concepts as they affect parent/child object relationships.</P>
<P>For example, what child events (if any) does/can/should the parent monitor with respect to child objects and vice versa? </P>
<P>Also, I found myself wanting to have methods on a child object that depended on a parent property. All well and good, except that the parent was a BusinessListBase derived class, and these don't implement PropertyHasChanged(), etc. OK, so you just wrap the BLB in it's own parent BO. Oops, now the child object is now a grandchild and would have to retrieve the property from it's grandparent. My initial reaction to this is Ugh! - why would I need to add an additional object level just to accommodate some CSLA-specific implementation issue. </P>
<P>Are there some blogs or examples of advanced CLSA object models someone could point me to, or should I just ask my specific design questions here as I run into them so we can discuss?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Monday, June 30, 2008</h2><P>One of the issues I've found typical for developers that are new to CSLA (myself included once upon a time) is the fact that your business object's Parent property is referring to the list that contains the object.&nbsp; This presents a problem when you want to communicate up the object model.</P>
<P>The first question you have to ask yourself if it really makes sense for a child object to be calling into its parent.&nbsp; Most likely, you are trying to notify the parent of something that has happened in the child.&nbsp; This is most easily and effectively accomplished by exposing events in the child object and wiring up handlers in the parent.&nbsp; The easiest way to do this is to echo the event from its "parent" collection.</P>
<P>A good example of this can be found with the existing PropertyChanged event on a BO and ListChanged event on a list.&nbsp; Business lists are coded to wire handlers for a contained object's PropertyChanged event which it <EM>converts</EM> to its own ListChanged event with the ListChangedType set to ItemChanged.</P>
<P>I've often followed the same pattern when bubbling events up an object model.</P>
<P>On the other hand, there are times when you want to reach up the object model.&nbsp; A good example is the Path property in a tree structure which calls up the object model until it reaches the root then appends its value to the what is returned from the parent.&nbsp; Because of the Parent issue in CSLA, this can seem problematic but it's really not.</P>
<P>The key is to have a reference from the list that contains your child objects to the parent object.&nbsp; This is best accomplished by passing a reference to the parent object when the collection/list is instantiated.&nbsp; For example,</P>
<BLOCKQUOTE dir=ltr>
<P>_nodes = new NodeCollection(this);</P></BLOCKQUOTE>
<P>Once the collection/list has a reference to the parent object, it is easy for the collection to set a reference to the same object when children are added.&nbsp; Then you can use code similar to:</P>
<BLOCKQUOTE dir=ltr>
<P>path = (Parent as NodeCollection).Path + Text;</P></BLOCKQUOTE>
<P>With both of these techniques, you can have an object model as deep as you need to with events bubbling from bottom to top and methods or properties crawling up the object graph to the top.</P>
<P>Not sure if that completely answers your question, but I hope it helps.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Tuesday, July 01, 2008</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>SonOfPirate:</strong></div><div>
<P>The first question you have to ask yourself if it really makes sense for a child object to be calling into its parent.&nbsp; </div></BLOCKQUOTE></P>
<P>Well, I'm not sure, but one question I have is whether a validation rule in a child object might depend on the state of another child in the same list. </P>
<P>For example, say you are trying to avoid duplication (e.g. the same item isn't allowed in the list twice), or in a related way, say with prescription drugs, two different drugs can't be in a formulary because of drug dependencies. </P>
<P>If I allow the user to pick a medication via a drop-down (or enter directly), the validation in this case would need to inspect other medications in the list.</P>
<P>Yes, I can conceive of ways to reign in access to child properties and creation to avoid this a different way, but then sometimes I'm doing "validation" using rules and sometimes by creative design. </P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
