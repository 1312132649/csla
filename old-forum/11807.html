<html><header><title>Supporting Multiple Data Schemas </title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Supporting Multiple Data Schemas </h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11807.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>brickls posted on Tuesday, January 29, 2013</h2><p>Our application provides an user interface to another system with a data schema that is not within our control. Our application uses CSLA to create business objects to allow editing of the data in the third party system. However, as the third party data schema evolves we have to evolve with it. &nbsp;However, at any given time our customers can have any version of the third party system with a different data schema. Therefore, our application needs to be able to adjust to whatever supported version of the schema that the customer happens to have. &nbsp;</p>
<p>We have looked at possibly using the Strategy Pattern to solve this. &nbsp;Essentially having a base class that supports the lowest version of the data schema and then having derived classes to support each subsequent version. &nbsp;In turn, we would have a factory that returned the class that corresponded to the current version of the data schema. However, we are concerned with the possibility of a long and confusing inheritance chain this may cause. &nbsp;Is there a better way to solve this problem? Possibly with composition instead of&nbsp;inheritance?&nbsp;&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>skagen00 replied on Tuesday, January 29, 2013</h2><p>I don&#39;t know how crazy the differences in your data schema could be.&nbsp; One of the common things is the notion of client defined custom fields.</p>
<p>We leverage a businesslistbase on the various entities that have custom properties.&nbsp; For example, an organization might have one of these businesslistbases, a contact might have one of these businesslistbases, etc.</p>
<p>So we might have a CustomPropertyList fo CustomProperty BOs.&nbsp; You could go so far as to have an ICustomProperty interface and have different types of properties within the CustomPropertyList.&nbsp; Each CustomProperty has a &quot;Value&quot;, a &quot;Name&quot;, perhaps a &quot;Type&quot;, perhaps IsRequired which can be enforced through a business rule on the Value property of the CustomProperty, perhaps the type dictates what a valid value is and a business rule is applied there. (If you don&#39;t use ICustomProperty / polymorphic custom property type classes, you really have to leave value as an object or string and do validation upon it).</p>
<p>It&#39;s a little different than a traditional businesslistbase in that we don&#39;t allow a user to remove or add custom properties in the businesslistbase, they can just modify what is there.&nbsp; Also, data access isn&#39;t about inserting or updating individual rows in our case; largely, the parent that contains the businesslistbase of custom properties handles the data access for it.</p>
<p>Within Create and Fetch, the CustomPropertyList is established with all the custom properties for the client in question.&nbsp; So, in a multi-tenant environment we can support different customizers with different custom fields.</p>
<p>My answer may not congeal with what you&#39;re asking, but just wanted to throw it out there.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brickls replied on Tuesday, January 29, 2013</h2><p>That you for the response! &nbsp;We actually have the same requirement of supporting client defined custom fields. &nbsp;However, we solved it a little differently by using the static RegisterProperty method on the base business object to define the custom properties and then using a Custom Property Descriptor to show those custom properties as regular properties at run time. We are able to assign business rules to those customer defined properties as well. I suppose I was resisting using the custom property functionality to support concrete version changes of the third party schema. &nbsp;However, after your response, I am not sure why I am resisting that. It could actually work quite well. I will see if I can get this working. </p>
<p>Thanks again! &nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Tuesday, January 29, 2013</h2><p>Just curious, but how do you support more than one client at the same time when registering properties normally via RegisterProperty?&nbsp; The known properties and rules for a class are established upon first instance, no?</p>
<p>Or do you not have to worry about multi-tenancy?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brickls replied on Wednesday, January 30, 2013</h2><p>In our application the business objects are created just on the client that is using the app that moment. &nbsp;This isn&#39;t a web app and we are also not passing the business objects back and forth with the server. We simply use csla to give us the business object framework on the client but we rely on the the third-party system that we are integrating to for the remote api. In that sense, multi-tenancy is provided by the third party api.&nbsp;</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
