<html><header><title>BusinessListBase&lt;T, C&gt; bug?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>BusinessListBase&lt;T, C&gt; bug?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7333.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jureleskovec posted on Friday, July 24, 2009</h2>Use case:<br>list.BeginEdit();<br>list.Add(child1);<br>list.Remove(child1);<br>list.Add(child1);<br>list.AcceptChanges();<br><br><br><br>On the last line the 'Edit level mismatch' occurs. I traced this issue inside the Csla a bit I think this happens because the child's edit level is decreased twice:<br>1. because it is in the deleted list (because it was removed).<br>2. because it is a part of the list (object tree) itself.<br><br>This is a more general problem when having an object in the object tree referenced more than once.<br><br>We found a workaround for the issue but it is getting really annoying since the pattern causing it is widely used. There are many cases where users arbitrarily add and remove items to/from a list.<br><br><br>-- Jure<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, July 27, 2009</h2>What version of CSLA?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jureleskovec replied on Tuesday, July 28, 2009</h2>Version 3.6.2.0<br><br><br>-- Jure<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, July 28, 2009</h2><P>It is true that the default behavior of BLB doesn't allow you to re-add <EM>the same instance that was deleted</EM>.</P>
<P>The reason, is that the object is in the deleted list and is used as a marker so the data will be deleted. The fact that another object has subsequently been added to the active list is fine, but that's an insert operation, because the old object will be deleted.</P>
<P>If you don't like that behavior, you'll need to create a subclass of BLB and override some methods to change the default behavior.</P>
<P>iirc, this question came up a few years ago, and I opened up some methods (made them protected) so it was possible for a subclass to remove an item from the deleted list - thus allowing you to override the insert behavior (which is ultimately what Add() calls) to remove the item from the deleted list before doing the actual insert.</P>
<P>Obviously that changes the semantic behavior of BLB rather a lot, but it allows you to get the behavior you are after.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
