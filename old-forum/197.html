<html><header><title>Why is SortedBindingList&lt;T&gt; not serializable?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Why is SortedBindingList&lt;T&gt; not serializable?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/197.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Shazam posted on Wednesday, May 24, 2006</h2><DIV>Hi there,</DIV>
<DIV>&nbsp;</DIV>
<DIV>first post here.&nbsp; I've been using CSLA to convert a project I'm working on, and have run into an annoying issue.</DIV>
<DIV>&nbsp;</DIV>
<DIV>SortedBindingList&lt;T&gt; should be serializable. It sure would help in regards to Webforms.&nbsp; When enabling both sorting and paging on something like a GridView, since SortedBindingList&lt;T&gt; can't be serialized, I have to always create the SortedBindingList&lt;T&gt; and call ApplySort when I'm sorting AND paging, which can take some time to run.&nbsp; I would prefer to just sort once (when the user requests sorting), and during paging, simply rebind to the persisted SortedBindingList&lt;T&gt;.</DIV>
<DIV>&nbsp;</DIV>
<DIV>I tried to add the [Serializable] attribute to SortedBindingList&lt;T&gt; and the inner class ListItem, but it didn't seem to work.&nbsp; Any ideas?</DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Shazam replied on Thursday, May 25, 2006</h2><DIV>I did miss marking the class SortedEnumerator, but it seems that System.ComponentModel.PropertyDescriptor is the problem, as it can't be serialized. Argg.</DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Shazam replied on Thursday, May 25, 2006</h2><DIV>Ok, I found a workaround.</DIV>
<DIV>&nbsp;</DIV>
<DIV>Add the [NotSerialized] attribute to the _sortBy variable in SortedBindingList&lt;T&gt;, and mark all classes in that file as [Serializable].&nbsp; That will allow you to persist SortedBindingList&lt;T&gt; in SessionState, etc.&nbsp; It should render the SortExpression getter unuseable between postbacks, however.</DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pfeds replied on Thursday, May 25, 2006</h2><P>Why do you need to serialize it?&nbsp; The SortedBindingList is a view of an IList, similar to a DataView of a DataTable in ADO.NET.&nbsp; Your client will retrieve the IList (BusinessCollection) from the DataPortal, which will be serialized.&nbsp; The SortedBindingList will display a sorted view on the client.&nbsp; Think of the sorted list being a collection of pointers to the actual objects in the business collection.</P>
<P>Does that help?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Shazam replied on Thursday, May 25, 2006</h2><DIV>I already mentioned why it needs to be persisted above.&nbsp; Sorting is not free, and with something like a GridView, you have to resort every time a user changes pages on a sorted collection.</DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, May 25, 2006</h2><P>You should be <EM>very</EM> careful when doing something like this. As someone noted, the sorted list is merely a view over another list. If you serialize the sorted list, it <EM>will</EM> serialize the original list and all its child objects (and their children, etc.).</P>
<P>But if you <EM>also</EM> serialize the actual business object, then you'll end up with TWO byte streams containing the same data. When you deserialize you'll get TWO object graphs. The sorted list will NOT point to the actual business objects any more, but rather to a copy of the business objects.</P>
<P>This is why I didn't make SortedBindingList serializable - because it isn't real obvious that this would happen, and I can easily envision all sorts of unintended consequences coming from this - hard to find bugs, etc. Things where the user edits an object and then you call Save() and the changes aren't saved - because the user changed the <EM>copy</EM> rather than the real object - that sort of thing...</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Shazam replied on Thursday, May 25, 2006</h2><DIV>Yes, I do realize the implications of serializing the sortview.</DIV>
<DIV>&nbsp;</DIV>
<DIV>Unfortunately this means that SortedBindingList is rather limited in usage for&nbsp;webforms.</DIV>
<DIV>&nbsp;</DIV>
<DIV>My&nbsp;needs only require that ReadOnlyList be sorted.&nbsp; I guess I'll have to roll my own solution to this then.</DIV></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
