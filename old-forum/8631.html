<html><header><title>Strange problem with ClientContext</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Strange problem with ClientContext</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8631.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>alexsychev posted on Monday, March 08, 2010</h2><p>Hi!</p>
<p>I&#39;m working on Point of Sale application. We&#39;re using CSLA 3.6 in client/server mode, the server is hosted inside windows service.</p>
<p>I came across the following problem: sometimes during server side processing&nbsp; I have the data from another request in ClientContext. Also the ApplicationContext.User contains wrong user.</p>
<p>It is difficult to reproduce and I&#39;m not sure what triggers it. I looked a bit in the csla implementation of client context and it seems to be quite ok, because on server side the data is set before request processed and stored in per-thread storage (correct me if I&#39;m wrong).</p>
<p>I have a feeling that it is not the CSLA which is the cause of the problem, but anyway: had anybody experience issues like this?</p>
<p>Thanks!</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, March 08, 2010</h2><p>Yes, in a Windows service host the values would be stored in TLS, and of course the principal is set as the thread&#39;s CurrentPrincipal.</p>
<p>Do you have any server-side multithreading going on? The data portal only sets the context values on the thread that is handling the request, and if you use any other threads you are responsible for setting the values on those threads</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>alexsychev replied on Sunday, March 14, 2010</h2><p>OKay, it was purely and entirely the problem of my application. The wrong data came from another request. CSLA works correctly!</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
