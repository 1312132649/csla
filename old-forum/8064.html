<html><header><title>Generic Equals override for CSLA objects (LINQ to Objects help)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Generic Equals override for CSLA objects (LINQ to Objects help)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8064.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jack posted on Monday, November 30, 2009</h2>I've found I keep writing custom linq statements to compare objects in a CSLA collection without using the object.Equals function and for some I can't determine how to write the linq statement.&nbsp; What I really want is to override Equals in many scenarios so that it matches based on GetIdValue().<br><br>I know there is the GetIdValue() but I don't know how to write a function like that for the Excepts clause.<br><br>ie) listA.Except(listB) ... this calls the Equals which doesn't work when all I care about is a PK in both lists.<br><br>I really want listA.Except(listB where listA.GetIdValue() equals listB.GetIdValue()).<br><br>So I thought I would benefit from having a generic equals when all I care about is the PK.&nbsp; Given that:<br><br>1) How do I create a generic equals override that I can put in my application level override of BusinessBase&lt;T&gt; ?<br><br>2) Can someone show me how I can write the Except statement to match based on GetIdValue()?<br><br>Thanks<br><br>jack<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tmg4340 replied on Monday, November 30, 2009</h2><P><FONT face=Tahoma size=2>Depending on your UI technology, writing a generic Equals override may not be possible.</FONT></P>
<P><FONT face=Tahoma size=2>I'm pretty sure Rocky touches on it in the 2008 book, but WPF and WinForms handle equality much differently.&nbsp; IIRC, Equals won't work in WPF.&nbsp; But not overriding them won't really work in WinForms.&nbsp; In fact, I think Rocky says that if you're using WPF (and, I would assume, by extension Silverlight), you shouldn't override either method - though I think overriding "GetIdValue" won't hurt.</FONT></P>
<P><FONT face=Tahoma size=2>Having said that, building a generic "Equals" override that you can put into your base class should be easy enough - just reference the "GetIdByValue" method, and override that in your subclasses to return whatever you need.&nbsp; It returns an object, so you can define your "object ID" however you want.</FONT></P>
<P><FONT face=Tahoma size=2>In terms of your Except method, Except can take an object that impments the generic IEqualityComparer interface.&nbsp; So instead of worrying about overriding Equals,&nbsp;you could always create an object that implements that interface, passing your BusinessBase type as the generic type.&nbsp; Then you just use that object in your Except (and&nbsp;several other LINQ method) calls.&nbsp; You can still override "GetIdValue", and just reference that in your IEqualityComparer implementation.</FONT></P>
<P><FONT face=Tahoma size=2>HTH</FONT></P>
<P><FONT face=Tahoma size=2>- Scott</FONT></P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
