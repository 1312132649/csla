<html><header><title>Some doubt of  Business Rule</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Some doubt of  Business Rule</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11997.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Sam_Lin posted on Tuesday, May 28, 2013</h2><p>Dear All:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; I am a junior in CSLA framework. There&#39;s a doubt when i reading the &quot;Using CSLA 4&quot; about the business rule: It says &quot;the target property can only be used on the ui thread and any use of this property on a background thread will lead to cross-thread exceptions or nasty threading bugs&quot;</p>
<p>My doubt:</p>
<p>1. this rule is only suitable for async rule or both sync/async rule?</p>
<p>2.if i don&#39;t have the ui thread, and it just a service to expose interface to others,in this case, can i use the target ?</p>
<p>3.&nbsp;Dose&nbsp;everyone could&nbsp;illustrate some detail example to explain what problem will occur when use target in background thread?</p>
<p>Thanks.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Tuesday, May 28, 2013</h2><p>Hi,</p>
<p>Typically - rules is triggered by a user editing a property in the UI. So it is likely that the rules Execute method will be called on the UI thread on an object that is databound. You will get cross thread exception when you try to set properties on an object in a background thread (actually when the OnPropertyChanged event is called and there is eventlisteners on another thread).</p>
<p>When rules have IsAsync = true this tells the RuleEngine to not call context.Complete automatically. It is then your code&acute;s responsibility to call context.Complete when the async operation is completed.&nbsp;</p>
<p>When you use ASP.NET or WCF you will typically load data into the object and call BusinessRules.CheckRules(). This is more efficient than calling rules on every property setter.</p>
<p>So your rules may be sync or async. Async rules may only get the contextTarget when ProvideTargetWhenAsync = true and you explicitly take reposibility for interaction with context.Target.&nbsp;</p>
<p>What is the rule expected to do?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Sam_Lin replied on Wednesday, May 29, 2013</h2><p>Thanks, JonnyBee</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; i think&nbsp;i can descripe this rule as below:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Target(BusinessBase) is not thread safety, There will be a problem when multi-thread access the target and its properties</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; That&#39;s mean when i guarantee the target is thread safety, there won&#39;t be a problem.</p>
<p>Right?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, May 30, 2013</h2><p>Hio, </p>
<p>Most of .NET framework is NOT thread safe so I&#39;m afraid I do not quite understand how you can make target thread safe. </p>
<p>For CSLA part it is mostly UI Events that causes problems when they occur from a thred that is NOT the UI Thread. <br />This will cause cross-thread exception to be thrown. </p>
<p>I stil do not understand what the purpose of the rule is. </p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Sam_Lin replied on Thursday, May 30, 2013</h2><p>OK, don&#39;t worry about that. It just the way of my understanding(i don&#39;t want to bring the UI/Background thread to it) . Maybe it&#39;s very hard to make the target thread safe.</p>
<p>So, my understanding is right?</p>
<p>&nbsp;</p>
<p>Thanks Jonney.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>thaehn replied on Thursday, May 30, 2013</h2><p>Here is an example of running a rule both on the current UI&nbsp;thread and using an async call on another thread.&nbsp; The UI thread just checks to see that the name isn&#39;t empty.&nbsp; Then a command is called to check the database that the name is unique and doesn&#39;t duplicate another name in the database:</p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">using</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> Csla.Core;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">using</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> Csla.Rules;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:gray;font-size:9.5pt;mso-highlight:white;">///</span><span style="font-family:Consolas;background:white;color:green;font-size:9.5pt;mso-highlight:white;"> </span><span style="font-family:Consolas;background:white;color:gray;font-size:9.5pt;mso-highlight:white;">&lt;summary&gt;</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:gray;font-size:9.5pt;mso-highlight:white;">///</span><span style="font-family:Consolas;background:white;color:green;font-size:9.5pt;mso-highlight:white;"> The group validate name rule.</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:gray;font-size:9.5pt;mso-highlight:white;">///</span><span style="font-family:Consolas;background:white;color:green;font-size:9.5pt;mso-highlight:white;"> </span><span style="font-family:Consolas;background:white;color:gray;font-size:9.5pt;mso-highlight:white;">&lt;/summary&gt;</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">public</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">class</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> </span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">GroupGroupValidateNameRule</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> : </span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">BusinessRule</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">public</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> GroupGroupValidateNameRule(</span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">IPropertyInfo</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> primaryProperty)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>: </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">base</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">(primaryProperty)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ProvideTargetWhenAsync = </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">true</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IsAsync = </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">true</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>AffectedProperties.Add(</span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">GroupGroupItem</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">.NameProperty);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">protected</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">override</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">void</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> Execute(</span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">RuleContext</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> context)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">GroupGroupItem</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> target = (</span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">GroupGroupItem</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">)context.Target;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">if</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> (target.Name == </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">string</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">.Empty)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.AddErrorResult(</span><span style="font-family:Consolas;background:white;color:#a31515;font-size:9.5pt;mso-highlight:white;">&quot;Group Name Cannot Be Empty.&quot;</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.Complete();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">else</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:green;font-size:9.5pt;mso-highlight:white;">// Check for duplicated name</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">GroupGroupValidateNameCommand</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">.BeginExecute(target.Name, target.Id, (o, e) =&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">if</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> (e.Error != </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">null</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">throw</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> e.Error;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">else</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">if</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> (e.Object.Duplicate)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.AddErrorResult(</span><span style="font-family:Consolas;background:white;color:#a31515;font-size:9.5pt;mso-highlight:white;">&quot;Group Name Is Already In Use.<span style="mso-spacerun:yes;">&nbsp; </span>Please Choose Another Name.&quot;</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.Complete();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">else</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.AddSuccessResult(</span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">true</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>context.Complete();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>});<span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p>
<p>Hope this will help find what you are looking for.</p>
<p>Todd</p>
</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, May 30, 2013</h2><p>Hi Todd,&nbsp;</p>
<p>Your rule is not correct. You MUST make sure to always call context.Complete in the callback - or else the object/property will remain &quot;busy&quot; and you will not get the ValidationCompleted event.&nbsp;</p>
<p>So - you should not throw the exception - rather add the error message as AddErrorMessage and call context.Complete().</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>thaehn replied on Thursday, May 30, 2013</h2><p>Thanks, Jonny.&nbsp; One of the boiler-plate cut and paste things... Here is a new copy:</p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">using</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> Csla.Core;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">using</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> Csla.Rules;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:gray;font-size:9.5pt;mso-highlight:white;">///</span><span style="font-family:Consolas;background:white;color:green;font-size:9.5pt;mso-highlight:white;"> </span><span style="font-family:Consolas;background:white;color:gray;font-size:9.5pt;mso-highlight:white;">&lt;summary&gt;</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:gray;font-size:9.5pt;mso-highlight:white;">///</span><span style="font-family:Consolas;background:white;color:green;font-size:9.5pt;mso-highlight:white;"> The group group validate name rule.</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:gray;font-size:9.5pt;mso-highlight:white;">///</span><span style="font-family:Consolas;background:white;color:green;font-size:9.5pt;mso-highlight:white;"> </span><span style="font-family:Consolas;background:white;color:gray;font-size:9.5pt;mso-highlight:white;">&lt;/summary&gt;</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">public</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">class</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> </span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">GroupGroupValidateNameRule</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> : </span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">BusinessRule</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">public</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> GroupGroupValidateNameRule(</span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">IPropertyInfo</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> primaryProperty)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>: </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">base</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">(primaryProperty)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ProvideTargetWhenAsync = </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">true</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IsAsync = </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">true</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>AffectedProperties.Add(</span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">GroupGroupItem</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">.NameProperty);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">protected</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">override</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">void</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> Execute(</span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">RuleContext</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> context)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">GroupGroupItem</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> target = (</span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">GroupGroupItem</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">)context.Target;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">if</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> (target.Name == </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">string</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">.Empty)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.AddErrorResult(</span><span style="font-family:Consolas;background:white;color:#a31515;font-size:9.5pt;mso-highlight:white;">&quot;Group Name Cannot Be Empty.&quot;</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.Complete();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">else</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:green;font-size:9.5pt;mso-highlight:white;">// Check for duplicated name</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">GroupGroupValidateNameCommand</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">.BeginExecute(target.Name, target.Id, (o, e) =&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">if</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> (e.Error != </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">null</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.AddErrorResult(e.Error.Message);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.Complete();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">else</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">if</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> (e.Object.Duplicate)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.AddErrorResult(</span><span style="font-family:Consolas;background:white;color:#a31515;font-size:9.5pt;mso-highlight:white;">&quot;Group Name Is Already In Use.<span style="mso-spacerun:yes;">&nbsp; </span>Please Choose Another Name.&quot;</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.Complete();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">else</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;</span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.AddSuccessResult(</span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">true</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.Complete();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>});<span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p>Todd</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Sam_Lin replied on Thursday, May 30, 2013</h2><p>If i change properties of target in the call back method, It will be a problem? If there&#39;s no other thread access the target such as &quot;OnPropertiesChanged&quot;,it will still be a problem ?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, May 30, 2013</h2><p>Hi</p>
<p>My general recommendation is to NEVER set an objects properties directly by the property setter in a rule Execute method. This will trigger the rule engine to run from within another rule execute method and may cause infinite loops.&nbsp;</p>
<p>In order to update property values on an object you may use&nbsp;</p>
<p>
<ul>
<li>context.AddOutValue or</li>
<li>&lt;rule&gt;.LoadProperty (similar to object factories)</li>
</ul>
</p>
<p>and make sure that all properties to be updated is added to AffectedProperties list in the constructor method of the rule.</p>
<p>The rule engine will then run rules for the affected properties and call OnPropertyChanged for you.&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Sam_Lin replied on Thursday, May 30, 2013</h2><p>Thanks.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>thaehn replied on Friday, May 31, 2013</h2><p>Sam Lin,</p>
<p>Here is an example of setting properties in a rule:</p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">class</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> </span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">DataEntrySetIssueItemSlaRule</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> : </span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">BusinessRule</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">public</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> DataEntrySetIssueItemSlaRule(</span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">IPropertyInfo</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> primaryProperty)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>: </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">base</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">(primaryProperty)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>InputProperties = </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">new</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> </span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">List</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">&lt;</span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">IPropertyInfo</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">&gt; { PrimaryProperty };</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>AffectedProperties.Add(</span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">DataEntryIssueItem</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">.SlaDueByProperty);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>AffectedProperties.Add(</span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">DataEntryIssueItem</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">.ShowSlaProperty);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">protected</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">override</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">void</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> Execute(</span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">RuleContext</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> context)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">var</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> target = (</span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">DataEntryIssueItem</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">)context.Target;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">if</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> (target.CustomerStdHrs &gt; </span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">TimeSpan</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">.Zero || target.CustomerCrtHrs &gt; </span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">TimeSpan</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">.Zero)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">DateTime</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">? slaDate = </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">null</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:green;font-size:9.5pt;mso-highlight:white;">// Critical Part and Critical Problem gets Critical Hrs</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">if</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> (target.PartCritical &amp;&amp; target.Problem.Critical &amp;&amp; target.CustomerCrtHrs &gt; </span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">TimeSpan</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">.Zero)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:green;font-size:9.5pt;mso-highlight:white;">// Calculate SLA date</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>slaDate = target.CalendarEventList.CalculateDate(target.Added, target.CustomerCrtHrs);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">else</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">if</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"> (target.CustomerStdHrs &gt; </span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">TimeSpan</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">.Zero)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>slaDate = target.CalendarEventList.CalculateDate(target.Added, target.CustomerStdHrs);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.AddOutValue(</span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">DataEntryIssueItem</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">.SlaDueByProperty, slaDate);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.AddOutValue(</span><span style="font-family:Consolas;background:white;color:#2b91af;font-size:9.5pt;mso-highlight:white;">DataEntryIssueItem</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">.ShowSlaProperty, slaDate != </span><span style="font-family:Consolas;background:white;color:blue;font-size:9.5pt;mso-highlight:white;">null</span><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;">);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.Complete();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;background:white;color:black;font-size:9.5pt;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p>
<p>Todd</p>
</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
