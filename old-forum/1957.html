<html><header><title>DWMAPI.dll and System.EnterpriseServices.dll </title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>DWMAPI.dll and System.EnterpriseServices.dll </h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1957.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Gareth posted on Tuesday, December 12, 2006</h2>Hi all, I'm just building the CSLA 2.1.1 and Project Tracker libraries for the first time and I've come across an issue on my machine. The CSLA libraries build okay, but the Project Tracker stuff will not build due to an error when referencing the System.EnterpriseServices.dll. Now this occurs even when I am not building an libraries based on COM+/EnterpriseServices. For examples in the Project Tracker solution I've removed every project except for PTWin and ProjectTracker.Library and I've made sure that the app.config is only using a localproxy, so no references to System.EnterpriseServices.dll are used. <br>When the executing code reaches the Fetch method (after entering the username and password on the login screen) there is a FileIO exception due to a dependancies of System.EnterpriseServices.dll not being found. The dependancy (according to depends.exe) is DWMAPI.dll which is the new Vista Desktop Windows Management API that IE7 references. <br>Now I'm using Windows XP with SP2 and IE7, not Vista and I definately don't have this DLL. I've checked out various posts via Google and it seems like uninstalling IE7 is the way to go but I really don't want to do this. <br>I wanted to know if anyone else has had this problem and has got around it.<br><br>One solution I am toying with is creating and registering my own skeleton DWMAPI.dll and seeing if that will get around the problem. There are a couple of posts suggesting this with source code in C++. It seems feasible. I'm guessing that grabbing DWMAPI.dll off a Vista machine won't work but that might be worth trying.<br>Does anyone have any other ideas or solutions?<br>Thanks,<br>Gareth.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Gareth replied on Tuesday, December 12, 2006</h2>Okay I think I've found the solution. I did a repair on the .NET 2.0 Framework and rebooted. Depends.exe still shows the missing dependancy but the project now builds and executes correctly.<br><br>Hope that's of use to others!<br>Regards,<br>Gareth.<br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
