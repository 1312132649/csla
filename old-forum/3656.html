<html><header><title>Data refresh in WPF</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Data refresh in WPF</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3656.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Paul Czywczynski posted on Friday, October 05, 2007</h2>Hey Rocky, I've been following your blog <a href="http://www.lhotka.net/weblog/CommentView,guid,06f305de-ec32-4e20-b042-171b58f305ae.aspx#commentstart">post</a> regarding this topic. Your last comment was interesting and I was wondering if you have anything further info. We've noticed the exact same issue with things being one step behind. Not sure if you have talked to the WPF team yet but I am interested in what they have to say.<br><br>Thanks...&nbsp; -Paul<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Sunday, October 07, 2007</h2><P>Hi Paul,</P>
<P>I did finally finally figure out the issue. I was using the CslaDataProvider's ability to manage the object lifetime by binding a button to the provider using commanding. AND I was using the Click event of the button to close the form (thus triggering the refresh of the underlying view).</P>
<P>It turns out that the Click event fires BEFORE the command is sent to the provider. So the form closes, the view refreshes and THEN the command hits the provider.</P>
<P>I can't see any way to force a button to do the Click after the command.</P>
<P>So what I did was make the edit form (which is an overlay in our case) close itself on the DataChanged event from the provider. The Click event doesn't close the overlay anymore. Instead it sets a flag giving the DataChanged event handler permission to close the form.</P>
<P>That way, when the overlay closes, the underlying view can refresh itself, with the new data.</P>
<P>The Equals() issue still remains though. That's not changed from how it has been since WPF showed up, and I think their approach really sucks. But it is what it is I guess.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>CSLAer replied on Monday, October 08, 2007</h2><P>Hi Rocky,</P>
<P>Is there any changes to the code which is released at the end of last month if this is the case?</P>
<P>Thanks</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, October 08, 2007</h2><P>No, ProjectTracker is unaffected by this issue.</P>
<P>In the project I'm currently building there's a detailed view of data as the main display. You can click to edit parts of that detailed information, and when that happens there's an overlay (user control) that comes in on top of the view (via a cool animation - working with a professional designer is fun!), and the original view fades out a bit.</P>
<P>The user edits the data in the overlay and clicks Save. That button is linked to the CslaDataProvider via a command - just like in PTWpf. But I was also handling the Click event to close the form and to tell the underlying view to refresh itself. That didn't work due to the timing issue.</P>
<P>PTWpf has no underlying view, so this issue doesn't exist.</P>
<P>But in my current project, the solution was to have the Click handler just set a flag to indicate that the overlay form is closing. Then in the CslaDataProvider control's DataChanged event handler (which is raised when the data save is complete), if that flag is set, the underlying view is told to refresh its data.</P>
<P>My current project will (I think) be ultimately put online as a demo, but this is for Magenic, not me, so I don't know for sure when or if it will go online.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
