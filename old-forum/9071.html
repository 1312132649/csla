<html><header><title>Friendly errors on foreign key violations?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Friendly errors on foreign key violations?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9071.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>frankhoffy posted on Friday, June 11, 2010</h2><p>I have 3 tables:&nbsp; Note, Issue, and NoteIssue.&nbsp; If the user attempts to delete an Issue, I would like to display a friendly message if there is a foreign key violation in the NoteIssue table.&nbsp; The foreign key error message from the database is pretty ugly.&nbsp; I was wondering how some of you have dealt with this in your apps.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Marjon1 replied on Saturday, June 12, 2010</h2><p>You really have a couple of options, depending on how your objects are used and the methods you use to delete them</p>
<ol>
<li>You can catch the exception within the relevant dataportal_XYZ method, if it is a foreign key exception then throw a new exception with a more friendly method otherwise just re-throw the original exception.&nbsp;<br />&nbsp;</li>
<li>This sounds like a business rule were you don&#39;t want to allow a user to delete an issue there is a note related to that issue. If you have an instance of an issue and then call delete you could override the delete method to check if there are notes (assuming it knows or a command object would be required) and then throw an error. If you use a factory method to delete the issue without having an actual instance then you could do the same thing, but in the factory method (using a command object). This would prevent the foreign key constraint from being triggered.</li>
</ol>
<p>Hopefully the two suggestions above make some sense, we need a bit more information about your actual classes not the database structure to be able to provide a more detailed / appropriate response. Normally if the user could delete the issue, you would need to ensure that any foreign keys were removed either in the dataportal_delete method, stored procedure or using cascade delete.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>frankhoffy replied on Monday, June 14, 2010</h2><p>I think option #2 is probably going to be the best fit for my situation.&nbsp; Thanks for your help on this.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
