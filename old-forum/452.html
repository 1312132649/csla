<html><header><title>First attempt at IBindingListView</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>First attempt at IBindingListView</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/452.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell posted on Thursday, June 22, 2006</h2>I ported the old FilterableCollectionBase to CSLA 2.0, but it and the SortedBindingList together raised too many ListChanged events, especially resets.&nbsp; So I finally decided to give IBindingListView a go and wrote my first attempt over the last weekend.&nbsp; It works similarly to SortedBindingList in that it takes an IList&lt;T&gt; as a parameter.<br><br>I really have only tested the sorting by 1 property and filtering, but I thought that some people might like to give it a go.&nbsp; So the provisos are that add, remove and the like have not been tested (my use case has me manipulating the source lists).&nbsp; The ObjectListView autosorts and autofilters, but it tries to do it in as economical a manner as possible.&nbsp; So an ItemChanged event on the source might generate an ItemMoved event, or an ItemAdded or ItemDeleted if the change causes the item to be filtered or unfiltered.<br><br>I am also going to start optimising where I can.&nbsp; The sorting is done by hand, but I cheated on the filtering (no way am I going to write a parser of that complexity).&nbsp; Internally, there is a single row DataTable with a DataView.&nbsp; Whenever an item needs to be evaluated as to whether it is filtered, its contents are copied into the row and the DataView is checked to see what the row count is.<br><br>If you plan on using this for in place editing while using a filter, I imagine that you would need to add "OR IsNew = 'True'" to the filter end of the to keep the new items from being filtered out.<br><br>So, in short, it is not completely tested, but I thought some people might like to play with it now and know that it is on its way rather than not know that something was available and coming.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Friday, June 30, 2006</h2>After using it for a week, I think I have most of the bugs out.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tsmo replied on Friday, July 21, 2006</h2>Found a bug:&nbsp; if you try to create an ObjectListView&lt;T&gt; where T has a nullable property, such as a Nullable&lt;DateTime&gt;, the _filteredTable will throw an exception when trying to set up the columns, saying that DataSet doesn't support Nullable&lt;T&gt;.<br><br>Chances are you've looked at them already, but there are a couple other people trying to implement IBindingList out there, so if you're looking to find a way to do this without using DataTables for filtering, you might be able to find ideas here:<br><br>http://www.gotdotnet.com/workspaces/workspace.aspx?id=ccbb6b50-6c55-4291-b191-f5c5f80ba122<br>http://book.itzero.com/read/microsoft/0602/Addison.Wesley.Data.Binding.with.Windows.Forms.2.0.Programming.Smart.Client.Data.Applications.with.dot.NET.Jan.2006_html/032126892X/ch09lev1sec13.html<br><br>Thanks for a great object-- I look forward to the day when its bulletproof and can replace SortedBindingList in CSLA.<br><br>tsmo<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Sunday, July 23, 2006</h2>Thanks for the feedback.&nbsp; The next version will return an ObjectView when indexed instead of an object of type T.&nbsp; This is to properly support the DataGridView control.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
