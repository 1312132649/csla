<html><header><title>upgrading from 3.6 to 4.0</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>upgrading from 3.6 to 4.0</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8875.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>theGov posted on Tuesday, May 04, 2010</h2><p>I have a small app I&#39;m attempting to upgrade from 3.6 to 4.0. For 3.6 this app runs in VS2008 using Cassini, and is configured for using WCF to access the data. I upgraded to VS2010 and using .net&nbsp;3.5, the app still executed fine. I then changed to .NET 4.0 and CSLA 4.0 dlls. When it attempts to access the data portal it gets the following error. Not sure what is happening since CSLA is in control of the WCF service and proxy, so I&#39;m wondering how the content type would not be consistent.</p>
<p>System.ServiceModel.ProtocolException was unhandled by user code<br />&nbsp; Message=The content type text/html; charset=utf-8 of the response message does not match the content type of the binding (application/soap+xml; charset=utf-8). If using a custom encoder, be sure that the IsContentTypeSupported method is implemented properly. The first 1024 bytes of the response were: &#39;&lt;html&gt;<br />&nbsp;&nbsp;&nbsp; &lt;head&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;title&gt;Configuration Error&lt;/title&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;style&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; body {font-family:&quot;Verdana&quot;;font-weight:normal;font-size: .7em;color:black;} <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; p {font-family:&quot;Verdana&quot;;font-weight:normal;color:black;margin-top: -5px}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; b {font-family:&quot;Verdana&quot;;font-weight:bold;color:black;margin-top: -5px}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; H1 { font-family:&quot;Verdana&quot;;font-weight:normal;font-size:18pt;color:red }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; H2 { font-family:&quot;Verdana&quot;;font-weight:normal;font-size:14pt;color:maroon }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pre {font-family:&quot;Lucida Console&quot;;font-size: .9em}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .marker {font-weight: bold; color: black;text-decoration: none;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .version {color: gray;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .error {margin-bottom: 10px;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .expandable { text-decoration:underline; font-weight:bold; color:navy; cursor:hand; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/style&gt;<br />&nbsp;&nbsp;&nbsp; &lt;/head&gt;</p>
<p>&nbsp;&nbsp;&nbsp; &lt;body bgcolor=&quot;white&quot;&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;span&gt;&lt;H1&gt;Server Error in &#39;/&#39; Application.&lt;hr width=100% size=1 color=silver&gt;&lt;/H1&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;h2&gt; &lt;i&gt;Configuration Error&lt;/i&gt; &lt;/h2&gt;&lt;/sp&#39;.<br />&nbsp; Source=mscorlib<br />&nbsp; StackTrace:<br />&nbsp;&nbsp;&nbsp; Server stack trace: <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Security.IssuanceTokenProviderBase`1.DoNegotiation(TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Security.SspiNegotiationTokenProvider.OnOpen(TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Security.WrapperSecurityCommunicationObject.OnOpen(TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Security.CommunicationObjectSecurityTokenProvider.Open(TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Security.SymmetricSecurityProtocol.OnOpen(TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Security.WrapperSecurityCommunicationObject.OnOpen(TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Channels.SecurityChannelFactory`1.ClientSecurityChannel`1.OnOpen(TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Security.SecuritySessionSecurityTokenProvider.DoOperation(SecuritySessionOperation operation, EndpointAddress target, Uri via, SecurityToken currentToken, TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Security.SecuritySessionSecurityTokenProvider.GetTokenCore(TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.IdentityModel.Selectors.SecurityTokenProvider.GetToken(TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Security.SecuritySessionClientSettings`1.ClientSecuritySessionChannel.OnOpen(TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Channels.ServiceChannel.OnOpen(TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Channels.CommunicationObject.Open(TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Channels.ServiceChannel.CallOpenOnce.System.ServiceModel.Channels.ServiceChannel.ICallOnce.Call(ServiceChannel channel, TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Channels.ServiceChannel.CallOnceManager.CallOnce(TimeSpan timeout, CallOnceManager cascade)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message)<br />&nbsp;&nbsp;&nbsp; Exception rethrown at [0]: <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData&amp; msgData, Int32 type)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.Server.Hosts.IWcfPortal.Fetch(FetchRequest request)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.DataPortalClient.WcfProxy.Fetch(Type objectType, Object criteria, DataPortalContext context) in C:\Visual Studio Projects\csla\40\Source\Csla\DataPortalClient\WcfProxy.cs:line 149<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.DataPortal.Fetch(Type objectType, Object criteria) in C:\Visual Studio Projects\csla\40\Source\Csla\DataPortal.cs:line 238<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.DataPortal.Fetch[T]() in C:\Visual Studio Projects\csla\40\Source\Csla\DataPortal.cs:line 174<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at CSLATestProjectTracker.BusObj.ProjectType_RdOnlyList.GetProjectType_RdOnlyList() in C:\Users\d006944\Documents\Visual Studio 2010\Projects\CSLATestProjectTracker\CSLATestProjectTrackerBusObj\BusObj\ProjectType_RdOnlyList.cs:line 40<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at FrameWorkApp.StaticListManager.ReadBusObjList[ListType](Int32&amp; cacheRefreshSecs) in C:\Users\d006944\Documents\Visual Studio 2010\Projects\CSLATestProjectTracker\FrameWork\StaticListManager.cs:line 37<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at FrameWorkApp.StaticListManager.GetDefBusObjList[ListType]() in C:\Users\d006944\Documents\Visual Studio 2010\Projects\CSLATestProjectTracker\FrameWork\StaticListManager.cs:line 110<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at FrameWorkApp.StaticListManager.GetBusObjListCurrentItems[ListType]() in C:\Users\d006944\Documents\Visual Studio 2010\Projects\CSLATestProjectTracker\FrameWork\StaticListManager.cs:line 155<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at CSLATestProjectTracker.ProjectList.get_myProjectTypes() in C:\Users\d006944\Documents\Visual Studio 2010\Projects\CSLATestProjectTracker\ProjectList.aspx.cs:line 37<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at CSLATestProjectTracker.ProjectList.Page_Load(Object sender, EventArgs e) in C:\Users\d006944\Documents\Visual Studio 2010\Projects\CSLATestProjectTracker\ProjectList.aspx.cs:line 184<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.UI.Control.OnLoad(EventArgs e)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.UI.Control.LoadRecursive()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)<br />&nbsp; InnerException: System.Net.WebException<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Message=The remote server returned an error: (500) Internal Server Error.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Source=System<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StackTrace:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Net.HttpWebRequest.GetResponse()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ServiceModel.Channels.HttpChannelFactory.HttpRequestChannel.HttpChannelRequest.WaitForReply(TimeSpan timeout)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InnerException:</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Thursday, May 06, 2010</h2><p>I think the &quot;Server error in &#39;/&#39; Application&quot; is the clue you are looking for. The server app just plain crashed, at the web server level. So there&#39;s probably an incompatibility in your web.config from .NET 3.5 to .NET 4.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
