<html><header><title>IsDirty within a SortedBindingList</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>IsDirty within a SortedBindingList</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2361.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>bgilbert posted on Friday, February 16, 2007</h2>In a WinForm, I wrap a collection object in a sortedBindingList to allow sorts in a DataGridView. I'm trying to evaluate the collection's IsDirty property, but I'm struggling with the syntax to get to the original collection object.<br><br>Thanks,<br>Barry<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, February 16, 2007</h2><P>The original collection is still in a variable in your code. You used it when you created the sorted list.</P>
<P>So do not try and get it out of the sorted list. Just use the original variable.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>bgilbert replied on Friday, February 16, 2007</h2>Joe,<br>Thanks for your response. I should have been more explicit in my description.<br><br>I have subclassed the WinPart control (called MaintWinPart) to handle a variety of my forms. This control contains the bindingList, which I fill in the derived controls. I have the close routine in MaintWinPart handle the close/cancel logic by evaluating the BindingSource like this:<br><br>Public Overrides Sub Close(ByVal sender As Object, ByVal e As FormClosingEventArgs)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not (BindingSource1.DataSource Is Nothing) AndAlso BindingSource1.DataSource.IsDirty Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Select Case MessageBox.Show("Save changes?", "Confirm close", MessageBoxButtons.YesNoCancel, MessageBoxIcon.Question, MessageBoxDefaultButton.Button3)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case DialogResult.Yes&nbsp;&nbsp; '&nbsp;&nbsp; Save and close.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Save()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyBase.Close(sender, e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case DialogResult.No&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp; Close without saving.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyBase.Close(sender, e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case DialogResult.Cancel<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.Cancel = True<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Select<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else&nbsp;&nbsp;&nbsp; '&nbsp;&nbsp; Not dirty.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyBase.Close(sender, e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>End Sub<br><br>My idea is to standardize the logic across all derived forms with the assumption that the BindingSource's DataSource is based on a BusinessListBase. However, when I started wrapping the collection classes in SortedBindingLists, I can no longer seem to use generic code to determine the IsDirty status.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, February 16, 2007</h2><P>That's an interesting issue. SortedBindingList and FilteredBindingList should probably have a property allowing you to get at the original list...</P>
<P>They actually do - the SyncRoot property simply returns the original list reference - but there should be a more explicit way to do it (you can't count on SyncRoot for this particular purpose).</P>
<P>I'll add this to the <A href="http://www.lhotka.net/Article.aspx?id=42066ed8-ea65-44a3-b7fd-035c9d8bfa36">wish list</A>.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>bgilbert replied on Friday, February 16, 2007</h2>Rocky,<br>SyncRoot works for me for now. <br><br>Thanks for your response. <br>Barry<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>amselem replied on Friday, February 16, 2007</h2><FONT size=4>
<P></FONT><FONT size=2>I also had this issue so I created a Generic class inherited from SBL to allow access to the inner list and to have strong typing :</FONT></P>
<P><FONT size=2><FONT color=#0000ff>Public</FONT> <FONT color=#0000ff>Class</FONT> SortedBindingListEx(<FONT color=#0000ff>Of</FONT> TList <FONT color=#0000ff>As</FONT> Generic.IList(<FONT color=#0000ff>Of</FONT> TItem), TItem)<BR></FONT><FONT size=2><FONT color=#0000ff>Inherits</FONT> CSLA.SortedBindingList(<FONT color=#0000ff>Of</FONT> TItem)</FONT></P>
<P><FONT size=2><FONT color=#0000ff>Public</FONT> <FONT color=#0000ff>Sub</FONT> <FONT color=#0000ff>New</FONT>(<FONT color=#0000ff>ByVal</FONT> list <FONT color=#0000ff>As</FONT> TList)<BR></FONT><FONT size=2><FONT color=#0000ff>MyBase</FONT>.New(list)<BR></FONT><FONT size=2><FONT color=#0000ff>Me</FONT>.mSource = list<BR></FONT><FONT size=2><FONT color=#0000ff>End</FONT> <FONT color=#0000ff>Sub</P></FONT></FONT>
<P><FONT size=2><FONT color=#0000ff>Private</FONT> mSource <FONT color=#0000ff>As</FONT> TList = <FONT color=#0000ff>Nothing</P></FONT></FONT>
<P><FONT size=2><FONT color=#0000ff>Public</FONT> <FONT color=#0000ff>ReadOnly</FONT> <FONT color=#0000ff>Property</FONT> List() <FONT color=#0000ff>As</FONT> TList<BR></FONT><FONT color=#0000ff><FONT size=2>Get<BR></FONT></FONT><FONT size=2><FONT color=#0000ff>Return</FONT> <FONT color=#0000ff>Me</FONT>.mSource<BR></FONT><FONT size=2><FONT color=#0000ff>End</FONT> <FONT color=#0000ff>Get<BR></FONT></FONT><FONT size=2><FONT color=#0000ff>End</FONT> <FONT color=#0000ff>Property</P></FONT></FONT>
<P><FONT size=2><FONT color=#0000ff>End Class</FONT></P></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
