<html><header><title>Sharing a transaction via CriteriaBase?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Sharing a transaction via CriteriaBase?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11727.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>JCardina posted on Tuesday, November 27, 2012</h2><p>I have a read only object which fetches inventory values. &nbsp;It needs to optionally accept a transaction object because it&#39;s sometimes used to simply display values to the user but at other times it&#39;s used by an inventory adjustment object which needs to check current inventory before making changes inside an isolated transaction.</p>
<p>I&#39;m experimenting with passing the transaction as part of a complex criteria (I also need two Guid&#39;s so there are three parameters).</p>
<p>When I try to specify the managed propery for the transaction like this inside my CriteriaBase class I get a complaint from visual studio:</p>
<p>public static readonly PropertyInfo&lt;IDbTransaction&gt; TransactionProperty = RegisterProperty&lt;IDbTransaction&gt;(c =&gt; c.TransactionProperty);</p>
<p>&quot;Cannot convert lambda expression to type &#39;Csla.PropertyInfo&lt;System.Data.IDbTransaction&gt;&#39; because it is not a delegate type&quot;</p>
<p>Is there any reason why I need to use the managed properties in my CriteriaBase derived class? &nbsp;I&#39;m a little confused as to why I need them to simply pass data from one object to another.</p>
<p>Is there a better way to share transactions between objects than this? &nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Tuesday, November 27, 2012</h2><p>This is the reason for the various transaction/connection/context types in the Csla.Data namespace. </p>
<p>I discuss their use in the &#39;Using CSLA 4&#39; ebook, and they are specifically designed to &quot;flow&quot; connections/transactions between your DAL components without having to deal with the complexity you are currently facing.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JCardina replied on Wednesday, November 28, 2012</h2><p>Ahhh!&nbsp; I&#39;ve read all the ebooks but I missed that somehow the first time around, I&#39;ll dig through it, thanks Rocky!</p>
<p>[I don&#39;t know how I missed that before, was it added in a later revision from the first book release?]</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JCardina replied on Monday, December 03, 2012</h2><p>Just an FYI for any future readers of this issue: If you can&#39;t use the built in transaction types in the csla namespace as I can&#39;t it *is* possible to use the far simpler method of setting a shared transaction property in the enlisted other object. &nbsp;You just need to set it&#39;s backing property to nonserializable and it works fine.</p>
<p>So just create a property in the secondary object that will be enrolled in the transaction that holds the shared transaction, give it a backing field set to nonserializable and Bob&#39;s your lobster.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
