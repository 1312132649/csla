<html><header><title>Reload BusinessRules collection in CSLA 4</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Reload BusinessRules collection in CSLA 4</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8933.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Wayne Hiller posted on Friday, May 14, 2010</h2><p>Hi there,</p>
<p>I have custom Validation rules stored in a database that I load at runtime in AddBusinessRules(). If the user makes changes to the rules from within the app I need to be able to clear the existing rules for an object type and force AddBusinessRules to be called again. Any ideas? I did this in 3.8 but it was quite a bit of work finding all the places the rules were cached etc. Now in Csla 4 the rules system has really changed so instead of digging for hours I thought I might just ask first this time.</p>
<p>P.S. Rocky, I love the new Business Rules system. It seems so much more natural than the previous system. Good work :)</p>
<p>&nbsp;</p>
<p>Wayne</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Friday, May 14, 2010</h2><p>The idea I have for this, and you can see if it meets your needs, is that you&#39;d use rule chaining. Basically you create one rule and attach it to your property. That rule is what dynamically loads any other rules, and invokes them using rule chaining. This one rule wouldn&#39;t ever add an error message (except in the case of an exception I suppose), but rather is purely responsible for invoking your other rules.</p>
<p>This way CSLA will do its normal thing - invoking your rule when rules should be run. And your rule in turn will invoke whatever rules you have dynamically loaded for that property. Each of those rules will do its normal thing, operating against the chained context (see my <a href="http://www.lhotka.net/weblog/CSLA4BusinessRuleChaining.aspx">blog post on chaining</a>).</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Wayne Hiller replied on Friday, May 14, 2010</h2><p>Thanks Rocky,</p>
<p>This may work for me however as far as I can tell I would need to Access the database every time the rule fired. I suppose I can design a cache system on my list of Authorization rules. I really need to dig into this rule engine to understand it better. I am a bit confused as to how Authorization rules fit into this. I have not looked at the code but does an Authorization rule get fired very time one of the BusinessRules.HasPermission methods is called?</p>
<p>I will spend some time today digging into the code and create some unit tests to follow the flow to see where my dynamic rules can be loaded. The nice part of this new design is that I can also use whatever process I come up with to also dynamically load business rules as well as authorization rules.</p>
<p>The way I did it in version 3.8 worked well as per type rules were only loaded once in AddAuthorizationRules. As rules rarely change this was excellent. The trick was that I needed to reload them if the user made changes. Loading rules every time they are used makes it a lot easier to deal with user changes but performance could be an issue.&nbsp;</p>
<p>I have always wondered how programmers were able to&nbsp;anticipate what Roles an application would need and what operations are allowed for each role. I have a large business app and I really can&#39;t see how I could hard code authorizations as every Customer seems to want something different. I think it would be quite valuable to develop a &quot;Dynamic&quot; rule/authorization example for others to use as a starting point for this kind of thing. If I come up with something decent I will post it.&nbsp;</p>
<p>Wayne&nbsp;</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
