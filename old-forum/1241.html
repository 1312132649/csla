<html><header><title>Handling e.value = nothing</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Handling e.value = nothing</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1241.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>MadGerbil posted on Monday, September 18, 2006</h2><P>On a csla datasource UpdateObject event if an e.value is nothing and I try to convert it to a string I get an error.&nbsp; This happens when an object populated with string values is bound to the webform and the user deletes all the text in one of the bound textboxes.&nbsp; </P>
<P>The empty string causes the following to error:</P>
<P>child.EmployeeName = (Ctype(e.Values("EmployeeName"), String))</P>
<P>How should this be handled?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MadGerbil replied on Monday, September 18, 2006</h2>What is bizzare about this to me is that the InsertObjectArgs returns an empty string "" if the value is left blank.&nbsp; The UpdateObjectArgs returns Nothing.&nbsp; Because of this, one handles the empty strings and the other does not.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, September 18, 2006</h2>Yeah, I've run into that as well. It appears that ASP.NET data binding is kindly changing empty string values to Nothing/null. Rather a PITA if you ask me...<br><br>The only solution I'm aware of in C# is to check for the null, but in VB life is a bit simpler because VB will help you out if you use the VB runtime:<br><br>child.EmployeeName = CStr(e.Values("EmployeeName"))<br><br>If you dislike using the Basic runtime, then you can write the code C#-style:<br><br>If e.Values("EmployeeName") IsNot Nothing Then<br>&nbsp; child.EmployeeName = DirectCast(e.Values("EmployeeName"), String)<br>End If<br><br>Obviously, without a bit of optimization, this second approach is slower because it requires two dictionary lookups, so what you really need is a temporary variable. Then you can use TryCast:<br><br>Dim tmp As String = TryCast(e.Values("EmployeeName"), String)<br>If tmp IsNot Nothing Then<br>&nbsp; child.EmployeeName = tmp<br>End If<br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
