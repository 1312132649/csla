<html><header><title>Create RestPortal as alternative to WcfPortal</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Create RestPortal as alternative to WcfPortal</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/12715.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>_pisees_ posted on Wednesday, August 06, 2014</h2><p>I am exploring the idea of creating a RestPortal based on WcfPortal to simplify creating a Web API for HTML + Angular client. WcfPortal has quite a simple API: Create, Delete, Update, Fetch, which should be easy to duplicate in a Web API. Any thoughts on pros and cons of this? Any pointers on how could simplify project or roadblocks may encounter?</p>
<p>Thanks, Kurt</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Wednesday, August 06, 2014</h2><p>You may want to look at the HttpProxy and host classes in 4.5.600. In ASP.NET 5 the host is a Web API endpoint, and in ASP.NET 4 it is an MVC controller (because Web API didn&#39;t yet do all the necessary threading stuff).</p>
<p>Technically this isn&#39;t 100% RESTful because the data portal itself isn&#39;t actually restful. The data portal transfers a self-describing binary payload from the client to the server, and the server processes that payload based on the data _inside_ the binary blob. REST says that the request should be processed based on the GET/POST/PUT/DELETE verb - but in the case of the data portal the &quot;verb&quot; is embedded in the data stream.</p>
<p>And in the data portal&#39;s case there is _always_ a resulting binary blob returned to the client. That resulting blob again is a self-describing payload containing success/failure information and possibly other data of use to the client.</p>
<p>As a result the HttpProxy only makes GET calls to the Web API end point, and always passes what should be viewed as binary blobs to/from the server.</p>
<p>In your case you&#39;d want to pass JSON data to/from the service end point, but the basic concepts remain the same as HttpProxy.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>_pisees_ replied on Wednesday, August 06, 2014</h2><p>Thanks very much Rocky. </p>
<p>I am reviewing HttpPortal and it looks like I will have to modify implementation to work with JSON. That existing HttpPortal transfers binary payload for a .NET client, and not for JavaScript Client (like HTTP + Angular). Is that correct?</p>
<p>Because HttpPortal.InvokePortal use of MobileFormatter will not deserialize JSON to a CriteriaRequest</p>
<p><span style="font-size:x-small;font-family:Consolas;color:#008000;"><span style="font-size:x-small;font-family:Consolas;color:#008000;"><span style="font-size:x-small;font-family:Consolas;color:#008000;">
<p>// var request = MobileFormatter.Deserialize(buffer.ToArray());</p>
</span></span></span></p>
<p>For example the following from client</p>
<p>[POST] <a href="http://[server]/Mvc5AppServer/api/DataPortal?operation=fetch">http://[server]/Mvc5AppServer/api/DataPortal?operation=fetch</a></p>
<p>[PAYLOAD]{&quot;typeName&quot;:&quot;Library.Net.Library.CustomerEdit&quot;,&quot;criteriaData&quot;:null,&quot;principal&quot;:null,&quot;globalContext&quot;:null,&quot;clientContext&quot;:null,&quot;clientCulture&quot;:&quot;&quot;,&quot;clientUICulture&quot;:&quot;&quot;,&quot;isBusy&quot;:false,&quot;isSelfBusy&quot;:false}</p>
<p>&nbsp;-Kurt</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, August 12, 2014</h2><p>I think you&#39;re going about this the wrong way.&nbsp; You should not attempt to deserialize a Csla object directly as the result of a web service call.&nbsp; Instead you should map your Csla object to&nbsp;other objects (I&#39;ll call&nbsp;them DTOs) that represents the request / response data.&nbsp; Please see this page (it also includes a link to a forum post which has a deeper explaination):&nbsp; <a href="http://www.lhotka.net/cslanet/faq/ObjectsAsServiceContract.ashx">http://www.lhotka.net/cslanet/faq/ObjectsAsServiceContract.ashx</a></p>
<p>Also, I don&#39;t think that POST&nbsp;<a href="http://[server]/Mvc5AppServer/api/DataPortal?operation=fetch"><span style="color:#3366cc;">http://[server]/Mvc5AppServer/api/DataPortal?operation=fetch</span></a>&nbsp;would be considered restful.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>_pisees_ replied on Saturday, August 23, 2014</h2><p>As I understand, CSLA supports clients like Silverlight, WPF, Windows Forms by supplying client-side logic that leverages mobile objects that run on the client. There is no need to create DTO because the Framework takes care of creating these mobile objects which supply client-side data binding, validation etc., logic for communicating with the server and sterilizing data needed. I am trying to do the same thing but wit HTML+Angular+JSON -- in effect support a new non .NET client. I realize that creating all the client-side functionality in JavaScript may be a large project, but my questions are related to how much I&nbsp;could achieve by modifying HttpPortal.&nbsp;</p>
<p>&nbsp;</p>
<p>Any thoughts appreciated,</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
