<html><header><title>GlobalContext, ClientContext, LocalContext in ASP.Net land</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>GlobalContext, ClientContext, LocalContext in ASP.Net land</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11600.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>joemorin73 posted on Wednesday, September 26, 2012</h2><p>I have two questions:</p>
<ol>
<li>In the ASP.Net scope of things, GlobalContext, ClientContext, LocalContext appear to be the same.&nbsp; The three store to the current HttpContext Items collection and are limited to the users session.&nbsp; Is this correct?</li>
<li>Is there a an API like context that would store to the application domain?&nbsp; (either Cache or Application in ASP.Net)&nbsp; I know I can directly access these on the ASP.Net, but I wouldn&#39;t mind a preexisting api so it can operate in both an ASP and non ASP environment.</li>
</ol></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Wednesday, September 26, 2012</h2><p>In a 2-tier web deployment you are correct.</p>
<p>In a 3-tier web deployment, where the web server communicates with an app server, then GlobalContext and ClientContext obviously provide different capabilities from LocalContext.</p>
<p>In any case, web and app servers are stateless, so once the client request processing is done, everything in memory on the server(s) goes away. That includes all three context dictionaries.</p>
<p>If you need to maintain state on your web server between client requests, you&#39;ll need to use standard ASP.NET state management features, such as Session. Of course there are a lot of downsides to maintaining state between client requests, and most web experts would strongly discourage such an approach. At the same time, people _do_ use Session, and I&#39;m sure they sleep OK at night :)</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>joemorin73 replied on Wednesday, September 26, 2012</h2><p>This appears to be a problem.&nbsp; It seems that the ClientContext seem to live past the page life.&nbsp; IE, living as long as the session.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Wednesday, September 26, 2012</h2><p>You must make sure that Csla.Web.dll is deployed to the website.&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, September 26, 2012</h2><p>The default context provider uses thread local storage, which is great for pure .NET environments. This will NOT work in an ASP.NET environment due to the way ASP.NET manages its threads.</p>
<p>The ASP.NET context provider (automatically used if Csla.Web.dll is in your web server&#39;s bin folder) uses HttpContext to manage all context dictionaries and the User value.</p>
<p>So Jonny is correct, if you have Csla.Web.dll in your bin directory then you should see the correct behavior.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>joemorin73 replied on Wednesday, September 26, 2012</h2><p>Interesting.&nbsp; I did forget to put the Csla.Web in the Web application.&nbsp; The fact that the Thread collection worked surprises me and scares me at the same time.&nbsp; Ok.</p>
<p>That said, Csla has no API that will use Application and/or Session. Which is fine, I can have my own.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
