<html><header><title>Insert multiple child objects fails with DTC error</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Insert multiple child objects fails with DTC error</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2485.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>awsisme posted on Wednesday, March 07, 2007</h2><P>I've got a child collection inside a root object. I can add a single new child item to the collection, save it and everything works fine. As soon as I add two items, then save, I get a DTC error. It appears to be transaction related and throws an exception on the cn.open() the second time it's called. As soon as I remove the <FONT color=#008000><FONT size=2>[Transactional(TransactionalTypes.TransactionScope)]&nbsp;&nbsp;</FONT><FONT face=Arial color=#000000><FONT face="Times New Roman">from DataPortal_Insert everything works fine.&nbsp;</FONT></FONT></FONT></P>
<P><FONT color=#000000>I'm sure I'm screwing something up with the transactions but can't figure out what. Any help would be appreciated.</FONT></P>
<P><FONT color=#008000><FONT face=Arial color=#000000 size=2></FONT></FONT>&nbsp;</P>
<P><FONT color=#008000><FONT face=Arial color=#000000 size=2>Andy</FONT></P></FONT><FONT size=2></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, March 07, 2007</h2>Only use one connection if you're using TS.&nbsp; Opening more than one connection, even with the same connection string, will promote the transaction to a distributed transaction.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, March 07, 2007</h2>I've added this to the <a HREF="/forums/12915/ShowThread.aspx#12915">FAQ</a>.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>awsisme replied on Wednesday, March 07, 2007</h2><P>Thank you. I had read your similar response to an earlier post but didn't think it was the same problem. Having one of those failure to connect the dots kind of days.</P>
<P>&nbsp;</P>
<P>Thanks again.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
