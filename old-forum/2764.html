<html><header><title>child objets on the database side</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>child objets on the database side</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2764.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jhw posted on Tuesday, April 24, 2007</h2><P>Loading child object data from the&nbsp;database:</P>
<P>Standard procedure is for the parent objects fetch sproc to load the data for the child object.</P>
<P>Currently I manually put in the sql for getting the child objects data. Seems like poor re-use and encapsulation.</P>
<P>So I was thinking of using a user defined function(udf) that would get the child data, and call&nbsp;the udf&nbsp;within the parent objects sproc. Can than select * from the table returned by the udf. But using * is not optimized. Is there another way of doing it.</P>
<P>While not optimized, it does give some encapsulation which would be great.</P>
<P>&nbsp;</P>
<P>Thanks </P>
<P>&nbsp;</P>
<P>Heath</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jhw replied on Tuesday, April 24, 2007</h2>So I used this system to load a collection of child objects, each of which contains a grandchild.<br><br>I selected all of the grandchildren 1st, using user defined function(though another sproc would work).<br><br>Then I loaded all the children. I only had to select the id of the grandchild. This cleaned up my sproc nicely, as well as giving me re-use for loading the grandchild objects.<br><br>Now back in csla, when loading the 1st level children, I pass the collection of grandchildren into the fetch method, allowing the child to pick out the target grandchild.<br><br>This works back into an earlier post about loading grandchildren.<br><br>It worked very well, but of course it is not optimized int sql server as I need to use a select * from [user defined function]. <br><br>It sounds like a lot of work, but if an object is a child of several other objects, it is nice to only have 1 sproc or udf to change in the db if the child object changes.<br><br><font color="#0000ff"><font color="#ffa500">select * from dbo.udf_JobBearingPacks(@Id)</font><br>&nbsp;&nbsp;&nbsp; --get the job motors<br>&nbsp;&nbsp;&nbsp; select jm.Id, Abh, Bottom, HasBeenJobOrdered, InspectionRateToOilCompany, JobId,<br>&nbsp;&nbsp;&nbsp; Lobe, MinUnits, NqlInspectionChargeAmount, OilCompanyInvoiceId,<br>&nbsp;&nbsp;&nbsp; RentalRateToOilCompany, Stage, UnitsUsed, MotorReplacementCostToOilCompany, MotorNeedsReplacement,<br>&nbsp;&nbsp;&nbsp; MotorReplacementJobCost,<br>&nbsp;&nbsp;&nbsp; --get the info for the nql insp cx invoice obj<br>&nbsp;&nbsp;&nbsp; nii.Id, nii.Gst,&nbsp; nii.InvoiceNumber, cinv.Id, cinv.BusinessName,<br>&nbsp;&nbsp;&nbsp; <font color="#ff0000">--get the info for the bearing pack. Get rid of for now while trying new system,<br>&nbsp;&nbsp;&nbsp; --and replace with just a list of the id's so class can know which one to load<br>&nbsp;&nbsp;&nbsp; dm.Id,</font><br>&nbsp;&nbsp;&nbsp; --dm.Id,&nbsp;&nbsp; dm.SerialNumber, dm.Description,&nbsp; dm.MotorSize<br>.....</font><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
