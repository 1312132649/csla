<html><header><title>Is this a bug? Calling BeginEdit() followed by CancelEdit() results in IsDirty being true</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Is this a bug? Calling BeginEdit() followed by CancelEdit() results in IsDirty being true</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10623.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jaans posted on Wednesday, August 17, 2011</h2><p>Hi Gang</p>
<p>I&#39;ve just ran into an issue under Silverlight where I found that calling .BeginEdit() followed by a CancelEdit() results a clean object (IsDirty = false) becoming dirty (IsDirty = true)?</p>
<p>I&#39;m not sure, it could be by design (not&nbsp;sure why&nbsp;though),&nbsp;but this feels like a bug to me.<br /><br />Using Silverlight 4 with CSLA 4.1.0</p>
<p>Thanks,<br />Jaans</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Wednesday, August 17, 2011</h2><p>I don&#39;t see the problem with this code:</p>
<pre style="font-family:Consolas;background:white;color:black;font-size:13px;">&nbsp;&nbsp;&nbsp;&nbsp;[<span style="color:#2b91af;">TestMethod</span>]<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">public</span>&nbsp;<span style="color:blue;">void</span>&nbsp;CancelEditRoundTripsIsDirty()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">var</span>&nbsp;obj&nbsp;=&nbsp;<span style="color:blue;">new</span>&nbsp;<span style="color:#2b91af;">Root</span>();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj.Clean();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">Assert</span>.IsFalse(obj.IsDirty,&nbsp;<span style="color:#a31515;">&quot;Before&nbsp;edit&quot;</span>);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj.BeginEdit();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">Assert</span>.IsFalse(obj.IsDirty,&nbsp;<span style="color:#a31515;">&quot;After&nbsp;begin&nbsp;edit&quot;</span>);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;obj.CancelEdit();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">Assert</span>.IsFalse(obj.IsDirty,&nbsp;<span style="color:#a31515;">&quot;After&nbsp;cancel&nbsp;edit&quot;</span>);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /></pre>
<p>The Root class is this:</p>
<pre style="font-family:Consolas;background:white;color:black;font-size:13px;">&nbsp;&nbsp;[<span style="color:#2b91af;">Serializable</span>]<br />&nbsp;&nbsp;<span style="color:blue;">public</span>&nbsp;<span style="color:blue;">class</span>&nbsp;<span style="color:#2b91af;">Root</span>&nbsp;:&nbsp;<span style="color:#2b91af;">BusinessBase</span>&lt;<span style="color:#2b91af;">Root</span>&gt;<br />&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">public</span>&nbsp;<span style="color:blue;">static</span>&nbsp;<span style="color:blue;">readonly</span>&nbsp;<span style="color:#2b91af;">PropertyInfo</span>&lt;<span style="color:blue;">string</span>&gt;&nbsp;DataProperty&nbsp;=&nbsp;RegisterProperty&lt;<span style="color:blue;">string</span>&gt;(c&nbsp;=&gt;&nbsp;c.Data);<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">public</span>&nbsp;<span style="color:blue;">string</span>&nbsp;Data<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">get</span>&nbsp;{&nbsp;<span style="color:blue;">return</span>&nbsp;GetProperty(DataProperty);&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">set</span>&nbsp;{&nbsp;SetProperty(DataProperty,&nbsp;<span style="color:blue;">value</span>);&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">public</span>&nbsp;<span style="color:blue;">void</span>&nbsp;Clean()<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MarkClean();<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;}<br /></pre></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jaans replied on Wednesday, August 17, 2011</h2><p>Apologies Rocky</p>
<p>It would seem that an overrides of OnChildChanged method is calling PropertyHasChanged (which I do to enable triggering of business rules&nbsp;on parent objects in response to changes in grand-child objects).</p>
<p>Again, my bad!</p>
<p>CSLA is cancelling the edit correctly.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
