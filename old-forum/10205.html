<html><header><title>Migrating from CSLA 3.5 to 3.8.3 exception</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Migrating from CSLA 3.5 to 3.8.3 exception</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10205.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>leocharrua posted on Friday, March 25, 2011</h2><p><span><span title="Yo he migrado de CSLA 3.5 a 3.8.3 y he encontrado problemas.">I have migrated from CSLA 3.5 to 3.8.3 and have encountered problems.</span><span title="CommonRules.IntegerMinValue lanza una excepci&oacute;n con propiedades del tipo Int16.">CommonRules.IntegerMinValue throws an exception with properties of type Int16.&nbsp;</span><span title="Con la versi&oacute;n 3.5 no pasaba.">With version 3.5 does not happen.&nbsp;</span></span></p>
<p><span><span title="Con la versi&oacute;n 3.5 no pasaba.">
<p>El c&oacute;digo de usuario no control&oacute; Csla.Server.DataPortalException</p>
<p>&nbsp;&nbsp;Message=&quot;DataPortal.Fetch fall&oacute; en el servidor&quot;</p>
<p>&nbsp;&nbsp;Source=&quot;Csla&quot;</p>
<p>&nbsp;&nbsp;StackTrace:</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en Csla.Validation.ValidationRules.CheckRules(List`1 list) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Validation\ValidationRules.cs:l&iacute;nea 1187</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en Csla.Validation.ValidationRules.CheckRules() en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Validation\ValidationRules.cs:l&iacute;nea 1128</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en SGINMO.Library.InquilinoContrato.GetInquilinoContrato(SafeDataReader dr) en d:\Documentos\_desarrollo\SGINMO\SGINMO.Library\InquilinoContrato.Designer.vb:l&iacute;nea 244</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en SGINMO.Library.ListaHijaInquilinosContrato.Fetch(SafeDataReader dr) en d:\Documentos\_desarrollo\SGINMO\SGINMO.Library\ListaHijaInquilinosContrato.Designer.vb:l&iacute;nea 175</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en SGINMO.Library.ListaHijaInquilinosContrato.GetListaHijaInquilinosContrato(SafeDataReader dr) en d:\Documentos\_desarrollo\SGINMO\SGINMO.Library\ListaHijaInquilinosContrato.Designer.vb:l&iacute;nea 59</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en SGINMO.Library.Contrato.FetchChildren(SafeDataReader dr) en d:\Documentos\_desarrollo\SGINMO\SGINMO.Library\Contrato.Designer.vb:l&iacute;nea 902</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en SGINMO.Library.Contrato.Fetch(SqlCommand cmd) en d:\Documentos\_desarrollo\SGINMO\SGINMO.Library\Contrato.Designer.vb:l&iacute;nea 856</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en SGINMO.Library.Contrato.DataPortal_Fetch(Criteria crit) en d:\Documentos\_desarrollo\SGINMO\SGINMO.Library\Contrato.Designer.vb:l&iacute;nea 827</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en dm(Object , Object[] )</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en Csla.Reflection.MethodCaller.CallMethod(Object obj, DynamicMethodHandle methodHandle, Object[] parameters) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Reflection\MethodCaller.cs:l&iacute;nea 357</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en Csla.Reflection.MethodCaller.CallMethod(Object obj, DynamicMethodHandle methodHandle, Object[] parameters) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Reflection\MethodCaller.cs:l&iacute;nea 361</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en Csla.Reflection.MethodCaller.CallMethod(Object obj, String method, Object[] parameters) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Reflection\MethodCaller.cs:l&iacute;nea 270</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en Csla.Reflection.LateBoundObject.CallMethod(String method, Object[] parameters) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Reflection\LateBoundObject.cs:l&iacute;nea 86</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en Csla.Server.SimpleDataPortal.Fetch(Type objectType, Object criteria, DataPortalContext context) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Server\SimpleDataPortal.cs:l&iacute;nea 125</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en Csla.Server.SimpleDataPortal.Fetch(Type objectType, Object criteria, DataPortalContext context) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Server\SimpleDataPortal.cs:l&iacute;nea 154</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en Csla.Server.DataPortalSelector.Fetch(Type objectType, Object criteria, DataPortalContext context) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Server\DataPortalSelector.cs:l&iacute;nea 80</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en Csla.Server.DataPortal.Fetch(Type objectType, Object criteria, DataPortalContext context) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Server\DataPortal.cs:l&iacute;nea 194</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en Csla.Server.Hosts.RemotingPortal.Fetch(Type objectType, Object criteria, DataPortalContext context) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Server\Hosts\RemotingPortal.cs:l&iacute;nea 37</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en System.Runtime.Remoting.Messaging.StackBuilderSink._PrivateProcessMessage(IntPtr md, Object[] args, Object server, Int32 methodPtr, Boolean fExecuteInContext, Object[]&amp; outArgs)</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en System.Runtime.Remoting.Messaging.StackBuilderSink.PrivateProcessMessage(RuntimeMethodHandle md, Object[] args, Object server, Int32 methodPtr, Boolean fExecuteInContext, Object[]&amp; outArgs)</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; en System.Runtime.Remoting.Messaging.StackBuilderSink.SyncProcessMessage(IMessage msg, Int32 methodPtr, Boolean fExecuteInContext)</p>
<p>&nbsp;&nbsp;InnerException: Csla.Reflection.CallMethodException</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; Message=&quot;DataPortal_Fetch la llamada al m&eacute;todo fall&oacute;&quot;</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; Source=&quot;Csla&quot;</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; StackTrace:</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;en Csla.Validation.ValidationRules.CheckRules(List`1 list) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Validation\ValidationRules.cs:l&iacute;nea 1187</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;en Csla.Validation.ValidationRules.CheckRules() en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Validation\ValidationRules.cs:l&iacute;nea 1128</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;en SGINMO.Library.InquilinoContrato.GetInquilinoContrato(SafeDataReader dr) en d:\Documentos\_desarrollo\SGINMO\SGINMO.Library\InquilinoContrato.Designer.vb:l&iacute;nea 244</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;en SGINMO.Library.ListaHijaInquilinosContrato.Fetch(SafeDataReader dr) en d:\Documentos\_desarrollo\SGINMO\SGINMO.Library\ListaHijaInquilinosContrato.Designer.vb:l&iacute;nea 175</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;en SGINMO.Library.ListaHijaInquilinosContrato.GetListaHijaInquilinosContrato(SafeDataReader dr) en d:\Documentos\_desarrollo\SGINMO\SGINMO.Library\ListaHijaInquilinosContrato.Designer.vb:l&iacute;nea 59</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;en SGINMO.Library.Contrato.FetchChildren(SafeDataReader dr) en d:\Documentos\_desarrollo\SGINMO\SGINMO.Library\Contrato.Designer.vb:l&iacute;nea 902</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;en SGINMO.Library.Contrato.Fetch(SqlCommand cmd) en d:\Documentos\_desarrollo\SGINMO\SGINMO.Library\Contrato.Designer.vb:l&iacute;nea 856</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;en SGINMO.Library.Contrato.DataPortal_Fetch(Criteria crit) en d:\Documentos\_desarrollo\SGINMO\SGINMO.Library\Contrato.Designer.vb:l&iacute;nea 827</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;en dm(Object , Object[] )</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;en Csla.Reflection.MethodCaller.CallMethod(Object obj, DynamicMethodHandle methodHandle, Object[] parameters) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Reflection\MethodCaller.cs:l&iacute;nea 357</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;en Csla.Reflection.MethodCaller.CallMethod(Object obj, DynamicMethodHandle methodHandle, Object[] parameters) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Reflection\MethodCaller.cs:l&iacute;nea 361</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;en Csla.Reflection.MethodCaller.CallMethod(Object obj, String method, Object[] parameters) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Reflection\MethodCaller.cs:l&iacute;nea 270</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;en Csla.Reflection.LateBoundObject.CallMethod(String method, Object[] parameters) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Reflection\LateBoundObject.cs:l&iacute;nea 86</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;en Csla.Server.SimpleDataPortal.Fetch(Type objectType, Object criteria, DataPortalContext context) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Server\SimpleDataPortal.cs:l&iacute;nea 125</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; InnerException: Csla.Validation.ValidationException</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Message=&quot;La regla de validaci&oacute;n rule://Csla.Validation.CommonRules/IntegerMinValue/Orden?MinValue=0&amp;Format= fall&oacute; en la propiedad Orden&quot;</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Source=&quot;Csla&quot;</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;StackTrace:</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; en Csla.Validation.ValidationRules.CheckRules(List`1 list) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Validation\ValidationRules.cs:l&iacute;nea 1187</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; en Csla.Validation.ValidationRules.CheckRules() en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Validation\ValidationRules.cs:l&iacute;nea 1128</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; en SGINMO.Library.InquilinoContrato.GetInquilinoContrato(SafeDataReader dr) en d:\Documentos\_desarrollo\SGINMO\SGINMO.Library\InquilinoContrato.Designer.vb:l&iacute;nea 244</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; en SGINMO.Library.ListaHijaInquilinosContrato.Fetch(SafeDataReader dr) en d:\Documentos\_desarrollo\SGINMO\SGINMO.Library\ListaHijaInquilinosContrato.Designer.vb:l&iacute;nea 175</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; en SGINMO.Library.ListaHijaInquilinosContrato.GetListaHijaInquilinosContrato(SafeDataReader dr) en d:\Documentos\_desarrollo\SGINMO\SGINMO.Library\ListaHijaInquilinosContrato.Designer.vb:l&iacute;nea 59</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; en SGINMO.Library.Contrato.FetchChildren(SafeDataReader dr) en d:\Documentos\_desarrollo\SGINMO\SGINMO.Library\Contrato.Designer.vb:l&iacute;nea 902</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; en SGINMO.Library.Contrato.Fetch(SqlCommand cmd) en d:\Documentos\_desarrollo\SGINMO\SGINMO.Library\Contrato.Designer.vb:l&iacute;nea 856</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; en SGINMO.Library.Contrato.DataPortal_Fetch(Criteria crit) en d:\Documentos\_desarrollo\SGINMO\SGINMO.Library\Contrato.Designer.vb:l&iacute;nea 827</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; en dm(Object , Object[] )</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; en Csla.Reflection.MethodCaller.CallMethod(Object obj, DynamicMethodHandle methodHandle, Object[] parameters) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Reflection\MethodCaller.cs:l&iacute;nea 357</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;InnerException: System.InvalidCastException</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Message=&quot;La conversi&oacute;n especificada no es v&aacute;lida.&quot;</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Source=&quot;Csla&quot;</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; StackTrace:</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;en Csla.Validation.CommonRules.IntegerMinValue(Object target, RuleArgs e) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Validation\CommonRules.cs:l&iacute;nea 479</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;en Csla.Validation.RuleMethod.Invoke(Object target) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Validation\RuleMethod.cs:l&iacute;nea 103</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;en Csla.Validation.ValidationRules.CheckRules(List`1 list) en d:\Documentos\_desarrollo\csla-3.8.3\cslacs\Csla\Validation\ValidationRules.cs:l&iacute;nea 1177</p>
<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; InnerException:&nbsp;</p>
<p>&nbsp;</p>
</span></span></p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>ajj3085 replied on Sunday, March 27, 2011</h2><p>Can you put a breakpoint into the Csla rule?&nbsp;&nbsp; The exception is an invalid cast, I&#39;d like to know what&#39;s being cast.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>leocharrua replied on Sunday, March 27, 2011</h2><p>The exception is throw in function&nbsp;IntegerMinValue</p>
<p>in line: &nbsp;&nbsp;<b>int value = (int)Utilities.CallByName(target, e.PropertyName, CallType.Get);</b></p>
<p>casting int16 (type of the property) to int.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Sunday, March 27, 2011</h2><p>Hmm, I&#39;d check to ensure e.PropertyName is correct.&nbsp; Also, check what Utilities.CallByName returns.</p>
<p>Casting an int16 to an int32 should not result in an exception.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>leocharrua replied on Monday, March 28, 2011</h2><p><span><span title="Haz clic para obtener traducciones alternativas" class="hps">I found the</span>&nbsp;<span title="Haz clic para obtener traducciones alternativas" class="hps">explanation here:</span><br /><br /><a href="http://weblogs.sqlteam.com/mladenp/archive/2006/12/04/41013.aspx">http://weblogs.sqlteam.com/mladenp/archive/2006/12/04/41013.aspx</a></span></p>
<p><span title="Haz clic para obtener traducciones alternativas" class="hps">I think</span>&nbsp;<span title="Haz clic para obtener traducciones alternativas" class="hps">that</span>&nbsp;<span title="Haz clic para obtener traducciones alternativas" class="hps">should</span>&nbsp;<span title="Haz clic para obtener traducciones alternativas" class="hps">be considered a</span>&nbsp;<span title="Haz clic para obtener traducciones alternativas" class="hps">bug</span><span title="Haz clic para obtener traducciones alternativas">.</span></p>
<p><span title="Haz clic para obtener traducciones alternativas"><br /></span></p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>ajj3085 replied on Monday, March 28, 2011</h2><p>Just use the MaxValue&lt;T&gt; rule, and specify short.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
