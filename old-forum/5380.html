<html><header><title>DevExpress XtraGrid ChildCollection, AddNewRecord</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>DevExpress XtraGrid ChildCollection, AddNewRecord</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5380.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jurjen posted on Wednesday, September 10, 2008</h2><DIV class=ForumPostContentText id=ctl00_ctl01_bcr_ctl00___PostRepeater_ctl04_PostViewWrapper>
<P>Hello,</P>
<P><BR>I'm using DevExpress XtraGrid (8.2.1) in my windows-application and am having some problems with child-collections. Editing is working just fine, but when adding a new child to the childcollection using the 'NewItemRowPosition' so the new record will be inserted by the grid, strange things happen, the first keystroke (or selected date in dateEdit) is discarded, while adding items in a similar fashion to a EditableRootCollection works just fine.</P>
<P>I was just wondering if anyone here had maybe solved this problem already, so I won't have to. <IMG alt="Big Smile <img src=" />" src="/emoticons/emotion-2.gif"></P>
<P><BR>TIA,<BR>Jurjen.</P></DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>andy replied on Thursday, September 11, 2008</h2><P>Hi TIA,</P>
<P>I just started testing xtrgrid for my new project.<BR>Would be interested to know all the sharp&nbsp;edges that you may have using the component.:)</P>
<P>Andy</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jurjen replied on Thursday, September 11, 2008</h2><P>TIA = Thanks In Advance.... :-) </P>
<P>Well Andy,</P>
<P>I have subclassed all DevExpress controls that I use in my project, which is (I think) a good way to get uniformity on controls within a project. Except for the problem as explained in my message I'm not encountering any real problems, I find that it works just fine.</P>
<P>Jurjen</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>andy replied on Thursday, September 11, 2008</h2><P>I just learned a new acronym today! :)</P>
<P>I just love their GUI.&nbsp; Their skinning looks and feels UI feature just rocks.&nbsp; <BR>One question, where did purchase your dx component.<BR>I notice componentsource offers a cheaper deal.<BR>Not sure&nbsp;I will get&nbsp;the same support level for it.<BR>Tks for the tip.</P>
<P>Andy</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Curtmantle replied on Thursday, September 11, 2008</h2>The DevExpress components are excellent by-and-large. The documentation sucks a bit which leaves you battling with trial and error a lot of the time - but they are extremely good components.<br><br>I haven't encountered the problem mentioned but that might be because I go about things differently in terms of design and use. The one thing you do need to remember when you want to add rows via a grid is to override the AddNewCore function in your BindingList derived class. Apart from that I haven't had any serious problems... although it's early days in my project! <br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jurjen replied on Saturday, September 20, 2008</h2><P>Well, as it turns out the problem was not with Devexpress controls and also no with Csla but with code in my subclasses wich inherit from csla. When adding a child to my childcollection I set the foreign key to the parent during the AddNewCore(), here the value for property fkOrderId is set, wich raises the propertychanged event, when this 'SetForeignKey' code is commented out, the problem goes away.</P>
<P>&nbsp;</P>
<P>Jurjen</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Saturday, September 20, 2008</h2><P>Is this a master-detail grid editing scenario? We use the DevExpress suite also -- I'm just trying to envision the particular U/I design that is leading to your problem.</P>
<P>In our case, the XtraGrid works great with an editable root, but if that root has children and you use a master-detail grid, the ERLB saves the root item when you click on a child row, effectively orphaning the child items. We haven't solved this and so don't use this feature except for read-only scenarious.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jurjen replied on Saturday, September 20, 2008</h2><P>No it's not. It's a root object with a child collection, only the child-collection is bound to the XtraGrid.<BR>But it's working fine now..</P>
<P>In your scenario, what type of datatype do you use for your keys, Guid or Int&nbsp;? <BR>I use guids, and when a new child is created I call a method called 'SetForeignKey(businessobject parent)' on the child, thereby setting it's foreign key to the parent, that way, when the child-collection is saved, no 'orphans' are created. If you use Int as foreign key, then you should call Setforeignkey on new children after you've saved the parent and know what the Int value the database assigned to the Primary Key or ID-field, so it can be assigned to the foreign key field of the children.<BR><BR>I think this should also work in a Master-Detail grid.</P>
<P>Jurjen</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Saturday, September 20, 2008</h2><P>My keys are int (autonumbering in various flavors, from sequences in Oracle, IDENTITY in SQL Server, autonumber in Access). </P>
<P>I'm currently using CSLA 3.0.x, and since I'm responsible for doing all the child object saving in this version of CSLA&nbsp;(at least I think that is the case ;) , I was setting the parent foreign key of child objects when the parent object is saved.&nbsp; Each BO saves itself first, then traverses child objects and saves them if they are new/dirty and updates their parent foreign key value automatically. </P>
<P>For a child list, I wasn't using an editable root&nbsp;list&nbsp;but instead a BusinessListBase derived class, so the grid shouldn't "save" those objects. </P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
