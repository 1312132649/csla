<html><header><title>Connection/Transaction Manager in SQL 2000</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Connection/Transaction Manager in SQL 2000</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6703.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal posted on Tuesday, March 31, 2009</h2>Hi Rocky!<br><br>I've been working on CslaGen for 3.x and I found a small issue. The plan is to use Connection and Transaction Managers, but there's an edge case where they create a problem. Sometimes during a read process (datareader) you need to retrieve additional data (lookups, readonly collections, etc). This is not a huge problem With SQL &gt;= 2005 since they can work with multiple active result sets (provided you set it up correctly), but there's no way to work around it in SQL 2000.<br><br>I think a simple solution to the problem would be to add an extra parameter to the GetManager methods so that we can specify a context name (optional, of course).<br><br>That way, we can create different contexts with different connections that ultimately use the same connection string.<br><br>Would you consider adding something like this?<br><br>Thanks<br><br>Andr√©s<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Blarm replied on Tuesday, March 31, 2009</h2><P>That's the same problem that I have.</P>
<P>Its very common to have to do additional lookups during a fetch and unless you have MARS with SQL2005 or higher you get the problem. SQL2000 does not even support MARS.</P>
<P>I agree with Andres that it would be a good change to the framework.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Marjon1 replied on Tuesday, March 31, 2009</h2>I would like to see this as well. It is very useful in the edge cases when you need it.<br /><br />The current connection manager class that I implemented myself in 2.x has this and would like to see the same functionality when we (finally) upgrade to 3.x</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, March 31, 2009</h2>I'll add this to the wish list, it is a good idea.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
