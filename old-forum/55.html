<html><header><title>Localisation Rule descriptions</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Localisation Rule descriptions</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/55.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>SealedClassSingleton posted on Wednesday, May 10, 2006</h2><P>Hi,</P>
<P>I'm living in Belgium wherer some apps have to be multilanguage. Depending on the user's preferences the user's native language is selected (I cann't rely on the culture, since the choosen language has to be&nbsp;changed while the app is running, and all controls has to (re) localise themselves).</P>
<P>I'm using version 2.0 of the CSLA FW. When&nbsp;I do some validation, the databinding and errorprovider are working fine in the intended manner. However, I want to localise the description of the custom rules. Any idea what could be the best way to do this ? </P>
<P>I was thinking of&nbsp; putting an XML fragment into the rule description and returning a localised attribute value depending on the current language when retrieving the error information from the IDataErrorInfo in the BusinessBase class.</P>
<P>At first sight, I don't see any possibility to do some transation on the UI layer, since the extended properties on the controls (e.g. error on errorprovider...) are'nt updated via the setError method...</P>
<P>Any&nbsp;suggestions / opinions ?<FONT color=#0000ff size=5></P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, May 10, 2006</h2><P>I suggest that you use a resource file just like I do in CSLA .NET itself. The thread object has a UICulture property that controls the current culture to be used by the application. This defaults to the machine's culture, but you can change it through code.</P>
<P>The localization support built into Windows Forms is based on resource files and the UICulture as well, so this approach would let you use the features already built by Microsoft.</P>
<P>You can look at the CommonRules class in CSLA to see how I used the resource file to get at localized strings for the rule descriptions.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ksavoie replied on Tuesday, March 29, 2011</h2><p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">Hi</span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">I know this is an old posting, but I&#39;m looking into using the Localization in my custom Validation rules.</span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">Would it be possible to get an example on how it would be done.&nbsp; I&#39;ve created my custom Validation rules ok and they work fine.&nbsp; I using windows form (vb.net 2005 with CSLA 2.0), and my users have the option to change the language of the application.&nbsp; With this I need to be able to show the error message in the different language.</span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">I&#39;ve used the following code to access the resources files:</span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">&nbsp;</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">Dim</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> mRS </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">As</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> </span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:blue;font-size:10pt;">New</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;"> ResourceManager(</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:maroon;font-size:10pt;">&quot;frmMain&quot;</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">, System.Reflection.Assembly.Load(</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:maroon;font-size:10pt;">&quot;frmMain&quot;</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">))</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;"></span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">And in my custom rule this is the code I&#39;m using:</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;"></span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">e.Description = mRS.GetString(</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:maroon;font-size:10pt;">&quot;Invoice_Name&quot;</span><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">)</span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">When I do this, I get a Fetch failed (DataPortal.Fetch failed, Message: &quot;Exception has been thrown by the target of an invocation.&quot;).&nbsp; I&#39;ve tried a few things, and when I thought I had the right code, I was getting a Serialization exception on the save.</span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">So do you think it would be possible to get an example on localization to help&nbsp;me out?</span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">Thanks</span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:10pt;">Kat</span></p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
