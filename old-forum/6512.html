<html><header><title>OT:  WPF UserControl's and commands</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>OT:  WPF UserControl's and commands</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6512.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Thursday, February 26, 2009</h2>Hi,<br><br>I'm trying to create some Wpf user controls, which are focused at editing a single BO.&nbsp; I found a way to have a menu (actually a XamRibbon from Infragistics) host a Save button, and using the Load / Unload events of each control I set the RibbonButton's CommandTarget to the apprpriate object.&nbsp; Save now properly enabled / disables based on the currently viewed UserControl and state of the BO.&nbsp; <br><br>That's fine for standard buttons... but I'd also like some "non-standard" commands.&nbsp; For example, when editing a part, there should be a button that, when clicked, will open the BOM for that part for editing.&nbsp; It doesn't seem like a good idea to have all these buttons that may not even be relevent to the currently viewed BO.&nbsp; Any ideas on how to dynamically create these?&nbsp; I'd like to not tie my impelementation directly to the Ribbon, because I'll likely use these Wpf controls in my existing WinForms app, and I'll want to use the MergeMenu feature found in WinForms controls.<br><br>Any ideas?<br><br>Thanks<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong replied on Friday, February 27, 2009</h2><P>Don't u want to use DelegateCommands, simply bind the command to your xaml button and handle it somewhere else. Not hard tied directly to the Ribbon.</P>
<P>In Composite Application Guidance (Prism)&nbsp;they implimented an extended version DelegateCommands which we are using.</P>
<P><A href="http://msdn.microsoft.com/en-us/library/dd458928.aspx">http://msdn.microsoft.com/en-us/library/dd458928.aspx</A></P>
<P>Maybe i don't understand your problem, as it seems as a bit too easy solution ;)</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, February 27, 2009</h2>Well I'm not using Prism, so I'm not familiar with DelegateCommands.&nbsp; I also don't see how the information in that link helps me add / remove buttons or button groups which aren't relevant to the current document.&nbsp; Could you elaborate a bit more?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong replied on Sunday, March 01, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>Well I'm not using Prism, so I'm not familiar with DelegateCommands.&#160; I also don't see how the information in that link helps me add / remove buttons or button groups which aren't relevant to the current document.&#160; Could you elaborate a bit more?<br></div></BLOCKQUOTE><br /><br />Maybe im spoiled with Prism, saidly u don't use it. But it feels like u are searching for the same functionality a DelegateCommand offers. Anyway like i said i might be misreading your question. Heck, i don't even know what u mean with MergeMenu :)<br /><br />Dynamically create buttons? I don't see the point in doing that, do u have an own abstraction layer over the control sets in WinForms and WPF?<br /><br />Like u wrote in the title of this thread, perhaps it's offtopic for this forum. U could ask your question a bit more specific on a WPF forum somewhere, don't ask me which one ;)<br /><br />channel9?<br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, March 02, 2009</h2><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>rfcdejong:</strong></div><div>Heck, i don't even know what u mean with MergeMenu :)

Dynamically create buttons? I don't see the point in doing that, do u have an own abstraction layer over the control sets in WinForms and WPF?

</div></BLOCKQUOTE><br><br>In WinForms, you can have a MDI Parent window with a Menu, and an MDI Child with a Menu.&nbsp; If they both share the same key, they will be "merged" so that all the MenuItems that are in the parent appear with all the MenuItems in the child when that child is the active MDI window.<br><br>For example, in my main menu on the MDI parent, I have a View toolbar menu.&nbsp; There's a MenuItem for Navigation Bar which is a checkable menu item.&nbsp; It's always there.&nbsp; Also, if you're viewing an invoice in the InvoiceForm MDI child, the're a View Menu that contains a Related Documents.&nbsp; When that child has the focus, the user can click View and both items display.&nbsp; When the MDI child is closed, the Related Documents is removed from the menu.&nbsp; This is all automatic.<br><br>In WPF, there's no more MDI, but you can do "tabbed documents," which is similar to visual studio.&nbsp; In VS 2008, when you have a Code window open, you have the Refactor menu.&nbsp; Close all windows, and Refactor is removed from the menu bar.&nbsp; This is the functionaity I'm trying to achive.<br><br><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>rfcdejong:</strong></div><div>Like u wrote in the title of this thread, perhaps it's offtopic for this forum. U could ask your question a bit more specific on a WPF forum somewhere, don't ask me which one ;)

channel9?</div></BLOCKQUOTE><br><br>This is true... but I think this issue is probably one others have or will come up against.&nbsp; Unless everyone here is building Single Document Interface applications.&nbsp; <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" />&nbsp; The valid choices in Wpf though seem to be SDI or TDI, as MDI has been frowned upon for some time now, even in WinForms.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
