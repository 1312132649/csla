<html><header><title>OT; Triggers and Transactions</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>OT; Triggers and Transactions</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1483.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>cash_pat posted on Saturday, October 14, 2006</h2>Hi,<br><br>I Have 3 Tables<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Parent<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Child<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Balance<br><br>Now in DataPortal_Insert, the Parent BO is updated, then the Child BOs are updated. The Child BO Insert Stored Procedure starts a trigger which references a Column from the Parent Table to update the Balance table.<br><br>I am getting run time errors from SQL on saving my BO. Could someone tell me<br><br>1) has the parent table been updated or the row is temporarily stored somewhere till the transaction commits.<br>2) How can i get the value from the parent table in the child table's trigger<br><br>regards<br><br>Pat cash<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Saturday, October 14, 2006</h2>1) Anything that happens under the auspices of a transaction will be rolled back if a transaction finishes without being committed.<br>2) If you are talking about SQL Server, the Inserted table will give you the values that have been added/updated.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cash_pat replied on Saturday, October 14, 2006</h2>How can a child tables' trigger access rows from the parent table's insert . I mean the inserted in the chlild table's trigger would only contain columns from the child table.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>guyroch replied on Saturday, October 14, 2006</h2><P>Are you using the attribute <SPAN class=ImportantSyntax>[Transactional(TransactionScope)]</SPAN><SPAN class=SiteText>&nbsp; or <SPAN class=ImportantSyntax>[Transactional(Manual)].</SPAN></SPAN></P>
<P><SPAN class=SiteText><SPAN class=ImportantSyntax>If you are using "Manual", then</SPAN><SPAN class=SiteText>&nbsp;you have to _start_ your transaction yourself and because your are updating then you need to make sure that it is started with the IsolationLevel.Serializable AND NOT IsolationLevel.ReadCommitted.</SPAN></SPAN></P>
<P><SPAN class=SiteText><SPAN class=SiteText>If you use either TransactionScope OR IsolationLevel.Serializable&nbsp; then ALL of you update/insert, including triggers, will be part of your db transaction and you should not have any problems.</SPAN></SPAN></P>
<P><SPAN class=SiteText><SPAN class=SiteText>Would help if you can include the error your are having.</SPAN></SPAN></P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
