<html><header><title>Silverlight, ReadOnlyListBase and Managed backing fields</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Silverlight, ReadOnlyListBase and Managed backing fields</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9828.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>pgroenenstein posted on Friday, December 03, 2010</h2><p>Hi</p>
<p>If my understanding is correct CSLA for Silverlight (I&#39;m currently using 3.8.4) has to make use of managed backing fields in order for serialization to work correctly.</p>
<p>My problem is that the &quot;parent&quot; in a read only list does not seem to have acces to &quot;RegisterProperty&quot;. How would one go about to do it the right way then?</p>
<p>My need is such that the &quot;parent&quot; in a read only list has some data that it gets from the DB that needs to be loaded. E.g. I have a &quot;Menu&quot; readonly list(e.g. a &quot;Breakfast Menu&quot; which contains items on a menu( e.g. eggs, toast...etc). While the children in the list has managed backing fields and everything is just A OK there, the &quot;parent&quot; does not seem to have a way to make use of manged backing fields. I need this ability in thre parent to show for example the &quot;time available&quot; and the description of the menu (e.g. &quot;Breakfast&quot; menu)</p>
<p>What is the recommended way then to implement the concept of Managed backing fields in a &quot;readonly list&quot;?</p>
<p>Thank you </p>
<p>Phillip</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pgroenenstein replied on Friday, December 03, 2010</h2><p>I understand that I need to ovverride &quot;OnGetState&quot; and &quot;OnSetState&quot; but it returns an error when I run it. The Error is:</p>
<p>&quot;The key given wasn&#39;t present in the dictionary&quot;. I understand what the error message mean, what I don&#39;t understand what is causing it?</p>
<p>Here is my code, what is wrong here?</p>
<p>&nbsp;&nbsp; Protected Overrides Sub OnGetState(ByVal info As Csla.Serialization.Mobile.SerializationInfo, ByVal mode As Csla.Core.StateMode)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyBase.OnGetState(info, mode)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; info.AddValue(&quot;MyApp.MenuListItem._Descrip&quot;, _Descrip)<br /><br />&nbsp;&nbsp;&nbsp; End Sub<br /><br />&nbsp;&nbsp;&nbsp; Protected Overrides Sub OnSetState(ByVal info As Csla.Serialization.Mobile.SerializationInfo, ByVal mode As Csla.Core.StateMode)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Descrip = info.GetValue(Of String)(&quot;MyApp.MenuListItem._Descrip&quot;)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyBase.OnSetState(info, mode)<br /><br />&nbsp;&nbsp;&nbsp; End Sub</p>
<p>&nbsp;</p>
<p>Thank You</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pgroenenstein replied on Friday, December 03, 2010</h2><p>I would think there is nothing wrong with the code, what I suspect is that &quot;OnGetState&quot; is not putting the variable into to serialzed stream when fetching from the DB..any suggestions why not?</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pgroenenstein replied on Friday, December 03, 2010</h2><p>OK the above samples was put into the &quot;Child&quot; of a readonly list and not into the &quot;parentlist&quot;. I moved that now the code looks like this now...but it still seems not te be loading the var into the serialization string.</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; Protected Overrides Sub OnGetState(ByVal info As Csla.Serialization.Mobile.SerializationInfo)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyBase.OnGetState(info)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; info.AddValue(&quot;MyApp.MenuListItem._Descrip&quot;, _Descrip)<br /><br />&nbsp;&nbsp;&nbsp; End Sub<br /><br />&nbsp;&nbsp;&nbsp; Protected Overrides Sub OnSetState(ByVal info As Csla.Serialization.Mobile.SerializationInfo)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Descrip = info.GetValue(Of String)(&quot;MyApp.MenuListItem._Descrip&quot;)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyBase.OnSetState(info)<br /><br />&nbsp;&nbsp;&nbsp; End Sub</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pgroenenstein replied on Friday, December 03, 2010</h2><p>Can anyone help?...PLEASE!!</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Friday, December 03, 2010</h2><p>The recommended solution is to have a parent object <em>above the list</em> that contains extra properties.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pgroenenstein replied on Friday, December 03, 2010</h2><p>Thanks for the answer Rocky, I&#39;ll probably go that route.</p>
<p>I&#39;m just wondering Why overriding the OnGetState and OnSetState in the readonly list does not seem to work? </p>
<p>Thanks</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pgroenenstein replied on Friday, December 03, 2010</h2><p>Putting a break on &quot;OnGetState&quot; it just never seems to get there.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, December 03, 2010</h2><p>The base classes were created to support mainstream CSLA scenarios. There are no mainstream scenarios that support or enable the use of custom properties on lists.</p>
<p>Keep in mind, we basically had to re-invent serialization to get this to extend into Silverlight, but without the budget to literally recreate everything you can do with BinaryFormatter, etc. So we invented the parts necessary to meet the mainstream/core CSLA scenarios, and have slowly extended from there.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
