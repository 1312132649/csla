<html><header><title>Old-Fashioned Binding method - bound fields not changing</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Old-Fashioned Binding method - bound fields not changing</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1333.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>matt tag posted on Tuesday, September 26, 2006</h2><font face="Verdana" size="1">I'm finally getting into using CSLA 2.0 for a small project, and I'm running into some problems using binding. I haven't learned any of the "new fangled" binding stuff yet (ObjectDataSource, etc), so I'm still just using the older style stuff, where you manually set Databindings and bind a Checkbox to IsDirty.<br><br>I have an object that I'm editing that contains an ID and a Name property, and they're related to each other. The object looks something like this<br><br>readonly property Id as integer<br>get<br>&nbsp; return fID<br>end get<br>end prop<br><br><br></font><font face="Verdana" size="1">readonly property Name as string<br>
get<br>
&nbsp; return fname<br>
end get<br>
end prop<br><br>public sub SetName(nID as int, cName as string)<br>if nID &lt;&gt; fID then<br>&nbsp; fID = nID<br>&nbsp; fName = cName<br><font color="#0000ff">&nbsp; MarkDirty</font><br>endif<br>end sub<br><br>In CSLA 2.0, the MarkDirty doesn't appear to be working correctly. I've got a textbox bound to cName, and a checkbox bound to IsDirty, neither appear to be updated when I call SetName<br><br>matt tag<br><br></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, September 26, 2006</h2>The new binding scheme relies entirely on a PropertyChanged event. So there is no IsDirtyChanged event any longer, and PropertyChanged is never raised for the IsDirty property.<br><br>In other words, the IsDirty checkbox hack won't work...<br><br>If you want to use that approach, you'll need to override OnUnknownPropertyChanged() and raise your own IsDirtyChanged event. You should be able to subclass BusinessBase(Of T) to add this functionality - just make sure to declare your IsDirtyChanged event like I do with the Saved event in BusinessBase in version 2.1.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>matt tag replied on Tuesday, September 26, 2006</h2><font size="1"><font face="Verdana">I don't necessarily need to use the IsDirty hack, I just need to know the minimum set of steps required so that when I change a property value "behind the scenes", any controls bound to that property get updated.<br><br>thanks,<br>matt tag<br></font></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, September 26, 2006</h2>Not sure what you mean by 'change the property behind the scenes,' but typically as long as you raise a propertychanged event for the propery which was changed it will update.&nbsp; <br><br>I stronglly recommend creating a BindingSource component on your form though and bind controls to that.&nbsp; It works much better.<br><br>Databinding is simple. I recommend learning the 'new' way is its all done via the designer, meaning less code you have to maintain.&nbsp; Create an object Data Source and base it on your BO class.&nbsp; Set the DataSource on the BindingSource to this newly created data source.<br><br>Bind your controls (via the designer) to the binding source.&nbsp; For example, you can set the Text property of a text box to a string property exposed by the BindingSource.<br><br>Then, when your form loads, you do:<br><br>MyBindingSource.DataSource = myInstanceBO;<br><br>And off you go.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, September 26, 2006</h2>I haven't really spent time with the old binding scheme in 2.0, so I don't know what you'll have to do...<br><br>I'd really recommend you switch to using a bindingsource object between your controls and objects - it solves a whole raft of 1.1 issues...<br><br>CSLA .NET 2.0.3+ raises PropertyChanged("") for any unknown property changes. This tells data binding that something changed, so it can refresh everything. It may be the BindingSource control that is actually making this work properly, I'm not sure.<br><br>If it isn't working for you, with old-style bindings, then that is pretty decent evidence that it is the bindingsource doing the work. In that case, your options are probably to either switch to using a&nbsp; bindingsource, or to declare your own IsDirtyChanged event and raise it as I described in my previous post.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>matt tag replied on Tuesday, September 26, 2006</h2><font face="Verdana"><font size="1">ok, I've switched over to the ObjectDatasource and all the bizarre problems have gone away. Consider me converted....<br><br>matt tag<br></font></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>thomasc@magenic.com replied on Tuesday, September 26, 2006</h2><P>Matt,</P>
<P>Why you using a function for setting the name?&nbsp; You can do "Gets" and "Sets" for properties.&nbsp; My guess is simply style, since you are applying light logic there.</P>
<P>Tom Cole</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
