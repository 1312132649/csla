<html><header><title>Rookie question about deleteSelf of items in lists</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Rookie question about deleteSelf of items in lists</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3886.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>gartnerj posted on Monday, November 12, 2007</h2>OK, I've seen the examples where a list does a foreach loop for the deletion of items so marked.<br /><br />The item.DeleteSelft is called, which deletes the database entry for the item, then it is marked MarkNew.<br /><br />I DON'T see where the item is actually removed from the LIST BO class itself.  It looks like the deleted item, although marked NEW (so subsequent saves should't re-add them to the db) are not actually removed from the list, unless you go back out an re-fetch the list from the db.<br /><br />Any help here in understanding what is going on greately appreciated.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>juddaman replied on Monday, November 12, 2007</h2>Hi<br><br>If your talking about this kind of thing (taken for ProjectResources.cs).<br><br>&nbsp;foreach (ProjectResource obj in DeletedList)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.DeleteSelf(project);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // now that they are deleted, remove them from memory too<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DeletedList.Clear();<br><br>After calling DeleteSelf on each child, Clear() is called on the list, therefore deling each child from memory.<br><br>Not to sure where you saw MarkNew() being called. If you point me at it I'll take a look.<br><br>HTH<br>George<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>juddaman replied on Monday, November 12, 2007</h2>Actually, I guess you saw the MarkNew() in the DeleteSelf() method in the child class. The child is deleted from memory in the parent collection class, when Clear() is called. <br><br>George<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>gartnerj replied on Tuesday, November 13, 2007</h2>Yes, that is where I saw the MarkNew.<br /><br />I thought the DeletedList.Clear() ONLY removed the items from the DeletedList deleted objects tracking, not the actual BO list.<br /><br />My front end user is saying that when they "delete" objects out of the list (which is part of another BO), the item is removed from the db, but when the other BO is saved again, the "old" deleted items in the list are being readded to the database.<br /><br />BTW, I appreciate the help here!</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>juddaman replied on Tuesday, November 13, 2007</h2>Hi<br><br>Sorry you've lost me. If you attach the code for the root object, the collection and collection child objects I'll take a look.<br><br>George<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, November 13, 2007</h2>That should be handled via databinding; your grid control asks the binding source to remove a specific object.&nbsp; Csla's BusinessListBase overrides RemoveItem (IIRC) so that instead of just removing it from the "real" list, it puts it into DeletedList so that you can do the database delete when Save is called.&nbsp;&nbsp; It also calls the Delete method on the BO "deleted."<br><br>If that's not happening, something fishy is going on.&nbsp; Are you sure the object is removing itself from the database?&nbsp; I would check there first.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>gartnerj replied on Monday, November 19, 2007</h2>Thanks for the further explanation.<br />It turns out, the UI coder who complained about this had removed the DeletedList.Clear from his copy of the business object code, so while it DID remove items from the db (since the item.delete was called), the actual deleted items were never removed from the list itself.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
