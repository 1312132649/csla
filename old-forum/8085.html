<html><header><title>EditableRootList and BusinessBase</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>EditableRootList and BusinessBase</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8085.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>AndyW posted on Thursday, December 03, 2009</h2>I have a problem with my implementation of EditableRootList.<br /><br />I have an EditableRootList (StockList) with a collection of BusinessBase (StockItem) and bound to a Windows form Grid.  I can update the grid successfuly, however I want to be able to double click on a grid item and launch in a new form, this form is a more detailed form, whereas the grid is more of a snapshot with only a set amount of fields updatable.<br /><br />I am passing the current grid item to my form like this <br /><br />using (Forms.StockEntry stockEntry =<br />                       new Forms.StockEntry((Business.StockItem)bindingStockList.Current))<br />                    {<br />                        stockEntry.ShowDialog(this);<br />                    }<br /><br />And on my form the code looks like this<br /><br />	Private Business.StockItem _sd;<br /><br />        public StockEntry(Business.StockItem sItem)<br />        {<br />            InitializeComponent();<br /><br />            _sItem = sItem;<br />	    bindingSourceStockItem.DataSource = _sItem;<br />        }<br /><br /><br />Now I am not sure if that is the best way to pass the current selected grid item to a form, but it works.<br /><br />I can now change data on the form and so on, and when I save, it is automatically reflected in the grid, great.  However if I cancel the edit on the form and close the form the new information updates to the grid and does not perform a .CancelEdit.  I am calling CancelEdit myself.<br /><br />I cannot work out why, any pointers would be very appreciated.<br /><br />Thanks<br />Andy</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, December 03, 2009</h2><P>Sadly this is more complicated than you'd hope due to the way WinForms data binding works...</P>
<P>An object can be bound to one thing at a time. The object is bound to the datagrid, and you are then trying to bind it to the dialog, and you can't do that. You need to unbind the object from the datagrid first (which really means unbinding the entire list from the datagrid) so you can display it in the dialog...</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rxelizondo replied on Thursday, December 03, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>RockfordLhotka:</strong></div><div><P>An object can be bound to one thing at a time. The object is bound to the datagrid, and you are then trying to bind it to the dialog, and you can't do that. You need to unbind the object from the datagrid first (which really means unbinding the entire list from the datagrid) so you can display it in the dialog...</P></div></BLOCKQUOTE><br /><br />Just out of curiosity, is this also a limitation wiht WPF?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AndyW replied on Thursday, December 03, 2009</h2><br />Thanks guys for the responses.<br /><br />On the face of it, all I am asking is for something that sounds really easy.  <br /><br />I want an editable grid and also be able to double click a row in the grid, open a new dialog, change / modify data.  When I close the form save or cancel the ammended data.<br /><br />The grid row should now reflect the changes I made in the popup dialog.<br /><br />Sounds easy when you write it like that.<br /><br />Anyhow, I am working my way through unbinding / rebinding.  <br /><br />I am also re-reading certain sections of the 2008 book to get a better understanding.<br /><br />I does seem a little strange that I have to unbind the complete list, just to work with one object within the list.  I understand that is not the frameworks fault, just a little frustrating.<br /><br />At least my problem is a lot simpler than yours rsbaker0 :-)<br /><br />I am going to purchase Rockys new videos, hopefully it will give me a better understanding.<br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, December 03, 2009</h2>WPF data binding is not as complex as Windows Forms, and so it is easier<br />(much easier) to do this scenario in WPF or Silverlight.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Thursday, December 03, 2009</h2>We had this same issue -- even worse because we sometimes will have a grid either beside or below a non-modal form. <br /><br />The only solution we found was to turn off the IEditableObject interface (DisableIEditableObject = true) in our BusinessBase derived classes. <br /><br />This seems to work, but it's not free by any means. If you do this, you have to completely implement the BeginEdit/ApplyEdit/CancelEdit calls yourself, including when the current row in the grid changes from one row to another (each time you visit a row, you have to ApplyEdit on the last row visted, and BeginEdit on the new row, etc).<br /><br /></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
