<html><header><title>Underlying connection was closed.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Underlying connection was closed.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9273.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jwhook posted on Monday, July 26, 2010</h2><p>Hello All.</p>
<p>We have a user who comes in through the web who about once a day errors out with:</p>
<p><span style="font-family:Consolas;font-size:small;">System.Net.WebException: The underlying connection was closed: A connection that was expected to be kept alive was closed by the server.</span></p>
<p>The stack details vary slightly depending on what they were doing at the time. Typically, it&#39;s after they&#39;ve initiated a search in our application.</p>
<p>I&#39;ve looked through the threads here where something similar has happened, but they are all on later versions of CSLA than ours. We&#39;re way back at 1.5x, with a rebuild to .Net 2.0. While we will get to later versions of CSLA, it probably won&#39;t be until the end of the year.</p>
<p>I&#39;m at a loss to even know where to start, so any advice would be helpful. All of our users startup from the same place, although only this one user connects via the web to get to the startup location. None of our other users are experiencing this problem.</p>
<p>Thanks.</p>
<p>- jim</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Monday, July 26, 2010</h2><p>It sounds like a timeout issue. When you say &quot;connects via the web&quot; are you referring to the data portal running over the web, or something else?</p>
<p>Either way though, if it is a timeout issue, the solution is almost certainly to up the timeout limits on your network technology (Remoting, asmx, etc), probably on both client and server. That&#39;s typically done through configuration - though with the Remoting channel of the data portal it might mean creating a custom client-side proxy subclass (I honestly don&#39;t remember how that worked in 1.5 off the top of my head).</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jwhook replied on Monday, July 26, 2010</h2><p>I mis-stated the connectivity. They come in through our firewall, which redirects them to the appropriate location, which is the same application server everyone else is running from. They do have their own folder with their own copy of netrun.exe, but it&#39;s an exact copy of what our people inside the firewall use.</p>
<p>We&#39;ll see if we can make some adjustments to the network and see what happens.</p>
<p>Thanks.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Kevin Fairclough replied on Monday, July 26, 2010</h2><p>This exception is probably not the real fault.&nbsp; I would enable 
logging on the web server.</p>
<p>I had similar errors and it was a class
 that was not marked [Serializable].&nbsp; It might have been an inner class,
 can&#39;t remember.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jwhook replied on Monday, July 26, 2010</h2><p>Would having a class unmarked result in intermittant behavior? That doesn&#39;t sound right, but ... It&#39;s also the case that they can be running different parts of our application when this occurs, but I suppose that would point to a problem in code that is used by lots of the application.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Kevin Fairclough replied on Tuesday, July 27, 2010</h2><p>No it wouldn&#39;t be intermittent, only if the class was used intermittently.</p>
<p>I thought your classes were going through the data portal.&nbsp; Any class that goes through the data portal must be marked.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
