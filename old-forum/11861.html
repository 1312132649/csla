<html><header><title>WPF client hangs on Save() since upgrade to 4.5</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>WPF client hangs on Save() since upgrade to 4.5</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11861.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>kmavis posted on Friday, March 01, 2013</h2><p>I am a member of a team&nbsp;working&nbsp;on a largish app that uses CSLA. This app has both a Silverlight and a WPF client. The data portal runs in a Windows Service. We recently upgraded from CSLA 4.3 to 4.5. We are targeting Framework 4. The Silverlight client seems to be working fine. The WPF client however, hangs whenever we try to save changed data. In fact it hangs on the line &quot;response = await tcs.Task;&quot; in Csla.DataPortalClient.WcfProxy.Update.</p>
<p>Anyone have any hints as to what might be causing this? I&#39;ve been chasing this for a while and I&#39;m not&nbsp;getting&nbsp;anywhere.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Friday, March 01, 2013</h2><p>Please try the current beta version (4.5.12, or 4.5.13 this weekend), because this is a known issue that should be addressed at this time.</p>
<p>The next release will be 4.5.20, and I anticipate this coming out in about a week.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kmavis replied on Saturday, March 02, 2013</h2><p>Rocky, thank you for the response.</p>
<p>I used VS12&#39;s Package Manager app to update to the CSLA 4.5.12 Beta. Now when I try to build the solution I get &quot;Error<span>	</span>55<span>	</span>A stable release of a package should not have on a prerelease dependency. Either modify the version spec of dependency &quot;CSLA-Core (&ge; 4.5.12-Beta)&quot; or update the version field.<span>	</span>Vass.UI.Eng&quot; for every project in the solution. I think it may be due to CSLA-Core&#39;s dependency on Microsoft.BCL.Async 1.0.14-RC.</p>
<p>Comments in the NuGet forum seem to indicate that this behavior is intentional. Have I done&nbsp;something&nbsp;wrong? Or is there a work-around?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Sunday, March 03, 2013</h2><p>What is Vass.UI.Eng?</p>
<p>It is also possible that you were using the old async library and that doesn&#39;t upgrade smoothly to the new one. I have had to manually remove and reads nuget references to the async library.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kmavis replied on Monday, March 04, 2013</h2><p>Vass.UI.Eng is one of the projects in our solution. I expect it was the project that was referenced by that particular instance of that error message. It looked like I got an error for every&nbsp;project&nbsp;that referenced CSLA.</p>
<p>Sorry, I&#39;m not sure that I know what you mean by &quot;the old async library&quot;. Is that something prior to the &quot;async targeting pack&quot;?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, March 04, 2013</h2><p>The async targeting pack changed pretty radically a few months ago. The one targeted by the latest CSLA is not the one targeted by version 4.3.</p>
<p>The old async targeting pack doesn&#39;t properly upgrade to the new async targeting pack, causing all sorts of build issues.</p>
<p>To fix those, I have found it necessary to manually remove any async targeting pack references in every one of my projects. Then I reference the current async targeting pack in every one of my projects. Then things work.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kmavis replied on Monday, March 04, 2013</h2><p>Thanks Rocky. I understand now. I don&#39;t believe that is what is happening in our case. We just added the async targeting pack to our app at the same time we upgraded to CSLA 4.5.10. And FWIW, that is&nbsp;also&nbsp;when we upgraded to VS12 and was our first experience with using NuGet.</p>
<p>I appreciate your help on this issue. We have a sprint demo this week that we need to be ready for, so we are about out of time. Our current plan is to replace the more mainstream calls to Save() with calls to SaveAsync() wrapped in async methods. The way we are doing it is on the Q&amp;D side but it&nbsp;should&nbsp;be&nbsp;good enough to get us through the demo. Then&nbsp;when&nbsp;4.5.20 comes out we&#39;ll likely upgrade to it and rollback our fixes.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, March 04, 2013</h2><p>I just put 4.5.13 beta into nuget, so you might try that before going back. This is the last beta release before 4.5.20 - in fact it might _be_ 4.5.20 if we don&#39;t fix any bugs this week.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kmavis replied on Monday, March 04, 2013</h2><p>Thanks Rocky. I tried but I never could get rid of that &quot;A stable release of a package should not have on a prerelease dependency...&quot; error. One difference though is that I am only seeing that on the projects that reference CSLA -Silverlight. I think that&#39;s a change from 4.5.12 as I&#39;m nearly certain I was getting that error for all of our projects that&nbsp;referenced&nbsp;CSLA. Mindful of your comments earlier in this thread, I went through and removed all of the NuGet packages for our solution. Then I added CSLA 4.5.13 Beta and let it get whatever it wanted. No joy.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, March 04, 2013</h2><p>I just created a new SL5 project and used nuget to add the 4.5.13 CSLA Silverlight package. That added the new async targeting packages. This builds and runs fine.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
