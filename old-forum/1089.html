<html><header><title>EditableRootList containing SwitchableObjects</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>EditableRootList containing SwitchableObjects</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1089.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jrnail23 posted on Thursday, August 31, 2006</h2><P>I'm trying to build an EditableRootList which contains SwitchableObjects, and I noticed that in the Templates, the SwitchableObject doesn't contain the code necessary to comply with the following DataPortal_Update method of the template's EditableRootList code:</P>
<P><FONT face="Courier New" size=2>Protected Overrides Sub DataPortal_Update()<BR>&nbsp;&nbsp;&nbsp;RaiseListChangedEvents = False<BR>&nbsp;&nbsp;&nbsp;For Each item As EditableChild In DeletedList<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item.<FONT>DeleteSelf</FONT>()<BR>&nbsp;&nbsp;&nbsp;Next<BR>&nbsp;&nbsp;&nbsp;DeletedList.Clear()</FONT></P>
<P><FONT face="Courier New" size=1><FONT size=2>&nbsp;&nbsp;&nbsp;For Each item As EditableChild In Me<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If item.IsNew Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item.<FONT>Insert</FONT>(Me)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item.<FONT>Update</FONT>(Me)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If<BR>&nbsp;&nbsp;&nbsp;Next<BR>&nbsp;&nbsp;&nbsp;RaiseListChangedEvents = True<BR>End Sub</FONT></FONT></P>
<P><FONT size=2><FONT size=3>Now I know that Rocky discourages the use of SwitchableObjects, but can anyone provide some insight on what I might need to do to my SwitchableObject to get it to comply with this code?</FONT></FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, August 31, 2006</h2>I'm not sure I understand the issue?<br><br>All switchable objects implement both the DataPortal_XYZ methods that are called by the data portal if the object is used as a root, and a set of equivalent Friend methods that are called by the parent if the object is used as a child. Typically the DataPortal_XYZ methods delegate their work to the Friend methods to avoid duplication of code, or both of these delegate to a third private method that does the real work.<br><br>So in the switchable object you'll have:<br><br>Protected Overrides Sub DataPortal_Insert()<br>&nbsp; DoInsert()<br>End Sub<br><br>Friend Sub Insert(ByVal parent As ParentType)<br>&nbsp; mParentId = parent.Id<br>&nbsp; DoInsert()<br>End Sub<br><br>Private Sub DoInsert()<br>&nbsp; ' implement actual data update code here<br>End Sub<br><br>This implementation, or variations on the theme, is the standard approach for implementing any switchable object.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jrnail23 replied on Thursday, August 31, 2006</h2><P>Rocky, thanks for the quick reply... Makes sense to me, but the code you posted isn't in the switchable object template.&nbsp; Is there an updated version of the templates project available for download?</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
