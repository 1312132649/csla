<html><header><title>Dependent Property Validation</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Dependent Property Validation</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10372.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson posted on Friday, May 13, 2011</h2><p>I&#39;m having trouble with something that should be simple, I think.</p>
<p>I have a property called PositionStatus that is not required.&nbsp; Another property DaysWorkedGTZero is usually not required, either.&nbsp; But if PositionStatus has a value of &quot;07&quot;, DaysWorkedGTZero has to have one of its allowable values: either Y or N.</p>
<p>So I tried this for a rule method:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Private Shared Function DaysWorkedForStatus(Of T As RptDetailRecord)(ByVal target As T, ByVal e As RuleArgs) As Boolean<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If target.ReadProperty(_positionStatusProperty) = &quot;07&quot; Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.Description = &quot;&#39;Days Worked Greater Than 0&#39; is required when Position Status is &#39;07&#39;&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return False<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return True<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Function</p>
<p>and then I call these methods in my AddBusinessMethods routine:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ValidationRules.AddRule(Of RptDetailRecord)(DaysWorkedForStatus(Of RptDetailRecord), _daysWorkedGTZeroProperty)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ValidationRules.AddRule(Of RptDetailRecord)(DaysWorkedForStatus(Of RptDetailRecord), _positionStatusProperty)</p>
<p><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ValidationRules.AddDependentProperty(_positionStatusProperty, _daysWorkedGTZeroProperty, True)</p>
<p>This seems a pretty faithful mimic of the code Rocky offers in ppg507 and 509.&nbsp; But my compiler is complaining about the calls to AddRule for the custom Rule saying &quot;argument not specified for parameter &#39;e&#39; of Private Shared Function DaysWorkedForStatus....yada, yada - and the same for &#39;target&#39;.</p>
<p>I must be missing something obvious here.&nbsp; Can you steer me right?</p>
<p>Thanks and have a great weekend.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Saturday, May 14, 2011</h2><p>AddBusinessRules should be like this:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ValidationRules.AddRule(Of RptDetailRecord)(DaysWorkedForStatus, _daysWorkedGTZeroProperty)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ValidationRules.AddRule(Of RptDetailRecord)(DaysWorkedForStatus, _positionStatusProperty)</p>
<p><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ValidationRules.AddDependentProperty(_positionStatusProperty, _daysWorkedGTZeroProperty, True)</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson replied on Saturday, May 14, 2011</h2><p>Thanks for the reply, Johnny.</p>
<p>I tried that and stil have the same four compiler errors (both calls to .AddRule complaining about missing target and e), I&#39;m sorry to say.</p>
<p>And their appearance in the code window is still the same, too.&nbsp; Maybe this is a clue you can use whose importance eludes me. AddRule has the red squiggly line underneath and the Issue it references is &quot;Undeclared element&quot;.&nbsp; DaysWorkdForStatus has the blue squiggly and its tip message is &quot;argument not specified for parameter&nbsp;&#39;e&#39;....yada, yada&quot;.&nbsp; I believe these are offered by VS 2008, but they may be provided by CodeRush.</p>
<p>It&#39;s curious to me that the &#39;target&#39; argument gets to show the message for the missing &#39;e&#39;, but no such message shows for the propertyinfo argument.&nbsp; Is that significant?</p>
<p>Thanks again.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Saturday, May 14, 2011</h2><p>Which version of Csla are you using? </p>
<p>I believe you ar missing the AddressOf keyword for the static method: :</p>
<p>Code taken from ProjectTrackervb;</p>
<p>&nbsp;&nbsp;&nbsp; ValidationRules.AddRule(Of Project)(<b>AddressOf</b> StartDateGTEndDate(Of Project), StartedProperty)<br />&nbsp;&nbsp;&nbsp; ValidationRules.AddRule(Of Project)(<b>AddressOf </b>StartDateGTEndDate(Of Project), EndedProperty)<br /><br />&nbsp;&nbsp;&nbsp; ValidationRules.AddDependentProperty(StartedProperty, EndedProperty, True)<br /><br />&nbsp; End Sub<br /><br />&nbsp; Private Shared Function StartDateGTEndDate(Of T As Project)( _<br />&nbsp;&nbsp;&nbsp; ByVal target As T, _<br />&nbsp;&nbsp;&nbsp; ByVal e As Validation.RuleArgs) As Boolean<br /><br />&nbsp;&nbsp;&nbsp; If target.GetProperty(Of SmartDate)(StartedProperty) &gt; target.GetProperty(Of SmartDate)(EndedProperty) Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.Description = &quot;Start date can&#39;t be after end date&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return False<br /><br />&nbsp;&nbsp;&nbsp; Else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return True<br />&nbsp;&nbsp;&nbsp; End If<br /><br />&nbsp; End Function</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson replied on Sunday, May 15, 2011</h2><p>I&#39;m using CSLA 3.8.4.</p>
<p>And adding the AddressOf did the trick!&nbsp; </p>
<p>I had suspected that it might be the issue, having looked at some code in other posts.&nbsp; But when I added it my original code here (that had the bogus (of RptDetailRecord), it didn&#39;t correct it, so I discarded it and posted my question here without it.</p>
<p>So your first suggestion would have fixed it if I&#39;d just left it in!</p>
<p>Many years ago when the book for CSLA 1.x was published, Rocky made an errata list available on his site.&nbsp; Do you know where there might be one for the current book?&nbsp; I can&#39;t find one.&nbsp; And I&#39;d think the ommission of AddressOf on the code example in chapter 17 might qualify for it.</p>
<p>Thanks again, Jonny!</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Sunday, May 15, 2011</h2><p>Apress tracks all errata for their books.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
