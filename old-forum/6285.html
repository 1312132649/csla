<html><header><title>How to validate whether a child item exists?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How to validate whether a child item exists?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6285.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>raz0rf1sh posted on Thursday, January 29, 2009</h2>I have an Invoice object with a collection of InvoiceItem objects.  <br /><br />I need to add a validation rule that says at least on InvoiceItem object is required.  Where is it best to do this at?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>reagan123 replied on Thursday, January 29, 2009</h2>***Edit *** Nevermind, I mis-read your post :(<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Antonio Sandoval replied on Thursday, January 29, 2009</h2>I have the same question.<br><br>I was doing it with overriden IsValid method. Chapter 8. Expert CSharp Bussines Objects:<br><br>public override bool IsValid(){<br>get{<br>&nbsp;&nbsp; return base.IsValid &amp;&amp; _ChildrenList.IsValid /* &amp;&amp; _ChildrenList.Count&gt;0 */;<br>}<br>}<br><br>But maybe a better way is using a custom Rule:<br><br>ValidationRules.AddRule&lt;Root&gt;(ChildrenAtLeastOne&lt;Root&gt;,"ChildrenList");<br><br>&nbsp;private static bool ChildrenAtLeastOne&lt;T&gt;(T target, Csla.Validation.RuleArgs e) where T: class<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int count = ((Csla.Core.IExtendedBindingList)Csla.Utilities.CallByName(target, e.PropertyName, CallType.Get)).Count;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return count &gt; 0;<br>}<br><br>In the two cases I have the problem of how to automate the error notification in the user interface. Thanks in advance.<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Wbmstrmjb replied on Thursday, January 29, 2009</h2>Don't add it to IsValid().&nbsp; Do your second suggestion by requiring at least one object via validation.&nbsp; But the validation can go in the Child List, not the Root object.&nbsp; Most likely that is a business rule for all instances of that list, so add it there instead.&nbsp; HTH.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>raz0rf1sh replied on Thursday, January 29, 2009</h2>So ChildLists allow for validation rules now?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, January 29, 2009</h2><P>No. Child Lists do not have ValidationRules. I am not sure what the other poster was referring to.</P>
<P>The list can raise events that the root BO can listen to. Then the root BO can call CheckRules for the specific child collection property name. But the rule would need to exist in the root BO.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Antonio Sandoval replied on Thursday, January 29, 2009</h2>That sounds logic, but BussinesListBase neither EditableRootListBase supports Rule Validation. The second method works, but I must use PropertyHasChanged("GetChildrensList") instead of OnPropertyChanged(null)&nbsp; (ProjectTracker) in the ListChanged Event, that permits to CSLA verify the rules for this children list. But I'm still don't sure if it is a good way of do that.<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, January 30, 2009</h2>Your Invoice should be sub-classing BB though; I'd be really surprised if there were a use case that did it any other way.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
