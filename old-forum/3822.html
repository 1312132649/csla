<html><header><title>OT:  Sql Server 2005 OVER clause</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>OT:  Sql Server 2005 OVER clause</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3822.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Thursday, November 01, 2007</h2>Hi,<br><br>I've been trying in SSIS to count the number of rows with a particular attribute, to be returned with each row.&nbsp; <br><br>So for this set of data:<br>LineItem ( DocumentNumber, UnitPrice, ProductId )<br>"12", 34.3, 1<br>"12", 10, 3<br>"12", 0.3, 5<br>"5", 34.3, 1<br>"5", 0.3, 5<br>
"1", 34.3, 1<br>
"1", 10, 2<br>
"1", 0.3, 3<br>
"1", 34.3, 4<br>
"1", 10, 5<br>
"1", 0.3, 6<br><br>I want <br>DocumentNumber, UnitPrice, ProductId, NumberOfLines<br>"12", 34.3, 1, 3<br>
"12", 10, 3, 3<br>
"12", 0.3, 5, 3<br>
"5", 34.3, 1, 2<br>
"5", 0.3, 5, 2<br>

"1", 34.3, 1, 6<br>

"1", 10, 2, 6<br>

"1", 0.3, 3, 6<br>

"1", 34.3, 4, 6<br>

"1", 10, 5, 6<br>

"1", 0.3, 6, 6<br>
<br>I need to do this because that's what the other program to which I am exporting data expects.<br><br>In Sql 2005, you can do this select and get the desired result<br>select DocumentNumber, UnitPrice, ProductId, count(*) over (partition by DocumentNumber) as itemcount<br>from LineItem<br><br>You can also use it over some other functions as well.<br><br>Hope that helps others!<br><br>Andy<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
