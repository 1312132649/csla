<html><header><title>OT: Visual Studio report control question</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>OT: Visual Studio report control question</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1872.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>albruan posted on Wednesday, November 29, 2006</h2><P>I have a report based on two business objects due to the method in which my client wants the data displayed.&nbsp; My first business object consists of a single row of drawing data for each department, so three rows of data will be returned if there are three departments involved in the project.&nbsp; My second business object returns a single row of drawing data for all departments.&nbsp; For each department, he wants it broken out by drawing types and subtotaled for the department; for the project, he wants it also broken out by drawing types and totaled for the project.&nbsp; </P>
<P>This is a bit hard to describe so maybe a diagram of sorts will help.&nbsp; Limiting it to three departments and two drawing types, the first report is similar to:</P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# of Dwgs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Total Hours<BR>Architectural<BR>&nbsp;&nbsp;&nbsp;CADD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 80<BR>&nbsp;&nbsp;&nbsp;Manual&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 60<BR>&nbsp;&nbsp;&nbsp;Dept Total&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;140<BR>Electrical<BR>&nbsp;&nbsp;&nbsp;CADD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 95<BR>&nbsp;&nbsp;&nbsp;Manual&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 20<BR>&nbsp;&nbsp;&nbsp;Dept Total&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;19&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;115<BR>Structural<BR>&nbsp;&nbsp;&nbsp;CADD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 80<BR>&nbsp;&nbsp;&nbsp;Manual&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 60<BR>&nbsp;&nbsp;&nbsp;Dept Total&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;140</FONT></P>
<P>For the second part of the report, he wants it displayed as:</P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# of Dwgs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Total Hours<BR>Project<BR>&nbsp;&nbsp;&nbsp;CADD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;36&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255<BR>&nbsp;&nbsp;&nbsp;Manual&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;140<BR>&nbsp;&nbsp;&nbsp;Project Totals&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;49&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 395</FONT></P>
<P>My business objects return the correct data, but the problem occurs in the rendering of the report.&nbsp; To display the first part of the report, I have a report table embedded in a report list box to permit iterating through the departments; it works as advertised.&nbsp; To display the second part of the report, I have a standalone report table and it is here that the report refuses to render the way it should.&nbsp; Rather than displaying a single grid for the project totals, it displays the same grid with the same data three times.</P>
<P>Has&nbsp;anyone here successfully created a similar report or one in SQL Server Reporting Services (since the two are similar)?&nbsp; If so, what, if anything,&nbsp;am I doing wrong?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>figuerres replied on Thursday, November 30, 2006</h2><P>Are you using client reports or report server reports ?</P>
<P>I reciently made a client report and posted here with some info on what I had to do in my case.</P>
<P>I have not yet tried to do a report server based report.</P>
<P>are the two BO related ? as in parent / child ?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>albruan replied on Thursday, November 30, 2006</h2><P>I'm using client reports for this project.&nbsp; The two BOs are related after a fashion.&nbsp; For the first part of my report, I had to create a pair of BOs in order to flatten my hierarchy for reporting purposes; without them, the report displayed project-wide totals for each of the departments.&nbsp; See&nbsp;<A HREF="/forums/thread/9388.aspx">http://forums.lhotka.net/forums/thread/9388.aspx</A>&nbsp; In other words, given the data in my example, it would display 10 CADD drawings in each of the three departments before I flattened the hierarchy.</P>
<P>I've been able to&nbsp;aggregate the totals for each of the departments in my report, but I've been unable to display the second part of my report without having to resort to another pair of business objects.</P>
<P>Thanks for your response.&nbsp; I'll perform a search and see what you wrote about client reports.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, November 30, 2006</h2>Also, are you adding both objects as seperate data sources, and setting the table to the proper datasource?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>figuerres replied on Thursday, November 30, 2006</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>albruan:</strong></div><div>
<P>I'm using client reports for this project.&nbsp; The two BOs are related after a fashion.&nbsp; For the first part of my report, I had to create a pair of BOs in order to flatten my hierarchy for reporting purposes; without them, the report displayed project-wide totals for each of the departments.&nbsp; See&nbsp;<A href="/forums/thread/9388.aspx">http://forums.lhotka.net/forums/thread/9388.aspx</A>&nbsp; In other words, given the data in my example, it would display 10 CADD drawings in each of the three departments before I flattened the hierarchy.</P>
<P>I've been able to&nbsp;aggregate the totals for each of the departments in my report, but I've been unable to display the second part of my report without having to resort to another pair of business objects.</P>
<P>Thanks for your response.&nbsp; I'll perform a search and see what you wrote about client reports.</P>
<P></div></BLOCKQUOTE></P>
<P>I was not able to find my post where I found the trick I needed but here goes:</P>
<P>if you do binding to winforms with a parent / child you can bind the child grid by refering to the parent.child</P>
<P>with client reports you can bind to a child and have it fill out a list / table but you have to bind it to the child collection directly. if you bind wrong you get no data and no error.</P>
<P>if it is wrong the vs report designer does not tell you, it all looks good till you run the report.</P>
<P>if you have a collection you must bind with a repeating control parent, sometimes you can use a list and then detail items.</P>
<P>depending on how the BO is setup and is single or a collection you may need to create datascources for each BO and bind each datasource to a report container.</P>
<P>if you are still stuck post back and we can try to work it out, I am finishing some code and then later I will be doing a bunch of reports to finish the app I am working on.... wow almost done... lot's of forms and stuff to get this thing competed.... but then comes testing and bug fixing!</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>albruan replied on Thursday, November 30, 2006</h2>I finally found the problem.&nbsp; The first few times I ran the application, everything was working according to plan.&nbsp; Somehow, while making changes to the data to be accessed for a particular cell, I inadvertently set the datasetname for the second table to the datasetname used by the first table.&nbsp; Changing it back to the correct BO solved the problem.&nbsp; I can't even begin to count (enumerate?) the number of times I stared at it and didn't even see it.&nbsp; Sheeeeeesh!</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, November 30, 2006</h2>Ya, those kinds of things are the worst.&nbsp; You spend days looking at something, not noticing the simple thing wrong.&nbsp; At least we can take comfort in knowing that everyone does this from time to time.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
