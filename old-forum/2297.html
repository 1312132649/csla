<html><header><title>Web Reference to WebServiceHost</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Web Reference to WebServiceHost</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2297.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>DanEssin posted on Wednesday, February 07, 2007</h2>In the CSLA project there is a web reference called WebServiceHost that is defined as http://localhost:4804/WSPortalcs/Service.asmx<br><br>but I can't find any folder called WSPortalcs and there is no file called Service.asmx<br><br>In ProjectTracker20cs there is a directory www\WebServicesHost that contails a file called WebServicePortal.asmx which points to Class="Csla.Server.Hosts.WebServicePortal"<br><br>When I try to run the PTServiceClient application I am getting an error at the &gt;&gt;&gt; inside the fetch but after the serialize call:<br>&nbsp;&nbsp;&nbsp; public Server.DataPortalResult Fetch(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type objectType, object criteria, Server.DataPortalContext context)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object result;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Server.Hosts.WebServicePortal.FetchRequest request = <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new Server.Hosts.WebServicePortal.FetchRequest();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request.ObjectType = objectType;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request.Criteria = criteria;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; request.Context = context;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using (WebServiceHost.WebServicePortal wsvc = GetPortal())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&gt;&gt;&gt;&gt; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = Deserialize(wsvc.Fetch(Serialize(request)));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (result is Exception)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw (Exception)result;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return (Server.DataPortalResult)result;<br>&nbsp;&nbsp;&nbsp; }<br><br>I have the following problems:<br>1 - The web reference in CSLA - If I delete it and try to add a new one, it says there is no web service called WebServicePortal. <br>2 - If I run PTServiceClient from VS by rt-clicking debug it throws the following exception:<br>{"No connection could be made because the target machine actively refused it"}<br>3 - If I open the PTWebService in a browser , select GetRoles and click test it throws an exception:<br><pre>System.Exception: Unable to connect to the remote server<br>   at PTService.GetRoles() in e:\csla20cs\ProjectTracker20cs\www\PTWebService\App_Code\PTService.cs:line 294</pre>4 - If I start both PTWebService and WebServiceHost in instances of VS and then run PTServiceClient it gives me the error about invalid identity - duplicate token<br><br>I have also tried this with IIS instead of the builtin vs web server and the errors are the same.<br><br>I have worked on this for about 40 hours and also spent 4 hours on the phone with a Microsoft tech support person and have been unable to discover what mistake that I have made. I assume that there is something that I have overlooked or not understood but I haven't got a clue to what it might be.<br><br>Any help, especially from Rocky, to get me up and running would be greatly appreciated.<br><br>Dan Essin<br><br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DanEssin replied on Wednesday, February 07, 2007</h2>Followup info:<br>1 - PTWin runs fine.<br>2 - running PTServiceClient sometimes throws this exception:<br>System.Web.Services.Protocols.SoapException: Server was unable to process request. ---&gt; System.Exception: Principal must be of type BusinessPrincipal, not System.Security.Principal.GenericPrincipal\n&nbsp;&nbsp; at PTService.GetProjectList() in e:\\csla20cs\\ProjectTracker20cs\\www\\PTWebService\\App_Code\\PTService.cs:line 49<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
