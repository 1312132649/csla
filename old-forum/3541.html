<html><header><title>ObjectListView filtered by child objects</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ObjectListView filtered by child objects</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3541.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate posted on Friday, September 14, 2007</h2><P>I have a list of objects.&nbsp; Each object contains a list of the categories to which it belongs.&nbsp; (Each object can exist in more than one category.)&nbsp; Each child Category object has a Name property that indicates the name of that category.</P>
<P>In my application, I present the user with this list of objects bound to a simple list control.&nbsp; This is accomplished using a "default" view with pre-defined sorting and no filtering.&nbsp; Via a drop-down list, the user can select which category they would like to filter the list by.&nbsp; Ordinarily, if there was a one-to-many relationship between the category and my objects, this would be simple and I'd just create a new ObjectListView filtered on "Category = 'x'".&nbsp; However, because there is no one Category property or value, this won't work.</P>
<P>I tried using "Child.Name = 'x'" as my filter expression but that threw an exception from ADO.NET saying that it didn't recognize Child.&nbsp; I also tried having my Category collection return a string containing a comma-delimited list of the names so I could use "'x' IN Categories" where Categories is the property name on&nbsp;my object&nbsp;- but it didn't like that either.</P>
<P>So, how do I accomplish this?&nbsp; Essentially I need a way to filter the list based on whether the object contains a child Category object with the specified name - or the name is in a list exposed by the object.&nbsp; Can this be done with the ObjectListView?</P>
<P>Any suggestions?</P>
<P>Thx</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>KKoteles replied on Friday, September 14, 2007</h2><P><SPAN>SonOfPirate,<o:p></o:p></SPAN></P>
<P><SPAN>What about adding another "Get" method to your list object? <SPAN>&nbsp;</SPAN>So where you now have ObjectList.Get(), you would also create an ObjectList.GetByCategory() (or more than one if you have different parameter signatures). The Data_Portal_Fetch for that particular method would call its own specific stored procedure for the objects to be returned. <SPAN>&nbsp;</SPAN>All the real work is done in the stored procedure (where you would return the object if ANY category associated with it matched...). <SPAN>&nbsp;The idea is that you are not really "filtering" a returned recordset, but rather controlling what is being returned in the recordset in the first place (yes, you will need to be able to address parameters being passed in the fetch).&nbsp; </SPAN>So:<o:p></o:p></SPAN></P>
<P class=MsoNoSpacing><SPAN>if</SPAN><SPAN> <SPAN>(</SPAN>condition<SPAN>) </SPAN><SPAN>&nbsp;</SPAN><SPAN>//</SPAN><SPAN> You need to get list by Category<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNoSpacing><SPAN>{<o:p></o:p></SPAN></P>
<P class=MsoNoSpacing><SPAN><SPAN>&nbsp;&nbsp; </SPAN><SPAN>DisplayList</SPAN><SPAN>(</SPAN>ObjectList<SPAN>.GetByCategory());</SPAN><o:p></o:p></SPAN></P>
<P class=MsoNoSpacing><SPAN>}</SPAN><SPAN><o:p></o:p></SPAN></P>
<P class=MsoNoSpacing><SPAN>else</SPAN><SPAN><o:p></o:p></SPAN></P>
<P class=MsoNoSpacing><SPAN>{</SPAN><SPAN><o:p></o:p></SPAN></P>
<P class=MsoNoSpacing><SPAN><SPAN>&nbsp;&nbsp; </SPAN><SPAN>DisplayList</SPAN><SPAN>(</SPAN>ObjectList<SPAN>.Get());</SPAN><o:p></o:p></SPAN></P>
<P class=MsoNoSpacing><SPAN>}</SPAN><SPAN><o:p></o:p></SPAN></P>
<P class=MsoNoSpacing><SPAN><SPAN>&nbsp;</SPAN><o:p></o:p></SPAN></P>
<P class=MsoNoSpacing><SPAN>private</SPAN><SPAN> <SPAN>void</SPAN> DisplayList(ObjectList list)<o:p></o:p></SPAN></P>
<P class=MsoNoSpacing><SPAN>{<o:p></o:p></SPAN></P>
<P class=MsoNoSpacing><SPAN><SPAN>&nbsp;&nbsp; </SPAN>Csla.SortedBindingList&lt;ObjectInfo&gt; sortedList =&nbsp;</SPAN><SPAN>new</SPAN><SPAN> Csla.SortedBindingList&lt;ObjectInfo&gt;(list);<o:p></o:p></SPAN></P>
<P class=MsoNoSpacing><SPAN><SPAN>&nbsp;&nbsp; </SPAN>sortedList.ApplySort(<SPAN>"Name"</SPAN>, ListSortDirection.Ascending);<o:p></o:p></SPAN></P>
<P class=MsoNoSpacing><SPAN><SPAN>&nbsp;&nbsp; </SPAN>this</SPAN><SPAN>.ObjectListBindingSource.DataSource = sortedList;<o:p></o:p></SPAN></P>
<P class=MsoNoSpacing><SPAN>}<o:p></o:p></SPAN></P>
<P class=MsoNoSpacing><SPAN><SPAN></SPAN></SPAN>&nbsp;</P>
<P class=MsoNoSpacing><SPAN><SPAN>Just a thought,&nbsp;</SPAN><o:p></o:p></SPAN></P>
<P class=MsoNoSpacing><SPAN>Ken K<o:p></o:p></SPAN></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Monday, September 17, 2007</h2><P>Yea, I guess I should have included in my original post that the app is "document-centric" in nature meaning that we have to operate as if all of our objects exist ONLY in memory.&nbsp; Therefore, instantiating different lists using SQL to do the filtering is not an option.</P>
<P>Essentially, the user creates a new "document" and begins adding items.&nbsp; Until they explicitly save the "document", nothing is persisted in the database.&nbsp; As a result, all of the filtering required to support multiple views in the UI must be done directly on the business collections.</P>
<P>Besides that, making round-trips everytime they want to VIEW that data differently is undesirable and highly unproductive (imo).&nbsp; In addition, we'd be consuming more and more memory as we'd actually have multiple instances of the same object in memory - another key to why we are using the ObjectListView approach.</P>
<P>Again, the issue is that we want to filter our list based on whether an item contains a particular value or object in its child collection.&nbsp; It's the many-to-many relationship that exists between our objects and each "Category" that makes this different from the standard pattern.</P>
<P>Thx.</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Tuesday, November 20, 2007</h2>Hi, the ObjectListView is still supported by its author, although it may seem as though I have fallen off of the face of the earth.&nbsp; A combination of a move from Oxford to San Diego, a career change to the construction industry, 45 minute commutes, an apartment that is still not unpacked and a six month old baby can do that to you. <img src="/emoticons/emotion-5.gif" alt="Wink [;)]" />&nbsp; Last night was the first time I had unpacked and turned on my computer since the end of July.<br><br>I think that it might work if you tried something like<br>"Categories like %" + categoryName + "%"<br><br>against your comma delimited list.&nbsp; I realize that this is really old and you may have moved on from this, but that is my best guess.<br><br>By the way, to anyone looking for support on the ObjectListView, send me a PM.&nbsp; That will send me an email, which I should be more responsive to.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
