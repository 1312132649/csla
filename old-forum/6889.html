<html><header><title>Value cannot be null. Parameter name: key (CSLA Light)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Value cannot be null. Parameter name: key (CSLA Light)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6889.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>CampbellCM posted on Friday, May 01, 2009</h2>I'm getting this error when I try to delete a BO.<br /><br />Here is the DataPortal_Delete method:<br /><br />[Transactional(TransactionalTypes.TransactionScope)]<br />protected void DataPortal_Delete(ProfileCriteria criteria)<br />{<br />    ...<br />}<br /><br />Here is the SL factory method:<br /><br />public static void DeleteProfile(string profileID, string companyID, EventHandler> handler)<br />{<br />    DataPortal dp = new DataPortal();<br />    dp.DeleteCompleted += handler;<br />    ProfileCriteria criteria = new ProfileCriteria();<br />    criteria.ProfileID = profileID;<br />    criteria.CompanyID = companyID;<br />    dp.BeginDelete(criteria);<br />}<br /><br />Here is the criteria class:<br /><br />[Serializable]<br />public class ProfileCriteria : BusinessBase<br />{<br /><br />    private static PropertyInfo ProfileIDProperty = RegisterProperty<br />        (<br />        typeof(ProfileCriteria), new PropertyInfo("ProfileID", "ProfileID")<br />        );<br /><br />    public string ProfileID<br />    {<br />        get<br />        {<br />            return GetProperty(ProfileIDProperty);<br />        }<br />        set<br />        {<br />            SetProperty(ProfileIDProperty, value);<br />        }<br />    }<br /><br />    private static PropertyInfo CompanyIDProperty = RegisterProperty<br />        (<br />        typeof(ProfileCriteria), new PropertyInfo("CompanyID", "CompanyID")<br />        );<br /><br />    public string CompanyID<br />    {<br />        get<br />        {<br />            return GetProperty(CompanyIDProperty);<br />        }<br />        set<br />        {<br />            SetProperty(CompanyIDProperty, value);<br />        }<br />    }<br /><br />}<br /><br />I use the same methodology for the DataPortalFetch method (including the criteria class), no problem.<br /><br />Any ideas?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>CampbellCM replied on Friday, May 01, 2009</h2>After searching the forum again I found what appeared to be a related post and tried a couple of things suggested there.  First I tried implementing the ICriteria interface on my criteria BO and that didn't work.  I then tried inheriting my criteria class from CriteriaBase and that did the trick.  It seems odd to me that the BusinessBase derived criteria class works with DataPortal_Fetch and not the DataPortal_Delete...</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, May 01, 2009</h2><P>Implementing ICriteria should have done the trick, as long as you returned the correct business object type through the ICriteria interface.</P>
<P>The data portal now has three models for finding the type of the business object.</P>
<OL>
<LI>If the data portal method call is generic (like Delete&lt;T&gt;()) then T is used</LI>
<LI>If the criteria object implements ICriteria, then the type returned by ICriteria is used</LI>
<LI>If the criteria class is nested in the business class, then the type containing the criteria class is used</LI></OL>
<P>These models should follow that order of preference.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
