<html><header><title>Adding child objects directly in a grid</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Adding child objects directly in a grid</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4598.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dtabako posted on Tuesday, April 01, 2008</h2><P>Hi,</P>
<P>I'm writing my first CSLA app and I have a situation I'm not sure how to handle. I have an editable root object "TaxJurisdiction" which contains a collection of child objects "TaxCodes". Each TaxCode contains properties for 'Tax1', 'Tax2', and 'ItemTax'. Those are values associated with the TaxCode and cannot be changed when building/editing a TaxJurisdiction. What I need is a mechanism to be able to add/remove TaxCodes to/from the TaxJurisdiction. Since I want the user to be able to see the tax fields (but not be able to edit them) my first thought was to make a grid and have the first column (TaxCode) be a comboBox column. The datasource would be my list of TaxCodes, the display member would be the description and the value member would be the Id. The comboBox column would be set to readOnly = false but the other columns would be readOnly = true.&nbsp;This works fine for showing existing TaxCodes within a TaxJurisdiction. The problem comes when you try to add (or edit) TaxCodes within the grid. The comboBox won't dropdown for existing TaxCode objects (maybe because this is the identifier for the TaxCode child object? - anyway, this type of editing of an existing&nbsp;TaxCode&nbsp;is&nbsp;not necessary but would be nice) and if I try to add a new object I get system exceptions that the value in the comboBox is not valid - probably because there is no default TaxCode.</P>
<P>So my question is, is there a good way to do this that I am not getting? Is it even possible? If not - or if it's not the best way to do this - does anyone have any suggestions about what I can and should be doing?</P>
<P>Also, something I haven't yet tried but which I will need to do is display on the form the total for each type of tax (Tax1, Tax2, ItemTax) - which is simply the sum of each type of tax over all selected tax codes. Of course, these totals&nbsp;will need to keep&nbsp;themselves updated each time a TaxCode is added or removed. But they will be display-only values which will not need to be edited or saved back to the database.</P>
<P>Any help would be greatly appreciated.</P>
<P>Thanks, Dennis</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Tuesday, April 01, 2008</h2>You didn't mention whether this was a WinForms application or not. If it is, you can subscribe to the AddingNew event of the BindingSource object you are using for your TaxCodes grid. This allows you to create the "new" object yourself when the grid needs one, and you can initialize the non-editable properties from the parent object. </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dtabako replied on Wednesday, April 02, 2008</h2><P>It is a WinForms app. But I guess the real problem is that there is no default value to load. What really should happen logically - if this is to be done in a grid -&nbsp;is that the user adds a blank row and then picks a TaxCode from a comboBox in the first column.</P>
<P>I'm beginning to see that trying to use the grid directly here is probably not the way to go. I can easily put a comboBox (with the list of available TaxCodes) and an "Add" button on the form. Then I can make all grid columns readOnly or (probably a better idea) label columns. I just thought it might be a little more slick if I could work it so the user could do it all within the grid. </P>
<P>Is there a "best practices" or generally accepted way of doing what I'm trying to do here? Or is it pretty much to each his own?</P>
<P>Thanks, Dennis</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Wednesday, April 02, 2008</h2><P>Is there a setting for the combobox control you are using that will allow null values? Of course, the object is broken until the user picks one, but that would allow use of a grid. </P>
<P>(We're using a third-party control library and null values aren't a problem for their combo-type control)</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
