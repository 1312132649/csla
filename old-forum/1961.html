<html><header><title>DBConcurrencyException</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>DBConcurrencyException</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1961.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Nemisis posted on Wednesday, December 13, 2006</h2><P>Hi everyone, hope everyone is looking forward to xmas break! i am!<BR><BR>probably a simple question for someone, but i have coded in concurrency checks into my code, and a DBConcurrencyException is raised, but Csla wraps exceptions?<BR><BR>How can i tell if a DBConcurrencyException occurred on my website/Windows Form?<BR><BR>At the moment the code is as follows<BR><BR>Try<BR>&nbsp;&nbsp;&nbsp;&nbsp; Company.Save<BR>Catch Ex as DBConcurrencyException<BR>&nbsp;&nbsp;&nbsp;&nbsp; MsgBox "Concurrency Exception"<BR>Catch Ex as Exception<BR>&nbsp;&nbsp;&nbsp;&nbsp; MsgBox "Update Error in database"<BR>End Try</P>
<P>But ex on DBConcurrencyException is never caught, anbd always caught on Ex as Exception.<BR><BR>Would really appreciate some help<BR><BR>Thanks in advanced.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Wednesday, December 13, 2006</h2>Yes: csla does wrap exceptions in some places.<br><br>Just, recursively check the InnerException and StackTrace properties for additional clues. Also, some of the exceptions thrown by csla have a BusinessException property that contains the wrapped exception.<br><br>Bayu<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RRorije replied on Wednesday, December 13, 2006</h2>I agree,<br><br>I think the error handling could be something like this, I typed this without testing, directly in the editor, so some things may be named slightly different.<br><br>Try<br>&nbsp;&nbsp;&nbsp;&nbsp; Company.Save<br>Catch Ex as CSLA.DataportalException<br>&nbsp;&nbsp;&nbsp; If typeof(Ex.BusinessException) is gettype(DBConcurrencyException) Then<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; MsgBox(Ex.BusinessException.Message) <br>&nbsp;&nbsp;&nbsp; Else<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;  'Other exception<br>&nbsp;&nbsp;&nbsp; End If<br>Catch Ex as CSLA.ValidationException<br>&nbsp;&nbsp;&nbsp;&nbsp; MsgBox Company.ValidationRules.ToString()<br>End Try</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Wednesday, December 13, 2006</h2>I merely meant something like this:<br><br>&nbsp;&nbsp;&nbsp; Public Shared Sub Handle(ByVal ex As Exception)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Print("Exception Occurred (" &amp; DateTime.Now.ToShortTimeString &amp; ")")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Report(ex)<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>&nbsp;&nbsp;&nbsp; Private Shared Sub Report(ByVal ex As Exception)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim msg As New Text.StringBuilder<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; msg.AppendLine("Type of Exception: " &amp; ex.GetType.ToString)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; msg.AppendLine(ex.Message)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; msg.AppendLine()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; msg.AppendLine(ex.StackTrace)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Print(msg.ToString)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If TypeOf ex Is DataPortalException Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim dpex As DataPortalException = DirectCast(ex, DataPortalException)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not IsNothing(dpex.BusinessException) Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Report(dpex.BusinessException)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not IsNothing(ex.InnerException) Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Report(ex.InnerException)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br><br>&nbsp;&nbsp;&nbsp; End Sub<br><br>&nbsp;&nbsp;&nbsp; Private Shared Sub Print(ByVal msg As String)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.WriteLine(msg)<br>&nbsp;&nbsp;&nbsp; End Sub<br><br><br>In this case also all inner-exceptions and business-exceptions are reported in full.<br><br>Bayu<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
