<html><header><title>Ms Project modeling with Csla</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Ms Project modeling with Csla</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/27.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>CslaNut posted on Monday, May 08, 2006</h2><P>How would you model project plans and particularly rules for valid plans when the project plans can come from the following sources?</P>
<P>1) project server</P>
<P>2) the automation client</P>
<P>3) local database</P>
<P>I want to 'normalize' the behavior of business rules related to validation of the project plan.&nbsp; Would you create a project model to load the project from the project server using the PDS (project data services)&nbsp;or a remote data portal?&nbsp; The automation client has a different performance curve than the database.&nbsp; A local MS Access database adds a different set of characteristics.&nbsp; However, the rules that validate a project plan are the same regardless of where the data comes from.&nbsp; Would you have a 'ProjectPlan' Csla object with 3 different data access models?&nbsp; This makes the automation client data access VERY complex and creates poor performance.</P>
<P>How about a ProjectPlanValidator?&nbsp; I still need a hierarchy of iterators that can traverse a&nbsp;rather involved object model.&nbsp; Any thoughts on the business objects invovled?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>guyroch replied on Monday, May 08, 2006</h2><P class=MsoNormal>Yes, I would have 1 object with all of the ProjectPlan business rules.<SPAN>&nbsp; </SPAN>The fact that you have up to 3 different data sources should not be that complex.<SPAN>&nbsp; </SPAN>The DataPortal_XYZ methods for data access are very isolated and in fact should make it very easy to implement 3 data sources for the same object.<o:p></o:p></P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>You should look into creating an interface to get around you issue.<SPAN>&nbsp; </SPAN>Then have your ProjectPlan business object implement this interface.<SPAN>&nbsp; </SPAN>You could also have a web.config setting (or even a criteria parameter) that tells what is the datasource being used so that you make the appropriate call to you data souce via the interface.<o:p></o:p></P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>The interface could look like this:<o:p></o:p></P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal><SPAN>using</SPAN><SPAN> System;<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>using</SPAN><SPAN> System.Collections.Generic;<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>using</SPAN><SPAN> System.Text;<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>namespace</SPAN><SPAN> MyNamespace<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>{<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN><SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;summary&gt;<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN><SPAN>///</SPAN><SPAN> Interface implemented by server-side data portal<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN><SPAN>///</SPAN><SPAN> components.<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN><SPAN>///</SPAN><SPAN> </SPAN><SPAN>&lt;/summary&gt;<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN><SPAN>public</SPAN> <SPAN>interface</SPAN> <SPAN>IProjectPlan</SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN>{<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN>object rows = Fetch(object someParameter);<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN>int rowsInserted = Insert(object someParameter);<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN>int rowsUpdated = Update(object someParameter);<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN>int rowsDeleted = Delete(object someParameter);<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN>}<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>}<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>Hope this helps<o:p></o:p></P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>CslaNut replied on Tuesday, May 09, 2006</h2><P>Yes, I took that approach to begin with.&nbsp; However, there are 2 dozen data entities related to a ms project plan.&nbsp;&nbsp; The interfaces that have to be implemented with this approach are quite complex after awhile.&nbsp; The trick is the design of interfaces for all the entities involved.&nbsp; I frequently use an interface in my data access layer objects to isolate&nbsp;data access&nbsp;from the business object.&nbsp; Normally, I use the IDataReader interface to pass data back to the business object.&nbsp; That way I can create mock objects for testing.&nbsp; However, the number and complexity of project plans require a more sophisticated interface.&nbsp;&nbsp; Especially when considering the automation data source, which is significantly different than the database structures.</P>
<P>The interface structure will have to be some kind of facade or even a flyweight pattern I suppose.</P>
<P>Another challenge that I tried and gave up on was the testing piece.&nbsp; I could NOT figure out how to test the automation object hierarchy implementation using NUnit tests.&nbsp; The problem was Ms Project's automation heirarchy seems to only operate inside of the client.&nbsp; So I did not figure out how to start the client from a test that could then access the automation object as a data source in order to test the implementation of the data access interface.&nbsp; I could test the consumption of the interface in the business objects easy enough, using NUnit and mock objects.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>CslaNut replied on Tuesday, May 09, 2006</h2><P>Another issue related to using the automation objects in Ms Project, is the method of accessing the automation object.&nbsp; That object exists BEFORE the business object does and must be encapsulated with the implementation of the data access layer's interface and then passed to the business object.&nbsp; This is a problem because this&nbsp;requires a 'RunLocal'&nbsp;attribute on the dataportal methods which have to be able to communicate with a remote dataportal to use the project server.</P>
<P>Perhaps the automation object, project server and ms access data sources require 3 different business objects and the business rules must be somehow encapsulated as a visitor.&nbsp; This way the various business object hierarchies could validate against the same set of business rules that are implemented in the visitor.&nbsp; What do you think?&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>guyroch replied on Tuesday, May 09, 2006</h2><P>This is where to buck stops for me.&nbsp; Evidently the issue your facing is way more complex that I originally though and I'm afraid I don't have any other clues for you, sorry!</P>
<P>I will trust that someone will take over with some sort of a solution for you.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>CslaNut replied on Wednesday, May 10, 2006</h2><P>I attended a preview of the Ms Project 2007 client/server last night.&nbsp; Now I have to look ahead to changes in all 3 data sources.</P>
<P>the database of the server is going to change, the local database structure will change AND the automation object hierarchy will change dramatically.&nbsp;&nbsp; So I have to consider how to implement rules across very complex object hierarchies that will change in the near future.</P>
<P>Perhaps normalizing behavior is NOT a good thing to do in this case.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
