<html><header><title>How to bind form control to collection item using string indexer</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How to bind form control to collection item using string indexer</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2288.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>GlennMiller posted on Tuesday, February 06, 2007</h2><P class=MsoNormal><FONT face=Calibri>I have a businessbase object&nbsp;that contains a list&nbsp;member of businessbase objects indexed by&nbsp;string. What I would like to do is bind an individual item from the list based on an index to text box controls using the Windows form designer; something like this: Customer.Contacts[“Bob”].Phone. <o:p></o:p></FONT></P>
<P class=MsoNormal><o:p><FONT face=Calibri>&nbsp;</FONT></o:p></P>
<P class=MsoNormal><FONT face=Calibri>When I create a new DataSource in Visual Studio it recognizes my&nbsp;member collection, but when I create a binding source on my form and attempt to bind to a text box, the collection member is no longer&nbsp;available. I can create another binding source based on the collection, but that always binds to the first row of the collection, not a particular indexed item. I know I can use a grid, but I don't want to use that interface for this project.<o:p></o:p></FONT></P>
<P class=MsoNormal><o:p><FONT face=Calibri>&nbsp;</FONT></o:p></P>
<P class=MsoNormal><FONT face=Calibri>public class Customer : BusinessBase&lt;Customer&gt;<o:p></o:p></FONT></P>
<P class=MsoNormal><FONT face=Calibri>{<o:p></o:p></FONT></P>
<P class=MsoNormal><FONT face=Calibri>private ContactList list;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // derived from ReadOnlyListBase </FONT></P>
<P class=MsoNormal><o:p><FONT face=Calibri>&nbsp;</FONT></o:p></P>
<P class=MsoNormal><FONT face=Calibri>public ContactList Contacts<o:p></o:p></FONT></P>
<P class=MsoNormal><FONT face=Calibri>{<o:p></o:p></FONT></P>
<P class=MsoNormal><FONT face=Calibri>&nbsp;&nbsp;&nbsp;&nbsp;get { return list; }<o:p></o:p></FONT></P>
<P class=MsoNormal><FONT face=Calibri>}<o:p></o:p></FONT></P>
<P class=MsoNormal><FONT face=Calibri>}<o:p></o:p></FONT></P>
<P class=MsoNormal><o:p><FONT face=Calibri>&nbsp;</FONT></o:p></P>
<P class=MsoNormal><FONT face=Calibri>public class ContactList : ReadOnlyListBase&lt;ContactList, Contact&gt;<o:p></o:p></FONT></P>
<P class=MsoNormal><FONT face=Calibri>{<o:p></o:p></FONT></P>
<P class=MsoNormal><FONT face=Calibri>public Contact this[string name]<o:p></o:p></FONT></P>
<P class=MsoNormal><FONT face=Calibri>{</FONT></P>
<P class=MsoNormal><FONT face=Calibri>&nbsp;&nbsp;&nbsp; get { … search for name and return instance }<o:p></o:p></FONT></P>
<P class=MsoNormal><FONT face=Calibri>}<o:p></o:p></FONT></P>
<P class=MsoNormal><FONT face=Calibri>}<o:p></o:p></FONT></P>
<P class=MsoNormal><o:p><FONT face=Calibri>&nbsp;</FONT></o:p></P>
<P class=MsoNormal><FONT face=Calibri>public class Contact : BusinessBase&lt;Contact&gt;<o:p></o:p></FONT></P>
<P class=MsoNormal><FONT face=Calibri>{<o:p></o:p></FONT></P>
<P class=MsoNormal><FONT face=Calibri><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN>private string phone;<o:p></o:p></FONT></P>
<P class=MsoNormal><FONT face=Calibri><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN></FONT></P>
<P class=MsoNormal><FONT face=Calibri><SPAN></SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public string Phone<o:p></o:p></FONT></P>
<P class=MsoNormal><FONT face=Calibri>{<o:p></o:p></FONT></P>
<P class=MsoNormal><FONT face=Calibri>&nbsp;&nbsp;&nbsp; get { return&nbsp;phone; }<o:p></o:p></FONT></P>
<P class=MsoNormal><FONT face=Calibri>}<o:p></o:p></FONT></P>
<P class=MsoNormal><FONT face=Calibri>}<o:p></o:p></FONT></P>
<P class=MsoNormal><o:p><FONT face=Calibri>&nbsp;</FONT></o:p></P>
<P class=MsoNormal><FONT face=Calibri>Any ideas how to use the form designer to bind a control to a specific string index of a collection?<o:p></o:p></FONT></P>
<P class=MsoNormal><o:p><FONT face=Calibri>&nbsp;</FONT></o:p></P>
<P class=MsoNormal><FONT face=Calibri>Thanks.<o:p></o:p></FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brian_peterson replied on Thursday, February 08, 2007</h2>Yeah I am interested in this as well. Anyone else have any thoughts on this?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Thursday, February 08, 2007</h2>Ok, so let me see if I get this straight...<br>You have a collection of items and a grid with a corresponding binding source that displays the list.<br>You want to display a set of controls so that the current selected item in the grid is bound to that set of controls.<br><br>Is this the scenario?<br><br>If it is, is your set of controls in it's own user control?<br><br>Here's the deal:<br>If you create your own user control to host the "editing" version and then you add the usercontrol to the form with the grid, it won't work straight off. The reason is that the user control uses it's own binding context and thus it's own currency manager. If this is the case, all you need to do is handle the "CurrentItemChanged" event in the bindingsource that's bound to the grid, and pass the value of the binding source's "Current" property to your user control. That will keep both things in sync. (Be aware that you may need to do the EndEdit in your UC's binding source before setting the newly focused item)<br><br>If you don't have a user control and the form has everything contained by itself, then it's ridiculously simple:<br><br>From the Datasources window, select the <b>collection</b> node you want to use, drop down the little combobox and choose a datagridview. Drag that node to the form and it'll create the grid and a bindingsource. Now go back to that same node and change it to "Details". Once again, drag it to the form and it'll create the controls and use the same binding source. Now both will be synced automatically and all you need to do is set the bindingsource.DataSource property to your actual collection when the form loads.<br><br><br><br>I hope this brings some light to the matter.<br><br>Andrés<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cash_pat replied on Thursday, February 08, 2007</h2>If I am not wrong did u mean this??<br><br><br>DataBindingSource.DataSource = mMasterTable<br>DataBindingSource.DataMember = "Children"<br><br>TextEdit1.DataBindings.Add(New System.Windows.Forms.Binding("EditValue", _<br>&nbsp;&nbsp;&nbsp; DataBindingSource.Item(0), "EmployeeName", True, _<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; System.Windows.Forms.DataSourceUpdateMode.OnPropertyChanged))</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Thursday, February 08, 2007</h2>No, you can't use a datamember because it's only one collection with children. You'd use a datamember if those children had child collections themselves and you wanted to display information about those grandchildren in a grid or in a binding navigator...<br>Also, in my example I'm assuming that the databindings are created through the designer instead of by hand.<br><br>Andrés<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
