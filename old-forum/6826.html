<html><header><title>SL2 CSLA v3.6.2 - Expecting element 'ArrayOfSerializationInfo' </title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>SL2 CSLA v3.6.2 - Expecting element 'ArrayOfSerializationInfo' </h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6826.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>davido posted on Monday, April 20, 2009</h2><P>I am trying to store data in a compressed state in IsolatedStorage</P>
<P>Deseializing gives me the following error but I can't see why? I followed the code through Serialize and it creates a <FONT color=#2b91af size=2><FONT color=#2b91af size=2>SerializationInfo per element + 1.</P></FONT></FONT>
<P>"Error in line 1 position 2. Expecting <STRONG>element 'ArrayOfSerializationInfo'</STRONG> from namespace 'http://schemas.datacontract.org/2004/07/Csla.Serialization.Mobile'.. </P>
<P><STRONG>Encountered 'Element'&nbsp; with name 'ArrayOfNameValueListBase.NameValuePairOfintstringzwHo_PEFv'</STRONG>, namespace 'http://schemas.datacontract.org/2004/07/Csla'."</P>
<P><BR>"&nbsp;&nbsp; at System.Runtime.Serialization.DataContractSerializer.InternalReadObject(XmlReaderDelegator xmlReader, Boolean verifyObjectName)<BR>&nbsp;&nbsp; at System.Runtime.Serialization.XmlObjectSerializer.ReadObjectHandleExceptions(XmlReaderDelegator reader, Boolean verifyObjectName)<BR>&nbsp;&nbsp; at System.Runtime.Serialization.DataContractSerializer.ReadObject(XmlReader reader)<BR>&nbsp;&nbsp; at Csla.Serialization.Mobile.MobileFormatter.Deserialize(XmlReader reader)<BR>&nbsp;&nbsp; at Csla.Serialization.Mobile.MobileFormatter.Deserialize(Stream serializationStream)<BR>&nbsp;&nbsp; at Csla.Serialization.Mobile.MobileFormatter.Deserialize(Byte[] data)<BR>&nbsp;&nbsp; at ICSharpCode.SharpZipLib.Wrapper.Deserialize(Type t, Byte[] objectData)<BR>&nbsp;&nbsp; at ICSharpCode.SharpZipLib.Wrapper.DecompressAndDeserialize(Type t, Byte[] bytData)<BR>&nbsp;&nbsp; at XXX.Business.BusinessClasses.ClassificationsLookup.GetClassifications(EventHandler`1 handler)"<BR></P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, April 21, 2009</h2>Serialization isn't a great way to store data.  There are many things that break such a scheme, and the purpose of serialization is to send objects over a wire.  If you try to use it for storage, you're bound to run into problems (such as this).<br /><br />You'd be better served creating a method that will store the data in a more permanant form.  </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>davido replied on Tuesday, April 21, 2009</h2><P>Thanks for the&nbsp;advice. Having looked at the bloat produced by MobileFormatter.Serialize I agree. However, using MobileFormatter takes care of all&nbsp;business base properties. If I was to populate my BO from a file format of my own choosing (something that has better storage characteristics) I wouldn't be sure what I need to set/call in terms of base class. I have the 2005 and 2008 books so if you knew where I should look to find out that would be great.</P>
<P>FYI I am using SharpZipLib to cut down on the size of the serialised data.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>davido replied on Tuesday, April 21, 2009</h2>Forgot to mention I sorted my earlier problem; typo on my part....mix up between <FONT color=#2b91af size=2><FONT color=#2b91af size=2>
<P>IsolatedStorageFile</FONT></FONT><FONT size=2>.GetUserStoreForSite and <FONT color=#2b91af size=2><FONT color=#2b91af size=2></P>
<P>IsolatedStorageFile</FONT></FONT><FONT size=2>.GetUserStoreForApplication</FONT></P>
<P><FONT size=2>AutoComplete is a mixed blessing ;)</P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, April 21, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>davido:</strong></div><div>
<P>If I was to populate my BO from a file format of my own choosing (something that has better storage characteristics) I wouldn't be sure what I need to set/call in terms of base class. I have the 2005 and 2008 books so if you knew where I should look to find out that would be great.</P>
<P></div></BLOCKQUOTE></P>
<P>CSLA defines a persistence model through the data portal. My recommendation would be to use that persistence model, so you'd persist your data using DataPortal_XYZ or object factory methods.</P>
<P>Remember that the data portal is invoked from your factory method (or BeginSave(), which you can override). So you can put code in those methods to check first and see if there's a client cache, ensuring you go to the server only if there isn't a client cache.</P>
<P>If there is a client cache you can still call the data portal, just call it in local mode.</P>
<P>Hopefully this makes sense. What I am saying is that you can implement <EM>both</EM> server-side and client-side persistence models, and your factory method can decide whether to have the data portal call the server (for server-side persistence) or local (for client-side persistence).</P>
<P>This way your client-side persistence can store just the object data, and you don't need to worry about the metadata (like IsNew, etc) because that'll get set appropriately based on your normal DataPortal_XYZ methods.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
