<html><header><title>Self Managing Business Objects</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Self Managing Business Objects</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3842.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Matt posted on Friday, November 02, 2007</h2>In working with csla and having to give business objects to wpf designers I have found a need to have a class that automatically does things, the most common of which is saving. This poses a problem though as the Clone() method must be used when saving and I haven't found a way to have the business object do this internally. Has anyone found a need to have an object like this where things just happen automagically as items are added/removed or properties have changed? If you have found a need how did you tackle the problem of the cloning with the saving?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Yang replied on Friday, November 02, 2007</h2><FONT color=#0000ff size=2>
<P>You can implement a base class like this that overrides the Save method by invoking the clone first before actually saving the object. You can derive your business objects&nbsp;that needs to be saved&nbsp;"automagically" from this class.&nbsp;There is also a collection class that does save after each edit. Please see EditableRootListBase. </P>
<P>Imports</FONT><FONT size=2> Csla</P></FONT><FONT color=#0000ff size=2>
<P>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>MustInherit</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> ClonedSavingBusinessBase(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Csla.BusinessBase(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T))</P>
<P></FONT><FONT color=#0000ff size=2>Inherits</FONT><FONT size=2> BusinessBase(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T)</P>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> Save() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> T</P>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> cloneT </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> T = Clone()</P>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> cloneT.Save()</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P>
<P>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, November 02, 2007</h2><P>Also be sure to check the newer versions of CSLA as Rocky has added AutoClone to the DataPortal. I think it is false for now by default and you can changeit tot True. In the next version he is going to make it True by Default because it should have always been that way.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Saturday, November 03, 2007</h2><P>On a related note, beware of EditableRootListBase unless you have the new AutoClone feature turned *on*. </P>
<P>I found that otherwise, ERLB would clone objects that weren't even dirty, perhaps when leaving a grid to edit the same item on a property sheet. At that point, the object in the ERLB and object on the form were two different objects. </P>
<P>With AutoClone, the object doesn't get cloned/saved unless it is dirty. Much better. </P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
