<html><header><title>Dependent validationrules</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Dependent validationrules</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7764.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>KJosh posted on Saturday, October 10, 2009</h2>I have classes Comapny, Employee, Class B. Company contains employee property, property1(property1 is of type Class B). <br>Employee has salaries property which is of BusinessListBase. Employee class contains one validation rule on the salaries property. I need to put dependency between property1 and salaries property. When property1 changes executes validation rules dependent on salaries property in Employee class. How to put this type of dependency when adding validation rules?<br><br>Thanks<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>KJosh replied on Sunday, October 11, 2009</h2>Basically the question is, How to put dependency between property of one class and to the class which contains validation rules?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Monday, October 12, 2009</h2><P>A normal dependency exists between two relatively simple properties of a single BO. I do not think your model qualifies.</P>
<P>In this case I would write a new validation rule in the top level Company object which had access to is two child objects Employee and ClassB. Then have the rule run inside Company whenever you call IsValid. (ValidationRulesCheckRules("MySpecialRule")) Or you can try to hook up events and listen for them to run the rule&nbsp;but that is more complex.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>KJosh replied on Monday, October 12, 2009</h2>Can you give me example for this? The new validation rule should depend on which property of Company?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Tuesday, October 13, 2009</h2><P>You do not have to use a real Property of Company.</P>
<P>You can create a fake property name instead.</P>
<P>The validation sub-system does not care if it is real or not. It is just that a change to a real property will cause a real rule to run. In this case you are going to run it manually as part of your call to Company.IsValid so using a fake property name is fine.</P>
<P>Joe</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
