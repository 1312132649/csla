<html><header><title>An ObjectFactory for ROLB</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>An ObjectFactory for ROLB</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6293.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong posted on Friday, January 30, 2009</h2><P>Hmm... Insert failed when doing ROLB.Add(ROB)</P>
<P>Ok, thats because ROLB.IsReadOnly should be false while adding the list items.<BR>But.... "cannot be used in this context because the set accessor is inaccessible"</P><FONT size=2></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>RelatieInfoList</FONT></FONT><FONT size=2> Fetch(</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>RelatieInfoCriteria</FONT></FONT><FONT size=2> criteria)<BR>...<BR>&nbsp;&nbsp;&nbsp;</FONT>RelatieInfoList</FONT></FONT><FONT size=2> result = (</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>RelatieInfoList</FONT></FONT><FONT size=2>)</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Activator</FONT></FONT><FONT size=2>.CreateInstance(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>typeof</FONT></FONT><FONT size=2>(</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>RelatieInfoList</FONT></FONT><FONT size=2>), </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>true</FONT></FONT><FONT size=2>);<BR>&nbsp;&nbsp;&nbsp;result.IsReadOnly = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>false</FONT></FONT><FONT size=2>;<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;foreach</FONT></FONT><FONT size=2> (</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>var</FONT></FONT><FONT size=2> item </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>in</FONT></FONT><FONT size=2> queryResult)<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>RelatieInfo</FONT></FONT><FONT size=2> relatie = (</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>RelatieInfo</FONT></FONT><FONT size=2>)</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Activator</FONT></FONT><FONT size=2>.CreateInstance(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>typeof</FONT></FONT><FONT size=2>(</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>RelatieInfo</FONT></FONT><FONT size=2>), </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>true</FONT></FONT><FONT size=2>);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoadProperty(relatie, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>RelatieInfo</FONT></FONT><FONT size=2>.databronProperty, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>BusinessObjectDatabron</FONT></FONT><FONT size=2>.DiasDataBase);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoadProperty(relatie, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>RelatieInfo</FONT></FONT><FONT size=2>.naamProperty, item.Naam);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoadProperty(relatie, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>RelatieInfo</FONT></FONT><FONT size=2>.kenmerkProperty, item.Kenmerk);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result.Add(relatie);<BR>&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;result.IsReadOnly = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>true</FONT></FONT><FONT size=2>;<BR></FONT><FONT size=2>}</FONT><FONT size=2></P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Kevin Fairclough replied on Friday, January 30, 2009</h2>One possible solution would be to use the MethodCaller from Csla.Reflection.<br><br>MethodCaller.CallMethod(result, "Add", relate);<br><br>or.. you could expose an Add method on the ROLB specifically for the factory that takes in the queryResult<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Kevin Fairclough replied on Friday, January 30, 2009</h2>Probably best to only have the reflection call once, so I would add a method to a derivative of ReadOnlyListBase that takes in the list to add to itself.<br><br>Then either that method would be public or you can use CallMethod to call that Add once.<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong replied on Friday, January 30, 2009</h2>I've reintroduced the Add method in my base class for ROLB and made it internal so the ObjectFactory's can access it.<br /><br />In our base class i wrote something like:<br /><br />IsReadOnly = false;<br />base.Add(item);<br />IsReadOnly = true;<br /><br />Works ok ;)</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
