<html><header><title>Do you test common buisness rules?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Do you test common buisness rules?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9433.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>davekaro posted on Thursday, August 26, 2010</h2><p>I&#39;m wondering if people here write tests for the common rules they may add to a business object. For example, say you have a business object with these rules:</p>
<p>protected override void AddBusinessRules()<br />{<br />&nbsp;&nbsp;&nbsp; this.BusinessRules.AddRule(new Csla.Rules.CommonRules.Required(TitleProperty));<br />&nbsp;&nbsp;&nbsp; this.BusinessRules.AddRule(new Csla.Rules.CommonRules.MaxLength(DescriptionProperty, 300));<br />}</p>
<p>would you then write tests like:</p>
<p>var businessObject = BuisnessObject.NewBusinessObject();<br />Assert.IsFalse(businessObject.IsValid);<br />Assert.IsTrue(businessObject.BrokenRulesCollection.Contains(&quot;rule://csla.rules.commonrules.required/Title&quot;));</p>
<p>businessObject.Title = &quot;test&quot;;</p>
<p>Assert.IsFalse(businessObject.BrokenRulesCollection.Contains(&quot;rule://csla.rules.commonrules.required/Title&quot;));</p>
<p>&nbsp;</p>
<p>Or something along those lines. If you do do this, why? If you don&#39;t do this, why?</p>
<p>&nbsp;</p>
<p>Dave</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Phlar replied on Thursday, August 26, 2010</h2><p><span style="font-size:9pt;color:black;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;">Hi Dave,</span></p>
<p><span style="font-size:9pt;color:black;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;">Yes, we test every business rule in our system for completeness.&nbsp; It&#39;s possible another developer/group of developers will make a modification and change the logistics of the rule in question.&nbsp; </span></p>
<p><span style="font-size:9pt;color:black;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;">In your example, someone could change the MaxLength rule for the Description property from 300 to 500 but not realize the implications of these changes (i.e. DB size limitation, Web Service Contract size limitation, etc...).&nbsp; Your automatic test scripts should catch these types of errors and warrant additional investigation.</span></p>
<p>It also provides a complete unit test case to ensure all boundary checks are still valid.&nbsp; <img src="http://forums.lhotka.net/emoticons/emotion-1.gif" alt="Smile" /></p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>reagan123 replied on Monday, August 30, 2010</h2><p>I plan on testing my validation rules as well.&nbsp; Can anyone post an example of the test they are using for their CSLA objects?&nbsp; I&#39;ve always been interested in different approaches.</p>
<p>Thanks!</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, August 30, 2010</h2><p>It should be possible to directly unit test the Execute() method of a rule. You&#39;d need to create a mock context object that exactly matches the context object CSLA provides to the rule at runtime, but otherwise this should be pretty straightforward. This is only really possible if your rule does not use the Target property and gets all its values through the input properties dictionary. This type of unit test is not a bad idea, as it directly establishes that the rule itself works.</p>
<p>Beyond that, you need to instantiate a business object and set the property to which the rule is attached. This is really more of an integration test, since you may obviously invoke numerous rules, and all the normal short-circuiting and priority concepts come into play.</p>
<p>To instantiate a business object, you may need to have a mock database, which can be done using options 2-4 of the various data portal scenarios (<a href="http://www.lhotka.net/cslanet/faq/DataFaq.ashx">http://www.lhotka.net/cslanet/faq/DataFaq.ashx</a>).</p>
<p>That&#39;s also true if your rule interacts with the database, which some rules do. Having that mock database capability is pretty important for any meaningful testing.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
