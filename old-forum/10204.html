<html><header><title>Debugging WCF Service for a CSLA Silverlight app</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Debugging WCF Service for a CSLA Silverlight app</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10204.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>MichaelMaddox posted on Friday, March 25, 2011</h2><p>I have downloaded the CSLA source (latest version) and I can debug through the SimpleApp sample on the Silverlight side, but I can&#39;t get the debugger to break in the WcfPortal code or the CustomerEdit DataPortal_Insert() method.&nbsp; I know that code is being executed because if I add an exception throw in DataPortal_Insert, the exception is displayed in the UI (with an incomplete stack trace - I can&#39;t determine how the stack trace is getting truncated).</p>
<p>In general, I am having trouble understanding what magic happens between the SaveButton in Page.xaml on the Silverlight side and the DataPortal_Insert method on the WCF side.&nbsp; The deepest I can get in the debugger is the BeginUpdate method in WcfPortalClientChannel in the autogenerated Reference.cs proxy code.</p>
<p>I have written other XAML code that is not hitting the DataPortal_* methods on the WCF side and I&#39;d like to at least be able to debug through and see how the &quot;resolver&quot; determines which DataPortal_* method to call and why if the proper method doesn&#39;t exist it appears as if no error gets thrown to understand what is going wrong.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Friday, March 25, 2011</h2><p>If you have the SL and web projects in the same solution, the debugger should &quot;just work&quot;.</p>
<p>It is possible the client call never reaches the server though (maybe a mis-matched URL in the client config?), and of course then the server code would never break in the debugger because it would never run at all.</p>
<p>That&#39;s the most likely reason the debugger doesn&#39;t break in the server code.</p>
<p>If the save fails, the error should roll up to the OnError method in the viewmodel though, so you should see the exception.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>MichaelMaddox replied on Saturday, March 26, 2011</h2><p>
<p>I figured this out, mostly by finding a different CSLA sample where I could debug the WCF code and then guessing at what was different between the two projects.</p>
<p>I re-extracted SimpleApp from the sample zip and started over. &nbsp;The startup project was set to SimpleApp by default (the Silverlight project). &nbsp;Running that gives this error:</p>
<p>---------------------------</p>
<p>An error occurred while trying to make a request to URI &#39;http://localhost:1993/WcfPortal.svc&#39;. This could be due to attempting to access a service in a cross-domain way without a proper cross-domain policy in place, or a policy that is unsuitable for SOAP services. You may need to contact the owner of the service to publish a cross-domain policy file and to ensure it allows SOAP-related HTTP headers to be sent. This error may also be caused by using internal types in the web service proxy without using the InternalsVisibleToAttribute attribute. Please see the inner exception for more details.</p>
<p>---------------------------</p>
<p>I &quot;fixed&quot; this issue originally by creating&nbsp;CrossDomain.xml and&nbsp;ClientAccessPolicy.xml files. &nbsp;Apparently, that is not the correct way to solve the problem.</p>
</p>
<p>The correct way is to set the startup project to SimpleApp.Web and the startup page to SimpleAppTestPage.html. &nbsp;Then debugging works as I want it to.</p>
<p>The truncated stack trace in the exception issue remains, but now that I can debug properly, I may be able to figure that one out.</p>
<p>Thanks for saying that it should work so I was motivated to beat my head against it some more.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Saturday, March 26, 2011</h2><p>Yes, this is perhaps the most common issue with Silverlight apps, and I&#39;m sorry I didnt&#39; think to suggest it.</p>
<p>For some reason, Silverlight solutions don&#39;t remember the correct startup project - apparently that isn&#39;t stored in the sln file or something.</p>
<p>So when a SL solution is opened by each new VS environment, the default startup app switches to the SL project, not the web project.</p>
<p>The crossdomain file will get the app working, but won&#39;t force the debugger to attach correctly to the web app.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
