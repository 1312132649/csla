<html><header><title>OT: Dynamic Reporting Using ReportingServices Local Mode in WinForms CSLA App</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>OT: Dynamic Reporting Using ReportingServices Local Mode in WinForms CSLA App</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7592.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>BigPines2 posted on Wednesday, September 09, 2009</h2>I am using ReportingServices in Local mode in my WinForms app. Although, ReportingServices has some nice things about it, I am getting tired of designing new reports for every simple list based report I want to run. Unfortunately, the report requires a strongly typed data source so you have to create a new report (and object) for each use. This is tedious and does not allow the flexibility I would like.<br><br>Eventually I am going to need something more dynamic. For instance, our operators are currently using an app that allows them to define their own custom reports. They define the fields and then only those columns show up on the report when it is run. I would eventually like to do something similar.<br><br>Ideally I'd like to use the same report for all list based "simple" reporting and just change the column headers and title. I thought of just binding to a schema with all string fields and then plugging in whatever string collection object I want to display but even this requires you to know how many columns you want to display and different lists have a different number of columns. Am I simply using the wrong tool? Is there something better to use for these generalized dynamic type of list reports?<br><br>I know there are lots of smart people on this forum and I'm sure somebody has already tackled this problem. Any advice is appreciated.<br><br>Mike<br><br>P.S. Because I got tired of creating new complicated strongly typed CSLA collections for every list type of report (I don't do code gen yet), I created a special report object inheriting from CommandBase that simply hits the DB and converts the SafeDataReader into a DataTable to send directly to the report. In the report designer, I set the report's data source to the specific Stored Procedure the object will be hitting. I know this is a real departure from CSLA's strongly typed objects but for reporting purposes, I think strongly typed lists are overkill. This option allows me to continue to use the data portal in a standard way and yet avoid most of the extra work of the strongly typed list. Anyway, this doesn't get me where I want to eventually go but it does help somewhat.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Wednesday, September 09, 2009</h2>Hi, <br><br>You can generate a report definition programmatically.<br><br>I know that there are developers that have generated the rdlc file (which is an xml-file) with headerinfo and columns based on the data object and then  bound the report and data in reportviewer to produce dynamic reports. <br><br>Have a look at the samples from <a href="http://www.gotreportviewer.com">www.gotreportviewer.com:</a><br> <ul><li><a href="http://www.gotreportviewer.com/DynamicTable.zip">Dynamic Table Report</a>&nbsp; as an example of to dynamically generate rdlc files. This sample is available in both C# and VB -the link provided here is for C#.</li><li><a href="http://www.gotreportviewer.com/DynamicMatrix.zip">Dynamic Matrix sample </a>shows how to generate RDLC at run-time based on user-specified options.</li></ul><br>The rdlc specification can be found on this page <a href="http://www.microsoft.com/sqlserver/2008/en/us/reporting.aspx">SqlServer 2008 Reporting</a>.<br><br>/jonnybee<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>BigPines2 replied on Wednesday, September 09, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>JonnyBee:</strong></div><div>Hi, <br><br>You can generate a report definition programmatically.<br><br>I know that there are developers that have generated the rdlc file (which is an xml-file) with headerinfo and columns based on the data object and then  bound the report and data in reportviewer to produce dynamic reports. <br><br>Have a look at the samples from <a href="http://www.gotreportviewer.com">www.gotreportviewer.com:</a><br> <ul><li><a href="http://www.gotreportviewer.com/DynamicTable.zip">Dynamic Table Report</a>&nbsp; as an example of to dynamically generate rdlc files. This sample is available in both C# and VB -the link provided here is for C#.</li><li><a href="http://www.gotreportviewer.com/DynamicMatrix.zip">Dynamic Matrix sample </a>shows how to generate RDLC at run-time based on user-specified options.</li></ul><br>The rdlc specification can be found on this page <a href="http://www.microsoft.com/sqlserver/2008/en/us/reporting.aspx">SqlServer 2008 Reporting</a>.<br></div></BLOCKQUOTE><br>This looks like it is *EXACTLY* what I was looking for! I will dig into this right away. :)<br><br>Thank you very much!<br><br>Mike<br><br>P.S. I will report back on how it goes.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, September 09, 2009</h2>Hmm... I was hoping to look at Reporting Services to let my users make their own reports, so I don't have to.  Anyone have any luck with that?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, September 09, 2009</h2><P>We just implemented an entire susbsystem of our Web app to allow users to design and manage reports using Reporting Services. It was quite a large undertaking. We built 20-30 different models which are connected to a common DataSource (think "connection string"). When a user creates a report based on the model they are automatically using the right data source and are limited to the fields in the model. We had 2 developers designing models.</P>
<P>I handled the Web Service interactions for deploying the models to the client's Report Server instance. One of the key things we stumbled over was the need to merge the DataSourceView XML&nbsp;into the end of the SemanticModel XML and deploy them as a single XML file! We also decided to encrypt the models and enforce a licensing scheme so that clients who want end users to build reports have to license each set of models for each major subsystem of our app. </P>
<P>A client "Admin" can assign permissions to users for licensed models and also let users assign permissions for each report that they create.</P>
<P>Not a whole lot of CSLA involved (if any) in all of this except for the Manage Models and Manage reports screens. </P>
<P>The creating, building and deploying of models through a web service is handled by a WinForms wizard that I wrote. I found a fantastic wizard.dll that makes building them a snap. (See <A href="http://www.codeproject.com/KB/miscctrl/DesignTimeWizard.aspx?msg=1308991">http://www.codeproject.com/KB/miscctrl/DesignTimeWizard.aspx?msg=1308991</A>)</P>
<P>I want to quit Web development and build wizards for a living! The wizard dll came with source code which I tweaked to make it even easier to use. Many people recommended adding a stack to track forward navigation and then just popping off the stack for the Back button. So I added the sample code to the source and it worked great! I found a small bug and was able to tweak the source code to handle that edge case. (<FONT color=#008000 size=2><FONT color=#008000 size=2>pop-up message boxes that leave you on the same page cause the page to get added to the stack again. So you need to make an extra Pop when navigating Back otherwise the user has to click Back a 2nd time.)</P></FONT></FONT><FONT size=2>
<P></P></FONT><FONT size=2>
<P></FONT><FONT size=2><FONT color=#000000 size=2>This is the code fix:<BR><BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>if</FONT></FONT><FONT size=2> (index == wiz.PageIndex &amp;&amp; wiz.PageStack.Count &gt; 0)<BR>&nbsp; index = (</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2>)wiz.PageStack.Pop();</P></FONT>
<P>I was even able to add my company logo to the wizard dll so that each page has it in the bottom left corner. I wrote another wizard for a different project and really enjoyed working with it.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, September 10, 2009</h2>Cool... that's what I was hoping for, building models and then letting the users go at it via reportbuilder.  <br /><br />Fortunately, it sounds like your application is larger and b/c its off the shelf, that's where the complexity came in.. my app is likely much smaller in scope (it has only me developing it for a few years) and internal.<br /><br />So you did build a UI to query the available reports on the report server?  That was my largest question mark... if the reports are on the server, how does my application get the list of them, know how to prompt for parameters (or does RS handle that?).<br /><br />I do have one wrinkle that maybe your experience could be adapted for.  The company I work for is family owned, and own three other companies.  Seperate, but not really (they all use the same two locations and are all on the main companys domain).  So I had to build branding in my application, and the database itself is seperate, but all four databases are on the same server... so I need to keep the reports seperate.  Any thoughts on that?<br /><br />Oh... also, did you use Sql 2008 or 2005?  We're still on 2005, but I  heard there were many improvements to reportbuilder in 2008.<br /><br />Thanks<br />Andy</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, September 10, 2009</h2><P>1. "So you did build a UI to query the available reports on the report server?" <BR>Yes. </P>
<P>2. "if the reports are on the server, how does my application get the list of them"<BR>You use Web Services. Luckily the WebService is identical for SQL 2005 and 2008! So you only need 1 Web Reference to create the proxy. I usually create a class that wraps the proxy so that I can construct it with all of the values that the proxy will need to make the connection. Many of them are "setup options" in our database so it is a simple matter of reading them out of the DB, getting an instance of my wrapper class and you now have a properly constructed proxy which can talk to the web service. By using DB values you can actually talk to different report servers using the exact same code since the DB values will be different for each client.</P>
<P>3. We decided up front to have a "well known" folder structure on the Report Server which we could then leverage in all of our code. When you use the Report Server UI and click Home you are at the top level. We have web service methods to "CreateFolders" which then go:</P>
<P>\AppName<BR>&nbsp; \Version<BR>&nbsp;&nbsp;&nbsp; \Models<BR>&nbsp;&nbsp;&nbsp; \Reports<BR>&nbsp;&nbsp;&nbsp; \DataSources<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \MyAppDBConnection (we have our own name for this but it is the connection to the app database)</P>
<P>4. We have other web service methods to deploy models, re-deploy models for a new version, copy reports from an old version to a new version (surprisingly there is no such feature in the MS product - you can *move* reports but not copy them.)</P>
<P>5. Report Builder 1.0&nbsp;in 2005&nbsp;is much simpler for a client to use. Report Builder 2.0 in 2008 is more powerful and thus more complex. A basic enduser has a shot at building reports in 1.0 - not so easy in 2.0. May need more advanced users for that. Or training.</P>
<P>Joe</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, September 10, 2009</h2>Joe, thanks for the great feedback!  I feel much more comfortable taking this approach now.  </div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
