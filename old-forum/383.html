<html><header><title>HOW TO Expose Child Broken Rules on the Parent</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>HOW TO Expose Child Broken Rules on the Parent</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/383.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Mr.Underhill posted on Thursday, June 15, 2006</h2><P>I have a parent object that contains a child object.&nbsp; The child object has its own Broken Rules Collection.&nbsp; If my Parent is invalid, it might be because the child is invalid.&nbsp; If I ask my Parent for the BrokenRules, the BrokenRules on the parent might be empty (because the broken rule is on the child).</P>
<P>&nbsp;</P>
<P>HOW TO Expose Child Broken Rules on the Parent?</P>
<P>&nbsp;</P>
<P>Thanks</P>
<P>=</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Pradeep replied on Thursday, June 15, 2006</h2><FONT size=2>
<P>What version of CSLA are you using? For 1.5 you have to write your own function to get the broken rule's list. Tere is an implementation provided by Peter in ActiveObjects.&nbsp; In that he loop's through each child object and builds an arraylist of broken rules. Take a look at that.</P>
<P>HTH</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jwooley replied on Thursday, June 15, 2006</h2><P>I posted an extraction of Petar's implementation on the old forum a while back. You may be able to search for it.</P>
<P>I'm curious, do you need the actual rules or just to know if the children are valid? If it is just the later, your parent object should override IsValid (and IsDirty) to do the following:</P>
<P>Return MyBase.IsValid AndAlso ChildCollection.IsValid. </P>
<P>Each level of the tree should only be responsible for the level directly below it. Parents should not be responsible directly for the grandchildren. If the children can report for them and their children, everything should cascade nLevels gracefully.</P>
<P>Jim Wooley<BR><A href="http://devauthority.com/blogs/jwooley/default.aspx">http://devauthority.com/blogs/jwooley/default.aspx</A></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Mr.Underhill replied on Thursday, June 15, 2006</h2><P>Thanks for your feedback, I'll take a look at Peter's work.&nbsp; I'm concern about getting access to the broken rules itself.&nbsp; The IsValid trick is also really important, and that I'm using already.</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>Thanks</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jdelano replied on Thursday, August 10, 2006</h2><P>I'm also looking to retrieve the BrokenRules string from the parent object, but I'm using CSLA 2.0. Has anything changed in that regard since 1.5?</P>
<P>Thanks,</P>
<P>John</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, August 10, 2006</h2>No, nothing has really changed in how broken rules are exposed to the UI from 1.53 to 2.0.<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jdelano replied on Thursday, August 10, 2006</h2><P>I've basically got one root object with lots of children collection objects displayed across multiple tabs on a tabbed interface, and it would be nice if the user knew approximately where the error was, so all I really want to do is give the user a hint at where to look. In other words, I really don't care what specific errors occurred on a specific grandchild object, but I do want to know&nbsp;whether or not a specific&nbsp;child object has invalid grandchildren. Does that make sense?</P>
<P>Since the number of child collections is static within my parent object, I know that I could expose a GetBrokenRulesString property and manually add my own "Error in: xyz collection" string for each of the child collections that are not valid. So, my question is whether or not there is any way to iterate through all the child collection classes within a given parent, or do I have to do something like this...</P>
<P>Public Property GetBrokenRulesString() as String<BR>&nbsp;&nbsp;&nbsp;Get<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim temp as String = ""<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Not Child1.IsValid Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp &amp;= "Error in Child1" &amp; vbCrLf<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Not Child2.IsValid Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp &amp;= "Error in Child2" &amp; vbCrLf<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return temp<BR>&nbsp;&nbsp;&nbsp;End Get<BR>End Property</P>
<P>I'm guessing the answer is going to have something to do with reflection (which I'm fairly new at), so could someone provide some example syntax?</P>
<P>Thanks,</P>
<P>John</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
