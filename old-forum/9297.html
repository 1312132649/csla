<html><header><title>Silverlight CommandBase questions</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Silverlight CommandBase questions</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9297.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>DanB posted on Thursday, July 29, 2010</h2><p>First, I&#39;m getting an error:</p>
<p>&quot;Attempt by method &#39;Csla.Core.FieldManager.FieldDataManager.ForceStaticFieldInit(System.Type)&#39; to access field &#39;BLayer.Email.ToggleReadFlagCommand.FolderNameProperty&#39; failed.&quot;</p>
<p>Yes, I have my backing fields as public static readonly.&nbsp; What else would cause that?</p>
<p>&nbsp;</p>
<p>Secondly, the Rolodex sample is using a command for an async business rule.&nbsp; I&#39;m trying to make one for an actual simple separate thing - updating a value in the database.&nbsp; So I&#39;m guessing much of the AsyncValidationRuleContext code is not applicable.&nbsp; I also don&#39;t really need a result back other than to know if there was an exception.</p>
<p>So, my command class is pretty simple.&nbsp; The fields/properties, constructor to pass them in, and the DataPortal_Execute method.</p>
<p>The code using it looks like this:</p>
<p>public void SetFlagBegin(bool newValue, Action&lt;Exception&gt; callback)<br />{<br />&nbsp;&nbsp; MyCommand command = new MyCommand( // set properties)<br />&nbsp;&nbsp; DataPortal&lt;MyCommand&gt; dp = new DataPortal&lt;MyCommand&gt;();<br />&nbsp;&nbsp; dp.ExecuteCompleted += (o,e) =&gt;<br />&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (e.Error != null)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { callback(e.Error); }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { callback(null); }<br />&nbsp;&nbsp; };<br />&nbsp;&nbsp; dp.BeginExecute(command)</p>
<p>Does that look right?</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Thursday, July 29, 2010</h2><p>Is it possible that the business object type itself isn&#39;t public? Silverlight reflection can only work on public elements - public types, public members, etc.</p>
<p>I don&#39;t see a problem with SetFlagBegin(), though if this is inside some other business object (and I suspect it is) then you might want to mark the object as busy/idle so it is possible for the UI (or other code) to know that something is going on.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DanB replied on Friday, July 30, 2010</h2><p>Palm-forehead slap of the day.&nbsp; My command class wasn&#39;t marked public.&nbsp; Doh!&nbsp; (Big clue was when I removed all the properties and then it failed in the ctor.)</p>
<p>Thanks for the heads up on MarkBusy/MarkIdle.&nbsp; My hopes that would bubble up through the ViewModel&nbsp;to my BusyIndicator were confirmed.&nbsp; Excellent!</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
