<html><header><title>Querying using Linq and an embedded Criteria Class</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Querying using Linq and an embedded Criteria Class</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4981.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>justin.fisher posted on Monday, June 16, 2008</h2><font face="Courier New">I'm relatively new to LINQ to SQL and I am a little confused on querying a datacontext for multiple criteria.&nbsp; For instance I have a contact object that has fields for all the familar information first name, last name, title, etc.<br><br>I was hoping to have a dataportal_fetch() method that could handle querying for any combination of query criteria.&nbsp; I began checking string.IsNullOrEmpty on each criteria property then running a query against the contact's datacontext but that is getting quickly out of hand.<br><br>In raw SQL I could just build the required query string then execute that and process a datareader to extract the results.&nbsp; I did a quick search on LINQ to SQL predicates and came up with some hits that look like an entire evenings worth of reading.<br><br>I'm sure that this has been tackled by someone reading this forum and was hoping someone has some existing CSLA specific information they could point me to.<br><br></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cliffordru replied on Monday, June 16, 2008</h2><P>You have a few options:</P>
<OL>
<LI>Write an initial LINQ query that is the least specific.&nbsp; Follow this query with if statements based on your criteria values, building new LINQ statements based on the criteria.&nbsp; This allows you to use LINQ but can quickly become a maintenance issue/violation of the DRY principle.</LI>
<LI>Use the Dynamic Query Library.&nbsp; These are extension methods that allow you to use string expressions instead of code expressions.&nbsp; You can dynamically gen your strings, then pass to the methods.</LI>
<LI>ADO.NET...if using dynamic sql or a stored procedure looks to be the cleanest solution, use it, you can use a mixture of LINQ and ADO.NET for your data access.</LI></OL>
<P>Hope that helps.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cliffordru replied on Monday, June 16, 2008</h2>One more item to note, you may want to revisit the responsibility of your object, if it is trying to do too much (retrieve different info based on different scenarios/use&nbsp;cases) you may want to consider breaking out the responsibilities across multiple objects.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>justin.fisher replied on Tuesday, June 17, 2008</h2><font face="Courier New">I appreciate the feedback Cliff.&nbsp; It turns out that after revisiting some of the requirements with the users the filtering was much simpler than I had anticipated.&nbsp; Things are much simpler now, since I don't have to worry about combining search criteria.&nbsp; Much easier to search on last name than last name and any number of other search criteria.<br><br>I did get a chance to look at some of the dynamic LINQ to SQL posts, I wasn't aware that these were extensions at first.&nbsp;&nbsp; I was a little hesitant to thrown another new element into the development mix for now.&nbsp; Especially since this is my first CSLA project so there is already a pretty steep learning curve. If I did have to implement this I would probably have opted for executing dynamic sql against the databae using ADO.net.<br><br><br></font></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
