<html><header><title>IsDeleted</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>IsDeleted</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1712.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Wal972 posted on Wednesday, November 08, 2006</h2><P>Hi,</P>
<P>I have an ASP.NET application which shows the list of pays to be processed. I want to use a checkbox to show and change the deleted state but I don't know how. Like in the yahoo messaging where a message can be marked for deletion. Any suggestions</P>
<P>Thanks</P>
<P>Ellie</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>guyroch replied on Wednesday, November 08, 2006</h2><P>When an object gets deleted from a list it's not really deleted, it gets pushed into a DeletedList collection.&nbsp; So you could toy with this to make it work.&nbsp; However, I think you'll have some issues given that your use case seems to be that you have a boolean indicator if the object is marked for deletion or not and doing it this way will mean that you'll have to do some gymnastic with both lists.<o:p></o:p></P>
<P>Alternatively, you could add your own boolean IsMarkedForDeletion property and let this property drive the show sort of speak.&nbsp; Then when the user hits save, loop through the list and _delete_ all rows that are IsMarkedForDeletion&nbsp;= true, then call the save method on you BO.<o:p></o:p></P>
<P>Hope this helps<o:p></o:p></P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, November 08, 2006</h2>Maybe a better way would be to override RemoveAt so that the item never ends up on the deleted list.<br><br>Deleting wouldn't remove it from the list (so its still displayed).&nbsp; On save, you just loop through the actual list (since DeletedList will always be empty) and process accordingly.<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, November 09, 2006</h2><P>I use the checkbox to IncludeLine or not on many of my web pages.</P>
<P>Each of my child BOs has a Boolean property to get/set to see if it is checked.</P>
<P>In the collection class I use code like this when saving:</P>
<P>&nbsp;&nbsp;&nbsp; Protected Friend Overridable Sub Update(ByVal tr As IDbTransaction, ByVal parent As ParentType)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim child As ChildType</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'need a way to delete existing data in DB. Do this by unchecking them on the screen and testing if they are New.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For i As Integer = List.Count - 1 To 0 Step -1<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; child = Me.Item(i)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If child.IsNew = False AndAlso child.Includeline = False Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.List.Remove(child)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next i</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For Each child In DeletedList<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; child.Update(tr, parent)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DeletedList.Clear()</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For Each child In List<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If child.Includeline = True Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; child.Update(tr, parent)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next<BR>&nbsp;&nbsp;&nbsp; End Sub</P>
<P>I let the user check/uncheck as many rows as they like.</P>
<P>If they add&nbsp;one or more&nbsp;new rows then we only care about saving therm if they are checked.</P>
<P>Rows that are in the DB and get unchecked need to be deleted from the DB when Saved. That is the purpose of the first block of code. It removes them from the List and puts them in the Deleted list where they get deleted from the DB. Then the remaining checked items get saved to the DB.</P>
<P>Joe</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
