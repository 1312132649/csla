<html><header><title>Validation with Priority help</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Validation with Priority help</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/12064.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jasona22 posted on Monday, July 08, 2013</h2><p>I have a rule written as such:</p>
<p>BusinessRules.AddRule(Of BusObj)(_statusProperty, Function(obj As BusObj) obj.Status = &quot;some test value&quot;, &quot;Error Message&quot;, RuleSeverity.Error)</p>
<p>I am not having success adding the &quot;With { .Priority = 1 }&quot; to this.&nbsp; Where does this go?&nbsp; I can use this with other definitions, but can&#39;t find any references for the above version.</p>
<p>&nbsp;</p>
<p>Thanks</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Monday, July 08, 2013</h2><p>Hi,</p>
<p>Yes, when these RuleExtensions were written we regarded them pretty much like DataAnnotations - that always have Priority = 0.<br />But overall the rule extensions is just a simplified way of adding Lambda rules with an optionally strong typed lambda statement.</p>
<p>&nbsp;You could add your own RuleExtension method that accepts Priority or write is as a Lambda rule or create an ordinary BusinessRule.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jasona22 replied on Tuesday, July 09, 2013</h2><p>&nbsp;</p>
<p>So what I think you said is that I cannot add Priority=1 to this type of rule and need to write a custom rule instead.</p>
<p>I don&#39;t know what you mean by write my own RuleExtension.&nbsp; It seems the problem with using frameworks is not only do you have to be an expert in your business, but you have to become an expert in the framework your using as well so you can extend it and write parts that don&#39;t actually exist -- especially when it almost works.</p>
<p>Thank you for your reply.&nbsp; I will confer with my team and we will decide how to proceed.&nbsp; Maybe we just don&#39;t do the priority thing for this scenario.</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, July 09, 2013</h2><p>ExtensionMethods is language feature of C# and VB.NET&nbsp;</p>
<p>So the method your were using to register the rule is &nbsp;(from an implementation perspective) Extension Methods to BusinessRules class that simplifies the use of the existing Lambda rule. These ecxtension methods is placed in the Csla.Rules.RuleExensions class.&nbsp;</p>
<p>You _can_ look at the Csla.Rules.RuleExtensions class and create your own additional extension methods or create a lambda rule directly or create a custom rule.&nbsp;</p>
<p>For my own preferences is typically do not use Lambda rules as they are not so easily testable - so I prefer to create separate rule classes that I can create good unit tests on. &nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jasona22 replied on Tuesday, July 09, 2013</h2><p>&nbsp;</p>
<p>I completely understand not writing lambda rules as a best practice.&nbsp; Besides just testing, it puts the functionality across your business library in each class instead of in a singular custom rule that is a fix once/use often scenario.&nbsp;&nbsp; However, in this case, we are using CodeSmith to generate this particular rule.&nbsp; To prevent having to CodeSmith a custom rule and the references to it, we are writing it as a lambda.&nbsp; While looking at it won&#39;t seem like a reuse of code, it would still be fixed one place, regenerated and repaired everywhere (provided a bug was found).&nbsp; </p>
<p>The only reason I wanted to have a priority = 1 on it was because we already have a &quot;required&quot; rule for the property and I didn&#39;t want this rule to run when the value was &quot;empty string&quot;.&nbsp; The work around is to put an String.Empty check in my lambda rule.&nbsp; It solves the problem differently.</p>
<p>&nbsp;</p>
<p>Thanks for the info on the Extension Methods.&nbsp; I have been so tucked away in code generation (note framework usage comment from before) that I have lost touch with many of the changes.&nbsp; Dang, lambda expressions are still difficult for me.&nbsp; I&nbsp; come from VB6 days and while do well in .net, I do not do as well with some of the newer features (to me newer).&nbsp; PFM (Pure Freakin Magic) of MEF for instance.&nbsp; Lambda, Extension methods, etc are all &quot;new&quot; to me and not a tool I always know to reach for.&nbsp; </p>
<p>Thanks again for your help.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, July 09, 2013</h2><p>Hi,</p>
<p>Just one more possible solution. </p>
<p>It would be perfectly valid to have a Required rule at Priority = -10 (or any negative number) tho.&nbsp;</p>
<p>And you could also change the BusinessRules.ProcessThroughPriority setting (remember this is an instance setting and must be done in DataPortal_XYZ methods) to negative number so that the Lambda rule would &nbsp;not be executed when a previous rule is broken with Severity = Error. . &nbsp;</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
