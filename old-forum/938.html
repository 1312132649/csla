<html><header><title>Re-Binding necessary for Readonly BO properties?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Re-Binding necessary for Readonly BO properties?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/938.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>marioe2000 posted on Thursday, August 17, 2006</h2><P>I have a BusinessBase descendant that is composed of a few string properties as well as a single&nbsp;ReadOnlyBase object. <o:p></o:p></P>
<P>Simplified version:<o:p></o:p></P>
<P class=MsoNormal><SPAN>Public Class ROZipCode<BR><SPAN>&nbsp; </SPAN>Inherits ReadOnlyBase<BR><BR><SPAN>&nbsp; </SPAN>private _ZipCode as string<BR><SPAN>&nbsp; </SPAN>private _County as string<BR><SPAN>&nbsp; </SPAN>private _State as string<BR><SPAN>&nbsp;</SPAN><BR><SPAN>&nbsp;</SPAN><SPAN>&nbsp;</SPAN>public readonly property ZipCode as string … <BR><SPAN>&nbsp;</SPAN><SPAN>&nbsp;</SPAN>public readonly property CountyName as string …<BR><SPAN>&nbsp; </SPAN>public readonly property StateName as string …<BR></SPAN></P>
<P class=MsoNormal><SPAN>...</SPAN></P>
<P class=MsoNormal><SPAN>End Class<o:p></o:p></SPAN></P>
<P>Public Class Location<BR><SPAN>&nbsp; </SPAN>Inherits BusinessBase<BR><BR>&nbsp; private _LocName as string<BR>&nbsp; private _LocDescription as string<BR>&nbsp; private _LocZIP as ROZipCode<BR><BR>&nbsp; public property LocName as string ...<BR>&nbsp; public property LocDescription as string<BR>&nbsp; public property LocZIP as ROZipCode<BR><SPAN>‘&nbsp; ... get/set methods (CheckRules &amp; MarkDirty called on set) for all properties<BR>‘ … DataAccess/ Shared Methods and the rest needed<BR><BR></SPAN><SPAN>End Class</SPAN><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Public Class EditLocationForm<BR><SPAN>&nbsp; </SPAN>Inherits System.Windows.Forms.Form<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>…<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>Public Sub BindFields()<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN>‘BindField for each Location property including LocZIP binded to a ButtonEdit ‘descendant that returns an ROZipCode.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN>‘ I’m also binding LocZIP properties to readonly text boxes for display purposes.<BR><SPAN>&nbsp; </SPAN>BindField(CheckBox1, “Checked”, SomeLocation, “IsDirty”)<BR><SPAN>&nbsp; </SPAN>BindField(TextBox1, “Text”, SomeLocation, “LocName”)<BR><SPAN>&nbsp; </SPAN>BindField(CustomLookupEdit1, “Text”, SomeLocation, “LocZIP”) 'Bound to a ROZipCode object<BR><SPAN>&nbsp; </SPAN>BindField(TextBox11, “Text”, SomeLocation.LocZIP, “CountyName”)<BR><SPAN>&nbsp; </SPAN>BindField(TextBox12, “Text”, SomeLocation.LocZIP, “StateName”)<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>End sub <o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>The CustomLookupEdit control is a descendant of a devexpress ButtonEdit control which through the Format/Parse mechanism “converts” a ROZipCode to text and back again; it also does some lookup and search functions. In the end it returns a ROZipCode to it’s bound property. This I know is working fine because the LocZIP property of SomeLocation changes accordingly whenever the custom control looks up a different zip code.<BR><BR>The problem is that although it’s value changes correctly within the Location instance, the textboxes to which the LocZIP properties are bound to (TextBox11, TextBox12) don’t get refreshed.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Why is this? At first I had forgatten to bind the checkbox to SomeLocation.IsDirty, but I’ve since corrected that and still no-go.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>I’ve done my fair share of research on both searchcsla.com and this forum to no‑avail.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Can some one point me in the right direction, I’m sure the answer to this is lurking somewhere but I Still Haven’t Found What I’m Looking For … <o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN><BR>Thanks<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Mario Estrella<o:p></o:p></SPAN></P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>marioe2000 replied on Friday, August 18, 2006</h2><P>The solution I'm using right now is trapping the Validated event for the custom lookup control from the EditLocationForm and do a re-bind. This works fine, but I dont think I should have to do it.</P>
<P>Is there a better approach to this?</P>
<P>Thanks</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, August 18, 2006</h2>The problem is that the RO object doesn't support the IPropertyChanged interface, and doesn't raise PropertyChanged events when the RO properties are updated.&nbsp; You'll have to manually implement this interface and raise the events to update the display.<br><br>HTH<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Friday, August 18, 2006</h2>I didn't read all the discussion, so forgive me if I'm off the subject...<br>But if you have a readonly property that changes based on others, you could override on property changed like:<br><br>Protected Overrides Sub OnPropertyChanged(propertyName as string)<br>If propertyName = "PropA" Or propertyName = "PropB" Then<br>PropertyHasChanged ("TheReadOnlyProp")<br>End If<br>End Sub<br><br><br><br>Andrés</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Friday, August 18, 2006</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>xal:</strong></div><div>I didn't read all the discussion, so forgive me if I'm off the subject...<br>But if you have a readonly property that changes based on others, you could override on property changed like:<br><br>Protected Overrides Sub OnPropertyChanged(propertyName as string)<br>If propertyName = "PropA" Or propertyName = "PropB" Then<br>PropertyHasChanged ("TheReadOnlyProp")<br>End If<br>End Sub<br>Andrés</div></BLOCKQUOTE><br>Is that necessary?&nbsp; I thought I remembered Rocky mentioning that DataBinding automatically refreshes all properties aside from the one that caused the update, hence the need for the BindingRefresh component.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>marioe2000 replied on Friday, August 18, 2006</h2><P>I'm still using CSLA 1.5 ... doing a little research it seems the IPropertyChanged interface is for CSLA 2.0 or at least .NET 2.</P>
<P>Am I correct? if so, is there something similar for CSLA 1.5?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Friday, August 18, 2006</h2>Well, in that case, the same thing &lt;should&gt; apply if you call PropertyChange() passing the new info...<br>You might have to bind something to isvalid / isdirty for that to work...<br><br>Andrés<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
