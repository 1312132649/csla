<html><header><title>OT: Obfuscation</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>OT: Obfuscation</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2496.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>cash_pat posted on Friday, March 09, 2007</h2>Hi,<br><br>Just wondering how everyone else is protecting their codes. I am soon going for a commercial application and i really want to do it with CSLA.NET.<br><br>Which obfuscators /linkers will work with CSLA.<br><br>thanks in advance,
<p>Cash</p><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, March 09, 2007</h2><P>I am pretty sure you cannot use an obfuscator with CSLA. I know it has been mentioned in the past.</P>
<P>What I am unsure of is:</P>
<P>Is it only CSLA itself that cannot be obfuscated?</P>
<P>Or is my Business Object library also one of the things which cannot be obfuscated?</P>
<P>Or both?</P>
<P>I think it is both - but would like this clarified.</P>
<P>Joe</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mercule replied on Friday, March 09, 2007</h2>Why couldn't you obfuscate CSLA?&nbsp; Is it a legal/license issue (totally understandable) or a technical one?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, March 09, 2007</h2>Technical.&nbsp; The DataPortal looks for methods with certain names to call and execute.&nbsp; Obfuscating would change the name of those private methods, and break the dataportal.&nbsp; <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bowman74 replied on Friday, March 09, 2007</h2><P>ajj,</P>
<P>Good point on the reflection issue; the more I hear the more I remember.&nbsp; Some commercial obfuscators allow you to make methods&nbsp;so their names&nbsp;won't be obfuscated.&nbsp; This would have to be done with the dataportal methods since their names are hard coded as strings in the dataportal itself.&nbsp; I think I may have even had a discussion with Rocky at the time of that being an advantage of using an interface for the dataportal methods.&nbsp; I'll have to look more for that paper I wrote on it but IIRC&nbsp;it could definitely be done with the correct tool in 1.5 and I can't think of anything in 2.x that would really have made that impossible.&nbsp; </P>
<P>Thanks,</P>
<P>Kevin</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cash_pat replied on Friday, March 09, 2007</h2>Thanks for all the info. But, I still looking for something positive. <br><br>If not, I may have to use the usual DAL for this commercial app, but I prefer to use CSLA over DAL.<br><br>If obfuscation is possible by modifiying the framework in some way. Could someone point in the right direction.<br><br>regards<br><br>cash<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bowman74 replied on Friday, March 09, 2007</h2><P>Cash,</P>
<P>I am 100% sure that obfuscation can be done without modifying the framework.&nbsp; IIRC this is what you need to do:</P>
<P>1)&nbsp;Mark all dataportal method&nbsp;names (DataPortal_Fetch, etc) as non obfuscated.&nbsp; This will allow the CSLA dataportal to find and create them with reflection.&nbsp; The fact that these are not obfuscated should not reveal anything about the proprietary business logic in your classes.</P>
<P>2) Make sure your criteria classes inherit from Criteriabase so the proper object is created by the data portal.&nbsp; I don't recall if this is strictly necessary but seems to be sticking around in my head as true.</P>
<P>3)&nbsp; If you want the public interface on your CSLA based DLLs to be obfuscated you need to use a obfuscation product that can obfuscate an entire solution as a unit.&nbsp; If you obfuscate on a project by project basis then you will need to not obfuscate the public interface so you can still use it in your calling projects.&nbsp; In that case only the implementation code inside the public methods would be obfuscated.&nbsp; This is nothing specific to CSLA but true of all projects you make with a publicly consumable interface.</P>
<P>Thats really all I remember.&nbsp; If there is something I forgot I'm sure someone else will chime in.</P>
<P>Thanks,</P>
<P>Kevin</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, March 09, 2007</h2>Bowman,<br><br>I think you'd still have to modify the framework; the DP also calls methods defined in BusinessBase, like MarkNew, MarkOld, etc.<br><br>I guess it does depend on the tool though.. although as someone else poitned out you need to obfuscate at the solution level, and that means each version of Csla will be different (because it has to be re-obfuscated for each solution, I would imagine).<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bowman74 replied on Friday, March 09, 2007</h2><P>Andy,</P>
<P>The solution thing was me but that's not really an issue here.&nbsp; You would only have issues with items such as MarkOld, MarkNew in BusinessBase if you actually obfuscated the CSLA DLLs themselves instead of just the proprietary DLLs that use CSLA.&nbsp; If you only obfuscate the DLLs that use CSLA then the inherited MarkNew and MarkOld methods wouldn't be renamed anymore than the ToString method from System.Object does.</P>
<P>The reason for obfuscation in a commercial product is to stop reverse engineering of your proprietary content.&nbsp; There is not proprietary content in the CSLA DLLs themselves so there would be no reason to obfuscate them.&nbsp; At least no more reason that you would want to obfuscate any of the .Net system DLLs.&nbsp; If you don't obfuscate the CSLA DLLs themselves then that problem vanishes.</P>
<P>The reason why you want an obfuscator that works on a solution is so that your projects that use those proprietary DLLs can actually be written/maintained if the DLL's public interfaces have been obfuscated as well as the implementation code.</P>
<P>Thanks,</P>
<P>Kevin</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, March 09, 2007</h2>I would think, though, that either you'd have to mark your overloaded (strongly typed) DP_Fetch() methods (for example) so they wouldn't be obfuscated, or you'd need to NOT overload them, and simply override the not-strongly-typed ones from the CSLA .NET base classes.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bowman74 replied on Monday, March 12, 2007</h2><P>Rocky,</P>
<P>Exactly, I had mentioned that obfuscators allow you to mark up&nbsp;method signatures you choose not to be obfuscated&nbsp;and the dataportal methods would be prime candidates for this.&nbsp; The ability to have strongly typed dataportal methods based on the specific criteria classes is very cool and would be hard to loose.</P>
<P>Thanks,</P>
<P>Kevin</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bowman74 replied on Friday, March 09, 2007</h2><P>I had looked into this a few years ago with CSLA.Net 1.5.&nbsp; What you need is a tool (and there are a few out there) that can obfuscate a solution as a whole.&nbsp; That is, so every project in the solution is using and understands the replaced names.&nbsp; If you try and obfuscate each DLL individually you will run into trouble.</P>
<P>I just don't recall all of the issues at this point nor can I find the white paper I wrote about it for the client the explained the issues and had the results of my testing.&nbsp; I do recall that it could be done with the correct solution wide tool.&nbsp; For whatever reason I also thing that your criteria object might have to inherit from criteriaBase to pass in the proper (obfuscated) type to the constructor so the data portal creates the correct object type.&nbsp; We always used generated code so we did this anyway.</P>
<P>I wish I could remember more about it.</P>
<P>Thanks,</P>
<P>Kevin</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
