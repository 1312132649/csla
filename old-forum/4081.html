<html><header><title>Core bug</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Core bug</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4081.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rxelizondo posted on Saturday, December 22, 2007</h2><P>Ok, it’s late and I am really, really tired right now so I hope I am not screwing up by labeling this a bug. I writing this now because I leave tomorrow for vacations and I am not sure when I will get the time to log this if not right now.</P>
<P><BR>Ok, here is the deal. If you look at the “UndoableBase” class, there is a method called “GetFieldName”.&nbsp; The method body contains the following instruction:</P>
<P><BR><STRONG><FONT color=#000080>return field.DeclaringType.Name + "!" + field.Name;</FONT></STRONG></P>
<P><BR>The problem with this is that this really needs to be:</P>
<P><BR><STRONG><FONT color=#000080>return field.DeclaringType.FullName + "!" + field.Name;</FONT></STRONG></P>
<P><BR>The reason why it needs to be “FullName” is because someone can create a custom class called “BusinessBase” (the same name as what the CSLA uses) and add a field to this custom class using the same field name as one of the persistent fields of the CSLA “BusinessBase” properties. For example:</P>
<P>-----<BR><STRONG><FONT color=#000080>MyNameSpace<BR>class BusinessBase<BR>{<BR>&nbsp;&nbsp;&nbsp;private int EditLevel<BR>}</FONT></STRONG> <BR>-----</P>
<P><BR>&nbsp;If someone does this, when the CSLA tries to copy the state you will be getting a duplicate key exception when trying to insert the value in the “HybridDictionary” collection.</P>
<P class=MsoNormal><FONT face=Calibri>Of course, this problem is more likely to occur if the code is obfuscated since the obfuscation process will try to rename the classes as short as possible so the possibility having conflicting names it’s much bigger with obfuscated code.</FONT><BR></P>
<P><BR>Thanks (I am going to sleep!!)<BR></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rxelizondo replied on Thursday, January 10, 2008</h2><P class=MsoNormal><FONT face=Calibri>Any comments on this anyone?</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, January 11, 2008</h2>This seems like a reasonable change, I'll try to fit it into 3.5.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
