<html><header><title>Possible Bug Report for PTracker App v3.5 Beta 1</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Possible Bug Report for PTracker App v3.5 Beta 1</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4271.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>emmanuel posted on Thursday, January 31, 2008</h2><P>Hi</P>
<P>I believe this is a bug in v3.5 Beta 1:</P>
<P>Try this:</P>
<P>1) Login to PTWin as power</P>
<P>2) Create New Resource</P>
<P>3) Enter First Name and Last Name</P>
<P>4) Click on Apply</P>
<P>I'm getting an exception in FieldDataManager.cs:</P><FONT color=#0000ff size=2>
<P>throw</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> UndoException(</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2>.Format(Properties.Resources.EditLevelMismatchException, </FONT><FONT color=#a31515 size=2>"CopyState"</FONT><FONT size=2>));</FONT></P>
<P><FONT size=2><FONT face=Arial size=3>You will not get this error if you click OK or if you do the same with a New Project.</FONT></FONT></P>
<P><FONT size=2><FONT face=Arial size=3>It seems to only fail when you click Apply after filling out a New Resource.</FONT></FONT></P>
<P><FONT size=2><FONT face=Arial size=3>It seems that the Resource.cs may be missing a <FONT size=2>DataPortal_Create() such as:</FONT></FONT></FONT></P><FONT size=2><FONT face=Arial size=3><FONT size=2><FONT size=2>
<P>[</FONT><FONT color=#2b91af size=2>RunLocal</FONT><FONT size=2>()]</P>
<P></FONT><FONT color=#0000ff size=2>protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>override</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> DataPortal_Create()</P>
<P>{</P>
<P></FONT><FONT color=#008000 size=2>// nothing to initialize</P></FONT><FONT size=2>
<P>ValidationRules.CheckRules();</P>
<P>}</P>
<P>But that still doesn't work.</P>
<P>I have found a workaround which may help discover the bug.</P>
<P>Add a Dummy Property in Resource.cs like so:</P><FONT size=2>
<P></FONT><FONT color=#008000 size=2>// Dummy variable to fix bug that prevents you from pressing Apply to save a New Resource! [let Dummy=0; in DataPortal_Create() method]</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>static</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>PropertyInfo</FONT><FONT size=2>&lt;</FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2>&gt; DummyProperty = RegisterProperty&lt;</FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2>&gt;(</FONT><FONT color=#0000ff size=2>typeof</FONT><FONT size=2>(</FONT><FONT color=#2b91af size=2>Resource</FONT><FONT size=2>), </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>PropertyInfo</FONT><FONT size=2>&lt;</FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2>&gt;(</FONT><FONT color=#a31515 size=2>"Dummy"</FONT><FONT size=2>, </FONT><FONT color=#a31515 size=2>"dummy property"</FONT><FONT size=2>));</P>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> Dummy</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>get</P></FONT><FONT size=2>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> GetProperty&lt;</FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2>&gt;(DummyProperty);</P>
<P>}</P>
<P></FONT><FONT color=#0000ff size=2>set</P></FONT><FONT size=2>
<P>{</P>
<P>SetProperty&lt;</FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2>&gt;(DummyProperty, </FONT><FONT color=#0000ff size=2>value</FONT><FONT size=2>);</P>
<P>}</P>
<P>}</P>
<P>Now simply modify the above DataPortal_Create() to assign 0 to Dummy like so:</P><FONT size=2>
<P>[</FONT><FONT color=#2b91af size=2>RunLocal</FONT><FONT size=2>()]</P>
<P></FONT><FONT color=#0000ff size=2>protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>override</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> DataPortal_Create()</P>
<P>{</P>
<P></FONT><FONT color=#008000 size=2>// nothing to initialize</P></FONT><FONT size=2>
<P>Dummy = 0; </FONT><FONT color=#008000 size=2>// simply add this to Apply to save new resources</P></FONT><FONT size=2>
<P>ValidationRules.CheckRules();</P>
<P>}</P>
<P>This should work.</P>
<P>I hope this helps!</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>Emmanuel.</P></FONT></FONT></FONT></FONT></FONT></FONT>
<P><FONT size=2><FONT face=Arial size=3></FONT>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, February 01, 2008</h2><P>Great catch, thank you!!</P>
<P>There was a bug in the way n-level undo and data binding interact and the way things cascaded down to child objects (like the FieldDataManager).</P>
<P>The fix is in svn.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
