<html><header><title>nullable db bit columns</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>nullable db bit columns</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3867.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>checlark posted on Thursday, November 08, 2007</h2>I have a SQL Server 2005 table that contains a bit column which is used as a boolean value. In my code I am using a nullable bool to represent this column. When adding a new row the db will show "NULL" in the column which is the desired behavior. Now when I grab that row to poulate the CSLA BO the SafeDataReader reads the value as false and I need it to return as null. I am using the dr.GetBoolean() method and have also tried to use the dr.GetByte() as well. In my case this column may or may not be set and if not then it is called an invariant. An example might be a person that is entered into my table and the sex of that person is unknown so the column should be null and it is when inserted but an update to that person will set the column to false due to the SafeDataReader returning false instead of null. Returning a false or female represented by a 0 is incorrect. Anyone run into this scenario?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>triplea replied on Thursday, November 08, 2007</h2>I prefer using 'Y'/'N' so don't have that much experience with bit columns. But you might want to check out the CSLA Contrib project in Codeplex since a SmartBool struct is provided which works pretty much like SmartDate. So I am pretty sure it will help you overcome the issues you are facing.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tetranz replied on Thursday, November 08, 2007</h2>The SafeDataReader does not directly support nullable types. The regular .NET DataReader doesn't either.<br><br>Read it as an object and cast it.<br><br>_sex = (bool?) dr.GetValue("Sex")<br><br>By the way, the Binding Format and Parse events are useful if you want to bind this to a tristate checkbox.<br><br>Ross<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ward0093 replied on Thursday, November 08, 2007</h2><P>I am doing the samething you are for a lot of different Datatypes... I had to create and override the CSLA SmartDateReader to handle this... It might at first glance seem like a lot of extra work but it works great and in ALL my BO objects I call the same function to load the value regardless of the data type and whether or not is a Nullable Type.</P>
<P>MyBusinessCore.Core.SmartDataReader</P>
<P>In my new object I created a simple function used for all type of data, nullable or not.&nbsp; Here is my function below:</P>
<P>I call is like this:</P><FONT size=2>
<P>mUserCreated = .GetValue(</FONT><FONT color=#0000c6 size=2>Of</FONT><FONT size=2> Nullable(</FONT><FONT color=#0000c6 size=2>Of</FONT><FONT size=2> Guid))("UserCreated")</FONT></P>
<P><FONT size=2>or</FONT></P><FONT size=2><FONT size=2>
<P>mIsDeleted = .GetValue(</FONT><FONT color=#0000c6 size=2>Of</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Boolean</FONT><FONT size=2>)("IsDeleted")</FONT></P>
<P>or </P>
<P>mIsMaleGender = .GetValue(<FONT color=#0000c6 size=2>Of Nullable(Of</FONT><FONT size=2>&nbsp;</FONT><FONT color=#0000c6 size=2>Boolean</FONT><FONT size=2>))("GenderIsMale")</FONT></P>
<P><FONT size=2></FONT>&nbsp;</P>
<P><FONT size=2>The new function is my overriden SmartDateReader looks like this:</FONT></P><FONT size=2><FONT color=#0000c6 size=2>
<P>Public</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Shadows</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Function</FONT><FONT size=2> GetValue(</FONT><FONT color=#0000c6 size=2>Of</FONT><FONT size=2> T)(</FONT><FONT color=#0000c6 size=2>ByVal</FONT><FONT size=2> name </FONT><FONT color=#0000c6 size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>String</FONT><FONT size=2>) </FONT><FONT color=#0000c6 size=2>As</FONT><FONT size=2> T</P>
<P></FONT><FONT color=#0000c6 size=2>Return</FONT><FONT size=2> GetValue(</FONT><FONT color=#0000c6 size=2>Of</FONT><FONT size=2> T)(GetOrdinal(name))</P>
<P></FONT><FONT color=#0000c6 size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Function</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000c6 size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Shadows</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Function</FONT><FONT size=2> GetValue(</FONT><FONT color=#0000c6 size=2>Of</FONT><FONT size=2> T)(</FONT><FONT color=#0000c6 size=2>ByVal</FONT><FONT size=2> i </FONT><FONT color=#0000c6 size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Integer</FONT><FONT size=2>) </FONT><FONT color=#0000c6 size=2>As</FONT><FONT size=2> T</P>
<P></FONT><FONT color=#0000c6 size=2>Dim</FONT><FONT size=2> rtn </FONT><FONT color=#0000c6 size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Object</FONT><FONT size=2> = </FONT><FONT color=#0000c6 size=2>Nothing</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000c6 size=2>Dim</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>As</FONT><FONT size=2> Type = </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(T)</P>
<P></FONT><FONT color=#008000 size=2>'///// IF WE HAVE A [NULL] VALUE COMING OUT OF THE DATABASE /////</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000c6 size=2>If</FONT><FONT size=2> IsDBNull(i) </FONT><FONT color=#0000c6 size=2>Then</FONT></P>
<P><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;If</FONT><FONT size=2> typeOfT.IsGenericType </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Nothing</FONT><FONT size=2> </FONT><FONT color=#008000 size=2>'IF NULLABLE TYPE, RETURN NOTHING FOR ALL FIELDS</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;ElseIf</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(</FONT><FONT color=#0000c6 size=2>Boolean</FONT><FONT size=2>) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtn = Convert.ToBoolean(</FONT><FONT color=#0000c6 size=2>False</FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;ElseIf</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(</FONT><FONT color=#0000c6 size=2>Byte</FONT><FONT size=2>) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtn = System.Byte.MinValue</P>
<P></FONT><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;ElseIf</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(</FONT><FONT color=#0000c6 size=2>Char</FONT><FONT size=2>) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtn = </FONT><FONT color=#0000c6 size=2>Char</FONT><FONT size=2>.MinValue</P>
<P></FONT><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;ElseIf</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(DateTime) </FONT><FONT color=#0000c6 size=2>OrElse</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(</FONT><FONT color=#0000c6 size=2>Date</FONT><FONT size=2>) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtn = </FONT><FONT color=#0000c6 size=2>Date</FONT><FONT size=2>.MinValue</P>
<P></FONT><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;ElseIf</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(</FONT><FONT color=#0000c6 size=2>Decimal</FONT><FONT size=2>) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtn = </FONT><FONT color=#0000c6 size=2>Decimal</FONT><FONT size=2>.Zero</P>
<P></FONT><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;ElseIf</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(</FONT><FONT color=#0000c6 size=2>Double</FONT><FONT size=2>) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtn = Convert.ToDouble(</FONT><B><FONT color=#625a42 size=2>0</B></FONT><FONT size=2>)</FONT></P>
<P><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;ElseIf</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(Guid) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtn = System.Guid.Empty</P>
<P></FONT><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;ElseIf</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(Int16) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtn = Convert.ToInt16(</FONT><B><FONT color=#625a42 size=2>0</B></FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;ElseIf</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(Int32) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtn = Convert.ToInt32(</FONT><B><FONT color=#625a42 size=2>0</B></FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;ElseIf</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(Int64) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtn = Convert.ToInt64(</FONT><B><FONT color=#625a42 size=2>0</B></FONT><FONT size=2>)</FONT></P>
<P><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;ElseIf</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(UInt16) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtn = Convert.ToUInt16(</FONT><B><FONT color=#625a42 size=2>0</B></FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;ElseIf</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(UInt32) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtn = Convert.ToUInt32(</FONT><B><FONT color=#625a42 size=2>0</B></FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;ElseIf</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(UInt64) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtn = Convert.ToUInt64(</FONT><B><FONT color=#625a42 size=2>0</B></FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;ElseIf</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(</FONT><FONT color=#0000c6 size=2>String</FONT><FONT size=2>) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rtn = </FONT><FONT color=#0000c6 size=2>Nothing</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000c6 size=2>Else</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;Throw</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>New</FONT><FONT size=2> NotSupportedException("The data type: " &amp; typeOfT.Name &amp; " is not supported." &amp; NewLine()&amp;&nbsp;&nbsp;&nbsp;&nbsp;"This method [" &amp; System.Reflection.MethodBase.GetCurrentMethod().Name &amp; "] in object [" &amp; System.Reflection.MethodBase.GetCurrentMethod.ReflectedType.Name &amp; "] is not supported.")</P>
<P></FONT><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;End</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;Return</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>CType</FONT><FONT size=2>(rtn, T)</P>
<P></FONT><FONT color=#0000c6 size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>'///// VALID DATABASE VALUE COMING OUT OF THE DATABASE /////</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>'///// SPECIAL DB FIELD CONVERSIONS ////</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000c6 size=2>If</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(Nullable(</FONT><FONT color=#0000c6 size=2>Of</FONT><FONT size=2> System.UInt16)) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;If</FONT><FONT size=2> DataReader.GetInt16(i) &lt; </FONT><B><FONT color=#625a42 size=2>0</B></FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Then</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Nothing</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;rtn = Convert.ToUInt16(DataReader.GetInt16(i))</P>
<P></FONT><FONT color=#0000c6 size=2>ElseIf</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(Nullable(</FONT><FONT color=#0000c6 size=2>Of</FONT><FONT size=2> UInt32)) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;If</FONT><FONT size=2> DataReader.GetInt32(i) &lt; </FONT><B><FONT color=#625a42 size=2>0</B></FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Then</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Nothing</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;rtn = Convert.ToUInt32(datareader.GetInt32(i))</P>
<P></FONT><FONT color=#0000c6 size=2>ElseIf</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(Nullable(</FONT><FONT color=#0000c6 size=2>Of</FONT><FONT size=2> UInt64)) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000c6 size=2>&nbsp;&nbsp;&nbsp;If</FONT><FONT size=2> DataReader.GetInt64(i) &lt; </FONT><B><FONT color=#625a42 size=2>0</B></FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Then</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Nothing</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;rtn = Convert.ToUInt64(DataReader.GetInt64(i))</P>
<P></FONT><FONT color=#0000c6 size=2>ElseIf</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(UInt16) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;rtn = Misc.Strings.IIF(</FONT><FONT color=#0000c6 size=2>Of</FONT><FONT size=2> UInt16)(DataReader.GetInt16(i) &lt; </FONT><B><FONT color=#625a42 size=2>0</B></FONT><FONT size=2>, Convert.ToUInt16(</FONT><B><FONT color=#625a42 size=2>0</B></FONT><FONT size=2>), Convert.ToUInt16(DataReader.GetInt16(i)))</P>
<P></FONT><FONT color=#0000c6 size=2>ElseIf</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(UInt32) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;rtn = Misc.Strings.IIF(</FONT><FONT color=#0000c6 size=2>Of</FONT><FONT size=2> UInt32)(DataReader.GetInt32(i) &lt; </FONT><B><FONT color=#625a42 size=2>0</B></FONT><FONT size=2>, Convert.ToUInt32(</FONT><B><FONT color=#625a42 size=2>0</B></FONT><FONT size=2>), Convert.ToUInt32(DataReader.GetInt32(i)))</P>
<P></FONT><FONT color=#0000c6 size=2>ElseIf</FONT><FONT size=2> typeOfT </FONT><FONT color=#0000c6 size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>GetType</FONT><FONT size=2>(UInt64) </FONT><FONT color=#0000c6 size=2>Then</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;rtn = Misc.Strings.IIF(</FONT><FONT color=#0000c6 size=2>Of</FONT><FONT size=2> UInt64)(DataReader.GetInt64(i) &lt; </FONT><B><FONT color=#625a42 size=2>0</B></FONT><FONT size=2>, Convert.ToUInt64(</FONT><B><FONT color=#625a42 size=2>0</B></FONT><FONT size=2>), Convert.ToUInt64(DataReader.GetInt64(i)))</P>
<P></FONT><FONT color=#0000c6 size=2>Else</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;rtn = GetValue(i)</P>
<P></FONT><FONT color=#0000c6 size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000c6 size=2>Try</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000c6 size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>CType</FONT><FONT size=2>(rtn, T)</P>
<P></FONT><FONT color=#0000c6 size=2>Catch</FONT><FONT size=2> ex </FONT><FONT color=#0000c6 size=2>As</FONT><FONT size=2> Exception</P>
<P></FONT><FONT color=#0000c6 size=2>Throw</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>New</FONT><FONT size=2> InvalidCastException("The data type: " &amp; typeOfT.Name &amp; " will not cast from the database value: " &amp; GetDataTypeName(i) &amp; "[" &amp; GetFieldType(i).Name &amp; "]." &amp; NewLine() &amp; "This method [" &amp; System.Reflection.MethodBase.GetCurrentMethod().Name &amp; "] in object [" &amp; System.Reflection.MethodBase.GetCurrentMethod.ReflectedType.Name &amp; "] is not supported.")</P>
<P></FONT><FONT color=#0000c6 size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Try</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000c6 size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000c6 size=2>Function</P></FONT></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Blarm replied on Thursday, November 08, 2007</h2><P>This is the sort of code I use with NULLs</P>
<P>&nbsp; &nbsp; Private mRatingViewings As Nullable(Of Int16) = Nothing <BR>
<P>&nbsp; &nbsp; Public Property RatingViewings() As Nullable(Of Int16) <BR>&nbsp; &nbsp; &nbsp; &nbsp; Get <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanReadProperty("RatingViewings", True) <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Return mRatingViewings <BR>&nbsp; &nbsp; &nbsp; &nbsp; End Get <BR>&nbsp; &nbsp; &nbsp; &nbsp; Set(ByVal value As Nullable(Of Int16)) <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CanWriteProperty("RatingViewings", True) <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; If mRatingViewings.HasValue &lt;&gt; value.HasValue OrElse _ <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(mRatingViewings.HasValue AndAlso value.HasValue AndAlso <BR>mRatingViewings.Value &lt;&gt; value.Value) Then <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mRatingViewings = value <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PropertyHasChanged("RatingViewings") <BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End If <BR>&nbsp; &nbsp; &nbsp; &nbsp; End Set <BR>&nbsp; &nbsp; End Property <BR>
<P>DataPortal_Fetch:&nbsp;<BR>If Not dr.IsDBNull("RatingViewings") Then&nbsp;mRatingViewings = dr.GetInt16("RatingViewings") <BR>
<P>DoInsertUpdate: <BR>cmd.Parameters.AddWithValue("@RatingViewings", IIf(Not mRatingViewings.HasValue, DBNull.Value, mRatingViewings)) </P>
<P>I am hoping to build this as an option into CSALGen at some time as I use frequently use NULLs in the database</P>
<P>Bill</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ward0093 replied on Friday, November 09, 2007</h2><P>Hey Bill...</P>
<P>You may know this already... but i found out that if your SP has a default value already set (i.e. @RatingViewings as smallint = null)</P>
<P>then you can skip the IIF check:</P>
<P>cmd.Parameters.AddWithValue("@RatingViewings", mRatingViewings)</P>
<P>&nbsp;</P>
<P>just a thought...&nbsp; i did it the same thing for the longest time but discovered you didn't have to if a Default Value was established.</P>
<P>ward0093</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ward0093 replied on Friday, November 09, 2007</h2><P>oops... obviously,&nbsp;only with Nullable Values (i.e. Private mRatingViewings as Nullable(of int16) = nothing)</P>
<P>ward0093</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Blarm replied on Sunday, November 11, 2007</h2><P>Thanks ward I'll give that a try.</P>
<P>Bill</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
