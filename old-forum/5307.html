<html><header><title>BusinessBase as chilld property (One to one OR mapping)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>BusinessBase as chilld property (One to one OR mapping)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5307.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Joffies posted on Wednesday, August 27, 2008</h2><P>I am not sure if i am going about this in the right way....<BR><BR>I have two tables, Award and AwardVestingSettings and the relationship between these are 1 to 1.</P>
<P>I have a businessbase class</P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</FONT></FONT><FONT size=2> Award<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Inherits</FONT></FONT><FONT size=2> BusinessBase(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> Award)<BR>.....<BR><BR>Within this class I have&nbsp; property that represents the awardvesting setting table<BR><BR>.....<BR></FONT><FONT size=2><BR></FONT><FONT size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Private</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Shared</FONT></FONT><FONT size=2> VestingSettingProperty </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> PropertyInfo(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> AwardVestingSetting) = RegisterProperty(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> AwardVestingSetting)(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>GetType</FONT></FONT><FONT size=2>(Award), </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>New</FONT></FONT><FONT size=2> PropertyInfo(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> AwardVestingSetting)(</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"VestingSetting"</FONT></FONT><FONT size=2>, </FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"VestingSetting"</FONT></FONT><FONT size=2>))</P>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>''' </FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;Summary&gt;<BR></FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>''' Gets and sets the VestingSetting value.<BR></FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>''' </FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;/Summary&gt;</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> VestingSetting() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> AwardVestingSetting<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Get<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Return</FONT></FONT><FONT size=2> GetProperty(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> AwardVestingSetting)(VestingSettingProperty)<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Get</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Set</FONT></FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> value </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> AwardVestingSetting)<BR>&nbsp;&nbsp;&nbsp; SetProperty(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> AwardVestingSetting)(VestingSettingsProperty, value)<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Set<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</P>
<P><FONT color=#000000>......</FONT></P>
<P><FONT color=#000000>AwardVestingSetting is also a businessbase class<BR></FONT></FONT></FONT><BR>......</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</FONT></FONT><FONT size=2> AwardVestingSetting<BR>&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Inherits</FONT></FONT><FONT size=2> BusinessBase(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> AwardVestingSetting)</FONT></P>
<P>.....</P>
<P>I am trying to make use of this through winforms databinding but cannnot set databinding through the designer for the properties of the AwardVestingSetting child object. I am not sure if I am implementing the one to one relationship as property correctly...?</P>
<P>Thanks</P>
<P></FONT><FONT size=2>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, August 27, 2008</h2>Well, first off make sure you're designing your objects based on the use case, not on the database schema.&nbsp; But yes, you can have a single BusinessBase subclass that is a child of another BusinessBase.&nbsp; I don't think however you'd want a public property setter for the child BO though.&nbsp; <br><br>What you'll need to do for databinding is create a second BindingSource component.&nbsp; It's data source will be the primary BindingSource component for the Award class.&nbsp; The AwardVestingSetting's BindingSource's DataMember property would be set to "VestingSetting".&nbsp; <br><br>If you want to make things similpler, you can make AwardVestingSetting an internal class, and expose it's properties via the Award class.&nbsp; This would be a facade pattern.&nbsp; But I would only do that if AwardVestingSetting has a lot of it's own rules, or if AwardVestingSetting is an abstract class and you're going to subclass it because you have diffferent VestingSettings with their own unique behaviors.<font size="2"><font size="2"><br></font></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Joffies replied on Wednesday, August 27, 2008</h2><P>Thanks for the reply ajj3085. I agree with the approach of basing objects on the use case first.&nbsp;</P>
<P>I cannot seem to pickup the property&nbsp;VestingSetting as a Datamember for some reason? The property is Public so it should be visible as far as i can see..</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, August 27, 2008</h2>Ya, I can't remember if it will show up in the dropdown, but you should be able to type VestingSetting manually into the designer anyway.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pfeds replied on Wednesday, August 27, 2008</h2><P>As said, you probably need to think about the behaviour of your objects and not your database schema.&nbsp; Would you class Award and AwardVestingSettings as different objects, or one object that just happens to reside in more than one database table?</P>
<P>If they're two seperate objects then it could be worth using two datasources instead of one, with the second datasource calling <FONT face="Courier New" size=2>AwardVestingSettings.GetAwardVestingSettings(award.VestingSettingsId);</FONT></P>
<P>If they do need to be a single object then it could be worth storing the AwardVestingSettings object internally to the Award class. You can then expose the AwardVestingSettings properties&nbsp;on the Award class.</P>
<P>Here's another example that may help:</P>
<P>A Customer may have a primary Address (mandatory)&nbsp;as well as a collection of other addresses (shipping, billing, alternate addresses etc).&nbsp; The primary address will be a 1-1 to the customer, and an application may treat the primary address as such.&nbsp; This will allow you to do the following:</P>
<P><FONT face="Courier New" size=2>Customer newCustomer = Customer.NewCustomer();</FONT></P>
<P><FONT face="Courier New" size=2>newCustomer.Name = "Bob Monkhouse";</FONT></P>
<P><FONT face="Courier New" size=2>newCustomer.StreetAddress = "41 Country Lane";</FONT></P>
<P>Internally the street address is being stored in an Address object, but the user of the object does not need to see that.&nbsp; It also makes databinding clearer.</P>
<P>The Customer class would contain the following:</P>
<P><FONT face="Courier New" size=2>public string StreetAddress</FONT></P>
<P><FONT face="Courier New" size=2>{</FONT></P>
<P>&nbsp;&nbsp;&nbsp;<FONT face="Courier New" size=2>get</FONT></P>
<P>&nbsp;&nbsp;&nbsp;<FONT face="Courier New" size=2>{</FONT></P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT face="Courier New" size=2>return this.primaryAddress.StreetAddress</FONT></P>
<P>&nbsp;&nbsp;&nbsp;<FONT face="Courier New" size=2>}</FONT></P>
<P><FONT face="Courier New" size=2>}</FONT></P>
<P>I hope this helps.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Joffies replied on Wednesday, August 27, 2008</h2><P>Thanks for the reply and the insight to the use case/problem. </P>
<P>The Award and AwardVestingSetting&nbsp;should exist within in the same object in my use case and as far as I understand that is why the VestingSettings property is therefore allowing the usecase be exposed as single object and all the CRUD methods being handled by the parent object.</P>
<P>The AwardVestingSetting class was created from the point of view that it will be a child property so all the factory and data access methods were declared to identify it as being a child object and only exist within the parent context.<BR><BR>Factory Methods<BR>-----</P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Shared</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Function</FONT></FONT><FONT size=2> NewAwardVestingSetting(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> AwardId </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Integer</FONT></FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> AwardVestingSetting</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Not</FONT></FONT><FONT size=2> CanAddObject() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Then<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; Throw</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>New</FONT></FONT><FONT size=2> System.Security.SecurityException(</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>" User not authorised to add a Award"</FONT></FONT><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Return</FONT></FONT><FONT size=2> DataPortal.CreateChild(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> AwardVestingSetting)(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>New</FONT></FONT><FONT size=2> SingleCriteria(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> AwardVestingSetting, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Integer</FONT></FONT><FONT size=2>)(AwardId))</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Function</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Shared</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Function</FONT></FONT><FONT size=2> GetAwardVestingSetting(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> awardId </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Integer</FONT></FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> AwardVestingSetting</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Not</FONT></FONT><FONT size=2> CanGetObject() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Then<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp; Throw</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>New</FONT></FONT><FONT size=2> System.Security.SecurityException(</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"User not authorised to to view a Award"</FONT></FONT><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Return</FONT></FONT><FONT size=2> DataPortal.FetchChild(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> AwardVestingSetting)(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>New</FONT></FONT><FONT size=2> SingleCriteria(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> AwardVestingSetting, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Integer</FONT></FONT><FONT size=2>)(awardId))</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Function</FONT></FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>----<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#000000>Data Access Methods<BR><FONT color=#0000ff size=2><FONT color=#0000ff size=2><BR>Private</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</FONT></FONT><FONT size=2> Child_Fetch(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> criteria </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> SingleCriteria(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> AwardVestingSetting, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Integer</FONT></FONT><FONT size=2>))<BR></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...............<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Private</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</FONT></FONT><FONT size=2> Child_Insert()<BR></FONT><FONT size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;................<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Private</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</FONT></FONT><FONT size=2> Child_Update()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .................<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</P></FONT></FONT></FONT></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Joffies replied on Wednesday, August 27, 2008</h2><P>OK, somethings fishy going on when using specifying a property of BusinessBase type and using Undo.</P>
<P>My Parent class has two properties of which both are BusinessListBase and undo works fine for these two.</P>
<P>If&nbsp;I&nbsp; attempt to load&nbsp;the of the BusinessBase type (AwardVestingSetting)&nbsp;property and then attempt&nbsp;undo I get the lovely&nbsp; Edit level mismatch in copystate error. :).</P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>Private</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</FONT></FONT><FONT size=2> RebindUI(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> saveObject </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean</FONT></FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> rebind </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean</FONT></FONT><FONT size=2>)</P>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>' disable events</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me</FONT></FONT><FONT size=2>.AwardBindingSource.RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>False</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me</FONT></FONT><FONT size=2>.TransactionsBindingSource.RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>False</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me</FONT></FONT><FONT size=2>.VestingsBindingSource.RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>False</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me</FONT></FONT><FONT size=2>.VestingSettingsBindingSource.RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>False</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Try</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>' unbind the UI</P></FONT></FONT><FONT size=2>
<P>UnbindBindingSource(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me</FONT></FONT><FONT size=2>.VestingSettingsBindingSource, saveObject, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>False</FONT></FONT><FONT size=2>)</P>
<P>UnbindBindingSource(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me</FONT></FONT><FONT size=2>.VestingsBindingSource, saveObject, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>False</FONT></FONT><FONT size=2>)</P>
<P>UnbindBindingSource(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me</FONT></FONT><FONT size=2>.TransactionsBindingSource, saveObject, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>False</FONT></FONT><FONT size=2>)</P>
<P>UnbindBindingSource(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me</FONT></FONT><FONT size=2>.AwardBindingSource, saveObject, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>True</FONT></FONT><FONT size=2>)</P>
<P></P>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>' save or cancel changes</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If</FONT></FONT><FONT size=2> saveObject </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Then</P></FONT></FONT><FONT size=2>
<P>_award.ApplyEdit()</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Try</P></FONT></FONT><FONT size=2>
<P>_award = _award.Save</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Catch</FONT></FONT><FONT size=2> ex </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> Csla.DataPortalException</P>
<P>MessageBox.Show(ex.BusinessException.ToString(), _</P>
<P></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"Error saving"</FONT></FONT><FONT size=2>, MessageBoxButtons.OK, _</P>
<P>MessageBoxIcon.Exclamation)</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Catch</FONT></FONT><FONT size=2> ex </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> Exception</P>
<P>MessageBox.Show(ex.ToString(), _</P>
<P></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"Error Saving"</FONT></FONT><FONT size=2>, MessageBoxButtons.OK, _</P>
<P>MessageBoxIcon.Exclamation)</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Try</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Else</P></FONT></FONT><FONT size=2>
<P>_award.CancelEdit()</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Finally</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>' rebind UI if requested</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If</FONT></FONT><FONT size=2> rebind </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Then</P></FONT></FONT><FONT size=2>
<P>BindUI()</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>' restore events</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me</FONT></FONT><FONT size=2>.AwardBindingSource.RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>True</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me</FONT></FONT><FONT size=2>.TransactionsBindingSource.RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>True</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me</FONT></FONT><FONT size=2>.VestingsBindingSource.RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>True</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me</FONT></FONT><FONT size=2>.VestingSettingsBindingSource.RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>True</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If</FONT></FONT><FONT size=2> rebind </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Then</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>' refresh the UI if rebinding</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me</FONT></FONT><FONT size=2>.AwardBindingSource.ResetBindings(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>False</FONT></FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me</FONT></FONT><FONT size=2>.TransactionsBindingSource.ResetBindings(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>False</FONT></FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me</FONT></FONT><FONT size=2>.VestingsBindingSource.ResetBindings(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>False</FONT></FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me</FONT></FONT><FONT size=2>.VestingSettingsBindingSource.ResetBindings(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>False</FONT></FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Try</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</FONT></FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#000000>In essence all three properties are the same except for the VestingSettings being of BusinessBase Type.</FONT></P></FONT></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
