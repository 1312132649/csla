<html><header><title>How do you pass several parameters to DataPortal_Fetch()?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How do you pass several parameters to DataPortal_Fetch()?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7226.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>superkuton posted on Friday, July 03, 2009</h2>Hi!<br><br>How do you pass several parameters to DataPortal_Fetch()?<br><br>Is this valid?<br><br>Private Overloads Sub DataPortal_Fetch(ByVal startdate As SingleCriteria(Of ScheduleList, Date), ByVal enddate As SingleCriteria(Of ScheduleList, Date), ByVal qualification As SingleCriteria(Of ScheduleList, String))<br><br>'codes to get data<br><br>End Sub<br><br><br>And how do you call the procedure in the Factory Methods?<br><br><br>Thanks.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Vinodonly replied on Saturday, July 04, 2009</h2>in c# book page 81, 203 this is given..<br /><br />In short, <br /><br />SingleCriteria can be used when you have only one parameter to pass<br /><br />For multiples values (like in your case), you will have to create a class which inherits from criteriabase or create a nested class in your BO..<br /><br />Remember criteria class is just a datacontainer to carry different criteria/key values to dataportal, so you can subclass and put whatever values you want and retreive in Dataportal</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Vinodonly replied on Saturday, July 04, 2009</h2>i'm not using vb, so i generated following code through a generator. This is a example of embeded criteria class in your BO, where you have two parameters<br /><br />IMP : Tags not being shown here but you have to mark your criteria class as Serializable<br /><br /> _<br />      Protected Class CriteriaTS<br /><br />			Private _empMainID As Int32<br />			Public ReadOnly Property EmpMainID() As Int32<br />				Get<br />					Return _empMainID<br />				End Get<br />			End Property<br />		<br /><br />			Private _lastChanged As Byte()<br />			Public ReadOnly Property LastChanged() As Byte()<br />				Get<br />					Return _lastChanged<br />				End Get<br />			End Property<br />		<br />			Public Sub New(ByVal empMainID As Int32, ByVal lastChanged As Byte())<br />				_empMainID = empMainID<br />				_lastChanged = lastChanged<br />			End Sub<br />		<br />		Public Overrides Function Equals(obj As Object) As Boolean<br />			If TypeOf obj Is CriteriaTS<br />				Dim c As CriteriaTS = DirectCast(obj, CriteriaTS)<br />				If Not _empMainID.Equals(c._empMainID) Then Return False<br />				If Not _lastChanged.Equals(c._lastChanged) Then Return False<br />				Return True<br />			End If<br />			Return False<br />		End Function<br />		Public Overrides Function GetHashCode() As Integer<br />			Return String.Concat("CriteriaTS", _empMainID.ToString(), _lastChanged.ToString()).GetHashCode()<br />		End Function<br />      End Class<br />      <br /><br />Then in your dataportal, you will define it like this<br /><br />Protected Overloads Sub DataPortal_Delete(ByVal crit As CriteriaTS)<br />		<br />			Using ctx = ConnectionManager(Of SqlConnection).GetManager(Database.OrdersConnection, False)<br />				Using cmd As New SqlCommand("EmpMainDel", ctx.Connection)<br />					cmd.CommandType = CommandType.StoredProcedure<br />					cmd.Parameters.AddWithValue("@EmpMainID", crit.EmpMainID)<br />					cmd.Parameters.AddWithValue("@LastChanged", crit.LastChanged)<br />					Dim args As New DataPortalHookArgs(cmd, crit)<br />					OnDeletePre(args)<br />					cmd.ExecuteNonQuery()<br />					OnDeletePost(args)<br />				End Using<br />			End Using<br />		End Sub</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>superkuton replied on Saturday, July 04, 2009</h2>Yap, I finally got it.<br><br>Thank you vinodonly.<br><br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
