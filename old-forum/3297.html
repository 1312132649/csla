<html><header><title>Proper way to close a form with databinding</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Proper way to close a form with databinding</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3297.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>JohnB posted on Monday, July 30, 2007</h2><font face="Verdana" size="2">I was checking out the code in the latest PT (3.0) and noticed that for the Close button on the ProjectEdit form the code calls the Cancel_Button_Click sub. Perhaps I'm missing something but why would you want to Rebind, Restore and Refresh when you are closing the form? Wouldn't it make sense to just to disable the events, unbind and close? Is there recommended way of unbinding?<br><br><br>&nbsp;&nbsp;&nbsp; Private Sub Cancel_Button_Click(ByVal sender As System.Object, _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ByVal e As System.EventArgs) Handles Cancel_Button.Click<br><br>&nbsp;&nbsp;&nbsp; ' disable events<br>&nbsp;&nbsp;&nbsp; Me.ProjectBindingSource.RaiseListChangedEvents = False<br>&nbsp;&nbsp;&nbsp; Me.ResourcesBindingSource.RaiseListChangedEvents = False<br><br>&nbsp;&nbsp;&nbsp; ' unbind the UI<br>&nbsp;&nbsp;&nbsp; UnbindBindingSource(Me.ResourcesBindingSource, True, False)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UnbindBindingSource(Me.ProjectBindingSource, True, True)<br><br>&nbsp;&nbsp;&nbsp; ' rebind the UI<br>&nbsp;&nbsp;&nbsp; Me.ResourcesBindingSource.DataSource = Me.ProjectBindingSource<br>&nbsp;&nbsp;&nbsp; Me.ProjectBindingSource.DataSource = mProject<br><br>&nbsp;&nbsp;&nbsp; ' restore events<br>&nbsp;&nbsp;&nbsp; Me.ProjectBindingSource.RaiseListChangedEvents = True<br>&nbsp;&nbsp;&nbsp; Me.ResourcesBindingSource.RaiseListChangedEvents = True<br><br>&nbsp;&nbsp;&nbsp; ' refresh the UI<br>&nbsp;&nbsp;&nbsp; Me.ProjectBindingSource.ResetBindings(False)<br>&nbsp;&nbsp;&nbsp; Me.ResourcesBindingSource.ResetBindings(False)<br><br>&nbsp; End Sub<br><br>&nbsp; Private Sub CloseButton_Click(ByVal sender As System.Object, _<br>&nbsp;&nbsp;&nbsp; ByVal e As System.EventArgs) Handles CloseButton.Click<br><br>&nbsp;&nbsp;&nbsp; Cancel_Button_Click(sender, e)<br>&nbsp;&nbsp;&nbsp; Me.Close()<br><br>&nbsp; End Sub<br></font><font face="Verdana" size="2"><br><br>I also found this article which list the steps for "Save/Cancel in Windows Forms data binding".<br>http://www.lhotka.net/article.aspx?id=91e15def-fa1c-4236-86b5-b204bfc4a0aa<br></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, July 31, 2007</h2><P>It depends on whether there may be other references to the object in the application.</P>
<P>If your form is the <EM>only</EM> reference to the object, then you really don't need to do anything at all - just close the form and let the garbage collector do its job.</P>
<P>But if your object is referenced from elsewhere in the app, you need to cancel changes on the object. The key with doing this is to <EM>leave the object unbound</EM>, because as soon as you rebind the object, data binding will call BeginEdit() on your object(s).</P>
<P>In PTWin there are no other references, so you are correct that the call to the cancel click handler is technically unnecessary.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
