<html><header><title>Suspicious Business Rule behavior</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Suspicious Business Rule behavior</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10535.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ranjini posted on Tuesday, July 19, 2011</h2><p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-family:Calibri;"><b style="mso-bidi-font-weight:normal;"><span style="line-height:115%;font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;">Technologies</span></b><span style="line-height:115%;font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"> &ndash; CSLA 4/Silverlight 4</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="line-height:115%;font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">Here is my scenario. </span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">Object A (BusinessBase)</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">|</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">----------- PropertyB (typeof(Boolean))</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">----------- PropertyC (typeof(ChildListC) BusinessListBase)</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">When property B is set to true, I require C to contain at least 1 child. </span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">To implement this,</span></span></p>
<p class="MsoListParagraph" style="line-height:normal;text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-add-space:auto;mso-list:l0 level1 lfo1;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:Consolas;"><span style="mso-list:Ignore;">1)<span style="font:7pt &#39;Times New Roman&#39;;">&nbsp; </span></span></span><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;</span>I implemented a rule on the Property B </span></span><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;text-indent:0.5in;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;text-indent:0.5in;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">BusinessRules.AddRule(<span style="color:blue;">new</span> <span style="color:#2b91af;">CheckCSettings</span>(_PropertyB));</span></p>
<p class="MsoListParagraphCxSpFirst" style="line-height:normal;margin:0in 0in 0pt 0.5in;mso-add-space:auto;mso-layout-grid-align:none;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">&nbsp;</span></span></p>
<p class="MsoListParagraphCxSpMiddle" style="line-height:normal;text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-add-space:auto;mso-list:l0 level1 lfo1;mso-layout-grid-align:none;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;mso-fareast-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;">2)</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">Implemented OnChildChanged on ObjectA to capture change in ChildList C</span></span></p>
<p class="MsoListParagraphCxSpLast" style="line-height:normal;margin:0in 0in 0pt 0.5in;mso-add-space:auto;mso-layout-grid-align:none;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;text-indent:0.5in;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">protected</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">override</span> <span style="color:blue;">void</span> OnChildChanged (Csla.Core.<span style="color:#2b91af;">ChildChangedEventArgs</span> e)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">base</span>.OnChildChanged(e);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (e.ChildObject.GetType() == <span style="color:blue;">typeof</span>(<span style="color:#2b91af;">ChildListC</span>) &amp;&amp; e.CollectionChangedArgs != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>BusinessRules.CheckRules(_PropertyB);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoListParagraphCxSpFirst" style="line-height:normal;margin:0in 0in 0pt 0.5in;mso-add-space:auto;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoListParagraphCxSpMiddle" style="line-height:normal;text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-add-space:auto;mso-list:l0 level1 lfo1;mso-layout-grid-align:none;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;mso-fareast-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;">3)</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">Implemented the CheckCSettings Rule as follows</span></span></p>
<p class="MsoListParagraphCxSpLast" style="line-height:normal;margin:0in 0in 0pt 0.5in;mso-add-space:auto;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:blue;">public</span> <span style="color:blue;">class</span> <span style="color:#2b91af;">CheckCSettings</span>: Csla.Rules.<span style="color:#2b91af;">BusinessRule</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes;">&nbsp;</span><span style="color:blue;">public</span> <span style="color:#2b91af;">CheckCSettings</span> (<span style="color:#2b91af;">IPropertyInfo</span> primaryProperty)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>: <span style="color:blue;">base</span>(primaryProperty)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">protected</span> <span style="color:blue;">override</span> <span style="color:blue;">void</span> Execute (<span style="color:#2b91af;">RuleContext</span> context)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">var</span> ctx = context.Target <span style="color:blue;">as</span> <span style="color:#2b91af;">ObjectA</span>;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (ctx!= <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (ctx.PropertyB.GetValueOrDefault(<span style="color:blue;">false</span>)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&amp;&amp; (ctx.PropertyC != <span style="color:blue;">null</span> &amp;&amp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ctxDomain.PropertyC.Count &lt; 1))</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.AddErrorResult(<span style="color:#a31515;">&quot;Atleast 1 child C is required.&rdquo;</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">The rule seems to get triggered correctly when I change the Boolean flag or when I add/remove child objects from PropertyC. However, when the rule is executed in the latter situation, something seems to not reach completion. </span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">Eg, when PropertyB is set initially, the rule runs and correctly invalidates the property indicating that a child is required. However, when I add a child, the rule runs again, and even though the child count is 1 and the context.AddErrorResult line is never hit, the UI still shows the error adorner around Property B indicating it is invalid. The Save button that I have that is bound to Viewmodel CanSave is also disabled. </span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">Here is how I have bound my UI &ndash;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">&lt;</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">Button</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> Content=</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">&quot;Save&quot;</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> Name</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=&quot;SaveButton&quot;</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> DataContext</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=&quot;{</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">Binding</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> ObjectAVM</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">}&quot;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;</span></span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;">IsEnabled</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=&quot;{</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">Binding</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> Path</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=CanSave}&quot;/&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">&lt;</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">CheckBox</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> x</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">:</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;">Name</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=&quot;chbPropertyB&quot; </span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;">IsChecked</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=&quot;{</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">Binding</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> ObjectAVM</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">.Model.PropertyB,</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> Mode</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=TwoWay,</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> ValidatesOnDataErrors</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=True,</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> NotifyOnValidationError</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=True,</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> FallbackValue</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=&#39;False&#39;}&quot;</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> /&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">What I find inconsistent/strange is that when I try to capture the object status at this point, this is what I see &ndash; </span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:9.5pt;"><a href="https://docs.google.com/leaf?id=0B-Qwbn69ZX90ZGQ4OTZjYjEtYmFhOS00NWE3LThlZTgtNGY4OWZmZmU3ZTM2&amp;hl=en_US"><span style="color:#0000ff;">https://docs.google.com/leaf?id=0B-Qwbn69ZX90ZGQ4OTZjYjEtYmFhOS00NWE3LThlZTgtNGY4OWZmZmU3ZTM2&amp;hl=en_US</span></a></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">IsValid is true, IsDirty is true, IsBusy is false, but CanSave is false. How is this possible?</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">Please help. Any thoughts /comments are welcome.</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><br /><span style="font-family:Calibri;">Thanks</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-size:10pt;mso-ascii-font-family:Calibri;mso-hansi-font-family:Calibri;mso-bidi-font-family:Calibri;"><span style="font-family:Calibri;">Ranjini Suryanarayanan</span></span></p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, July 19, 2011</h2><p>It is not suspicious at all!!</p>
<p>BusinessRules.CheckRules(property) does NOT raise OnPropertyChanged to notify UI of changes to property (and rules). It only does the rule checking.</p>
<p><b>You should rather call &lt;BO&gt;.PropertyHasChanged(property) as this will </b></p>
<ul>
<li><b>mark object as dirty</b></li>
<li><b>run rules for property</b></li>
<li><b>check the setting for PropertyChangedMode and raise proper OnPropertyChanged<br /></b></li>
</ul>
<p><b>or implement OnPropertyChanged in your own eventhandler.</b></p>
<p>Something like this:</p>
<p class="MsoNormal" style="line-height:normal;text-indent:0.5in;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">protected</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">override</span> <span style="color:blue;">void</span> OnChildChanged (Csla.Core.<span style="color:#2b91af;">ChildChangedEventArgs</span> e)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">base</span>.OnChildChanged(e);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (e.ChildObject.GetType() == <span style="color:blue;">typeof</span>(<span style="color:#2b91af;">ChildListC</span>) &amp;&amp; e.CollectionChangedArgs != <span style="color:blue;">null</span>)</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged(_propertyB);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ranjini replied on Tuesday, July 19, 2011</h2><p>Aaaah! Thanks so much! That does work perfectly!</p>
<p>I still find the object status inconsistency a little puzzling. Is there an explanation for that?</p>
<p>Thanks!</p>
<p>Ranjini</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, July 19, 2011</h2><p>We had a few bugs in PropertyStatus that I worked on in May so you should grab the latest PropertStatus.cs from trunk and update your CSLA 4&nbsp; version if you experience other inconsistencies.</p>
<p>Basically - it may fail to attach to the correct &quot;CurrentItem&quot; when databaound to a list or miss on updating the PropertyStatus if a control is not visible on the first run, f.ex in a hidden Tab control page (ie: control is not yet part of the VisualTree and property status is unable to set the icon/message, believes everything is OK and did not try to refresh when control became visible).</p>
<p>And - all updates via Databinding requires that some event is triggered to notfiy UI controls. </p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ranjini replied on Tuesday, July 19, 2011</h2><p>Thanks so much for your quick responses! We rely on this forum a lot and you guys make it so easy !</p>
<p>Ranjini</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
