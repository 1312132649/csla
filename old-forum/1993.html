<html><header><title>Object decoupling/responsibility questions</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Object decoupling/responsibility questions</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1993.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate posted on Monday, December 18, 2006</h2><P>I have a question about object decoupling and who should be responsible for some of the business logic&nbsp;I am trying to implement.</P>
<P>I am working with an expanded security model based on a rights-based approach whereby a user is a member of a set of security groups each with various rights assigned (either allow or deny).&nbsp; The approach is very similar to the way Windows security works.&nbsp; However, we want our framework classes to support both simple and complex models - i.e. role-based or rights-based security.&nbsp; To do this, I need to be able to check both the list of groups and the list of rights for a user when a security check is performed.&nbsp; In other words, when we make a call such as:</P>
<P>AuthorizationRules.AllowWrite("PropertyName", "Role");</P>
<P>I would like to be able to specify either the role (group) OR the right.&nbsp; This will free&nbsp;the developers using the framework to implement the security check using either method.</P>
<P>The question I have is where it is best to put the logic required to assess whether the security check passes or fails?</P>
<P>We already have created a SecurityManager class which manages all of our settings, etc. that govern how security is applied.&nbsp; Initially, we created a static Authorize method that accepted an IPrincipal object and the role/right being checked.&nbsp; In this method, we would search to see if the argument passed was a&nbsp;role (group) by checking the user's Groups collection for a match.&nbsp; If not, we would then look in the user's Rights collection.&nbsp; This method was used in lieu of any direct calls to IsInRole() in our code, including the RolesForProperty class.</P>
<P>However, this approach limits us to ONLY using our custom objects and doesn't seem consistent with the standard approach.&nbsp; I am wondering if it would be better to implement this logic within the IsInRole method and include it in our custom principal object rather than externalize it in the SecurityManager class.&nbsp; Or, is it better to leave IsInRole() synonymous with IsInGroup() and not mix the rights-based stuff here?</P>
<P>My thought is that to truly decouple the SecurityManager from the custom principal object, it must not assume anything such as the existance of a Rights collection and only work with the IPrincipal/IIDentity interfaces.&nbsp; If that's the case, the we only have IsInRole() to work with and the logic should all be placed in this method within our custom principal.</P>
<P>Any thoughts?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>twistedstream replied on Monday, December 18, 2006</h2><P>I'm not sure the correct answer to this question; I&nbsp;just have a few ideas.&nbsp; Very curious to see what others have to say.</P>
<P>My tendancy would be to stick to the IPrincipal/IIDentity interfaces and perform the rights check within your custom principal object.&nbsp; Your pricipal could have a configuration setting (perhaps read from the .config file or set as a static property by the business objects) that would switch&nbsp;the IsInRole&nbsp;method from evaluating roles vs. rights.</P>
<P>Actually, having the switch might not even be necessary, since, once you went&nbsp;down the rights-based security&nbsp;path in a given business object library, there would be no need to check for roles anyway (since you could always create a right that would perform the necessary security check).&nbsp;&nbsp;It might make more sense to just implement&nbsp;a RightsPrincipal and be done with it.&nbsp;</P>
<P>~pete&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Monday, December 18, 2006</h2><P>&nbsp;I have IsInRole in my custom Principal.</P>
<P>But I also have a finer grained collection of permissions which is accessed through HasPermission.</P>
<P>I spoke with Rocky about this and he agrees that restricting the call to IsInRole is too limiting. He said he would investigate adding a Delegate so that you can replace the call to IsInRole with something that matches the Delegate. This way you can use his entire framework to support a call to HasPermission.</P>
<P>I assume he means version 2.2 or later.</P>
<P>Joe</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
