<html><header><title>Criteria objects &amp; a lot of beers :)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Criteria objects &amp; a lot of beers :)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6665.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Boris posted on Tuesday, March 24, 2009</h2>Rocky,<br><br>I clearly remember from your last books that:<br><br>---<br>At a minimum, the criteria object must specify the type<br>of object you are trying to create, retrieve, or delete<br>---<br><br>I also know that criteria can be created in one of three ways <br>(page 81 in Expert C# 2008 Business Objects)<br><br><br>...So this what I've been pushing for..create criteria, <br>that will convey to the&nbsp; App. Server information about the type (at a minimum) of the BO.<br><br><br>Well, what is the difference then, between the following two calls:<br><br>&nbsp;&nbsp;&nbsp; public static Project GetProject(Guid id)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return DataPortal.Fetch&lt;Project&gt;(new SingleCriteria&lt;Project, Guid&gt;(id));<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp;&nbsp; // and<br>&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp;&nbsp; public static Project GetProject(Guid id)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return DataPortal.Fetch&lt;Project&gt;(Guid id);<br>&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;<br><br>Thanks,<br>&nbsp; <br>~ Boris&nbsp; <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Boris replied on Tuesday, March 24, 2009</h2>Ooh,<br><br>I forgot, if everything is just fine with the last call I'm buying a lot of beers....<br>There is nothing wrong with that...of course ;)<br><br>- B<br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Boris replied on Tuesday, March 24, 2009</h2>Of course, to be absolutely precise the second call is:<br><br>&nbsp;&nbsp;&nbsp; public static Project GetProject(Guid id)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return DataPortal.Fetch&lt;Project&gt;(id);<br>&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp; <br><br><br>&nbsp;&nbsp; And the <br>private void DataPortal_Fetch(SingleCriteria&lt;Project, Guid&gt; criteria) {...}<br>&nbsp;&nbsp; changes to<br>private void DataPortal_Fetch(Guid id) {...}<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, March 25, 2009</h2><P>The first one is correct, the other is not :)</P>
<P>The data portal is designed to carry a criteria object over the wire. It is absolutely not guaranteed that arbitrary primitive values will work, and an Int32 type specifically will not work (because the data portal uses that type internally).</P>
<P>If I didn't care about backward compatibility I'd allow arbitrary values, and someday I may make that change (which would involve eliminating the non-generic data portal methods like Create() and Fetch()).</P>
<P>But unless I make that breaking change, the data portal is only designed to work with criteria objects as parameters, not arbitrary primitive values.</P>
<P>Of course a Guid is not a primitive, and so it is probably pretty safe :)</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Boris replied on Wednesday, March 25, 2009</h2>Rocky,<br><br>Thank you for the quick responce!<br>I confirmed what you're saying and that makes sense to me...<br><br>I cannot say I completely understand how the DataPortal is using the Int32 internally, and why is the call <b>obj.CallMethod("DataPortal_Fetch")</b> needed in SimpleDataPortal.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // tell the business object to fetch its data<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (criteria is int)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>obj.CallMethod("DataPortal_Fetch");</b><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.CallMethod("DataPortal_Fetch", criteria);<br><br>I just didn't have the time to expolre that yet, but I think this where you mean backward compatibility thing...<br><br>Thank you!<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, March 25, 2009</h2>This is discussed in the book in Chapter 15 for the SimpleDataPortal. <br /><br />Rocky needed a "magic" value to determine which path to take and arbitrarily decide to use an int because the DataPortal is designed to accept a Criteria Object which is NOT a primitive type.<br /><br />But there are overloads for Fetch that do not require *any* criteria at all and no parameter is not the same thing as Nothing. <br /><br />So Rocky assigns it a magic value to indicate that no parameter was passed at all.<br /><br />Joe<br /><br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, March 25, 2009</h2>The 'magic value' idea is not ideal, but it is with good reason.<br /><br />The alternative is to use a more complex message container to transfer the<br />parameter(s). That would have broken backward compatibility at the time (and<br />would now). Perhaps more importantly, it would have increased the size of<br />the fetch request on the wire, and I wanted to keep that as compact as<br />possible.<br /><br />Rocky</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Boris replied on Wednesday, March 25, 2009</h2>I should've read the whole book ;)<br>Thank you both!<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
