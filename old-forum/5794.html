<html><header><title>OT: Oracle Data Provider ODP.NET and GetInt32</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>OT: Oracle Data Provider ODP.NET and GetInt32</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5794.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Wbmstrmjb posted on Wednesday, November 12, 2008</h2><P>Anyone else using the Oracle Data Provider (Oracle.DataAccess.Client)&nbsp;instead of System.Data.OracleClient?&nbsp; GetInt32 doesn't work for ints because Oracle always returns numbers at decimals.&nbsp; I can change the calls to (int)dr.GetDecimal but was wondering if anyone had a better workaround.</P>
<P>Thanks,</P>
<P>Mike</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DancesWithBamboo replied on Wednesday, November 12, 2008</h2>You do have to typecast it to an int.&nbsp; I made a version of the SafeRowReader/SafeDataReader that was Oracle friendly.&nbsp; Inside of the GetInt32 overload I did my typecast from decimal.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jack replied on Saturday, November 15, 2008</h2>Any interest in sharing any of that code?  I'm starting to run into a few of these things.<br /><br />thanks<br /><br />jack</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Monday, November 17, 2008</h2><P>You just subclass SafeDataReader and override the method you want to modify and use your own implementation. Then in your code instead of using "New SafeDataReader" you use "New MySafeDataReader" (or whatever you decide to call it.)</P>
<P>Here is how I handled Booleans for Oracle:</P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>Imports</FONT></FONT><FONT size=2> Csla<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Imports</FONT></FONT><FONT size=2> Csla.Data<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Imports</FONT></FONT><FONT size=2> System.Web.Configuration</P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>Namespace</FONT></FONT><FONT size=2> BO</P>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>'My Base class for modifications to Csla.Data.SafeDataReader<BR></FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>'Add support to SafeDataReader class to support Oracle reading Booleans.</P></FONT></FONT><FONT size=2>
<P>&lt;Serializable()&gt; _<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</FONT></FONT><FONT size=2> MySafeDataReader<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Inherits</FONT></FONT><FONT size=2> SafeDataReader</P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>#Region</FONT></FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2><FONT color=#ff00ff size=2>" Class Variable Declarations "<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2><BR>Private</FONT></FONT><FONT size=2> mDBType </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>String</FONT></FONT><FONT size=2> = WebConfigurationManager.AppSettings(</FONT><FONT color=#ff00ff size=2><FONT color=#ff00ff size=2>"DBType"</FONT></FONT><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2><BR>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>New</FONT></FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> dataReader </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> IDataReader)<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; MyBase</FONT></FONT><FONT size=2>.New(dataReader)<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub<BR><BR>#End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Region</P>
<P>#Region</FONT></FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2><FONT color=#ff00ff size=2>" Properties and Methods "</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Overrides</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Function</FONT></FONT><FONT size=2> GetBoolean(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> i </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Integer</FONT></FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; If</FONT></FONT><FONT size=2> mDBType = </FONT><FONT color=#ff00ff size=2><FONT color=#ff00ff size=2>"SQL Server"</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If</FONT></FONT><FONT size=2> DataReader.IsDBNull(i) </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Return</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>False<BR>&nbsp; &nbsp;&nbsp;</FONT></FONT><FONT size=2><FONT color=#0000ff>Else<BR>&nbsp;&nbsp;&nbsp; &nbsp; </FONT></FONT><FONT size=2><FONT color=#0000ff><FONT color=#0000ff>Return</FONT></FONT> DataReader.GetBoolean(i)<BR>&nbsp; &nbsp; </FONT><FONT size=2><FONT color=#0000ff><FONT color=#0000ff>End</FONT></FONT> <FONT color=#0000ff><FONT color=#0000ff>If<BR></FONT></FONT></FONT><FONT size=2><FONT color=#0000ff><FONT color=#0000ff>&nbsp; ElseIf</FONT></FONT> mDBType = <FONT color=#ff00ff><FONT color=#ff00ff>"Oracle"</FONT></FONT> <FONT color=#0000ff><FONT color=#0000ff>Then<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT></FONT><FONT size=2><FONT color=#0000ff><FONT color=#0000ff>If</FONT></FONT> DataReader.IsDBNull(i) <FONT color=#0000ff><FONT color=#0000ff>Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></FONT></FONT><FONT size=2><FONT color=#0000ff><FONT color=#0000ff>Return</FONT></FONT> <FONT color=#0000ff><FONT color=#0000ff>False<BR>&nbsp; &nbsp; </FONT></FONT></FONT><FONT color=#0000ff><FONT color=#0000ff><FONT size=2>Else<BR>&nbsp;&nbsp;&nbsp; &nbsp; </FONT></FONT></FONT><FONT size=2><FONT color=#0000ff><FONT color=#0000ff>If</FONT></FONT> <FONT color=#0000ff><FONT color=#0000ff>CStr</FONT></FONT>(DataReader(i)) = <FONT color=#ff00ff><FONT color=#ff00ff>"1"</FONT></FONT> <FONT color=#0000ff><FONT color=#0000ff>Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; </FONT></FONT></FONT><FONT size=2><FONT color=#0000ff><FONT color=#0000ff>Return</FONT></FONT> <FONT color=#0000ff><FONT color=#0000ff>True<BR>&nbsp; &nbsp;&nbsp;&nbsp; </FONT></FONT></FONT><FONT color=#0000ff><FONT color=#0000ff><FONT size=2>Else<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </FONT></FONT></FONT><FONT size=2><FONT color=#0000ff><FONT color=#0000ff>Return</FONT></FONT> <FONT color=#0000ff><FONT color=#0000ff>False<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></FONT></FONT><FONT size=2><FONT color=#0000ff><FONT color=#0000ff>End</FONT></FONT> <FONT color=#0000ff><FONT color=#0000ff>If<BR></FONT></FONT></FONT><FONT size=2><FONT color=#0000ff><FONT color=#0000ff>&nbsp; &nbsp; End</FONT></FONT> <FONT color=#0000ff><FONT color=#0000ff>If<BR></FONT></FONT></FONT><FONT size=2><FONT color=#0000ff><FONT color=#0000ff>&nbsp; End</FONT></FONT> <FONT color=#0000ff><FONT color=#0000ff>If<BR></FONT></FONT></FONT><FONT size=2><FONT color=#0000ff><FONT color=#0000ff>End</FONT></FONT> </FONT><FONT color=#0000ff><FONT color=#0000ff><FONT size=2>Function</FONT></P>
<P><FONT size=2>#End</FONT></FONT></FONT><FONT size=2> <FONT color=#0000ff><FONT color=#0000ff>Region<BR><BR></FONT></FONT></FONT><FONT size=2><FONT color=#0000ff><FONT color=#0000ff>End</FONT></FONT> </FONT><FONT color=#0000ff><FONT color=#0000ff><FONT size=2>Class<BR><BR></FONT><FONT size=2>End</FONT></FONT></FONT><FONT size=2> <FONT color=#0000ff><FONT color=#0000ff>Namespace</P></FONT></FONT></FONT>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jack replied on Monday, November 17, 2008</h2>Thank you.&nbsp; Anything less I have to code the better.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jack replied on Monday, November 17, 2008</h2><P>Joe,</P>
<P>Just out of curiosity what are you doing with decimal vs. int32?&nbsp; My earlier version of my application used int32 all over the place for my ID keys and I did the (int) conversion on reading them in.&nbsp; Now with CSLA and using CodeSmith all my keys are coming back as decimal.&nbsp; </P>
<P>Would you suggest I re-code the templates to use int32 in lieu of decimal except when directly doing Oracle data access?</P>
<P>Thanks</P>
<P>jack</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Monday, November 17, 2008</h2><P>I no longer have to support Oracle. Plus I never used the Oracle provider - I used the Microsoft version. But now you should be able to make a decision as to which way to go and then use the code sample to get you there.</P>
<P>Joe</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
