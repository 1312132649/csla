<html><header><title>PropertyInfo(Of T) - constructor question</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>PropertyInfo(Of T) - constructor question</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5052.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 posted on Thursday, July 03, 2008</h2><P>There are many constructors for this class. I am not sure which one gets called when the type T is String. </P>
<P><FONT color=#0000ff size=2>--------------------------------------------------------------------------------------------------------------------------------</FONT></P>
<P><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> PropertyInfo(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T)</P></FONT><FONT color=#0000ff size=2>
<P>&nbsp; Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> name </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> friendlyName </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>)</FONT></P><FONT size=2><FONT color=#0000ff size=2>
<P>&nbsp; Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> name </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> defaultValue </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> T)</FONT></P><FONT size=2><FONT color=#0000ff size=2>
<P>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</P></FONT></FONT></FONT>
<P><FONT color=#0000ff size=2>--------------------------------------------------------------------------------------------------------------------------------</FONT></P>
<P>In the code below, I am trying to set the Friendly name as the 2nd parameter. But how do I know it is not really setting the defaultValue which is also the 2nd parameter of a different constructor? Which constructor is really getting called in this case? </P>
<P>e.g. <FONT color=#0000ff size=2>Dim</FONT><FONT size=2> x </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> PropertyInfo(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>) = </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> PropertyInfo(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>)(</FONT><FONT color=#ff00ff size=2>"Data"</FONT><FONT size=2>, </FONT><FONT color=#ff00ff size=2>"Object data"</FONT><FONT size=2>)</FONT></P>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, July 03, 2008</h2>That's a good question. Breaking change or not, I should probably remove that second ctor overload, forcing you to provide a friendly name if you provide a default value.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, July 03, 2008</h2><P>Rocky,</P>
<P>I agree that removing it is a good idea.</P>
<P>While trying to create a subclass for PropertyInfo(Of T) I am having some trouble with the defaultValue. You made the Property Overridable but did not give us access to the Private variable _defaultValue. This caused me to have to create my own variable in my subclass and then use it inside the overridden Property. Can you do one of these 2 suggestions:</P>
<P>1. Make _defaultValue Protected instead of Private.</P>
<P>2. Create a Protected&nbsp;Overridable function named GetDefaultValue As T.</P>
<P>Then call that function inside the constructor with 2 parameters:<BR><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> name </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> friendlyName </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>)</P></FONT><FONT color=#0000ff size=2>
<P>Protected Overridable </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetDefaultValue() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> T<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> result </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> T<BR></FONT><FONT color=#0000ff size=2><BR>&nbsp; If</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>GetType</FONT><FONT size=2>(T).Equals(</FONT><FONT color=#0000ff size=2>GetType</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>)) </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>result = </FONT><FONT color=#0000ff size=2>DirectCast</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>DirectCast</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>.Empty, </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>), T)<BR></FONT><FONT color=#0000ff size=2>Else<BR>&nbsp; </FONT><FONT size=2>result = </FONT><FONT color=#0000ff size=2>Nothing<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Return</FONT><FONT size=2> result</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT>
<P>By doing this I can override the function and add defaults for numeric values too.</P>
<P>e.g.</P>
<P>Protected Overrides <FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetDefaultValue() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> T<BR>&nbsp; ...</FONT></P>
<P><FONT size=2>&nbsp; <FONT color=#0000ff>ElseIf</FONT> <FONT color=#0000ff>GetType</FONT>(T).Equals(<FONT color=#0000ff>GetType</FONT>(<FONT color=#0000ff>Integer</FONT>)) <FONT color=#0000ff>OrElse</FONT> <FONT color=#0000ff>GetType</FONT>(T).Equals(<FONT color=#0000ff>GetType</FONT>(<FONT color=#0000ff>Long</FONT>)) <FONT color=#0000ff>OrElse</FONT> <FONT color=#0000ff>GetType</FONT>(T).Equals(<FONT color=#0000ff>GetType</FONT>(<FONT color=#0000ff>Decimal</FONT>)) <FONT color=#0000ff>OrElse</FONT> <FONT color=#0000ff>GetType</FONT>(T).Equals(<FONT color=#0000ff>GetType</FONT>(<FONT color=#0000ff>Short</FONT>)) <FONT color=#0000ff>OrElse</FONT> <FONT color=#0000ff>GetType</FONT>(T).Equals(<FONT color=#0000ff>GetType</FONT>(<FONT color=#0000ff>Byte</FONT>)) </FONT><FONT size=2><FONT color=#0000ff>Then<BR><BR></FONT>&nbsp; result = <FONT color=#0000ff>DirectCast</FONT>(<FONT color=#0000ff>DirectCast</FONT>(0, <FONT color=#0000ff>Object</FONT>), T)<BR></FONT><FONT size=2><BR>...<BR></FONT><FONT size=2>End Function</P></FONT>
<P>Joe</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
