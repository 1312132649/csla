<html><header><title>EnterpriseServices, Remote Host, and C#</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>EnterpriseServices, Remote Host, and C#</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2499.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>noyceb posted on Friday, March 09, 2007</h2><P>Greetings,</P>
<P>We are attempting a remote EnterpriseServices host setup on our network, but cannot seem to get the client install (generated msi from component services on the host machine) to install successfully.&nbsp; Our environment appears as follows:</P>
<P>Web Server (IIS 7.0) - PTWeb<BR>Application Server (2003 SP1) - EnterpriseServicesHostcs<BR>Client (XP SP2) - IE7</P>
<P>We can get the EnterpriseServicesHostcs installed properly (via regsvcs)&nbsp;on the Application Server, and export the pre-built application into an MSI.&nbsp; However, when we go to install the application onto the web server, it complains that it could not register the COM component due to the fact that it cannot find a reference to CSLA.&nbsp; Just for the sake of it, we have also attempted the following, but with little to no success:</P>
<UL>
<LI>Install the application MSI on the client machine</LI>
<LI>Install the application MSI on the application server via the component services snap-in, so we can over-ride the location to ensure a CSLA assembly is in the same location</LI></UL>
<P>We have verified that all of the proper COM settings exist on the application server prior to exporting the MSI.&nbsp; There were thoughts that we should regsiter the CSLA assembly on the web server, however the buildCSLA documentation strongly advises against it.&nbsp; I am certain we are missing some simple detail, but until now it has elluded us.&nbsp; For the record, we have successfully completed this setup on a single location (the web server), and have successfully deployed a proof of concept EnterpriseService in this environment to elimate the environment as an instigator.</P>
<P>Thanks in advance.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>noyceb replied on Thursday, March 29, 2007</h2><P>Hello there again,</P>
<P>We are still struggling with this issue, and I simply wanted to throw this back out there to see if anyone has had any luck or has any ideas we can try.</P>
<P>Thanks in advance.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>noyceb replied on Friday, March 30, 2007</h2><P>OK, for those who are interested, read on...</P>
<P>In order to successfully install a pre-built COM+ proxy (creating this is described on page 618 of Rocky's Expert C# 2005 Business Objects book), you must ensure that the CSLA assembly exists in the system32 directory (e.g. C:\Windows\System32) on the destination system BEFORE you attempt to install the MSI.&nbsp; If you try to install the MSI before hand, COM+ registation will complain that it cannot find the CSLA dependency.</P>
<P>Once installed, you will need to ensure that the account you configured the COM+ server to run in (page 617), is the same account that is used for the application pool of the web site that will access the component (or another account that has access to every tier), otherwise you will get access violations.</P>
<P>More information on troubleshooting EnterpriseService components regarding dependencies can be found here:&nbsp; <A href="http://support.microsoft.com/kb/308940">http://support.microsoft.com/kb/308940</A>.</P>
<P>Best of luck.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Mik123 replied on Tuesday, April 03, 2007</h2>I'm having a similar issue setting up EnterpriseServices<br><br>Here's how I'm trying to it set up.<br><br>Both DB and Business Objects on the app server, and at some future point move the DB to its own server.<br><br>Also using team foundation and sharepoint (don't know if that makes any diff)<br><br>Complied. no prob. Installed. no prob.&nbsp; Doesn't run.&nbsp; I've thought its the server denying access, but I've setup the users under administrator.&nbsp; I don't know if its the firewall, or remoting or what.&nbsp; <br><br>Please help...I'm at a loss..<br><br>Running ptwin generates this error...<br><br><br>************** Exception Text **************<br>System.UnauthorizedAccessException: Access is denied. (Exception from HRESULT: 0x80070005 (E_ACCESSDENIED))<br>&nbsp;&nbsp; at System.Runtime.InteropServices.Marshal.ThrowExceptionForHRInternal(Int32 errorCode, IntPtr errorInfo)<br>&nbsp;&nbsp; at System.EnterpriseServices.Thunk.Proxy.CoCreateObject(Type serverType, Boolean bQuerySCInfo, Boolean&amp; bIsAnotherProcess, String&amp; uri)<br>&nbsp;&nbsp; at System.EnterpriseServices.ServicedComponentProxyAttribute.CreateInstance(Type serverType)<br>&nbsp;&nbsp; at System.Runtime.Remoting.Activation.ActivationServices.IsCurrentContextOK(Type serverType, Object[] props, Boolean bNewObj)<br>&nbsp;&nbsp; at EnterpriseServicesHost.EnterpriseServicesProxy.GetServerObject() in D:\CSLA\ProjectTracker20cs\EnterpriseServicesHostcs\EnterpriseServicesProxy.cs:line 13<br>&nbsp;&nbsp; at Csla.DataPortalClient.EnterpriseServicesProxy.Fetch(Type objectType, Object criteria, DataPortalContext context) in D:\CSLA\csla20cs\Csla\DataPortal\Client\EnterpriseServicesProxy.cs:line 52<br>&nbsp;&nbsp; at Csla.DataPortal.Fetch(Type objectType, Object criteria) in D:\CSLA\csla20cs\Csla\DataPortal\Client\DataPortal.cs:line 185<br>&nbsp;&nbsp; at Csla.DataPortal.Fetch[T](Object criteria) in D:\CSLA\csla20cs\Csla\DataPortal\Client\DataPortal.cs:line 140<br>&nbsp;&nbsp; at ProjectTracker.Library.Security.PTIdentity.GetIdentity(String username, String password) in D:\CSLA\ProjectTracker20cs\ProjectTracker.Library\Security\PTIdentity.cs:line 57<br>&nbsp;&nbsp; at ProjectTracker.Library.Security.PTPrincipal.Login(String username, String password) in D:\CSLA\ProjectTracker20cs\ProjectTracker.Library\Security\PTPrincipal.cs:line 15<br>&nbsp;&nbsp; at PTWin.LoginForm.OK_Click(Object sender, EventArgs e) in D:\CSLA\ProjectTracker20cs\PTWin\LoginForm.cs:line 23<br>&nbsp;&nbsp; at System.Windows.Forms.Control.OnClick(EventArgs e)<br>&nbsp;&nbsp; at System.Windows.Forms.Button.OnClick(EventArgs e)<br>&nbsp;&nbsp; at System.Windows.Forms.Button.PerformClick()<br>&nbsp;&nbsp; at System.Windows.Forms.Form.ProcessDialogKey(Keys keyData)<br>&nbsp;&nbsp; at System.Windows.Forms.TextBoxBase.ProcessDialogKey(Keys keyData)<br>&nbsp;&nbsp; at System.Windows.Forms.Control.PreProcessMessage(Message&amp; msg)<br>&nbsp;&nbsp; at System.Windows.Forms.Control.PreProcessControlMessageInternal(Control target, Message&amp; msg)<br>&nbsp;&nbsp; at System.Windows.Forms.Application.ThreadContext.PreTranslateMessage(MSG&amp; msg)<br><br><br>************** Loaded Assemblies **************<br>mscorlib<br>&nbsp;&nbsp;&nbsp; Assembly Version: 2.0.0.0<br>&nbsp;&nbsp;&nbsp; Win32 Version: 2.0.50727.42 (RTM.050727-4200)<br>&nbsp;&nbsp;&nbsp; CodeBase: file:///C:/WINDOWS/Microsoft.NET/Framework/v2.0.50727/mscorlib.dll<br>----------------------------------------<br>PTWin<br>&nbsp;&nbsp;&nbsp; Assembly Version: 1.0.0.0<br>&nbsp;&nbsp;&nbsp; Win32 Version: 1.0.0.0<br>&nbsp;&nbsp;&nbsp; CodeBase: file:///C:/Documents%20and%20Settings/onqami/Desktop/New%20Folder%20(2)/PTWin.exe<br>----------------------------------------<br>System.Windows.Forms<br>&nbsp;&nbsp;&nbsp; Assembly Version: 2.0.0.0<br>&nbsp;&nbsp;&nbsp; Win32 Version: 2.0.50727.42 (RTM.050727-4200)<br>&nbsp;&nbsp;&nbsp; CodeBase: file:///C:/WINDOWS/assembly/GAC_MSIL/System.Windows.Forms/2.0.0.0__b77a5c561934e089/System.Windows.Forms.dll<br>----------------------------------------<br>System<br>&nbsp;&nbsp;&nbsp; Assembly Version: 2.0.0.0<br>&nbsp;&nbsp;&nbsp; Win32 Version: 2.0.50727.42 (RTM.050727-4200)<br>&nbsp;&nbsp;&nbsp; CodeBase: file:///C:/WINDOWS/assembly/GAC_MSIL/System/2.0.0.0__b77a5c561934e089/System.dll<br>----------------------------------------<br>System.Drawing<br>&nbsp;&nbsp;&nbsp; Assembly Version: 2.0.0.0<br>&nbsp;&nbsp;&nbsp; Win32 Version: 2.0.50727.42 (RTM.050727-4200)<br>&nbsp;&nbsp;&nbsp; CodeBase: file:///C:/WINDOWS/assembly/GAC_MSIL/System.Drawing/2.0.0.0__b03f5f7f11d50a3a/System.Drawing.dll<br>----------------------------------------<br>System.Configuration<br>&nbsp;&nbsp;&nbsp; Assembly Version: 2.0.0.0<br>&nbsp;&nbsp;&nbsp; Win32 Version: 2.0.50727.42 (RTM.050727-4200)<br>&nbsp;&nbsp;&nbsp; CodeBase: file:///C:/WINDOWS/assembly/GAC_MSIL/System.Configuration/2.0.0.0__b03f5f7f11d50a3a/System.Configuration.dll<br>----------------------------------------<br>System.Xml<br>&nbsp;&nbsp;&nbsp; Assembly Version: 2.0.0.0<br>&nbsp;&nbsp;&nbsp; Win32 Version: 2.0.50727.42 (RTM.050727-4200)<br>&nbsp;&nbsp;&nbsp; CodeBase: file:///C:/WINDOWS/assembly/GAC_MSIL/System.Xml/2.0.0.0__b77a5c561934e089/System.Xml.dll<br>----------------------------------------<br>Csla<br>&nbsp;&nbsp;&nbsp; Assembly Version: 2.1.1.0<br>&nbsp;&nbsp;&nbsp; Win32 Version: 1.0.0.0<br>&nbsp;&nbsp;&nbsp; CodeBase: file:///C:/Documents%20and%20Settings/onqami/Desktop/New%20Folder%20(2)/Csla.DLL<br>----------------------------------------<br>ProjectTracker.Library<br>&nbsp;&nbsp;&nbsp; Assembly Version: 1.0.0.0<br>&nbsp;&nbsp;&nbsp; Win32 Version: 1.0.0.0<br>&nbsp;&nbsp;&nbsp; CodeBase: file:///C:/Documents%20and%20Settings/onqami/Desktop/New%20Folder%20(2)/ProjectTracker.Library.DLL<br>----------------------------------------<br>System.Web<br>&nbsp;&nbsp;&nbsp; Assembly Version: 2.0.0.0<br>&nbsp;&nbsp;&nbsp; Win32 Version: 2.0.50727.210 (QFE.050727-2100)<br>&nbsp;&nbsp;&nbsp; CodeBase: file:///C:/WINDOWS/assembly/GAC_32/System.Web/2.0.0.0__b03f5f7f11d50a3a/System.Web.dll<br>----------------------------------------<br>EnterpriseServicesHostcs<br>&nbsp;&nbsp;&nbsp; Assembly Version: 1.0.0.0<br>&nbsp;&nbsp;&nbsp; Win32 Version: 1.0.0.0<br>&nbsp;&nbsp;&nbsp; CodeBase: file:///C:/Documents%20and%20Settings/onqami/Desktop/New%20Folder%20(2)/EnterpriseServicesHostcs.DLL<br>----------------------------------------<br>System.EnterpriseServices<br>&nbsp;&nbsp;&nbsp; Assembly Version: 2.0.0.0<br>&nbsp;&nbsp;&nbsp; Win32 Version: 2.0.50727.42 (RTM.050727-4200)<br>&nbsp;&nbsp;&nbsp; CodeBase: file:///C:/WINDOWS/assembly/GAC_32/System.EnterpriseServices/2.0.0.0__b03f5f7f11d50a3a/System.EnterpriseServices.dll<br>----------------------------------------<br><br>************** JIT Debugging **************<br>To enable just-in-time (JIT) debugging, the .config file for this<br>application or computer (machine.config) must have the<br>jitDebugging value set in the system.windows.forms section.<br>The application must also be compiled with debugging<br>enabled.<br><br>For example:<br><br>&lt;configuration&gt;<br>&nbsp;&nbsp;&nbsp; &lt;system.windows.forms jitDebugging="true" /&gt;<br>&lt;/configuration&gt;<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>noyceb replied on Tuesday, April 03, 2007</h2><P>Well, your problem is most likely that the account that the application is running under (e.g. Network Service) does not have the appropriate permissions on the app server (hence the access violation comment above).&nbsp; If this is the case, and the application is a web site, you have a couple of options:</P>
<P>1) Create a new application pool on the web server just for this particular web application, assign the application pool to the web site, and assign a specific user for the application pool to run under - if you are in a domain, this should be a domain user with access to every tier; if you don't have a domain, setting the username and password to be the same on all tiers should do the trick.</P>
<P>2) Enable impersonation in the web.config via the &lt;identity .../&gt; tag.&nbsp; Again, this account is going to have to have access to all of the tiers.&nbsp; This would allow you to either impersonate the logged in user (windows authentication), or specify a specific user to impersonate (not really recommended for production).</P>
<P>If the application is not a web site...well...give the user the application is running under permissions to access the app server...;)</P>
<P>If neither of these is the case, post some more information and we will see...</P>
<P>Cheers.<BR>Ben Noyce</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>noyceb replied on Wednesday, April 04, 2007</h2><P>I thought I would add one other possibility to an 'Access Denied' error - if you have set all of the permissions up&nbsp;properly and still get access violations, it could be that one of the assemblies containing a business object that is attempting to move through the framework was not installed / successfully referenced from the enterprise service component.&nbsp; You need to be certain that all assemblies that contain business objects to be used by the framework (an any of their dependant assemblies) are installed with the component (and&nbsp;most likely should be&nbsp;located in the same directory).&nbsp; As a best practice, you should probably re-export the proxy and re-install it wherever relevant after registering the new component package.</P>
<P>Best of luck.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Mik123 replied on Thursday, April 05, 2007</h2><P>You're first post solved that problem.&nbsp; Thanks so much Ben.&nbsp;I did&nbsp;run into more issues, and the other posts helped solve the rest.&nbsp;Again thanks.</P>
<P>For those who may be having a similar issue, the server was orginally setup and I had installed remoting, and web services.&nbsp; But someone promoted it to a domain controller and everything that worked stopped. </P>
<P>Reinstalling SQL 2005&nbsp;under the new user fixed this problem.</P>
<P>I'm now having more issues with Enterprise services.&nbsp; Where it worked before (after being promoted to a domain controller), it does not work now.</P>
<P>I've followed all the steps of reinstalling the com objects, yet it will not recognize that the file exists. Everything works except through&nbsp;Enterprise.</P>
<P>The first curious thing I noticed is when I reinstalled the com objects, it remembered the username and the App root directory.&nbsp; I think this may be causing the problem, as the old dlls were deleted and a fresh batch was recomplied and rebuilt.&nbsp; If you look at the error msg, there are two locations.&nbsp; the one with 'Transfer\Ted' is incorrect.&nbsp; I don't understand why COM is still looking for it there, even when I added the files from the 'Test' directory.&nbsp;&nbsp;</P>
<P>Also, I'm running the PTWin right from the server to make sure it sets up the right proxy calls.&nbsp; I did this test for all other types before testing on a client machine.&nbsp; Failure is on the server not the client.</P>
<P>Thanks.</P>
<P>************** Exception Text **************<BR>System.IO.FileNotFoundException: Could not load file or assembly 'EnterpriseServicesHostcs' or one of its dependencies. The system cannot find the file specified.<BR>File name: 'EnterpriseServicesHostcs'<BR>&nbsp;&nbsp; at System.Reflection.Assembly.nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, Assembly locationHint, StackCrawlMark&amp; stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection)<BR>&nbsp;&nbsp; at System.Reflection.Assembly.InternalLoad(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark&amp; stackMark, Boolean forIntrospection)<BR>&nbsp;&nbsp; at System.Reflection.Assembly.InternalLoad(String assemblyString, Evidence assemblySecurity, StackCrawlMark&amp; stackMark, Boolean forIntrospection)<BR>&nbsp;&nbsp; at System.Activator.CreateInstance(String assemblyName, String typeName, Boolean ignoreCase, BindingFlags bindingAttr, Binder binder, Object[] args, CultureInfo culture, Object[] activationAttributes, Evidence securityInfo, StackCrawlMark&amp; stackMark)<BR>&nbsp;&nbsp; at System.Activator.CreateInstance(String assemblyName, String typeName)<BR>&nbsp;&nbsp; at Csla.DataPortal.GetDataPortalProxy(Boolean forceLocal) in D:\Transfer\Ted\projects\csla20cs\csla20cs\Csla\DataPortal\Client\DataPortal.cs:line 410<BR>&nbsp;&nbsp; at Csla.DataPortal.Fetch(Type objectType, Object criteria) in D:\Transfer\Ted\projects\csla20cs\csla20cs\Csla\DataPortal\Client\DataPortal.cs:line 175<BR>&nbsp;&nbsp; at Csla.DataPortal.Fetch[T](Object criteria) in D:\Transfer\Ted\projects\csla20cs\csla20cs\Csla\DataPortal\Client\DataPortal.cs:line 140<BR>&nbsp;&nbsp; at ProjectTracker.Library.Security.PTIdentity.GetIdentity(String username, String password) in D:\Test\csla20cs\ProjectTracker20cs\ProjectTracker.Library\Security\PTIdentity.cs:line 57<BR>&nbsp;&nbsp; at ProjectTracker.Library.Security.PTPrincipal.Login(String username, String password) in D:\Test\csla20cs\ProjectTracker20cs\ProjectTracker.Library\Security\PTPrincipal.cs:line 15<BR>&nbsp;&nbsp; at PTWin.LoginForm.OK_Click(Object sender, EventArgs e) in D:\Test\csla20cs\ProjectTracker20cs\PTWin\LoginForm.cs:line 23<BR>&nbsp;&nbsp; at System.Windows.Forms.Control.OnClick(EventArgs e)<BR>&nbsp;&nbsp; at System.Windows.Forms.Button.OnClick(EventArgs e)<BR>&nbsp;&nbsp; at System.Windows.Forms.Button.PerformClick()<BR>&nbsp;&nbsp; at System.Windows.Forms.Form.ProcessDialogKey(Keys keyData)<BR>&nbsp;&nbsp; at System.Windows.Forms.TextBoxBase.ProcessDialogKey(Keys keyData)<BR>&nbsp;&nbsp; at System.Windows.Forms.Control.PreProcessMessage(Message&amp; msg)<BR>&nbsp;&nbsp; at System.Windows.Forms.Control.PreProcessControlMessageInternal(Control target, Message&amp; msg)<BR>&nbsp;&nbsp; at System.Windows.Forms.Application.ThreadContext.PreTranslateMessage(MSG&amp; msg)</P>
<P>WRN: Assembly binding logging is turned OFF.<BR>To enable assembly bind failure logging, set the registry value [HKLM\Software\Microsoft\Fusion!EnableLog] (DWORD) to 1.<BR>Note: There is some performance penalty associated with assembly bind failure logging.<BR>To turn this feature off, remove the registry value [HKLM\Software\Microsoft\Fusion!EnableLog].</P>
<P>&nbsp;</P>
<P>************** Loaded Assemblies **************<BR>mscorlib<BR>&nbsp;&nbsp;&nbsp; Assembly Version: 2.0.0.0<BR>&nbsp;&nbsp;&nbsp; Win32 Version: 2.0.50727.42 (RTM.050727-4200)<BR>&nbsp;&nbsp;&nbsp; CodeBase: <A>file:///C:/WINDOWS/Microsoft.NET/Framework/v2.0.50727/mscorlib.dll</A><BR>----------------------------------------<BR>PTWin<BR>&nbsp;&nbsp;&nbsp; Assembly Version: 1.0.0.0<BR>&nbsp;&nbsp;&nbsp; Win32 Version: 1.0.0.0<BR>&nbsp;&nbsp;&nbsp; CodeBase: <A>file:///D:/Test/csla20cs/ProjectTracker20cs/PTWin/bin/Debug/PTWin.exe</A><BR>----------------------------------------<BR>System.Windows.Forms<BR>&nbsp;&nbsp;&nbsp; Assembly Version: 2.0.0.0<BR>&nbsp;&nbsp;&nbsp; Win32 Version: 2.0.50727.42 (RTM.050727-4200)<BR>&nbsp;&nbsp;&nbsp; CodeBase: <A>file:///C:/WINDOWS/assembly/GAC_MSIL/System.Windows.Forms/2.0.0.0__b77a5c561934e089/System.Windows.Forms.dll</A><BR>----------------------------------------<BR>System<BR>&nbsp;&nbsp;&nbsp; Assembly Version: 2.0.0.0<BR>&nbsp;&nbsp;&nbsp; Win32 Version: 2.0.50727.42 (RTM.050727-4200)<BR>&nbsp;&nbsp;&nbsp; CodeBase: <A>file:///C:/WINDOWS/assembly/GAC_MSIL/System/2.0.0.0__b77a5c561934e089/System.dll</A><BR>----------------------------------------<BR>System.Drawing<BR>&nbsp;&nbsp;&nbsp; Assembly Version: 2.0.0.0<BR>&nbsp;&nbsp;&nbsp; Win32 Version: 2.0.50727.42 (RTM.050727-4200)<BR>&nbsp;&nbsp;&nbsp; CodeBase: <A>file:///C:/WINDOWS/assembly/GAC_MSIL/System.Drawing/2.0.0.0__b03f5f7f11d50a3a/System.Drawing.dll</A><BR>----------------------------------------<BR>System.Configuration<BR>&nbsp;&nbsp;&nbsp; Assembly Version: 2.0.0.0<BR>&nbsp;&nbsp;&nbsp; Win32 Version: 2.0.50727.42 (RTM.050727-4200)<BR>&nbsp;&nbsp;&nbsp; CodeBase: <A>file:///C:/WINDOWS/assembly/GAC_MSIL/System.Configuration/2.0.0.0__b03f5f7f11d50a3a/System.Configuration.dll</A><BR>----------------------------------------<BR>System.Xml<BR>&nbsp;&nbsp;&nbsp; Assembly Version: 2.0.0.0<BR>&nbsp;&nbsp;&nbsp; Win32 Version: 2.0.50727.42 (RTM.050727-4200)<BR>&nbsp;&nbsp;&nbsp; CodeBase: <A>file:///C:/WINDOWS/assembly/GAC_MSIL/System.Xml/2.0.0.0__b77a5c561934e089/System.Xml.dll</A><BR>----------------------------------------<BR>Csla<BR>&nbsp;&nbsp;&nbsp; Assembly Version: 2.1.1.0<BR>&nbsp;&nbsp;&nbsp; Win32 Version: 1.0.0.0<BR>&nbsp;&nbsp;&nbsp; CodeBase: <A>file:///D:/Test/csla20cs/ProjectTracker20cs/PTWin/bin/Debug/Csla.DLL</A><BR>----------------------------------------<BR>ProjectTracker.Library<BR>&nbsp;&nbsp;&nbsp; Assembly Version: 1.0.0.0<BR>&nbsp;&nbsp;&nbsp; Win32 Version: 1.0.0.0<BR>&nbsp;&nbsp;&nbsp; CodeBase: <A>file:///D:/Test/csla20cs/ProjectTracker20cs/PTWin/bin/Debug/ProjectTracker.Library.DLL</A><BR>----------------------------------------<BR>System.Web<BR>&nbsp;&nbsp;&nbsp; Assembly Version: 2.0.0.0<BR>&nbsp;&nbsp;&nbsp; Win32 Version: 2.0.50727.62 (QFE.060727-6200)<BR>&nbsp;&nbsp;&nbsp; CodeBase: <A>file:///C:/WINDOWS/assembly/GAC_32/System.Web/2.0.0.0__b03f5f7f11d50a3a/System.Web.dll</A><BR>----------------------------------------</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>noyceb replied on Thursday, April 05, 2007</h2><P>From the sounds of it, I would manually uninstall the server component (via revsvcs /u &lt;component&gt; - and you might also check for any orphan enterpriseserviceshostcs.tlb after uninstalling), re-install the server component, re-export the proxy, uninstall the proxy from the clients and re-install.&nbsp;&nbsp;I know the default&nbsp;behavior of Enterprise Services is to re-use a registration if it already exists, which may explain why it remembered the user but not the app directory.&nbsp;&nbsp;Also, and I know you stated this was a server failure, but have you checked to be sure the Csla assembly is in the System32 directory of the CLIENT (where you are installing the proxy)?...this is the EXACT error I received from my original post, and installing the Csla assembly into System32 and re-installing the proxy solved the issue.</P>
<P>Of course a classic Windows reboot never hurt the testing either...</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
