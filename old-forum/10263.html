<html><header><title>SmartDate - I want textbox to be empty</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>SmartDate - I want textbox to be empty</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10263.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ksavoie posted on Thursday, April 14, 2011</h2><p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN" style="mso-ansi-language:EN;"><span style="font-size:small;"><span style="font-family:Calibri;">Hi</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN" style="mso-ansi-language:EN;"><span style="font-size:small;"><span style="font-family:Calibri;">I&#39;m at the end of my options with the SmartDate.</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN" style="mso-ansi-language:EN;"><span style="font-size:small;"><span style="font-family:Calibri;">This is my code.</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN" style="mso-ansi-language:EN;"><span style="font-size:small;"><span style="font-family:Calibri;">Private&nbsp;</span></span></span><span lang="EN" style="mso-ansi-language:EN;"><span style="font-size:small;"><span style="font-family:Calibri;">_contrSdtDt As SmartDate = New SmartDate(True)</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN" style="mso-ansi-language:EN;"><span style="font-size:small;"><span style="font-family:Calibri;">Public</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN" style="mso-ansi-language:EN;"><span style="font-size:small;"><span style="font-family:Calibri;">&nbsp;</span></span></span><span lang="EN" style="mso-ansi-language:EN;"><span style="font-size:small;"><span style="font-family:Calibri;">Property ContrSdtDt() As DateTime<br />Get<br />&nbsp;&nbsp;&nbsp;&nbsp; CanReadProperty(&quot;ContrSdtDt&quot;, True)<br />&nbsp;&nbsp;&nbsp;&nbsp; Return _contrSdtDt.Date<br />End Get</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN" style="mso-ansi-language:EN;"><span style="font-size:small;"><span style="font-family:Calibri;">&nbsp;</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN" style="mso-ansi-language:EN;"><span style="font-size:small;"><span style="font-family:Calibri;">Set(ByVal value As DateTime)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CanWriteProperty(&quot;ContrSdtDt&quot;, True)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not _contrSdtDt.Equals(value) Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _contrSdtDt.Date = value<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged(&quot;ContrSdtDt&quot;)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br />End Set<br />End Property</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN" style="mso-ansi-language:EN;"><span style="font-size:small;"><span style="font-family:Calibri;">In my textbox, when creating a new record, I keep getting the &quot;0001-01-01&quot; value, because my date is empty, but that&#39;s not what I want. &nbsp;I actually want an empty string, so an empty textbox.&nbsp; I&#39;m using a mask &quot;9999-99-99&quot; for that specific textbox in my window form.&nbsp; And I set the DataBindings.text to my ContrSdtDt.</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN" style="mso-ansi-language:EN;"><span style="font-size:small;"><span style="font-family:Calibri;">Can anybody help me on how to get my empty value show up in my textbox in window form?</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN" style="mso-ansi-language:EN;"><span style="font-size:small;"><span style="font-family:Calibri;">Thanks</span></span></span></p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>danielmartind replied on Thursday, April 14, 2011</h2><p>You need your property to be a string and return the text portion of the SmartDate.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ksavoie replied on Tuesday, April 19, 2011</h2><p>I already have a string property.&nbsp; But is there another way of doing this by using the Date property?</p>
<p>Thanks</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>sergeyb replied on Tuesday, April 19, 2011</h2><p>You can try to change your property to return .ToNullableDateTime() function, although this works much better bound to calendar control, rather than textbox.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Tuesday, April 19, 2011</h2><p>SmartDate is designed specifically to support the scenario where you have a string property, with a SmartDate backing field. The SmartDate type understands the concept of an &quot;empty&quot; value, and when it converts to a string it returns string.Empty if the SmartDate value is empty.</p>
<p>There is no other recommended scenario for using SmartDate.</p>
<p>If you just want a nullable DateTime, then use DateTime? as your property type, and deal with the null value issues in the UI itself. As Sergey says, you&#39;ll probably have better luck with a control that is smarter than a TextBox.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
