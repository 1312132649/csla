<html><header><title>DynamicRootList - Winforms Binding Template/Proper Binding Question</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>DynamicRootList - Winforms Binding Template/Proper Binding Question</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6905.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>xAvailx posted on Wednesday, May 06, 2009</h2>CSLA 3.6.1<br /><br />We are using the dynamic root list to bind to an editable grid. This is the code we use to remove an item from grid:<br /><br />Private Sub DeleteLogoColor(ByVal logoColorId As Integer)<br />		LogoColorsBindingSource.RaiseListChangedEvents = False<br />		BindingHelper.UnbindBindingSource(LogoColorsBindingSource, False, True)<br /><br />		Try<br />			Dim logoColor As RequestItemLogoColor = mLogoColors.GetItem(logoColorId)<br />			logoColor.Delete()<br />			logoColor = mLogoColors.SaveItem(logoColor)<br />			mLogoColors.Remove(logoColor)<br /><br />		Catch ex As ATBaseException<br />			MessageBox.Show(ex.Message, My.Resources.ATBaseExceptionErrorCaption, MessageBoxButtons.OK, MessageBoxIcon.Exclamation)<br />		End Try<br /><br />		BindUI()<br /><br />		LogoColorsBindingSource.RaiseListChangedEvents = True<br />		LogoColorsBindingSource.ResetBindings(True)<br />	End Sub<br /><br />We are having a problem where if there is an exception thrown an the grid needs to repaint (lost window focus, another window over, etc...) then we get an error with the currency manager because the grid can't find the source (since it is unbound). <br /><br />What is the current way to handle the binding/unbinding? or should there be no unbinding at all? I am having a hard time finding a template/example for dynamic root list binding to a winform grid.<br /><br />Thx.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, May 06, 2009</h2>The idea behind a dynamic list is that you don't unbind it. Nor do you need to write code to remove an item - just let the datagrid control do the removal when the user deletes the row.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xAvailx replied on Wednesday, May 06, 2009</h2>>> list is that you don't unbind <br />Ok, that is great to know. If we don't unbind, then it works correctly.<br /><br />>> Nor do you need to write code to remove an item <br />Well, this particular UI has a "global" to the form delete button, so the user highlights the row and clicks on the delete button. How should we handle this? <br /><br />Thx.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, May 06, 2009</h2>You can either have your code tell the datagrid to delete the row (so it<br />triggers normal data binding behavior), or your code can emulate the normal<br />data binding behavior that the datagrid would have done.<br /><br />Most likely, the datagrid, when a row is removed, calls the remove method on<br />the bindingSource - and if you do that, you should get the correct behavior.<br /><br />Rocky</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tiago replied on Wednesday, May 06, 2009</h2>There is a full commented example in Code Project. Refer to <A HREF="/forums/thread/31781.aspx">http://forums.lhotka.net/forums/thread/31781.aspx</A></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
