<html><header><title>SmartDate and DateTimeOffset</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>SmartDate and DateTimeOffset</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8350.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>GregDobbs posted on Wednesday, January 13, 2010</h2>Hello all.<br /><br />I've been unable to get SmartDate to persist DateTimeOffset values to the database. <br /><br />Property Definition:<br /><br />    Public Shared RegistrationDateProperty As PropertyInfo(Of SmartDate) = RegisterProperty(New PropertyInfo(Of SmartDate)("RegistrationDate"))<br />    Public Property RegistrationDate() As String<br />        Get<br />            Return GetPropertyConvert(Of SmartDate, String)(RegistrationDateProperty)<br />        End Get<br />        Set(ByVal value As String)<br />            SetPropertyConvert(Of SmartDate, String)(RegistrationDateProperty, value)<br />        End Set<br />    End Property<br /><br /><br />Insert Parameter:<br /><br />        cm.Parameters.AddWithValue("@RegistrationDate", ReadProperty(RegistrationDateProperty).DBValue)<br /><br /><br />The above result in a standard datetime value being inserted into SQL Server - the offset value is ignored.<br /><br />Anyone else handled this issue?<br /><br />Thanks!</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, January 13, 2010</h2><P>SmartDate internally uses a DateTime to store its information. It is a wrapper around DateTime, so the behavior you observe is correct.</P>
<P>SmartDate is convertible to/from other date types such as DateTimeOffset, but internally it doesn't maintain its information in that type.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>GregDobbs replied on Thursday, January 14, 2010</h2>Thanks for the response, Rocky.<br /><br />I guess my choices are 1) to modify the internal structure of SmartDate so it stores DateTimeOffset by default or 2) perhaps create my own version such as SmartDateOffset.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, January 14, 2010</h2>Yes, I think that is a fair summary.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Kyle replied on Wednesday, October 13, 2010</h2><p>It&#39;s been a while since anyone posted to this thread. I see that Rocky has put in SmartDateOffset as a future feature. Has anyone already coded (and tested) something that they could share in the meantime?</p>
<p>Thanks.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
