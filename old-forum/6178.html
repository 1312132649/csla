<html><header><title>Add Instance Rule issue</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Add Instance Rule issue</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6178.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rob.polak posted on Friday, January 16, 2009</h2><font size="2" face="Tahoma">So me and a co-worker are working on a project where we use very dynamic validation.&nbsp; The problem is that the context of the validation is only determined after the object is loaded.<br><br>Since we do not know the context of the validation when we create the object we cannot use the overloaded AddInstanceBusinessRules method (since the object is not loaded at the time of validation).<br><br>So the way we approached this problem was to load the validation after we load the object data.&nbsp; However, the problem with this is that the Rules never seem to apply for the object.&nbsp; After stepping through the source it seems attributed to the following code:<br><br></font><blockquote><b><font size="2" face="Tahoma">&nbsp;&nbsp;&nbsp; private ValidationRulesManager RulesToCheck</font><br><font size="2" face="Tahoma">&nbsp;&nbsp;&nbsp; {</font><br><font size="2" face="Tahoma">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get</font><br><font size="2" face="Tahoma">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</font><br><font size="2" face="Tahoma">&nbsp;<font color="#000000">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">&nbsp; if (_rulesToCheck == null )</font></font><br></b><br><br></blockquote>It appears that once the rules are loaded they are never loaded again.&nbsp;
So my question is there a way to reload the rules after I add one (not
in one of the two provided methods)?&nbsp; Or do I need to modify the source
to always get the current rules to check?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>stacy.odell replied on Friday, January 16, 2009</h2><P>He's talking about version 3.0.4, by the way.</P>
<P>We are loading unique and dynamic validation methods from a database, per object instance -- and we obviously need to know certain things about the instance (like the ID for example) when we go to look up the validators for that item in the database and apply them as instance rules.&nbsp; One instance of an object can have completely and wildly different validation rules applied to it than another.</P>
<P>AddBusinessInstanceRules fires before we know what the instance's ID property is, so we cannot look up the rules in the database at that point.&nbsp; The rest is as Rob states above</P>
<P>-- Stacy (the coworker)</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, January 16, 2009</h2>What if you tackle this by going another route... all rules always apply (that is, are registered with AddValidationRule), but the rule itself is smart enough to know it should not really do anything or that it should do something.<br><br>For this to work, the instance (or possibly class) may need to load all the data affecting the rules.&nbsp;&nbsp; For example, the instance would load it's values, and then you have another class that specifies which values cause the rule to apply.&nbsp; The rule then uses your instance and this helper class to figure out if it should run the rule or return true.<br><br>Does that make sense?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fintanv replied on Friday, January 16, 2009</h2>When the id changes can you clear and re-load the instance rules?<br>The following thread provides a mechanism to clear the objects loaded instance rules without modifying the CSLA code directly.&nbsp; When the new rules are loaded simply run a CheckRules().<br><br>http://forums.lhotka.net/forums/thread/25819.aspx<br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
