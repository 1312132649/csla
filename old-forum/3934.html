<html><header><title>Retrieving private member variables during validation</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Retrieving private member variables during validation</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3934.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonM posted on Friday, November 23, 2007</h2><P>Current I'm using C# and the Utilities.CallByName function&nbsp;to retrieve public properties in my validation functions.&nbsp; I need to retrieve a private variables in a couple of different rules and do not want to expose them as public members.&nbsp; Everytime I try it I get an "Object reference not set to an instance of an object." error.&nbsp; Any ideas here?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>William replied on Friday, November 23, 2007</h2><P>If you are defining your rule method inside the corresponding business object, you can access the private members directly. For example,</P>
<P><FONT face="Courier New" size=2>[Serializable]<BR>public class Customer : BusinessBase&lt;Customer&gt;<BR>{<BR>&nbsp; private string _name;<BR>&nbsp; ...<BR>&nbsp; private static bool NameValidation(Customer target, RuleArgs e)<BR>&nbsp; {<BR>&nbsp;&nbsp;&nbsp; return target._name&nbsp;!= null &amp;&amp; target._name.Trim().Length &gt; 0;<BR>&nbsp; }<BR>}</FONT></P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ayubu replied on Saturday, November 24, 2007</h2><P>It depends </P>
<P>if the property you want to access set/gets an value which belongs to another user defined object that will be created later by your class through the constructor( for child objects) , then&nbsp;you will face the message since the validation rules are bound to the object before it is even created i.e when the base business classes are created.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, November 26, 2007</h2><P>William is correct - if the rule method is in your business class then you can access the fields directly. And if you use the generic overloads for rules (as discussed in the <EM>CSLA .NET Version 2.1 Handbook</EM>) then you can access the fields off the target parameter.</P>
<P>However, if your rule method is <EM>not</EM> in the business class, then you have a bigger challenge. You can then either use reflection (which is what the Utilities method uses, but it only works on properties, so you'd have to write your own variation to use fields - and accessing private fields via reflection is pretty slow so make sure to test). Or you can use an interface to expose the values.</P>
<P>For an example of using an interface, look at ProjectTracker.Library and how IHoldRoles is used.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
