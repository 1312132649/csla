<html><header><title>Runtime properties</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Runtime properties</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2407.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Clayton posted on Thursday, February 22, 2007</h2>We have a business case where we need to set properties that we only know at runtime. It would be too difficult to program every conceivable runtime scenario for updating the properties.<br><br>What we've done to get around this is to add the code below to BusinessBase&lt;T&gt;. Does anyone have a more efficient way to do this? Is it useful enough that a variant could be added to CSLA?<br><br>private static PropertyDescriptorCollection _properties = System.ComponentModel.TypeDescriptor.GetProperties(typeof(T));<br><br>public object this[string propertyName]<br>{<br>&nbsp;&nbsp;&nbsp; get<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return _properties[propertyName].GetValue(this);<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; set<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _properties[propertyName].SetValue(this, value);<br>&nbsp;&nbsp;&nbsp; }<br>}<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, February 22, 2007</h2><P>The solution to your problem is probably the Decorator design pattern - which is similar to what you've done.</P>
<P>But Decorator formalizes the separation slightly, by having the extra properties in a collection that is referenced by your object. In other words, don't make your object itself into a collection by adding an indexer, but rather have your object expose a read-only property to provide a reference to your decorator collection.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
