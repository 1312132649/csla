<html><header><title>data portal related issue</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>data portal related issue</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5635.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Chris2008 posted on Monday, October 20, 2008</h2><P>Hello:</P>
<P>I am a member of a team using CSLA 1.3 to develop an application and was hoping for some insight into the following issue . . .</P>
<P>An invoice object (inherets from BusinessBase) has a child InvoiceLineItemCollection.&nbsp; Each time the InvoiceLineItemCollection is set, code is called that registers event handers:</P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P><FONT color=#000000 size=3>public</FONT></FONT></FONT><FONT color=#000000> void</FONT><FONT color=#000000> GetInvoiceLineItemCollection()<BR></FONT><FONT color=#000000>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Code that creates criteria object<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Criteria criteria = new Criteria()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; etc.</FONT><BR><BR><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Code that sets invoice line item collection.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#000000>_invoiceLineItemCollection =&nbsp;&nbsp; InvoiceLineItemCollection.GetInvoiceLineItemCollection(Criteria);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RegisterChildEventHandlers();<BR>}</FONT></P>
<P><FONT color=#000000>private</FONT><FONT color=#000000> void</FONT><FONT color=#000000> RegisterChildEventHandlers()<BR></FONT><FONT color=#000000>{<BR></FONT><FONT color=#000000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_invoiceLineItemCollection.ListChanged+=new</FONT><FONT color=#000000> System.ComponentModel.ListChangedEventHandler(ChildCollection_ListChanged);<BR>}</FONT></P>
<P><FONT color=#000000>During runtime, the ChildCollection_ListChanged method does not execute when the InvoiceLineItem collection is changed.&nbsp; This problem does not occur when the application&nbsp;accesses the database directly . . .&nbsp;only when the data portal is used.</FONT></P>
<P>Any thoughts on why this may be happening?</P>
<P>Thanks!<BR>Chris<FONT size=2>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>sergeyb replied on Monday, October 20, 2008</h2>









 

 
  
 




<div class=Section1>

<p class=MsoNormal><span>The handlers will be lost during serialization / de-serialization
process.&nbsp; You will need to re-establish them after de-serialization.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><b><span>Sergey Barskiy<o:p></o:p></span></b></p>

<p class=MsoNormal><b><i><span>Principal Consultant<o:p></o:p></span></i></b></p>

<p class=MsoNormal><span>office: 678.405.0687 |
mobile:&nbsp;404.388.1899</span><span><o:p></o:p></span></p>

<p class=MsoNormal><span><img width=119 height=26 id="Picture_x0020_1" alt="cid:_2_0648EA840648E85C001BBCB886257279"><br>
</span><b><span>Microsoft Worldwide Partner of the Year |</span></b><span> </span><b><span>Custom
Development Solutions, Technical Innovation</span></b><span><o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<div>

<p class=MsoNormal><b><span>From:</span></b><span> Chris2008
[mailto:cslanet@lhotka.net] <br>
<b>Sent:</b> Monday, October 20, 2008 11:21 AM<br>
<b>To:</b> Sergey Barskiy<br>
<b>Subject:</b> [CSLA .NET] data portal related issue<o:p></o:p></span></p>

</div>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p>Hello:<o:p></o:p></p>

<p>I am a member of a team using CSLA 1.3 to develop an application and was
hoping for some insight into the following issue . . .<o:p></o:p></p>

<p>An invoice object (inherets from BusinessBase) has a child
InvoiceLineItemCollection.&nbsp; Each time the InvoiceLineItemCollection is
set, code is called that registers event handers:<o:p></o:p></p>

<p><span>public void GetInvoiceLineItemCollection()<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Code that creates criteria object<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Criteria criteria = new Criteria()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; etc.</span><br>
<br>
<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Code that sets
invoice line item collection.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_invoiceLineItemCollection =&nbsp;&nbsp;
InvoiceLineItemCollection.GetInvoiceLineItemCollection(Criteria);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RegisterChildEventHandlers();<br>
}</span><o:p></o:p></p>

<p><span>private void RegisterChildEventHandlers()<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_invoiceLineItemCollection.ListChanged+=new
System.ComponentModel.ListChangedEventHandler(ChildCollection_ListChanged);<br>
}</span><o:p></o:p></p>

<p><span>During runtime, the ChildCollection_ListChanged
method does not execute when the InvoiceLineItem collection is changed.&nbsp;
This problem does not occur when the application&nbsp;accesses the database
directly . . .&nbsp;only when the data portal is used.</span><o:p></o:p></p>

<p>Any thoughts on why this may be happening?<o:p></o:p></p>

<p>Thanks!<br>
Chris<span>&nbsp;<o:p></o:p></span></p>

<p class=MsoNormal><br>
<br>
<o:p></o:p></p>

</div>



</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Chris2008 replied on Monday, October 20, 2008</h2><P>Thanks for the quick reply Sergey.</P>
<P>Serialization doesn't appear to be the problem because the issue occurs prior to the invoice object being saved.&nbsp; For example:</P>
<P>Invoice invoice = Invoice.GetInvoice(1);<BR>invoice.GetInvoiceLineItemCollection()<BR><BR>// This line of code does not cause ChildCollection_ListChanged method to execute.<BR>invoice.InvoiceLineItemCollection[0].Notes = "x";<BR><BR>Chris</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>sergeyb replied on Monday, October 20, 2008</h2>









 

 
  
 




<div class=Section1>

<p class=MsoNormal><span>I see. Does Invoice.GetInvoice() call data portal?<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><b><span>Sergey Barskiy<o:p></o:p></span></b></p>

<p class=MsoNormal><b><i><span>Principal Consultant<o:p></o:p></span></i></b></p>

<p class=MsoNormal><span>office: 678.405.0687 |
mobile:&nbsp;404.388.1899</span><span><o:p></o:p></span></p>

<p class=MsoNormal><span><img width=119 height=26 id="Picture_x0020_1" alt="cid:_2_0648EA840648E85C001BBCB886257279"><br>
</span><b><span>Microsoft Worldwide Partner of the Year |</span></b><span> </span><b><span>Custom
Development Solutions, Technical Innovation</span></b><span><o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<div>

<p class=MsoNormal><b><span>From:</span></b><span> Chris2008
[mailto:cslanet@lhotka.net] <br>
<b>Sent:</b> Monday, October 20, 2008 12:00 PM<br>
<b>To:</b> Sergey Barskiy<br>
<b>Subject:</b> Re: [CSLA .NET] RE: data portal related issue<o:p></o:p></span></p>

</div>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p>Thanks for the quick reply Sergey.<o:p></o:p></p>

<p>Serialization doesn't appear to be the problem because the issue occurs
prior to the invoice object being saved.&nbsp; For example:<o:p></o:p></p>

<p>Invoice invoice = Invoice.GetInvoice(1);<br>
invoice.GetInvoiceLineItemCollection()<br>
<br>
// This line of code does not cause ChildCollection_ListChanged method to
execute.<br>
invoice.InvoiceLineItemCollection[0].Notes = &quot;x&quot;;<br>
<br>
Chris<o:p></o:p></p>

<p class=MsoNormal><br>
<br>
<o:p></o:p></p>

</div>



</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Chris2008 replied on Monday, October 20, 2008</h2><P>Yes, Invoice.GetInvoice() calls the data portal as does Invoice.GetInvoiceLineItemCollection().</P>
<P>Thanks, <BR>Chris</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>sergeyb replied on Monday, October 20, 2008</h2>









 

 
  
 




<div class=Section1>

<p class=MsoNormal><span>Then you need to re-attach your events because Fetch process
will break them just as Save would.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><b><span>Sergey Barskiy<o:p></o:p></span></b></p>

<p class=MsoNormal><b><i><span>Principal Consultant<o:p></o:p></span></i></b></p>

<p class=MsoNormal><span>office: 678.405.0687 |
mobile:&nbsp;404.388.1899</span><span><o:p></o:p></span></p>

<p class=MsoNormal><span><img width=119 height=26 id="Picture_x0020_1" alt="cid:_2_0648EA840648E85C001BBCB886257279"><br>
</span><b><span>Microsoft Worldwide Partner of the Year |</span></b><span> </span><b><span>Custom
Development Solutions, Technical Innovation</span></b><span><o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<div>

<p class=MsoNormal><b><span>From:</span></b><span> Chris2008
[mailto:cslanet@lhotka.net] <br>
<b>Sent:</b> Monday, October 20, 2008 1:31 PM<br>
<b>To:</b> Sergey Barskiy<br>
<b>Subject:</b> Re: [CSLA .NET] RE: RE: data portal related issue<o:p></o:p></span></p>

</div>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p>Yes, Invoice.GetInvoice() calls the data portal as does
Invoice.GetInvoiceLineItemCollection().<o:p></o:p></p>

<p>Thanks, <br>
Chris<o:p></o:p></p>

<p class=MsoNormal><br>
<br>
<o:p></o:p></p>

</div>



</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Chris2008 replied on Monday, October 20, 2008</h2><P class=MsoNormal><FONT face=Calibri>Thanks again for your help Sergey.</FONT></P>
<P class=MsoNormal><FONT face=Calibri>Perhaps I don't fully understand the point you're making, but it seems the event handlers are already being reattached.</FONT></P>
<P class=MsoNormal><FONT face=Calibri>When a client calls Invoice.GetInvoiceLineItemCollection, the child event handlers are reattached immediately after the _invoiceLineItemCollection is populated (see GetInvoiceLineItemCollection code listed above).</FONT></P><SPAN>Thanks,<BR>Chris</SPAN></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
