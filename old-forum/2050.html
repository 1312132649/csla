<html><header><title>apply sort to BusinessCollectionBase from code (v1.5)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>apply sort to BusinessCollectionBase from code (v1.5)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2050.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>kayakheaven posted on Friday, December 29, 2006</h2><P>Here is how to apply a sort to a BusinessCollectionBase (v1.5) from code, in case anyone finds&nbsp;the example&nbsp;useful. I didn't find it in the forum when I searched just now. Could be simplied by replacing _list[0] and check of _list.Count with a canonical instance.</P><FONT size=2>
<P>using System.ComponentModel;</FONT><FONT color=#0000ff size=2></FONT></P>
<P><FONT color=#0000ff size=2>if</FONT><FONT size=2> (_list.Count &gt; 0)</P>
<P>{</P>
<P>PropertyDescriptorCollection properties = TypeDescriptor.GetProperties(_list[0]);</P>
<P>PropertyDescriptor property = properties.Find("name", </FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>);</P>
<P>ListSortDirection direction = ListSortDirection.Ascending;</P>
<P>((IBindingList)_list).ApplySort(property, direction);</P>
<P>}</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Saturday, December 30, 2006</h2><P>In 1.x there was a larg community effort to build Sortable CollectionBase (and then FilterableCollectionBase). As I recall, the code would be added to Csla (maybe re-name an existing file so it uses the new code in the file of the same name) and then re-compile Csla. This allowed you to sort and filter any Csla collections. In the old forum there was an Attachments section or something where you could download the code.</P>
<P>In 2.x the idea has changed to a bit. Rather than modify the collection directly, you provide a View of it and then display the View. This View can be sorted or filtered or both. Rocky provides the SortedListView and the Filtered ListView in 2.x. Brian Criswell provides the ObjectListView which does both PLUS has the ability to do multi-property sorting (which Rocky's does not do.)</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kayakheaven replied on Monday, January 01, 2007</h2><P>Hi Joe, could you clarify a couple of points from your post. </P>
<P>You mention "the old forum", is that available anywhere?</P>
<P>CSLA v1.5 download from lhotka.net has SortedCollectionBase included in it, but I don't see anything for FilteredCollectionBase, or did I miss it? </P>
<P>You still have to write code in your own UI form or class to make the sort happen. I didn't find that sample anywhere in this forum. That is what my posting illustrates.</P>
<P>When you talk about the idea changing in v2.x, my&nbsp;understanding is that v1.5 also uses a "view", which maps the sorted ids to the unsorted base collection. Perhaps the v2.x view is different.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Monday, January 01, 2007</h2>I think what Joe was referring to is that the 1.x lists had the ability to sort themselves.&nbsp; SortedCollectionBase is the filename, but the class within is SortableCollectionBase.&nbsp; It provides the sorting functionality for BusinessCollectionBase.&nbsp; After 1.x had been out for a while, someone released a sorted view class that did stable sorts (and multi-column sorts?).&nbsp; A filtered view class was also released by someone else.&nbsp; A VB version is available on the wiki (linked at the top of the main forum page), and I have attached a C# version.<br><br>One of my friends also back-ported the ObjectListView to CSLA 1.x by removing the reference to IBindingListView and making a few other tweaks so that it would compile.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Monday, January 01, 2007</h2>Go figure I never attached the file.<br><br>As a side note, one thing a lot of people do is create their own ObjectBase, ListBase, ROObjectBase and ROListBase classes.&nbsp; This would allow you to have an ApplySort(string, ListSortDirection) method in ListBase that could take a property name and internally convert it to the correct property descriptor, allowing you to implement the functionality once for all of your lists.<br><br>I do not have a copy of the back ported ObjectListView.&nbsp; I will see if I can duplicate what my friend did.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Thursday, January 11, 2007</h2>If you want, you can try it a first version of the ObjectListView backported to CSLA 1.x.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kayakheaven replied on Thursday, January 11, 2007</h2><div>Thanks Brian, really appreciate your help. I had a quick read of the source 
code. Just so I don't misunderstand, is this a full port beta version or a 
partial port with some features not yet ported?</div></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Thursday, January 11, 2007</h2>All the functionality should be there.&nbsp; The changes include:<br><ul><li>Some extra classes and interfaces were added to be stand-ins for those that were added in .NET 2</li><li>Generic lists were changed to the non-generic versions</li><li>Detection of the type in a list was changed</li><li>Some of the property changed notification was stripped out.&nbsp; I now realise that was probably not necessary as I could have used the same solution as in step 1.&nbsp; You will probably not notice that it is missing.<br></li></ul></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
