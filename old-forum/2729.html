<html><header><title>Using GridView paging with BusinessListBase-inherited object.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Using GridView paging with BusinessListBase-inherited object.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2729.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>MarkHildreth posted on Wednesday, April 18, 2007</h2>Hi all.<br><br>Still trucking through the early stages of learning the framework, I've encountered this problem:<br><br>I've created a class named (notoriously..) "Bug" which inherits from BusinessBase. It has a child object which is a class called "BugComments" that inherits from BusinessListBase, each object in the list being also a BusinessBase ("BugComment"). I've attached this child object to a grid view on the page where the parent class is the main business object, and am trying to do paging on the grid view (at grid-view level, no worries about performance at this stage).<br><br>I was able to easily accomplish this with another list on another page that inherited from ReadOnlyListBase. I'm trying to do things similarly, however, I'm running into the following problem with BugComments...<br><br>The paging always seems to have the correct amount of pages (if the page size is three and I have nine "comments", there are three pages). However, all of the pages, except for the last one, will always have the first X items, where X is the size of the page. So, if the page size is four, then pages one, two and three will have the first three items listed (where two and three should have their own unique items). When I hit the final page, I get ALL of the items listed, even if it's more than the paging should handle.<br><br>I switched the data source to read straight from the database through a different adapter and it worked as it should.<br><br>The SelectObject function for the CslaDataSource...<br><br>&nbsp;&nbsp;&nbsp; protected void bugCommentsDataSource_SelectObject(object sender, Csla.Web.SelectObjectArgs e)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Bugz.Bug obj = GetBug();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.BusinessObject = obj.BugComments;<br>&nbsp;&nbsp;&nbsp; }<br><br><br>GetBug()...<br><br>&nbsp;&nbsp;&nbsp; private Bugz.Bug GetBug()<br>
&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object businessObject = Session["currentObject"];<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (businessObject == null || !(businessObject is Bugz.Bug))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string idString = Request.QueryString["id"];<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (String.IsNullOrEmpty(idString))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; businessObject = Bugz.Bug.NewBug();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; businessObject = Bugz.Bug.GetBug(Convert.ToInt32(idString));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (System.Security.SecurityException)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Redirect("BugList.aspx");<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Csla.DataPortalException)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Redirect("BugList.aspx");<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return (Bugz.Bug)businessObject;<br>
&nbsp;&nbsp;&nbsp; }<br><br>Thinking it might've been something that I did with the GetBug and persisting the object in Session, I went to just getting it every time from the db...<br><br>&nbsp;&nbsp;&nbsp; protected void bugCommentsDataSource_SelectObject(object sender, Csla.Web.SelectObjectArgs e)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Bugz.Bug obj = GetBug();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //e.BusinessObject = obj.BugComments;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.BusinessObject = Bugz.Bug.GetBug(Convert.ToInt32(Request.QueryString["id"])).BugComments;<br>&nbsp;&nbsp;&nbsp; }<br><br>Same incorrect results.<br><br>Any ideas?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cslasoup replied on Thursday, June 09, 2011</h2><p>Did you ever get this resolved? &nbsp;I am currently having the same issue. &nbsp;This is the first result I&#39;ve come across in my search for a solution so I will keep looking.</p>
<p><b>[UPDATE]</b> I figured out the issue for my case. &nbsp;Since my object doesn&#39;t directly support paging or sorting, the TypeSupportsPaging and TypeSupportsSorting properties on the CSLADataSource object should have been set to False but instead I had them set to True. &nbsp;Changing them to False allowed the GridView to handle the paging automatically.</p>
<p>If your object <strong>DOES </strong>support paging and sorting, then you should set those properties to True so that ASP.NET defers those actions to your business object. &nbsp;</p>
<p><span style="text-decoration:underline;"><b><i>Source: P. 635 Expert VB 2008 Business Objects.</i></b></span></p>
<p>Hope this helps someone else out.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
