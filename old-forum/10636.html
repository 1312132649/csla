<html><header><title>CSLA mobile objects network transmission</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA mobile objects network transmission</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10636.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Direvius posted on Thursday, August 25, 2011</h2><p>Good day everyone!</p>
<p>We have a webapp based on Silverlight, WCF and CSLA. I&#39;ve done some performance optimization for the app and the bottleneck for now is CSLA. I&#39;ve analyzed the request, it was a search by UID operation. </p>
<p>UID is 10-digit decimal. CSLA had serialized an object (FindByUIDCriteria) with a huge amount of additional data (state stack for example) resulted in message size of 50 KB. We have to make about 850 similar requests per second which is obviously can make our 8-core CPU to cry (and the network).</p>
<p>Is there a way to reduce the message size (maybe by disabling the undo history or global and client contexts transmission)?</p>
<p>Thnx, Alexey.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Thursday, August 25, 2011</h2><p>If you are doing hundreds of requests per second you will probably have issues even if you reduce the message size.</p>
<p>To directly answer your question, there is no practical way to reduce the message size while using the data portal. The data portal clones the object graph over the wire, and that incurs some overhead.</p>
<p>One option is to make a direct service call (don&#39;t use the data portal) for this particular request. In other words, for this particular business object, use the local data portal, and make a direct WCF service call. That can reduce the message size quite a bit, because you won&#39;t be moving entire objects over the network.</p>
<p>I suspect you&#39;ll still have issues though, so here&#39;s my suggestion: use time-boxed batching.</p>
<p>Most high volume network implementations (including TCP, etc) combine numerous small messages into a single message as an important optimization. The performance difference is so dramatic it is one of those things we couldn&#39;t live without (literally - the Internet wouldn&#39;t work without this technique).</p>
<p>If you are doing hundreds of requests per second, you can probably combine these requests into 1, 2, or 4 server calls - each of these server calls containing several hundred requests. </p>
<p>The efficiencies gained by doing this are important, because each request has TCP, network latency, HTTP, IIS, ASP.NET, WCF, and .NET overhead. Even if you get your request size very small, every one of your hundreds of requests incurs all this overhead - and that adds up.</p>
<p>If you can make 1 server call per second, with that server call containing all 850 UID values, then you incur all that overhead exactly one time per second, and that&#39;ll make a huge difference.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Direvius replied on Thursday, August 25, 2011</h2><p>Thanx for the answer, it&#39;s all clear for me now.</p>
<p>Unfortunately, we can&#39;t use time-boxed batching as the requests are coming from different users (Silverlight clients). We&#39;ll try WCF calls.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
