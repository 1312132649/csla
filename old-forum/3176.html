<html><header><title>binding to business object with property datatypes as enum</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>binding to business object with property datatypes as enum</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3176.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rd_bigdog posted on Wednesday, July 11, 2007</h2><P><BR>I have a business object I want to use for binding. There are a series of combobox on the form that are populated via a bindingsource which sets the DataSource, DataMember, ValueMemeber. THis populates the combo with available values. Now, I bind all the controls on teh form to my business object. The BO has a property which I set to be bound to the SelectedValue of the combo. The property in question is defined as an enum. It seems like the binding mechanism cannot read/write from the property when defined as an enum. If I change it to Integer, it all works correctly.</P>
<P>Does anyone know the cause of this issue? Is there a work around or something I need to do to make this work? If I has to use integers for my properites, it will not be pretty, I have dozens of enums and the code will get very ugly fast.</P>
<P>Thanks in advance for any assistance you may provide.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>hurcane replied on Wednesday, July 11, 2007</h2>Enums *are* integers. The enum values are only around in your source code. When it is compiled, they all become integers. Suppose you have an enum with members Red, White, and Blue. Red = 0, White = 1, and Blue = 2.<br><br>You probably want your enum options to display with a user-friendly value in the combo box (like Red, White, or Blue). I think you're going to need an additional object that represents the list of those values. I haven't tried this, but perhaps you could use reflection against the Enum to generate the list? I'm not sure if reflection will let you retrieve "Red" out of the enum type, but it could be worth exploring.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rd_bigdog replied on Thursday, July 12, 2007</h2><P>Hi,</P>
<P>Thanks for your reply. </P>
<P>So, what is happening is that I am not binding the combobox to the enum values. I am binding the combo box to a List object that contains the values loaded from the database. However, to represent the values loaded in the database, I use enums in the application.</P>
<P>So, for example I have,</P>
<P>Public Enum MyEnum</P>
<P>Red</P>
<P>White</P>
<P>Blue</P>
<P>End Enum</P>
<P>&nbsp;</P>
<P>And in my business object, I have a property</P>
<P>public property SomeColor as MyEnum</P>
<P>Get...</P>
<P>Set...</P>
<P>End property.</P>
<P>&nbsp;</P>
<P>I have a binding source that is set to an Object of a ReadOnlyList&nbsp; that is used to populate the combobox. Then, in my business object for the overall form, I have a property like above. I bind teh SelectedValue to the property in the Business Object so that when an object is being edited, the combobox shows the right value.</P>
<P>I put a breakpoint on teh Get and Set routine in teh property. When I change the value in the combobox, the set never gets called, but the Get is getting called 2 or 3 times. Then the form goes into a state where I cannot even take teh focus of the combobox in question, can't even close the form with the controlbox.</P>
<P>I am going to do some isolated testing today, but there seems to be a limitation here...hoping I am wrong though.</P>
<P>&nbsp;</P>
<P>Rick.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Thursday, July 12, 2007</h2><P>I'm a bit confused.</P>
<P>Enums are a static construct, and building a list of values from the database is, by definition, a dynamic thing to do.&nbsp; So I'm concerned about keeping the list of values in the enum the same as the list of items in the database.&nbsp; It just feels like a design mismatch to me.</P>
<P>Why not&nbsp;load an NVList (from NameValueListBase) from the database and bind it to the combobox?&nbsp; That's what it's for! :)</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rd_bigdog replied on Thursday, July 12, 2007</h2><P>Hello,</P>
<P>Ok, so binding a list of items to the combobox is not the issue.</P>
<P>Yes, we have enums that are kept in sync with values from the database, good or bad, that is how it was done.</P>
<P>I bind the combobox based on an id that will give me a group of related possible values for a particular domain from the database (also b/c we are supporting multiple languages, this is in teh database). This is fine.</P>
<P>My issue is with the business object that has attributes of those enum types.</P>
<P>The business object has a property, for example, a car object, with a color property, wher the only options are red,white,blue as the enum above. So, when declaring the property on the Car object, it is delcared as the enum type. Why? So that when developers are coding against the property, they immediatly see the options for the enum...this is very common practice throughout the entire .Net framework.</P>
<P>So, I have a winform to manage my 'car' object. I use a combobox to give the user the limited choices they have on colors. I load the available values from the database in teh appropriate language for the user. I bind all the controls on my winform to by Car object. The combobox selected value is bound to the color property whose datatype is defined as the colors enum above.</P>
<P>The winform is not behaving nicely in this situation. It is not calling the Set on teh property when the value is changed. It is calling the get,but not changing the value in the combobox based on teh value of the property when the property datatype is the enum.</P>
<P>Please note that my issue has nothing to do with loading the combobox, it has to do with binding the comboboxes on the form to properties of my business object.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rd_bigdog replied on Thursday, July 12, 2007</h2><P>I know this is down the path of a general .Net thing now, but I am trying to do a proof of concept with the CSLA framework with our existing application. And this is how I came accross this. Here is a sample app I whipped up that will demonstrate the problem.</P><FONT color=#0000ff size=2>
<P>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Enum</FONT><FONT size=2> MyEnum</P>
<P>One = 1</P>
<P>Two</P>
<P>Three</P>
<P>Four</P></FONT><FONT color=#0000ff size=2>
<P>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Enum</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> Form1_Load(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.EventArgs) </FONT><FONT color=#0000ff size=2>Handles</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.Load</P>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> sortedList </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Collections.ArrayList = </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> ArrayList</P>
<P>sortedList.Add(</FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> myItems(-1, </FONT><FONT color=#a31515 size=2>""</FONT><FONT size=2>))</P>
<P>sortedList.Add(</FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> myItems(1, </FONT><FONT color=#a31515 size=2>"One"</FONT><FONT size=2>))</P>
<P>sortedList.Add(</FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> myItems(2, </FONT><FONT color=#a31515 size=2>"Two"</FONT><FONT size=2>))</P>
<P>sortedList.Add(</FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> myItems(3, </FONT><FONT color=#a31515 size=2>"Three"</FONT><FONT size=2>))</P>
<P>sortedList.Add(</FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> myItems(4, </FONT><FONT color=#a31515 size=2>"Four"</FONT><FONT size=2>))</P>
<P>ComboBox1.DataSource = sortedList</P>
<P>ComboBox1.DisplayMember = </FONT><FONT color=#a31515 size=2>"Value"</P></FONT><FONT size=2>
<P>ComboBox1.ValueMember = </FONT><FONT color=#a31515 size=2>"Key"</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> _bo </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> MyBO = </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> MyBO()</P>
<P>MyBOBindingSource.DataSource = _bo</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> myItems</P>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> _key </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> _value </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</FONT><FONT size=2> Key() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Get</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> _key</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Get</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Set</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> value </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2>)</P>
<P>_key = value</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Set</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</FONT><FONT size=2> Value() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Get</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> _value</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Get</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Set</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> value </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>)</P>
<P>_value = value</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Set</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> key </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> value </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>)</P>
<P>_key = key</P>
<P>_value = value</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</P>
<P>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</P>
<P>&nbsp;</P>
<P>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> MyBO</P>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</FONT><FONT size=2> X() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> EnumClassLibrary.MyEnum</P>
<P></FONT><FONT color=#0000ff size=2>Get</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> _x</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Get</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Set</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> value </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> EnumClassLibrary.MyEnum)</P>
<P>_x = value</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Set</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> _x </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> EnumClassLibrary.MyEnum</P>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2>()</P>
<P>X = EnumClassLibrary.MyEnum.Four</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>smiley riley replied on Thursday, May 15, 2008</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>david.wendelken:</strong></div><div>
<P>I'm a bit confused.</P>
<P>Enums are a static construct, and building a list of values from the database is, by definition, a dynamic thing to do.&nbsp; So I'm concerned about keeping the list of values in the enum the same as the list of items in the database.&nbsp; It just feels like a design mismatch to me.</P>
<P>Why not&nbsp;load an NVList (from NameValueListBase) from the database and bind it to the combobox?&nbsp; That's what it's for! :)</P></div></BLOCKQUOTE>
<P>Enums are a great idea for static data (Closed sets of choices) that other tables/objects feed off. Drives me mad when I see applications with magic numbers.</P>
<P>GetAllOrdersByType(1);</P>
<P>What does it mean???</P>
<P>Much better to use</P>
<P>GetAllOrdersByType(OrderType.CeaseOrder);</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, July 12, 2007</h2>That's not quite true; enums are first class members.&nbsp; by default, using an enum will have the actual enum name display in the combobox, if you were to databind them.&nbsp; In other words, Red, White and Blue woudl be displayed, not 0, 1, or 2.<br><br>Also, not all enums are ints; you CAN create enums which inherit from short or long, as you need, although I think that's discouraged.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dshafer replied on Thursday, July 12, 2007</h2><P>Rick,</P>
<P>I have a similar setup to yours where I have&nbsp;a "lookup" table&nbsp;in the database&nbsp;with values to populate combo boxes.&nbsp; I also have corresponding enums with these "lookup" values.&nbsp; As far as I know, it is not possible to bind a combobox directly to an enum property.&nbsp; I'm assuming that&nbsp;your business object also stores the database id of the lookup item that was selected so that it can be persisted back to the database.&nbsp; What I do is bind the combobox to this lookup id property on the business object.&nbsp; Then in the get&nbsp;accessor of the&nbsp;enum property I call a static/shared helper method that "maps" the database id of the lookup item to the correct value in the enum.&nbsp; So your get accessor for the enum property on the business object would look something like this (c#):</P>
<P><BR>public&nbsp;MyEnum SomeColor <BR>{&nbsp;<BR>&nbsp;&nbsp;&nbsp;get&nbsp;<BR>&nbsp;&nbsp;&nbsp;{&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return EnumHelper.GetMyEnumValue(m_colorId);&nbsp;<BR>&nbsp;&nbsp;&nbsp;}&nbsp; <BR>}</P>
<P>The implementation is a little tedious, but it gets the job done.&nbsp; It's also much better than looking at code like this:</P>
<P>if (m_colorId == 1)&nbsp;&nbsp;&nbsp;&amp;&amp; 1 stands for Red</P>
<P>If anybody knows a better way, please let us know.</P>
<P>Dustin</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, July 12, 2007</h2><P>Why not wrap the enum in a NVL? In other words, create an object that inherits from NVLB, where the DataPortal_Fetch() method merely loads the list from the enum. You can enumerate the values in an enum (using reflection if nothing else).</P>
<P>Given an enum like</P>
<P>&nbsp; public enum MyEnum<BR>&nbsp; {<BR>&nbsp;&nbsp;&nbsp; Red,<BR>&nbsp;&nbsp;&nbsp; Blue,<BR>&nbsp;&nbsp;&nbsp; Green<BR>&nbsp; }<BR></P>
<P>You'd have a class like:</P>
<P>&nbsp; [Serializable]<BR>&nbsp; public class MyEnumList : Csla.NameValueListBase&lt;MyEnum,string&gt;<BR>&nbsp; {<BR>&nbsp;&nbsp;&nbsp; public static MyEnumList GetList()<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Csla.DataPortal.Fetch&lt;MyEnumList&gt;(new Criteria(typeof(MyEnumList)));<BR>&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;&nbsp;&nbsp; private MyEnumList()<BR>&nbsp;&nbsp;&nbsp; { /* require use of factory method */ }</P>
<P>&nbsp;&nbsp;&nbsp; [Csla.RunLocal]<BR>&nbsp;&nbsp;&nbsp; protected override void DataPortal_Fetch(object criteria)<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.IsReadOnly = false;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (MyEnum item in Enum.GetValues(typeof(MyEnum)))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add(new Csla.NameValueListBase&lt;MyEnum, string&gt;.NameValuePair(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; item, Enum.GetName(typeof(MyEnum), item)));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.IsReadOnly = true;<BR>&nbsp;&nbsp;&nbsp; }<BR>&nbsp; }<BR></P>
<P>Then you can bind it like you'd bind any other object/list to a combobox, as long as the object's property is of type MyEnum:</P>
<P>&nbsp;&nbsp;&nbsp; MyEnum _color;<BR>&nbsp;&nbsp;&nbsp; public MyEnum Color<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [System.Runtime.CompilerServices.MethodImpl(System.Runtime.CompilerServices.MethodImplOptions.NoInlining)]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CanReadProperty(true);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return _color;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [System.Runtime.CompilerServices.MethodImpl(System.Runtime.CompilerServices.MethodImplOptions.NoInlining)]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CanWriteProperty(true);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!_color.Equals(value))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _color = value;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }<BR></P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rd_bigdog replied on Thursday, July 12, 2007</h2><P><FONT color=#000000>Hey Rocky,</FONT></P>In summary, that code worked perfectly. After analyzing my problem set more after I got a sample project working with it, I added a few requirements to my list. I follow the pattern you posted. But, in my case, I have a 'master' enum which is an enum of all the available enums that we have. When I say enums in this context I am referring to different domain of lookup values. So, I have an enum of all lookup value types, and enums of each individual lookup. In total, dozens upon dozens of enums -- lots of entities managed in this system.<BR><BR>So, I wanted to make your code sample generic so that I only had one class to deliver my lookups to the UI, and not one class per lookup/enum. I managed to get this to work, it wasn't too tricky, I will post the code here as I think the pattern might help others.<BR><BR>I have custom combobox that is dedicated to showing the lookup values based on the enums. I gave it a property with the type of the "master' enum so that a consumer can pick the lookup domain to popluate the box with:<BR><BR>
<P></FONT><FONT color=#000000><FONT size=2>Protected</FONT><FONT size=2> </FONT><FONT size=2>Overrides</FONT><FONT size=2> </FONT><FONT size=2>Sub</FONT></FONT><FONT size=2><FONT color=#000000> OnCreateControl()</FONT></P>
<P></FONT><FONT color=#000000 size=2>MyBase</FONT><FONT size=2><FONT color=#000000>.OnCreateControl()</FONT></P>
<P></FONT><FONT color=#000000><FONT size=2>For</FONT><FONT size=2> </FONT><FONT size=2>Each</FONT><FONT size=2> bindings </FONT><FONT size=2>As</FONT><FONT size=2> System.Windows.Forms.Binding </FONT><FONT size=2>In</FONT></FONT><FONT size=2><FONT color=#000000> DataBindings</FONT></P>
<P><FONT color=#000000>bindings.DataSourceUpdateMode = DataSourceUpdateMode.OnPropertyChanged</FONT></P>
<P></FONT><FONT size=2><FONT color=#000000>Next</FONT></P></FONT><FONT size=2>
<P></FONT><FONT color=#000000><FONT size=2>If</FONT><FONT size=2> </FONT><FONT size=2>Not</FONT><FONT size=2> </FONT><FONT size=2>Me</FONT><FONT size=2>.DesignMode </FONT></FONT><FONT size=2><FONT color=#000000>Then</FONT></P>
<P><FONT color=#000000></FONT>&nbsp;</P></FONT><FONT size=2>
<P></FONT><FONT color=#000000 size=2>Me</FONT><FONT size=2><FONT color=#000000>.DataSource = AMSCSLA.ValueList.GetValueList(AMSDomain)</FONT></P>
<P></FONT><FONT color=#000000><FONT size=2>Me</FONT><FONT size=2>.DisplayMember = </FONT><FONT size=2>"Value"</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#000000><FONT size=2>Me</FONT><FONT size=2>.ValueMember = </FONT><FONT size=2>"Key"</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#000000><FONT size=2>End</FONT><FONT size=2> </FONT><FONT size=2>If</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#000000><FONT size=2>End</FONT><FONT size=2> </FONT><FONT size=2>Sub</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#000000><FONT size=2>Public</FONT><FONT size=2> </FONT><FONT size=2>Property</FONT><FONT size=2> AMSDomain() </FONT><FONT size=2>As</FONT></FONT><FONT size=2><FONT color=#000000> AMS.Framework.AMSDomains</FONT></P>
<P></FONT><FONT size=2><FONT color=#000000>Get</FONT></P></FONT><FONT size=2>
<P></FONT><FONT color=#000000 size=2>Return</FONT><FONT size=2><FONT color=#000000> _amsDomain</FONT></P>
<P></FONT><FONT color=#000000><FONT size=2>End</FONT><FONT size=2> </FONT><FONT size=2>Get</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#000000><FONT size=2>Set</FONT><FONT size=2>(</FONT><FONT size=2>ByVal</FONT><FONT size=2> value </FONT><FONT size=2>As</FONT></FONT><FONT size=2><FONT color=#000000> AMS.Framework.AMSDomains)</FONT></P>
<P><FONT color=#000000>_amsDomain = value</FONT></P>
<P></FONT><FONT color=#000000><FONT size=2>End</FONT><FONT size=2> </FONT><FONT size=2>Set</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#000000><FONT size=2>End</FONT><FONT size=2> </FONT><FONT size=2>Property</FONT></FONT></P>
<P><FONT color=#000000 size=2></FONT>&nbsp;</P>
<P><FONT color=#ff0000 size=2>In here, pass the master domain type to my NVL. In my NL I do this:</FONT></P>
<P><FONT size=2></FONT>&nbsp;</P><FONT size=2><FONT size=2>
<P><FONT color=#000000>Public</FONT></FONT><FONT color=#000000><FONT size=2> </FONT><FONT size=2>Shared</FONT><FONT size=2> </FONT><FONT size=2>Function</FONT><FONT size=2> GetValueList(</FONT><FONT size=2>ByVal</FONT><FONT size=2> domain </FONT><FONT size=2>As</FONT><FONT size=2> AMS.Framework.AMSDomains) </FONT><FONT size=2>As</FONT></FONT><FONT size=2><FONT color=#000000> ValueList</FONT></P>
<P></FONT><FONT color=#000000><FONT size=2>Return</FONT><FONT size=2> Csla.DataPortal.Fetch(</FONT><FONT size=2>Of</FONT><FONT size=2> ValueList)(</FONT><FONT size=2>New</FONT></FONT><FONT size=2><FONT color=#000000> DomainCriteria(domain))</FONT></P>
<P></FONT><FONT color=#000000><FONT size=2>End</FONT><FONT size=2> </FONT><FONT size=2>Function</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#000000><FONT size=2>Protected</FONT><FONT size=2> </FONT><FONT size=2>Overloads</FONT><FONT size=2> </FONT><FONT size=2>Sub</FONT><FONT size=2> DataPortal_Fetch(</FONT><FONT size=2>ByVal</FONT><FONT size=2> thecriteria </FONT><FONT size=2>As</FONT></FONT><FONT size=2><FONT color=#000000> DomainCriteria)</FONT></P>
<P></FONT><FONT color=#000000><FONT size=2>Me</FONT><FONT size=2>.IsReadOnly = </FONT><FONT size=2>False</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#000000><FONT size=2>Dim</FONT><FONT size=2> enumName </FONT><FONT size=2>As</FONT><FONT size=2> </FONT><FONT size=2>String</FONT><FONT size=2> = [Enum].GetName(</FONT><FONT size=2>GetType</FONT><FONT size=2>(AMSDomains), </FONT><FONT size=2>CType</FONT><FONT size=2>(thecriteria.Domain, </FONT><FONT size=2>Integer</FONT></FONT><FONT size=2><FONT color=#000000>))</FONT></P>
<P></FONT><FONT color=#000000><FONT size=2>Dim</FONT><FONT size=2> enumTypeHandle </FONT><FONT size=2>As</FONT><FONT size=2> System.Runtime.Remoting.ObjectHandle = System.Activator.CreateInstance(</FONT><FONT size=2>"AMS.Framework"</FONT><FONT size=2>, </FONT><FONT size=2>"AMS.Framework.AMSDomainValues."</FONT></FONT><FONT size=2><FONT color=#000000> &amp; enumName)</FONT></P>
<P></FONT><FONT color=#000000><FONT size=2>Dim</FONT><FONT size=2> enumType </FONT><FONT size=2>As</FONT><FONT size=2> [Enum] = </FONT><FONT size=2>CType</FONT></FONT><FONT size=2><FONT color=#000000>(enumTypeHandle.Unwrap(), [Enum])</FONT></P>
<P></FONT><FONT color=#000000><FONT size=2>For</FONT><FONT size=2> </FONT><FONT size=2>Each</FONT><FONT size=2> item </FONT><FONT size=2>As</FONT><FONT size=2> </FONT><FONT size=2>Object</FONT><FONT size=2> </FONT><FONT size=2>In</FONT></FONT><FONT size=2><FONT color=#000000> [Enum].GetValues(enumType.GetType)</FONT></P>
<P><FONT color=#000000>Add(</FONT></FONT><FONT color=#000000><FONT size=2>New</FONT><FONT size=2> Csla.NameValueListBase(</FONT><FONT size=2>Of</FONT><FONT size=2> [Enum], </FONT><FONT size=2>String</FONT></FONT><FONT size=2><FONT color=#000000>).NameValuePair( _</FONT></P>
<P><FONT color=#000000>item, [Enum].GetName(enumType.GetType, item)))</FONT></P>
<P></FONT><FONT size=2><FONT color=#000000>Next</FONT></P></FONT><FONT size=2>
<P></FONT><FONT color=#000000><FONT size=2>Me</FONT><FONT size=2>.IsReadOnly = </FONT><FONT size=2>True</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#000000><FONT size=2>End</FONT><FONT size=2> </FONT><FONT size=2>Sub</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#000000><FONT size=2>Protected</FONT><FONT size=2> </FONT><FONT size=2>Class</FONT></FONT><FONT size=2><FONT color=#000000> DomainCriteria</FONT></P>
<P></FONT><FONT color=#000000><FONT size=2>Public</FONT><FONT size=2> </FONT><FONT size=2>Property</FONT><FONT size=2> Domain() </FONT><FONT size=2>As</FONT></FONT><FONT size=2><FONT color=#000000> AMS.Framework.AMSDomains</FONT></P>
<P></FONT><FONT size=2><FONT color=#000000>Get</FONT></P></FONT><FONT size=2>
<P></FONT><FONT color=#000000 size=2>Return</FONT><FONT size=2><FONT color=#000000> _domain</FONT></P>
<P></FONT><FONT color=#000000><FONT size=2>End</FONT><FONT size=2> </FONT><FONT size=2>Get</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#000000><FONT size=2>Set</FONT><FONT size=2>(</FONT><FONT size=2>ByVal</FONT><FONT size=2> value </FONT><FONT size=2>As</FONT></FONT><FONT size=2><FONT color=#000000> AMS.Framework.AMSDomains)</FONT></P>
<P><FONT color=#000000>_domain = value</FONT></P>
<P></FONT><FONT color=#000000><FONT size=2>End</FONT><FONT size=2> </FONT><FONT size=2>Set</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#000000><FONT size=2>End</FONT><FONT size=2> </FONT><FONT size=2>Property</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#000000><FONT size=2>Private</FONT><FONT size=2> _domain </FONT><FONT size=2>As</FONT></FONT><FONT size=2><FONT color=#000000> AMS.Framework.AMSDomains</FONT></P>
<P></FONT><FONT color=#000000><FONT size=2>Public</FONT><FONT size=2> </FONT><FONT size=2>Sub</FONT><FONT size=2> </FONT><FONT size=2>New</FONT><FONT size=2>(</FONT><FONT size=2>ByVal</FONT><FONT size=2> domain </FONT><FONT size=2>As</FONT></FONT><FONT size=2><FONT color=#000000> AMS.Framework.AMSDomains)</FONT></P>
<P><FONT color=#000000>_domain = domain</FONT></P>
<P></FONT><FONT color=#000000><FONT size=2>End</FONT><FONT size=2> </FONT><FONT size=2>Sub</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#000000><FONT size=2>End</FONT><FONT size=2> </FONT></FONT><FONT size=2><FONT color=#000000>Class</FONT></FONT></P>
<P><FONT size=2><FONT color=#000000>End</FONT></FONT><FONT color=#000000><FONT size=2> </FONT><FONT size=2>Class</FONT></FONT></P>
<P><FONT color=#000000 size=2></FONT>&nbsp;</P>
<P><FONT color=#000000><FONT size=2>I use a little reflection to create an insance of the type of enum specified by the domain (this makes a requirment that the text of the master domain match the actual domain, but that will be managable). I will have left to do after this is add in a call to my lookup table to get the string text for the NVL in the users culture so the UI displays correctly and to sort the values by that text.</FONT></FONT></P>
<P><FONT color=#000000><FONT size=2></FONT></FONT>&nbsp;</P>
<P><FONT color=#000000><FONT size=2>Thanks very much for your post, you definitely got me down the right path.</FONT></FONT></P>
<P><FONT color=#000000><FONT size=2></FONT></FONT>&nbsp;</P>
<P><FONT color=#000000><FONT size=2>Regards,</FONT></FONT></P>
<P><FONT color=#000000><FONT size=2></FONT></FONT>&nbsp;</P>
<P><FONT color=#000000><FONT size=2>Rick.</P></FONT></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dshafer replied on Friday, July 13, 2007</h2><P>Wow.&nbsp; That's a pretty good idea.&nbsp; I'll have to try to modify my system to use something like this.&nbsp; It's quite a bit less tedious than what I'm currently using.</P>
<P>Dustin</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Dave Boal replied on Wednesday, April 02, 2008</h2><P><FONT face=Verdana size=1>Here's another suggestion:</FONT></P>
<P><FONT face=Verdana size=1>I created a class called <FONT color=#2b91af>EnumNVL</FONT> which creates a NameValueList from any Enum Type.</FONT></P>
<P><FONT face=Verdana size=1><STRONG>Sample Usage in form:</STRONG></FONT></P>
<P><FONT face=Verdana><FONT size=1><FONT color=#2b91af>EnumNVL</FONT> envlDateRangeTypes = <FONT color=#2b91af>EnumNVL</FONT>.GetEnumNVL(<FONT color=#0000ff>typeof</FONT>(<FONT color=#2b91af>DateRangeType</FONT>));<BR>// <FONT color=#2b91af>The parameter for the GetEnumNVL() method is any valid Enum, ie., GetEnumNVL(typeof(AnyValidEnum)). </FONT><BR></FONT></FONT><FONT face=Verdana size=1>// <FONT color=#2b91af>The substitutable parameter in this example uses the Enum type "DateRangeType".<BR></FONT></FONT><FONT face=Verdana size=1><BR>cbxDateRangeTypes.DataSource = envlDateRangeTypes<BR></FONT><FONT face=Verdana size=1>cbxDateRangeTypes.DisplayMember = <FONT color=#a31515>"Value"</FONT>;<BR></FONT><FONT face=Verdana size=1>cbxDateRangeTypes.ValueMember = <FONT color=#a31515>"Key"</FONT>;<BR></FONT><FONT face=Verdana size=1>cbxDateRangeTypes.SelectedIndex = 0;</FONT></P>
<P><FONT face=Verdana size=1><STRONG>Here's is the <FONT color=#2b91af>EnumNVL</FONT> class:</STRONG></FONT></P>
<P><FONT size=1><FONT face=Verdana>[</FONT><FONT face=Verdana color=#2b91af>Serializable</FONT><FONT face=Verdana>]<BR></FONT></FONT><FONT size=1><FONT face=Verdana><FONT color=#0000ff>public</FONT> <FONT color=#0000ff>class</FONT> <FONT color=#2b91af>EnumNVL</FONT> : Csla.<FONT color=#2b91af>NameValueListBase</FONT>&lt;<FONT color=#2b91af>Enum</FONT>, <FONT color=#0000ff>string</FONT></FONT><FONT face=Verdana>&gt;<BR></FONT></FONT><FONT face=Verdana size=1>{<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT size=1><FONT face=Verdana><FONT color=#0000ff>private</FONT> <FONT color=#0000ff>static</FONT> <FONT color=#2b91af>Type</FONT> _Type = <FONT color=#0000ff>null</FONT></FONT><FONT face=Verdana>;<BR>&nbsp;&nbsp;&nbsp;</FONT></FONT><FONT size=1><FONT face=Verdana><FONT color=#0000ff>public</FONT> <FONT color=#0000ff>static</FONT> <FONT color=#2b91af>EnumNVL</FONT> GetEnumNVL(<FONT color=#2b91af>Type</FONT></FONT><FONT face=Verdana> type)<BR>&nbsp;&nbsp;&nbsp;</FONT></FONT><FONT face=Verdana size=1>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT face=Verdana size=1>_Type = type;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=1><FONT face=Verdana><FONT color=#0000ff>return</FONT> Csla.<FONT color=#2b91af>DataPortal</FONT>.Fetch&lt;<FONT color=#2b91af>EnumNVL</FONT>&gt;(<FONT color=#0000ff>new</FONT> <FONT color=#2b91af>Criteria</FONT>(<FONT color=#0000ff>typeof</FONT>(<FONT color=#2b91af>EnumNVL</FONT></FONT><FONT face=Verdana>)));<BR></FONT></FONT><FONT size=1><FONT face=Verdana>&nbsp;&nbsp;&nbsp;}</P></FONT></FONT>
<P><FONT size=1><FONT face=Verdana color=#0000ff>&nbsp;&nbsp;&nbsp;private</FONT><FONT face=Verdana> EnumNVL()<BR>&nbsp;&nbsp;&nbsp;</FONT></FONT><FONT size=1><FONT face=Verdana>{ </FONT><FONT face=Verdana color=#008000>/* require use of factory method */</FONT><FONT face=Verdana> }</FONT></FONT></P>
<P><FONT size=1><FONT face=Verdana>&nbsp;&nbsp;&nbsp;[Csla.</FONT><FONT face=Verdana color=#2b91af>RunLocal</FONT><FONT face=Verdana>]<BR></FONT></FONT><FONT size=1><FONT face=Verdana><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;protected</FONT> <FONT color=#0000ff>override</FONT> <FONT color=#0000ff>void</FONT> DataPortal_Fetch(<FONT color=#0000ff>object</FONT></FONT><FONT face=Verdana> criteria)<BR></FONT></FONT><FONT face=Verdana size=1>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=1><FONT face=Verdana><FONT color=#0000ff>this</FONT>.IsReadOnly = <FONT color=#0000ff>false</FONT></FONT><FONT face=Verdana>;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT></FONT><FONT size=1><FONT face=Verdana><FONT color=#0000ff>foreach</FONT> (<FONT color=#2b91af>Enum</FONT> item <FONT color=#0000ff>in</FONT> <FONT color=#2b91af>Enum</FONT></FONT><FONT face=Verdana>.GetValues(_Type))<BR></FONT></FONT><FONT size=1><FONT face=Verdana>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Add(</FONT><FONT face=Verdana><FONT color=#0000ff>new</FONT> Csla.<FONT color=#2b91af>NameValueListBase</FONT>&lt;<FONT color=#2b91af>Enum</FONT>, <FONT color=#0000ff>string</FONT>&gt;.<FONT color=#2b91af>NameValuePair</FONT></FONT><FONT face=Verdana>(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT></FONT><FONT size=1><FONT face=Verdana>item, </FONT><FONT face=Verdana color=#2b91af>Enum</FONT><FONT face=Verdana>.GetName(_Type, item)));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT></FONT><FONT size=1><FONT face=Verdana><FONT color=#0000ff>this</FONT>.IsReadOnly = <FONT color=#0000ff>true</FONT></FONT><FONT face=Verdana>;<BR></FONT></FONT><FONT face=Verdana size=1>&nbsp;&nbsp;&nbsp;}<BR></FONT><FONT face=Verdana size=1>}</FONT></P>
<P><FONT face=Verdana size=1>-- Update:</FONT></P>
<P><FONT face=Verdana size=1>Cine's brilliant generic version below is a great modification. </FONT><FONT face=Verdana size=1>Here is an example of how I use his code:</FONT></P>
<DIV class=ForumPostContentText id=ctl00_ctl01_bcr_ctl00___PostRepeater_ctl10_PostViewWrapper>
<P><FONT face="Courier New" size=1>EnumNVL&lt;DateRangeType&gt; enumNVL = EnumNVL&lt;DateRangeType&gt;.GetEnumNVL();</FONT></P>
<P><FONT face="Courier New"><FONT size=1><FONT color=#008000><FONT color=#008000>// The KEY POINT is that with your more general code, I can cast the type to int as follows:<BR></FONT></FONT><FONT color=#0000ff><FONT color=#0000ff>int</FONT></FONT> dbColumnValue = (<FONT color=#0000ff><FONT color=#0000ff>int</FONT></FONT>)enumNVL[0].Key;</FONT></FONT></P>
<P><FONT face="Courier New" color=#008000 size=1>// I could not do that cast with my code!</FONT></P></DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Cine replied on Wednesday, April 02, 2008</h2>Even more general:<br><br><font face="Courier New" size="1">&nbsp;&nbsp; class Program<br>&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; static void Main(string[] args)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (NameValueListBase&lt;hest, string&gt;.NameValuePair s in HestNVL.GetEnumNVL())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.WriteLine(string.Format("{0} {1}", (int)s.Key, s.Value));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp; }<br>&nbsp;&nbsp; [Serializable]<br>&nbsp;&nbsp; public class EnumNVL&lt;T&gt; : NameValueListBase&lt;T, string&gt;<br>&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static EnumNVL&lt;T&gt; GetEnumNVL()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return DataPortal.Fetch&lt;EnumNVL&lt;T&gt;&gt;(new Criteria(typeof(T)));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected EnumNVL()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { /* require use of factory method */ }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [RunLocal]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected override void DataPortal_Fetch(object criteria)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Criteria c = (Criteria)criteria;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsReadOnly = false;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (T item in Enum.GetValues(c.ObjectType))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add(new NameValuePair(item, Enum.GetName(c.ObjectType, item)));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsReadOnly = true;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp; }<br>&nbsp;&nbsp; [Serializable]<br>&nbsp;&nbsp; public enum hest<br>&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; red,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; green<br>&nbsp;&nbsp; }<br>&nbsp;&nbsp; [Serializable]<br>&nbsp;&nbsp; public class HestNVL : EnumNVL&lt;hest&gt; { }</font><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, April 03, 2008</h2><P>Thanks!</P>
<P>Here it is in VB:</P><FONT size=2>
<P>&lt;Serializable()&gt; _<BR></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> EnumNVL<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Inherits</FONT><FONT size=2> NameValueListBase(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> [Enum], </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> mType </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Type = </FONT><FONT color=#0000ff size=2>Nothing</P>
<P>#Region</FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2>" Constructor "</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2>()<BR>&nbsp; </FONT><FONT color=#008000 size=2>&nbsp; 'require use of factory methods&nbsp;<BR></FONT><FONT color=#0000ff size=2>&nbsp; End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P>
<P>#End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P>
<P>#Region</FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2>" Factory Methods "</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetEnumNVL(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> type </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Type) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> EnumNVL<BR>&nbsp;&nbsp;&nbsp; mType = type<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> DataPortal.Fetch(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> EnumNVL)(</FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> Criteria(</FONT><FONT color=#0000ff size=2>GetType</FONT><FONT size=2>(EnumNVL)))<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P>
<P>#End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P>
<P>#Region</FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2>" Data Access "</P></FONT><FONT size=2>
<P>&nbsp; &lt;RunLocal()&gt; _<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> DataPortal_Fetch(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> criteria </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>)<BR>&nbsp;&nbsp;&nbsp; RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2>False<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>IsReadOnly = </FONT><FONT color=#0000ff size=2>False<BR><BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>For</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Each</FONT><FONT size=2> item </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> [Enum] </FONT><FONT color=#0000ff size=2>In</FONT><FONT size=2> [Enum].GetValues(mType)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add(</FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> NameValuePair(item, [Enum].GetName(mType, item)))<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Next</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp; IsReadOnly = </FONT><FONT color=#0000ff size=2>True<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2>True<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P>
<P>#End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT></P>
<P><FONT color=#0000ff size=2>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pillesoft replied on Friday, April 25, 2008</h2>Dear All,<br><br>these examples are really usefull for me also. i would like to share some extension. if you would like to localize enum valus here is a possible solution:<br>create an attribute class:<br>&nbsp; /// &lt;summary&gt;<br>&nbsp; /// Provides a description for an enumerated type.<br>&nbsp; /// &lt;/summary&gt;<br>&nbsp; [AttributeUsage(AttributeTargets.Enum | AttributeTargets.Field,<br>&nbsp;&nbsp; AllowMultiple = false)]<br>&nbsp; public sealed class EnumDescriptionAttribute : Attribute<br>&nbsp; {<br>&nbsp;&nbsp;&nbsp; private string description;<br><br>&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>&nbsp;&nbsp;&nbsp; /// Gets the description stored in this attribute.<br>&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br>&nbsp;&nbsp;&nbsp; /// &lt;value&gt;The description stored in the attribute.&lt;/value&gt;<br>&nbsp;&nbsp;&nbsp; public string Description<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return this.description;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>&nbsp;&nbsp;&nbsp; /// Initializes a new instance of the<br>&nbsp;&nbsp;&nbsp; /// &lt;see cref="EnumDescriptionAttribute"/&gt; class.<br>&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br>&nbsp;&nbsp;&nbsp; /// &lt;param name="description"&gt;The description to store in this attribute.<br>&nbsp;&nbsp;&nbsp; /// &lt;/param&gt;<br>&nbsp;&nbsp;&nbsp; public EnumDescriptionAttribute(string description)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : base()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.description = description;<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp; }<br><br>these attributes can be used :<br>&nbsp; [Serializable()]<br>&nbsp; public enum PUType<br>&nbsp; {<br>&nbsp;&nbsp;&nbsp; [EnumDescription("Installation")]<br>&nbsp;&nbsp;&nbsp; INSTALLATION = 1,<br>&nbsp;&nbsp;&nbsp; [EnumDescription("Material")]<br>&nbsp;&nbsp;&nbsp; MATERIAL = 2,<br>&nbsp;&nbsp;&nbsp; [EnumDescription("Optional")]<br>&nbsp;&nbsp;&nbsp; OPTIONAL = 3<br>&nbsp; }<br><br>and here is a method to extend EnumNVL&lt;T&gt; class:<br>&nbsp;&nbsp;&nbsp; private string GetDescription(object enumname)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (enumname == null)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw new ArgumentNullException("enumname");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string description = null;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldInfo fieldinfo = typeof(T).GetField(enumname.ToString());<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EnumDescriptionAttribute[] attributes =<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (EnumDescriptionAttribute[])<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fieldinfo.GetCustomAttributes(typeof(EnumDescriptionAttribute), false);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (attributes != null &amp;&amp; attributes.Length &gt; 0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; description = attributes[0].Description;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return description;<br>&nbsp;&nbsp;&nbsp; }<br><br>and of course modify the Add method:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add(new NameValuePair(item, GetDescription(item)));<br><br>hope this helps to someone, however i got the basic idea from codeproject.com<br>Ivan<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pillesoft replied on Friday, April 25, 2008</h2>some adjustment of GetDescription method:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (attributes != null &amp;&amp; attributes.Length &gt; 0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; description = attributes[0].Description;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; description = Enum.GetName(typeof(T), enumname);<br><br><br>Ivan</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pillesoft replied on Friday, April 25, 2008</h2>Dear All,<br><br>i need your help now:<br>one of my enums Description contains space:<br>&nbsp; [Serializable()]<br>&nbsp; public enum PUDimension<br>&nbsp; {<br>&nbsp;&nbsp;&nbsp; [EnumDescription("Quantity Only")]<br>&nbsp;&nbsp;&nbsp; QUANTITY = 0,<br>&nbsp;&nbsp;&nbsp; [EnumDescription("Length")]<br>&nbsp;&nbsp;&nbsp; LENGTH = 1,<br>&nbsp;&nbsp;&nbsp; [EnumDescription("Square Meter")]<br>&nbsp;&nbsp;&nbsp; SQUARE_METER = 2,<br>&nbsp;&nbsp;&nbsp; [EnumDescription("Cubic Meter")]<br>&nbsp;&nbsp;&nbsp; CUBIC_METER = 3<br>&nbsp; }<br><br>if this enum is bounded to a combobox, and when i select those where there is a space in the description i receive an error like:<br>Quantity Only is not valid value for PUDimension<br>when i select Length<br>the system accepts.<br><br>this is the combobox binding:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PmsEnumNVL&lt;PUDimension&gt; nvlpudimen = PUDimensionNVL.GetEnumNVL();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.dimensionComboBox.DataSource = nvlpudimen;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.dimensionComboBox.DisplayMember = "Value";<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.dimensionComboBox.ValueMember = "Key";<br><br>how to tell the system that SelectedItem.Key property needs to be used?<br><br>Ivan<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fintanv replied on Friday, April 25, 2008</h2>What about the simple solution of replacing the spaces with an underscore?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pillesoft replied on Sunday, April 27, 2008</h2>Dear All,<br><br>the first idea of this Description Attribute was to localize enum valus. it is important for me as i'm hungarian.<br>in the meantime, after reading some articles i've found a solution.<br>what i implemented is the typeconverter.<br>if you are interested in please check http://www.codeproject.com/KB/cs/LocalizingEnums.aspx<br><br>Ivan<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Shazam replied on Tuesday, October 21, 2008</h2>This class is totally unnecessary.&nbsp; There already is a Description attribute that does pretty well what this does.<br><br>Decorate your enum:<br><br>using System;<br>using System.ComponentModel;<br><br>[Serializable]<br>public enum SomeEnum<br>{<br>&nbsp;&nbsp;&nbsp; Active = 1,<br>&nbsp;&nbsp;&nbsp; [Description("Here's An Enum That Could Use Some Spaces")]<br>&nbsp;&nbsp;&nbsp; HeresAnEnumThatCouldUseSomeSpaces = 2,<br>&nbsp;&nbsp;&nbsp; Inactive = 9<br>}<br><br>I then have a Enum helper class:<br><br>using System;<br>using System.Collections;<br>using System.Collections.Generic;<br>using System.ComponentModel;<br>using System.Linq;<br><br>/// &lt;summary&gt;<br>/// An Enum helper class.<br>/// &lt;/summary&gt;<br>/// &lt;typeparam name="T"&gt;An enumeration.&lt;/typeparam&gt;<br>public static class Enum&lt;T&gt;<br>{<br>&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>&nbsp;&nbsp;&nbsp; /// Returns a Dictionary with the Enumeration as the Key, and the Description as the Value.<br>&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br>&nbsp;&nbsp;&nbsp; /// &lt;returns&gt;&lt;/returns&gt;<br>&nbsp;&nbsp;&nbsp; public static Dictionary&lt;T, string&gt; GetValues()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var values = new Dictionary&lt;T,string&gt;(Enum.GetNames(typeof(T)).Length);<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; foreach (T t in Enum.GetValues(typeof(T)))<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; values.Add(t, Description(t));<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return values;<br>&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; public static string Description(T value)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var da = (DescriptionAttribute[])(typeof(T).GetField(value.ToString()).GetCustomAttributes(typeof(DescriptionAttribute), false));<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return da.Length &gt; 0 ? da[0].Description : value.ToString();<br>&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; public static T FromDescription(string description)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; foreach (T t in Enum.GetValues(typeof(T)))<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (Description(t).Equals(description) || t.ToString().Equals(description))<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return t;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; throw new ArgumentOutOfRangeException(string.Format("The description \"{0}\" was not found in the enumeration.", description));<br>&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; public static T Parse(string value)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return (T)Enum.Parse(typeof(T), value);<br>&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; public static string ValueToString&lt;C&gt;(T value)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return Convert.ChangeType(value, typeof(C)).ToString();<br>&nbsp;&nbsp;&nbsp; }<br>}<br>Use the Enum&lt;T&gt;.GetValues() method for control binding.&nbsp; For dropdowns, use "Key" as the DataValueField and "Value" as the DataTextField.<br><br>I don't even bother with the NameValuePair collection if they're to represent enums.<br><br>Oh, and I take zero credit for this code.&nbsp; I found it somewhere on the interweb.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, October 21, 2008</h2>






 





<div class=Section1>

<p class=MsoNormal><span>That&#8217;s a good idea &#8211; using the Description
attribute.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>However, a Dictionary isn&#8217;t a valid data binding source,
so there&#8217;s probably still some value in having a list type that is
bindable that auto-populates based on the enum type. Perhaps a subclass of
NameValueListBase that wraps your code in its DataPortal_Fetch() method?<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>Rocky<o:p></o:p></span></p>

</div>



</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Shazam replied on Wednesday, October 22, 2008</h2>Hmm, Dictionary&lt;K, V&gt; does implement IEnumerable.&nbsp; Why isn't it valid? Is that a WPF or Winforms issue?&nbsp; It works fine with the &lt;csla:CslaDataSource&gt; tag.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, October 22, 2008</h2>






 





<div class=Section1>

<p class=MsoNormal><span>Web Forms has a very low set of requirements for its binding
sources. Windows Forms, WPF and Silverlight have richer functionality, and thus
have a higher set of requirements.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>Rocky</span><b><span><o:p></o:p></span></b></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

</div>



</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Shazam replied on Wednesday, October 22, 2008</h2>Tells you how much non-Webforms stuff I do :)<br><br>Certainly, it's easy enough to wrap the descriptive enum values into a NameValueListBase.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Patrick.Roeper replied on Tuesday, April 29, 2008</h2>@Cine &amp; Joe:<br><br>I implemented your generic version of the solution Rocky offered, and I am getting very strange behavior in my projects. Whenever I have an implementation of EnumNVL&lt;T&gt; in one of my business object libraries, I can no longer see that assembly in the "Configure Datasource" popup in order to hookup data binding... I havent changed any references or anything, the assembly just automagically becomes unlisted. <br><br>However, whenever I make an explicit implementation like Rocky showed, I can see the business object assembly in my "Configure Datasource" window and everything works as normal.<br><br>Can you think of a reason why the generic version would cause this problem?<br><br>----<br><br><span>Update:</span> I was able to get everything working by modifying the previously posted generic code. Here is the version that doesn't cause the behavior described above:<br><br>&nbsp;&nbsp; [Serializable]<br>&nbsp;&nbsp;&nbsp; public class EnumNVL&lt;T&gt; : NameValueListBase&lt;T, string&gt;<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private static EnumNVL&lt;T&gt; cache;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected EnumNVL()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Require factory method call from derived type<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static EnumNVL&lt;T&gt; GetList()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (cache == null)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cache = DataPortal.Fetch&lt;EnumNVL&lt;T&gt;&gt;(new Criteria(typeof(EnumNVL&lt;T&gt;)));<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return cache;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [RunLocal]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected override void DataPortal_Fetch(object criteria)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsReadOnly = false;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (T item in Enum.GetValues(typeof(T)))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add(new NameValuePair(item, Enum.GetName(typeof(T), item)));<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsReadOnly = true;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fintanv replied on Wednesday, April 30, 2008</h2>Can we get this added to the FAQ so it doesn't get burried over time?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>lprada replied on Thursday, July 12, 2007</h2>How do you bounf to the selecedvalue of the combo?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rd_bigdog replied on Thursday, July 12, 2007</h2><P>I am binding using the propeties window - Data - Data Bindings - SelectedValue and setting the SelectedValue to MyBOBindingSource.PropertyName.</P>
<P>So, from the SelectedValue property under data bindings, a data source has been created bound to my business object. I then use this binding source to bind to all the controls.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
