<html><header><title>How to convert a Business Base to a Read Only Base ?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How to convert a Business Base to a Read Only Base ?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11170.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dg78 posted on Friday, February 17, 2012</h2><p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Hello,</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">I have a Business&nbsp;Base object and I need to have the same in a Read Only Base but without to fetch data.</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">I have the two classes BB and ROB. I want to keep them but I need to convert a BB object to a ROB object.&nbsp;</span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">How to do that ?</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Thanks in advance</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Dominique</span></span></span></p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Friday, February 17, 2012</h2><p>Write a method in the read-only class something like this:</p>
<p style="padding-left:30px;">public static YourReadOnlyType CreateFromBB(YourEditableType obj)<br />{<br />&nbsp; this.Id = obj.Id;<br />&nbsp; this.Name = obj.Name;<br />&nbsp; // etc<br />}</p>
<p>Then you can easily get a read-only object based on the editable object without going to the server or database.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dg78 replied on Friday, February 17, 2012</h2><p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN" style="mso-ansi-language:EN;"><span style="font-size:small;"><span style="font-family:Calibri;">Thanks, Rocky, for your answer.</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN" style="mso-ansi-language:EN;"><span style="font-size:small;"><span style="font-family:Calibri;">Yes I could use inside your method all properties I have in the DataPortal_Fetch of the read-only class but there is a problem because it is not possible to refer instance member inside a shared method.</span></span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN" style="mso-ansi-language:EN;"><span style="font-size:small;"><span style="font-family:Calibri;">I did (sorry I use VB) :</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp; </span><span style="color:blue;">Public</span> <span style="color:blue;">Shared</span> <span style="color:blue;">Function</span> CreateFromBB(<span style="color:blue;">ByVal</span> pTravEntete <span style="color:blue;">As</span> TravEntete) <span style="color:blue;">As</span> TravEnteteInfo</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>_Id = pTravEntete.Id</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Return</span> <span style="color:blue;">Me</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp; </span><span style="color:blue;">End</span> <span style="color:blue;">Function</span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">With DataPortal, the factory method (static or shared method) call DataPortal.Fech that call code in Csla which create an instance object on which we work in DataPortal_Fetch. It is not the case with only a static method. So there is an error on _Id = pTravEntete.Id</span></span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dg78 replied on Saturday, February 18, 2012</h2><p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">It is OK if I use a Public constructor in the read-only&nbsp;class.</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp; </span><span style="color:blue;">Public</span> <span style="color:blue;">Sub</span> <span style="color:blue;">New</span>(<span style="color:blue;">ByVal</span> pTravEntete <span style="color:blue;">As</span> TravEntete)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>_Id = pTravEntete.Id</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>_DateTrav = pTravEntete.DateTrav</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;">&nbsp;&nbsp;&nbsp; ..</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp; </span><span style="color:blue;">End</span> <span style="color:blue;">Sub</span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 10pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><br /><span style="font-size:small;"><span style="font-family:Calibri;">Is it the good solution ?</span></span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Saturday, February 18, 2012</h2><p>That&#39;s the problem with using a browser as a code editor - no checking for validity :)</p>
<p>You don&#39;t need a public constructor, the private one is fine. Just use the Shared method like I suggested, but create the object:</p>
<p style="padding-left:30px;">Public Shared Function GetReadOnlyTrav(obj As TravEntete)<br />&nbsp; Dim result = new ReadOnlyTrav<br />&nbsp; result.Id = obj.Id<br />&nbsp; ...<br />End Function</p>
<p>This works because the shared method is inside the read-only class, so it has access to all the private members of the read-only class - including the private constructor and the private setters.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
