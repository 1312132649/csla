<html><header><title>Specilaising From a base object</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Specilaising From a base object</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4562.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>REA_ANDREW posted on Wednesday, March 26, 2008</h2><P><BR><FONT size=2 face=Tahoma>I have a base class called ContactInformation.&nbsp; I then inherit from this class in <STRONG>CustomerContactInformation</STRONG> as I wish to add <STRONG>2</STRONG> more fields to <STRONG>CustomerContactInformation</STRONG>.</FONT></P>
<P><FONT size=2 face=Tahoma>In the database I have a table called <STRONG>Person.Address</STRONG>, and another called <STRONG>Customer.Address</STRONG> .&nbsp; The difference being that all common address information is stored in the <STRONG>Person.Address</STRONG> table.&nbsp; Inside the <STRONG>Customer.Address</STRONG> table I have</FONT></P>
<P><FONT size=2 face=Tahoma><STRONG>CustomerID<BR>AddressID<BR>AddressTypeID</STRONG></FONT></P>
<P><FONT size=2 face=Tahoma>As there is a one to many relationship between customer and address.&nbsp; I am struggling on the business object design for this inside the CSLA framework.</FONT></P>
<P><FONT size=2 face=Tahoma>I create an abstract base class for the contact information<BR>I inherit from this class to make the <STRONG>CustomerContactInformation</STRONG>.</FONT></P>
<P><FONT size=2 face=Tahoma>With regards to the methods the base class defines, I do not want to hide them but rather declare new ones and run the base method.&nbsp; Is this the correct way to go about this?&nbsp; </FONT></P>
<P><FONT size=2 face=Tahoma>So in the <STRONG>CustomerContactInformation</STRONG>'s ExecuteFetch Block, I call <STRONG><FONT color=#ff0000>base.ExecuteFetch</FONT></STRONG>(connection,criteria)</FONT></P>
<P><FONT size=2 face=Tahoma>Is this a good way to do this, or is there a more tried and tested way of approaching this scenario?</FONT></P>
<P><FONT size=2 face=Tahoma>Cheers</FONT></P>
<P><FONT size=2 face=Tahoma>Andrew</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JohnB replied on Wednesday, March 26, 2008</h2>I'm assuming that both ContactInformation and CustomerContactInformation inherit from Csla? Typically with Csla you would not use inheritance between these two classes.<br><br>Per Rocky: "Using inheritance to "reuse" properties and fields is counter-productive."<br><br>Therefore, I would rethink about your objects from a single responsibility perspective.<br><br>Here are some links that may help.<br><br><a href="http://en.wikipedia.org/wiki/Single_responsibility_principle">Single Responsibility Principal</a><br><br><a HREF="/forums/thread/1658.aspx">http://forums.lhotka.net/forums/thread/1658.aspx</a><br><br>Hope this helps some,<br>John<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>REA_ANDREW replied on Wednesday, March 26, 2008</h2><P><FONT size=2 face=Tahoma>It really does help, thankyou.</FONT></P>
<P><FONT size=2 face=Tahoma>OK, so following on from that, can the database design can stay the same, and it is simply the business object design that should change.&nbsp; So by this I mean:</FONT></P>
<P><FONT size=2 face=Tahoma>I will do away with the base class for <STRONG>ContactInformation</STRONG> and simply import all fields and properties into the <STRONG>CustomerContactInformation</STRONG> class.</FONT></P>
<P><FONT size=2 face=Tahoma>In the <STRONG>DataAccess</STRONG> regions I will have to interact with two tables, via stored procedures.&nbsp; I cannot see a problem with this, but I would just like to confirm my thoughts with you.&nbsp; </FONT></P>
<P><FONT size=2 face=Tahoma>Cheers,</FONT></P>
<P><FONT size=2 face=Tahoma>Andrew</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SomeGuy replied on Wednesday, March 26, 2008</h2><P>You can also look at the ResourceAssignment(s) and ProjectResource(s) classes (and the underlying static Assignment class) in PTracker to get an idea of how to use Interfaces and composition to create your objects.</P>
<P>What you would end up with is a static Address class that can handle the data access to Person.Address. You can create an IAddress interface that defines the properties required also. You would implement IAddress in CustomerAddress or CustomerContactInformation. That class would then call the static Address class to save the Address info and then call a SP for the CustomerAddress info.</P>
<P>That would allow you to reuse the Address class and interface for an EmployeeAddress or Supplier<BR>Address classes. They would be just cut and paste copies of CustomerAddress for the most part.</P>
<P>E</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JohnB replied on Wednesday, March 26, 2008</h2>You're on the right path. Your database schema should not define how your objects look.<br><br>As far as the DataAccess, I don't see an issue with what you're doing.<br><br>John<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tmg4340 replied on Wednesday, March 26, 2008</h2><P><FONT face=Tahoma size=2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>REA_ANDREW:</strong></div><div></FONT><FONT face=Tahoma size=2>OK, so following on from that, can the database design can stay the same, and it is simply the business object design that should change.</FONT><FONT face=Tahoma size=2></div></BLOCKQUOTE></FONT></P>
<P><FONT face=Tahoma size=2>There is nothing wrong with the database design you have.&nbsp; However, there is one thing you might want to consider.</FONT></P>
<P><FONT face=Tahoma size=2>I've done designs similar to this in the past, and the one-to-many relationship between "Address" and "CustomerAddress" can be a real pain to manage.&nbsp; Let's start with a Customer whose billing and shipping addresses are the same, thus generating one "Address" record and two "CustomerAddress" records.&nbsp; What&nbsp;if they change one of them?&nbsp; What if they change both of them?&nbsp;&nbsp;What if they change&nbsp;one (or both)&nbsp;of them&nbsp;to another existing address in the database?&nbsp; And what if that existing address is associated with a different Customer?&nbsp; Similar questions arise when you have a Customer with different billing and shipping addresses that become the same.</FONT></P>
<P><FONT face=Tahoma size=2>If you intend to keep your "Address" table from having duplicate addresses in it - thus enforcing the "one" part of the relationship -&nbsp;the logic that you put into your stored procedure becomes a rather complex process.&nbsp; What the app considers a simple update could involve&nbsp;deleting, inserting, or updating existing data, and&nbsp;probably will include&nbsp;more than one of those operations.&nbsp; The check&nbsp;for existing Address data could be&nbsp;rather expensive as well,&nbsp;as you'll have to do a field-by-field check across the entirety of the address, which is a bunch of string comparisons that&nbsp;could include case sensitivity.&nbsp; The code required to make this system work reliably is non-trivial.&nbsp; </FONT><FONT face=Tahoma size=2>And you can't do a whole lot to help manage&nbsp;this complexity from within your app - pretty much all of it is going to end up in database code.</FONT></P>
<P><FONT face=Tahoma size=2>I'm not suggesting that you merge your two tables.&nbsp; Having a base "Address" table keeps the data in one place, which&nbsp;can be&nbsp;helpful if you have addresses&nbsp;in different parts of your application.&nbsp; But I am suggesting you consider letting your "Address" table hold multiple records that contain the same address.&nbsp; Under that scenario, while your database considers the relationship a one-to-many, in practice it becomes a one-to-one.</FONT></P>
<P><FONT face=Tahoma size=2>I realize that this has little to do with your CSLA class designs.&nbsp; And perhaps you already have all this worked out on your database.&nbsp; But if you don't, you might want to go back and take another look.</FONT></P>
<P><FONT face=Tahoma size=2>- Scott</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>REA_ANDREW replied on Wednesday, March 26, 2008</h2><P><FONT size=2 face=Tahoma>Hi Scot,</FONT></P>
<P><FONT size=2 face=Tahoma>Thanks for your help on this.</FONT></P>
<P><FONT size=2 face=Tahoma>Yes I do allow the possibility of duplicate addresses being input, I do not mind this.&nbsp; I have an AddressID field inside the table which is an uniqueidentifier, as this is used as a foreign key inside the CustomerContactInformation combined with an AddressType etc...</FONT></P>
<P><FONT size=2 face=Tahoma>Cheers</FONT></P>
<P><FONT size=2 face=Tahoma>Andrew</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dlambert replied on Wednesday, March 26, 2008</h2>It sounds like this is more about composition than inheritance, but I've used inheritance with great success to implement objects that are really similar to one another.<br><br>The client I'm working with is really particular about how their DB schemas are set up, and there's a standard they follow for lookup values that's sort of a pain to work with.&nbsp; First, each type of lookup value has to be in its own table rather than a master key-value table, and all lookup values tables have (in addition to key and value), a sequence number, a start (effective) date, an end (effective) date, a last-changed timestamp, and a last-changed user ID.<br><br>To make matters worse, I've seen these tables done with either strings or integers as IDs (keys), and these tables are sometimes extended to hold other values.&nbsp; Needless to say, there were potentially a lot of largely repeated code in order to handle some small variances.<br><br>So I built a base class for the value and another base class for the list, and I'm derivnig concrete classes for each type of lookup value, and it's handling this stuff really well.&nbsp; The value base class has a generic key type, and it handles all the standard fields, plus populating those fields from a datareader (sort of like ResourceInfo in the ProjectTracker app). <br><br>The list base class handles dataportal_fetch as you'd normally expect, with one difference.&nbsp; It uses a virtual method to get the SQL command name it's going to us to get the data reader, and this method is implemented in the concrete class.&nbsp; Ex:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected override string GetFetchCommand()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return "SelectMeetingPurposes";<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>For a "standard" reference / lookup table, this is all I have to implement to handle a new lookup type.&nbsp; When I need to extend the standard table, I add those properties in the concrete class, then override a method populate those fields, leaving the "standard" fields for the base class to populate:<br><br>I wouldn't recommend doing something like this for just a couple of classes, but in this case, this pattern is repeated many times, and it's really nice to have base functionality handled for me.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>REA_ANDREW replied on Wednesday, March 26, 2008</h2><P><FONT size=2 face=Tahoma><STRONG>dlambert</STRONG></FONT></P>
<P><FONT size=2 face=Tahoma>Thanks for your input on this, I appreciate it. :-)</FONT></P>
<P><FONT size=2 face=Tahoma>Andrew</FONT></P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
