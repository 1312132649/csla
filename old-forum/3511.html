<html><header><title>Categories and subcategories</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Categories and subcategories</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3511.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Tuesday, September 11, 2007</h2>Hi,<br><br>I'm doing an asp.net application now, its been a while.&nbsp; I have business objects, categories, which can contain subcategories as well.&nbsp; I'm trying to display these in an a simple unordered list.<br><br>I'm stumbling on how to get the subcategories displayed.&nbsp; I tried having a repeater contained in the ItemTemplate of the categories repeater, and setting its datasource, but nothing displayed.<br><br>Any ideas?&nbsp; Any other better controls for this?<br><br>Thanks<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Tuesday, September 11, 2007</h2><P>Andy,</P>
<P>I have used nested repeaters for a long time with CSLA and they work just fine.</P>
<P>Your idea is 100% correct - add the 2nd repeater in the Item Template of the first.</P>
<P>In rptr1_ItemDataBound you have to have code like this:</P>
<P><FONT color=#008000 size=2>'call this after all the values in the main repeater are set. <BR></FONT><FONT color=#008000 size=2>'ItemDataBound will then run for all the values in the nested repeater.<BR></FONT><FONT size=2>mFilteredList = GetDataSource(mKey)</FONT></P><FONT size=2><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> rptr2 </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Repeater = </FONT><FONT color=#0000ff size=2>CType</FONT><FONT size=2>(e.Item.FindControl(</FONT><FONT color=#ff00ff size=2>"rptr2"</FONT><FONT size=2>), Repeater)</FONT><BR>rptr2.DataSource = mFilteredList<BR>rptr2.DataBind()</P></FONT>
<P>Then you need a function like this:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetDataSource(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> key </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> ObjectListView<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> list </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> ObjectListView = Util.GetObjectListView(mColl, mSortExpression, mSortDirection)<BR>&nbsp; list.Filter = </FONT><FONT color=#ff00ff size=2>"key="</FONT><FONT size=2> &amp; </FONT><FONT color=#0000ff size=2>CStr</FONT><FONT size=2>(key)<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> list<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT>
<P>Note:<BR>The ObjectListView filtering is slower than Rocky's FilteredBindingList. It allows multi-property sorting and I want to use it for both sorting and filtering. But if you have large lists that get filtered often, you may want to use Rocky's instead.<BR><BR>I also handle rptr2_ItemDataBound and assign values to the controls. (I use a lot of hyperlinks and find it easier to handle in code.)<BR><BR>Something like this:<BR><BR><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> rptrData_ItemDataBound(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.Web.UI.WebControls.RepeaterItemEventArgs)</P>
<P></FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> e.Item.ItemType = ListItemType.Item </FONT><FONT color=#0000ff size=2>OrElse</FONT><FONT size=2> e.Item.ItemType = ListItemType.AlternatingItem </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> mIndex </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2> = e.Item.ItemIndex<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> mObjInColl </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> SomeType = </FONT><FONT color=#0000ff size=2>CType</FONT><FONT size=2>(mFilteredList.Item(mIndex).Object, SomeType)<BR></FONT><FONT size=2><BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> oHylNumber </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> HyperLink = </FONT><FONT color=#0000ff size=2>CType</FONT><FONT size=2>(e.Item.FindControl(</FONT><FONT color=#ff00ff size=2>"hylNumber"</FONT><FONT size=2>), HyperLink)</FONT><FONT size=2><BR><BR>&nbsp;oHylNumber.NavigateUrl = </FONT><FONT color=#ff00ff size=2>"Win('SomePage.aspx?keyvalue="</FONT><FONT size=2> &amp; mObjInColl.key &amp; </FONT><FONT color=#ff00ff size=2>"&amp;viewtype=1','MyScreen',600,500);"<BR><BR>&nbsp; </FONT><FONT size=2>oHylNumber.Text = mObjInColl.Number</FONT></P>
<P><FONT size=2>etc.</P>
<P></P></FONT>
<P>Joe</P>
<P><FONT size=2><FONT size=2></FONT><FONT size=2>&nbsp;</P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, September 11, 2007</h2>Ahh, that's it.&nbsp; I forgot the call to .DataBind.&nbsp; Opps...<br><br>I don't think I'll need the OLV though, everything is sorted by the business layer (no user sortable items here).<br><br>Thanks<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>NightOwl888 replied on Thursday, November 08, 2007</h2><P>Hi,</P>
<P>I am working with an older version of CSLA - version 1.51 (upgraded for .NET 2.0 to be exact).&nbsp; I haven't purchased the books on 2.0 or 3.0 yet. Unfortunately, I don't have the luxury&nbsp;of&nbsp;time right now to learn and upgrade.</P>
<P>I am trying to accomplish nested repeaters similar to this example. Actually, what I would like to do is have something that looks like this blog: <A href="http://chrisdodd.com/blog">http://chrisdodd.com/blog</A>. Specifically, I would&nbsp;like to have a repeated&nbsp;list&nbsp;(with paging) on the outside and on the bottom of each post display a list of categories it belongs to. The category list should be&nbsp;horizontal but wrap when it gets to the end of the available space.&nbsp;Given the fact that there are no ObjectListView or FilteredBindingList objects in my version of the framework, is something like&nbsp;this still possible with CSLA and&nbsp;ASP.NET? </P>
<P>I have been playing with this trying to get it working, but can't seem to find a solution.</P>
<P>By the way, the post - category relationship is many to many with a database table to resolve the relationship.</P>
<P>NightOwl888</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
