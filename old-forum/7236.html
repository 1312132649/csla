<html><header><title>LinqBindingList and ThenBy</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>LinqBindingList and ThenBy</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7236.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Woggly posted on Tuesday, July 07, 2009</h2>Hi!<br /><br />I am trying to do some sorting and filtering with the help of the LinqBindingList. This worked really fine until my boss noticed, that the new sorting (my sorting) does not exactly match the old way of sorting.<br />This is what I am doing:<br />LinqBindingList temp = this.EntitySetModel.Where(ex) as LinqBindingList;<br />                LinqBindingList sortedTempList = (temp.OrderBy(item.DBName) as LinqBindingList);<br />I am using DynamicLinq to pass in the Sortparameter when the user clicks on a column in a grid.<br />Now the problem:<br />The Transactions shown in the grid can have the same date in property Valuta. When you sort the grid ascending with this property the transactions do not have the right order. It seems as if the bindinglist uses the ID of the transaction as second parameter. This is ok, but it should sort the matching date transaction not ascending but descending.<br />So I tried to do this:<br />LinqBindingList temp = this.EntitySetModel.Where(ex) as LinqBindingList;<br />                LinqBindingList sortedTempList = (temp.OrderBy(item.DBName) as LinqBindingList).ThenByDescending(b => b.BuchungID) as LinqBindingList;<br />Although I am using ThenBy the transactions are sorted the same as before.<br /><br />Does anybaody have an idea how I can sort by date and then by Id in another direction? Or can anybody see if I am doing something wrong?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Tuesday, July 07, 2009</h2><P>It looks like your code is operating against 2 Lists. That could be an issue.</P>
<P>Try combining your linq code into a single statement.</P>
<P>myList.OrderBy("something).ThenByDescending("somethingelse")</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Woggly replied on Wednesday, July 08, 2009</h2>I changed the code to this:<br />LinqBindingList temp = (this.EntitySetModel.Where(ex).OrderBy(item.DBName) as LinqBindingList).ThenByDescending(b => b.BuchungID) as LinqBindingList;<br /><br />But it does not change anything it is still not sorted like I expect it to be. Is the Lambda-Expressen in ThenBy b=> b.BuchungID ok? </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, July 08, 2009</h2><P>That is still 2 different lists! </P>
<P>See where you are casting to LBL? That is one list. Then you are calling ThenBy on it which is the 2nd list.</P>
<P>It needs to be a single statement as I showed above.</P>
<P>Try it out using hard coded values to prove that it will work and then figure out the lamdas.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Woggly replied on Wednesday, July 08, 2009</h2>But When I am trying to do it without casting to LBL the compiler tells me, that ThenBy is not available!</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, July 08, 2009</h2><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Dim</FONT></FONT><FONT size=2> sortedList </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> Csla.LinqBindingList(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> SomeBO)</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Dim</FONT></FONT><FONT size=2> query </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> System.Linq.IOrderedQueryable(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> SomeBO) = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>From</FONT></FONT><FONT size=2> x </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>In</FONT></FONT><FONT size=2> mSomeCollection </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Order</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>By</FONT></FONT><FONT size=2> x.Column1 </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Ascending</FONT></FONT><FONT size=2>, x.Column2 </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Descending</P></FONT></FONT><FONT size=2>
<P>sortedList = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>CType</FONT></FONT><FONT size=2>(query, Csla.LinqBindingList(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> SomeBO))</FONT></P>
<P><FONT size=2>===================================================================================</FONT></P>
<P><FONT size=2>Try code like that shown above.<BR></FONT><FONT size=2>Joe</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Woggly replied on Thursday, July 09, 2009</h2>Thanks, this code sample helped me. <br />My List gets now sorted like I expected it.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
