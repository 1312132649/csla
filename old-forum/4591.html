<html><header><title>How do you properly &quot;bind&quot; a child collection to a grid on a form?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How do you properly &quot;bind&quot; a child collection to a grid on a form?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4591.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 posted on Monday, March 31, 2008</h2><P>What we have typically seen in designing forms is that a grid for a child collection on a form has its own binding source. So you have two binding sources, one for the parent object whose properties are bound to fields on the form, and then a separate binding source for the child. </P>
<P>We've been "manually" setting the datasource property of the child grid binding source when the parent object is passed in, which works on the surface, but this isn't a true binding per se.&nbsp;There are situations in which this isn't working right (if you save or cancel editing on the parent, for example, we aren't updating the child grid). </P>
<P>What is the "right" way to do this? </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ERodewald replied on Monday, March 31, 2008</h2>Can you provide more info?&nbsp; (Framework version, language((xaml?c#?), etc).&nbsp; The forms data provider can be bound to the entire collection, then individual controls can be bound to child objects.&nbsp; Or you can set the datacontext of a parent layout control to the child object.&nbsp; Depends on how you set up your child object.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Monday, March 31, 2008</h2><P>It's C#, Winforms, .NET 3.0 (although we just moved to this recently and haven't made many changes specific to 3.0). </P>
<P>Here is an example of where we are setting the data source for a form. The form shows a Task (the root object), and has fields bound to it. The Task BO has a child list of TaskItems, which I'm showing in a grid on the same form. </P>
<P>(Sorry about the formatting - not sure how to get code to look good here)</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>override</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> UpdateBindingSource(</FONT><FONT color=#2b91af size=2>BindingSource</FONT><FONT size=2> src) {</P>
<P></FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (src.Current </FONT><FONT color=#0000ff size=2>is</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>Task</FONT><FONT size=2>)</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.taskBindingSource.DataSource = src.Current;</P>
<P></FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.taskItemBindingSource.DataSource = ((</FONT><FONT color=#2b91af size=2>Task</FONT><FONT size=2>)src.Current).TaskItems;</P>
<P>}</P>
<P>}</P>
<P>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ERodewald replied on Tuesday, April 01, 2008</h2>I probably wouldn't be the most qualified to answer that, since I work in WPF rather than Winforms and I am sure there are hundreds here who work in winforms.&nbsp;GL :-)</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Wednesday, April 02, 2008</h2><P>OK, I have looked at an analogous situation in Project Tracker, which is the ResourceEdit form.&nbsp; The assignments at the bottom are the collection being shown in a grid.</P>
<P>The grid in ProjectTracker uses the same binding source as the form, with a data member being provided to tell it which Property implements the child collection. </P>
<P>Unfortunately, our BO objects currently implement ICustomTypeDescriptor, which means that I can't do this (at least not at design time) the same way. Once I have an actual BO instance at runtime, then&nbsp;I can set the "DataMember" field on the grid. </P>
<P>Otherwise (when the data source of the binding source is just the Type provided at design time)&nbsp;it tells you that it can't resolve the property name. This is some sort of bug or limitation in .NET with regards to objects that implement ICustomTypeDescriptor. </P>
<P>I can make it work by doing what ProjectTracker does at runtime, but it also works if I just set the data source of the child collection binding source directly using the child collection property. Any reason I shouldn't do this?</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
