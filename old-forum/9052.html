<html><header><title>CSLA.NET 4 and MVVM and edit level</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA.NET 4 and MVVM and edit level</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9052.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Chris posted on Monday, June 07, 2010</h2><p>I have been working with the latest CSLA.NET 4 (svn repository)&nbsp;and Rocky&#39;s lightweight MVVM&nbsp;framework.&nbsp; I have run into an issue that seems odd to me.&nbsp; Everything (i.e. save, cancel, etc.) works well if I have an editable root and one viewmodel (Rocky&#39;s ViewModel).&nbsp; </p>
<p>However, let&#39;s say I have an editable root with an editable child (e.g. Invoice, InvoiceItem).&nbsp; My view has two user controls.&nbsp; One user control is assoicated with&nbsp;the edtiable root and has a viewmodel.&nbsp; Another user control is associated with the editable child and also has a viewmodel.&nbsp;&nbsp;Something weird happens to the edit level on the editable child.&nbsp; It seems that the edit level is incremented for each viewmodel I have.&nbsp; Thus, the editable child&#39;s edit level=2 before &quot;anything&quot; is done to it whereas the edit level of the root is 1.&nbsp; This causes problems because I can&#39;t save or cancel the child object.&nbsp; Instead, if I only have one viewmodel supporting both user controls, everything works well and the edit level = 1.&nbsp; </p>
<p>This isn&#39;t a big problem because I can work around it by having one view model support all user controls in the view.&nbsp; However, my actual editable root has many child collections and child objects and the viewmodel is rapidly becoming very complex.</p>
<p>I would like to know if it is by design that every viewmodel increments the editlevel by one.&nbsp; Is there a way to prevent the edit level from being incremented?&nbsp; What is the best practice of how many view models to have per user control (view)?&nbsp; I have been over the code and I don&#39;t think it is user error :-).&nbsp; In my debugging efforts I have been able to detect that when the object leaves the dataportal the edit level is zero.&nbsp; But, when it&nbsp;is loaded in&nbsp;the view model&nbsp;(i.e. Refresh) the edit level&nbsp;is incremented.</p>
<p>Any&nbsp;insight&nbsp;would be greatly appreciated.&nbsp; Best regards,</p>
<p>Chris</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Tuesday, June 08, 2010</h2><p>ViewModelBase defaults to ManageObjectLifeTime=&quot;true&quot;. For a child viewmodel you probably want that to be false, which will prevent the viewmodel from automatically incrementing the child edit level.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Chris replied on Tuesday, June 08, 2010</h2><p>Bless you! That is good to know :-) ... I really did want to be able to split out my viewmodels.&nbsp; I really do appreciate your response!</p>
<p>Best regards,</p>
<p>Chris</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>HK.Lee replied on Wednesday, June 09, 2010</h2><p>Hi All,</p>
<p>This is the answer of my question <a href="http://forums.lhotka.net/forums/p/8972/42680.aspx#42680">http://forums.lhotka.net/forums/p/8972/42680.aspx#42680</a> in separate viewmodel and&nbsp; why I didn&#39;t find&nbsp; problem after changing 1 viewmodel.&nbsp;&nbsp;I appreciate both of you.</p>
<p>Chris,</p>
<p>When I bind CRUD button with child viewmodel&#39;s Can_ properties and click addnew button, then&nbsp;addnew button should be disabled&nbsp;state because added child is invalid at first&nbsp;,but it isn&#39;t. CanAddnew tells&nbsp;false but button&#39;s disability not changed. Have you encountered this problem ?&nbsp; Pls read my question in above link. Because of this problem and simplicity as I did in SCSF, I am sticking to 1 viewmodel as far as&nbsp;one view model is enough even in parent-child senario. &nbsp;With 1 viewmodel, I added Can_ poperties same with ViewModelBase but for childviewmodel and can control button&#39;s enability via&nbsp;ChildChanged event. If you have more elegant way or I miss something pls advise me.&nbsp; Thank you in advance.</p>
<p>HK.Lee</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
