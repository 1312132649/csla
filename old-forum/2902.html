<html><header><title>Aggregate Validations</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Aggregate Validations</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2902.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ifergus posted on Friday, May 18, 2007</h2><P class=MsoBodyText>What’s the best way to implement a validation rule when it involves an aggregation of multiple child objects?<SPAN>&nbsp; </SPAN>For example, if I have a rule that states for a given order the total cost amount of the order items cannot exceed $5000, how would I do it?</P>
<P class=MsoBodyText>In my implementation I have three classes as follows:</P>
<P class=MsoBodyText><o:p>&nbsp;</o:p></P>
<P class=MsoBodyText>Order <SPAN><SPAN>à</SPAN></SPAN> OrderDetailCollection <SPAN><SPAN>à</SPAN></SPAN> OrderDetail</P>
<P class=MsoBodyText><o:p>&nbsp;</o:p></P>
<P class=MsoBodyText>In the book (on page 454), I see that there is a similar example that considers all siblings in order to ensure that a particular Id is not reused.<SPAN>&nbsp; </SPAN>However, it does not fit this need because the validation is not performed on the aggregate of the siblings. I'm using 2.1</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, May 18, 2007</h2><P>Typically you'd have your root object handle the ListChanged event of the child list. When an item changes in the child list, this event handler is notified and calls just one line of code:</P>
<P>ValidationRules.CheckRules("OrderTotal")</P>
<P>(assuming, of course, that OrderTotal is the name of the property you are using to display the total amount of the order)</P>
<P>Then all you need to do is write a rule method to ensure that the total amount doesn't exeed the maximum and connect that rule method to the OrderTotal property in AddBusinessRules().</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
