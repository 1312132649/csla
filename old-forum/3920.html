<html><header><title>Set Focus to Data Bound Control w/ BrokenRule</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Set Focus to Data Bound Control w/ BrokenRule</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3920.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>honus posted on Tuesday, November 20, 2007</h2><P><FONT face=Arial size=2>I&nbsp;am doing some custom validation using the BrokenRulesCollection on a WinForm, and simply put, if there are any broken rules in the collection, I want to alert the user regarding the first broken rule in the collection, and then set the form focus to the correlating control.</FONT></P>
<P><FONT face=Arial size=2>Here is what I have so far:</FONT></P>
<P><FONT face=Arial size=2>If mObject.BrokenRulesCollection.Count &gt; 0 Then<BR>&nbsp;&nbsp;&nbsp;Dim tmpRule As Validation.BrokenRule = mObject.BrokenRulesCollection(0)<BR>&nbsp;&nbsp;&nbsp;MessageBox.Show(tmpRule.Description &amp; "!", "Data Entry Error")</FONT></P>
<P><FONT face=Arial size=2>&nbsp;&nbsp;&nbsp;'this is where I need help in setting focus to the data-bound control<BR>End If</FONT></P>
<P><FONT face=Arial size=2>I am guessing that I can do something with BrokenRule.Property in conjunction with the BindingSource, but I am yet to figure this out.&nbsp; I have thought about looping through all of the controls and doing something with the DataBindings collection, but there is some pretty intense nesting going on (textboxes within panels within tabcontrols), so I have tried to avoid this, as I am sure there is a more simple way.&nbsp; Any help is appreciated.</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>honus replied on Tuesday, November 20, 2007</h2><P><FONT face=Arial size=2>Here is what I came up with.&nbsp; Let me know if you have something better/more efficient.</FONT></P>
<P><FONT face=Arial size=2>If mObject.BrokenRulesCollection.Count &gt; 0 Then<BR>&nbsp;&nbsp;&nbsp;Dim tmpRule As Validation.BrokenRule = mObject.BrokenRulesCollection(0)<BR>&nbsp;&nbsp;&nbsp;MessageBox.Show(tmpRule.Description &amp; "!", "Data Entry Error")</FONT></P>
<P><FONT face=Arial size=2>&nbsp;&nbsp;&nbsp;setFieldFocus(Me, tmpRule.Property)<BR>End If</FONT></P>
<P><FONT size=2><FONT color=#000000><FONT face=Arial>Private Sub setFieldFocus(ByVal parentContainer As Control, ByVal propName As String</FONT></FONT><FONT face=Arial color=#000000>)<BR>&nbsp;&nbsp;&nbsp;</FONT></FONT><FONT size=2><FONT color=#000000><FONT face=Arial>For Each tmpControl As Control In</FONT></FONT><FONT face=Arial color=#000000> parentContainer.Controls<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'allow for some recursion in case of nested child&nbsp;controls</FONT></FONT><FONT size=2><FONT face=Arial color=#000000><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT></FONT><FONT size=2><FONT color=#000000><FONT face=Arial>If tmpControl.Controls.Count &gt; 0 Then</FONT></FONT><FONT face=Arial color=#000000> setFieldFocus(tmpControl, propName)</FONT></FONT></P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT size=2><FONT color=#000000><FONT face=Arial>For Each tmpBinding As Binding In</FONT></FONT><FONT face=Arial color=#000000> tmpControl.DataBindings<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT></FONT><FONT color=#000000><FONT face=Arial><FONT size=2>If tmpBinding.BindingMemberInfo.BindingField.Equals(propName) Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT></FONT></FONT><FONT face=Arial color=#000000 size=2>tmpBinding.Control.Focus()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#000000><FONT face=Arial><FONT size=2>Exit Sub<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT></FONT></FONT><FONT color=#000000><FONT face=Arial><FONT size=2>End If<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT></FONT></FONT><FONT face=Arial color=#000000 size=2>Next<BR></FONT><FONT face=Arial color=#000000 size=2>&nbsp;&nbsp;&nbsp;Next<BR></FONT><FONT color=#000000><FONT face=Arial><FONT size=2>End Sub</FONT></P></FONT></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
