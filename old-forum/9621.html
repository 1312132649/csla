<html><header><title>Sharing business objects between processes</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Sharing business objects between processes</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9621.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael posted on Sunday, October 10, 2010</h2><p>Our application has a main WinForms UI, and an AutoCAD extension UI which is hosted by acad.exe. There is also a second, separate AutoCAD extension which uses some of the business objects, UI components and the csla.dll instance of the primary application.<br /><br />We want to</p>
<ul>
<li>refresh all UI&#39;s automatically after a BO is saved; and</li>
<li>cache BO&#39;s so they are not loaded separately by each UI or AutoCAD instance, which is important when working over a VPN, or when AutoCAD crashes (it does a lot).</li>
</ul>
<p>We&#39;re using a local data portal. I&#39;ve looked at chapter 15 which talks about the WcfProxy, and 21: WCF Service Interface. This is a pretty basic <i>cross-component </i>communication requirement, so any suggestions?<br /><br />Thanks in advance.<br />Michael</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Monday, October 11, 2010</h2><p>In my view, cross-application communication should follow an SOA model. Which means you define message contracts and send messages back and forth between the applications.</p>
<p>That means no &quot;sharing of objects&quot; as such, though you can certainly pass object data back and forth through the messages - just not objects in the way the data portal does.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael replied on Monday, October 11, 2010</h2><p>What if it&#39;s the same, trusted application, just a different UI, as the case is with our AutoCAD extension?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, October 11, 2010</h2><p>It is probably fine then, as long as you remember that CSLA isn&#39;t threadsafe. So both &quot;parts&quot; of the app need to be on the same thread, and realistically the same AppDomain.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael replied on Monday, October 11, 2010</h2><p>Which technology/approach would you take to solve the problem of serving/caching the business objects to the two UIs?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, October 11, 2010</h2><p>Pat Helland gave a talk some years ago where he described four types of data:</p>
<ol>
<li>Resource</li>
<li>Reference</li>
<li>Request/Response</li>
<li>Activity</li>
</ol>
<p>Resource data is mutable - read/write data that is stored in your database.</p>
<p>Reference data is immutable - read-only data that is versioned, so if you edit it you create a new version and the old version is still there (like a newspaper - you can always get yesterday&#39;s paper, even years from now - and it is unchanged).</p>
<p>Request/Response data is transitory - it is read-only and exists for short periods of time while in transit.</p>
<p>Activity data is mutable, but isn&#39;t typically stored. Think of this like the fields of your objects in memory.</p>
<p>Of all these, the only type of data you can safely cache is Reference data. In all other cases you run the risk of stale data.</p>
<p>I suspect you want to cache Resource data (though technically if it is in memory it is Activity data - but still...) That&#39;s the hardest to cache, because it is the most likely to become stale in any multi-user scenario.</p>
<p>In any case, remember that CSLA objects are (typically) retrieved using a factory method. Most factory methods are one line of code: the data portal call. But there&#39;s nothing that says they can&#39;t be more complex, possibly managing a list of retrieved objects that are held in memory and returned out of that list rather than using the data portal.</p>
<p>If you want to be fancier, you could create your own client-side CachedProxy for the data portal. This proxy would cache objects (maybe based on some custom attribute you define) and return the objects from the cache, or invoke WcfProxy (or whatever) if the object isn&#39;t in the cache.</p>
<p>Either way you&#39;ll have to deal with stale data.</p>
<p>And either way you&#39;ll have to deal with potential memory leaks. Holding a business object in memory can be problematic if you also use data binding. When a window/form/page/usercontrol sets up a handler for PropertyChanged, that actually creates a reference from the object to the UI element. If the object never goes away, that event is probably never unhooked, so that reference probably never goes away, so the UI element is forever stuck in memory.</p>
<p>How you solve that is not something I&#39;ve taken the time to figure out, but I suspect it isn&#39;t easy :(</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>chrduf replied on Tuesday, October 12, 2010</h2><p>You can use a distributed cache to acomplish this. Check out Windows Server AppFabric <a href="http://msdn.microsoft.com/en-us/windowsserver/ee695849.aspx">http://msdn.microsoft.com/en-us/windowsserver/ee695849.aspx</a></p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
