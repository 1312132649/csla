<html><header><title>Validation rules and ErrorProvider</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Validation rules and ErrorProvider</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5525.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dg78 posted on Friday, October 03, 2008</h2><P class=MsoNormal><SPAN>Hi,<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Three questions about validation rules and ErrorProvider :<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>1) In a<SPAN>&nbsp; </SPAN>winform, when validation rules are not true, the ErrorProvider appear. I wish to replace it&nbsp;by a MessageBox.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>Also I wish, in the UI, the user can't to go to another control until the validation rules are not good on the control (textbox for instance) where the focus is.</SPAN></P>
<P class=MsoNormal><SPAN>How to do this ?<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>2) Since .net 1.0, there is errors on ErrorProvider : if you put the mouse on the small red icon then the message appear but if you click on this icon or if the mouse stay too long time on it, the message disappears. After that, it is not possible this message appear again. Also sometimes the message appears twice.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>I hope that will be good in .net 3.5 but it is not. Is there a solution to this problem ?<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>3) often when we do a <SPAN>Validation.CommonRules.StringMaxLength, the value we use is the length of a field in the database. Is it possible to use these value automaticaly (or automagicaly ;)) ?<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Thanks in advances<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Dominique</SPAN><SPAN><o:p></o:p></SPAN></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dg78 replied on Friday, October 03, 2008</h2><P class=MsoNormal><SPAN>I answer to my question number 2 :<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>If you do a search on Google ("errorprovider message disappear"), you find many sites which speak about this issue.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>There is a solution at <SPAN>&nbsp;</SPAN><A href="http://www.codeproject.com/KB/dotnet/ErrorProvider_ToolTipFix.aspx"><FONT color=#800080>http://www.codeproject.com/KB/dotnet/ErrorProvider_ToolTipFix.aspx</FONT></A> <o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>I tried it. It is good but, as his author said, it causes a slight flicker.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>It is an old issue and Microsoft never solved it. They closed this issue and said "not important problem". It is not normal. <SPAN>&nbsp;</SPAN>(see <A href="https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=188945&amp;wa=wsignin1.0"><FONT color=#800080>https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=188945&amp;wa=wsignin1.0</FONT></A> ).<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>Without a fixed, the ErrorProvider is not useful. I can't explain to my users why the message appears once. </SPAN></P>
<P class=MsoNormal><SPAN></SPAN>&nbsp;</P>
<P class=MsoNormal><SPAN><o:p></o:p></SPAN>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Friday, October 03, 2008</h2><P>It's pretty easy to use the length of the database field as long as you have a mechanism to retrieve the field length. You would implement your own validation rule though.</P>
<P>I just basically copied the CSLA implementation and called my common routine to fetch the length of the field as opposed to using a value from RuleArg. (You probably want to cache the field lengths somewhere to avoid repeated database accesses). </P>
<P>I can post a sample if this isn't clear. </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dg78 replied on Saturday, October 04, 2008</h2><P>Thanks for your answer.</P>
<P>It is true that I want to cache the field lengths somewhere because there is not a binding between the database and the BO (the binding is between BO and the controls).</P>
<P>If you can post a sample it would be wonderful (allways I believe that a small code is better than many words).</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Saturday, October 04, 2008</h2><P>Here is the sample. It references some things not define here (I'm usign the Wilson ORMapper as a DAL and it provides an IObjectHelper interface for referencing the values of backing fields directly). It would be easy to change this to reflect directly on the property value and use the MaxLengthRuleArgs directly. </P>
<P>namespace Csla.WORMapper.Validation<BR>{<BR>&nbsp;&nbsp;&nbsp; public class CommonRules<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; internal class CustomFieldMaxLengthRuleArgs : Csla.Validation.CommonRules.MaxLengthRuleArgs<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public CustomFieldMaxLengthRuleArgs(string propertyName, string fieldName, int nMaxLength)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : base(propertyName, nMaxLength)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this["FieldName"] = fieldName;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; internal static bool CustomFieldMaxLength(object target, Csla.Validation.RuleArgs e)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DecoratedRuleArgs args = (DecoratedRuleArgs)e;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int max = (int)args["MaxLength"];<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string value = ((Wilson.ORMapper.IObjectHelper)target)[(string)args["FieldName"]] as string;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!String.IsNullOrEmpty(value) &amp;&amp; (value.Length &gt; max))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.Description = String.Format("Field {0} exceeds maximum allowed length of {1} characters",<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RuleArgs.GetPropertyName(e), max);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }<BR>}<BR></P>
<P>Here is the code that actually adds the rule definitions in my object's AddBusinessRules. As you can see, sometimes I have to use the special rule above, and sometimes I can just use the built-in CSLA rule. You might be able to just use the CSLA rule and skip the above:</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Add rules for all string columns for maximum length, and whether required (e.g. not nullable)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (DataColumnInfo info in ColumnInfoCollection.Columns)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (info.IsString)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Add rules for all non-nullable string fields<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!info.Nullable)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ValidationRules.AddRule&lt;T&gt;(CommonRules.StringRequired, info.MappedPropertyName);</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // CSLA doesn't currently support dynamic properties, so use special rule if property can't be found<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyInfo p = GetType().GetProperty(info.MappedPropertyName);</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (p == null)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Must use internal field<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ValidationRules.AddRule(Validation.CommonRules.CustomFieldMaxLength,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new Validation.CommonRules.CustomFieldMaxLengthRuleArgs(info.MappedPropertyName, info.MappedFieldName, info.ColumnSize));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ValidationRules.AddRule(Csla.Validation.CommonRules.StringMaxLength,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new Csla.Validation.CommonRules.MaxLengthRuleArgs(info.MappedPropertyName, info.ColumnSize));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dg78 replied on Monday, October 06, 2008</h2><P class=MsoNormal><SPAN>Thanks for your sample.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>I think your code is possible only because you use an ORM, it is to said a relation between the properties in the BO and the fields of the database. <o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>Without this relation, the properties of the BO can't know the length of the fields in the database unless to pass them in attributes of the properties or other things.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Now, my first question in this thread, always without answer :<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>1) In a&nbsp; winform, when validation rules are not true, the ErrorProvider appear. I wish to replace it&nbsp;by a MessageBox.<O:P></O:P> Also I wish, in the UI, the user can't to go to another control until the validation rules are not good on the control (textbox for instance) where the focus is.<BR>How to do this ?</SPAN></P>
<P class=MsoNormal><SPAN><O:P></O:P><o:p></o:p></SPAN>&nbsp;</P>
<P class=MsoNormal><SPAN>In another words : I want to use for some controls (TextBox) an ErrorProvider and for anothers controls a MessageBox and keep the focus on the control where the rule is broken (with the ErrorProvider the focus go on the following control).<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>To use a MessagBox, I can do <SPAN>&nbsp;</SPAN>e.description="" <SPAN>&nbsp;&nbsp;</SPAN>to not have an ErrorProvider icon but how to use a MessageBox and<SPAN>&nbsp; </SPAN>sender.focus<SPAN>&nbsp; </SPAN>when the ErrorProvider is managed in the business class and there is a binding between the business class and the controls in the form.</SPAN></P>
<P class=MsoNormal><SPAN></SPAN>&nbsp;</P>
<P class=MsoNormal><SPAN>Thanks for help. <o:p></o:p></SPAN></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Tuesday, October 07, 2008</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>dg78:</strong></div><div> 
<P class=MsoNormal><SPAN>Thanks for your sample.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>I think your code is possible only because you use an ORM, it is to said a relation between the properties in the BO and the fields of the database. <o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>Without this relation, the properties of the BO can't know the length of the fields in the database unless to pass them in attributes of the properties or other things.</SPAN></div></BLOCKQUOTE></P>
<P class=MsoNormal>&nbsp;</P>
<P class=MsoNormal>Actually, the ORM makes it a little simpler, but it's not all that difficult. I&nbsp;but I'm basically just using an IDataReader when you get right down to it. This code queries a single column, but you can also do the entire table:</P>
<P class=MsoNormal>&nbsp;</P>
<P class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static Util.DataColumnInfo GetDataColumnInfo(TransactionContext context, string tableName, string columnName)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Wilson.ORMapper.Internals.Connection connection = context.ObjectSpace.Context.Connection;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataTable schema;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string strSQL = "SELECT " + columnName +&nbsp; " FROM " + tableName;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Util.DataColumnInfo info = null;</P>
<P class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using (IDataReader reader = connection.GetSchemaReader(Global.GetEntityType(tableName), strSQL))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; schema = reader.GetSchemaTable();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</P>
<P class=MsoNormal><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (schema.Rows.Count == 1)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; info = Util.DataColumnInfoCollection.GetColumnInfo(new Util.Schema.GetSchemaTableProvider(), schema.Rows[0]);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (System.Exception)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return info;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR></P>
<P class=MsoNormal>As far as your ErrorProvider question goes, all you really need to do is (1) don't use an error provider, and (2) Use the ToString() method on your object's BrokenRulesCollection to display the error to the user using the method of your choice (MessageBox, etc.)</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
