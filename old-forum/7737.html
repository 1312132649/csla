<html><header><title>NVL Combobox when revisiting doesn't show error icon</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>NVL Combobox when revisiting doesn't show error icon</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7737.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>tiago posted on Tuesday, October 06, 2009</h2><P><FONT face=Arial>I have a NVL combobox that is setup like this:</FONT></P><FONT face=Arial><FONT size=2>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT><FONT size=2>.docTypeNVLComboBox.DataBindings.Add(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> System.Windows.Forms.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Binding</FONT></FONT><FONT size=2>(</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"SelectedValue"</FONT></FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT><FONT size=2>.docBindingSource, </FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"DocTypeID"</FONT></FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>true</FONT></FONT></FONT><FONT face="Courier New"><FONT size=2>));<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT><FONT size=2>.docTypeNVLComboBox.DataSource = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT></FONT><FONT face="Courier New"><FONT size=2>.docTypeNVLBindingSource;<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT><FONT size=2>.docTypeNVLComboBox.DisplayMember = </FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"Value"</FONT></FONT></FONT><FONT face="Courier New"><FONT size=2>;<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT><FONT size=2>.docTypeNVLComboBox.Name = </FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"docTypeNVLComboBox"</FONT></FONT></FONT></FONT><FONT face="Courier New"><FONT size=2>;<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT><FONT size=2>.docTypeNVLComboBox.ValueMember = </FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"Key"</FONT></FONT><FONT size=2>;</P></FONT></FONT>
<P><FONT face=Arial>When I create a new document, as I have no default value, the combo has no selected item and shows the red icon from the error provider. If I enter the combo box it behaves as the La Brea tar pit and doesn't allow me to leave until I select an item.</FONT></P>
<P><FONT face=Arial>If I come back and type garbage or just delete every character, when I try to leave </FONT><FONT face=Arial>it lets me go away, although it doesn't change the databindings. If I change anything else in the form, that combobox re-shows the last selected item.</FONT></P>
<P><FONT face=Arial>On the other hand, if I come back, change the selected item to another item and after that type garbage or delete every character, then it shows me the red icon and behaves like a tar pit again.</FONT></P><FONT face=Arial>
<P><FONT face=Arial>Of course I can solve the problem with the binding Parse and Format handlers. But that means to much coding.</FONT></P>
<P>Is there a way (meaning property) to make the combobox always show the red icon when there is no valid item selected?</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, October 06, 2009</h2>Hi, <br><br>Is the datatype for Key and DocTypeID excact same? They should be ..<br><br>What is the Style of your combobox? DropDownList? <br><br>I prefer to add a "system" item that says something like "(not selected)" and has a Key (ex -1 which is also the defaultvalue) that is not considered a valid value in ValidationRules. This allows the user to leave the field without selecting a value and leaves the error icon in place. <br><br>And what is the message you get on the red icon? It may not be from your BOs validation rules but from the databinding. If you want an error icon on the ComboBox when no item is selected then your BOs validation rules should fail on property DocTypeID. The ErrorProvider or ErrorWarnInfoProvider connected to your datasource will show the ErrorIcon and message. <br><br>I would also recommend reading the <a href="http://windowsclient.net/downloads/folders/applications/entry1302.aspx">DataBinding FAQ</a><br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
