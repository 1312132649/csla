<html><header><title>Reflection Solution?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Reflection Solution?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1602.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>NetStream posted on Thursday, October 26, 2006</h2>Let's say that I have an editable root object with 500 items and I want to update a half dozen child objects with a varying number of items all having a linked field to the root object.&nbsp; I need to retrieve a value from the root object based on the linked field and store it in the child object.&nbsp; I want to be able to traverse the child objects one property at a time searching for the same property in the root object and storing the value of the root property in the child object at runtime.&nbsp; How might I accomplish this?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>boo replied on Thursday, October 26, 2006</h2>Let's see if I understand:<br><br>You have a list (X) with 500 items (Y).<br><br>You want to update a few that 'have a linked field to the root object'.&nbsp;&nbsp; By this do mean this.Parent.SomeProperty (where 'this' is the child object)?<br><br>You need to 'retrieve a value from the root object based on the linked filed and store it in the child object'.&nbsp;&nbsp; Can't you just do this.Parent.SomeProperty ('this' being of type Y)?<br><br>And the last part I don't understand what you're trying to do...if you have a property in the X object called "Name" and a property in the Y object called "Name" can't&nbsp; you just do this.Name = Parent.Name ('this' being of type Y)?<br><br>Perhaps I can be of more assistance if you phrase the question differently.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>NetStream replied on Thursday, October 26, 2006</h2>The problem is that you do not know what the properties on either side are beforehand.&nbsp; You have to parse through the properties in the smaller tables looking for those&nbsp;properties in the larger table.&nbsp; You do not know what the properties are until runtime.&nbsp; Otherwise, you could do a this.name=parent.name.&nbsp; That is what makes this challenging.&nbsp; I can use reflection to locate the property in the larger table but I have not been able to find any way to change the value in the located field because reflection is using an empty instantiated class not the actual class I am using in the code.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Friday, October 27, 2006</h2>Hey,<br><br>I don't understand what challenge you actually face, your description is a bit fuzzy. <img src="/emoticons/emotion-7.gif" alt="Tongue Tied [:S]" /><br><br>However, I <i>do</i> know reflection, so perhaps I can answer your question anyways. <img src="/emoticons/emotion-5.gif" alt="Wink [;)]" /><br><br>- <b>TypeDescriptor.GetProperties(oObject.GetType)</b> will return a PropertyDescriptorCollection for a particular type of object<br>- each <b>PropertyDescriptor </b>in this PropertyDescriptorCollection is indeed not tied to a particular instance of the object, it's just metadata<br>- however, with a PropertyDescriptor at hand, you can obtain a PropertyInfo object using <b>oInfo = oObject.GetType.GetProperty(somePropertyDescriptor.Name)</b><br>- then, using <b>oValue = oInfo.GetValue(oObject, Nothing) </b>you get the particular value of the particular instance<br><br><br>- additionally, if you want to use type conversions then better make use of the mechanisms that also drive the PropertyGrid control, i.e.: TypeConverter<br>- you get a typeconverter using <b>oConverter = somePropertyDescriptor.Converter</b><br>- to check if it can convert property values to a particular target type, check <b>oConverter.CanConvertTo(GetType(String))</b> (replace String with anything you need)<br>- if this returns true, you can perform the actual conversion with: <b>sValue = DirectCast(oConverter.ConvertTo(oValue, GetType(String)), String)</b><br><br><br>This is pretty powerful stuff, I guess&nbsp; you should be able to solve your challenge using these techniques.<br><br>Bayu<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>NetStream replied on Friday, October 27, 2006</h2><P>Your discussion was right on!&nbsp; I really appreciate your assistance.&nbsp; I will certainly pay this forward!</P>
<P>&nbsp;</P>
<P><img src="/emoticons/emotion-2.gif" alt="Big Smile [:D]" /></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Saturday, October 28, 2006</h2>Glad to be of help. <br>Your gratitude is much appreciated in turn as well. <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /><br><br>Bayu<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
