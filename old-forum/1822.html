<html><header><title>Validation.RegExPatterns.Email and String.Empty</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Validation.RegExPatterns.Email and String.Empty</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1822.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Norty posted on Thursday, November 23, 2006</h2><FONT size=2>
<P>One of the fields that can captured in my app is an email address.&nbsp; This field is not compulsory.&nbsp; However, if it is captured, then it must be a valid email address with a maximum length of 100 characters.&nbsp; My Validation works great when an email address is captured, but throws an exception if it is left blank.</P>
<P>Is there a quick fix for this problem? <img src="/emoticons/emotion-43.gif" alt="Confused [8-)]" />&nbsp; </P>
<P>If not, I would like to add Validation.RegExPatterns.EmailOptional to the CSLA library with a modified RegEx to allow for empty strings.&nbsp; Any help on modifying the existing pattern (<FONT color=#800000 size=2>"^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$")<FONT color=#000000> would be appreciated. <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /></FONT></FONT></P>
<P><FONT color=#800000></FONT>&nbsp;</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> AddBusinessRules()</P></FONT><FONT size=2>
<P>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> Validation.CommonRules.StringMaxLength, </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> Validation.CommonRules.MaxLengthRuleArgs(</FONT><FONT color=#800000 size=2>"Email"</FONT><FONT size=2>, 100))</P>
<P>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> Validation.CommonRules.RegExMatch, </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> Validation.CommonRules.RegExRuleArgs(</FONT><FONT color=#800000 size=2>"Email"</FONT><FONT size=2>, Validation.RegExPatterns.Email))</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT></FONT>
<P><FONT size=2>Des</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RRorije replied on Thursday, November 23, 2006</h2>I have had the same problem, and I think the solution to any regex pattern to be optional is to use the non-optional regex pattern and add: |^$. In language I think it means "OR begin of string followed by end of string". But I am not a Regex guru by any means. But using some tests seemed this is correct.<br><br>So your Email pattern will then be:<br><font><font size="2"><font color="#800000" size="2">"^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$ | ^$"</font></font></font><br><br><br>Ruben</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Thursday, November 23, 2006</h2><BLOCKQUOTE><div><img src="/Themes/alternate1/images/icon-quote.gif"> <strong>RRorije:</strong></div><div>I have had the same problem, and I think the solution to any regex pattern to be optional is to use the non-optional regex pattern and add: |^$. In language I think it means "OR begin of string followed by end of string". But I am not a Regex guru by any means. But using some tests seemed this is correct.<br><br>So your Email pattern will then be:<br><font><font size="2"><font color="#800000" size="2">"^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$ | ^$"</font></font></font><br><br><br>Ruben</div></BLOCKQUOTE><br><br>Hey,<br><br>We posted almost simultaneously. ;-)<br><br>As a comment on your post: I don't think it's wise to 'loosen up' your regex. Rather surround the regex match test in a if-then-else condition that checks for empty strings before applying the regex.<br><br>See also my previous post.<br><br>Bayu<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RRorije replied on Thursday, November 23, 2006</h2>I totally agree with your last but one post. I think it is better to have a rule that uses the regex to check whether some value is correct.<br><br>And on top of that, if necessary, a rule when the property is required. That way you don't end up with several regex-patterns which come down to required/not required. This is cleaner I think<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Norty replied on Thursday, November 23, 2006</h2><P>Thanks Guys</P>
<P>Just thought it would be easier/quicker to use common rules.<img src="/emoticons/emotion-6.gif" alt="Sad [:(]" />&nbsp; I'll just implement a custom validation procedure.</P>
<P>Des</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, November 27, 2006</h2>Well as I said in my other post, you can.&nbsp; If the string is not empty you call the standard regex validator from CommonRules and return its result.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Thursday, November 23, 2006</h2>Instead of using the standard RegexMatch validation in CommonRules you could create your own validation function. Within this function you would then be free to apply any logic that you wish, hence also to check if a string is not empty before matching the regex.<br><br>In the ProjectTracker sample there is a Project BO which makes use of such a function.<br><br>Bayu<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, November 27, 2006</h2>I'd recommend Bayu's approach, and in fact is the approach I have taken with the same requirement.<br><br>In my custom logic, I check if the string is empty and if it is, return that the rule is met.&nbsp; If its not empty, I end up calling the RegEx validator and returning that result.<br><br>HTH<br>Andy<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
