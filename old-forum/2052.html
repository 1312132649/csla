<html><header><title>ValidationRules.AddRule - GUIDRequired</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ValidationRules.AddRule - GUIDRequired</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2052.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Nicholas Trevatt posted on Saturday, December 30, 2006</h2>Hi,<br><br>Before I go and write a custom validation rule in my BO's (or extending CSLA) to require a valid GUID exists in properties I just want to make sure I'm not missing something that might already exist.&nbsp; I can't see anything obvious in Validation.CommonRules so am I on the right track?<br><br>Thanks,<br>Nicholas<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jurjen replied on Saturday, December 30, 2006</h2><P>Nicholas,</P>
<P>I know of a GuidRequired function in ActiveObjects (ActiveObjects\Rules\ActiveRules.vb) :</P>
<P>&nbsp; Public Shared Function GuidRequired(ByVal target As Object, ByVal e As RuleArgs) As Boolean<BR>&nbsp;&nbsp;&nbsp; Dim TestGuid As Guid = New Guid(GetPropertyValue(target, e.PropertyName).ToString)<BR>&nbsp;&nbsp;&nbsp; If TestGuid.Equals(Guid.Empty) Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.Description = String.Format("{0} required", e.PropertyName)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return False<BR>&nbsp;&nbsp;&nbsp; Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return True<BR>&nbsp;&nbsp;&nbsp; End If<BR>&nbsp; End Function<BR><BR>There are some more 'standard' validations for int-range and dates also, check 'm out in the ActiveObjects download on Petar's ActiveObjects site : <A href="http://csla.kozul.info/">http://csla.kozul.info/</A></P>
<P>Hope this helps.<BR>Jurjen.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Saturday, December 30, 2006</h2><P>Sort of. &lt;g&gt;</P>
<P>I created my own class of "common rules" and put it in the same folder as my subclasses of CSLA that all my BOs derive from. I basically copied Rocky's common rules, put them in my own namespace to avoid conflicts,&nbsp;and then enhanced it. This gives ne a single place to put all of mycommon rules. Plus I&nbsp;now have the ability to add things like Property descriptions to my rules so that the broken rule reads: "Account Code is invalid" instead of "Acctcd is invalid".</P>
<P>Plus any suggestions which are made to enhance Rocky's rules can be applied to my rules rigt away without having to wait for the next version of CSLA.</P>
<P>Finally, any new rules you may want to write (like GUID required) can be put in this one place and used for multiple BOs.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Nicholas Trevatt replied on Sunday, December 31, 2006</h2>Thanks Jurjen and Joe for your prompt and most helpful replies!&nbsp; One of those will do the trick for me I'm sure.<br><br>I just want to add that I think the CSLA forum and particularly those people who regularly post helpful replies (including Rocky himself!) are fantastic.&nbsp; It's one of the many reasons I chose to use CSLA.&nbsp; <br><br>Thanks again,<br>Nicholas<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
