<html><header><title>Benefit of using CommandBase??</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Benefit of using CommandBase??</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1867.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rhinoishere posted on Wednesday, November 29, 2006</h2><P><FONT size=2><U><STRONG>Notes on the code blocks seen below</STRONG><BR></U>-&nbsp;Both code blocks do the same thing. They have the same interface and they return the same data.&nbsp; <BR>- Code block #2 is considerably less code and easier to read.<BR>- Other than the obvious differences, the only notable difference is the "Serializable" attribute. <BR><BR>Why would there be so much effort to use a command object? Is it just so that the code will run on the app server rather than the client?</FONT></P>
<P><U><STRONG>Code block #1</STRONG><BR></U><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>static</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> GetDataOnSomething(</FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> id)<BR>{<BR>&nbsp;&nbsp;&nbsp;GetDataOnSomethingCommand result;<BR>&nbsp;&nbsp;&nbsp;result = DataPortal.Execute&lt;GetDataOnSomethingCommand&gt;<BR>&nbsp;&nbsp;&nbsp;(</FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> GetDataOnSomethingCommand(id));<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;return</FONT><FONT size=2> result.ReturnedData;<BR>}</P>
<P>[Serializable()]<BR></FONT><FONT color=#0000ff size=2>private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>class</FONT><FONT size=2> GetDataOnSomethingCommand : CommandBase<BR>{<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> _id;<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> _returnedData = </FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2>.Empty;<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> ReturnedData<BR>&nbsp;&nbsp;&nbsp;{<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get</FONT><FONT size=2> { </FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> _returnedData; }<BR>&nbsp;&nbsp;&nbsp;}</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;public</FONT><FONT size=2> GetDataOnSomethingCommand(</FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> id)<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_id = id;<BR>&nbsp;&nbsp;&nbsp;}</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>override</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> DataPortal_Execute()<BR>&nbsp;&nbsp;&nbsp;{<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;using</FONT><FONT size=2> (SqlConnection cn = </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> SqlConnection(Database.YourConnection))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cn.Open();<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;using</FONT><FONT size=2> (SqlCommand cm = cn.CreateCommand())<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cm.CommandType = CommandType.StoredProcedure;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cm.CommandText = "storedProc";<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cm.Parameters.AddWithValue("@Id", _id);<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string</FONT><FONT size=2> returnedData = cm.ExecuteScalar().ToString();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_returnedData = returnedData;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR><BR>&nbsp;&nbsp;&nbsp;}<BR>}</FONT></P>
<P><FONT size=2><FONT size=3><U><FONT size=2><STRONG>Code block #2</STRONG></FONT><BR></U><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>static</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> GetDataOnSomething(</FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> id)<BR>{<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;using</FONT><FONT size=2> (SqlConnection cn = </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> SqlConnection(Database.YourConnection))<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cn.Open();<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;using</FONT><FONT size=2> (SqlCommand cm = cn.CreateCommand())<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cm.CommandType = CommandType.StoredProcedure;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cm.CommandText = "storedProc";<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cm.Parameters.AddWithValue("@Id", id);<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string</FONT><FONT size=2> returnedData = cm.ExecuteScalar().ToString();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;}<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;return</FONT><FONT size=2> returnedData;<BR>}<BR></FONT></FONT></FONT></P>
<P><FONT size=2><FONT size=3><FONT size=2>&nbsp;</P></FONT></FONT></FONT><FONT size=2><FONT size=3><FONT size=2></FONT></FONT></FONT>
<P><FONT size=2>thanks, Ryan</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xAvailx replied on Wednesday, November 29, 2006</h2>With the second code block you are bypassing the data portal. If you are not sure why the data portal is used, then post back and me/someone will explain.<br><br>HTH<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, November 29, 2006</h2>Well, you're bypassing the dataportal, which means you instantely lose the ability to use remoting to run data access code on an application server.<br><br>I think typically you'd also expose the command object itself to the UI.&nbsp; Nor would you use a command object to simply return a single value from an Id.&nbsp; Those kinds of mappings are usually done with a subclass to NameValueListBase.<br><br>HTH<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rhinoishere replied on Wednesday, November 29, 2006</h2><P>Thanks for the replies. <BR><BR><EM>I think typically you'd also expose the command object itself to the UI.</EM>&nbsp;<BR><BR>This statement confused me a bit.&nbsp; Can you explain?</P>
<P>thanks, Ryan</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, November 29, 2006</h2>Well the command subclass would be publicly visible and have a static factory method, much like other business objects, since the CommandBase itself is considered a business object (it implements IBusinessObject).<br><br>So in your code you'd remove the static method which returns a string, make the command class public, and add a factory method for the command object.&nbsp; The UI would then set whatever it needs to prior to executing the command then execute it.&nbsp; After execution, it could read out any returned data, if any.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
