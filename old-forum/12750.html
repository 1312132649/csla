<html><header><title>Adding a chained rule using a property on another Business Object</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Adding a chained rule using a property on another Business Object</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/12750.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>kreid posted on Monday, September 15, 2014</h2><p>I have a BO called Payment.</p>
<p>When a Customer makes a payment, I need to require that Customer to have a BillingAddress set, if it is an account payment.</p>
<p>However, I&#39;m not sure how to do this in practice. What I have so far is shown below - it is throwing &quot;given key not present in the dictionary&quot;. I can understand why. Really I just don&#39;t know if this is possible.</p>
<p><strong>CODE:</strong></p>
<p>private class ValidCustomerBusinessAddressRequiredForAccountPayments : BusinessRule</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; private readonly IBusinessRule _addressRequiredRule;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; private readonly IBusinessRule _addressCompletedRule;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; public ValidCustomerBusinessAddressRequiredForAccountPayments()</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : base(MethodProperty)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; InputProperties = new List&lt;IPropertyInfo&gt; { MethodProperty };</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _addressRequiredRule = new Required(Customer.BillingAddressProperty);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _addressCompletedRule = new FullAddressRule(Customer.BillingAddressProperty);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; protected override void Execute(RuleContext context)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var target = (Payment)context.Target;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var method = target.Method;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; var customer = Customer.Get(target.PrimaryContactId);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (customer != null &amp;&amp; method == PaymentMethod.Account)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; context.ExecuteRule(_addressRequiredRule); // throws exception</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; context.ExecuteRule(_addressCompletedRule);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Monday, September 15, 2014</h2><p>No, this is not possible!</p>
<p>You may add code in OnChildChanged event on Customer and revalidate these fields on the customer object when child properties are changed.&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>thaehn replied on Monday, September 15, 2014</h2><p>What I do in a situation like this is create a command object that goes out to the database and does the check.&nbsp; I set a logical property on the command object which is checked when it returns to the rule.</p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:gray;mso-highlight:white;">///</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:green;mso-highlight:white;"> </span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:gray;mso-highlight:white;">&lt;summary&gt;</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"></span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:gray;mso-highlight:white;">///</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:green;mso-highlight:white;"> The UPS chargeback code validate billable rule.</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"></span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:gray;mso-highlight:white;">///</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:green;mso-highlight:white;"> </span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:gray;mso-highlight:white;">&lt;/summary&gt;</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"></span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:blue;mso-highlight:white;">public</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"> </span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:blue;mso-highlight:white;">class</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"> </span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:#2b91af;mso-highlight:white;">UpsChargebackCodeValidateBillableRule</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"> : </span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:#2b91af;mso-highlight:white;">BusinessRule</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"></span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:blue;mso-highlight:white;">public</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"> UpsChargebackCodeValidateBillableRule(</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:#2b91af;mso-highlight:white;">IPropertyInfo</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"> primaryProperty)</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>: </span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:blue;mso-highlight:white;">base</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;">(primaryProperty)</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ProvideTargetWhenAsync = </span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:blue;mso-highlight:white;">true</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;">;</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IsAsync = </span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:blue;mso-highlight:white;">true</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;">;</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;">&nbsp;</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>AffectedProperties.Add(</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:#2b91af;mso-highlight:white;">UpsChargebackCodeItem</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;">.BillableProperty);</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;">&nbsp;</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:gray;mso-highlight:white;">///</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:green;mso-highlight:white;"> </span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:gray;mso-highlight:white;">&lt;summary&gt;</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"></span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:gray;mso-highlight:white;">///</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:green;mso-highlight:white;"> The execute.</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"></span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:gray;mso-highlight:white;">///</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:green;mso-highlight:white;"> </span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:gray;mso-highlight:white;">&lt;/summary&gt;</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"></span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:gray;mso-highlight:white;">///</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:green;mso-highlight:white;"> </span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:gray;mso-highlight:white;">&lt;param name=&quot;context&quot;&gt;</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"></span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:gray;mso-highlight:white;">///</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:green;mso-highlight:white;"> The context.</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"></span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:gray;mso-highlight:white;">///</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:green;mso-highlight:white;"> </span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:gray;mso-highlight:white;">&lt;/param&gt;</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"></span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:blue;mso-highlight:white;">protected</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"> </span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:blue;mso-highlight:white;">override</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"> </span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:blue;mso-highlight:white;">void</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"> Execute(</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:#2b91af;mso-highlight:white;">RuleContext</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"> context)</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:#2b91af;mso-highlight:white;">UpsChargebackCodeItem</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"> target = (</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:#2b91af;mso-highlight:white;">UpsChargebackCodeItem</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;">)context.Target;</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:blue;mso-highlight:white;">if</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"> (target.Billable == </span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:blue;mso-highlight:white;">false</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;">)<span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:#2b91af;mso-highlight:white;">UpsChargebackCodeValidateBillableCommand</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;">.BeginExecute(target.Id, (o, e) =&gt;</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:blue;mso-highlight:white;">if</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"> (e.Error != </span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:blue;mso-highlight:white;">null</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;">)</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.AddErrorResult(e.Error.Message);</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.Complete();</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:blue;mso-highlight:white;">else</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"></span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:blue;mso-highlight:white;">if</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"> (e.Object.OverrideUsed)</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.AddErrorResult(</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:#a31515;mso-highlight:white;">&quot;Code Is Overridden by Customer.<span style="mso-spacerun:yes;">&nbsp; </span>Please Remove Code from Customer First.&quot;</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;">);</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.Complete();</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:blue;mso-highlight:white;">else</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"></span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.AddSuccessResult(</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:blue;mso-highlight:white;">true</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;">);<span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;">&nbsp;</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.Complete();</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>});</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:blue;mso-highlight:white;">else</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"></span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.AddSuccessResult(</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:blue;mso-highlight:white;">true</span><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;">);</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.Complete();</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="margin:0in 0in 10pt;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;background:white;color:black;line-height:115%;mso-highlight:white;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p>Todd</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
