<html><header><title>ValidationRules &amp; private properties</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ValidationRules &amp; private properties</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8405.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Monday, January 25, 2010</h2><P>Hi,</P>
<P>I have a few properties which were private, but had some rules tied to them.&nbsp; They end up being set by&nbsp;a method call, not your normal set via property.</P>
<P>I was suprised to encounter an error when the CommonRules.StringRequired rule was run; I was getting a NullReferenceException when the rule ran.</P>
<P>I traced the problem and it looks like in the Utilities class the CallByName method only gets public properties.</P>
<P>Would this be considered a bug, or should all Csla properties be public?&nbsp; I'm using 3.8.1.</P>
<P>Thanks</P>
<P>Andy</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Monday, January 25, 2010</h2>Hi Andy,<br><br>Have you tried the Csla.Reflection.MethodCaller.CallPropertyGetter(obj, propertyName) instead of CallByName? <br><br>Just out of curiosity, why do you put validation rules on private properties? <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, January 25, 2010</h2><P>Well this is all within Csla code, so I haven't tried modifying it.</P>
<P>I put the rule on to ensure that the method was called pretty much.&nbsp; Part of the method call sets the property, then fires the rule check. I wanted the method call because it reads a file, which may take a while, so it didn't seem right to do that in response to a property changed.</P>
<P>I understand this might not be the best way, but its quick, and I fixed it by just making the property public, so its not a big deal, but was just wondering if there was a conscience decision to only support public properties or not.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, January 25, 2010</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>
<P>Would this be considered a bug, or should all Csla properties be public?&nbsp; I'm using 3.8.1.</P>
<P></div></BLOCKQUOTE></P>
<P>Not a bug, no. The common rules are built with the assumption that they shouldn't break encapsulation - that they should operate on public properties.</P>
<P>Breaking encapsulation isn't ideal, and I didn't (don't) want to encourage doing so. I understand that it can make some things easier, but it is still dangerous.</P>
<P>As the author of an object, when you declare something as private you rather expect it to be private. When things break encapsulation, it violates that basic expectation. It changes the very nature of the contract between object and consumer, so now the author of the object can no longer assume the private member belongs only to the object. It now belongs to the entity that's breaking encapsulation too.</P>
<P>So renaming the private member should be a non-issue right? It is private after all. But now even a simple rename of a member becomes a breaking change. And not one the Visual Studio refactoring tools will help you find - because they too assume people wouldn't do something like this.</P>
<P>This is why I have always been so resistent to externalized DAL code. Almost by definition that code breaks encapsulation and thus increases the maintenance costs of your code. (though I think public PropertyInfo objects and the ObjectFactory base class help with this)</P>
<P>Ideally your properties would be public. Or you'd define an interface to expose them. In short, hopefully you'd expose the values in such a way that they are accessible without resorting to hacks like reflection.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, January 25, 2010</h2><P>Ok, glad to know your thoughts on this.&nbsp; I did end up simply making the property public, at least public read-only.</P>
<P>The only reason I have the property at all is because I've been favoring creating PropertyInfo[T] objects so that Csla manages the field value, in case I decide to move to Silverlight.</P>
<P>Since&nbsp;I had the PropertyInfo[T] and a rule I needed checked, i just threw it on there, and that's how I got where I was.</P>
<P>Thanks for the insight.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
