<html><header><title>Question about ValidatedDataGridTextColumn</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Question about ValidatedDataGridTextColumn</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7609.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fel posted on Friday, September 11, 2009</h2>Is it possible to set ValidatedDataGridTextColumn to edit
mode that a user don't need to click two times to be able change value in it?
<br>If yes, what I need to do?

<br><br>Thanks</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, September 11, 2009</h2>I don't know. I think it changes modes when it is clicked the first time, maybe you can have it set focus automatically after that mode change?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pondosinat replied on Friday, September 11, 2009</h2><P>Yes. We're doing this now by subclassing DataGrid and handling the PreparingCellForEdit event. Here is the code.</P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>Imports</FONT></FONT><FONT size=2> Csla.Silverlight</P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</FONT></FONT><FONT size=2> EditableGridBase</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Inherits</FONT></FONT><FONT size=2> DataGrid</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>New</FONT></FONT><FONT size=2>()</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>AddHandler</FONT></FONT><FONT size=2> CurrentCellChanged, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>AddressOf</FONT></FONT><FONT size=2> dg_CurrentCellChanged</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>AddHandler</FONT></FONT><FONT size=2> PreparingCellForEdit, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>AddressOf</FONT></FONT><FONT size=2> dg_PreparingCellForEdit</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Private</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</FONT></FONT><FONT size=2> dg_CurrentCellChanged(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Object</FONT></FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> EventArgs)</P>
<P>EnterEditMode()</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</FONT></FONT><FONT size=2> EnterEditMode()</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Try</P></FONT></FONT><FONT size=2>
<P>BeginEdit()</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Catch</FONT></FONT><FONT size=2> ex </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> Exception</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Try</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Private</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</FONT></FONT><FONT size=2> dg_PreparingCellForEdit(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Object</FONT></FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> DataGridPreparingCellForEditEventArgs)</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Dim</FONT></FONT><FONT size=2> txt </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> TextBox = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Nothing</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>TypeOf</FONT></FONT><FONT size=2> e.Column </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Is</FONT></FONT><FONT size=2> ValidatedDataGridTextColumn </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Then</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Dim</FONT></FONT><FONT size=2> sp = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>TryCast</FONT></FONT><FONT size=2>(e.EditingElement, StackPanel)</P>
<P>txt = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>TryCast</FONT></FONT><FONT size=2>(sp.Children(0), TextBox)</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Dim</FONT></FONT><FONT size=2> p = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>TryCast</FONT></FONT><FONT size=2>(sp.Children(1), PropertyStatus)</P>
<P>txt.Width = e.Column.ActualWidth - 2</P>
<P>p.Visibility = Windows.Visibility.Collapsed</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ElseIf</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>TypeOf</FONT></FONT><FONT size=2> e.Column </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Is</FONT></FONT><FONT size=2> DataGridCheckBoxColumn </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Then</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Dim</FONT></FONT><FONT size=2> ch = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>TryCast</FONT></FONT><FONT size=2>(e.EditingElement, CheckBox)</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If</FONT></FONT><FONT size=2> ch </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>IsNot</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Nothing</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Then</P></FONT></FONT><FONT size=2>
<P>ch.Focus()</P>
<P>ch.IsChecked = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Not</FONT></FONT><FONT size=2> ch.IsChecked.Value</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Return</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Else</P></FONT></FONT><FONT size=2>
<P>txt = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>TryCast</FONT></FONT><FONT size=2>(e.EditingElement, TextBox)</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If</FONT></FONT><FONT size=2> txt </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>IsNot</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Nothing</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Then</P></FONT></FONT><FONT size=2>
<P>txt.SelectionLength = txt.Text.Length</P>
<P>txt.Focus()</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</P>
<P>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</P></FONT></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
