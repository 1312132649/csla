<html><header><title>Object Inheritance Help</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Object Inheritance Help</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9288.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>GPhillips posted on Wednesday, July 28, 2010</h2><p>I started with an inheritance module used with CSLA 2.0 and I am trying to rewrite it to use 3.8.1 and<br />lambda expressions with the PropertyInfo/Field manager model.&nbsp; The original inheritance looked like this:<br /><br />BusinessBase<br />&nbsp;&nbsp; Entity <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BankAccountBase (or other business classes-autogenerated based on a SQL DB)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BankAccount&nbsp; (for custom Properties/Methods not autogenerated)<br /><br />Rewritten version:<br /><br />BusinessBase(Of T)<br />&nbsp;&nbsp; Entity(Of T As Entity(Of T))&nbsp; Inherits BusinesBase(Of T) <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BankAccountBase(Of T As BankAccountBase(Of T))&nbsp;&nbsp; Inherits Entity(Of T)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BankAccount(Of T As BankAccount(Of T))&nbsp;&nbsp; Inherits BankAccountBase(Of T)</p>
<p>This works properly with PropertyInfo, FieldManager and lambda expressions.&nbsp; Just using Entity without<br />without the (Of T) causes downstream classes to blow up with a PropertyInfo locked error.&nbsp; <br /><br />My problem is that I have many routines that operate on the Entity class (including Custom Controls<br />that have an Entity property).&nbsp; This worked fine with the original hierarchy since everything was <br />derived from Entity, but with the new method, these would have to be Entity(Of T) and the type would<br />have to be specified all the time, which isn&#39;t feasible.<br /><br />One attempt I have made is to create an IEntity Interface that Entity(Of T) would implement.&nbsp; The <br />concern I have about that route is that EVERY property, event and Sub that is needed from both<br />Entity(Of T) AND BusinessBase(Of T) (like IsNew, Is Valid, Save, etc, etc.) need to be part of the<br />interface and have to be Shadowed and raised (or returned) in Entity(OF T).&nbsp; This seems overly<br />complicated.<br /><br />Has anyone else run into a similar situation? Is an interface the right approach or is there another<br />way to access the base classes?.<br /><br />Any help/ideas would be GREATLY appreciated.</p>
<p>Thanks,</p>
<p>Gary </p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Monday, August 02, 2010</h2><p>Hi Gary,</p>
<p>Your only option with generic classes is to use Interfaces. But - not every property has to be in that interface as there are other standard interfaces you could use in Csla as ITrackStatus, ISavable etc. And&nbsp; you can have inheritance in interfaces as: </p>
<p><span style="font-family:Courier New;font-size:x-small;">Public Interface IA<br />&nbsp;&nbsp;&nbsp; Sub A()<br />End Interface</span></p>
<p><span style="font-family:Courier New;font-size:x-small;">Public Interface IB<br />&nbsp;&nbsp;&nbsp; Sub B()<br />End Interface</span></p>
<p><span style="font-family:Courier New;font-size:x-small;">Public Interface IC<br /><strong>&nbsp;&nbsp;&nbsp; Inherits IA, IB</strong><br />&nbsp;&nbsp;&nbsp; Sub C()<br />End Interface</span></p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
