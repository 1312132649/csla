<html><header><title>DataMapper and Decimals (Numbers)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>DataMapper and Decimals (Numbers)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8121.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Wbmstrmjb posted on Wednesday, December 09, 2009</h2>I am surprised that this is not brought up in another thread, but I was unable to find it.<br /><br />How do you guys handle DataMapper.Map mapping "0" back to decimals (numbers) instead of "null" if there is no value?  Seems like you would not want "0" being set because "0" is a real value and not the same as null.  Haven't others crossed this issue before?<br /><br />Thanks,<br />Mike</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tmg4340 replied on Wednesday, December 09, 2009</h2><P><FONT size=2 face=Tahoma>One of the tenets of CSLA is that in general, NULL and 0 <EM>are</EM> the same thing.&nbsp; If you read through all the books (and various forum posts), you'll see that's how Rocky built the framework - NULL's are converted to a type-appropriate default value.&nbsp; If you do have&nbsp;a need to distringuish between NULL and a value, you can do it - but the framework doesn't&nbsp;do&nbsp;it for you by default.</FONT></P>
<P><FONT size=2 face=Tahoma>In terms of DataMapper, I can't offer a specific solution - I haven't looked at the code in a long time, and I don't use it.&nbsp;&nbsp;One possibility that&nbsp;comes to mind is to use a decimal?, but I don't know whether DataMapper is smart enough to handle that.&nbsp; In any event, I think you'll encounter situations like this throughout CSLA.</FONT></P>
<P><FONT size=2 face=Tahoma>HTH</FONT></P>
<P><FONT size=2 face=Tahoma>- Scott</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Wbmstrmjb replied on Wednesday, December 09, 2009</h2>The "0" is null is interesting, but then how do you handle "0" as a value?  If I have a bank account balance of "0" that's different than having an account with the balance not yet set to a value.  How do you distinguish between "0" and "not set"?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, December 09, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>tmg4340:</strong></div><div>
<P><FONT size=2 face=Tahoma>One of the tenets of CSLA is that in general, NULL and 0 <EM>are</EM> the same thing.&nbsp; </FONT></div></BLOCKQUOTE></P>
<P>Let's be careful around this topic.</P>
<P>The <EM>SafeDataReader</EM> exists to "de-null" values. It is one tiny class in a large framework. The rest of the framework doesn't care what you do with your null values.</P>
<P>Personally, one of my pet peeves is the misuse of null in databases. In my personal experience, almost every database has many columns that allow null values where there's absolutely no business rationale for such a thing. Nor is the column a foreign key, or an empty date - the only two technical reasons for allowing a null value.</P>
<P>Due to all the crappy databases out there, it was (and is) common practice to write data access code to check for, and remove, null values. SafeDataReader just makes this easier.</P>
<P>But you must be aware that you don't need to use SafeDataReader. It is merely a wrapper around your real datareader object. Nothing stops you from using your real datareader that you got from ADO.NET - and thereby getting at the null values and using them as you see fit.</P>
<P>I would <EM>hope</EM> that "you see fit" means there are specific cases where <EM>business users</EM> care about the difference between a value that was never entered, and a value that is empty ("", 0, false, etc). That (and the two technical reasons listed above) are the only reasons your database should allow null values in a column - and therefore are the only reasons your app should have to deal with null values.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Wbmstrmjb replied on Thursday, December 10, 2009</h2>I agree to an extent, but I think there are plenty of real uses for null (or "not set") over a default value for every column (0, false, "", etc).<br /><br />Usually an amount should be something other than $0.00, so I'll concede that even though I find it odd to have a textbox with $0.00 in it before a user enters a value.  <br /><br />But in the case of true/false with a default of false (or true for that matter), "not set" is very different than false.  Answers to questions should be null until answered.  How would one know looking at an answer whether the person answered false or there just hasn't been an answer entered yet?  That seems like a very common and very real need for nulls.  And in the case of needing nulls, how does one map those values with DataMapper.Map?  Is it just not possible?<br /><br />Thanks.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, December 10, 2009</h2>That's what I'm saying though. If there is a _business need_ to<br />differentiate between a value having not been set, and a "real value" then<br />that's fine - that's the point of null.<br /><br />In that case though, SafeDataReader isn't useful, because you actually care<br />about the null value, and so you should use whatever datareader you get from<br />executing your command.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Wbmstrmjb replied on Thursday, December 10, 2009</h2>Yes and no.  We extended SafeDataReader and added SmartDecimal so that "decimal" can be null.  :)</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Wbmstrmjb replied on Thursday, December 10, 2009</h2>That you for your insight.  We will "map" it another way.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, December 10, 2009</h2><P>In any case, we've veered off your original question.</P>
<P>DataMapper is pretty dumb - it just copies values from property to property.</P>
<P>But this comes back to what I was saying earlier. If you really care about null values from a business perspective, then that concept must (by definition) be expressed from the database all the way through to the UI.</P>
<P>Typically DataMapper is used to map web UI values back into the business object. So if your UI represents the null concept, you should be able to map it - though perhaps not with DataMapper.</P>
<P>I say this, because different UI technologies represent null in the UI in different ways (or not at all - in which case you sometimes need to invent the concept). Microsoft has gotten better about this over the past few years, at least on the Windows side. I do little on the web side, so I don't know if Web Forms expresses null values well or not...</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
