<html><header><title>How to Access Grandparent properties from child</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How to Access Grandparent properties from child</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7244.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Todd_B posted on Wednesday, July 08, 2009</h2><P><BR>I have a child Editable Child.&nbsp; I need to add a Validation Rule in the child object that compares a property in the child with a property in the GrandParent object.&nbsp; I have seen an example in the forms on how to get the parent reference for one level up in a custom rule. <BR></P>
<P>Is there a way to get the parent's parent GrandParent reference from a child object?&nbsp; </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tetranz replied on Wednesday, July 08, 2009</h2>BusinessBase and BusinessListBase both have a reference to their immediate parent so you can just work your way up the chain.<br><br>I usually but something like this in my lists derived from BusinessListBase. Assuming my root is called Root<br><br>public Root MyParent<br>{<br>&nbsp; get { return (Root) Parent; }<br>}<br><br>And then in my child class, something like this ...&nbsp; assuming my list is MyList<br><br>public MyList MyParent<br>{<br>&nbsp; get { return (MyList) Parent; }<br>}<br><br>Then in the child, to get the root do MyParent.MyParent<br><br>That can be repeated on further levels so in a grandchild you might do MyParent.MyParent.MyParent.MyParent to get the root. There are twice as many MyParents as you might expect because for the child, Parent refers to the list not the parent above it. Maybe you don't really need access to the lists so in the child do something like:<br><br>public Root MyParent<br>
{<br>
&nbsp; get { return ((MyList) Parent).MyParent; }<br>
}<br>
<br>That works for me but it's probably not the purest OO thing to do. You'd need to use an interface or something if your collections were not always under the same parent type.<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Vinodonly replied on Thursday, July 09, 2009</h2>In one of the bo's, I used LocalContext to store ref of Parent BO and accessed it from grandchild..</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tetranz replied on Thursday, July 09, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>Vinodonly:</strong></div><div>In one of the bo's, I used LocalContext to store ref of Parent BO and accessed it from grandchild..</div></BLOCKQUOTE><br><br>Don't forget that you'll need to reset the reference after serializing / deserializing. The Parent property in BB and BLB "just works" because Rocky has taken care of all that tedious stuff.<br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
