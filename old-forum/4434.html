<html><header><title>Customizing Authorization</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Customizing Authorization</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4434.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rvlc05 posted on Thursday, February 28, 2008</h2><FONT size=2>
<P><FONT face="Courier New">I am new to CSLA and am developing an employee information management application. Each Employee is assigned to one of many Sites. Each Employee has (at least) one Supervisor and may have one or more ProjectManagers. The Employee, her Supervisor(s), and her ProjectManager(s) must belong to the same Site.</FONT></P>
<P><FONT face="Courier New">My challenge is that I have what appears to be three different types of Roles to be implemented.</FONT></P>
<P><FONT face="Courier New">The first role type is of global scope and the actions granted to these roles apply to all Employees. The management of authorizations for these roles can be handled by the PTracker model.</FONT></P>
<P><FONT face="Courier New">The actions granted to the second role type are based on one or more Sites assigned to the user for this role. For instance, an Employee object authorizes the RegionChief role only if the Employee's Site is assigned to this RegionChief.</FONT></P>
<P><FONT face="Courier New">The third type of role is similar to the second except it is based on the Employees assigned to the user. For instance, an Employee object authorizes the Supervisor role </FONT><FONT face="Courier New">only if the Employee is assign to this Supervisor.</FONT></P>
<P><FONT face="Courier New">I guess I'm asking for some advice on how to gracefully integrate the second and third role types using modifications of the model provided in the PTracker.</FONT></P>
<P><FONT face="Courier New">Thanks for your help.</FONT></P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, February 28, 2008</h2><P>You are describing something other than role-based authorization.</P>
<P>Which is fine - you can override CanReadProperty and CanWriteProperty to accomodate arbitrary authorization rules at the property level - in addition to the existing role-based functionality.</P>
<P>In other words, it sounds like you do have normal role-based rules and can use the existing functionality for that. Then you can add extra functionality for the relationship-based rules:</P>
<P>public override bool CanReadProperty(string propertyName)<BR>{<BR>&nbsp; if (base.CanReadProperty(propertyName))<BR>&nbsp; {<BR>&nbsp;&nbsp;&nbsp; // do&nbsp;your relationship-based checks&nbsp;here<BR>&nbsp; }<BR>&nbsp; else<BR>&nbsp;&nbsp;&nbsp; return false;<BR>}</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
