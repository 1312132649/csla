<html><header><title>EditLevel error (WinForm)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>EditLevel error (WinForm)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8974.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dg78 posted on Sunday, May 23, 2010</h2><p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Hi,</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">When everything is ok, databinding and n-level undo are marvelous but with the smallest error it is the horror.</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">And now it is the horror for me with an EditLevel error on a child BO.</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;"></span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">(<span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">I use the Csla version VB 3.52 in WinForms and I don&rsquo;t use managed properties).</span></span></span>
<p></p>
</span></span></span>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">In Copystate (Undoable), I have an exception in <span style="mso-spacerun:yes;">&nbsp;</span>:</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">If</span> <span style="color:blue;">Me</span>.EditLevel + 1 &gt; parentEditLevel <span style="color:blue;">Then</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Throw</span> <span style="color:blue;">New</span> UndoException( _</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">String</span>.Format(<span style="color:blue;">My</span>.Resources.EditLevelMismatchException, <span style="color:#a31515;">&quot;CopyState&quot;</span>))</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-no-proof:yes;">Exit</span><span style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-no-proof:yes;"> <span style="color:blue;">Sub</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">End</span> <span style="color:blue;">If</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">because EditLevel = 1 for the child and ParentEditLevel is also egal to 1.</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;"></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">I do :</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Dim</span> oEmploye <span style="color:blue;">As</span> Employe = Employe.NewEmploye</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Dim</span> uc <span style="color:blue;">As</span> ucEmploye = <span style="color:blue;">New</span> ucEmploye(oEmploye)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">No problem then in the UI, I have a button &ldquo;Create a new employe&rdquo;. The exception come with a click on this button.</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">My editable root is Employee and the child BO is Totals (which give sums of several values of payrolls). In SQL Server, there is a relationship one-one between tables Employee and Totals.</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Totals is created during payroll edition and I want to display Totals in the editable Employee root UI.</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">First I use for the Totals child an editable root child and I have the error described above.</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">What do I miss ?</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">I know that many old posts are about that problem. I read many of them but I don&rsquo;t know how to solve my problem. It is not easy and not clear.</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">It is my first question, my second is below :</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">I think it is better to use a ReadOnly Child for Totals BO. Is it possible to use a ROC for that ?</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Thanks for a small sample (even in C#).</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Best regards</span></span></span></p>
</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dagware replied on Sunday, May 23, 2010</h2><p>I&#39;ve developed the habit of exposing the EditLevel property in all my business objects &amp; collections, so I can write&nbsp;console messages for situations like this. Eventually I figure out what&#39;s causing the edit levels to get out of sync.</p>
<p>That&#39;s the best I can offer, which I admit isn&#39;t much. Oh, and also that you&#39;re not alone in the frustrations you feel! Good luck.</p>
<p>Dan</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dg78 replied on Monday, May 24, 2010</h2><p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Thanks Dan for your answer.</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Me too I expose the EditLevel in the BO :</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Public</span> <span style="color:blue;">ReadOnly</span> <span style="color:blue;">Property</span> CurrentEditLevel() <span style="color:blue;">As</span> <span style="color:blue;">Integer</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-no-proof:yes;">Get</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-no-proof:yes;"><span style="mso-tab-count:4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Return</span> EditLevel</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-no-proof:yes;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">End</span> <span style="color:blue;">Get</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-no-proof:yes;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">End</span> <span style="color:blue;">Property</span></span><span lang="EN-US" style="font-size:8pt;mso-ansi-language:EN-US;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Yes, sometimes I am frustrated with Dotnet and Csla and I think that I am not alone.</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">We must be patient with Dotnet and very very&nbsp;patient with Csla. I think it is the reason that there are no women who work with Csla (since many years I never see one on the forum).</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Come back to my problem.</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">I found a solution (perhaps not the solution but a solution).</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">When I click on the button &ldquo;create a new employee&rdquo;, I do :</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>bsEmploye.DataSource = mEmploye</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-no-proof:yes;">ReBindUI(mEmploye, <span style="color:blue;">False</span>, <span style="color:blue;">True</span>, Ok)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-no-proof:yes;"></span><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Before to enter on RebindUI, I have :</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;">memploye.CurrentEditLevel = 1</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;">memploye.MyTotals.CurrentEditLevel =1</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">In RebindUI, we go on <span style="mso-spacerun:yes;">&nbsp;</span></span></span></span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;">UnbindBindingSource</span><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp; </span>then<span style="mso-spacerun:yes;">&nbsp; </span></span></span></span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;">current.CancelEdit</span><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp; </span>then </span></span></span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;">CancelEdit</span><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp; </span>then<span style="mso-spacerun:yes;">&nbsp; </span></span></span></span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;">UndoChanges(<span style="color:blue;">Me</span>.EditLevel - 1)</span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-ansi-language:EN-US;mso-no-proof:yes;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-ansi-language:EN-US;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Here there is :</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:green;">&#39; this is a child object, cascade the call</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">If</span> <span style="color:blue;">Not</span> _bindingEdit <span style="color:blue;">OrElse</span> <span style="color:blue;">TypeOf</span> value <span style="color:blue;">Is</span> FieldManager.FieldDataManager <span style="color:blue;">Then</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;</span><span style="color:blue;">DirectCast</span>(value, IUndoableObject).UndoChanges(<span style="color:blue;">Me</span>.EditLevel, BindingEdit)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:8pt;mso-no-proof:yes;">End</span><span style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-no-proof:yes;"> <span style="color:blue;">If</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Never I go on the UndoChanges for child and it is normal because<span style="mso-spacerun:yes;">&nbsp; </span></span></span></span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;">_bindingEdit</span><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp; </span>is always True (we can undo only if it is do before).</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">I repeat that I don&rsquo;t use managed properties so I have no FieldDataManager.</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Then I saw how Rocky does when childs are BLB or even in managed properties. I found that he uses<span style="mso-spacerun:yes;">&nbsp; </span></span></span></span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;">Csla.Core.UndoableBase.ResetChildEditLevel</span><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp; </span>to synchronize editlevel for child / root.</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Then I put :</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>bsEmploye.DataSource = mEmploye</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:red;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Csla.Core.UndoableBase.ResetChildEditLevel(mEmploye.MyTotals, 1, True) </span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:green;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span lang="EN-US" style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;font-size:8pt;mso-no-proof:yes;">ReBindUI(mEmploye, <span style="color:blue;">False</span>, <span style="color:blue;">True</span>, Ok)<span style="color:green;"></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">And now it is good.</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">But<span style="mso-spacerun:yes;">&nbsp; </span></span></span></span><span lang="EN-US" style="font-family:&#39;Courier New&#39;;color:red;font-size:8pt;mso-ansi-language:EN-US;mso-no-proof:yes;">Csla.Core.UndoableBase.ResetChildEditLevel</span><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp; </span>is Friend then I put it Public.</span></span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0cm 0cm 0pt;"><span lang="EN-US" style="mso-ansi-language:EN-US;"><span style="font-size:small;"><span style="font-family:Calibri;">Rocky, could you put this sub as Public or is it necessary to expose it in the BO ?</span></span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Dexter replied on Tuesday, May 25, 2010</h2><p>Take a look at the CslaActionExtender helper class, that may be of help to you. </p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
