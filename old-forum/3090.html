<html><header><title>Doing Calculations in FilteredBindingLists</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Doing Calculations in FilteredBindingLists</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3090.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>pirithoos posted on Tuesday, June 26, 2007</h2>Hi all,<br><br>I do have a question about design.<br><br>My application has a ReadOnlyList called ReadOnlyOrderList containing OrderInfos.<br>This list has some shared methods to e.g. sum the turnover off all contained OrderItems or another<br>one which counts the total number of Orders already shipped.<br><br>Know I started to use a FilteredBindingList as view to extract Orders by certain criteria such<br>e.g. only Orders with a turnover &gt; 10.000 EUR.<br><br>My question is what is the best practise to allow using the sum/count methods over the OrderInfoBO's within those Views?<br><br>Shall I inherit a subclass from FilteredBindingList implemeting those shared methods<br>or create a new class consuming either ReadOnlyOrderLists or FilteredOrderBindingLists<br>doing the sums/calculation and return them via a function/property? Or any different approach?<br><br>What is the recommended implementation in this scenario?<br><br>Thanks for your feedback,<br><br>Frank<br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, June 26, 2007</h2><P>You want to make sure to normalize your behaviors. Something like Count is already normalized by .NET - it is a property on every collection. But Sum is not, so you need to write it.</P>
<P>In .NET 3.5 you'll be able to extend IBindingList with a Sum method, but today you can't do that, and instead must write a normal (typically static/Shared) method instead.</P>
<P>Your only question then, is whether to add a Sum method to your business lists and have that method delegate to your shared Sum implementation, or to have your code directly use that shared method.</P>
<P>sum = OrderInfos.Sum()<BR>sum = CustomFiltered.Sum()</P>
<P>or</P>
<P>sum = OrderInfos.Sum(list)</P>
<P>where "list" is the list containing the data to sum - filtered or not.</P>
<P>This second approach, btw, lends itself more to the extender method in .NET 3.5 - it'll be easier to port/convert.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pirithoos replied on Wednesday, June 27, 2007</h2>Dear Rocky,<br><br>thanks for your reply.<br><br>In fact count is normalized in .Net and I use this property to get the total number of OrdersInfos<br>in my collection. But sometimes I need the count of only those OrderInfos whicht are <br>shipped (though all either shipped or not shipped OrderInfos are in the same collection),<br>therefore I need to implent an additional Count for ShippedOrders...<br><br>I followed up your second approach and spend my ReadOnlyListBase 'OrderInfos' some&nbsp; shared functions like <br><br>GetSumTurnover( ByVal IList (of OrderInfo) as Double<br>GetSumOfShippedOrder (ByVal IList (Of OrderInfo) as Integer<br><br>those functiona accepts either OrderInfos or the FilterBindingList Views of OrderInfos.<br><br>This works fine. However one more thing needing a solution:<br><br>There are currently approx 5 different kinds of sums / counts and more to come...<br>though it is no problem writing simmilar GetSumXYZ/GetCountXYZ methods like the above, this would implicit that we loop 5 or more times through the same collection to build those sums/counts.<br><br>Before using the FilteredBindingList exposed all sums/count by ReadOnlyProperties<br>of the OrderInfos collection and when after within the Factorymethod returning<br>this OrderInfoList I temporarily stored the list and called a sub looping through all<br>OrderInfos and build the individual sums/count within a select clause later accessed<br>through those Properties. <br><br>Now where my OrderInfos collection has two factorymethods one returning a 'ReadOnlyBindingList' <br>one returning a 'FilteredBindingList' this is no longer possible at least as long as I do<br>not implement the same sub in both (ReadOnlyBinding and FilteredBindingList)<br><br>Any further suggestions for a elegant solution?<br><br>Best Regards<br><br>Frank<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
