<html><header><title>Compression with Web Service data portal?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Compression with Web Service data portal?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10817.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 posted on Thursday, October 27, 2011</h2><p>I&#39;ve done some searching to see how this is done, and have the impression it might be just a matter of including the correct incantation in the web.config on the web service side. </p>
<p>However, I&#39;m a bit fuzzy on specifically what changes are required and, moreover, how does the client decompress the data on receipt?&nbsp; Is there some standard infrastructure in Windows that will decompress soap messages based on the header content?</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Thursday, October 27, 2011</h2><p>This is the old asmx portal, not WCF?</p>
<p>That portal does manual serialization of the data to get a byte array from the BinaryFormatter. That byte array is passed over the web service.</p>
<p>I would think that to do compression you&#39;d need to create a custom version of the proxy and portal/host classes, and compress/decompress that byte array before it is passed over the wire by web services.</p>
<p>That&#39;s not hard - just copy the existing classes out of Csla into your project and compress/decompress the byte array with a compression library.</p>
<p>In the Silverlight data portal you do the same thing, but we explicitly created virtual methods so you can do this in a subclass. I suppose I&#39;d have done the same with the asmx channel, but when WCF came along I pretty much viewed all the previous channels as legacy.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Friday, October 28, 2011</h2><p>Thanks, Rocky. Somehow I had the impression there was a way to get IIS to handle this (e.g. web pages get httpcompression for &quot;free&quot; if the server supports it), so I was trying to see if there was a way to leverage this in the asmx portal.&nbsp; This is not the case if I&#39;m understanding correctly. I&#39;ve done some minor modifications to asmx portal on the server side already so I can see how it might not be difficult at all to add compression. </p>
<p>Do you remember which version of CSLA first had the virtual methods for allowing this to be&nbsp;done in a subclass? (I&#39;ve been backporting newer CSLA features as needed to CSLA 3.5 as needed as we aren&#39;t using Silverlight or WPF at this point and there were breaking changes introduced in the versions that introduced support for these.)</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, October 28, 2011</h2><p>IIS does offer some compression features, and this has been discussed on the forum in the past. I think there are some limits though, especially on post-back data, where the HTTP spec doesn&#39;t explicitly define a compression model (iirc).</p>
<p>I think the compression support for the <em>Silverlight data portal</em> was added in 3.7 or 3.8. You can look at the history of WcfPortal (for example) here:</p>
<p><a href="http://www.lhotka.net/cslacvs/viewvc.cgi/core/trunk/Source/Csla/Server/Hosts/Silverlight/WcfPortal.cs?view=log">http://www.lhotka.net/cslacvs/viewvc.cgi/core/trunk/Source/Csla/Server/Hosts/Silverlight/WcfPortal.cs?view=log</a></p>
<p>&nbsp;</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
