<html><header><title>Another Beginner Easy Question </title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Another Beginner Easy Question </h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/12876.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>MarkOverstreet posted on Monday, May 04, 2015</h2><p>I&#39;m trying to do something really basic.&nbsp; I have a lookup table called TWageType and the structure is simply a description field containing 3 records (Hourly, Salary, Other).</p>
<p>I&#39;m trying to create my first business object to simply allow me to retrieve all the records and bind them to a grid for admin maintenance.</p>
<p>So I have a WageType class inheriting from BusinessBase&lt;WageType&gt; and I have a WageTypes collection inheriting from BusinessBindingListBase&lt;WageTypes,WageType&gt;.&nbsp; All works so far.</p>
<p>I have the following method in the WageTypes collection (list):</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static async Task&lt;WageTypes&gt; GetAll()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return await DataPortal.FetchAsync&lt;WageTypes&gt;();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>and in the DataPortal_Fetch of the WageTypes collection (list) I have this...</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void DataPortal_Fetch()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // get all the payment methods from the database.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TWagePaymentMethods paymentMethods = TWagePaymentMethod.SelectAll();<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (var item in paymentMethods)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WageTypes w = this.AddNew();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; w.Description = item.Description;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //using (w.BypassPropertyChecks)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;&nbsp;&nbsp; DatabaseHelper.CopyProperties(item, m, string.Empty);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;</p>
<p>This appears to work but I have 3 questions.&nbsp; </p>
<p>1)&nbsp; The WageType object when created with .AddNew&nbsp; has it&#39;s IsNew property set to true but in your example code in your eBook I didn&#39;t see any example of this unless I missed it.&nbsp; IsNew should be false.&nbsp; So what should I do?</p>
<p>2)&nbsp; Why can&#39;t I do the BypassPropertyChecks like in your book.&nbsp; If I uncomment this, the compiler complains that it isn&#39;t a property of the object.</p>
<p>3)&nbsp; Is this even the correct way to do this?&nbsp; My goal is simple,&nbsp; load the values in a grid and let the user change them at will, add new ones, delete, etc.&nbsp; Standard stuff.</p>
<p>Thanks again for any help.</p>
<p>Mark</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Monday, May 04, 2015</h2><p>You have to understand the difference of a list object and the business object.&nbsp;</p>
<p>Your DataPortal_Fetch is in the list object. BypassPropertyChecks is a property of the business object (item).&nbsp;</p>
<p>If you look at the samples - typically the list will call this.Add(DataPortal.FetchChild&lt;type&gt;(param)) and this in turn calls the Child_Fetch method on the business object and will also make sure that the child object is marked as Old.&nbsp;</p>
<p>When you call this.AddNew it is the same as when you insert new objects during edit of the list,&nbsp;</p>
<p>So the semantics would be:&nbsp;</p>
<p><span>&nbsp; &nbsp; &nbsp; &nbsp; private void DataPortal_Fetch()</span><br /><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span><br /><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // get all the payment methods from the database.</span><br /><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TWagePaymentMethods paymentMethods = TWagePaymentMethod.SelectAll();</span><br /><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (var item in paymentMethods)</span><br /><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br /></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.Add(DataPortal.FetchChild&lt;WageType&gt;(item);<br /><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span><br /><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p>and in WageType class:</p>
<p><span>&nbsp; &nbsp; &nbsp; &nbsp; private void Child_Fetch(TWagePaymentMethod data)</span><br /><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span><br /><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; using (w.BypassPropertyChecks)</span><br /><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br /></span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // set properties in the bussiness obect from the supplied object from database<br /><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DatabaseHelper.CopyProperties(item, m, string.Empty);</span><br /><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span><br /><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><br /><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p><span><br /></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MarkOverstreet replied on Monday, May 04, 2015</h2><p>Thanks!&nbsp;&nbsp; That worked great but caused an interesting issue.&nbsp; I loaded all 3 records into a grid and when the user types in a row to change an existing value in the RowUpdated event I get a reference to the underlying object for that row and I try to call</p>
<p>.Save </p>
<p>to save the modified description and I get an error that says {&quot;Can not directly save a child object&quot;}</p>
<p>So my goal is to bind the simple list of descriptions for this look up table to the grid so that the user can modify the value, tab off of the row, modify the second value, tab off the row, etc.&nbsp; If I call save on the entire collection, first I will be serializing the entire contents across the wire when maybe only one object changed and also it seems like it will screw up the tabbing from row to row if I have to save the entire collection each time and rebind.&nbsp; What am I missing?</p>
<p>Thanks again,&nbsp; i really appreciate the help in trying to get going with CSLA.NET.</p>
<p>Mark</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, May 04, 2015</h2><p>You&#39;d call Save on the BusinnessListBase class, which would save all the children at once.&nbsp; this is the most normal case as a user will typically have a save button which saves all the changes to the form.&nbsp; if you really want to save as the row loses focus, change your list to subclass DynamicRootListBase and change your child to be a root by implementing DataPortal_Fetch, _Insert _Create and _Insert, as appropriate.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MarkOverstreet replied on Tuesday, May 05, 2015</h2><p>Hi Andy,</p>
<p>Thanks for the help.&nbsp; I didn&#39;t see your DynamicRootListBase  but I did try DynamicBindingListBase and it worked perfectly (and you knew it was coming) except for one issue that I&#39;m hoping is simple to fix.</p>
<p>I can load the single column grid of descriptions, edit one and tab off and it even automatically calls the Save method on my individual objects for me (awesome) but the grid does not display and empty row at the bottom so that a user can add new descriptions.&nbsp; On my BindSource that is bound to the grid I have set the property AllowNew to true and that didn&#39;t work.&nbsp; I then added the AllowNew = true; in my constructor of my DynamicBindingListBase object which didn&#39;t appear to work either.&nbsp;&nbsp;&nbsp; Any idea what I am missing to allow me to add new rows?</p>
<p>Thanks again.</p>
<p>Mark</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MarkOverstreet replied on Tuesday, May 05, 2015</h2><p>Never mind, I found the problem myself.&nbsp; I&#39;m using the DevExpress XtraGrid and forgot to set the NewItemRowPosition = Bottom.&nbsp; Thanks again for the help it all works so far!</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
