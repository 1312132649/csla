<html><header><title>C# Question about Multiple Inheritence</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>C# Question about Multiple Inheritence</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1323.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>DeHaynes posted on Monday, September 25, 2006</h2><P>&nbsp;&nbsp;&nbsp;I have some functionality that I want to add to all 6 of the basic business object classes in CSLA from which you derive your business objects.&nbsp; I am subclassing them so obviously this is the best location to put my added functionality.</P>
<P>&nbsp;&nbsp;&nbsp;I would like to only type the code once and then implement it in each class.&nbsp; I cannot inherit from two base classes, so is putting the code in an Interface my only option?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Monday, September 25, 2006</h2><P>You can't really "put code in an interface" </P>
<P>What kind of functionality are you thinking of? Perhaps that'll help me understand what you're asking. I don't quite understand "code once and then implement it in each class". I assume you mean "code once and then use in each class"? </P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DansDreams replied on Monday, September 25, 2006</h2>That would imply that it belongs further up the existing inheritance chain.&nbsp; Obviously you can't do that without hacking CSLA, but Rocky likes to hear these things as potential future enhancements, so please share your idea here.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DeHaynes replied on Monday, September 25, 2006</h2><P><STRONG><FONT size=4>Outline</FONT></STRONG></P>
<P>In each table in my database, I add the following fields</P>
<P>ReactivatePerson&nbsp;&nbsp;&nbsp;varchar(50)<BR>ReactivateDate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DateTime<BR>IsActive&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Bit (Boolean)<BR>DeactivatePerson&nbsp;&nbsp;&nbsp;varchar(50)<BR>DeactivateDate&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DateTime</P>
<P>Then in my objects I add the ability to Deactive &amp; Reactivate objects (records) in the the database.&nbsp; This allows me to remove records from showing up without actually deleting them from the database.</P>
<P>Along with this I am going to add is the ability to only show objects where IsActive is True, or only show objects where IsActive is false, or show all objects regardless of the IsActive state.</P>
<P>&nbsp;&nbsp;&nbsp;I could duplicate code in each of my base classes in that inherit from the CSLA base classes but I would rather not.</P>
<P><STRONG><FONT size=4>Examples</FONT></STRONG> </P>
<P>&nbsp;&nbsp;&nbsp;So if I tell my Store object to retrieve a store and the object is set to only retrieve stores where IsActive is true and the store in question is not active, then it will return nothing or an empty object.<BR>&nbsp;&nbsp;&nbsp;If I tell my Read Only List Owners Object to only retrieve Owners and it is set to retrieve where IsActive equals false, then it will only show me Owners who are no longer active.</P>
<P><STRONG><FONT size=4>Real Life Need</FONT></STRONG></P>
<P>&nbsp;&nbsp;&nbsp;Here is my real life situation.&nbsp; My company is a large franchisor and does a LOT of statistics with financial numbers from the stores.&nbsp; We have developed a method to share this financial information without actually giving out the financial numbers.&nbsp; We do company wide report every year.&nbsp; Which goes into the historical financial data and retrieves it.&nbsp; So when a store closes, we cannot remove them from the system.&nbsp; They must stay in the system.&nbsp;&nbsp;My solution was to use the IsActive thing outlined above.&nbsp;&nbsp;The reason we cannot go with static numbers is because the calculations may change from year to year depending on&nbsp;how finely they want to divide areas like "cost of goods",&nbsp;"labor costs", etc.&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;Well this idea bled over into another report system which measures pricing.&nbsp; Now we have historical data about that.&nbsp;&nbsp;This then moved into another reporting system on salary and benefits.&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;Now we are at a point where they want to keep as much historical (now including contact info) as possible online.&nbsp; So my approach is, rather than deal with&nbsp;it each time I run into I might as well code it into the base classes.&nbsp; </P>
<P><STRONG><FONT size=4>Further Thought</FONT></STRONG></P>
<P>&nbsp;&nbsp;&nbsp;Originally the ReactivatedPerson, ReactivatedDate, DeactivatedPerson and DeactivatedDate were just for niceties. But then a situation occuried to me.&nbsp; What if my user deactivates a Owner who already has 15 old (deactivated) addresses on record.&nbsp; They want to re-activate him but how can the system tell which addresses it should reactivate.&nbsp; Well, all the child objects that were deactivated at the same time as the parent object SHOULD have a very similiar DeactivatedDate value.&nbsp; So you can use that to programatically reactivate a collection of objects back to the situation it was before you deactivated them.&nbsp; You could even do this two-weeks after the event.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Monday, September 25, 2006</h2>Personally I would only see this applicable to BusinessBase&lt;T&gt;. </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DeHaynes replied on Monday, September 25, 2006</h2><P>I think I have a solution to emulate Multiple Inheritence.</P>
<P>If I create a interface outlining the requirements for my added functionality:</P><FONT color=#0000ff size=2>
<P>using</FONT><FONT size=2> System;<BR></FONT><FONT color=#0000ff size=2>using</FONT><FONT size=2> System.Collections.Generic;<BR></FONT><FONT color=#0000ff size=2>using</FONT><FONT size=2> System.Text;<BR></FONT><FONT color=#0000ff size=2>namespace</FONT><FONT size=2> MyCompany.MyFramework<BR>{<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>interface</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>IActiveFunctionality<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>bool</FONT><FONT size=2> IsActive&nbsp;{&nbsp;</FONT><FONT color=#0000ff size=2>get</FONT><FONT size=2>; </FONT><FONT color=#0000ff size=2>set</FONT><FONT size=2>;}</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> Deactivate();</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> Reactivate();<BR>&nbsp;&nbsp;&nbsp;}<BR>}</FONT></P>
<P><FONT size=2><FONT color=#000000 size=3>Then I create a class to hold my code that will be shared:</FONT></FONT></P><FONT size=2><FONT size=3><FONT color=#0000ff size=2>
<P>using</FONT><FONT size=2> System;<BR></FONT><FONT color=#0000ff size=2>using</FONT><FONT size=2> System.Collections.Generic;<BR></FONT><FONT color=#0000ff size=2>using</FONT><FONT size=2> System.Text;</P></FONT><FONT color=#0000ff size=2>
<P>namespace</FONT><FONT size=2> MyCompany.MyFramework<BR>{<BR>&nbsp;&nbsp;&nbsp;<FONT color=#008000 size=2>//I implement the&nbsp;IActiveFunctionality interace&nbsp;<BR></FONT></FONT><FONT size=2>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>class</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>IsActiveFunctionality</FONT><FONT size=2> : </FONT><FONT color=#008080 size=2>IActiveFunctionality<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>bool</FONT><FONT size=2> _IsActive;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>bool</FONT><FONT size=2> IsActive<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>get </FONT><FONT size=2>{ </FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> _IsActive; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>set </FONT><FONT size=2>{ _IsActive = </FONT><FONT color=#0000ff size=2>value</FONT><FONT size=2>; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> Reactivate()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#008000 size=2>//Put code here to reactivate object<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>}</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> Deactivate()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#008000 size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//Put code here to deactivate object<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>}<BR>&nbsp;&nbsp;&nbsp;}<BR>}</FONT></P>
<P><FONT color=#000000>Finally I subclass from CSLA and include my common code from my IsActiveFunctionality class:</FONT></P><FONT size=2><FONT color=#0000ff size=2>
<P>using</FONT><FONT size=2> System;<BR></FONT><FONT color=#0000ff size=2>using</FONT><FONT size=2> System.Collections.Generic;<BR></FONT><FONT color=#0000ff size=2>using</FONT><FONT size=2> System.Text;<BR><FONT color=#0000ff>using</FONT><FONT size=2> Csla;</FONT></P></FONT><FONT color=#0000ff size=2>
<P>namespace</FONT><FONT size=2> MyCompany.MyFramework<BR>{<BR>&nbsp;&nbsp;&nbsp;<FONT color=#008000 size=2>//Notice this also&nbsp;implements the&nbsp;IActiveFunctionality interace&nbsp;<BR></FONT>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>class</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>SubClassedBusinessBase</FONT><FONT size=2> : BusinessBase&lt;</FONT><FONT color=#008080 size=2>SubClassedBusinessBase</FONT><FONT size=2>&gt;, </FONT><FONT color=#008080 size=2>IActiveFunctionality</FONT><FONT size=2>&nbsp;<BR>&nbsp;&nbsp;&nbsp;{</FONT><FONT size=2><BR><FONT color=#008000 size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//This object holds my common code that will be shared<BR></FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>private</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>IsActiveFunctionality</FONT><FONT size=2> IsActiveCodeObject = </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>IsActiveFunctionality</FONT><FONT size=2>();</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#008000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//I have to implement the IActiveFunctionality interface</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>bool</FONT><FONT size=2> IsActive<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>get<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> IsActiveCodeObject.IsActive;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsActiveCodeObject.IsActive = </FONT><FONT color=#0000ff size=2>value</FONT><FONT size=2>;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#008000>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//I&nbsp;use the IsActiveCodeObject to the common code</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>IsActiveFunctionality</FONT><FONT size=2>.Reactivate()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsActiveCodeObject.Reactivate();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>IsActiveFunctionality</FONT><FONT size=2>.Deactivate()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IsActiveCodeObject.Deactivate();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;}<BR>}</FONT></P>
<P><FONT size=2><FONT color=#000000 size=3>I know this is an extremely simplified example but it demonstrates the basic ideas.&nbsp; I believe this will successfully allow me to emulate the functionality of multiple inheritence.&nbsp; &nbsp;</FONT></P></FONT></FONT></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>justncase80 replied on Tuesday, September 26, 2006</h2><P>You&nbsp;could try removing the IsActive data from every table (so its not redundant)&nbsp;and maybe have just one IsActive table, make that correspond to a full blown business object. In the IsActive table you'd have all the rows you have above plus a field for a table name (or object name) and a foreign key column. Make the PK a combination of the foreign key column and the table name. In your objects that you want to be active you could have an IsActive object and expose that with a property.</P>
<P>Either way, remember if you change the IsActive value you want to call MarkDirty().</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
