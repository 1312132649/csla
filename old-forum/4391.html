<html><header><title>OT:  Linq and stored procedures</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>OT:  Linq and stored procedures</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4391.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Friday, February 22, 2008</h2>Hi,<br><br>I'm trying to write some code to execute a stored procedure.&nbsp; My old way of doing it I had a DataCommand subclass which would have properties for the parameters and attributes would help in mapping everything to the right procedure.<br><br>What I've found for linq is to do this:<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;summary&gt;Updates a document's ship<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// date ONLY.&lt;/summary&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;param name="shipDate"&gt;The new value for the<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// ship date.&lt;/param&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;param name="documentId"&gt;The id of the document to update.&lt;/param&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;returns&gt;&lt;c&gt;true&lt;/c&gt; if the update succeeded, <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// false otherwise.&lt;/returns&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [Function( Name = "dbo.apUpdateDocumentShipdate", IsComposable = false )]<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [return: ResultType( typeof( bool ) )]<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public bool UpdateDocumentShipdate( <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [Parameter( DbType = "datetime", Name = "@ShipDate" )]<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; DateTime? shipDate,<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [Parameter( DbType = "int", Name = "@DocumentId" )]<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; int documentId <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ) {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return (bool)ExecuteMethodCall(<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; this,<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; (MethodInfo)MethodInfo.GetCurrentMethod(),<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; shipDate,<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; documentId<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ).ReturnValue;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br><br>Ok, kinda odd.&nbsp; It'd be nice if the compiler would generate code for the method body, since the attributes tell it everything it needs.&nbsp; I guess that wouldn't be good for the compiler though.&nbsp; My reservation is that the help for ExecuteMethodCall says I shouldn't be calling that method myself.&nbsp; <br><br>Everything I've seen has me using VS to generate my classes for the db... but I already have them because my custom data layer needed them, so I'm able so far to just slap the Linq.Mapping attributes on the classes and go.&nbsp; Should I be ok, since this is what would be generated anyway?<br><br>More on a side note.. anyone know how to use the designer in VS to see my existing objects and decorate them.. or generate the diagram after I've decorated them appropriately?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Sunday, February 24, 2008</h2><P>As far as I know there is no problem with you creating/attributing your own code rather than using the designer. The designer is merely a code-generator after all, and they just code-gen using the attributes, etc.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, February 25, 2008</h2>Ok.&nbsp; Just wasn't sure if it should only be called from within a System.Linq assembly or not.. thanks!<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
