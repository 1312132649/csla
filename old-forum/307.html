<html><header><title>Generic Validation Rules</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Generic Validation Rules</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/307.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal posted on Wednesday, June 07, 2006</h2>Following with the changes to validation rules I mentioned <a HREF="/forums/permalink/1478/1478/ShowThread.aspx#1478">here</a>, here's an implementation of generic rules:<br><br>In order to do this I created:<br>&nbsp; Public Interface IRuleMethod<br>&nbsp;&nbsp;&nbsp; ReadOnly Property RuleName() As String<br>&nbsp;&nbsp;&nbsp; ReadOnly Property RuleArgs() As RuleArgs<br>&nbsp;&nbsp;&nbsp; Function Invoke(ByVal target As Object) As Boolean<br>&nbsp; End Interface<br><br>The rule handler was changed to this:<br><br>&nbsp;Public Delegate Function RuleHandler(Of T, C As RuleArgs)( _<br>&nbsp;&nbsp;&nbsp; ByVal target As T, ByVal e As C) As Boolean<br><br>There are many overloads of the AddRule() method with generic parameters besides the standard ones that we all use.<br><br>The benefits:<br><br>1) No code breaks. (This is because of the overloads in ValidationRules, ValidationRulesManager and SharedValidationRules.<br>2) You can write rules like:<br><br>&nbsp; Public Class SomeClass(Of T As SomeClass(Of T))<br>&nbsp;&nbsp;&nbsp; Inherits ActiveObjects.ActiveBusinessBase(Of T)<br><br>&nbsp; Private mSomeNumber as Integer = 0<br>&nbsp; Private Shared Function MyRule(ByVal target As SomeClass(Of T), _<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ByVal e As Csla.Validation.RuleArgs) As Boolean<br>&nbsp;&nbsp;&nbsp; e.Description = "The number cannot be zero"<br>&nbsp;&nbsp;&nbsp; Return target.mSomeNumber &lt;&gt; 0<br>&nbsp; End Function<br>&nbsp; <br>&nbsp; Public Property SomeNumber as Integer<br>&nbsp;&nbsp; ...<br>&nbsp; End Property<br><br>&nbsp; Shared Sub New<br>&nbsp;&nbsp;&nbsp; Csla.Validation.SharedValidationRules.AddRule(Of SomeClass(Of T))( _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddressOf MyRule, GetType(DateRangeChild(Of T)), "SomeNumber")<br>&nbsp; End Sub<br><br>&nbsp; End Class<br><br>Note that the target of the rule has the same definition as the class (this can be done with generic and non generic classes, of course) and the overloading also applies to instance or type rules.<br><br>I'm attaching the whole Validation Namespace classes so that it you can check it out. This includes the fix mentioned in the other thread.<br><br>Andrés<br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Thursday, June 08, 2006</h2>Hey Rocky, <br>Here's Version 2 based on the latest csla. I cleaned it up a little bit and ported the comments to the new methods. Note that there's a IRuleMethod.vb file that needs to be added to the project.<br><br><br>Andrés<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Wednesday, June 14, 2006</h2>Fixed a ValidationRules.vb because the overloads where not being called correctly.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
