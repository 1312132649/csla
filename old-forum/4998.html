<html><header><title>How to know if a object is derived from BusinessListBase?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How to know if a object is derived from BusinessListBase?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4998.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>longbridge posted on Saturday, June 21, 2008</h2>Hi, <br><br>I need to test if the type of a object is a subclass of BusinessListBase without giving the specific type of T and C. Since BusinessListBase is a generic class defined as:<br>&nbsp;<br>public abstract class BusinessListBase&lt;T, C&gt; : ExtendedBindingList&lt;C&gt;, IEditableCollection, IBusinessObject, ISupportUndo, IUndoableObject, ICloneable, ISavable, IParent<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; where T : Csla.BusinessListBase&lt;T, C&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; where C : Csla.Core.IEditableBusinessObject<br><br><br>how can I do that? <br><br>For BusinessBase, I can use <br>if(myObject is BusinessBase) { ... }<br><br>But for BusinessListBase, following code can not pass compilation.<br><br>if(myObject is BusinessListBase&lt;BusinessListBase, IEditableBusinessObject&gt;)<br>{ ... }<br><br>Thanks. <br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>simon_may replied on Saturday, June 21, 2008</h2><P>I have looked at this type of problem many times and have never been able to find a 'generic' solution to it. I am sure that there must be one somewhere. Having given up on that, I check for Csla.Core.IEditableCollection a non generic&nbsp;interface unique to the BusinessListBase.</P>
<P>Simon</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>longbridge replied on Saturday, June 21, 2008</h2>Thanks. Simon.<br><br>Actually I would like to get IsValid property after I convert myObject to BusinessListBase(if the type test can pass). IEditableCollection doesn't has isValid property, so it doesn't work for my case. <br><br>Actually this is a general problem for generic type. There should be a solution to do that. <br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tmg4340 replied on Saturday, June 21, 2008</h2><P><FONT face=Tahoma size=2>There are properties on a Type object that would tell you whether it is a generic type.&nbsp; But you aren't going to get what you want.</FONT></P>
<P><FONT face=Tahoma size=2>The reason there is no solution for this is&nbsp;because BusinessListBase&lt;T, C&gt; is what's called an "open generic type" - a type whose generic parameters have not been resolved down to&nbsp;actual types.&nbsp; Generics are essentially a compiler trick, and do not work like base classes.&nbsp; They are more like C++ templates.&nbsp; That's why Rocky had to create the interfaces.&nbsp; As such, there is no "BusinessListBase&lt;T, C&gt;" type anywhere.&nbsp; Every reference is resolved to its "closed type" based on what you provide for T and C.&nbsp; So it's not possible to cast a variable to "BusinessListBase&lt;T, C&gt;".</FONT></P>
<P><FONT face=Tahoma size=2>Also, consider what would have to happen if .NET allowed you to cast a variable to a "BusinessListBase&lt;T, C&gt;" type.&nbsp; How does it work with T and C within the generic type when it doesn't know what they are?&nbsp; Sure, there could be constraints on the generic types, but&nbsp;.NET can't guarantee that.&nbsp; And those types may play into the properties/methods you're trying to use.</FONT></P>
<P><FONT face=Tahoma size=2>What version of CSLA are you working with?&nbsp; The 3.0 version I have shows that "IsValid" is part of the "IEditableCollection" interface...</FONT></P>
<P><FONT face=Tahoma size=2>HTH</FONT></P>
<P><FONT face=Tahoma size=2>- Scott</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>simon_may replied on Sunday, June 22, 2008</h2><P>Thanks Scott. As I said before, I have looked at the problem on a number of occasions but have never come to a firm conclusion. Your explanation makes perfect sense and is pretty much what I imagined it might be without thinking it through to a firm conclusion</P>
<P>Simon</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>sergeyb replied on Sunday, June 22, 2008</h2><P>This maybe a bit convuluted, but here it goes anyway :-)</P>
<P>&nbsp;</P><FONT color=#0000ff size=2>
<P>public static </FONT><FONT color=#0000ff size=2>bool</FONT><FONT size=2> IsBusinessListBase(</FONT><FONT color=#0000ff size=2>object</FONT><FONT size=2> testObject)</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>bool</FONT><FONT size=2> returnValue = </FONT><FONT color=#0000ff size=2>false</FONT><FONT size=2>;</P>
<P></FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (testObject.GetType().BaseType.GetGenericArguments().Length==2)</P>
<P>{</P>
<P></FONT><FONT color=#2b91af size=2>Type</FONT><FONT size=2> firstParameter = testObject.GetType().BaseType.GetGenericArguments()[0].UnderlyingSystemType;</P>
<P></FONT><FONT color=#2b91af size=2>Type</FONT><FONT size=2> secondParameter = testObject.GetType().BaseType.GetGenericArguments()[1].UnderlyingSystemType;</P>
<P></FONT><FONT color=#2b91af size=2>Type</FONT><FONT size=2>[] interfaces = secondParameter.GetInterfaces();</P>
<P></FONT><FONT color=#0000ff size=2>bool</FONT><FONT size=2> isEditableObject = </FONT><FONT color=#0000ff size=2>false</FONT><FONT size=2>;</P>
<P></FONT><FONT color=#0000ff size=2>for</FONT><FONT size=2> (</FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> intefaceCounter = 0; intefaceCounter &lt; interfaces.Length-1; intefaceCounter++)</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (interfaces[intefaceCounter].UnderlyingSystemType.Equals(</FONT><FONT color=#0000ff size=2>typeof</FONT><FONT size=2>(System.ComponentModel.</FONT><FONT color=#2b91af size=2>IEditableObject</FONT><FONT size=2>)))</P>
<P>{</P>
<P>isEditableObject = </FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>;</P>
<P>}</P>
<P>}</P>
<P></FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (isEditableObject)</P>
<P>{</P>
<P></FONT><FONT color=#2b91af size=2>Type</FONT><FONT size=2> businessListType = </FONT><FONT color=#0000ff size=2>typeof</FONT><FONT size=2>(</FONT><FONT color=#2b91af size=2>BusinessListBase</FONT><FONT size=2>&lt;,&gt;).MakeGenericType(</FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>Type</FONT><FONT size=2>[] { firstParameter, secondParameter });</P>
<P></FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (testObject.GetType().BaseType.Equals(businessListType))</P>
<P>{</P>
<P>returnValue = </FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>;</P>
<P>}</P>
<P>}</P>
<P></P>
<P>}</P>
<P></FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> returnValue;</P>
<P>}</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, June 23, 2008</h2><P>The Csla.Core.ITrackStatus interface introduced in CSLA .NET 3.5 should give you IsValid, along with other important status properties.</P>
<P>You'll still need to check to see if the type implements IEditableCollection to know if it is a BLB.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>longbridge replied on Monday, June 23, 2008</h2><br>
Thanks for all your replies.<br><br>For my problem, I can use IEditableCollection to test the object and get isValid Property if type is compatible. <br><br>Kevin<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Sunday, June 22, 2008</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>longbridge:</strong></div><div>Actually I would like to get IsValid property after I convert myObject to BusinessListBase(if the type test can pass). IEditableCollection doesn't has isValid property, so it doesn't work for my case. </div></BLOCKQUOTE></P>
<P>I had this exact same issue.</P>
<P>I simply created my own Interface which Inherits IEditableCollection and then exposed IsValid.</P>
<P>Then I had my base class which derives from BusinessListBase implement my Interface.</P>
<P>Thus all of my collections implement the Interface and I can cast any list to the Interface and ask if it IsValid.</P>
<P>I also added a few more things that I needed while I was doing this. This process allowed me to develop a general report engine using DataDynamics reporting where the detail section is *any* ROC.</P>
<P>Joe</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
