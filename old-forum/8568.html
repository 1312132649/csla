<html><header><title>Wpf:  Missing something simple?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Wpf:  Missing something simple?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8568.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Tuesday, February 23, 2010</h2><p>Ok, I&#39;m finally trying the MVVM stuff in a Wpf client application (not SL).</p>
<p>This is what I&#39;d like:&nbsp; I have an OpenDocument method on my VM.</p>
<p>I want to fire the Open command when a row is double clicked in my DataGrid, passing the DocumentInfo object as a command parameter.</p>
<p>I can&#39;t figure this out!</p>
<p>Any ideas?</p>
<p>(also, whats the diff between Interaction.Triggers in Interactivity and normal Wpf triggers?)</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>triplea replied on Wednesday, February 24, 2010</h2><p>Hi Andy</p>
<p>I use the grid from the WPF toolkit so in XAML:<span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;"> <span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;"><font size="2" color="#c0c0c0"><font size="2" color="#c0c0c0">
<p>&lt;</p>
</font></font></span></span></span></span></span></span></span><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;"><font size="2" color="#c0c0c0">
<p>&nbsp;</p>
</font></span></span></span></span></span></span></span>
<p>&nbsp;</p>
</span></span></span></span></span></span><span style="font-size:x-small;color:#ffff00;"><span style="font-size:x-small;color:#ffff00;">dg</span></span><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;">:</span></span><span style="font-size:x-small;color:#ffff00;"><span style="font-size:x-small;color:#ffff00;">DataGrid </span></span><span style="font-size:x-small;color:#00ffff;"><span style="font-size:x-small;color:#00ffff;">x</span></span><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;">:</span></span><span style="font-size:x-small;color:#00ffff;"><span style="font-size:x-small;color:#00ffff;">Name</span></span><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;">=</span></span><span style="font-size:x-small;color:#00ff00;"><span style="font-size:x-small;color:#00ff00;">&quot;MyGrid&quot; </span></span><span style="font-size:x-small;color:#00ffff;"><span style="font-size:x-small;color:#00ffff;">ItemsSource</span></span><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;">=&quot;{</span></span><span style="font-size:x-small;color:#ffff00;"><span style="font-size:x-small;color:#ffff00;">Binding</span></span><span style="font-size:x-small;color:#ff0000;"><span style="font-size:x-small;color:#ff0000;"> Path</span></span><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;">=Model}</span></span><span style="font-size:x-small;color:#00ff00;"><span style="font-size:x-small;color:#00ff00;">&quot; </span></span><span style="font-size:x-small;color:#00ffff;"><span style="font-size:x-small;color:#00ffff;">csla</span></span><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;">:</span></span><span style="font-size:x-small;color:#00ffff;"><span style="font-size:x-small;color:#00ffff;">InvokeMethod.TriggerEvent</span></span><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;">=</span></span><span style="font-size:x-small;color:#00ff00;"><span style="font-size:x-small;color:#00ff00;">&quot;MouseDoubleClick&quot; </span></span><span style="font-size:x-small;color:#00ffff;"><span style="font-size:x-small;color:#00ffff;">csla</span></span><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;">:</span></span><span style="font-size:x-small;color:#00ffff;"><span style="font-size:x-small;color:#00ffff;">InvokeMethod.MethodName</span></span><span style="font-size:x-small;color:#c0c0c0;"><span style="font-size:x-small;color:#c0c0c0;">=</span></span><span style="font-size:x-small;color:#00ff00;"><span style="font-size:x-small;color:#00ff00;">&quot;SomethingSelected&quot;&gt; </span></span></p>
<p>In the VM:</p>
<p><b><span style="font-size:x-small;color:#eaeaac;"><span style="font-size:x-small;color:#eaeaac;">public</span></span></b><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><b><span style="font-size:x-small;color:#eaeaac;"><span style="font-size:x-small;color:#eaeaac;">void</span></span></b><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">SomethingSelected</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">(</span></span><b><span style="font-size:x-small;color:#eaeaac;"><span style="font-size:x-small;color:#eaeaac;">object</span></span></b><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">sender</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">, </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">Csla</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">.</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">Wpf</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">.</span></span><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;">ExecuteEventArgs</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">e</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">)<br />{<br />&nbsp;&nbsp;&nbsp; </span></span><b><span style="font-size:x-small;color:#eaeaac;"><span style="font-size:x-small;color:#eaeaac;">var</span></span></b><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">source</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> = ((</span></span><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;">MouseButtonEventArgs</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">)</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">e</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">.</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">TriggerParameter</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">).</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">OriginalSource</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><b><span style="font-size:x-small;color:#eaeaac;"><span style="font-size:x-small;color:#eaeaac;">as</span></span></b><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;">DependencyObject</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">;<br />&nbsp;&nbsp;&nbsp; </span></span><b><span style="font-size:x-small;color:#eaeaac;"><span style="font-size:x-small;color:#eaeaac;">var</span></span></b><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">row</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> = <strong>MyApp<span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">.</span></span></strong><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;"><strong>Infrastructure.</strong></span></span></span></span><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;">UIHelper</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">.</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">TryFindParent</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">&lt;</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">Microsoft</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">.</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">Windows</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">.</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">Controls</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">.</span></span><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;">DataGridRow</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">&gt;(</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">source</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">);<br /><br />&nbsp;&nbsp;&nbsp; </span></span><b><span style="font-size:x-small;color:#eaeaac;"><span style="font-size:x-small;color:#eaeaac;">if</span></span></b><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> (</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">row</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> != </span></span><b><span style="font-size:x-small;color:#eaeaac;"><span style="font-size:x-small;color:#eaeaac;">null</span></span></b><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">)<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var item = </span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">.<span style="color:#dfdfbf;">row</span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">.</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">DataContext as MyObj;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...<br />&nbsp;&nbsp;&nbsp; }<br />}</span></span></span></span></p>
<p>The UI helper method I found from the net but I cannot find the bookmark for it. Instead I have blatantly pasted the code below. </p>
<p><span><span style="font-size:x-small;color:#eaeaac;"><span style="font-size:x-small;color:#eaeaac;"><span style="font-size:x-small;color:#eaeaac;"><strong>using </strong><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">System</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">.</span></span><span><span style="font-size:x-small;color:#dfdfbf;">Windows<br /></span><span style="font-size:x-small;color:#eaeaac;"><strong>using</strong></span><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">System</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">.</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">Windows</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">.</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">Media</span></span></span></span></span><span style="font-size:x-small;color:#eaeaac;"><strong>&nbsp;</strong></span></span></p>
<p>
<p>
<p><strong><span><span style="font-size:x-small;color:#eaeaac;">namespace</span><span style="font-size:x-small;color:#dcdccc;"> MyApp</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">.</span></span></strong><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;"><strong>Infrastructure<br /></strong></span></span><strong><span><span style="font-size:x-small;color:#dcdccc;">{<br /></span><span style="font-size:x-small;color:#eaeaac;">&nbsp; public</span></span><span><span style="font-size:x-small;color:#dcdccc;"> </span><span style="font-size:x-small;color:#eaeaac;">static</span></span><span><span style="font-size:x-small;color:#dcdccc;"> </span><span style="font-size:x-small;color:#eaeaac;">class</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span></strong><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;"><strong>UIHelper<br />&nbsp; </strong></span></span><strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">{<br />&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">///</span></span><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;"> </span></span></strong><strong><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&lt;summary&gt;<br /></span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&nbsp;&nbsp;&nbsp; ///</span></span></strong><strong><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;"> Finds a parent of a given item on the visual tree.<br /></span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&nbsp;&nbsp;&nbsp; ///</span></span><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;"> </span></span></strong><strong><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&lt;/summary&gt;<br /></span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&nbsp;&nbsp;&nbsp; ///</span></span><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;"> </span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&lt;typeparam name=&quot;T&quot;&gt;</span></span><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;">The type of the queried item.</span></span></strong><strong><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&lt;/typeparam&gt;<br />&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">///</span></span><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;"> </span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&lt;param name=&quot;child&quot;&gt;</span></span></strong><strong><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;">A direct or indirect child of the<br />&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">///</span></span><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;"> queried item.</span></span></strong><strong><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&lt;/param&gt;<br />&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">///</span></span><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;"> </span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&lt;returns&gt;</span></span></strong><strong><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;">The first parent item that matches the submitted<br />&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">///</span></span></strong><strong><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;"> type parameter. If not matching item can be found, a null<br />&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">///</span></span><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;"> reference is being returned.</span></span></strong><strong><span><span style="font-size:x-small;color:#808080;">&lt;/returns&gt;<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size:x-small;color:#eaeaac;">public</span></span><span><span style="font-size:x-small;color:#dcdccc;"> </span><span style="font-size:x-small;color:#eaeaac;">static</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">T</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">TryFindParent</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">&lt;</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">T</span></span><span><span style="font-size:x-small;color:#dcdccc;">&gt;(</span><span style="font-size:x-small;color:#eaeaac;">this</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;">DependencyObject</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">child</span></span><span><span style="font-size:x-small;color:#dcdccc;">) </span><span style="font-size:x-small;color:#eaeaac;">where</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">T</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> : </span></span></strong><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;"><strong>DependencyObject<br />&nbsp;&nbsp;&nbsp; </strong></span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong></span></span><strong><span style="font-size:x-small;color:#7f9f7f;"><span style="font-size:x-small;color:#7f9f7f;">//get parent item<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;">DependencyObject</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">parentObject</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> = </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">GetParentObject</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">(</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">child</span></span></strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>);</strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong> </strong></span></span></span></span></p>
<p><strong><span><span style="font-size:x-small;color:#7f9f7f;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //we&#39;ve reached the end of the tree<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="font-size:x-small;color:#eaeaac;">if</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> (</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">parentObject</span></span><span><span style="font-size:x-small;color:#dcdccc;"> == </span><span style="font-size:x-small;color:#eaeaac;">null</span></span><span><span style="font-size:x-small;color:#dcdccc;">) </span><span style="font-size:x-small;color:#eaeaac;">return</span></span><span><span style="font-size:x-small;color:#dcdccc;"> </span><span style="font-size:x-small;color:#eaeaac;">null</span></span></strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>;</strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong> </strong></span></span></span></span></p>
<p><strong><span style="font-size:x-small;color:#7f9f7f;"><span style="font-size:x-small;color:#7f9f7f;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//check if the parent matches the type we&#39;re looking for<br /></span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">parent</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> = </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">parentObject</span></span><span><span style="font-size:x-small;color:#dcdccc;"> </span><span style="font-size:x-small;color:#eaeaac;">as</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">T</span></span></strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>;</strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong> </strong></span></span></span></span></p>
<strong><span><span style="font-size:x-small;color:#eaeaac;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if</span><span style="font-size:x-small;color:#dcdccc;"> (</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">parent</span></span><span><span style="font-size:x-small;color:#dcdccc;"> != </span><span style="font-size:x-small;color:#eaeaac;">null</span></span></strong><strong><span><span style="font-size:x-small;color:#dcdccc;">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:x-small;color:#eaeaac;">return</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">parent</span></span></strong><span><span style="font-size:x-small;color:#dcdccc;"><strong>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </strong></span><span style="font-size:x-small;color:#eaeaac;"><strong>else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </strong></span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </strong></span></span><strong><span><span style="font-size:x-small;color:#7f9f7f;">//use recursion to proceed with next level<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:x-small;color:#eaeaac;">return</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">TryFindParent</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">&lt;</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">T</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">&gt;(</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">parentObject</span></span></strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp; }</strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>&nbsp;<br /><br /></strong></span></span></span></span><strong><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&nbsp;&nbsp;///</span></span><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;"> </span></span></strong><strong><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&lt;summary&gt;<br /></span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&nbsp;&nbsp;///</span></span></strong><strong><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;"> This method is an alternative to WPF&#39;s<br /></span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&nbsp; ///</span></span><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;"> </span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&lt;see cref=&quot;VisualTreeHelper.GetParent&quot;/&gt;</span></span></strong><strong><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;"> method, which also<br /></span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&nbsp; ///</span></span></strong><strong><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;"> supports content elements. Keep in mind that for content element,<br /></span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&nbsp; ///</span></span></strong><strong><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;"> this method falls back to the logical tree of the element!<br /></span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&nbsp; ///</span></span><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;"> </span></span></strong><strong><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&lt;/summary&gt;<br /></span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&nbsp; ///</span></span><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;"> </span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&lt;param name=&quot;child&quot;&gt;</span></span><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;">The item to be processed.</span></span></strong><strong><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&lt;/param&gt;<br /></span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&nbsp; ///</span></span><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;"> </span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&lt;returns&gt;</span></span></strong><strong><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;">The submitted item&#39;s parent, if available. Otherwise<br /></span></span><span style="font-size:x-small;color:#808080;"><span style="font-size:x-small;color:#808080;">&nbsp; ///</span></span><span style="font-size:x-small;color:#7a987a;"><span style="font-size:x-small;color:#7a987a;"> null.</span></span></strong><strong><span><span style="font-size:x-small;color:#808080;">&lt;/returns&gt;<br />&nbsp; </span><span style="font-size:x-small;color:#eaeaac;">public</span></span><span><span style="font-size:x-small;color:#dcdccc;"> </span><span style="font-size:x-small;color:#eaeaac;">static</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;">DependencyObject</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">GetParentObject</span></span><span><span style="font-size:x-small;color:#dcdccc;">(</span><span style="font-size:x-small;color:#eaeaac;">this</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;">DependencyObject</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">child</span></span></strong><strong><span><span style="font-size:x-small;color:#dcdccc;">)<br />&nbsp; {<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size:x-small;color:#eaeaac;">if</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> (</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">child</span></span><span><span style="font-size:x-small;color:#dcdccc;"> == </span><span style="font-size:x-small;color:#eaeaac;">null</span></span><span><span style="font-size:x-small;color:#dcdccc;">) </span><span style="font-size:x-small;color:#eaeaac;">return</span></span><span><span style="font-size:x-small;color:#dcdccc;"> </span><span style="font-size:x-small;color:#eaeaac;">null</span></span></strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>;</strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong> </strong></span></span></span></span>
<p><strong><span style="font-size:x-small;color:#7f9f7f;"><span style="font-size:x-small;color:#7f9f7f;">&nbsp;&nbsp;&nbsp; //handle content elements separately<br />&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;">ContentElement</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">contentElement</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> = </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">child</span></span><span><span style="font-size:x-small;color:#dcdccc;"> </span><span style="font-size:x-small;color:#eaeaac;">as</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;">ContentElement</span></span></strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>;</strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong> </strong></span></span></span></span></p>
<strong><span><span style="font-size:x-small;color:#eaeaac;">&nbsp;&nbsp;&nbsp; if</span><span style="font-size:x-small;color:#dcdccc;"> (</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">contentElement</span></span><span><span style="font-size:x-small;color:#dcdccc;"> != </span><span style="font-size:x-small;color:#eaeaac;">null</span></span></strong><strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">)<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;">DependencyObject</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">parent</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> = </span></span><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;">ContentOperations</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">.</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">GetParent</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">(</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">contentElement</span></span></strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>);</strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>&nbsp;</strong></span></span></span></span><strong><span><span style="font-size:x-small;color:#eaeaac;"><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if</span><span style="font-size:x-small;color:#dcdccc;"> (</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">parent</span></span><span><span style="font-size:x-small;color:#dcdccc;"> != </span><span style="font-size:x-small;color:#eaeaac;">null</span></span><span><span style="font-size:x-small;color:#dcdccc;">) </span><span style="font-size:x-small;color:#eaeaac;">return</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">parent</span></span></strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>;</strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>&nbsp;</strong></span></span></span></span><strong><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;"><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FrameworkContentElement</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">fce</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> = </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">contentElement</span></span><span><span style="font-size:x-small;color:#dcdccc;"> </span><span style="font-size:x-small;color:#eaeaac;">as</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;">FrameworkContentElement</span></span></strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>;</strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>&nbsp;</strong></span></span></span></span><strong><span><span style="font-size:x-small;color:#eaeaac;"><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return</span><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">fce</span></span><span><span style="font-size:x-small;color:#dcdccc;"> != </span><span style="font-size:x-small;color:#eaeaac;">null</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> ? </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">fce</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">.</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">Parent</span></span><span><span style="font-size:x-small;color:#dcdccc;"> : </span><span style="font-size:x-small;color:#eaeaac;">null</span></span></strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>;<br />&nbsp;&nbsp;&nbsp; }</strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong> </strong></span></span></span></span>
<p><strong><span style="font-size:x-small;color:#7f9f7f;"><span style="font-size:x-small;color:#7f9f7f;">&nbsp;&nbsp;&nbsp; //also try searching for parent in framework elements (such as DockPanel, etc)<br /></span></span><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;">&nbsp;&nbsp;&nbsp; FrameworkElement</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">frameworkElement</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> = </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">child</span></span><span><span style="font-size:x-small;color:#dcdccc;"> </span><span style="font-size:x-small;color:#eaeaac;">as</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;">FrameworkElement</span></span></strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>;</strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong> </strong></span></span></span></span></p>
<strong><span><span style="font-size:x-small;color:#eaeaac;">&nbsp;&nbsp;&nbsp; if</span><span style="font-size:x-small;color:#dcdccc;"> (</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">frameworkElement</span></span><span><span style="font-size:x-small;color:#dcdccc;"> != </span><span style="font-size:x-small;color:#eaeaac;">null</span></span></strong><strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">)<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;">DependencyObject</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">parent</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> = </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">frameworkElement</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">.</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">Parent</span></span></strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>;</strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>&nbsp;</strong></span></span></span></span><strong><span><span style="font-size:x-small;color:#eaeaac;"><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if</span><span style="font-size:x-small;color:#dcdccc;"> (</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">parent</span></span><span><span style="font-size:x-small;color:#dcdccc;"> != </span><span style="font-size:x-small;color:#eaeaac;">null</span></span><span><span style="font-size:x-small;color:#dcdccc;">) </span><span style="font-size:x-small;color:#eaeaac;">return</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">parent</span></span></strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong>;<br />&nbsp;&nbsp;&nbsp; }</strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"><strong> </strong></span></span></span></span>
<p><strong><span><span style="font-size:x-small;color:#7f9f7f;">&nbsp;&nbsp;&nbsp; //if it&#39;s not a ContentElement/FrameworkElement, rely on VisualTreeHelper<br />&nbsp;&nbsp;&nbsp; </span><span style="font-size:x-small;color:#eaeaac;">return</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"> </span></span><span style="font-size:x-small;color:#f0dfaf;"><span style="font-size:x-small;color:#f0dfaf;">VisualTreeHelper</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">.</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">GetParent</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">(</span></span><span style="font-size:x-small;color:#dfdfbf;"><span style="font-size:x-small;color:#dfdfbf;">child</span></span></strong><strong><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;">);<br />&nbsp; }<br />}</span></span><span style="font-size:x-small;color:#dcdccc;"><span style="font-size:x-small;color:#dcdccc;"></span></span></strong></p>
</p>
</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, February 24, 2010</h2><p>Great, thanks for the tip!&nbsp; I wasn&#39;t sure if InvokeMethod or the&nbsp;Execute class was the one to use.&nbsp; I used this code though to get the row I wanted, seems simplier to me:</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color:#808080;font-size:x-small;"><span style="color:#808080;font-size:x-small;"><font size="2" color="#808080"><font size="2" color="#808080">
<p>&nbsp;</p>
</font></font></span><font size="2" color="#808080">
<p>&nbsp;</p>
</font></span>
<p>&nbsp;</p>
<p><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">public</span></span><span style="color:#808080;font-size:x-small;"><span style="color:#808080;font-size:x-small;"> </span></span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">static</span></span><span style="color:#808080;font-size:x-small;"><span style="color:#808080;font-size:x-small;"> </span></span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">class</span></span><span style="color:#808080;font-size:x-small;"><span style="color:#808080;font-size:x-small;"> </span></span><span style="color:#2b91af;font-size:x-small;"><span style="color:#2b91af;font-size:x-small;">Extensions</span></span><span style="color:#808080;font-size:x-small;"><span style="color:#808080;font-size:x-small;"> {<font size="2" color="#808080"><font size="2" color="#808080">
<p>&nbsp;</p>
</font></font></span><font size="2" color="#808080">
<p>&nbsp;</p>
</font></span></p>
<p>&nbsp;</p>
<p><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">public</span></span><span style="color:#808080;font-size:x-small;"><span style="color:#808080;font-size:x-small;"> </span></span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">static</span></span><span style="color:#808080;font-size:x-small;"><span style="color:#808080;font-size:x-small;"> T GetParentElement&lt;T&gt;( </span></span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">this</span></span><span style="color:#808080;font-size:x-small;"><span style="color:#808080;font-size:x-small;"> </span></span><span style="color:#2b91af;font-size:x-small;"><span style="color:#2b91af;font-size:x-small;">DependencyObject</span></span><span style="color:#808080;font-size:x-small;"><span style="color:#808080;font-size:x-small;"> element ) </span></span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">where</span></span><span style="color:#808080;font-size:x-small;"><span style="color:#808080;font-size:x-small;"> T : </span></span><span style="color:#2b91af;font-size:x-small;"><span style="color:#2b91af;font-size:x-small;">DependencyObject</span></span><span style="color:#808080;font-size:x-small;"><span style="color:#808080;font-size:x-small;"> {<font size="2" color="#808080"><font size="2" color="#808080">
<p>T result = </p>
</font></font></span><font size="2" color="#808080">
<p>&nbsp;</p>
</font></span></p>
<p><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">null</span></span><span style="color:#808080;font-size:x-small;"><span style="color:#808080;font-size:x-small;">;<font size="2" color="#808080"><font size="2" color="#808080">
<p>&nbsp;</p>
</font></font></span><font size="2" color="#808080">
<p>&nbsp;</p>
</font></span></p>
<p>&nbsp;</p>
<p><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">if</span></span><span style="color:#808080;font-size:x-small;"><span style="color:#808080;font-size:x-small;"> ( element </span></span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">is</span></span><span style="color:#808080;font-size:x-small;"><span style="color:#808080;font-size:x-small;"> T ) {
<p>result = (T)element;</p>
<p>}</p>
<font size="2" color="#808080"><font size="2" color="#808080">
<p>&nbsp;</p>
</font></font></span><font size="2" color="#808080">
<p>&nbsp;</p>
</font></span></p>
<p>&nbsp;</p>
<p><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">else</span></span><span style="color:#808080;font-size:x-small;"><span style="color:#808080;font-size:x-small;"> </span></span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">if</span></span><span style="color:#808080;font-size:x-small;"><span style="color:#808080;font-size:x-small;"> ( element != </span></span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">null</span></span><span style="color:#808080;font-size:x-small;"><span style="color:#808080;font-size:x-small;"> ) {<font size="2" color="#808080"><font size="2" color="#808080">
<p>result = GetParentElement&lt;T&gt;( </p>
</font></font></span><font size="2" color="#808080">
<p>&nbsp;</p>
</font></span></p>
<p><span style="color:#2b91af;font-size:x-small;"><span style="color:#2b91af;font-size:x-small;">VisualTreeHelper</span></span><span style="color:#808080;font-size:x-small;"><span style="color:#808080;font-size:x-small;">.GetParent( element ) );
<p>}</p>
<font size="2" color="#808080"><font size="2" color="#808080">
<p>&nbsp;</p>
</font></font></span><font size="2" color="#808080">
<p>&nbsp;</p>
</font></span></p>
<p>&nbsp;</p>
<p><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">return</span></span><span style="color:#808080;font-size:x-small;"><span style="color:#808080;font-size:x-small;"> result;</span></span></p>
<p>}</p>
<p>}</p>
<p><span style="color:#000000;">Which i used like this:</span></p>
<p><span style="color:#000000;">var gridRow = source.GetParentElement&lt;DataGridRow&gt;();</span></p>
</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>triplea replied on Wednesday, February 24, 2010</h2><p>Thanks for that, its more readable and elegant.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, February 24, 2010</h2><p>Sadly it doesn&#39;t end up very readable on the forum...</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
