<html><header><title>Validation trouble</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Validation trouble</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10847.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>CrikeyMoses posted on Monday, November 07, 2011</h2><p>I am running Silverlight, CSLA 4.1, MVVM.</p>
<p>I have a simple class called &quot;Company&quot; which has a few properties and i implement the BusinessRules as follows:&nbsp;&nbsp;BusinessRules.AddRule(new Csla.Rules.CommonRules.Required(ContactPersonProperty));</p>
<p>My problem is that when i do a CREATE the validation on the &quot;Contact Person&quot; text box works fine, but when i do a FETCH I have to do a BusinessRules.CheckRules(); for any validation to fire. In addition to that once the validation has fired and i type something into the &quot;Contact Person&quot; text box and tab away, the little red border and error info stays there even tho i can see the correct value being passed and set in the SET method of &quot;ContactPersonProperty&quot;.</p>
<p>Can anyone please help me on this issue, or explain why this happens?</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Monday, November 07, 2011</h2><p>1. When you call fetch it is up to you (the developer) to decide if you consider the data in your database to be valid by default or to recheck business rules. </p>
<p>Also - when loading many rows of data it may cost a large amount of time to execute the validation rules. </p>
<p>2. Make sure that your property set method uses SetProperty. It is only <b>SetProperty </b>that will retrigger business rules and raise property changed to the ui. If your code uses <b>LoadProperty </b>then no business rules is run an no ProeprtyChanged is raised to notify ui.</p>
<p>If it still fails then make sure to upgrade to the latest version of CslaPropertyStatus from 4.2.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>CrikeyMoses replied on Monday, November 07, 2011</h2><p>Thanks guys, that worked a treat! And i now understand why i need to call the CheckRules, the other issue was that i was using LoadProperty and not SetProperty.</p>
<p>Thanks again.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>StefanCop replied on Monday, November 07, 2011</h2><p>If you have a&nbsp;base.DataPortal_Create()&nbsp;in your overriden method,&nbsp;the base method&nbsp;will invoke a BusinessRules.CheckRules(). </p>
<p>The DataPortal_Fetch on the other hand does not a CheckRules(), because it is assumed that values from database are correct. If&nbsp;this in your case is not true&nbsp;(ie. a web service) then your DataProtal_Fetch should invoke BusinessRules.CheckRules() to have again&nbsp;this initial vaildation. </p>
<p>The fact, that the validation error (red border) doesn&#39;t disappear indicates another problem. How do you set the CSLA property? Do you use SetProperty(), which raises the property changed event and thus runs business rules; or LoadProperty, which doesn&#39;t?</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
