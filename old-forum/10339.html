<html><header><title>CSLA’s notion of Edit Level and Infragistics Ultra WinGrid</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA’s notion of Edit Level and Infragistics Ultra WinGrid</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10339.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Lazaro posted on Wednesday, May 04, 2011</h2><p style="margin:0in 0in 10pt;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;">We are having an issue with CSLA&rsquo;s notion of Edit Level and Infragistics Ultra WinGrid.</span></span></p>
<p style="margin:0in 0in 10pt;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;">When we bind (through a binding source) a Business Collection (with items that have other collections) to a WinGrid, all the child and grandchild collections get also bound in inner bands (whether we want to show them or not). As soon as it gets bound, Infragistics WinGrid automatically activates the first row of the first band (calling IEditableObject.BeginEdit() on the row&rsquo;s object), as well as the first row of every child band of such activated row, and so on (every time a row gets activated the first row of all its child bands also get activated). For instance if we had three bands (Parent-Child-Grandchild) like the sample below, Infragistics will call BeginEdit() to rows <b style="mso-bidi-font-weight:normal;">1</b>, <b style="mso-bidi-font-weight:normal;">1.1</b>, and <b style="mso-bidi-font-weight:normal;">1.1.1</b> as soon as the grid gets bound, and, therefore, the three objects in such rows get BeginEdit() called.</span></span></p>
<p style="margin:0in 0in 0pt 0.25in;text-indent:-0.25in;mso-add-space:auto;mso-list:l0 level1 lfo1;" class="MsoListParagraphCxSpFirst"><b style="mso-bidi-font-weight:normal;"><span style="color:red;mso-fareast-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-size:small;font-family:Calibri;">1.</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span></b><b style="mso-bidi-font-weight:normal;"><span style="color:red;"><span style="font-size:small;"><span style="font-family:Calibri;">A</span></span></span></b></p>
<p style="margin:0in 0in 0pt 0.55in;text-indent:-0.3in;mso-add-space:auto;mso-list:l0 level2 lfo1;" class="MsoListParagraphCxSpMiddle"><b style="mso-bidi-font-weight:normal;"><span style="color:red;mso-fareast-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-size:small;font-family:Calibri;">1.1.</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp; </span></span></span></b><b style="mso-bidi-font-weight:normal;"><span style="color:red;"><span style="font-size:small;"><span style="font-family:Calibri;">A</span></span></span></b></p>
<p style="margin:0in 0in 0pt 0.85in;text-indent:-0.35in;mso-add-space:auto;mso-list:l0 level3 lfo1;" class="MsoListParagraphCxSpMiddle"><b style="mso-bidi-font-weight:normal;"><span style="color:red;mso-fareast-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-size:small;font-family:Calibri;">1.1.1.</span><span style="font:7pt &#39;Times New Roman&#39;;"> </span></span></span></b><b style="mso-bidi-font-weight:normal;"><span style="color:red;"><span style="font-size:small;"><span style="font-family:Calibri;">A</span></span></span></b></p>
<p style="margin:0in 0in 0pt 0.85in;text-indent:-0.35in;mso-add-space:auto;mso-list:l0 level3 lfo1;" class="MsoListParagraphCxSpMiddle"><span style="mso-fareast-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-size:small;font-family:Calibri;">1.1.2.</span><span style="font:7pt &#39;Times New Roman&#39;;"> </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">B</span></span></p>
<p style="margin:0in 0in 0pt 0.55in;text-indent:-0.3in;mso-add-space:auto;mso-list:l0 level2 lfo1;" class="MsoListParagraphCxSpMiddle"><span style="mso-fareast-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-size:small;font-family:Calibri;">1.2.</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">B</span></span></p>
<p style="margin:0in 0in 0pt 0.85in;text-indent:-0.35in;mso-add-space:auto;mso-list:l0 level3 lfo1;" class="MsoListParagraphCxSpMiddle"><span style="mso-fareast-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-size:small;font-family:Calibri;">1.2.1.</span><span style="font:7pt &#39;Times New Roman&#39;;"> </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">A</span></span></p>
<p style="margin:0in 0in 0pt 0.85in;text-indent:-0.35in;mso-add-space:auto;mso-list:l0 level3 lfo1;" class="MsoListParagraphCxSpMiddle"><span style="mso-fareast-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-size:small;font-family:Calibri;">1.2.2.</span><span style="font:7pt &#39;Times New Roman&#39;;"> </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">B</span></span></p>
<p style="margin:0in 0in 0pt 0.55in;text-indent:-0.3in;mso-add-space:auto;mso-list:l0 level2 lfo1;" class="MsoListParagraphCxSpMiddle"><span style="mso-fareast-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-size:small;font-family:Calibri;">1.3.</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">C</span></span></p>
<p style="margin:0in 0in 0pt 0.85in;text-indent:-0.35in;mso-add-space:auto;mso-list:l0 level3 lfo1;" class="MsoListParagraphCxSpMiddle"><span style="mso-fareast-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-size:small;font-family:Calibri;">1.3.1.</span><span style="font:7pt &#39;Times New Roman&#39;;"> </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">A</span></span></p>
<p style="margin:0in 0in 0pt 0.85in;text-indent:-0.35in;mso-add-space:auto;mso-list:l0 level3 lfo1;" class="MsoListParagraphCxSpMiddle"><span style="mso-fareast-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-size:small;font-family:Calibri;">1.3.2.</span><span style="font:7pt &#39;Times New Roman&#39;;"> </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">B</span></span></p>
<p style="margin:0in 0in 0pt 0.25in;text-indent:-0.25in;mso-add-space:auto;mso-list:l0 level1 lfo1;" class="MsoListParagraphCxSpMiddle"><span style="mso-fareast-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-size:small;font-family:Calibri;">2.</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">B</span></span></p>
<p style="margin:0in 0in 0pt 0.55in;text-indent:-0.3in;mso-add-space:auto;mso-list:l0 level2 lfo1;" class="MsoListParagraphCxSpMiddle"><span style="mso-fareast-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-size:small;font-family:Calibri;">2.1.</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">A</span></span></p>
<p style="margin:0in 0in 0pt 0.85in;text-indent:-0.35in;mso-add-space:auto;mso-list:l0 level3 lfo1;" class="MsoListParagraphCxSpMiddle"><span style="mso-fareast-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-size:small;font-family:Calibri;">2.1.1.</span><span style="font:7pt &#39;Times New Roman&#39;;"> </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">A</span></span></p>
<p style="margin:0in 0in 0pt 0.85in;text-indent:-0.35in;mso-add-space:auto;mso-list:l0 level3 lfo1;" class="MsoListParagraphCxSpMiddle"><span style="mso-fareast-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-size:small;font-family:Calibri;">2.1.2.</span><span style="font:7pt &#39;Times New Roman&#39;;"> </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">B</span></span></p>
<p style="margin:0in 0in 0pt 0.55in;text-indent:-0.3in;mso-add-space:auto;mso-list:l0 level2 lfo1;" class="MsoListParagraphCxSpMiddle"><span style="mso-fareast-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-size:small;font-family:Calibri;">2.2.</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">B</span></span></p>
<p style="margin:0in 0in 10pt 0.55in;text-indent:-0.3in;mso-add-space:auto;mso-list:l0 level2 lfo1;" class="MsoListParagraphCxSpLast"><span style="mso-fareast-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-size:small;font-family:Calibri;">2.3.</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">C</span></span></p>
<p style="margin:0in 0in 10pt;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;">When the EndEdit() gets called on the object in the first row of the first band (one case is when the user selects another row), Infragistics DO NOT call the EndEdit() on the object in the first row of the inner bands for which it previously called BeginEdit() [in the example above row 1.1 and 1.1.1]. Therefore, the child and grandchild objects in inner bands will have Edit Level greater than 0 when they should have been 0. That behavior is creating us problems because it generates an Edit Level mismatch.</span></span></p>
<p style="margin:0in 0in 10pt;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;">Can anyone point us in the right direction, or tell us any work around that you did to result the issue?</span></span></p>
<p style="margin:0in 0in 10pt;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;">Your help will be greatly appreciated.</span></span></p>
<p style="margin:0in 0in 10pt;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;">Lazaro Falcon</span></span></p>
<p><span style="font-size:11pt;line-height:115%;font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-ansi-language:EN-US;mso-fareast-language:EN-US;mso-bidi-language:AR-SA;">PS: We are using CSLA version 4.1.0 and Infragistics version 10.3</span></p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>simpleman replied on Tuesday, May 10, 2011</h2><p>Hi Lazaro,</p>
<p>We&#39;ve had the same problem with CSLA 3.6 and Infragisitcs version 10.3</p>
<p>I first tried it with&nbsp;Infragisitcs&nbsp;&nbsp;version 9.2 to check if that was the issue but it wasn&#39;t. &nbsp;</p>
<p>I found a solution by creating a BindingSource for each band and pointing each BindingSource to its parent.</p>
<p>For example:</p>
<p>Grid.DataSource =&nbsp;BindingSource1</p>
<p>BindingSource1.DataSouce = BusinessClass</p>
<p>for band 1</p>
<p>
<ul>
<li>BindingSource2.DataSource =&nbsp;BindingSource1</li>
<li>BindingSource2.DataMember =&nbsp;BindingSource1.BusinessClass.ChildList1</li>
</ul>
</p>
<p>for band 2</p>
<p>
<p>
<ul>
<li>BindingSource3.DataSource =&nbsp;BindingSource2</li>
<li>BindingSource3.DataMember =&nbsp;BindingSource2.Child.GrandchildList</li>
</ul>
</p>
<div>etc etc.</div>
<div></div>
<div>Hope this helps,</div>
<div></div>
<div>Nathan.</div>
</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Lazaro replied on Tuesday, May 10, 2011</h2><p style="margin:0in 0in 10pt;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;">Hi Nathan,</span></span></p>
<p style="margin:0in 0in 10pt;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;">Thank you very much for your help, I would like to tell you what I did to confirm that my approach is similar to what you did. In my case I have a child collection and every child has its own collection of children (grandchildren of the root object). I, as you suggested, created two binding sources (one for the children collection (Band 1) and another for the grandchildren collection (Band 2)) and as you can see in the following event I unbind the grandchild collection and rebind it again. This is working for me, but I would like to confirm with you because maybe you have a better solution implemented.</span></span></p>
<p style="margin:0in 0in 0pt;line-height:normal;" class="MsoNormal"><span style="font-size:10pt;font-family:Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">private</span>&nbsp;<span style="color:blue;">void</span>&nbsp;workUnitsBindingSource_CurrentChanged(<span style="color:blue;">object</span>&nbsp;sender,&nbsp;<span style="color:#2b91af;">EventArgs</span>&nbsp;e)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grandChildBindingSource.UnbindDataSource(<span style="color:blue;">true</span>,&nbsp;<span style="color:blue;">false</span>);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">LNRCWUTest</span>&nbsp;lnrCWUTest&nbsp;=&nbsp;((<span style="color:#2b91af;">BindingSource</span>)sender).Current&nbsp;<span style="color:blue;">as</span>&nbsp;<span style="color:#2b91af;">LNRCWUTest</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grandChildBindingSource.BindDataSource(lnrCWUTest.LNRTestsObj);</span></p>
<p style="margin:0in 0in 10pt;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p style="margin:0in 0in 10pt;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;">PS: The UnbindDataSource and BindDataSource are some of the common helper binding methods.</span></span></p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>simpleman replied on Thursday, May 12, 2011</h2><p>Hi Lazaro,</p>
<p>What you&#39;re describing in class structure sounds similar to the structure I&#39;m using. &nbsp;I have an editableRoot with an editable child list, and each of the items within that child list also contains a editable child &nbsp;list.</p>
<p>My editable root is bound to various text boxes etc and the child collection is bound to the grid to give the multiple bands. I have a binding source for my editable root and then a binding source for each band. &nbsp;So band(1) binding source is fed from the binding source of band(0) and band(0)&#39;s binding source is fed from the editable root binding source. &nbsp;I didn&#39;t have to add any additional code to as per your example as it all seems to work.</p>
<p>When I tested it my properties were edited by typing data direct into a cell and it was all fine. &nbsp;However this isn&#39;t how the data was going to be editing in the final solution, and the final solution gave me the same error again.</p>
<p>My child collection data is a list of word and excel files and the contents need to be managed via button clicks not by typing in text. &nbsp;Each of the bands was effectively read only in terms of editing the contents of a cell because I was using a button on each cell to select a file. &nbsp;Selection of the file would then populate properties in that class that are both hidden and displayed columns. &nbsp;Changing any of the properties via code was causing an edit level mismatch. &nbsp;I needed to ApplyEdit after I changed the properties via code to resolve that problem. &nbsp;</p>
<p>I am one for, if you&#39;ve found a solution that works go with it.</p>
<p>Nathan</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jmcphers replied on Monday, April 02, 2012</h2><p>Does anyone have a good solution to this issue?&nbsp; &quot;Lazaro&quot; has clearly stated the issue that I am experiencing regarding binding child and grandchild objects to the Infragistics Ultragrid.&nbsp; I have followed the recommendations regarding setting up the binding source by Simpleman:</p>
<p>&nbsp;</p>
<p style="padding-left:30px;"><i>I found a solution by creating a BindingSource for each band and pointing each BindingSource to its parent.</i></p>
<p style="padding-left:30px;"><i>For example:</i></p>
<p style="padding-left:30px;"><i>Grid.DataSource =&nbsp;BindingSource1</i></p>
<p style="padding-left:30px;"><i>BindingSource1.DataSouce = BusinessClass</i></p>
<p style="padding-left:30px;"><i>for band 1</i></p>
<blockquote>
<ul style="padding-left:30px;">
<li><i>BindingSource2.DataSource =&nbsp;BindingSource1</i></li>
<li><i>BindingSource2.DataMember =&nbsp;BindingSource1.BusinessClass.ChildList1</i></li>
</ul>
</blockquote>
<p style="padding-left:30px;"><i>for band 2</i></p>
<blockquote>
<ul style="padding-left:30px;">
<li><i>BindingSource3.DataSource =&nbsp;BindingSource2</i></li>
<li><i>BindingSource3.DataMember =&nbsp;BindingSource2.Child.GrandchildList</i></li>
</ul>
</blockquote>
<p>However I still receive edit mismatch errors on update and when applying an undo.&nbsp; I was not able to use the additioanl information regarding the UnbindDataSource methods as they appear to not be available (I am using CSLA 3.8 and not 4.1)</p>
<p style="margin:0in 0in 0pt;line-height:normal;padding-left:30px;" class="MsoNormal"><span style="font-size:10pt;font-family:Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">private</span>&nbsp;<span style="color:blue;">void</span>&nbsp;workUnitsBindingSource_CurrentChanged(<span style="color:blue;">object</span>&nbsp;sender,&nbsp;<span style="color:#2b91af;">EventArgs</span>&nbsp;e)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grandChildBindingSource.UnbindDataSource(<span style="color:blue;">true</span>,&nbsp;<span style="color:blue;">false</span>);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">LNRCWUTest</span>&nbsp;lnrCWUTest&nbsp;=&nbsp;((<span style="color:#2b91af;">BindingSource</span>)sender).Current&nbsp;<span style="color:blue;">as</span>&nbsp;<span style="color:#2b91af;">LNRCWUTest</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;grandChildBindingSource.BindDataSource(lnrCWUTest.LNRTestsObj);</span></p>
<p style="margin:0in 0in 10pt;padding-left:30px;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p style="margin:0in 0in 10pt;padding-left:30px;" class="MsoNormal"><span style="font-size:small;"><span style="font-family:Calibri;">PS: The UnbindDataSource and BindDataSource are some of the common helper binding methods.</span></span></p>
<p style="margin:0in 0in 10pt;" class="MsoNormal">Any help on this would be much appreciated as this is a critical for me.</p>
<p style="margin:0in 0in 10pt;" class="MsoNormal">Thanks in advance</p>
<p style="margin:0in 0in 10pt;" class="MsoNormal">Joe</p>
<p style="margin:0in 0in 10pt;padding-left:30px;" class="MsoNormal">&nbsp;</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
