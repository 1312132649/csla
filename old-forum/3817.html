<html><header><title>autosave</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>autosave</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3817.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>mtagliaf posted on Wednesday, October 31, 2007</h2><font face="Verdana" size="1">I would like to implement an Autosave capability into my CSLA application. I currently intend to use the BinaryFormatter to serialize the object to an Autosave folder. This will be hooked into the CSLA IsDirtyChanged event, I think.<br><br>When the object is saved to the database, I will delete the autosave file from disk.<br><br>When the application starts, I will check the Autosave folder, and "rehydrate" any files found there back into CSLA objects.<br><br>I have read about the potential versioning problems with the BinaryFormatter - I intend to ignore these issues for now - as the purpose of the autosaver is short-term storage only. Any exceptions I get in the </font><font face="Verdana" size="1">"rehydrate" process I will treat as failed Autosaves.<br><br>Does anyone see any other potential issues with this approach, or, better yet, has anyone ever done it and has code they would like to share? &lt;g&gt;<br><br>matt tag<br><br><br></font><font face="Verdana" size="1"><br><br></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, October 31, 2007</h2><P>Matt,</P>
<P>I wrote some code for this about 4 years ago.</P>
<P>Here the class that is saved to disk:<BR><BR><FONT size=2>&lt;Serializable()&gt; </FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> StartUpValues<BR></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> Server </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = "jfallon"<BR></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> DataBase </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = "myDB"<BR></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> Uid </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = "Joe"<BR>&lt;NonSerialized()&gt; </FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> Pwd </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = "fallon"<BR></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> ConnectionString </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = "someConnString"<BR></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> DBtype </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = "SQL Server"<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</P></FONT>
<P>Here is how I saved it as a "fake" encrytped&nbsp;.dll file:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> SaveValues()<BR></FONT><FONT color=#0000ff size=2>With</FONT><FONT size=2> objStartUp<BR></FONT><FONT size=2>&nbsp; .Server = </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.txtServer.Text<BR>&nbsp; .DataBase = </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.txtDatabase.Text<BR></FONT><FONT size=2>&nbsp; .Uid = </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.txtName.Text<BR>&nbsp; .Pwd = </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.txtPassword.Text<BR></FONT><FONT size=2>&nbsp; .ConnectionString = connString<BR>&nbsp; .DBtype = DBtype<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>With</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> CurDir </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String<BR></FONT><FONT size=2>CurDir = Environment.CurrentDirectory &amp; "\"<BR></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> myFileStream </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Stream = File.Create(CurDir &amp; "plainFileName.dll")<BR></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> serializer </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> BinaryFormatter<BR>serializer.Serialize(myFileStream, objStartUp)<BR>myFileStream.Close()<BR><BR></FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> File.Exists(CurDir &amp; "plainFileName.dll") </FONT><FONT color=#0000ff size=2>Then<BR></FONT><FONT color=#0000ff size=2>&nbsp; Dim</FONT><FONT size=2> objCrypto </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> Crypto<BR>&nbsp; objCrypto.EncryptFile(CurDir &amp; "plainFileName.dll", CurDir &amp; "FileName.dll")<BR>&nbsp; File.Delete(CurDir &amp; "plainFileName.dll")<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT>
<P>Then in a Startup form load method I have code like this to decrypt the file and read it:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> objStartUp </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> StartUpValues</FONT></P><FONT size=2><FONT size=2>
<P>objStartUp = GetStartUpValues()</P><FONT color=#0000ff size=2>
<P>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetStartUpValues() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> StartUpValues<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> objStartUp </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> StartUpValues<BR>&nbsp; <BR>&nbsp; </FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> File.Exists("FileName.dll") </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp; &nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> CurDir </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String<BR>&nbsp; &nbsp; </FONT><FONT size=2>CurDir = Environment.CurrentDirectory &amp; "\"<BR><BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> objCrypto </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> Crypto<BR>&nbsp; &nbsp; objCrypto.DecryptFile(CurDir &amp; "FileName.dll", CurDir &amp; "plainFileName.dll")<BR>&nbsp;&nbsp;&nbsp; objCrypto = </FONT><FONT color=#0000ff size=2>Nothing<BR><BR>&nbsp; &nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> myFileStream </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Stream = File.OpenRead("plainFileName.dll")<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> deserializer </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> BinaryFormatter<BR>&nbsp; &nbsp; objStartUp = </FONT><FONT color=#0000ff size=2>CType</FONT><FONT size=2>(deserializer.Deserialize(myFileStream), StartUpValues)<BR>&nbsp;&nbsp;&nbsp; myFileStream.Close()<BR>&nbsp; &nbsp; File.Delete(CurDir &amp; "plainFileName.dll")<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If<BR><BR>&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> objStartUp<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT></FONT></FONT>
<P><FONT size=2>&nbsp;</P>
<P></P></FONT>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tiago replied on Wednesday, October 31, 2007</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>JoeFallon1:</strong></div><div> 
<P>Matt,</P>
<P>I wrote some code for this about 4 years ago.</P>
<P>Here the class that is saved to disk:<BR></div></BLOCKQUOTE></P>
<P>Hi Joe Fallon,</P>
<P>I find this subject very interesting but my knowledge of VB is nil. I usually convert VB files to C# using SharpDevelop. But this only works if the VB source compiles all right. Using your post I made up the following files:</P>
<P><STRONG>StartUpValues.vb</STRONG></P><FONT size=2>
<P><FONT face="Courier New">&lt;Serializable()&gt; </FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT></FONT><FONT face="Courier New"><FONT size=2> StartUpValues<BR></FONT><FONT color=#0000ff size=2>&nbsp; Public</FONT><FONT size=2> Server </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT></FONT><FONT face="Courier New"><FONT color=#a31515 size=2>"jfallon"<BR></FONT><FONT color=#0000ff size=2>&nbsp; Public</FONT><FONT size=2> DataBase </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT></FONT><FONT face="Courier New"><FONT color=#a31515 size=2>"myDB"<BR></FONT><FONT color=#0000ff size=2>&nbsp; Public</FONT><FONT size=2> Uid </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT></FONT><FONT face="Courier New"><FONT color=#a31515 size=2>"Joe"<BR></FONT><FONT size=2>&nbsp; &lt;NonSerialized()&gt; </FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> Pwd </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT></FONT><FONT face="Courier New"><FONT color=#a31515 size=2>"fallon"<BR></FONT><FONT color=#0000ff size=2>&nbsp; Public</FONT><FONT size=2> ConnectionString </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT></FONT><FONT face="Courier New"><FONT color=#a31515 size=2>"someConnString"<BR></FONT><FONT color=#0000ff size=2>&nbsp; Public</FONT><FONT size=2> DBtype </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT></FONT><FONT face="Courier New"><FONT color=#a31515 size=2>"SQL Server"<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT></FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#000000 size=3><STRONG>StartupForm.vb</STRONG></FONT></FONT></P><FONT color=#0000ff size=2><FONT color=#000000 size=3><FONT color=#0000ff size=2>
<P><FONT face="Courier New">Imports</FONT></FONT><FONT face="Courier New"><FONT size=2> System.IO<BR></FONT><FONT color=#0000ff size=2>Imports</FONT></FONT><FONT face="Courier New"><FONT size=2> System.Runtime.Serialization.Formatters.Binary<BR><BR></FONT><FONT color=#0000ff size=2>&nbsp; Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT></FONT><FONT face="Courier New" size=2> StartupForm<BR></FONT><FONT face="Courier New" color=#008000 size=2>&nbsp; '<BR></FONT><FONT face="Courier New" color=#008000 size=2>&nbsp; 'Then in a Startup form load method I have code like this to decrypt the<BR>&nbsp;&nbsp;'file and read it:<BR>&nbsp; </FONT><FONT face="Courier New"><FONT color=#008000 size=2>'<BR></FONT><FONT color=#0000ff size=2>&nbsp; Private</FONT><FONT size=2> objStartUp </FONT><FONT color=#0000ff size=2>As</FONT></FONT><FONT face="Courier New"><FONT size=2> StartUpValues<BR>&nbsp; objStartUp = GetStartUpValues()<BR><BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetStartUpValues() </FONT><FONT color=#0000ff size=2>As</FONT></FONT><FONT face="Courier New"><FONT size=2> StartUpValues<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; Dim</FONT><FONT size=2> objStartUp </FONT><FONT color=#0000ff size=2>As</FONT></FONT><FONT face="Courier New"><FONT size=2> StartUpValues<BR><BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; If</FONT><FONT size=2> File.Exists(</FONT><FONT color=#a31515 size=2>"FileName.dll"</FONT><FONT size=2>) </FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>Then<BR><BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; &nbsp; Dim</FONT><FONT size=2> CurDir </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>String<BR></FONT><FONT size=2>&nbsp;&nbsp;&nbsp; &nbsp; CurDir = Environment.CurrentDirectory &amp; </FONT></FONT><FONT face="Courier New"><FONT color=#a31515 size=2>"\"<BR><BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; &nbsp; Dim</FONT><FONT size=2> objCrypto </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT></FONT><FONT face="Courier New"><FONT size=2> Crypto<BR>&nbsp;&nbsp;&nbsp; &nbsp; objCrypto.DecryptFile(CurDir &amp; </FONT><FONT color=#a31515 size=2>"FileName.dll"</FONT><FONT size=2>, CurDir &amp;</FONT><FONT color=#a31515 size=2>&nbsp;"plainFileName.dll"</FONT></FONT><FONT face="Courier New" size=2>)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; objCrypto = </FONT><FONT face="Courier New"><FONT color=#0000ff size=2>Nothing<BR><BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; &nbsp; Dim</FONT><FONT size=2> myFileStream </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Stream = File.OpenRead(</FONT><FONT color=#a31515 size=2>"plainFileName.dll"</FONT></FONT><FONT face="Courier New"><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; &nbsp; Dim</FONT><FONT size=2> deserializer </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT></FONT><FONT face="Courier New"><FONT size=2> BinaryFormatter<BR>&nbsp;&nbsp;&nbsp; &nbsp; objStartUp = </FONT><FONT color=#0000ff size=2>CType</FONT></FONT><FONT face="Courier New"><FONT size=2>(deserializer.Deserialize(myFileStream),&nbsp;StartUpValues)<BR>&nbsp;&nbsp;&nbsp; &nbsp; myFileStream.Close()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; File.Delete(CurDir &amp; </FONT><FONT color=#a31515 size=2>"plainFileName.dll"</FONT></FONT><FONT face="Courier New"><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; End</FONT><FONT size=2> </FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>If<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; Return</FONT></FONT><FONT face="Courier New"><FONT size=2> objStartUp<BR></FONT><FONT color=#0000ff size=2>&nbsp; End</FONT><FONT size=2> </FONT></FONT><FONT face="Courier New" color=#0000ff size=2>Function<BR></FONT><FONT face="Courier New" color=#008000 size=2>&nbsp; '<BR></FONT><FONT face="Courier New" color=#008000 size=2>&nbsp; 'Here is how I saved it as a "fake" encrytped .dll file:<BR></FONT><FONT face="Courier New"><FONT color=#008000 size=2>&nbsp; '<BR></FONT><FONT color=#0000ff size=2>&nbsp; Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT></FONT><FONT face="Courier New"><FONT size=2> SaveValues()<BR></FONT><FONT color=#0000ff size=2>&nbsp; &nbsp; With</FONT></FONT><FONT face="Courier New"><FONT size=2> StartupForm.objStartUp<BR>&nbsp; &nbsp;&nbsp;&nbsp; .Server = </FONT><FONT color=#0000ff size=2>Me</FONT></FONT><FONT face="Courier New"><FONT size=2>.txtServer.Text<BR>&nbsp; &nbsp; &nbsp; .DataBase = </FONT><FONT color=#0000ff size=2>Me</FONT></FONT><FONT face="Courier New"><FONT size=2>.txtDatabase.Text<BR>&nbsp; &nbsp; &nbsp; .Uid = </FONT><FONT color=#0000ff size=2>Me</FONT></FONT><FONT face="Courier New"><FONT size=2>.txtName.Text<BR>&nbsp; &nbsp;&nbsp;&nbsp; .Pwd = </FONT><FONT color=#0000ff size=2>Me</FONT></FONT><FONT face="Courier New"><FONT size=2>.txtPassword.Text<BR>&nbsp; &nbsp;&nbsp;&nbsp; .ConnectionString = connString<BR>&nbsp; &nbsp;&nbsp;&nbsp; .DBtype = DbType<BR></FONT><FONT color=#0000ff size=2>&nbsp; &nbsp; End</FONT><FONT size=2> </FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>With<BR><BR></FONT><FONT color=#0000ff size=2>&nbsp; &nbsp; Dim</FONT><FONT size=2> CurDir </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>String<BR></FONT><FONT size=2>&nbsp; &nbsp; CurDir = Environment.CurrentDirectory &amp; </FONT></FONT><FONT face="Courier New"><FONT color=#a31515 size=2>"\"<BR></FONT><FONT color=#0000ff size=2>&nbsp; &nbsp; Dim</FONT><FONT size=2> myFileStream </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Stream = File.Create(CurDir &amp; </FONT><FONT color=#a31515 size=2>"plainFileName.dll"</FONT></FONT><FONT face="Courier New"><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2>&nbsp; &nbsp; Dim</FONT><FONT size=2> serializer </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT></FONT><FONT face="Courier New"><FONT size=2> BinaryFormatter<BR>&nbsp; &nbsp; serializer.Serialize(myFileStream, objStartUp)<BR>&nbsp; &nbsp; myFileStream.Close()<BR><BR></FONT><FONT color=#0000ff size=2>&nbsp; &nbsp; If</FONT><FONT size=2> File.Exists(CurDir &amp; </FONT><FONT color=#a31515 size=2>"plainFileName.dll"</FONT><FONT size=2>) </FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>Then<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; &nbsp; Dim</FONT><FONT size=2> objCrypto </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT></FONT><FONT face="Courier New"><FONT size=2> Crypto<BR>&nbsp;&nbsp;&nbsp; &nbsp; objCrypto.EncryptFile(CurDir &amp; </FONT><FONT color=#a31515 size=2>"plainFileName.dll"</FONT><FONT size=2>, CurDir&nbsp;&amp;</FONT><FONT color=#a31515 size=2>&nbsp;"FileName.dll"</FONT></FONT><FONT face="Courier New"><FONT size=2>)<BR>&nbsp;&nbsp;&nbsp; &nbsp; File.Delete(CurDir &amp; </FONT><FONT color=#a31515 size=2>"plainFileName.dll"</FONT></FONT><FONT face="Courier New"><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2>&nbsp; &nbsp; End</FONT><FONT size=2> </FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>If<BR></FONT><FONT color=#0000ff size=2>&nbsp; End</FONT><FONT size=2> </FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>Sub<BR><BR>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</P>
<P></FONT></FONT></FONT></FONT>StartupForm.vb reports too many errors. Can you help me?</P>
<P>TIA</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Pawz replied on Wednesday, October 31, 2007</h2>I'd recommend finding &amp; using an online code converter - VB -&gt; C# is pretty simple though, if you just take a bit to learn the differences.<br><a href="http://www.harding.edu/fmccown/vbnet_csharp_comparison.html%20">VB C# Comparison</a> is one of my favorite references, although I came from VB to C#. <br><br>In any case, there's a converter you can use to convert code snippets here (I'm sure there's more, just noticed this on Telerik's site...):<br><a href="http://www.codechanger.com/"><br>http://www.codechanger.com/</a><br><br><br>With a bit of fiddling, I got this, although it's not quite right (converter doesn't seem to like the 'with' keyword in VB)<br><br>[Serializable()]<br>public class StartUpValues<br>{<br>&nbsp;&nbsp;&nbsp; public string Server = "jfallon";<br>&nbsp;&nbsp;&nbsp; public string DataBase = "myDB";<br>&nbsp;&nbsp;&nbsp; public string Uid = "Joe";<br>&nbsp;&nbsp;&nbsp; [NonSerialized()]<br>&nbsp;&nbsp;&nbsp; public string Pwd = "fallon";<br>&nbsp;&nbsp;&nbsp; public string ConnectionString = "someConnString";<br>&nbsp;&nbsp;&nbsp; public string DBtype = "SQL Server";<br>}<br><br>public class Convert<br>{<br>&nbsp;&nbsp;&nbsp; private void SaveValues()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;// ERROR: Not supported in C#: WithStatement<br><br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; string CurDir;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CurDir = Environment.CurrentDirectory + "\\";<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Stream myFileStream = File.Create(CurDir + "plainFileName.dll");<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; BinaryFormatter serializer = new BinaryFormatter();<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; serializer.Serialize(myFileStream, objStartUp);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; myFileStream.Close();<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (File.Exists(CurDir + "plainFileName.dll"))<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Crypto objCrypto = new Crypto();<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; objCrypto.EncryptFile(CurDir + "plainFileName.dll", CurDir + "FileName.dll");<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; File.Delete(CurDir + "plainFileName.dll");<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; private StartUpValues objStartUp;<br><br>&nbsp;&nbsp;&nbsp; &nbsp;objStartUp = GetStartUpValues();<br><br>&nbsp;&nbsp;&nbsp; public StartUpValues GetStartUpValues()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; StartUpValues objStartUp;<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (File.Exists("FileName.dll"))<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; string CurDir;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CurDir = Environment.CurrentDirectory + "\\";<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Crypto objCrypto = new Crypto();<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; objCrypto.DecryptFile(CurDir + "FileName.dll", CurDir + "plainFileName.dll");<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; objCrypto = null;<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Stream myFileStream = File.OpenRead("plainFileName.dll");<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; BinaryFormatter deserializer = new BinaryFormatter();<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; objStartUp = (StartUpValues)deserializer.Deserialize(myFileStream);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; myFileStream.Close();<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; File.Delete(CurDir + "plainFileName.dll");<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return objStartUp;<br>&nbsp;&nbsp;&nbsp; }<br>}<br><br>//=======================================================<br>//Service provided by Telerik (www.telerik.com)<br>//Conversion powered by NRefactory.<br>//Built and maintained by Todd Anglin and Telerik<br>//=======================================================<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, November 01, 2007</h2><P>It is sample code.</P>
<P>There is no Crypto class in the .Net framework - it is one of my utility classes that uses the .Net version. You should probably comment it out.</P>
<P>The idea was simply to write the file to disk, call it a .dll in case someone was poking around and if they opened it they would see "junk".</P>
<P>If all you want to do is save and retrieve values you do not need encryption.</P>
<P>Joe</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
