<html><header><title>Getting and Setting Dynamic Business Object Properties</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Getting and Setting Dynamic Business Object Properties</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11087.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>CrikeyMoses posted on Wednesday, January 25, 2012</h2><p>We are attempting to do an import from a file (Excel in my case).<br />I can parse the file fine and get the column headings and values fine, the issue is setting these values to the correct properties of the BO. Its hard to explain, maybe the following example of what we are trying to do might help.<br /><br />So i loop through the &nbsp;DictionaryEntry key\value pair i get back from the excel file, and want to assign this value to a property on my BO.<br /><br />Participant newPart = new Participant();<br />for (int currentRow = 1; currentRow &lt; datasource.Count(); currentRow++)<br />{<br />&nbsp; &nbsp;&nbsp;foreach (DictionaryEntry pair in datasource.ElementAt(currentRow))<br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;string col = colums[pair.Key].ToString(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// The Column or Properties<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; string value = pair.Value.ToString(); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// The Value to fill that Property<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Then using reflection, i get all the properties of the BO<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;foreach (System.Reflection.PropertyInfo property in typeof(Participant).GetProperties())<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (property.Name == col)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;
// IN HERE I WANT TO SET THE VALUE TO THE PROPERTY<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// I JUST DONT KNOW HOW TO GET THAT PROPERTY&nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;newPart.ParticipantId = value; &nbsp;// WHERE ParticipantId would be col<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}<br />&nbsp; &nbsp; &nbsp; }<br />}</p>
<p>If anyone understands what im trying to do here and can help it would be great!<br />Also let me know if you need any further info.&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Wednesday, January 25, 2012</h2><p>Don&#39;t you just want property.SetValue(newPart, value, null); ?&nbsp; (I think the third prop is an index for indexed properties if I remember right)</p>
<p>i.e. use the propertyinfo that you have.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Wednesday, January 25, 2012</h2><p>The simplest answer is to use MethodCaller (a hidden gem for reflection in Csla.Reflection namespace:</p>
<pre style="font-family:Consolas;background:#fafafa;color:black;font-size:13px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">for</span>&nbsp;(<span style="color:blue;">int</span>&nbsp;currentRow&nbsp;=&nbsp;1;&nbsp;currentRow&nbsp;&lt;&nbsp;<span style="color:red;">datasource</span>.Count();&nbsp;currentRow++)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:red;">Participant</span>&nbsp;newPart&nbsp;=&nbsp;<span style="color:blue;">new</span>&nbsp;<span style="color:red;">Participant</span>();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">foreach</span>&nbsp;(<span style="color:#2b91af;">DictionaryEntry</span>&nbsp;pair&nbsp;<span style="color:blue;">in</span>&nbsp;<span style="color:red;">datasource</span>.ElementAt(currentRow))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">string</span>&nbsp;col&nbsp;=&nbsp;<span style="color:red;">colums</span>[pair.Key].ToString();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:green;">//&nbsp;The&nbsp;Column&nbsp;or&nbsp;Properties</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">string</span>&nbsp;value&nbsp;=&nbsp;pair.Value.ToString();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:green;">//&nbsp;The&nbsp;Value&nbsp;to&nbsp;fill&nbsp;that&nbsp;Property</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:green;">//&nbsp;Then&nbsp;using&nbsp;reflection,&nbsp;i&nbsp;get&nbsp;all&nbsp;the&nbsp;properties&nbsp;of&nbsp;the&nbsp;BO</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong><span style="color:#2b91af;">MethodCaller</span>.CallPropertySetter(newPart,&nbsp;col,&nbsp;value);</strong>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</pre>
<pre style="font-family:Consolas;background:#fafafa;color:black;font-size:13px;">or if you are using managed properties and code is inside the BO:</pre>
<pre style="font-family:Consolas;background:#fafafa;color:black;font-size:13px;"><pre style="font-family:Consolas;background:#fafafa;color:black;font-size:13px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">public</span>&nbsp;<span style="color:blue;">void</span>&nbsp;FillValues(<span style="color:red;">columnDictionary</span>&nbsp;columns,&nbsp;<span style="color:red;">datasourceRow</span>&nbsp;element)
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">foreach</span>&nbsp;(<span style="color:#2b91af;">DictionaryEntry</span>&nbsp;pair&nbsp;<span style="color:blue;">in</span>&nbsp;element)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">string</span>&nbsp;col&nbsp;=&nbsp;<span style="color:red;">colums</span>[pair.Key].ToString();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:green;">//&nbsp;The&nbsp;Column&nbsp;or&nbsp;Properties</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">string</span>&nbsp;value&nbsp;=&nbsp;pair.Value.ToString();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:green;">//&nbsp;The&nbsp;Value&nbsp;to&nbsp;fill&nbsp;that&nbsp;Property</span>
 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">var</span>&nbsp;fieldInfo&nbsp;=&nbsp;FieldManager.GetRegisteredProperties().Where(p&nbsp;=&gt;&nbsp;p.Name&nbsp;==&nbsp;col).First();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoadProperty(fieldInfo,&nbsp;value);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}</pre>
</pre></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Wednesday, January 25, 2012</h2><p>You can also get the list of properties from the field manager. That will give you a collection of&nbsp;IPropertyInfo objects that include a property name property. Then you could use the non-generic LoadProperty method to load the properties. </p>
<p>The result should be very similar to what you&#39;d do to load the object from a normal database operation.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
