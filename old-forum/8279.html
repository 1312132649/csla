<html><header><title>Retrieve PropertyInfo object using property name</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Retrieve PropertyInfo object using property name</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8279.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>stuart.bale posted on Sunday, January 03, 2010</h2>This might be simple, but finding an answer has been tricky.<br><br>I have a situation where I need to find out if the value of a property has changed, so that I can add it to a list of 'changed properties'.<br><br>I've used the FieldManager to check if a field is dirty, using:<br><br>this.FieldManager.IsFieldDirty(myPropertyInfo);<br><br>However, this method only accepts a PropertyInfo object, and I need to determine if a property has changed from its string name.<br><br>Can anyone suggest how I could do this?<br><br>Thanks,<br><br>Stuart<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rxelizondo replied on Sunday, January 03, 2010</h2>I think you are going to need to get a reference to that PropertyInfo one way or another in order to do what you want.<br /><br />So here is a supper cheese solution:<br /><br />------------------------------------------<br /><br />public Csla.Core.IPropertyInfo GetPropInfoByName(string propName)<br />{<br />    switch (propName)<br />    {<br />        case "prop1":<br />            return prop1Property;<br /><br />        case "prop2":<br />            return prop1Property;<br /><br />        default:<br />        throw new ArgumentException("Prop name not valid");<br />    }<br />} <br /><br />------------------------------------------<br /><br />So now you can do:<br /><br />this.FieldManager.IsFieldDirty(GetPropInfoByName("ThePropName"));<br /><br />I didnâ€™t try very hard but I did a quick scan on the CSLA framework and did not find a way to get to the PropertyInfo collection. If there was a way to get to this collection, I guess you could just iterate through such collection searching for a PropertyInfo matching the property name that you are looking for and use that PropertyInfo object to call the FieldManager.IsFieldDirty() method. <br /><br />I am sure others will be able to come up with a much better solution!</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Monday, January 04, 2010</h2>Hi Stuart,<br><br>I'd suggest you create intermediate base classes that implements custom funtionality. Look at the MyCsla project on http://cslacontrib.codeplex.com for sample baseclasses. <br><br>Then you could add the following method:<br><br>&nbsp;&nbsp;&nbsp; [Browsable(false)]<br>&nbsp;&nbsp;&nbsp; public bool IsFieldDirty(string propertyName)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var propinfo = FieldManager.GetRegisteredProperties().Where(p =&gt; p.Name == propertyName).FirstOrDefault();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // if fieldname does not exist return false (or throw exception). <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (propinfo == null) return false;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return FieldManager.IsFieldDirty(propinfo);<br>&nbsp;&nbsp;&nbsp; }<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>stuart.bale replied on Wednesday, January 06, 2010</h2>Awesome Jonny - you're a STAR!<br><br>It's the GetRegisteredProperties that i was looking for.<br><br>For anyone else referencing this, here is the actual code:<br><br>&nbsp;var propinfo = this.FieldManager.GetRegisteredProperties().Find(p =&gt; p.Name == propertyName);<br><br>That totally does the trick :-).<br><br>Regards,<br><br>Stuart<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
