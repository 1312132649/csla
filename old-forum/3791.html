<html><header><title>Pulling my hair out for &quot;ArgumentException was unhandled!</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Pulling my hair out for &quot;ArgumentException was unhandled!</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3791.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>CyclingFoodmanPA posted on Saturday, October 27, 2007</h2><P>&nbsp;&nbsp;&nbsp; Has this happened to anyone before and what did you do?&nbsp; I am opening and closing forms and am executing the code in CloseWinPart.&nbsp; When I get to the line of code "panel.Controls.Remove(part); (am using C#) I get the message "ArgumentException was unhandled".&nbsp; Now, I don't get this for every form just a few.&nbsp; I have stepped through everything, for the forms that work and the ones that don't work and all looks similar, except for some give me the error.&nbsp; I have even trashed a form and started again and I still get the error.&nbsp; I have checked the methods GetIdValue in the WinPart of the form and GetIdValue in the BusinessObject and all is correct.&nbsp; Here is the information that is stored to clipboard when I get the error:</P>
<P>System.ArgumentException was unhandled<BR>&nbsp; Message="Cannot bind to the property or column Description on the DataSource.\r\nParameter name: dataMember"<BR>&nbsp; Source="System.Windows.Forms"<BR>&nbsp; ParamName="dataMember"<BR>&nbsp; StackTrace:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.BindToObject.CheckBinding()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.BindToObject.SetBindingManagerBase(BindingManagerBase lManager)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Binding.SetListManager(BindingManagerBase bindingManagerBase)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.ListManagerBindingsCollection.AddCore(Binding dataBinding)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.BindingsCollection.Add(Binding binding)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.BindingContext.UpdateBinding(BindingContext newBindingContext, Binding binding)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.UpdateBindings()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.OnBindingContextChanged(EventArgs e)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.OnParentBindingContextChanged(EventArgs e)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.OnBindingContextChanged(EventArgs e)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.set_BindingContextInternal(BindingContext value)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.ContainerControl.set_BindingContext(BindingContext value)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.ContainerControl.get_BindingContext()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.get_BindingContextInternal()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.get_BindingContext()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.UpdateBindings()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.OnBindingContextChanged(EventArgs e)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.OnParentBindingContextChanged(EventArgs e)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.OnBindingContextChanged(EventArgs e)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.AssignParent(Control value)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.ControlCollection.Remove(Control value)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at BASWin.MainForm.CloseWinPart(Object sender, EventArgs e) in D:\Visual Studio 2008\CSLA Framework\BAS\BASWin\MainForm.cs:line 311<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at BASWin.WinPart.Close() in D:\Visual Studio 2008\CSLA Framework\BAS\BASWin\WinPart.cs:line 74<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at BASWin.InventoryIndicatorEditForm.closeButton_Click(Object sender, EventArgs e) in D:\Visual Studio 2008\CSLA Framework\BAS\BASWin\Operations\Sources\InventoryIndicatorEditForm.cs:line 113<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.OnClick(EventArgs e)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Button.OnClick(EventArgs e)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.WndProc(Message&amp; m)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Button.WndProc(Message&amp; m)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG&amp; msg)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(Int32 dwComponentID, Int32 reason, Int32 pvLoopData)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.Run(Form mainForm)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at BASWin.Program.Main() in D:\Visual Studio 2008\CSLA Framework\BAS\BASWin\Program.cs:line 18<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ThreadHelper.ThreadStart_Context(Object state)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ThreadHelper.ThreadStart()<BR>&nbsp; InnerException: <BR></P>
<P>&nbsp;&nbsp;&nbsp; I have been battling with this for a couple of days and cannot figure it out.&nbsp; I have created other BusinessObjects and forms and they have been ok, and then created another set and got the error.&nbsp; Any ideas would be greatly appreciated.&nbsp; I have a feeling this is an "ah duh" error.&nbsp; It has got to be so simple that I am missing something.</P>
<P>&nbsp;&nbsp;&nbsp; Thank you in advance for your assistance if fixing this error!</P>
<P>Keith</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tbot155 replied on Friday, November 02, 2007</h2><P>You aren't alone. I've recently experienced the exact same error when using WinPart. My form was working fine, but for some reason now I'm getting the same exception at "panel.Controls.Remove(part)" (I'm using VB).</P>
<P>I'm also looking for a suggestion into what may be causing this. It's very frustrating...<BR></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tbot155 replied on Friday, November 02, 2007</h2><P>As luck would have, moments after my last previous post I stumbled upon the fix for my particular issue.</P>
<P>The problem I had was that the ErrorProvider on the form was not bound against the datasource. Check the ErrorProvider on your form, and make sure that it is bound to&nbsp;the same&nbsp;DataSource that the form is bound to.&nbsp; That fixed the problem on my end.<BR><BR>Good luck.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>CyclingFoodmanPA replied on Friday, November 02, 2007</h2><P>I knew it was an "ah duh".&nbsp; That was it!!&nbsp; It is those simple, obvious things that get me every time.</P>
<P>Keith</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Warren replied on Tuesday, April 08, 2008</h2><P>After reading Rocky's advice on building a UI using user controls instead of forms in chapter 9 I&nbsp;decided to model my UI on&nbsp;the PTracker model.&nbsp; </P>
<P>I am also "pulling my hair out" with this same problem and I don't understand the solution&nbsp;used by the others here to resolve it.&nbsp;&nbsp;I used CSLAGen to create my objects and they do not have a reference to ErrorProvider.</P>
<P>In&nbsp;CloseWinPart, the&nbsp;line: " P<FONT size=2>anel1.Controls.Remove(part) " generates the following exception.</P></FONT>
<P>&nbsp;</P>
<P><FONT size=1>System.ArgumentException was unhandled<BR>&nbsp; Message="Cannot bind to the property or column BankShortName on the DataSource. Parameter name: dataMember"<BR>&nbsp; ParamName="dataMember"<BR>&nbsp; Source="System.Windows.Forms"<BR>&nbsp; StackTrace:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.BindToObject.CheckBinding()&nbsp;&nbsp;&nbsp; at System.Windows.Forms.BindToObject.SetBindingManagerBase(BindingManagerBase lManager)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Binding.SetListManager(BindingManagerBase bindingManagerBase)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.ListManagerBindingsCollection.AddCore(Binding dataBinding)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.BindingsCollection.Add(Binding binding)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.BindingContext.UpdateBinding(BindingContext newBindingContext, Binding binding)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.UpdateBindings()&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.OnBindingContextChanged(EventArgs e)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.OnParentBindingContextChanged(EventArgs e)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.OnBindingContextChanged(EventArgs e)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.set_BindingContextInternal(BindingContext value)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.ContainerControl.set_BindingContext(BindingContext value)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.ContainerControl.get_BindingContext()&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.get_BindingContextInternal()&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.get_BindingContext()&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.UpdateBindings()&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.OnBindingContextChanged(EventArgs e)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.OnParentBindingContextChanged(EventArgs e)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.OnBindingContextChanged(EventArgs e)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.AssignParent(Control value)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.ControlCollection.Remove(Control value)&nbsp;&nbsp;&nbsp; at OffsetInterestWin.MainForm.CloseWinPart(Object sender, EventArgs e) in C:\Users\Warren\Documents\DOTNET\OffsetInterest\OffsetInterestWin\MainForm.vb:line 470&nbsp;&nbsp;&nbsp; at OffsetInterestWin.WinPart.Close() in C:\Users\Warren\Documents\DOTNET\OffsetInterest\OffsetInterestWin\WinPart.vb:line 56&nbsp;&nbsp;&nbsp; at OffsetInterestWin.BankEdit.CloseButton_Click(Object sender, EventArgs e) in C:\Users\Warren\Documents\DOTNET\OffsetInterest\OffsetInterestWin\BankEdit.vb:line 87&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.OnClick(EventArgs e)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Button.OnClick(EventArgs e)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.WndProc(Message&amp; m)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Button.WndProc(Message&amp; m)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG&amp; msg)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(Int32 dwComponentID, Int32 reason, Int32 pvLoopData)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.Run(ApplicationContext context)&nbsp;&nbsp;&nbsp; at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.OnRun()&nbsp;&nbsp;&nbsp; at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.DoApplicationModel()&nbsp;&nbsp;&nbsp; at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Run(String[] commandLine)&nbsp;&nbsp;&nbsp; at OffsetInterestWin.My.MyApplication.Main(String[] Args) in 17d14f5c-a337-4978-8281-53493378c1071.vb:line 81<BR>&nbsp; InnerException: <BR></FONT></P>
<P>Any help is greatly appreciated.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Warren replied on Wednesday, April 09, 2008</h2><P>I'm new to OOP, CSLA and CSLAGen and sometimes it is a bit overwhelming but I continue to make&nbsp; progress so I'm staying the course with CSLA.&nbsp;</P>
<P>Adding ErrorProvider also solved my problem - yipee.</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
