<html><header><title>CSLA v3.6 + DataGrid Help Desperatly Needed</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA v3.6 + DataGrid Help Desperatly Needed</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6131.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>AndrewBurns posted on Monday, January 12, 2009</h2>Hello all,<br><br>I have been searching the forums for the past two hours trying to fix my problem.&nbsp; I got it half fixed, but that extra mile is killing me and so I am reaching out in need.<br><br>I have an Invoice with line items.&nbsp; One binding source and a grid (DevExpress XtraGrid) for the line items.&nbsp; The grid is bound to DataSource=BindinSource DataMember="LineItems".<br><br>The original problem I had was when tabbing into the grid (Qty column first) it would ALWAYS eat the first key of every row.&nbsp; Thanks to the forums I got that fixed (Changing child properties after it was added to the collection in AddNewCore) and the first line enters as expected now.<br><br>The problem is on addition lines.&nbsp; As soon as I tab out of the first column (Qty) it will reposition my selection to the first row; however the row I just added is in the correct place (bottom of the list). But because the selection has changed I can not continue to enter data.<br><br>I have been pulling my hair out changing settings and code to no avail, can someone give me some insight?<br><br>Thank you so much in advance!<br>Andrew<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AndrewBurns replied on Thursday, January 15, 2009</h2>Polite bump.<br><br>I have contacted Developer Express and they basically said unless you can reproduce the issue in this sample solution we have provided then we don't care.&nbsp; Has no one ran across this issue?<br><br>Thank you,<br>Andrew<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tetranz replied on Thursday, January 15, 2009</h2><P>I don't have a solution but have you tried reproducing the problem with a bare bones demo app, preferably using regular .NET objects rather than CSLA?&nbsp; If you could do that and demonstrate that the standard MS DataGridView works and their grid doesn't then that would be harder for them to ignore.</P>
<P>It sounds like something to do with bubbling up ListChanged events from the collection to the root. That causes problems. See <A HREF="/forums/thread/24802.aspx">http://forums.lhotka.net/forums/thread/24802.aspx</A>&nbsp;When you tab out of Qty, if you've changed the value then that causes PropertyChanged on the child, ListChanged on the collection and then, if you're bubbling events and fire a PropertyChanged on the root, the way Windows databinding works is that it refreshes every property on the root including the collections. That means your grid then gets a ListChanged, reset event. Maybe that's what's making the grid go back to the first row.</P>
<P>Are you bubbling up ListChanged events from the line items to cause a ProperlyChanged event in the invoice?&nbsp; If you are then you probably shouldn't do that.&nbsp; I guess it's hard to avoid if you want changes in the line items to update a total or something in the invoice.</P>
<P>Of course, all that might be completely irrelevent.</P>
<P>Ross<BR></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AndrewBurns replied on Thursday, January 15, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>tetranz:</strong></div><div><p>Are you bubbling up ListChanged events from the line items to cause a ProperlyChanged event in the invoice?&nbsp; If you are then you probably shouldn't do that.&nbsp; I guess it's hard to avoid if you want changes in the line items to update a total or something in the invoice.</p></div></BLOCKQUOTE><br><br>Ross,<br><br>Thank you SOOO much, that is EXACTLY what it was.&nbsp; I feel slightly stupid now as I read over and over in the forums about WinForms databinding acting stupid be for some stupid 'forest for the trees' reason I did not think it applied to me.&nbsp; I disabled all the code I had to update totals and such on the main invoice and it worked as expected!&nbsp; Now that I know what the cause is I can get a work around in place.<br><br>Thank you again!<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tetranz replied on Thursday, January 15, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>AndrewBurns:</strong></div><div>Thank you SOOO much, that is EXACTLY what it was.</div></BLOCKQUOTE><br>I'm happy to have helped <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /><br><br>It made me look at my recent code where I'm doing exactly what you're doing with an order / invoice type object and collection. ListChanged on the collection triggers a recalculate of some totals which updates properties on the root. I'm using the Janus grid and that seems to work okay. I guess it preserves the row position when it gets a ListChanged reset.<br><br>I did notice something that I'll report in another thread. A change to a child property seems to create two ListChanged events rather than one. If you're using the latest CSLA, I think where possible it's better to use ChildChanged instead of ListChanged. That only occurs once.<br><br>I wonder what happens now if you change a property on your root? Does the grid return to the top?<br><br>Ross<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
