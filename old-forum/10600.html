<html><header><title>MVVM How do I Set Focus on TextBox?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>MVVM How do I Set Focus on TextBox?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10600.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonM posted on Monday, August 08, 2011</h2><p>So I&#39;m using Silverlight / CSLA 4.1 with a BxF setup.&nbsp; When I call a add method on my ViewModel is creates a new object and the databinding works well for updating the UI.&nbsp; The only issue is I need to focus on the main textbox.&nbsp; Any idea on how to get this done or if CSLA or BxF have help for this?&nbsp; The problem I see is that the ViewModel doesn&#39;t know anything about the UI and the UI is only databound to the ViewModel.&nbsp; Is there anyway to use this binding to set the focused control?</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Monday, August 08, 2011</h2><p>This is tricky. To be pure MVVM, you need something in the XAML that binds to a property of the viewmodel, and when the property value changes, then the thing in XAML sets the focus.</p>
<p>There is not (to my knowledge) any such thing in Silverlight XAML. WPF has a focus manager component - though I don&#39;t think it is powerful enough to solve this either.</p>
<p>In at least one project, I created a component to do this. I think I made it an attached property, but I don&#39;t remember for sure. In any case, it did what I describe here. It had a property that could be bound to a viewmodel property. When the viewmodel property was set to a certain value, my component set the focus in the UI.</p>
<p>Unfortunately I don&#39;t remember whether this was for a client project, or a CSLA demo, or a talk I did at VS Live - so I&#39;m not sure where to find that code :(</p>
<p>On the positive side, it wasn&#39;t hard code. Writing a UI control or attached property is not hard - especially if all it does is call the Focus method when a property changes.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MichelRenaud replied on Tuesday, August 09, 2011</h2><p>Off the top of my head - and keep in mind that I&#39;m now just starting with MVVM: When your viewmodel handles the add method, it could dispatch a message that&#39;s handled by the view (basically telling the view &quot;that field - whatever control it is - should have the focus&quot;).&nbsp; The view can then do whatever it has to to give the textbox focus.&nbsp; The viewmodel then has no knowledge of the underlying UI.</p>
<p>As to how to set the focus in Silverlight, that I do not know.&nbsp; I only use WPF.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
