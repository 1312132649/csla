<html><header><title>Old School Error</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Old School Error</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4853.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>TestCSLA posted on Thursday, May 15, 2008</h2>I use CSLA 3.5 and I'm having ZERO problems.&nbsp; However, I've got an OLD program using CSLA 1 - and in moving that program to another machine I'm running into a problem.<br><br>My problem is ONLY when I attempt to use remoting.&nbsp; Basically I'm not hitting the database at all.&nbsp; I have some old notes and made sure that I unchecked "Enable Integrated Windows Authentication" in IE 6.&nbsp; I also made sure I selected "Anonymous" in IIS.<br><br>My code breaks right after in the Dataportal after the line:<br>MPortal = New Server.Dataportal<br><br>The DBA has confirmed I'm NEVER hitting the database.&nbsp; Now this code hasn't changed in about three years so I know its not the code, but some type of setting.<br><br>I can hit the Oracle database using TOAD - so I know my tnsnames.ora file is correct.&nbsp; I would like to know how CSLA finds the .ora file since I don't reference it anywhere in my code (could that be the problem - some type of Oracle setting?).<br><br>If anyone can help me out with setting to check concerning:<br>1) References (all seem to be set correctly)<br>2) IIS Settings<br>3) Oracle settings<br>4) Long shots<br>5) Internet Explorer<br><br>Thanks in advance.<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Yang replied on Thursday, May 15, 2008</h2>I believe oracle will look for the tnsnames file in the Network\Admin folder found in the path specified by ORACLE_CLIENT user environment variable. If you are running IIS as a system account, you are better off by overwriting this by creating a TNS_ADMIN system environment variable that is the absolute path to your tnsnames.ora file.<br><br>Good luck!<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TestCSLA replied on Thursday, May 15, 2008</h2>I can connect to Oracle using Oracle's SQL Developer.&nbsp; My problem is CSLA isn't getting the proper connection string.&nbsp; Do you know where I can set a breakpoint in CSLA to see exactly where its trying to obtain the connection information from the tnsnames.ora file?&nbsp;&nbsp;  &nbsp;&nbsp;  <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Yang replied on Thursday, May 15, 2008</h2>Are you using the connectionStrings settings in your app.config/web.config? Are you using ODP.NET or Microsoft's oracle provider?<br><br>It is not possible to set a breakpoint to figure out what it is getting from the tns names but you should be able to set a breakpoint to where you define and instantiate the OracleConnection object. The connection string can be passed to the constructor of the OracleConnection object.  Or you create the OracleConnection using the parameterless constructor then assign a connectionString afterwards.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TestCSLA replied on Thursday, May 15, 2008</h2>&nbsp;&nbsp;&nbsp; Yes, I'm using connection strings in web.config - which simply state to use a specific db in the .ora file.<br><br>Everything is going to the dbhelper just fine, but I don't think it is actually accessing the .ora file.&nbsp; Someone suggested to allow "EVERYONE" complete access to my Oracle/Ora92 directory.&nbsp; I'll tell you if that works.&nbsp;&nbsp;  &nbsp; <br><br>I've run into similar problems in the past and they are always related to&nbsp; settings on the machine (specifically IIS or IE).&nbsp; I just can't figure out&nbsp; which setting on this machine is the problem.<br><br>Last bit of info that might be helpful - does it matter what version of DBHelper I'm using?&nbsp; About three months ago they updated all the Oracle DB's to 10.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Yang replied on Thursday, May 15, 2008</h2>I am not familiar with the DBHelper but it should not be a problem.&nbsp; Have you updated the Oracle DB Driver in your IIS server machine? Although the driver of Oracle 9 should work still with 10.&nbsp; Can you post a stack trace of the exception?<br><br>Have you tried adding the TNS_ADMIN system environment variable? IIS user usually does not know where to find the tnsnames.ora. After adding this, you need to restart IIS for the change to take effect.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, May 15, 2008</h2><P>I supported Oracle for years with CSLA.</P>
<P>The only thing I had in my config file was:</P><FONT color=#000000>
<P><FONT size=2>&lt;add key="ConnectionString" value="data source=SomeOracleService;uid=someuser;password=apassword" /&gt;</FONT></P>
<P><FONT size=2>I used Oracle tools to create SomeOracleService and then made sure I could connect using the ID and Pwd above. Then everything worked fine. I don't recall having anything try to read the tnsnames.ora file directly. The creation of the Service does that.</FONT></P>
<P><FONT size=2>Joe</FONT></P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TestCSLA replied on Thursday, May 15, 2008</h2>&nbsp;&nbsp;&nbsp; VICTORY!!!<br><br>The dba's just told me they stopped using ORACLE 9i and went to 10g.&nbsp; I installed 10g and all is well.<br><br>Thanks for your help!<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Yang replied on Thursday, May 15, 2008</h2>Joe,<br><br>I am not familiar with your approach. We have been using Oracle for years too and the way we connect is to have a tnsnames.ora file that is reachable by the Oracle Provider. We use the same connection string as you specified. The data source is the one configured in the tnsnames.ora file. We are not reading the tnsnames.ora file directly. By setting the TNS_ADMIN environment variable, we are instructing the provider to get the tnsnames.ora from the specified location. The TNS_ADMIN is especially helpful when the user is a system user/IIS User.<br><br>Regards,<br>Yang<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, May 16, 2008</h2><P>Yang,</P>
<P>I think we are&nbsp;doing the same thing. The Oracle tools are installed on the server so that it can talk to the DB. The data source is configured in tnsnames.ora file using Oracle tools. Then prove you can connecto from that server to the DB using Oracle tools. Then the connection string should work fine.</P>
<P>I never had to do anything with environment variables though. Not sure about IIS permissions - I may have granted them so long ago I forgot about it.</P>
<P>Joe</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
