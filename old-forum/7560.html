<html><header><title>MyCsla on CslaContrib</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>MyCsla on CslaContrib</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7560.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee posted on Wednesday, September 02, 2009</h2>Hi folks, <br><br>I've just put MyCsla for 3.6.3 and never (also 3-6-3-N2) on the CslaContrib site. <a href="http://cslacontrib.codeplex.com%20">http://cslacontrib.codeplex.com </a><br><br>The purpose is to give a combined Best Practice and extension points where we can all contribute with utility/helper classes, validation rules, components and more. <br><br><span>Best Practice</span><br>As a lot of you already has done - I have added my own baseclasses with extension points for logging/trace and a small sample of how to add/alter functionality without making modifications to Csla itself. <br><br>As for usage - I prefer to add this project as part of my solution as this make it easier to extend Csla inside my app and make all my BOs inherit from these baseclasses. <br><br>Also included are:<br><span>Validation Rules </span><br><ul><li>Generic (IComparable) rules for GreaterThan, GreaterThanOrEqual, LessThan, LessThanOrEgual that compares two property values</li></ul><span>Custom Windows Controls </span><br><ul><li>StatusBarExtender with my implementation of wait animation and an animated splash after 2 seconds.</li><li>SmartDateTimePicker - also accepts text input like +, -, t, y&nbsp; (all these texts are defines in Csla resources and translated)</li><li>BindableRadioButtons - Radio buttons that support databind, typically for use with 2-5 items</li><li>ErrorWarnInfoProvider - Slightly reworked version of the one already available on CslaContrib</li></ul>And a sample app that demonstrates the custom windows controls. <br><br>The namespace is simply MyCsla and uses the same folder names as Csla. To download the code goto the<span> Source Code </span>tab and select Download. <br><br>I am posting this message on both the Csla.Net dicussions and CslaContrib discussion. Please post reponses concerning code/submissions in the CslaContrib forum. <br><br>I have volunteered to step up as overall coordinator of the CslaContrip and hope that we can tune up on more activity in this project. If you want to share som code/classes please join codeplex and send me info (as per home page on the project) or send me email with info about your code and I can post it. <br><br>Pleas note: The CslaContrib project uses the <a href="http://creativecommons.org/licenses/by/2.5/">Creative Commons Attribution 2.5 </a>license.<br><br>Hope you find this useful and want to contribute more code. <br><br>/jonnybee<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tiago replied on Wednesday, September 02, 2009</h2><P>Hi Jommybee,</P>
<P>I just read your message and didn't have time to look at your work. Csla is great but controls make everything so much easier... </P>
<P>I'm working on a Csla control: <BR><FONT face="Courier New">CslaComboBox<BR></FONT><FONT face="Courier New"><FONT size=2>[</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Description</FONT></FONT><FONT size=2>(</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"Csla NVL ready ComboBox."</FONT></FONT><FONT size=2>)]</FONT></FONT> <BR>Requirements:<BR>- proper ReadOnly state<BR>- bind to master object and to Csla NVL<BR>- Csla NVL using key of int32 and value of string (for id to description/name conversion and back)<BR>New properties<BR><FONT face="Courier New">public bool ReadOnly<BR>public BindingSource MasterBindingSource<BR>public Csla.NameValueListBase&lt;Int32, String&gt; CslaNameValueList</FONT></P>
<P>Are you working on something like that?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, September 03, 2009</h2>Hi Tiago,<br><br>Is it a Windows Forms control you are working on? <br><br>Standard ComboBox supports nearly all your requirements: <br><ul><li> DataSource = NameValueList instance</li><li>ValueMember = "Key"</li><li>DisplayMember = "Value"</li><li>SelectedValue =&gt; databound to masterobject.Property<br></li></ul>Use the ComboxTasks on the ComboBox to just get to these values for databound mode. <br><br>And use the Csla.Windows.ReadWriteAuthorizationManager to control whether combobox will be disabled/enabled based upon if user does not have permission to read/change  the property. RWA asks the BO methods CanWriteProperty and CanReadProperty.<br><br>No, I am not working on a control like this - standard ComboBox works fine for my apps in databound mode.<br><br>See here too: <br><a href="http://windowsclient.net/blogs/faqs/archive/2006/07/12/what-are-the-displaymember-and-valuemember.aspx">http://windowsclient.net/blogs/faqs/archive/2006/07/12/what-are-the-displaymember-and-valuemember.aspx&nbsp; </a>and I also highly recommend reading the <a href="http://www.windowsclient.net/Samples/Go%20To%20Market/Data%20Binding/DataBinding%20FAQ.doc">DataBinding FAQ</a> and <a href="http://www.windowsclient.net/Samples/Go%20To%20Market/DataGridView/DataGridView%20FAQ.doc">DataGridView FAQ</a><br><br>/jonnybee<br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>reagan123 replied on Thursday, September 03, 2009</h2>Thanks for doing this.&nbsp; I look forward to giving it a shot and seeing what all is available.<br><br>Thanks again.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tiago replied on Friday, September 04, 2009</h2><P><FONT face=Arial>Hi jonnybee,</FONT></P>
<P><FONT face=Arial>I'm talking about WinForms controls.</FONT></P>
<P><FONT face=Arial>Unfortunately ComboBox control has no ReadOnly property. There are a lot of solutions like having a TextBox on the same position and sizer and display it as ReadOnly when you want a ReadOnly ComboBox.</FONT></P>
<P><FONT face=Arial>Why do I want a CslaNvlComboBox?</FONT></P>
<P><FONT face=Arial>I read an int property from the database but I want to display the user name on the UI, on a ComboBox. So&nbsp;I make a BindingSource where the ID is the key and the Name is the value. Next I use a couple of events to convert from ID to Name and back like this:</FONT></P>
<P><FONT color=#008000><FONT color=#008000><FONT face="Courier New"><FONT color=#000000>...<BR></FONT>// add a DataBinding to Sender<BR></FONT></FONT></FONT><FONT face="Courier New">SenderNVLBindingSource.DataSource = </FONT><FONT color=#2b91af><FONT face="Courier New" color=#2b91af>UserNVL</FONT></FONT><FONT face="Courier New">.GetUserNVL();<BR></FONT><FONT face="Courier New"><FONT color=#0000ff><FONT color=#0000ff>var</FONT></FONT> senderBinding = <FONT color=#0000ff><FONT color=#0000ff>new</FONT></FONT> <FONT color=#2b91af><FONT color=#2b91af>Binding</FONT></FONT>(<FONT color=#a31515><FONT color=#a31515>"Text"</FONT></FONT>, DocBindingSource, <FONT color=#a31515><FONT color=#a31515>"SenderID"</FONT></FONT>, <FONT color=#0000ff><FONT color=#0000ff>true</FONT></FONT></FONT><FONT face="Courier New">);<BR></FONT><FONT face="Courier New">senderBinding.Format += OnUserFieldFormat;<BR></FONT><FONT face="Courier New">senderBinding.Parse += OnUserFieldParse;<BR></FONT><FONT face="Courier New">SenderComboBox.DataBindings.Add(senderBinding);<BR>...</FONT></P><FONT size=2>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff><FONT color=#0000ff>private</FONT></FONT> <FONT color=#0000ff><FONT color=#0000ff>void</FONT></FONT> OnUserFieldParse(<FONT color=#0000ff><FONT color=#0000ff>object</FONT></FONT> sender, <FONT color=#2b91af><FONT color=#2b91af>ConvertEventArgs</FONT></FONT></FONT><FONT face="Courier New"> e)<BR></FONT><FONT face="Courier New">{<BR></FONT><FONT face="Courier New"><FONT color=#0000ff><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;var</FONT></FONT> newUserID = <FONT color=#2b91af><FONT color=#2b91af>UserNVL</FONT></FONT></FONT><FONT face="Courier New">.GetUserNVL().Key(e.Value.ToString());<BR></FONT><FONT color=#0000ff><FONT face="Courier New" color=#0000ff>&nbsp;&nbsp;&nbsp;if</FONT></FONT><FONT face="Courier New"> (newUserID != 0)<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;{<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.Value = newUserID;<BR></FONT><FONT color=#0000ff><FONT face="Courier New" color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return</FONT></FONT><FONT face="Courier New">;<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;}<BR></FONT><FONT color=#0000ff><FONT color=#0000ff><FONT face="Courier New">&nbsp;&nbsp;&nbsp;try<BR></FONT></FONT></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;{<BR></FONT><FONT face="Courier New"><FONT color=#0000ff><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if</FONT></FONT> (!<FONT color=#0000ff><FONT color=#0000ff>string</FONT></FONT>.IsNullOrEmpty(<FONT color=#2b91af><FONT color=#2b91af>UserNVL</FONT></FONT>.GetUserNVL().Value(<FONT color=#2b91af><FONT color=#2b91af>Convert</FONT></FONT></FONT><FONT face="Courier New">.ToInt32(e.Value))))<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.Value = e.Value.ToString();<BR></FONT><FONT color=#0000ff><FONT face="Courier New" color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return</FONT></FONT><FONT face="Courier New">;<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;}<BR></FONT><FONT face="Courier New"><FONT color=#0000ff><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;catch</FONT></FONT> (<FONT color=#2b91af><FONT color=#2b91af>FormatException</FONT></FONT></FONT><FONT face="Courier New"> ex)<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;{<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;}<BR></FONT><FONT face="Courier New"><FONT color=#0000ff><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;throw</FONT></FONT> <FONT color=#0000ff><FONT color=#0000ff>new</FONT></FONT> <FONT color=#2b91af><FONT color=#2b91af>Exception</FONT></FONT>(<FONT color=#a31515><FONT color=#a31515>"Invalid input: "</FONT></FONT></FONT><FONT face="Courier New"> + e.Value);<BR></FONT><FONT face="Courier New">}</FONT></P>
<P><FONT face="Courier New"><FONT color=#0000ff><FONT color=#0000ff>private</FONT></FONT> <FONT color=#0000ff><FONT color=#0000ff>void</FONT></FONT> OnUserFieldFormat(<FONT color=#0000ff><FONT color=#0000ff>object</FONT></FONT> sender, <FONT color=#2b91af><FONT color=#2b91af>ConvertEventArgs</FONT></FONT></FONT><FONT face="Courier New"> e)<BR></FONT><FONT face="Courier New">{<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;e.Value = </FONT><FONT face="Courier New"><FONT color=#2b91af><FONT color=#2b91af>UserNVL</FONT></FONT>.GetUserNVL().Value((<FONT color=#0000ff><FONT color=#0000ff>int</FONT></FONT></FONT><FONT face="Courier New">)e.Value);<BR></FONT><FONT face="Courier New">}</FONT></P>
<P><FONT face=Arial>The problem is that I don't want't to write the same code over and over again for every ComboBox on the form (and there can be quite a few...).</FONT></P>
<P><FONT face=Arial>That's why I want a control that does all this work for me.</FONT></P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Sunday, September 06, 2009</h2>Hi, <br><br>The ComboBox does link to/from an ID with databinding. And set <span><span class="selflink">DropDownStyle to </span></span><span><span class="selflink">ComboBoxStyle.</span></span><span><span class="selflink">DropDownList</span></span> and AutoCompletMode to Suggest to give the user autcompletion on valid items int the list only.<br><br>I guess you could make a subclass of ComboBox that just accepts default databinding with a ReadOnly property and override the IsInputKey method and KeyDown event to make the control not accept any editing.<br><br>/jonnybee<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
