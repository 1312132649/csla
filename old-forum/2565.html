<html><header><title>Email Common Validation Rule</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Email Common Validation Rule</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2565.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>gdk9am posted on Tuesday, March 20, 2007</h2><P>If I have a BO with</P><FONT size=2>
<P>ValidationRules.AddRule(</FONT><FONT color=#2b91af size=2>CommonRules</FONT><FONT size=2>.RegExMatch, </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>CommonRules</FONT><FONT size=2>.</FONT><FONT color=#2b91af size=2>RegExRuleArgs</FONT><FONT size=2>(</FONT><FONT color=#a31515 size=2>"ContactEmail"</FONT><FONT size=2>, </FONT><FONT color=#2b91af size=2>CommonRules</FONT><FONT size=2>.</FONT><FONT color=#2b91af size=2>RegExPatterns</FONT><FONT size=2>.Email));</FONT></P>
<P><FONT size=2>in it </FONT></P>
<P><FONT size=2>It makes it impossible to save a record without an email address. </FONT></P>
<P><FONT size=2>A blank email address is still valid.</FONT></P>
<P><FONT size=2>Has anyone come across this before and do they have a solution ?</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, March 21, 2007</h2><P>I'm sure you could create a regular expression to allow that by taking the Email one in CommonRules and adding an option that says an empty string is also valid.</P>
<P>Or you could use rule short-circuiting, though that could be fragile.</P>
<P>Or you could create a custom rule that encapsulates the concept. Somewhat like:</P>
<P>&nbsp; Private Shared Function CheckEmail(Of T As OrderInfo)( _<BR>&nbsp;&nbsp;&nbsp; ByVal target As T, ByVal e As Csla.Validation.RuleArgs) As Boolean</P>
<P>&nbsp;&nbsp;&nbsp; If String.IsNullOrEmpty(target._customer) Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return True</P>
<P>&nbsp;&nbsp;&nbsp; Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim emailRule As New Csla.Validation.RuleHandler( _<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddressOf Csla.Validation.CommonRules.RegExMatch)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim args As New Csla.Validation.CommonRules.RegExRuleArgs( _<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.PropertyName, Validation.CommonRules.RegExPatterns.Email)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim result As Boolean = emailRule.Invoke(target, args)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not result Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.Description = args.Description<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.Severity = args.Severity<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.StopProcessing = args.StopProcessing<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return result<BR>&nbsp;&nbsp;&nbsp; End If</P>
<P>&nbsp; End Function<BR></P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bowman74 replied on Wednesday, March 21, 2007</h2><P>Whoops misread that one.&nbsp; I'd do a custom validation rule as Rocky indicated.</P>
<P>Thanks,</P>
<P>Kevin</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
