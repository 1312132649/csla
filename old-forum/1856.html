<html><header><title>Subclassing and validation rules</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Subclassing and validation rules</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1856.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>mr_lasseter posted on Tuesday, November 28, 2006</h2>I have subclassed the BusinessBase and am having problems with the validation rules in a class that inherits from the subclassed BusinessBase. My code is below.<br><br>MyBusinessBase:<br>Public MustInherit Class MyBusinessBase(Of T As MyBusinessBase(Of T)) : Inherits Csla.BusinessBase(Of T)<br><br>Class that inherits MyBusinessBase<br>Public Class MyClass : Inherits MyBusinessBase(Of MyClass)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Protected Overrides Sub AddBusinessRules()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.ValidationRules.AddRule(AddressOf Validation.CommonRules.StringRequired, "MyString")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Sub<br><br>End Class<br><br>The comliper is giving me an error on the line where I add the validation rule (I am using Csla 2.1).<br>The error is<br>"Overload resolution failed because no accessible 'AddRule' can be called with these arguments:<br>&nbsp;&nbsp;&nbsp; 'Public Sub AddRule(Of T, R As Csla.Validation.RuleArgs)(handler As Csla.Validation.RuleHandler(Of T, R), args As R)': Type parameter 'T' for 'Public Sub AddRule(Of T, R As Csla.Validation.RuleArgs)(handler As Csla.Validation.RuleHandler(Of T, R), args As R)' cannot be inferred.<br>&nbsp;&nbsp;&nbsp; 'Public Sub AddRule(handler As Csla.Validation.RuleHandler, args As Csla.Validation.RuleArgs)': Method 'Public Function StringRequired(target As Object, e As Csla.Validation.RuleArgs) As Boolean' does not have the same signature as delegate 'Delegate Function RuleHandler(target As Object, e As Csla.Validation.RuleArgs) As Boolean'.<br>&nbsp;&nbsp;&nbsp; 'Public Sub AddRule(handler As Csla.Validation.RuleHandler, args As Csla.Validation.RuleArgs)': Value of type 'String' cannot be converted to 'Csla.Validation.RuleArgs'.<br>&nbsp;&nbsp;&nbsp; 'Public Sub AddRule(Of T)(handler As Csla.Validation.RuleHandler(Of T, Csla.Validation.RuleArgs), propertyName As String)': Type parameter 'T' for 'Public Sub AddRule(Of T)(handler As Csla.Validation.RuleHandler(Of T, Csla.Validation.RuleArgs), propertyName As String)' cannot be inferred.<br>&nbsp;&nbsp;&nbsp; 'Public Sub AddRule(handler As Csla.Validation.RuleHandler, propertyName As String)': Method 'Public Function StringRequired(target As Object, e As Csla.Validation.RuleArgs) As Boolean' does not have the same signature as delegate 'Delegate Function RuleHandler(target As Object, e As Csla.Validation.RuleArgs) As Boolean'. "<br><br>Anyone have any idea what I am doing wrong?<br><br>Thanks,<br>Mike<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mr_lasseter replied on Tuesday, November 28, 2006</h2><P>Nevermind , it had something to do with their references.&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
