<html><header><title>Binding Business Object on Textbox Control?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Binding Business Object on Textbox Control?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/985.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>brembot posted on Wednesday, August 23, 2006</h2><font face="Tahoma">I have encountered a problem when binding my object to a textbox. What happened is when i edit the textbox and press TAB control for the next textbox, you have pressed it twice. I tried to trace the problem and found out that <font color="#0000ff">ValidationRules <font color="#000000">that cause the problem. When i removed it and it's working fine. You don't have to press the TAB twice in order to go the next control.<br><br>Have anyone has an idea how to resolve this issue co'z i would like some of my properties have ValidationRules?<br><br>Thanks<br></font></font></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, August 23, 2006</h2>It sounds like something in your validation rules might be throwing an exception.&nbsp; What are your rules?&nbsp; What does your property setter look like for the property which is bound to the text box?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, August 23, 2006</h2>It is likely that your code is throwing an exception - at least on the first TAB - and this exception causes data binding to lock the user on the control. Presumably that first TAB exception is somehow resolved before the second TAB is pressed (it is probably a null reference exception or something) and so the second TAB works.<br><br>The root of the issue is that data binding swallows/hides these exceptions, making debugging difficult. You'll have to put a debug breakpoint in the property set code and step through it to find the exception so you can resolve it.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brembot replied on Wednesday, August 23, 2006</h2><font face="Tahoma"><font size="2">Hello Rocky,<br><br>I've fixed the problem by replacing the </font><font color="#0000ff" size="2">PropertyHasChanged</font><font size="2"> to </font><font color="#0000ff"><font size="2">MarkDirty. </font><font color="#000000"><font size="2">I know that </font><font color="#0000ff" size="2">PropertyHasChanged</font><font size="2"> call these methods </font><font color="#000080" size="2">MarkDirty</font><font size="2">, </font><font color="#000080" size="2">CheckRules </font><font size="2">and </font><font color="#000080" size="2">OnPropertyChanged</font><font size="2">.<br><br>These are my codes:<br>......<br><br>&nbsp;&nbsp;&nbsp; Public Property Address() As String<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CanReadProperty(True)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return mAddress<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As String)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CanWriteProperty(True)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not mAddress.Equals(value) Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mAddress = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>&nbsp;&nbsp;&nbsp; Public Property TelNo() As String<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CanReadProperty(True)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return mTelNo<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As String)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CanWriteProperty(True)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not mTelNo.Equals(value) Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mTelNo = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>&nbsp;&nbsp;&nbsp; Public Property FaxNo() As String<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CanReadProperty(True)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return mFaxNo<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As String)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CanWriteProperty(True)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not mFaxNo.Equals(value) Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mFaxNo = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br></font>....<br><br><font size="2">&nbsp;Protected Overrides Sub AddBusinessRules()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '// TODO: add validation rules<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ValidationRules.AddRule(AddressOf CommonRules.StringRequired, "Address")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ValidationRules.AddRule(AddressOf CommonRules.StringMaxLength, New CommonRules.MaxLengthRuleArgs("Address", 50))<br><br>&nbsp;&nbsp;&nbsp; End Sub<br><br><br>What happened is this... As you have notice that i only have one <font color="#000080">ValidationRules </font>and that's for Address. When i try to modify the Address (bounded textbox) and press TAB or Position the mouse to the next control, it works fine because i have implemented a <font color="#000080">ValidationRules</font> for this property but for those properties that doesn't have ValidationRules. I notice that when change the focus to the next control it will try to validate just because i implemented the <font color="#000080">PropertyHasChanged</font>. In that case, i have to press TAB or Position the mouse twice to get the focus of the next control.<br><br>Any ideas how to solve this issue Or do we have to implement <font color="#0000ff">MarkDirty</font>, <font color="#0000ff">CheckRules <font color="#000000">separately </font></font>just like we did in CSLA 1.53?<br><br>Thanks<br><br><br></font></font></font></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Wednesday, August 23, 2006</h2>Any chance you're using the first release of 2.1 that rocky made some time ago? That one had that problem because it was throwing null reference exceptions sometimes when attempting to validate.<br><br>In any case, adding an error provider to the form and binding it to the binding source, might show you what the problem is...<br><br>Andrés<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brembot replied on Wednesday, August 23, 2006</h2><font face="Tahoma" size="2">Hello </font><font face="Tahoma" size="2">Andrés</font><font face="Tahoma" size="2">, <br><br>You are right... I'm using the first release of CSLA 2.1. Maybe i will to use the previous version CSLA 2.0.3 to see the difference. Thanks for the info...<br><br>Cheers,<br>Marlon<br><br><br><br><br></font></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
