<html><header><title>CslaAuthentication and the DataPortal</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CslaAuthentication and the DataPortal</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5470.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius posted on Thursday, September 25, 2008</h2>I'm trying to grasp an understanding of CslaAuthentication.&nbsp; If I understand correctly (which I very well may not), with CslaAuthentication set to "Csla", the DataPortal will always use the Csla.ApplicationContext.User for authorization....<br><br>If this is true, then I am confused on something: In the PTracker project, the PTPrincipal calls the Login Factory method of the PTIdentity just before the Csla.ApplicationContect.User is even set.&nbsp; Naturally, this would invoke the DataPortal, so how does it not get kicked out?<br><br>Thanks for any help in advance.<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, September 25, 2008</h2><P>Csla.ApplicationContext.User is always valid, regardless of the CslaAuthentication setting.</P>
<P>If CslaAuthentication is "Windows" then CSLA does nothing with to set or manipulate the principal, but Csla.ApplicationContext.User will still provide access to the current .NET principal.</P>
<P>If CslaAuthentication is "Csla" then CSLA will transfer the principal to the app server on every data portal call. Csla.ApplicationContext.User provides access to the current .NET principal.</P>
<P>In version 3.5 or older the data portal has exactly one requirement: the custom principal must inherit from Csla.Security.BusinessPrincipalBase. It doesn't care if the principal is authenticated or not, just that it inherit from that base class.</P>
<P>So all you need to do is call Logout() (usually) to set the principal to a <EM>valid but unauthenticated</EM> principal, and the data portal will work.</P>
<P>In version 3.6+ the data portal no longer cares how you create your principal, as long as it is serializable. This version introduces the ability for you to provide a method that is invoked, on the server, for every data portal call, and that method can authenticate each call as you see fit. The default implementation allows all calls.</P>
<P>So in 3.6+ you usually don't even need to call Logout(), because the .NET default GenericPrincipal will work fine flowing through the data portal. This should eliminate one of the primary FAQs on this forum :)</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius replied on Friday, September 26, 2008</h2>fabulous.&nbsp; that clears up all my confusion!&nbsp; thanks yet again Rocky.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
