<html><header><title>How do you set the ParentId to a new Child?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How do you set the ParentId to a new Child?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7242.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>superkuton posted on Wednesday, July 08, 2009</h2>I have the following objects:<br><br>- Student Object (EditableRoot)<br>&nbsp;&nbsp; -&nbsp; ContactAddressList (Editable Child List)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -&nbsp; ContactAddress (Editable Child)<br><br><br>I implemented an AddnewCore override, and set the AllowNew = True in the private constructor.<br>My problem is in the creation of the child object. In my code, I have the following:<br><br>..........<br>&nbsp;Private Overloads Sub Child_Create()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LoadProperty(Of Integer)(IDProperty, -1)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>LoadProperty(Of Guid)(ParentIDProperty, ?HOW?)</b><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LoadProperty(Of String)(OtherProperty, defaultvalue)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ValidationRules.CheckRules()<br>&nbsp;&nbsp;&nbsp; End Sub<br>...............<br>&nbsp;&nbsp;&nbsp; Private Sub Child_Insert()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Using ctx = ContextManager(...)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If IsSelfDirty Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ctx.DataContext.ContactAddressInsert( _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ReadProperty(Of Integer)(IDProperty), _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ReadProperty(Of Guid)(ParentIDProperty), _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ReadProperty(Of String)(OtherProperty))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Using<br>&nbsp;&nbsp;&nbsp; End Sub<br><br><br>How can I set the ParentID reference?<br>Thanks.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Vinodonly replied on Wednesday, July 08, 2009</h2>First of all the Child_Insert will auto pass the parent object.. So you can use that object to get key... See PTTracker for that...<br /><br />I don't think you need the parent property in Child_Create<br /><br />But if that is the case then you can use this.Parent to get reference for parent object and then set the appropriate property.. <br /><br />You might have to cast it to the proper type before using..</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>superkuton replied on Wednesday, July 08, 2009</h2>Thank you for helping me again vinodonly.<br><br>I have the following db tables:<br><br><ol><li>Person (PersonIntID, ProfileGUID, etc.)<br></li><li>Organization (OrganizationIntID, ProfileGUID, etc.)<br></li><li>ContactAddress (ContactAddressIntID, ProfileGUID, etc)<br></li><li>ContactNumber (ContactNumberIntID, ProfileGUID, etc)<br></li><li>ContactPerson (ContactPersonIntID, ProfileGUID, etc)</li></ol><br>IntIDs are primary, identity keys. The GUIDs served as the foreign keys to the Contact... tables (3,4,5).<br><br>I have created the Person and Organization separately because they have different field requirements. I used the GUIDs to "connect" them to the Contact... tables. Therefore, they are not automatically assigned by any db relationship. I don't know if this was a good design, but I simply avoided the creation of another set of (3) Contact... tables.<br><br>The contact business objects are managed by an editable root (PersonContact) object. The Contact... tables are all editable child collection objects.<br><br>In my UI, I present the PersonContactEditDialog where the PersonContact is "read-only" because it is managed by another object/context/form. The 3 Contact... objects are presented in 3 datagridviews which are all editable and set to allownew and so on.<br><br>---<br>First, if there is a better db design that you can suggest, I'd be glad to re-structure the db tables as of this early stage of development.<br><br>Second, (please read on), how do I use the<b> this.parent</b>? Are there better ways or techniques to manage the parent and children biz objects?<br><br>Third, are there better options to present them in a UI?<br><br>---<br>As you can observe, I am totally in-charge of the whole application design and development as this is just a pro-bono work for our school.<br><br>Please help me, In doing so, you are also helping our school and all of our students.<br><br>Thank you.<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Vinodonly replied on Wednesday, July 08, 2009</h2>Actually this forum is for CSLA so I beleive here CSLA related questions should be asked..<br /><br />I went through your msg quickly and here are some points but it is better to get some books and/or some training to clear the basic concepts..<br /><br />1. There are varied opinions on using GUID or int, both can be used for setting foreign key relation. Study this more and then you can decide..<br /><br />2.  Pls re-chk if really you will be having multiple Addresses or Multiple Phone Nos ? Maybe you just need one address or maybe 2 phone nos. In that case, you can simplify your db structure.<br /><br />3. this.parent will give you the ref of the parent object. From all csla child objects this is is avl. So you can use it to get the parent key.<br /><br />Pls look at the tracker sample, you will understand how it is used..<br /><br /></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
