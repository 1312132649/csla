<html><header><title>Beginner BXF / CSLA question DoRefresh / BeginRefresh</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Beginner BXF / CSLA question DoRefresh / BeginRefresh</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9722.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>nhwilly posted on Sunday, November 07, 2010</h2><p>Hey, guys.&nbsp; I know I am still writing in VB and that&#39;s probably a problem, but I&#39;m trying to build a test app using my own data to match the BXF example SLDemo.&nbsp; I am using WPF instead of SL, and I am using some Codesmith templates to make this happen.</p>
<p>What I can&#39;t seem to do is get the BeginRefresh to work.&nbsp; DoRefresh is fine.&nbsp; I know, there&#39;s supposed to be a handler on the end, but for the life of me i can&#39;t seem to build it.&nbsp; Usually I can work through stuff like this, but this one is driving me nuts.&nbsp; </p>
<p>It looks like BeginRefresh needs a handler, but the C# sample code does a
 BeginRefresh with just a factory method string.&nbsp; How is it working for 
C# and not VB?</p>
<p>Here&#39;s the Business method:</p>
<p><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Public Shared Sub NewNHApplicationAsync(ByVal handler As EventHandler(Of DataPortalResult(Of NHApplication)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim dp As New DataPortal(Of NHApplication)()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddHandler dp.CreateCompleted, handler<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dp.BeginCreate()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Sub</b></p>
<p>And here&#39;s the code in the viewmodel:</p>
<p><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Public Sub New()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Shell.Instance.ShowStatus(New Status() With { _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .Text = &quot;Creating new application&quot;, _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .IsBusy = True _<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; })<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BeginRefresh(&quot;NewNHApplicationAsync&quot;)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Sub<br /></b></p>
<p>Naturally, since the signature is different I get the No Such Factory Method error.</p>
<p>I guess I just don&#39;t&nbsp; know the syntax to make this work.</p>
<p>The lack of parity between VB and C# events and other stuff is hard to work through, so I guess I&#39;&#39;m going to have to man up and learn C#, but VB is simply easier for me to read, so I&#39;ve tried to stick with it.</p>
<p>Anybody have any example code for VB?</p>
<p>Pretty please?</p>
<p>TIA</p>
<p>p.s. Yes, I have the SL video series and the MVVM series, too.&nbsp; But it&#39;s all in C#.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Sunday, November 07, 2010</h2><p>I don&#39;t see the problem to be honest - your method signature looks correct. I tried the same basic thing and it works.</p>
<p>Here&#39;s my business class</p>
<pre style="font-family:consolas;"><span style="color:blue;">Imports</span>&nbsp;Csla<br /><span style="color:blue;">Imports</span>&nbsp;Csla.Serialization<br /> <br />&lt;<span style="color:#2b91af;">Serializable</span>()&gt;<br /><span style="color:blue;">Public</span>&nbsp;<span style="color:blue;">Class</span>&nbsp;<span style="color:#2b91af;">Class1</span><br />&nbsp;&nbsp;<span style="color:blue;">Inherits</span>&nbsp;<span style="color:#2b91af;">BusinessBase</span>(<span style="color:blue;">Of</span>&nbsp;<span style="color:#2b91af;">Class1</span>)<br /> <br />&nbsp;&nbsp;<span style="color:blue;">Public</span>&nbsp;<span style="color:blue;">Shared</span>&nbsp;<span style="color:blue;">Sub</span>&nbsp;NewClass1(<span style="color:blue;">ByVal</span>&nbsp;callback&nbsp;<span style="color:blue;">As</span>&nbsp;<span style="color:#2b91af;">EventHandler</span>(<span style="color:blue;">Of</span>&nbsp;<span style="color:#2b91af;">DataPortalResult</span>(<span style="color:blue;">Of</span>&nbsp;<span style="color:#2b91af;">Class1</span>)))<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">DataPortal</span>.BeginCreate(<span style="color:blue;">Of</span>&nbsp;<span style="color:#2b91af;">Class1</span>)(callback)<br />&nbsp;&nbsp;<span style="color:blue;">End</span>&nbsp;<span style="color:blue;">Sub</span><br /><span style="color:blue;">End</span>&nbsp;<span style="color:blue;">Class</span></pre>
<p>&nbsp;Here&#39;s my viewmodel:</p>
<pre style="font-family:consolas;"><span style="color:blue;">Imports</span>&nbsp;Csla.Xaml<br /><span style="color:blue;">Imports</span>&nbsp;SilverlightClassLibrary1<br /> <br /><span style="color:blue;">Public</span>&nbsp;<span style="color:blue;">Class</span>&nbsp;<span style="color:#2b91af;">Class1Vm</span><br />&nbsp;&nbsp;<span style="color:blue;">Inherits</span>&nbsp;<span style="color:#2b91af;">ViewModel</span>(<span style="color:blue;">Of</span>&nbsp;<span style="color:#2b91af;">Class1</span>)<br /> <br />&nbsp;&nbsp;<span style="color:blue;">Public</span>&nbsp;<span style="color:blue;">Sub</span>&nbsp;<span style="color:blue;">New</span>()<br />&nbsp;&nbsp;&nbsp;&nbsp;BeginRefresh(<span style="color:blue;">AddressOf</span>&nbsp;<span style="color:#2b91af;">Class1</span>.NewClass1)<br />&nbsp;&nbsp;<span style="color:blue;">End</span>&nbsp;<span style="color:blue;">Sub</span><br /><span style="color:blue;">End</span>&nbsp;<span style="color:blue;">Class</span><br /></pre>
<p>For a simple test I set the ProxyTypeName to &quot;Local&quot; so creation occured on the client - but the viewmodel invoked the factory, which ran the data portal and gave me back a model.</p>
<p>I think this is the same as you code?</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>nhwilly replied on Monday, November 08, 2010</h2><p>Rocky, thanks for the quick reply.</p>
<p>I believe I got stuck and then was trying too many different approaches at once and overlapping the attempts - classic deer in the headlights.</p>
<p>Your code worked perfectly and when I went back and tried a fetch in my code, which required parameters to be passed, I got stumped again, although I know this is my own lack of knowledge.&nbsp; </p>
<p>I then attempted both new and fetch operations with strings instead of the delegate and it works fine.</p>
<p>I&#39;ll find some sample delegate code that handles parameter passing and hopefully that will do it.</p>
<p>Would it be of any help if I translated the SLDemo code into VB?</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, November 08, 2010</h2><p>Just remember that the callback parameter is always last, and that the root data portal only allows one paramter:</p>
<p>DataPortal.BeginFetch(Of Customer)(id, callback)</p>
<p>goes to a server-side method like this:</p>
<p>Public Sub DataPortal_Fetch(ByVal id As Whatever)</p>
<p>as long as &quot;Whatever&quot; is a serializable type (in Silverlight this means IMobileObject).</p>
<p>I am always happy to accept contributions like a VB version of the C# samples, absolutely! Send me email directly (rocky at lhotka dot net) and I&#39;ll get you a contributor agreement if you are interested in doing that.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
