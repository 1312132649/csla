<html><header><title>How to convert a business object to a string using Stringbuilder</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How to convert a business object to a string using Stringbuilder</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3558.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>yimiqi posted on Monday, September 17, 2007</h2><P>You can convert a dataset or dataview to a tab, comma or any character separated string using StringBuilder, as follows (a comma separated string in this example):</P><FONT color=#000000 size=3>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim StrObj As New System.Text.StringBuilder</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim aCol As DataColumn<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For Each aCol In srcDataView.Table.Columns<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StrObj.Append(aCol.ColumnName)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StrObj.Append(",")<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim aRow As DataRowView<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For Each aRow In srcDataView<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For Each aCol In srcDataView.Table.Columns<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StrObj.Append(aRow(aCol.ColumnName))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StrObj.Append(",")<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next aCol<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Next aRow<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return StrObj.ToString()</P>
<P>This is all straightforward.</P>
<P>But If I have a&nbsp;ReadOnlyList ProjectList (&nbsp;it is the collection of the ReadOnly object ProjectInfo) in place of the dataview in the example and try to achieve the same results (convert the list of&nbsp;ProjectInfo to a comma separated string),&nbsp;how do I go about doing that?&nbsp; </P>
<P>The part I'm stuck is that&nbsp;what qualifier I should use to access the column names&nbsp;in ProjectInfo object and be able to loop through them?&nbsp;&nbsp;Has anyone done similar&nbsp;implementation as&nbsp;this?&nbsp; The column names are properties of the ProjectInfo object.</P>
<P>Thanks in advance.&nbsp;</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Monday, September 17, 2007</h2>Unfortunately, you'll have to fallback to hand coding it property by property or use reflection in order to read all the properties dynamically.<br><br>Andr√©s<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>yimiqi replied on Monday, September 17, 2007</h2><P>Hummm, hard coding all the column names seems a bit akward.&nbsp; Do you have&nbsp;code sample how to use&nbsp;reflection&nbsp;get&nbsp;all the properties dynamically?</P>
<P>By the way, are you&nbsp;the Cslagen guy?&nbsp; I think you are.&nbsp;&nbsp;&nbsp;Great tool,&nbsp; I use it to gen all my BOs. </P>
<P>Thank you for the suggestion on my problem, and hats off&nbsp;to all your hard work on Cslagen.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Monday, September 17, 2007</h2><P>Here is some reflection code that should get you started:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> mProps </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> List(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> PropertyInfo)</P></FONT><FONT color=#0000ff size=2>
<P>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>ReadOnly</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</FONT><FONT size=2> Props() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> List(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> PropertyInfo)<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Get<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> mProps </FONT><FONT color=#0000ff size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Nothing</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>mProps = </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> List(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> PropertyInfo)</FONT></P>
<P><FONT size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#006400>'This code ensures you get the correct Type of a ROC&nbsp;based on the Item method which uses index As Integer.<BR></FONT></FONT><FONT size=2><FONT color=#006400>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'I have 2 overloads of the Item method which can cause problems if you do not specify the correct one.<BR></FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> infoType </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Type = mROC.GetType().GetProperty(</FONT><FONT color=#ff00ff size=2>"Item"</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> Type() {</FONT><FONT color=#0000ff size=2>GetType</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2>)}).PropertyType</P>
<P></FONT><FONT color=#008000 size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'get an array of all Properties of the ROC (could be 50 or more)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> tempProps() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> PropertyInfo = infoType.GetProperties(flags)</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'add all Properties to mProps. Other conditional&nbsp;code was removed&nbsp;for clarity.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>For</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Each</FONT><FONT size=2> prop </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> PropertyInfo </FONT><FONT color=#0000ff size=2>In</FONT><FONT size=2> tempProps<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mProps.Add(prop)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Next<BR>&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If<BR><BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> mProps</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp; End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Get<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</P></FONT>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>yimiqi replied on Monday, September 17, 2007</h2><P>Thank you Joe, for posting the reflection code sample.</P>
<P>I don't exactly&nbsp;know how I am going to use the code to do what I'm trying to achieve yet, but this definitly will get me started in that direction.&nbsp; I will post back on progress.</P>
<P>Thanks.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>yimiqi replied on Wednesday, September 19, 2007</h2><P><FONT size=2><FONT color=#008000><FONT color=#000000>I'm back...&nbsp;&nbsp;</FONT></FONT></FONT></P>
<P><FONT size=2><FONT color=#008000><FONT color=#000000>Joe, what flags am&nbsp; I supposed to use&nbsp;in the following statement?&nbsp; I used BindingFlags.Default, .GetField and .GetProperty, all gave me Nothing back (tempProps.length = 0).&nbsp;&nbsp;So,&nbsp;the mProps also returns Nothing.</FONT></FONT></FONT></P>
<P><FONT size=2><FONT color=#008000>&nbsp; 'get an array of all Properties of the ROC (could be 50 or more)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff>Dim</FONT> tempProps() <FONT color=#0000ff>As</FONT> PropertyInfo = infoType.GetProperties(<FONT color=#ff0000>flags</FONT>)</FONT></P>
<P><FONT size=2>Apparently I missed something, but what was it?&nbsp; </FONT></P>
<P><FONT size=2></FONT>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, September 19, 2007</h2><P>&nbsp;Protected flags As BindingFlags = BindingFlags.Public Or BindingFlags.IgnoreCase Or BindingFlags.Instance</P>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>yimiqi replied on Wednesday, September 19, 2007</h2><P>Thanks Joe, that worked.&nbsp; BindingFlag has about 20 enum values you could set, I was very confused with what values to use.</P>
<P>That part worked, now I'm getting something back, following is in the command window</P><FONT size=1>
<P><FONT color=#0000ff>&gt;? tempprops</FONT></P>
<P><FONT color=#0000ff>{Length=14}</FONT></P>
<P><FONT color=#0000ff>(0): {System.Reflection.RuntimePropertyInfo}</FONT></P>
<P><FONT color=#0000ff>(1): {System.Reflection.RuntimePropertyInfo}</FONT></P>
<P><FONT color=#0000ff>(2): {System.Reflection.RuntimePropertyInfo}</FONT></P>
<P><FONT color=#0000ff>....</FONT></P>
<P><FONT color=#0000ff>(14): {System.Reflection.RuntimePropertyInfo}</FONT></P>
<P><FONT size=3>Versus before, length was 0.</FONT></P>
<P><FONT size=3>But, when I tried to add the propertyinfo in tempprops to the property list as in your sample code, I got NullReferenceException was unhandled error - I probably be able to figure this one out myself</FONT></P>
<P><FONT size=2><FONT color=#008000>&nbsp;</FONT><FONT color=#0000ff>For</FONT> <FONT color=#0000ff>Each</FONT> prop <FONT color=#0000ff>As</FONT> PropertyInfo <FONT color=#0000ff>In</FONT> tempProps<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mProps.Add(prop)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Next</FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#000000 size=3>But any insights is always welcome.</FONT></FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#000000 size=3>I'm new to reflection, please bare with all my newbie questions.&nbsp;</FONT></P>
<P><BR></P></FONT><FONT color=#0000ff size=2></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Wednesday, September 19, 2007</h2>Try something like this.&nbsp; You probably want to make adjustments to order the properties or something, but this should get you 80% there... Just pass an object to the function and get the string.<br><br><br>Public Shared Function ObjToString(ByVal obj As Object) As String<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim sb As New System.Text.StringBuilder()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim t As Type = obj.GetType()<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim props() As System.Reflection.PropertyInfo = t.GetProperties(Reflection.BindingFlags.Public Or Reflection.BindingFlags.Instance)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For Each p As System.Reflection.PropertyInfo In props<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim val As Object = p.GetValue(obj, Nothing)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim stringVal As String<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If val Is Nothing Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stringVal = "Null Reference"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stringVal = val.ToString()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sb.AppendFormat("{0}: {1}", p.Name, stringVal)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sb.AppendLine()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return sb.ToString()<br>&nbsp;&nbsp;&nbsp; End Function<br><br><br><br>Andr√©s</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>yimiqi replied on Wednesday, September 19, 2007</h2><P>Andr√©s </P>
<P>Thank you for posting the reflection code.&nbsp; I wish I knew a bit more about refection so that not to bother you guys with such basic simple questions here.</P>
<P>With your and Joe's code, I think I'm going to (I'll have to) accomplish my requirement.</P>
<P>Just in case you are interested, there is another post in this forum discussing export data from BO to a CSV string then file.&nbsp; The author of that post didn't use reflection to do his work.</P>
<P><A HREF="/forums/17708/ShowThread.aspx#17708">http://forums.lhotka.net/forums/17708/ShowThread.aspx#17708</A></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>yimiqi replied on Thursday, September 20, 2007</h2><P>Joe or Andr√©s</P>
<P>I'm getting the TargetException was unhandled error "Object does not match target type" when at line </P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim val As Object = p.GetValue(obj, Nothing)</P>
<P>If I replace&nbsp;&nbsp;line&nbsp;&nbsp;&nbsp; Dim t As Type = obj.GetType()</P>
<P>with&nbsp;<FONT size=2>&nbsp;&nbsp;</FONT><FONT size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#0000ff>Dim</FONT>&nbsp;t <FONT color=#0000ff>As</FONT> Type = obj.GetType().GetProperty(<FONT color=#ff00ff>"Item"</FONT>, <FONT color=#0000ff>New</FONT> Type() {<FONT color=#0000ff>GetType</FONT>(<FONT color=#0000ff>Integer</FONT>)}).PropertyType</FONT><BR>(from Joe's)</P>
<P>I did that because the line from Joe's code ensures getting the correct type of a ROC object based on the item method which uses index as integer, which is what I wanted - the item properties of the object.</P>
<P>obj.GetType() gives me all other properties of the object, like AllowRemove, AllowEdit, AllowNew etc. which isn't what I wanted.</P>
<P>If I don't change that line, the GetValue works for the first 4 properties, then will also fail but on different error - TargetParameterCountException ("Parameter count mismatch)</P>
<P>But I'm more concerned with the TargetException error.</P>
<P>So,&nbsp;is there a different way to&nbsp;get the value of an object's item properties (= column names, e.g firstname, age etc.) other than using GetValue(obj, Nothing)?</P>
<P>Thanks in advance for any help.&nbsp; (I will do some lookup on reflection too)</P>
<P><FONT size=2></FONT>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>yimiqi replied on Thursday, September 20, 2007</h2><P>If I don't change that line, the GetValue works for the first 4 properties, then will also fail but on different error - <FONT color=#0000ff>TargetParameterCountException ("Parameter count mismatch)</FONT></P>
<P>I found out what caused the ParameterCountException error.</P>
<P>When you use this line of code: Dim t As Type = obj.GetType()</P>
<P>Then do GetProperties, you will get list of propertyinfo like AllowRemove, AllowEdit, AllowNew, Count etc. and <FONT color=#ff0000>Item.&nbsp;</FONT></P>
<P><FONT color=#000000>When you loop through each p as propertyinfo in&nbsp;the property list&nbsp;to&nbsp;GetValue, when hits the <FONT color=#ff0000>Item</FONT>&nbsp;propertyinfo &nbsp;in the loop, you will get the above parameter error.&nbsp; It makes sense, because Item propertyinfo has its own child collection (the item properties of the object - in my case is the collection of my grid column names I'm after to build a string for).&nbsp; This problem can be resolved by replace one line of code (as in my last message in this thread).</FONT></P>
<P>But, my headache problem still there, TargetException was unhandled error "Object does not match target type" [;)<img src="/emoticons/emotion-1.gif" alt="Smile [:)]" />]</P>
<P>I did a bit search on PropertyInfo.GetValue() on MSDN and found the following</P>
<DIV class=title>PropertyInfo.GetValue Method</DIV>
<DIV id=mainSection>
<DIV id=mainBody>Returns the value of the property. 
<DIV class=MTPS_CollapsibleRegion>

var ExpCollDivStr = ExpCollDivStr;
ExpCollDivStr = ExpCollDivStr + "ctl00_LibFrame_ctl097156fab,";
var ExpCollImgStr = ExpCollImgStr;
 ExpCollImgStr = ExpCollImgStr + "ctl00_LibFrame_ctl09img,";

<A class=CollapseRegionLink href="http://msdn2.microsoft.com/en-us/library/system.reflection.propertyinfo.getvalue.aspx#"><IMG class=CollapseRegionImg id=ctl00_LibFrame_ctl09img alt="Overload List" src="http://msdn2.microsoft.com/msdn/Controls/CollapsibleArea/en-us/minus.gif" align=middle>Overload List</A><BR>
<DIV class=section id=ctl00_LibFrame_ctl097156fab>
<DIV id=ctl00_LibFrame_ctl09><A name=overloadedMembersToggle>
<TABLE class=memberListTable>




<TR>
<TH align=left>Name </TH>
<TH align=left>Description </TH></TR>
<TR>
<TD><A href="http://msdn2.microsoft.com/en-us/library/b05d59ty.aspx">PropertyInfo.GetValue (Object, Object[]) </A></TD>
<TD>Returns the value of the property with optional index values for indexed properties. 
<P>Supported by the .NET Compact Framework. </P></TD></TR>
<TR>
<TD><A href="http://msdn2.microsoft.com/en-us/library/c0bb9ctc.aspx">PropertyInfo.GetValue (Object, BindingFlags, Binder, Object[], CultureInfo) </A></TD>
<TD>When overridden in a derived class, returns the value of a property having the specified binding, index, and <A href="http://msdn2.microsoft.com/en-us/library/system.globalization.cultureinfo.aspx">CultureInfo</A>. 
<P>Supported by the .NET Compact Framework. </P></TD></TR></TABLE></A></DIV></DIV></DIV></DIV></DIV>
<P>But I'm lost as to what values I should set as parameters&nbsp;when Call GetValue(). I'm using GetValue(obj, Nothing), and this one gives me the target type exception error.&nbsp; </P>
<P>Could you help me out?&nbsp; Thanks in advance.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>yimiqi replied on Friday, September 21, 2007</h2><P>I figured out the problem.</P>
<P>the obj value passed in calling GetValue(obj, Nothing) is a ROC object.&nbsp; But&nbsp;when I use </P>
<P><FONT size=2>&nbsp;<FONT color=#0000ff>Dim</FONT> t <FONT color=#0000ff>As</FONT> Type = obj.GetType().GetProperty(<FONT color=#ff00ff>"Item"</FONT>, <FONT color=#0000ff>New</FONT> Type() {<FONT color=#0000ff>GetType</FONT>(<FONT color=#0000ff>Integer</FONT>)}).PropertyType to get the type</FONT></P>
<P><FONT size=2>rather than </FONT></P>
<P><FONT size=2>Dim t As Type = obj.GetType() </FONT></P>
<P><FONT size=2>then to&nbsp;get the properties of t,&nbsp;I need to pass in the &nbsp;ROC's child object - RO object (e.g. ProjectInfo in ProjecList)</FONT></P>
<P><FONT size=2>when propertyinfo.name = "Item", if you want to get all the properties exposed in the ROC.</FONT></P>
<P>Thanks.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Friday, September 21, 2007</h2>The code I sent is not intended to loop through collections by itself. It's just code for getting properties for a single instance.<br>If you need all the "ToStrings" in a collection, then you should loop through the collection and run each item agains the method I sent.<br><br>Otherwise, you'll have to use recursion, but first checking that the properties don't have indexers.<br>I assume you don't want to get the properties for the collection itself, just the items in the collection. Right?<br><br>Andr√©s<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>yimiqi replied on Friday, September 21, 2007</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>xal:</strong></div><div></P>
<P>I assume you don't want to get the properties for the collection itself, just the items in the collection. Right?<BR><BR>Andr√©s<BR></div></BLOCKQUOTE></P>
<P>That's correct.&nbsp; I only want to get the items in the collection.&nbsp; E.g. ROC object ProjectList has its properties, and item is one of them. Item then has its&nbsp;own properties which is a list of public properties/fields (=column&nbsp;names)&nbsp;exposed&nbsp;by the&nbsp;business&nbsp;object.&nbsp; Item actually is the RO object, ProjectInfo in this case.&nbsp; I only want to get all the properties/fields in ProjectInfo.</P>
<P>Thanks for the help.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Friday, September 21, 2007</h2>So again, loop through the list yourself and pass each of the items to the method I sent you.<br><br>Andr√©s<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>yimiqi replied on Friday, September 21, 2007</h2><P>Got it. Thanks a lot.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
