<html><header><title>Trying to bind a sorted EditableRootList to a DataGrid</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Trying to bind a sorted EditableRootList to a DataGrid</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9458.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Mike78 posted on Tuesday, August 31, 2010</h2><p>I have a DataGrid on my xaml page that I would like to be sorted when the page first loads.&nbsp; I realize I could just sort the data in my stored procedure, but I would prefer to do it in code.&nbsp; I thought this would be easy, but it&#39;s turning out to be much more difficult than I had anticipated.</p>
<p>I can bind my DataGrid to my EditableRootList object (my Model) well enough, but it&#39;s the sorting that&#39;s giving me trouble.&nbsp; I&#39;m trying to do the sort in my ViewModel class with a method similar to the following.</p>
<p>protected override void OnRefreshed()<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp; base.OnRefreshed();<br />&nbsp;&nbsp;&nbsp;&nbsp; if (Model != null)<br />&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var sortedList = (from item in Model orderby item.MyFieldName select item);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Model = (Business.CustomerList)sortedList;<br />&nbsp;&nbsp;&nbsp;&nbsp; }<br />}</p>
<p>My code compiles, but at runtime the last line of this method raises an InvalidCastException.</p>
<p>Has anyone else had any luck with this situation?&nbsp; I&#39;m using Silverlight 4, C# 4, and CSLA 4.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, August 31, 2010</h2><p>Hi, </p>
<p>A linq query returns just an IEnumerable not a Business.CustomerList and that is why you get an invalid cast exception</p>
<p>Take a look at the LinqObservableCollection class and the ToSyncList extension method that you can apply to a linq query. Something like:</p>
<p>var sortedList = model.ToSyncList(from item in Model orderby item.MyFieldName select 
item);</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>Mike78 replied on Tuesday, August 31, 2010</h2><p>Ah, yes.&nbsp; That seems to have done the trick.&nbsp; My new solution is as follows.</p>
<p><br />protected override void OnRefreshed()<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp; base.OnRefreshed();</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp; if (Model != null)<br />&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var sortedList = Model.ToSyncList(from item in Model orderby item.MyFieldName select item);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Business.CustomerList tempList = new Business.CustomerList();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tempList.AddRange(sortedList);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Model = tempList;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />}</p>
<p><br />Thanks for your help.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
