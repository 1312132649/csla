<html><header><title>Validation Rules with conditions</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Validation Rules with conditions</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/788.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>NelsonF posted on Wednesday, August 02, 2006</h2><DIV>First thanks to all who have helped me in my previous posts. This place is a God send...</DIV>
<DIV>&nbsp;</DIV>
<DIV>My current issue is how to have a rule that depends on other conditions. For example:</DIV>
<DIV>&nbsp;</DIV>
<DIV>Scenario 1:</DIV>
<DIV>Let's say you're managing some real estate information. So you have a&nbsp;value that indicates the PropertyTypeID where&nbsp;(1=Income, 2=Owner Occupied, 3=Commercial, etc)&nbsp; now if PropertyTypeID=1 I need to insure that a rule is enforced where a child list IncomeUnitList contains at least 1 entry. If PropertyTypeID=2 then IncomeUnitList must be empty. If ProprtyTypeID=3 then another sibling property NumOfUnits must be populated.</DIV>
<DIV>&nbsp;</DIV>
<DIV>Scenario 2:</DIV>
<DIV>I have an person object&nbsp;called PersonType&nbsp;that is boolean that indicates is a person is of a certain type (broker, attorney, borrower, etc). I also have another field that indicates the PersonID which will need a different regex validation depending on type (borrower must have a valid social security number, broker must have a broker id, attorney must have a bar #, &nbsp;etc..)</DIV>
<DIV>&nbsp;</DIV>
<DIV>In both scenarios I can quickly code a routine to do all these checks but I'd like to encapsulate them within my CSLA objects directly. Are there some recommendations for accomplishing this?</DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp;</DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>hurcane replied on Wednesday, August 02, 2006</h2>I'm not directly answering your question, but have you considered having different objects instead of using the data-centric type code within a single object? You could have separate property objects (IncomeProperty, OOProperty, CommercialProperty). The OOProperty object wouldn't even contain a child list. For your second scenario, you might consider having a Borrower object, an Broker object, and an Attorney object. Each object has their own unique rules.<br><br>Having separate objects eliminates your dependency on the "type" variable. For your person scenario, you now have very simple business rules based on simple properties. For example, the Attorney can use the StringRequired business rule on the bar # property.<br><br>You would still have dependencies on the child collection. I believe there have been other discussions about creating business rules based on the state of a child collection. I won't rehash that here.<br><br>If you still want to go with a single, heavy object, and include a type variable, I would still create separate business rules. Each rule's body would take this form:<br><br>If Type &lt;&gt; 1 Then Return True<br>Evaluate rule that applies to Type 1...<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Wednesday, August 02, 2006</h2>You can make one rule that has a case statement that validates the stuff you need according to the property type.<br>Or you could also make three different rules, and each of them would actually run the validation if the PropertyTypeID is the type that rule uses, and otherwise return true...<br><br>Andr√©s<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
