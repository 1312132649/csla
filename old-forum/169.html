<html><header><title>Using Inheritance</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Using Inheritance</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/169.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai posted on Tuesday, May 23, 2006</h2><P>Hi guys.</P>
<P>We had our first bash at using inheritance within Business Objects yesterday without success.&nbsp; Basically we have an object called Content of which there are three types - ContentHeader, ContentBody and ContentFooter.&nbsp; The only real difference between these three types is that they require different security i.e. some users are able to edit a ContentHeader etc.&nbsp; So we tried creating a Content object and inheriting the other three from this object.&nbsp; All the data access code is in the Content object, as they all use the same stored procedures and have the same properties.&nbsp; This means that the dataportal returns a Content object rather than one of the three inherited classes.&nbsp; How do you structure this so that it would work correctly?&nbsp; Hope that is clear.&nbsp; </P>
<P>FWIW, we are probably going down the route of having one object, Content with a ContentType property and working around the problem like that but I feel sure you must be able to use inheritance in Csla just can't see how it is done.&nbsp; Can anyone enlighten me?</P>
<P>Thanks.</P>
<P>John.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Tuesday, May 23, 2006</h2>The short answer: Make Content abstract (MustInherit), so that you can't make instances of it and you don't get confused about it. It only exists to support the actual content types...<br>Now, once you get past that point, you should be thinking of doing one of two things (assuming you these content classes are children).<br>1- Have n resultsets that return the different content types and create different child collections for different content types. (You can also selectively fill different collections with one resultset with an approach similar to #2)<br>2- Return everything in one result set and so something like this in your root:<br>while dr.read()<br>Select Case dr.GetByte("ContetType")<br>&nbsp;&nbsp;&nbsp; Case 1 'Header<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;  me.Contents.Add(ContentHeader.GetContentHeader(dr))<br>&nbsp;&nbsp;&nbsp; Case 2 <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;  me.Contents.Add(ContentBody.GetContentBody(dr))&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; ....<br>End Select<br>Loop<br> <br>Of course Contents would be accepting / returning objects of type Content.<br><br>Andr√©s<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DavidDilworth replied on Tuesday, May 23, 2006</h2><P>I agree that the abstract base class (ABC) route would be the way to achieve the result.</P>
<P>However, if all the properties of your 3 objects are the same and only the security policy is different then you probably do only have 1 object - the Content object.</P>
<P>It may well have a Content.Type property that allows you to program different behaviour depending on the value it has.</P>
<P>If the 3 subclasses you describe have nothing that makes them different from the base class, then the question must be "What behaviour is this class providing that is different?".</P>
<P>I think if the answer to your question is "None" then you probably don't have a need for a different subclass.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, May 23, 2006</h2><P>I think the problem here is that all three objects have the <EM>same behavior</EM> in that they restrict who has access.&nbsp;If you have&nbsp;a class that defines a Color, you wouldn't create a subclass for a Blue object and a different subclass for&nbsp;a Red object - you'd just make Color a property.</P>
<P>Here you are describing a class that defines authorization, and I don't think it makes sense to create a subclass for objects that only vary based on the data behind that authorization behavior.</P>
<P>In other words (and we're playing semantics here), your objects have the same behavior - just different data. As the object is created (through DataPortal_Create or DataPortal_Fetch) you should be able to examine the criteria object to determine the nature of the object and then load AuthorizationRules at that point (rather than in AddAuthorizationRules like normal).</P>
<P>If you need to authorize the create/fetch behaviors themselves, you may choose to put the customized checks in the factory methods so they run before the data portal is invoked.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>McManus replied on Tuesday, May 23, 2006</h2><P>John,</P>
<P>Since all classes have the same properties and data access code, these should be implemented in the base class (Content). The data access code can be put in a protected Fetch() method.</P>
<P>The Content class should not implement any public&nbsp;Factory methods, because you don't want to create objects of type Content.</P>
<P>In the ContentHeader, ContentBody and ContentFooter classes you can implement the Factory methods. In the DataPortal_Fetch() methods, just call the Fetch() method of the base class. This way, the data access code is not duplicated, and the DataPortal returns the objects you want, i.e. ContentHeader, ContentBody and ContentFooter.</P>
<P>Cheers,</P>
<P>Herman</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai replied on Wednesday, May 24, 2006</h2><P>Thanks to all the people that posted here.&nbsp; I certainly have some options to look at now.&nbsp; </P>
<P>John.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
