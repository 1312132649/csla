<html><header><title>Exception not coming back to the client</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Exception not coming back to the client</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/12076.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 posted on Thursday, July 18, 2013</h2><p>INCLUDING REPRO AT END OF THREAD</p>
<p>I vaguely remember seeing a post on this before but I couldn&#39;t locate it and I didn&#39;t see anything in the change log to indicate this was addressed.</p>
<p>We&#39;re using version 4.5.10.&nbsp; If I do something like this, my exceptions are not bubbling up to the client.<span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">&nbsp;</span></span>&nbsp;</p>
<p>
<p><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">protected</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">override</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">void</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> DataPortal_Update() { t</span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">hrow</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">new</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">Exception</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">(</span></span><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;">&quot;BOOM!&quot;</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">); }</span></span></p>
<p>I can put breakpoints in my OnSaved &amp; OnError viewmodel methods, and they don&#39;t get hit.&nbsp; This previously worked.&nbsp; While I cannot say definitively it was the upgrade to 4.5.10 that caused it (from like 4.2 I think) I believe it is the case.</p>
<p>Is there anything that could have changed in CSLA that would have perhaps introduced an issue?&nbsp; It&#39;s a fairly decent sized problem for us (it&#39;s not in production - next release though)</p>
<p>Edit: It&#39;s coming back to my CompressedWcfProxy (which inherits WcfProxy) and gets to CompressedWcfProxy.ConvertResponse but then fails... I can&#39;t seem to debug the Silverlight CSLA code so still trying to determine where it&#39;s failing.</p>
</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Thursday, July 18, 2013</h2><p>At this point, I can see that it gets to this line in SaveAsync (I overrode it and pasted it in because I can&#39;t seem to debug the CSLA SL code which would really help right now!). - it doesn&#39;t make it past that line (as expected). </p>
<p><span style="font-family:Consolas;color:#808080;font-size:x-small;"><span style="font-family:Consolas;color:#808080;font-size:x-small;"><span style="font-family:Consolas;color:#808080;font-size:x-small;"><span style="font-family:Consolas;color:#808080;font-size:x-small;"><span style="font-family:Consolas;color:#808080;font-size:x-small;"><span style="font-family:Consolas;color:#808080;font-size:x-small;">
<p>result = await DataPortal.UpdateAsync&lt;Contact&gt;((Contact)this);</p>
</span></span></span><font face="Consolas" size="2" color="#808080"><font face="Consolas" size="2" color="#808080"><font face="Consolas" size="2" color="#808080">
<p>
<p>&nbsp;</p>
</p>
</font></font></font></span><font face="Consolas" size="2" color="#808080"><font face="Consolas" size="2" color="#808080">
<p>&nbsp;</p>
</font></font></span><font face="Consolas" size="2" color="#808080">
<p>&nbsp;</p>
</font></span>
<p>&nbsp;</p>
</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Thursday, July 18, 2013</h2><p>In BeginSave of Csla.Xaml.ViewModelBase towards the bottom - BeginSave() is invoked when saving... basically just trying to save a business object that is designed to throw an error in the dataportal method.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Error = null;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsBusy = true;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; savable.BeginSave();&nbsp; &lt;-- this ends up throwing&nbsp;a DataPortalException<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)&nbsp; &lt;-- it doesn&#39;t seem to catch!<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsBusy = false;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Error = ex;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OnSaved();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; }</p>
<p>So I was looking at what BeginSave should end up doing,&nbsp;which ends up going into SaveAsync, and &nbsp;I _think_ the same sort of equivalent code with 4.0 would have returned a DataPortalResult with an error rather than an exception if something went wrong.&nbsp; When using 4.5, it&#39;s catching a dataportal exception.&nbsp; (This is effectively within SaveAsync of BusinessBase)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = await DataPortal.UpdateAsync&lt;Contact&gt;((Contact)this);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Thursday, July 18, 2013</h2><p>One last followup and then hopefully someone can chime in...</p>
<p>If I change my BusinessBase&#39;s SaveAsync to do the following, it fixes my problem.&nbsp; I obviously don&#39;t want to just use my own workaround if I&#39;m doing something incorrect - so if anyone has anything elightening to add it would be appreciated.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = await DataPortal.UpdateAsync&lt;Contact&gt;((Contact)this);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OnSaved(null, ex, userState);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return null;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Killian35 replied on Thursday, July 18, 2013</h2><p>You may be referring <a href="http://forums.lhotka.net/forums/p/11975/55457.aspx#55457">this post</a> a while ago. It sounds exactly like the issue I had and still have. Once I moved to 4.5.10 the BeginSave would fail as you described. I&#39;ve tested all the way through 4.5.30 and the bug still exists.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Thursday, July 18, 2013</h2><p>Bingo, that was the post I was referring to.&nbsp; </p>
<p>I&#39;m glad I&#39;m not alone.&nbsp; Seems like a pretty major issue.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Sunday, July 21, 2013</h2><p>I&#39;m hoping this doesn&#39;t just slide off the board as it is a fairly decent issue&nbsp;- I think it should be pretty clear as to what the issue is but would anything in particular help / i.e. a reproducible app or what have you?&nbsp; I think it should be fairly easy to reproduce but would be happy to help with a repro if the above posts aren&#39;t sufficiently clear.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Friday, July 26, 2013</h2><p>I&#39;m really hoping someone on the CSLA team can address this - I have a super-simple reproducable - just fire up the app and click the button and it&#39;ll be apparent that after the BeginSave(), there is no OnError, no OnSaved - for a save operation that throws an exception.</p>
<p>We release a next version of our product in a few months and I would *really* like to avoid hacky workarounds.</p>
<p>The upload attachment doesn&#39;t seem to be working for me - I would happy to email the reproducable to anyone on the CSLA team.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Friday, July 26, 2013</h2><p>Hi,</p>
<p>You may send the attachment to me on jonny.bekkum(a)gmail.com.&nbsp;</p>
<p>I am on vacation now and until 12. august and not sure if I am able to do much until I get back home.</p>
<p>AFAIK anyone that has signed a contribution agreement with Rocky may submit push requests to the CSLA repository.<br />Then either Rocky or me (as backup) can accept the push request and update the base repository. &nbsp;&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Friday, July 26, 2013</h2><p>Sent, thank you.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>skagen00 replied on Monday, August 19, 2013</h2><p>just fyi, I noticed the fix for this has been checked in over at GitHub - thanks Jonny!</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
