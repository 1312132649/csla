<html><header><title>&quot;Class not registered&quot; error when using EnterpriseServices transaction type.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>&quot;Class not registered&quot; error when using EnterpriseServices transaction type.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/12067.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>JohnRandall posted on Thursday, July 11, 2013</h2><p>I added a the Enterprise Services transaction attribute to a DataPortal_Fetch of a BusinessListBase object.<br /><br />If called internally, it fetches fine, and will rollback when an exception occurs, but when called through a web service I get &quot;DataPortal.Fetch failed (Class not registered (Exception from HRESULT: 0x80040154 (REGDB_E_CLASSNOTREG))&quot;</p>
<p>In <i>Expert CSharp 2008 Business Objects </i>on page 519, we find:<br /> <br />&quot;if you configure the data portal to run locally in the client process ... requires reference to System.EnterpriseServices.dll. It also has the side effect of requiring that Csla.dll be registered with COM+&quot;. &nbsp;<br /><br />As far as I know I have not configured the data portal to run locally (the only [RunLocal] I use is on methods that do not call the DataPoral), but since my error is related to registration I tried following these steps.<br /><br />After adding the reference to EnterpriseServices, and registering Csla.dll with regsvcs.exe, I get the following error:<br /><br /><span>&quot;DataPortal.Fetch failed (The ServicedComponent being invoked is not correctly configured (Use regsvcs to re-register).)&quot;<br /><br />I have tried re-registering, and also tried using&nbsp;regasm.exe, but to no effect. <br /><br />It definitely is registered because I can see CSLA in Component Services under COM+ Applications.&nbsp;</span></p>
<p><span>As a side note, DTC is enabled, and all firewalls are turned off.</span></p>
<p>I&#39;m using visual Studio 2012, hosted on IIS 6.8. Operating system is Windows 8 64 bit. Build platform is set to AnyCPU.</p>
<p>Any help is appreciated. Thank you in advance.&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JohnRandall replied on Friday, July 12, 2013</h2><p>Solved it. Wasn&#39;t a problem with CSLA - 32 bit applications had to be enabled on the application pool in IIS, since the COM component is 32 bit, as per this stackoverflow thread:<br /><br /><a href="http://stackoverflow.com/questions/8562221/error-class-not-registered-exception-from-hresult-0x80040154-regdb-e-classnot">http://stackoverflow.com/questions/8562221/error-class-not-registered-exception-from-hresult-0x80040154-regdb-e-classnot</a>&nbsp;</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
