<html><header><title>Object Model Question</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Object Model Question</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1617.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>David posted on Friday, October 27, 2006</h2><P>I have an editable root object, and two editable collections, and I can’t determine if the collections should be children of the root object, or root objects themselves.</P>
<P>Working from the use cases, I started out by making them children of the root object as this seemed to make the most sense. However, I need to edit each collection on a separate form, and things became complicated when I needed to do a save. In this configuration, the save needs to be initiated by the root object (which is on a 3rd form), so I guess it would go something like this:</P>
<OL>
<LI>The root form notifies each child form that it is about to save</LI>
<LI>Each child form uses the binding source control to end the current edit, checks the object IsValid, and returns a result to the root that it is (or is not) OK to proceed.</LI>
<LI>The root form clones and saves the object,&nbsp;and updates the references to the new object</LI>
<LI>The root form notifies each child form that the object has changed.</LI>
<LI>Each child form resets the data source to the new object passed to it by the root form.</LI></OL>
<P>At first I thought this was much to complex for the UI design and reverted to a model where the collection objects were both EditableRootCollections and simply made the Root object responsible for getting a new instance of each one. However, this just produces complexity elsewhere because my root object has properties and methods that rely on a reference to the two collections.</P>
<P>So (he finally gets to the question!), do you think my initial design is OK, and has anyone else written a UI like this? Basically I’m looking for reassurance that this is a reasonable approach.</P>
<P>Thanks in advance.</P>
<P>David</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>guyroch replied on Friday, October 27, 2006</h2><P>According to your use case this is a perfect candidate for a switchable object, p387 of c# book.</P>
<P>But beware, a switchable object is usually a sign of bad design - but not always.&nbsp; So it's up to you to decide if this fits your requirement.</P>
<P>A switchable object can be instantiated either as a root object or as a child object.</P>
<P>Hope this helps</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>David replied on Saturday, October 28, 2006</h2><P>Thanks for the comment, but I don't see how a&nbsp;switchable object solves my problem. It <EM>does</EM> give me the option to use either scenario from the UI, but I would then have to write the code to cater for both scenarios. So I would have to deal with both complexities.</P>
<P>I thought switchable objects were used to avoid duplication of code -&nbsp;when you needed to use a similar object in different use case scenarios. This is&nbsp;not really&nbsp;the problem here.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>guyroch replied on Saturday, October 28, 2006</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>David:</strong></div><div>
<P>I have an editable root object, and two editable collections, and I can’t determine if the collections should be children of the root object, or root objects themselves.</P>
<P></div></BLOCKQUOTE></P>
<P>If you _code_ your two editable collections as switchable collections then you'll be able in instantiate your collections as child collections of your editable root object AND you'll also be able to instantiate the collections as&nbsp;_root_ editable collections as well.&nbsp; This way you will be able to call the save method directly from the now _root_ editable collections.</P>
<P>I think your collections should be root objects because the responsibility to update the content of your collections seems to be different from the responsibility of your editable root object.&nbsp; In the case, the responsibility of your root object is to display the collections and not necessarily update the content.</P>
<P>Maybe the solution here would be to have an editable root object with 2 read only collections for display purposes only.&nbsp; Then your 2 root collections for update purposes.</P>
<P>This looks to me like a classic case of 2 distinct reponsibility - I could be wrong though because I don't know the context of your application.</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>guyroch replied on Saturday, October 28, 2006</h2><P>Ummm... on second thoughts... </P>
<P>Maybe what you need is to look at Petar's ActiveObjects at&nbsp;<A href="http://csla.kozul.info/">http://csla.kozul.info/</A>.&nbsp; Its an extention to Csla with an extensive _observer_ pattern implementation.&nbsp; It is meant to do something similar to what you are trying do to.&nbsp; I toyed with ActiveObject last year while still in 1.5x, but I havn't done any ActiveObject stuff with Csla 2x.</P>
<P>Hope this helps</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Saturday, October 28, 2006</h2><BLOCKQUOTE><div><img src="/Themes/alternate1/images/icon-quote.gif"> <strong>guyroch:</strong></div><div><p>Ummm... on second thoughts... </p>
<p>Maybe what you need is to look at Petar's ActiveObjects at&nbsp;<a href="http://csla.kozul.info/">http://csla.kozul.info/</a>.&nbsp; </p></div></BLOCKQUOTE><br><br>I agree with this last comment of guyroch. <br><br>To me it sounds like you have 3 <i>independent </i>forms:<br>- one for your 'root' object<br>- one for each of your collections<br><br>Imo this validates a BO design where the collections are editable root collections. This complies with the 'use case driven design principle' often referred to on this forum. The fact that your 'root' object bases some of its behavior on the contents of the collections could then be seen as a 'creational constraint' or so:<br>- whenever one of the collections is displayed, the root object must be instantiated as well<br>- this enables the root object to monitor the collections (e.g. using petar's observer pattern)<br><br>To ensure that you root object is always instantiated when required you can do as guyroch suggests: make those collections exclusively available to the UI through properties on this root object.<br><br>I guess then you would meet all your requirements/wishes:<br>- each form can update/save independently<br>- the logic of having another object monitoring those collections is where it belongs: in the BO, and not in your UI, so your UI can remain 'dumb' <br>- you ensure that your root object observes the collections by applying a creational pattern that satisfies your creational constraint<br><br>Last but certainly not least:<br>- you avoid the ugliness/complexities of switchables<br><br>Good luck!<br>Bayu<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
