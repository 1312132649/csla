<html><header><title>Saving changes made to multiple business objects on click of Apply</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Saving changes made to multiple business objects on click of Apply</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1845.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>adi posted on Monday, November 27, 2006</h2><P>While looking for a good architecture bcoz of some bottlenecks in the present one, we&nbsp;found CSLA quite interesting and was trying to implement a small part of it. I tried to check if this kind of a problem has been answered before but couldn't find any. So, typing in here hoping somebody must have done this.</P>
<P>I have a form similar to Tools-&gt;Options of Visual Studio where&nbsp;different controls are displayed&nbsp;on clicking different treenodes.&nbsp;Finally on clicking&nbsp;the OK button, the changes are saved. Unlike in Visual Studio, whenever a&nbsp;treenode is clicked, my controls&nbsp;are populated using different business objects which are loaded with data from a database. The user can do any of the CRUD operations and they will be&nbsp;saved to DB&nbsp;only&nbsp;when the form's Apply button is clicked.&nbsp;On clicking the Cancel button, the operations are rolled back and the changed business objects are repopulated.<BR><BR>Is&nbsp;there any way to implement this using CSLA?</P>
<P>I would like&nbsp;to make the Apply button enabled when a value is changed for any of the business object, keep track&nbsp;of all the objects which are dirty&nbsp;and save them only when the Apply button is clicked.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Monday, November 27, 2006</h2>You want to create an additional object whose responsibility is to make sure the objects are all saved or the save is rolled back if there is an exception.&nbsp; This object will take all of the other objects as arguments to its factory method.&nbsp; Its DataPortal_Update/Execute method could be marked with the [Transactional(TransactionScope)] attribute to ensure that all items are rolled back if there is an exception.<br><br>Because the apply button is dependent on several objects, I would recommend hooking up the PropertyChanged events on the objects to an event handler that sets the enabled state of the button based on whether any of the objects are dirty and all of the objects are valid.<br><br>So when the user clicks the apply button, you call AdditionalObject.SaveAllObjects(object1, object2, etc.).&nbsp; This adds the objects to a criteria object which gets passed to the data portal.&nbsp; The data portal calls the DataPortal_Update/Execute method (depending on whether you used a BusinessBase or CommandBase object), which was marked with the Transactional attribute.&nbsp; Within the DataPortal_* method, you call object1.Save(), object2.Save, etc.<br><br>That should be enough information to at least get you started.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
