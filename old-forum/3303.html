<html><header><title>Cannot get GUID ID from CSLADataSource</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Cannot get GUID ID from CSLADataSource</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3303.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>miloy001 posted on Tuesday, July 31, 2007</h2><FONT color=#0000ff>
<P><FONT face=Verdana size=2>Briefly, I added CSLADatasource to version 2.0, i have figured out the soring and paging based on&nbsp;some posts here&nbsp;and CSLA 2.1 handbook. I have to use a CustomerID fields on the following event and have to make CustomerID VISIBLE + EDITABLE:</FONT></P>
<P><FONT face=Verdana size=2>Protected</FONT></FONT><FONT face=Verdana size=2> <FONT color=#0000ff>Sub</FONT> CslaDataSource1_UpdateObject(<FONT color=#0000ff>ByVal</FONT> sender <FONT color=#0000ff>As</FONT> <FONT color=#0000ff>Object</FONT>, <FONT color=#0000ff>ByVal</FONT> e <FONT color=#0000ff>As</FONT> BOBases.Web.UpdateObjectArgs) <FONT color=#0000ff>Handles</FONT> CslaDataSource1.UpdateObject</FONT></P>
<P><FONT face=Verdana size=2>CID = e.Kays("CustomerID").ToString()<BR>obj = MyList.GetItemByID(CID)<BR>Data.DataMapper.Map(e.Values,&nbsp;obj</FONT><FONT face=Verdana size=2>)<BR>...</FONT></P>
<P><FONT face=Verdana size=2>This works but CustomerID should not be editable, i.e. only editable field is in the collection of Keys. How do I get the obj GUID ID or a Field with Visible=False&nbsp;form these CSLADatasource events? </FONT></P>
<P><FONT size=2><FONT face=Verdana>&nbsp;</P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, July 31, 2007</h2><P>There are a lot of changes/fixes from 2.0 to 2.1.4 (or 3.0) with the CslaDataSource, so if you are using it I suggest upgrading to the current framework version.</P>
<P>However, your specific question has less to do with CslaDataSource than with ASP.NET data binding itself.</P>
<P>The values in UpdateObjectArgs come from data binding, and data binding gets the values from the state of the page itself. If the value isn't on the page, it can't be in the state and so data binding can't provide it through UpdateObjectArgs. That's just the way ASP.NET data binding works.</P>
<P>So if you have fields you don't want displayed on the UI you must either put them into the UI in non-visible fields (zero size columns or whatever) so they are in the DetailsView/FormView/GridView. Or you must reload them from the database.</P>
<P>Remember that the web server is stateless, so the state exists either in the page or in the database.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>miloy001 replied on Wednesday, August 01, 2007</h2><P>I understand what you said. But my issue is:</P>
<P>I have Customer and CustomerList objects, on the select object event, CustomerList is assigned to csladtasource1: <BR><BR>e.BusinessObject = objList&nbsp;&nbsp;&nbsp;&nbsp; OR<BR><FONT size=3>e.BusinessObject = </FONT><FONT color=#0000ff size=3>New</FONT><FONT size=3> BOBases.SortedPagedBindingList(</FONT><FONT color=#0000ff size=3>Of</FONT><FONT size=3> Customer)(objList, e)</FONT></P>
<P><FONT size=3>That works but on Update event - </FONT><FONT size=3><FONT color=#0000ff size=3>Protected</FONT><FONT size=3> </FONT><FONT color=#0000ff size=3>Sub</FONT><FONT size=3> CslaDataSource1_UpdateObject(...</FONT></FONT></P>
<P><FONT size=3>How do I know which CustomerBeingUpdated in the CustomerList to pass to the DataMapper.Map?</FONT></P>
<P><FONT size=3><FONT size=3>Data.DataMapper.Map(e.Values, CustomerBeingUpdated)<BR><BR>I know the Customer.GetIdValue plays a roll here, but how/when do I setup the GetIdValue&nbsp;to databinding or CSLADataSource1?&nbsp; I useed the code sample in the Tracker project but it always said the CustomerBeingUpdated is null. What do I missed?</FONT></FONT></P>
<P><FONT size=3><FONT size=3>&nbsp;</P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, August 01, 2007</h2>This is discussed in Chapter 10, and is a common ASP.NET scenario. You need to tell the GridView, DetailsView or FormView which properties of your data are the key properties. There's a property on those controls where you set the key property name(s). The property is DataKeyNames and is discussed early in the chapter during the creation of the RolesEdit.aspx page.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>miloy001 replied on Wednesday, August 01, 2007</h2><P>Got it and thanks!<BR>Dim&nbsp;item = objList.ItemByGUID(GridView1.DataKeys(GridView1.EditIndex).Value)</P>
<P>One suggestion:&nbsp;</P>
<P>A simple test project using Northwind database so that users can simply replace connection string to run CSLA sample. I know some&nbsp;of developers have troubles or no patiences to setup/run your test sample and just forget it. Your book is great but how many users read it from A to Z? </P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
