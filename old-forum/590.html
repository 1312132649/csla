<html><header><title>Interface and Databinding question</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Interface and Databinding question</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/590.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Tuesday, July 11, 2006</h2>Hi all, <br><br>I have an interface which defines a specialized list.&nbsp; The interface is in a 'common' business layer assembly.<br><br>The idea is that I have a Contacts business assembly, and would like to use composition in my Quoting business assembly, but don't want to the Quoting assembly to the Contacts assembly.&nbsp; The UI layer will reference both assemblies.&nbsp; This makes sense to me, but if anyone has comments on this setup, please post.&nbsp; Now, my main question..<br><br>The interface is defined as such:&nbsp; <font color="#000080">public interface</font> <font color="#008000">IPhoneList</font>&lt;T&gt; <font color="#000080">where</font> T : <font color="#008000">IPhoneInfo</font> { }.<br><br>This works fine so far.&nbsp; I have an IContact interface as well, defined like so:<br><br><font color="#000080">public interface</font> <font color="#008000">IContact</font> {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#008000">IPhoneList</font>&lt;<font color="#008000">IPhoneInfo</font>&gt; PhoneNumbers{ <font color="#000080">get</font>; }<br>}<br><br>Now, when I bind to IContact, and then try to bind a BindingSource to PhoneNumbers, PhoneNumbers doesn't appear in the list of properties.&nbsp; I suspect this is because IPhoneList&lt;T&gt; doesn't implement any kind of collection interface.&nbsp; So the question is, which interface should IPhoneList also implement?&nbsp; I'm thinking System.Collections.Genetic.IList&lt;T&gt;, as that seems the most basic list type, and should already be implemented by my business collections (since they inherit BindingList, which I believe implements IList).&nbsp; <br><br>What are your suggestions?<br>thanks<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, July 11, 2006</h2>Some more info..<br><br>In the Add Project Data Source wizard, I noticed some interfaces show up, and others don't.&nbsp; What would make an interface NOT appear on this list?&nbsp; This is very frustrating about databinding, which is otherwise very useful.<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, July 11, 2006</h2>I was under the impression that data binding didn't support interfaces at all - at least not for binding discrete properties/columns.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, July 12, 2006</h2>I have an interface, IContact, and I can use the Add Data Source wizard to add an object datasource based on the interface.&nbsp; In a form, I can create a BindingSource using that datasource.&nbsp; If i set controls datasources on that form to the BindingSource, I can pick which properties the controls are bound to.. so it seems to work.<br><br>But for some reasons, The Add Data Source wizard just don't list some interfaces.&nbsp; Odder still, the PhoneNumbers property does show if I bind one bindingsource to another... its just not showing up to be able to create a project datasource by itself.<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>vargasbo replied on Wednesday, July 12, 2006</h2>Yes, I do belive DataSource was not designed to support interfaces However, you could hack it to make it work, but is it really worth it? Nope.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, July 12, 2006</h2>It seems that it doesn't support generic interfaces, just standard ones.&nbsp; But you're right, trying to get it to work off the interface is more effort than its worth; the only reason I went that was was because object I'm getting is actually declared as the interface..<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, July 12, 2006</h2>




<DIV align=left><SPAN class=250563418-12072006><FONT face=Arial color=#0000ff size=2>One goal behind the binding source is to enable data source 
flexibility. As long as your runtime data source has the same shape 
(properties/columns) as what was defined at design time, you can use 
it.</FONT></SPAN></DIV>
<DIV align=left><SPAN class=250563418-12072006><FONT face=Arial color=#0000ff size=2></FONT></SPAN>&nbsp;</DIV>
<DIV align=left><SPAN class=250563418-12072006><FONT face=Arial color=#0000ff size=2>What this means is that you should (in theory anyway) be 
able to build your form against a concrete business class that has only the 
common properties for all objects - a concrete implementation of your interface. 
At runtime then, you can set the DataSource property to any object that has (at 
a minimum) those properties. Extra properties are ignored, but missing 
properties cause an exception.</FONT></SPAN></DIV>
<DIV align=left><SPAN class=250563418-12072006><FONT face=Arial color=#0000ff size=2></FONT></SPAN>&nbsp;</DIV>
<DIV align=left><SPAN class=250563418-12072006><FONT face=Arial color=#0000ff size=2>The point being, that perhaps you don't need to use the 
interface for data binding, because all your objects will have those properties 
anyway.</FONT></SPAN></DIV>
<DIV align=left><SPAN class=250563418-12072006><FONT face=Arial color=#0000ff size=2></FONT></SPAN>&nbsp;</DIV>
<DIV align=left><SPAN class=250563418-12072006><FONT face=Arial color=#0000ff size=2>Rocky</FONT></SPAN></DIV><BR>
<BLOCKQUOTE>
  <DIV class=OutlookMessageHeader align=left>
  <HR>
  <FONT face=Tahoma size=2><B>From:</B> ajj3085 [mailto:cslanet@lhotka.net] 
  <BR><B>Sent:</B> Wednesday, July 12, 2006 1:15 PM<BR><B>To:</B> 
  rocky@lhotka.net<BR><B>Subject:</B> Re: [CSLA .NET] Interface and Databinding 
  question<BR></FONT><BR></DIV>
  <DIV></DIV>It seems that it doesn't support generic interfaces, just standard 
  ones.&nbsp; But you're right, trying to get it to work off the interface is 
  more effort than its worth; the only reason I went that was was because object 
  I'm getting is actually declared as the interface..<BR><BR><BR><BR></BLOCKQUOTE></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, July 12, 2006</h2>Yes, that makes sense.&nbsp; I forget that databinding doesn't 'tightly' couple anything.<br><br>Thanks for the feedback.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
