<html><header><title>OT:  Reporting services local reports</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>OT:  Reporting services local reports</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3145.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Thursday, July 05, 2007</h2>Hi,<br><br>I have a local report against my Csla business objects.<br><br>I have a table which lists line item details.&nbsp; In the footer I'm trying to do a total but I need to exclude certain line items from the total (for example, I have a Subtotal line item and its amount should be ignored).<br><br>I tried using this expression:&nbsp; =Sum( IIf( Fields!IsSubTotal.Value, 0D,&nbsp; Fields!ExtendedPrice.Value ) ), but that simply results in #Error (helpful, huh?).<br><br>I've also tried inserting a custom code snippet into the report to abstract this away but the function does not show up: =Sum( Code.FilterSubtotal( Fields!Value.Value ) )<br><br>But it doesn't reconized FilterSubtotal as a valid function.<br><br>Any ideas?&nbsp; Here's the sub:<br><br><font color="#0000ff">Public Shared Function</font> ConvertToDecimal( <font color="#0000ff">ByVal </font>dec <font color="#0000ff">As String</font> ) <font color="#0000ff">As Decimal</font><br>&nbsp;&nbsp;&nbsp; <font color="#0000ff">Dim </font>Result <font color="#0000ff">As Decimal</font><br><br>&nbsp;&nbsp;&nbsp; <font color="#0000ff">If String</font>.IsNullOrEmpty( dec ) <font color="#0000ff">Then</font><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Result = 0<br>&nbsp;&nbsp;&nbsp; <font color="#0000ff">Else</font><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Result = <font color="#0000ff">Decimal</font>.Parse( dec )<br>&nbsp;&nbsp;<font color="#0000ff">&nbsp; End If<br><br>&nbsp;&nbsp;&nbsp; Return</font> Result<br><font color="#0000ff">End Function</font><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, July 05, 2007</h2>Ok, I got it figured out.&nbsp; Forgot my build server isn't detecting changes properly at the moment..<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
