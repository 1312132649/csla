<html><header><title>Class derived from BusinessListBase to hold abstract classes?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Class derived from BusinessListBase to hold abstract classes?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6669.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>kennethkryger posted on Wednesday, March 25, 2009</h2>I'm a CSLA rookie, so please bear with me...<br /><br />I've got the following object-tree:<br />- Cylinder that derives from VisualComponent<br />- Bending that derives from VisualComponent<br /><br />- VisualComponent (is abstract) derives from PositionalComponent<br /><br />- PositionalComponent (is abstract) derives from BusinessBase<br /><br />How do I create a class, that derives from BusinessListBase that holds concrete implementations of VisualComponent (that is Cylinder or Bending classes)?<br /><br />Kind regards,<br />Kenneth<br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, March 25, 2009</h2><P>Because generic types are not polymorphic, you need a non-generic base type that is common across all the child objects you want to put into the list. This means using an interface.</P>
<P>BusinessListBase only accepts child objects of type Csla.Core.IEditableBusinessObject, and so your interface must inherit from IEditableBusinessObject:</P>
<P>public interface IVisualComponent : Csla.Core.IEditableBusinessObject<BR>{<BR>}</P>
<P>Have your child classes implement IVisualComponent. Then have your BLB use this type:</P>
<P>public class VisualComponentList : <BR>&nbsp;&nbsp;&nbsp; BusinessListBase&lt;VisualComponentList, IVisualComponent&gt;<BR>{<BR>}</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kennethkryger replied on Thursday, March 26, 2009</h2>Okay - so now my VisualComponent class looks like this...<br /><br />public abstract class VisualComponent : PositionableComponent, IVisualComponent<br />{<br />}<br /><br />But howcome I need to declare my managed backing field like this:<br /><br />internal static PropertyInfo ConnectionPointListProperty = RegisterProperty(new PropertyInfo("ConnectionPointList"));<br /><br />and not<br /><br />internal static PropertyInfo ConnectionPointListProperty = RegisterProperty(c => c.ConnectionPointList);<br /><br />If I do the latter I get this compile time error:<br />"Cannot convert lambda expression to type 'Csla.PropertyInfo[BusinessObjects.ConnectionPointList]' because it is not a delegate type"<br /><br />(please not that [ and ] should be smaller-than and greather-than symbols, but the web page didn't show them...)<br /><br />It not a big deal - I just want to make sure, what I'm doing is the right thing!<br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, March 26, 2009</h2>If your base class isn't BusinessBase then the overload of<br />RegisterProperty() that doesn't require the type name won't work. This is<br />because that overload uses T to determine the type of your class - which (in<br />your example) is PositionableComponent rather than VisualComponent.<br /><br />You can still use the lambda scheme - you'll just need to add some overloads<br />of RegisterProperty() into your non-generic base class, like I did in<br />CslaIdentity and CriteriaBase. Those overloads require that the subclass<br />provide a value for T, somewhat like this:<br /><br />RegisterProperty(c => c.ConnectionPointList)<br /><br />That extra generic type parameter allows the overload to know the correct<br />type for 'c' so it can find your property.<br /><br />Rocky</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Thursday, March 26, 2009</h2><P>I think another possibility is to use your own intermediate generic class:</P>
<P>public class VisualComponentList&lt;T&gt; : <BR>&nbsp;&nbsp;&nbsp; BusinessListBase&lt;VisualComponentList&lt;T&gt;,T&gt; where T : VisualComponent<BR>{</P>
<P>...<BR>}</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
