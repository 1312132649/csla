<html><header><title>Best tact for Hierarchical queries</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Best tact for Hierarchical queries</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11216.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>csmith1 posted on Thursday, March 08, 2012</h2><p>I need to query an EditableRootList by hierarchical child attributes.</p>
<p>An example from Using CSLA would be a &nbsp;Invoice-&gt;LineItems-&gt;LineItem.</p>
<p>I would like to return all Invoices for this month that have an LineItem Amount over $500.00.</p>
<p>Should I make a Command or this a Unit of Work?</p>
<p>I do not see in Using CSLA an example of how tackle this type of problem.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Thursday, March 08, 2012</h2><p>You&#39;ll obviously have an InvoiceList object that is the list of&nbsp;Invoice objects&nbsp;right? Or maybe a list of read-only InvoiceInfo objects?</p>
<p>The fetch method for the InvoiceList object is where you&#39;d execute the database query necessary to retrieve the filtered list of invoice data. All the real work should occur in the query (in the database).</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>csmith1 replied on Thursday, March 08, 2012</h2><p>I understand the work will be done in the server side in my case in the DAL.&nbsp;Usually I have seen top down query where one selects an invoice. Then selects invoice row. I like select and return a sub-set invoices with the children already loaded.&nbsp;&nbsp;I am thinking of creating a command that contains the criteria for the root and each child in hierarchy. I have a view in the db that joins all the tables together. I would select against the view. Then walk down the results filling in the selected parent then selected children then selected grandchildren. I would think this is a fairly common problem. Was not sure if there was some advantage to using the unit of work over the command. I was wonder if someone had come up with a different way to return result in a hierarchical set. &nbsp;&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tiago replied on Thursday, March 08, 2012</h2><p>Hi,</p>
<p>Have a look at <a href="http://cslagenfork.codeplex.com/releases/view/82675">DeepLoad sample v.2.0.0</a></p>
<p>This sample is generated by CslaGenFork. You can use the generated code as a guide. CslaGenFork doesn&#39;t support your needs directly, meaning you would have to edit the generated stored procedure in order return only Invoide WHERE &quot;LineItem Amount over $500.00&quot;. Besides that change in the search criteria, CslaGenFork can generate code to fetch all data in a single round trip to the database. If you don&#39;t like code generators, have a look at the sample to see how it&#39;s done.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
