<html><header><title>Handling Errors in a nice way depending on the type of error.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Handling Errors in a nice way depending on the type of error.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10606.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>tarekahf posted on Thursday, August 11, 2011</h2><p>In the UI Code (ASPX), I want to write proper error handling code to display the error in a nice way depending on the error type.</p>
<p>In my case, I see the errors has two main categories:</p>
<p>1. Unexpected errors which you need to dump the full &quot;ex.StackTrace&quot; and this will look very ugly, but is needed so that the developer can locate the source of the error in the code.</p>
<p>2. Expected errors such as incorrect data in a field or record not found ...etc. Such errors are controlled and I will display a nice error message to the user with full details to help resolve the problem. In this case, I only need to display a one-line error without any other details.</p>
<p>Why I am asking for this? This is becuase I realized that any error thrown from the Business Object / Data Access Part, it will always be &quot;DataPortalException&quot;. Sometimes, when there is an expected error while in &quot;Data Access&quot; part,&nbsp;I will throw a predefined exception, say eHRMDException(), with custom message. But I find difficulty in catching this error on the UI part, and I want to make sure I am doing the right thing.</p>
<p>I am using the following code template, and I need you help to tell me if this is OK (see the DataPortalException):</p>
<p>&nbsp;</p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Try</span></span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>theStaffID = Request.QueryString(<span style="color:#a31515;">&quot;StaffID&quot;</span>)</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">If</span> SPMSForm.Exists(theStaffID) <span style="color:blue;">Then</span></span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>theSPMSForm = SPMSForm.GetSPMSForm(theStaffID)</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Else</span></span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>theSPMSForm = SPMSForm.NewSPMSForm(theUserCtrlInfoPack)</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">End</span> <span style="color:blue;">If</span></span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>SaveSPMSFormToSession(theSPMSForm)</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>theSPMSForm.RenderPDFForm(Response, GetWebRoot, Page.Server.MapPath(<span style="color:#a31515;">&quot;.\&quot;</span>))</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Response.End()</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Catch</span> ex <span style="color:blue;">As</span> System.Security.SecurityException</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetMaster.ErrMsg = ex.Message</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ClearMedicalCardFormSession()</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Catch</span> ex <span style="color:blue;">As</span> eHRMDException</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetMaster.ErrMsg = ex.Message</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ClearMedicalCardFormSession()</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Catch</span> ex <span style="color:blue;">As</span> Csla.DataPortalException</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">If</span> <span style="color:blue;">Not</span> ex.BusinessException <span style="color:blue;">Is</span> <span style="color:blue;">Nothing</span> <span style="color:blue;">AndAlso</span> <span style="color:blue;">TypeOf</span> (ex.BusinessException) <span style="color:blue;">Is</span> eHRMDException <span style="color:blue;">Then</span></span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetMaster.ErrMsg = ex.BusinessException.Message</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Else</span></span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetMaster.ErrMsg = ex.Message &amp; <span style="color:#a31515;">&quot;&lt;br&gt;&quot;</span> &amp; ex.StackTrace</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">End</span> <span style="color:blue;">If</span></span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ClearMedicalCardFormSession()</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">Catch</span> ex <span style="color:blue;">As</span> Exception</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>GetMaster.ErrMsg = ex.Message &amp; <span style="color:#a31515;">&quot;&lt;br&gt;&quot;</span> &amp; ex.StackTrace</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ClearMedicalCardFormSession()</span></p>
<p class="MsoNormal"><span style="line-height:115%;font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">End</span> <span style="color:blue;">Try</span></span></p>
<p>&nbsp;</p>
<p>In the above code, I&nbsp;am checking the type of the BusinessException, and if it is &quot;eHRMDException&quot; which is the custom error I generated, then I will only display the error message as one line, otherwise, I will display the complete StackTrace().</p>
<p>&nbsp;If you have any comment or suggestion to&nbsp;do it in a better way, please let me&nbsp;know.</p>
<p>Tarek.&nbsp;</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
