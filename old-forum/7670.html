<html><header><title>Error Provider and textbox databound to property of type Integer : Displaying other message instead of : Input String is not in correct format</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Error Provider and textbox databound to property of type Integer : Displaying other message instead of : Input String is not in correct format</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7670.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>tutus posted on Tuesday, September 22, 2009</h2><P>Hi,</P>
<P>I have a textbox "<FONT color=#0000ff>DistanceTextBox</FONT>"&nbsp;bound to an property Distance&nbsp;of type <FONT color=#0000ff>INTEGER</FONT> in my business object <FONT color=#0000ff>MasterValue</FONT>. I also have an error provider on my form whose datasource is MasterValueBindingSource.&nbsp; MasterValueBindingSource has its datasource set to my MasterValue Instance.</P>
<P><FONT color=#0000ff>MasterValueBindingSource.DataSource = MyMasterValue </FONT></P>
<P>When the user does not include an input in the textbox distance, CSLA displays for me a warning red icon with the generic&nbsp;error: <FONT color=#ff0000>Input String Not in Correct format. </FONT></P>
<P>However the client insists that we display the message :<FONT color=#ff0000> This field is required.</FONT></P>
<P>I tried going to my textbox validating event and setting&nbsp;this&nbsp;: </P>
<P><FONT color=#0000ff>myErrorProvider.SetError("DistanceTextBox", "This field is required")</FONT> But it seems that by the time <FONT color=#0000ff>TextBox_validating</FONT> executes it's too late and we get, anyway,&nbsp;the generic message: <FONT color=#ff0000>Input string is not in correct format</FONT></P>
<P>Can you please suggest a solution either:</P>
<P>1- How to intercept the framework before it displays the generic warning: <FONT color=#ff0000>Input string is not in correct format</FONT> so that I display the message I want.</P>
<P>Or</P>
<P>2- How to go and change that generic CSLA&nbsp;message which seems to apply when the user does not enter a value in a TextBox which is&nbsp;bound to an INTEGER property.</P>
<P>I appreciate your taking the time to help :)</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Tuesday, September 22, 2009</h2>Are you sure CSLA is generating this message?<br /><br />I get this all the time using DevExpress controls, and the issue is that the value in the TextEdit control (DevExpress version of TextBox) cannot be converted to the bound property type. <br /><br />For example, if you have bound your TextBox to an Int property, and then you type characters rather than a valid integer in the control, then it can't be converted to an integer and you would get an error like this.<br /><br />There is no way of posting this value to your BO (short of binding to a string field rather than integer), so you have to handle this i the UI somehow.<br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, September 22, 2009</h2>Hi, <br><br>This is actually caused by DataBinding beeing  unable to convert the Text value to your datatype.  I have seen the same message from standard windows TextBox'es when an explicit type is set (like Int or Numeric). There are 2 ways (that I know of) to handle this: <br><br>1. Add code in TextBox Validating event to set the Text property to a valid number. <br><br>2. Use nullable types in your BO and in the constructor of your form (after InitializeComponents) add a single line of code that alters the databinding to set null value to string.Empty. That way an Empty textbox will be converted to null-value. Unfortunately - that property does not accept string.Empty in  WindowsForms Designer so it must be set manually. <br><br>I can post the needed code later today when I get to work. <br><br>/jonnybee<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, September 24, 2009</h2>Hi, <br><br>Here is sample code for how to use a nullable type property (not nullable backing field) and get correct error messages. <br><br>Sample code sets Bindig.NullValue to String.Empty and handle null value in the property get/set in BO and custom ValidationRule. <br> <br>You may also add your own code to the "Parse" event on the Bindings element but I haven't used that much before. <br><br>/jonnybee<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tutus replied on Thursday, September 24, 2009</h2>yeah, that s what I used last, u ssolved my problem man, I appreciate :)</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tutus replied on Thursday, September 24, 2009</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>JonnyBee:</strong></div><div>Hi, <BR><BR>Here is sample code for how to use a nullable type property (not nullable backing field) and get correct error messages. <BR><BR>/jonnybee<BR><BR></div></BLOCKQUOTE></P>
<P>I could not use this line in VB.Net in CSLA 3.5 version :</P>
<P>MethodCaller.CallPropertyGetter(target, e.PropertyName)</P>
<P>any idea pls ?</P>
<P>thanks</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, September 24, 2009</h2>Hi,<br><br>Use this:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim value As Int? = _<br>&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CallByName(target, e.PropertyName, CallType.Get) as Int?<br><br>Rocky created MethodCaller (amongst other reasons) as a C# version of  CallByName method in VB.NET. <br><br>/jonnybee<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
