<html><header><title>changing an ID and Name at the same time, how do people handle?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>changing an ID and Name at the same time, how do people handle?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3204.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>mtagliaf posted on Monday, July 16, 2007</h2><font face="Verdana" size="2">Say I've got an Order object that contains properties for CustomerID and Customer name.&nbsp; In the UI, I want to pop up a "picker" dialog so the user can pick a customer, and then set the custID and name at the same time on the order object.&nbsp; I usually like to do this with a "Set" procedure on the Order object:<br><br>sub SetCustomer(uID as guid, cName as string)<br>&nbsp; if not fCustID.equals(uID)<br>&nbsp;&nbsp;&nbsp; </font><font face="Verdana" size="2">fCustID = uID<br>&nbsp;&nbsp;&nbsp; fCustName = cName<br>&nbsp;&nbsp;&nbsp; PropertyHasChanged("CustName")<br>&nbsp; end if<br>end sub<br><br>I like to do it this way so the UI coder can't accidentally set one without the other.&nbsp; <br><br>It seems, though, that when I bind a Textbox to CustName on the form, it's not refreshing properly when the name is changed.&nbsp; The data in the Order object looks ok, it's just not making it to the form.&nbsp; I don't have to do the "IsDirty checkbox" hack anymore, do I?<br><br>matt tag<br></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, July 16, 2007</h2><P>You need to call PropertyHasChanged for both properties.</P>
<P>Or, don't call PropertyHasChanged at all, but rather</P>
<P>ValidationRules.CheckRules("id")<BR>ValidationRules.CheckRules("name")<BR>MarkDirty()</P>
<P>In other words, run the rules for both changed properties and then mark the object as dirty.</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
