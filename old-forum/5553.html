<html><header><title>Accessing Grandparent property...</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Accessing Grandparent property...</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5553.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rlriggs posted on Wednesday, October 08, 2008</h2>Been struggling with a design issue (which is my biggest problem from cutting my teeth in a non-OOP world).     The basic question, is it possible to update a property value in a grandparent object from the grandchild - and more importantly, should this ever be done.<br /><br />My basic structure is this:<br />ProductInventory (location, product, Available, Reserved, etc.) - BB<br />--InventoryTransactions (editable collection)<br />-----InventoryTransaction (editable child) contains Date, Quantity, ActionType, etc.)<br /><br />What I need to have happen is updating the Available, Reserved values based on the InventoryTransaction.<br /><br /><br />I had originally worked through this with my sprocs updating the values in the base tables, but am running into synch problems, also tried working through this with command objects, which probably could work.<br /><br />Anyone have a simple example of accessing the grandparent properties to update values?  I'm aware of the Parent property, but that doesn't get me to the root.   I know it's likely something silly I'm not considering, and would appreciate the guidance.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>sergeyb replied on Wednesday, October 08, 2008</h2>To get to grand parent you just need to expose parent property in your editable collection:<br />Internal ProductInventory MyParent<br />{<br />Get<br />{<br />Return this.Parent As ProductInventory<br />}<br />}<br />My approach usually is to just signal grandparent to compute something instead of directly modifying a property the parent is responsible for maintaining.<br /><br />So in your ProductInventory you would have<br />Internal void UpdateReservedAndAvalaible(InventoryTransaction tran)<br /><br />In your InventoryTransaction you would call that from property setter for quantity:<br />This.Parent.MyParent. UpdateReservedAndAvalaible(this)<br /><br />Sergey Barskiy<br />Principal Consultant<br />office: 678.405.0687 | mobile:&#160;404.388.1899<br /><br />Microsoft Worldwide Partner of the Year | Custom Development Solutions, Technical Innovation<br /><br />-----Original Message-----<br />From: rlriggs [mailto:cslanet@lhotka.net] <br />Sent: Wednesday, October 08, 2008 10:14 AM<br />To: Sergey Barskiy<br />Subject: [CSLA .NET] Accessing Grandparent property...<br /><br />Been struggling with a design issue (which is my biggest problem from cutting my teeth in a non-OOP world).     The basic question, is it possible to update a property value in a grandparent object from the grandchild - and more importantly, should this ever be done.<br /><br />My basic structure is this:<br />ProductInventory (location, product, Available, Reserved, etc.) - BB<br />--InventoryTransactions (editable collection)<br />-----InventoryTransaction (editable child) contains Date, Quantity, ActionType, etc.)<br /><br />What I need to have happen is updating the Available, Reserved values based on the InventoryTransaction.<br /><br /><br />I had originally worked through this with my sprocs updating the values in the base tables, but am running into synch problems, also tried working through this with command objects, which probably could work.<br /><br />Anyone have a simple example of accessing the grandparent properties to update values?  I'm aware of the Parent property, but that doesn't get me to the root.   I know it's likely something silly I'm not considering, and would appreciate the guidance.<br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rlriggs replied on Wednesday, October 08, 2008</h2>Thanks for the quick reply, looks very straight forward.   However, when I try to do this in VB, the Parent property is not available in my EditableRootCollection object (BusinessListBase).</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonStonecash replied on Wednesday, October 08, 2008</h2>You might also want to consider using events to signal the need for processing.&nbsp; Directly accessing the parent of the parent creates a coupling between the grandparent, child, and grandchild.&nbsp; That may be want you need, but if you can avoid it you should.<br><br>In the event model, the grandchild would do something and then raise an event.&nbsp; The list of grandchildren would catch that event, do whatever it wanted to, and then raise its own event.&nbsp; The child would catch that event, ya da, ya da, ya da and so on.&nbsp; If this event bubbling seems like too much overhead, you could have the grandparent catch the event directly; the child would perhaps have to help out on this.&nbsp; <br><br>In any case, the grandchild would not be so tightly coupled and the overall software would not be so fragile.<br><br>Just a thought.<br><br>Jon Stonecash<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
