<html><header><title>ErrorProvider does not disappear after validation rule has been satisfied (combobox)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ErrorProvider does not disappear after validation rule has been satisfied (combobox)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6005.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Valentin_Vasiliev posted on Wednesday, December 17, 2008</h2>I have a problem with ErrorProvider.<br><br>My BO has Enum field exposed as a property. Also it has a nullable integer property.<br>Enum is controlled by clicking the radio buttons in UI. This enum has only two values, and as a results two radio buttons in UI. The validation rule blindly returns true for first enum state and performs validation <br>logic in second state.<br>Problem:<br>I click the second radio button (check validation rule) - ErrorProvider starts blinking. Then I click other radio button (Validation rule returns true) - Error provider keeps on blinking, but the BO is now Valid.<br>Please hint what could be done to 'refill' the ErrorProvider with updated BO state.<br><br>Thank you.<br><br>Valentin.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Valentin_Vasiliev replied on Wednesday, December 17, 2008</h2>Currently I'm getting around this by explicitly calling UpdateBinding method of ErrorProvider.<br>I would like the ErrorProvider to automatically update the icon when properties change.<br><br>Valentin.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>whelzer replied on Wednesday, December 17, 2008</h2>In VB 2005/2008 - check out the Advanced settings under (DataBindings) property, change Data Source Update Mode from OnValidation to OnPropertyChanged.<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Valentin_Vasiliev replied on Wednesday, December 17, 2008</h2>I had already tried this, it didn't help, unfortunately.<br><br>Thank you.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, December 17, 2008</h2>Is a property changed event being raised for the property with the broken rule?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Valentin_Vasiliev replied on Wednesday, December 17, 2008</h2>I think I will try to provide a bogus code to be more clear:<br>class Customer : BusinessBase&lt;Customer&gt;<br>{<br><blockquote>//code for enum&nbsp; as Csla property<br>private CustomerStatus _status;<br>public CustomerStatus Status<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //csla get;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //csla set;<br>}<br><br>private int? _goldMemberRank;<br>public int? GoldMemberRank<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp; //csla get;<br>&nbsp;&nbsp;&nbsp;&nbsp; //csla set;<br>}<br><br>//validation rules<br>ValidationRules.AddRule(CheckIfGoldMemberRankPresentOnlyIfStatusGold,"GoldMemberRank");<br><br>private static bool CheckIfGoldMemberRankPresentOnlyIfStatusGold(parameters here)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(target._status==CustomerStatus.Gold)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(_goldMemberRank.HasValue)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.Description="rank not set";<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;<br>&nbsp;}<br>}<br><br>public enum CustomeStatus<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Regular,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GoldMember<br>}<br><br><br>This pseudo code shows my setup.<br><br>The enum is controlled by radio buttons in UI. When I click "gold member radio button" the validation rule is actually run. When I click "regular" the validation rule blindly returns 'true'.<br>&nbsp;Problem:<br>When I click "gold" error provider starts blinking, when I immediately click 'regular' after then, it keeps blinking (but validation rule returns true and BO is valid).<br><br>Thank you.<br><br><br></blockquote></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
