<html><header><title>Correct use of CSLA classes</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Correct use of CSLA classes</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9617.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Russ posted on Friday, October 08, 2010</h2><p><span style="font-size:small;"><span style="font-family:Calibri;">
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;">I want to build a view that contains a toolbar a list and a statusbar. The toolbar will contain a new button, preview button, refresh button, search text box, begin search button, an owner combobox and a hide inactive checkbox. The statusbar will contain next and previous buttons to page through the results 50 records at a time. The status bar will also contain textblocks for page number and total number of pages.</p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;">&nbsp;</p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;">I have already programmed this using WPF and CSLA 3.0 and I now want to move it to CSLA 4.0.1 and MVVM. The existing XAML form has a CSLADataProvider for the list (ReadOnlyList) and the owner combobox (NVList).</p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;">&nbsp;</p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;">I would like to know the correct way to approach the programming using the CSLA classes.</p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;">&nbsp;</p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;">I was thinking of creating:</p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;">&nbsp;</p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-list:l0 level1 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;">1.<span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>a ViewModel to provide the view with the Model and the bind able commands for the search button, new button and refresh button</p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-list:l0 level1 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;">2.<span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>a Business object (EditableRootParent) to provide:</p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 1in;mso-list:l0 level2 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;">a.<span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>read / write properties for the search textbox, selected owner, hide inactive and page number</p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 1in;mso-list:l0 level2 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;">b.<span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>read only properties for the owner NVList, number of pages, records per page and the read only list</p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 1in;mso-list:l0 level2 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;">c.<span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>Business Rules to reload the list if the owner, hide inactive, or page number properties change</p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 1in;mso-list:l0 level2 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;">d.<span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span>Methods to reload the list if the search button or refresh button was pressed</p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;">&nbsp;</p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;">Is this the right approach or is there a better combination of CSLA classes to achieve this?</p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;">&nbsp;</p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;">Thanks</p>
<font size="3"><font face="Calibri">
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;">Russ.</p>
</font></font></span><font size="3">
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;">&nbsp;</p>
</font></span>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;">&nbsp;</p>
</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Friday, October 08, 2010</h2><p>Your object model shouldn&#39;t be affected by a change of UI technology. The only time your object model should be affected is if the business use case has changed.</p>
<p>Conceptually you can think of a ViewModel&lt;T&gt; as being very similar to a CslaDataProvider. They aren&#39;t quite the same, but they aren&#39;t all that different either.</p>
<p>The idea behind the viewmodel is that it adds verbs/commands/methods <i>for use by the view</i> to your business object. Typically a CSLA business object already has all the methods necessary to handle the use case, but often doesn&#39;t have everything necessary to support the various UI gestures a user might take. So the viewmodel acts as a buffer between the view and model.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Russ replied on Friday, October 08, 2010</h2><p>I think my object model needs to change because it was incorrectly designed the first time.</p>
<p>Some of my old list forms have as many as 6 CSLADataProviders on them to provide NVLists to the filter comboboxes on the toolbar. </p>
<p>I was hoping to bind the new View to a single ViewModel that provided all the required data. If this is not possible then maybe I should have a ViewModel for the Toolbar/StatusBar and a ViewModel for the List area?</p>
<p>I&#39;m looking for the simplest approach to minimize or completely eliminate the code behind.</p>
<p>Russ.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Friday, October 08, 2010</h2><p>When I have a page/form that has multiple objects (business list, some NVLs, etc) I often use a unit of work object (usually a ROB) to retrieve them as a unit. So my &quot;parent&quot; viewmodel gets that UOW object, then I have a &quot;child&quot; viewmodel for the buisness object. Usually you don&#39;t need a specific viewmodel to manage individual read-only lists, because they don&#39;t need any extra commands (or any commands really).</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jpmir replied on Wednesday, October 13, 2010</h2><p>Thank you Rocky, that answer solves many questions in my head.</p>
<p>Jean Paul</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Russ replied on Thursday, October 14, 2010</h2><p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Thanks Rocky.</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I think the UOW is what I&rsquo;m looking for however... my list form toolbar contains a search text box, and active check box and a user combo box. I think I want to bind these to read/write properties and let the business rules initiate a GetList() on the main ReadOnlyList when they change. I cannot accomplish this if I base the UOW on an ROB. </span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">If I base the UOW on a BusinessBase with read/write fields for PageNum, RowsPerPage, UserFK, SearchText and Active and read only fields for NumOfPages, TotalRows and MainList then I could set up all the correct bindings to the form and let the business rules refresh the MainList, NumOfPages and TotalRows when any of the read/write fields change.</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">My questions are 1) does this sound like a good way to proceed and 2) Can I just set the ManageLifetime = false on the CSLADataProvider to ignore the Meta-state of the UOW object (i.e. IsDirty etc.)</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Russ</span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, October 14, 2010</h2><p>I typically use a ROB for my UOW types, because you rarely want to round-trip all the supporting types (NVL and so forth) back to the server when you save.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Russ replied on Thursday, October 14, 2010</h2><p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I think I understand.<span style="mso-spacerun:yes;">&nbsp; </span>So I want a UOW (ROB) object that contains:</span></span></p>
<p class="MsoListParagraphCxSpFirst" style="text-indent:-0.25in;margin:0in 0in 0pt 0.75in;mso-list:l0 level1 lfo1;mso-add-space:auto;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">1)</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;</span>Properties for all my supporting NVList types so that they are only transferred from the server to the client only once.</span></span></p>
<p class="MsoListParagraphCxSpMiddle" style="text-indent:-0.25in;margin:0in 0in 0pt 0.75in;mso-list:l0 level1 lfo1;mso-add-space:auto;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">2)</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">A BusinessBase property with:</span></span></p>
<p class="MsoListParagraphCxSpMiddle" style="text-indent:-0.25in;margin:0in 0in 0pt 1.25in;mso-list:l0 level2 lfo1;mso-add-space:auto;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">a.</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">Read/write fields for PageNum, RowsPerPage, UserFK, SearchText and Active</span></span></p>
<p class="MsoListParagraphCxSpMiddle" style="text-indent:-0.25in;margin:0in 0in 0pt 1.25in;mso-list:l0 level2 lfo1;mso-add-space:auto;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">b.</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">Read only fields for NumOfPages, TotalRows and MainList (ROL)</span></span></p>
<p class="MsoListParagraphCxSpLast" style="text-indent:-0.25in;margin:0in 0in 10pt 1.25in;mso-list:l0 level2 lfo1;mso-add-space:auto;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">c.</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">Business rules to reload the MainList, NumOfPages and TotalRows properties when any of the read/write fields change</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Question: Is this even possible?<span style="mso-spacerun:yes;">&nbsp; </span>Can a ROB contain a BusinessBase property?</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">If this isn&rsquo;t possible then maybe I need to abandon my existing UI which is based on the older CSLADataProvider model and create a new UI based on the MVVM model so I can have &ldquo;Child ViewModels&rdquo;.</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Russ</span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Russ replied on Thursday, October 14, 2010</h2><p>I just reviewed your CSLA Core 3.8 Video 4 on Data Portal Configuration and found the Unit of Work information starting at 99 minutes and 30 seconds. It answers all&nbsp;my questions.</p>
<p>Thanks</p>
<p>Russ</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
