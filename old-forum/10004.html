<html><header><title>eBook Suggestion (Class in Charge).</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>eBook Suggestion (Class in Charge).</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10004.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rxelizondo posted on Saturday, January 29, 2011</h2><p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Hello,</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Until recently, I never really took the time to investigate the reason why the CSLA uses the factory pattern to create business object, so I was happy to see that this reasoning is explained in the latest eBook.</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">From what I am able to tell (based on the eBook info), the decision to use the factory pattern appears to be heavily influenced by two things:</span></span></p>
<p class="MsoListParagraphCxSpFirst" style="text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-list:l0 level1 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">1)</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">Simplifies the UI Code.</span></span></p>
<p class="MsoListParagraphCxSpLast" style="text-indent:-0.25in;margin:0in 0in 10pt 0.5in;mso-list:l0 level1 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">2)</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">Eliminates the amount of plumbing code.</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I think the first point is a strong point, and it justify using either the &ldquo;object in charge&rdquo; or &ldquo;class in charge&rdquo; methods.</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">The second point however seems weak to me, and it does not really justify favoring the &ldquo;class in charge&rdquo; method over the &ldquo;object in charge&rdquo; method and here is why, take a look at the code below:</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">[<span style="color:#2b91af;">Serializable</span>()]</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:9.5pt;"> <span style="color:blue;">class</span> <span style="color:#2b91af;">Customer</span> : BusinessObject</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">public</span> Customer()</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:green;">// A make believe CSLA business object function </span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:green;">// that copies the state of a retrieved customer</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:green;">// object to the current instance.</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">this</span>.CopyState(<span style="color:#2b91af;">Customer</span>.NewCustomer());</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Calibri;"><span style="font-size:small;">The code above shows the object capable of being instantiated via a constructor (object in charge). Internally, the constructor leverages the current implementation of &ldquo;class in charge&rdquo; method. In short, the code retrieves the object using &ldquo;class in charge&rdquo; and transfer the state found on that object to the current object using my make-believe &ldquo;CopyState&rdquo; method. The &ldquo;CopyState&rdquo; method basically iterates through all the variables on the object (including collection variables) and copies them to the current object.</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Calibri;"><span style="font-size:small;">The result is an object that can be instantiated using the familiar constructor (&ldquo;object in charge&rdquo; method) with no more code that what it would normally take if the &ldquo;class in charge&rdquo; method was used.</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-family:Calibri;"><span style="font-size:small;">So, I feel like there should be more compelling arguments justifying why factory methods are used throughout the CSLA and I think I may have some&hellip;&hellip;</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-family:Calibri;"><span style="font-size:small;">Let&rsquo;s take a look at the following &ldquo;object in charge&rdquo; method instantiation example:</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-family:Calibri;"><span style="font-size:small;">var x = new Customer(123);</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-family:Calibri;"><span style="font-size:small;">The problem with the statement above is that it can be ambiguous. What exactly are we trying to do with the statement above? </span></span></p>
<p class="MsoListParagraphCxSpFirst" style="text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-list:l1 level1 lfo2;"><span style="font-family:Symbol;mso-bidi-font-family:Symbol;mso-fareast-font-family:Symbol;"><span style="mso-list:Ignore;"><span style="font-size:small;">&middot;</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family:Calibri;"><span style="font-size:small;">Are we trying to create a new customer with a default id of 123? </span></span></p>
<p class="MsoListParagraphCxSpMiddle" style="text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-list:l1 level1 lfo2;"><span style="font-family:Symbol;mso-bidi-font-family:Symbol;mso-fareast-font-family:Symbol;"><span style="mso-list:Ignore;"><span style="font-size:small;">&middot;</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family:Calibri;"><span style="font-size:small;">Are we trying to retrieve a customer with an id of 123? </span></span></p>
<p class="MsoListParagraphCxSpLast" style="text-indent:-0.25in;margin:0in 0in 10pt 0.5in;mso-list:l1 level1 lfo2;"><span style="font-family:Symbol;mso-bidi-font-family:Symbol;mso-fareast-font-family:Symbol;"><span style="mso-list:Ignore;"><span style="font-size:small;">&middot;</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-family:Calibri;"><span style="font-size:small;">What if need the ability to do both, create and retrieve a customer using the same constructor signature?</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-family:Calibri;"><span style="font-size:small;">To me, this is where the factory methods shine. They give us the ability to create object construction directives that are semantically accurate. In other words, there is not ambiguity between &ldquo;Customer.NewCustomer(123)&rdquo; and &ldquo;Customer.GetCustomer(123)&rdquo;.</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">So, the point of my post is that in the unlikely event that you agree with me </span><span style="font-family:Wingdings;mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin;mso-char-type:symbol;mso-symbol-font-family:Wingdings;"><span style="mso-char-type:symbol;mso-symbol-font-family:Wingdings;">J</span></span><span style="font-family:Calibri;">, I would add the semantics benefit provided by using factory methods as another compelling reason to go the factory way, because the ones that are listed right now on the eBook don&rsquo;t seem to carry too much weight, at least not on my head.</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Thanks.</span></span></p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Sunday, January 30, 2011</h2><p>There&#39;ve been several discussions over the past decade on the value of in-place serialization schemes. And there is a very real value to doing this, but the problem is that it means discarding the entire serialization model provided by Microsoft and creating an alternative.</p>
<p>Serialization/deserialization is a copy process - you end up with a new object instance. By itself this is just a tool (look at MobileFormatter for example) that can be used in many different ways.</p>
<p>But you always must consider that any solution needs to apply to an object graph, not just an object. This particular problem area is pretty trivial to solve for an object. It is not trivial to solve for an object graph, especially when objects have no universal concept of identity.</p>
<p>Take a list of objects, serialize it and deserialize it. Now tell me which of the copied objects equates to which of the original objects. There&#39;s no absolute solution to this problem. Suppose the deserialization process changed the order of the items in the list (which can happen). So you can&#39;t use ReferenceEquals, you can&#39;t use absolute ordering of objects, and you can&#39;t use logical equality (since in the general case two of the original objects could have had the same property values).</p>
<p>I&#39;m not saying the problem can&#39;t be solved. I&#39;m saying that the solution is non-trivial, and requires the invention of a universal identity mechanism for all objects in every object graph.</p>
<p>If you look at the DiffGram sample app you can see that this is exactly what I did for that sample. I imposed a construct over every object in the graph that requires a universal identity for each object - thus allowing for in-place serialization of data.</p>
<p>I wouldn&#39;t mind doing this in CSLA - except that it would be a breaking change beyond any breaking change I&#39;ve ever imposed. Basically no existing CSLA code would move forward - nor would any UI code built on existing objects. In short, it would be a new framework with a lot of similarities to the existing framework.</p>
<p>That&#39;s not a step I have yet been willing to take.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
