<html><header><title>How can I MarkNew the whole object graph during a DataPortal_Update?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How can I MarkNew the whole object graph during a DataPortal_Update?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11457.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>j0552 posted on Thursday, July 05, 2012</h2><p>Hi</p>
<p>I have a large object graph. There is a situation where, depending on the the status of the root object, I would like to mark the whole object graph as new when an update is called. e.g.</p>
<p><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">protected</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">override</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">void</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> DataPortal_Update()<br />{<br /></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">&nbsp;&nbsp;&nbsp; if</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> (SaveAction == </span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">SaveAction</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">.Draft){<br /></span></span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Mark everything as new. <br />&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">}<br /></span></span></span></span><span style="font-family:Consolas;font-size:x-small;">}</span></p>
<p>Is there an elegant way to handle this? What are my options?</p>
<p>Thanks<br />Andrew</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TSF replied on Thursday, July 05, 2012</h2><p>From Rocky&#39;s e-book:</p>
<p style="padding-left:30px;"><span style="font-size:small;">The MarkNew method is a protected method of BusinessBase, and you can call this method to mark an object as being new. You should not normally need to directly call MarkNew, because it is invoked automatically in most cases.</span></p>
<p><span style="font-size:small;">Also stated in his e-book, by default, calling MarkNew also invokes MarkDirty.&nbsp; So if you don&#39;t want that to happen, you&#39;ll need to override the MarkNew method and then call MarkClean to make sure the object isn&#39;t marked as dirty.</span></p>
<p><span style="font-size:small;">[Edit]&nbsp; I just realized you were asking about marking all child objects as new, so I&#39;m not sure if the MarkNew method on the root takes care of that on the children.&nbsp; I guess since you&#39;re asking, perhaps it doesn&#39;t.</span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, July 05, 2012</h2><p>no, </p>
<p>this is not possible inside DatapPortal_XYZ as the datapotal will help you to maintain proper state.&nbsp;</p>
<p>IE: The DataPortal will call MarkOld after DataPortal_Update is completed.&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>j0552 replied on Thursday, July 05, 2012</h2><p>OK, so the best thing I have come up with is:</p>
<p>1. Override save<br />2. after validation but before transfer to the DataPortal, go though the root and all children and call MarkNew()</p>
<p>I have to derive all the children&nbsp;from a custom BusinessBase which gives me an internal MarkNew(), e.g.:</p>
<p><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">internal </span></span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">new</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">void</span></span></span>&nbsp; <span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">MarkNew() <br />{<br />&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">base</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">.MarkNew();<br />}</span></span></p>
<p>Does this sound reasonable? What should the overridden Save method look like? Or is there a BB method which sits between Save and the DataPortal I can use?</p>
<p>Andrew</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, July 05, 2012</h2><p>Have you consiered a switchto ObjectFsctories. In object fatories the DataPortal will not help you with state management and you could call MarkNew in the Update method?&nbsp;</p>
<p>I&#39;m not sure why you need to call MarkNew in the DataPortal_Update metod. <br />Could this just be part of your persistance logic in the DataPortal_Update?&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>j0552 replied on Friday, July 06, 2012</h2><p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I&#39;m not sure I can just treat this all as persistence logic. Likewise I can&#39;t see how using ObjectFactories can help, although I haven&#39;t had to use them yet.</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"></span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I&#39;ve attached a diagram to illustrate the workflow I require. </span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Depending on the Status and the choice of &#39;Save&#39; or &#39;Publish&#39; we need to</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">decide whether to over-write the original object, or whether to create a new</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">linked copy (which will eventually over-write the original when it is</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">published).</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I just need to know the best way to do this using business objects.<span style="mso-spacerun:yes;">&nbsp;</span>I hope you can help point me in the right direction.</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Thanks</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Andrew</span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Saturday, July 07, 2012</h2><p>Hi,</p>
<p>One of the key issues is to identify what happens on the 
client versus the server and what should be handled as &quot;persistence 
logic&quot;.&#39;</p>
<p>Is there f.ex different rules&nbsp; based on the IsNew/Old to be enforced before Save?&nbsp;</p>
<p>One
 option is to create command objects to do the persistence logic and 
send the &quot;Root&quot; object as parameter. (This would also allow you to 
change the metastate of the object tree to IsNew in the serverside 
update). </p>
<p>Using the DataPortal_XYZ methods the DataPortal_XYZ are 
&quot;member&quot; calls and the DataPortal will help you maintain the correct 
state. IE The DataPortal will create the object - call the XYZ method 
and then set the correct state. </p>
<p>ObjectFactories are external classes that must create the objects, load 
data and set the metastate - then return the object to the client. This 
gives a little more flexibility but also adds complexity in that your 
code must maintain the state. </p>
<p>Using ObjectFactories will f.ex 
allow you to return a new instance of the BO from a Save - wheres 
DataPortal_XYZ is an instance method an cannot return another object.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>j0552 replied on Monday, July 09, 2012</h2><p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;mso-ascii-theme-font:minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:&#39;Times New Roman&#39;;mso-bidi-theme-font:minor-bidi;mso-themecolor:dark2;">Hi Jonny</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;mso-ascii-theme-font:minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:&#39;Times New Roman&#39;;mso-bidi-theme-font:minor-bidi;mso-themecolor:dark2;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;mso-ascii-theme-font:minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:&#39;Times New Roman&#39;;mso-bidi-theme-font:minor-bidi;mso-themecolor:dark2;">I think my specification requires behaviour modification rather than just changes to data, i.e. this is business logic not persistence logic. Therefore I need to do everything client side. I&rsquo;ve created a new method based on the CSLA Save method. Basically I do all modifications to the object tree before it&rsquo;s passed to the DataPortal.Update method. </span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;mso-ascii-theme-font:minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:&#39;Times New Roman&#39;;mso-bidi-theme-font:minor-bidi;mso-themecolor:dark2;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">private</span> <span style="color:#2b91af;">StandardPublication</span> SaveInternal()</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">StandardPublication</span> local;</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:green;">// Do validation, busy tests etc.</span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (IsDirty)</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (!IsLinkedCopy &amp;&amp; SaveAction == <span style="color:#2b91af;">SaveAction</span>.Save)</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:green;">// create a new linked copy</span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">StandardPublication</span> copy = CreateLinkedCopy(<span style="color:blue;">this</span>);</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>local = <span style="color:#2b91af;">DataPortal</span>.Update(copy);</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">else</span> <span style="color:blue;">if</span> (IsLinkedCopy &amp;&amp; SaveAction == <span style="color:#2b91af;">SaveAction</span>.Publish)</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:green;">// merge linked copy into the original and delete linked copy </span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">StandardPublication</span> orig = MergeLinkedCopy(<span style="color:blue;">this</span>);</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>local = <span style="color:#2b91af;">DataPortal</span>.Update(orig);</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">else</span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>local = <span style="color:#2b91af;">DataPortal</span>.Update(<span style="color:blue;">this</span>);</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">else</span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;</span>{</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>local = <span style="color:blue;">this</span>;</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>OnSaved(local, <span style="color:blue;">null</span>, <span style="color:blue;">null</span>);</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">return</span> local;</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;mso-fareast-font-family:&#39;Times New Roman&#39;;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;mso-ascii-theme-font:minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:&#39;Times New Roman&#39;;mso-bidi-theme-font:minor-bidi;mso-themecolor:dark2;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;mso-ascii-theme-font:minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:&#39;Times New Roman&#39;;mso-bidi-theme-font:minor-bidi;mso-themecolor:dark2;">The advantages are that nothing needs doing server-side, the business logic is contained, i.e. only need to change one method in the root BusinessBase class.<span style="mso-spacerun:yes;">&nbsp; </span>The only pain I can see at the moment is mapping the whole object graph to the new one and again when merging the linked version back to the original one. I have to be careful about how I create the new object tree. It has to be created in a similar way to how an object is created in the UI, rules must run in correct order. </span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;mso-ascii-theme-font:minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:&#39;Times New Roman&#39;;mso-bidi-theme-font:minor-bidi;mso-themecolor:dark2;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;mso-ascii-theme-font:minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:&#39;Times New Roman&#39;;mso-bidi-theme-font:minor-bidi;mso-themecolor:dark2;">Can you tell me if you see a problem with this approach in general? It looks promising so far.</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;mso-ascii-theme-font:minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:&#39;Times New Roman&#39;;mso-bidi-theme-font:minor-bidi;mso-themecolor:dark2;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;mso-ascii-theme-font:minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:&#39;Times New Roman&#39;;mso-bidi-theme-font:minor-bidi;mso-themecolor:dark2;">Thank you</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;mso-ascii-theme-font:minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:&#39;Times New Roman&#39;;mso-bidi-theme-font:minor-bidi;mso-themecolor:dark2;">Andrew</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;mso-ascii-theme-font:minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:&#39;Times New Roman&#39;;mso-bidi-theme-font:minor-bidi;mso-themecolor:dark2;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;mso-ascii-theme-font:minor-latin;mso-hansi-theme-font:minor-latin;mso-bidi-font-family:&#39;Times New Roman&#39;;mso-bidi-theme-font:minor-bidi;mso-themecolor:dark2;"></span></p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
