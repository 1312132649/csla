<html><header><title>Csla4 and Net4 - ASPNET permission problem</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Csla4 and Net4 - ASPNET permission problem</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11015.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>hayrob posted on Saturday, December 24, 2011</h2><p>My application works beautifully when the Net version was not Net4. It continues to work perfectly if I create a new Windows 7 based server from scratch. Configure the permissions and away you go.</p>
<p>But (and there is always a but...), my customer has an existing server where the application does not even start when I move to Csla4 and Net4. All the permissions seem to be identical on my &quot;clean&quot; server and on his &quot;legacy but upgraded&quot; server. But the client gets a security error:</p>
<p>System.Security.SecurityException: Request failed.<br />&nbsp;&nbsp; at System.RuntimeMethodHandle.PerformSecurityCheck(Object obj, RuntimeMethodHandleInternal method, RuntimeType parent, UInt32 invocationFlags)<br />&nbsp;&nbsp; at System.RuntimeMethodHandle.PerformSecurityCheck(Object obj, IRuntimeMethodInfo method, RuntimeType parent, UInt32 invocationFlags)<br />&nbsp;&nbsp; at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)<br />&nbsp;&nbsp; at System.Reflection.ConstructorInfo.Invoke(Object[] parameters)<br />&nbsp;&nbsp; at System.Configuration.TypeUtil.InvokeCtorWithReflectionPermission(ConstructorInfo ctor)<br />&nbsp;&nbsp; at System.Configuration.RuntimeConfigurationRecord.RuntimeConfigurationFactory.CreateSectionImpl(RuntimeConfigurationRecord configRecord, FactoryRecord factoryRecord, SectionRecord sectionRecord, Object parentConfig, ConfigXmlReader reader)<br />&nbsp;&nbsp; at System.Configuration.RuntimeConfigurationRecord.RuntimeConfigurationFactory.CreateSectionWithRestrictedPermissions(RuntimeConfigurationRecord configRecord, FactoryRecord factoryRecord, SectionRecord sectionRecord, Object parentConfig, ConfigXmlReader reader)<br />&nbsp;&nbsp; at System.Configuration.RuntimeConfigurationRecord.CreateSection(Boolean inputIsTrusted, FactoryRecord factoryRecord, SectionRecord sectionRecord, Object parentConfig, ConfigXmlReader reader)<br />&nbsp;&nbsp; at System.Configuration.BaseConfigurationRecord.CallCreateSection(Boolean inputIsTrusted, FactoryRecord factoryRecord, SectionRecord sectionRecord, Object parentConfig, ConfigXmlReader reader, String filename, Int32 line)<br />The action that failed was:<br />Demand<br />The type of the first permission that failed was:<br />System.Security.PermissionSet<br />The demand was for:<br />&lt;PermissionSet class=&quot;System.Security.PermissionSet&quot;<br />version=&quot;1&quot;<br />Unrestricted=&quot;true&quot;/&gt;</p>
<p>The only permitted permissions were:<br />&lt;PermissionSet class=&quot;System.Security.NamedPermissionSet&quot;<br />version=&quot;1&quot;<br />Name=&quot;Internet&quot;<br />Description=&quot;Default rights given to Internet applications&quot;&gt;<br />&lt;IPermission class=&quot;System.Security.Permissions.FileDialogPermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;<br />version=&quot;1&quot;<br />Access=&quot;Open&quot;/&gt;<br />&lt;IPermission class=&quot;System.Security.Permissions.IsolatedStorageFilePermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;<br />version=&quot;1&quot;<br />Allowed=&quot;ApplicationIsolationByUser&quot;<br />UserQuota=&quot;1024000&quot;/&gt;<br />&lt;IPermission class=&quot;System.Security.Permissions.SecurityPermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;<br />version=&quot;1&quot;<br />Flags=&quot;Execution&quot;/&gt;<br />&lt;IPermission class=&quot;System.Security.Permissions.UIPermission, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;<br />version=&quot;1&quot;<br />Window=&quot;SafeTopLevelWindows&quot;<br />Clipboard=&quot;OwnClipboard&quot;/&gt;<br />&lt;IPermission class=&quot;System.Drawing.Printing.PrintingPermission, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&quot;<br />version=&quot;1&quot;<br />Level=&quot;SafePrinting&quot;/&gt;<br />&lt;IPermission class=&quot;System.Security.Permissions.MediaPermission, WindowsBase, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&quot;<br />version=&quot;1&quot;<br />Audio=&quot;SafeAudio&quot;<br />Video=&quot;SafeVideo&quot;<br />Image=&quot;SafeImage&quot;/&gt;<br />&lt;IPermission class=&quot;System.Security.Permissions.WebBrowserPermission, WindowsBase, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&quot;<br />version=&quot;1&quot;<br />Level=&quot;Safe&quot;/&gt;<br />&lt;/PermissionSet&gt;</p>
<p>The method that caused the failure was:<br />System.Object CreateSectionWithRestrictedPermissions(System.Configuration.RuntimeConfigurationRecord, System.Configuration.FactoryRecord, System.Configuration.SectionRecord, System.Object, System.Configuration.ConfigXmlReader)</p>
<p>I am studying the changes to ASPNET security in Net4, and am thorougly confused.</p>
<p>Has anyone else come across this problem and can point me in the right direction? To repeat, the application works perfectly in a remote environment which I create from scratch, but not in an updated legacy server.</p>
<p>&nbsp;</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
