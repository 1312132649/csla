<html><header><title>Basic/Simple testing question</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Basic/Simple testing question</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3651.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>RichM posted on Friday, October 05, 2007</h2>We're just getting started with CSLA.NET after spending the last 8 years developing with our version of Lhotka's VB6 COM/MTS framework.<br><br>Having been used to doing quick unit testing via the immediate window in VB6, I tried this in VS2005 using some classes we'd written and tested with a simple UI.&nbsp; However, I've been unsuccessful creating a new instance of a class that inherits BusinessBase.&nbsp; I can create an emply class, let's say Class1, and do the following in the immediate window:<br><br><font face="Courier New">oo = new Class1</font><br><br>However, trying the same with a class that inherits BusinessBase does not work.&nbsp; Here's a simple, sample class:<br><br><font face="Courier New">&lt;Serializable()&gt; _<br>Public Class SomeClass<br>&nbsp;&nbsp;&nbsp; Inherits BusinessBase(Of SomeClass)<br><br>&nbsp;&nbsp;&nbsp; Private mcProperty As String<br><br>&nbsp;&nbsp;&nbsp; Public Property SomeProperty() As String<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;System.Runtime.CompilerServices.MethodImpl(Runtime.CompilerServices.MethodImplOptions.NoInlining)&gt; _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return mcProperty<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;System.Runtime.CompilerServices.MethodImpl(Runtime.CompilerServices.MethodImplOptions.NoInlining)&gt; _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As String)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mcProperty = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>&nbsp;&nbsp;&nbsp; Public Shared Function NewClass() As SomeClass<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return New SomeClass<br><br>&nbsp;&nbsp;&nbsp; End Function<br><br>&nbsp;&nbsp;&nbsp; Protected Overrides Function GetIdValue() As Object<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return 1 ' Don't care - just testing<br>&nbsp;&nbsp;&nbsp; End Function<br><br>End Class<br></font><br><br>Trying to do the following in the immediate window:<br><br><font face="Courier New">oo = SomeClass.NewClass<br><br><font face="Times New Roman">results in the error "Unable to evaluate expression."<br><br>For a more complex class that works when accessed via a Windows Form project, we get an error "SomeClass" is an unsupported type"<br><br>Is there some trick or environment setting to make this work?<br></font></font><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Friday, October 05, 2007</h2><P>I work in C# and rarely in the immediate window&nbsp;but don't you need to specify the "()" for the function call?</P>
<P>i.e. oo = SomeClass.NewClass()?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RichM replied on Friday, October 05, 2007</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>skagen00:</strong></div><div><p>I work in C# and rarely in the immediate window&nbsp;but don't you need to specify the "()" for the function call?</p>
<p>i.e. oo = SomeClass.NewClass()?</p></div></BLOCKQUOTE><br><br>For a second I thought I was being real stupid.. Anyway - same error with or without the ().&nbsp; I had also tried a different factory method in another class similar to what Joe posted:<br><br>oo = SomeClass.GetClass(123)<br><br>with the same results.<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, October 05, 2007</h2><P>FWIW,</P>
<P>I was using a Web Project - not Winforms.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, October 05, 2007</h2><P>I set a breakpoint in my code (happened to be in a BO) and then opened the Immediate window and requested a completely different BO. I set a breakpoint on the factory method and it worked. The code stopped there and I was able to step through the Data Portal and retrieve the BO.</P><FONT size=1>
<P>oo = Acct.NewAcct("11602")</P></FONT><FONT size=1>
<P>?oo.Acctcode</P>
<P>"11602" {String}</P>
<P>String: "11602"</P></FONT>
<P>Joe</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
