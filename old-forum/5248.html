<html><header><title>Validation RuleSets How to?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Validation RuleSets How to?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5248.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>DamReev posted on Friday, August 15, 2008</h2>Hi,<br><br>I'm in a situation where we have a single business object which is now being used in a wizard and we need to perform per wizard page validation. It does not seem like CSLA supports the concept of RuleSets (kind of like the Validation Application Block does), but since our objects are all CSLA objects, I was wondering if there is a way to do this either natively or with custom code. The basics of what I need to do is only check a certain set of property validations at a time, and I'm trying to do it without having to corrupt my validation rules with checks in every rule against some sort of state (i.e. if State = Start then enforce no rules, if State = State1 enforce State1 rules etc.).<br><br>I know I can expose methods which call specific property validations but I'm not a fan of this method, and I'd choose to use the VAB rather than doing this, but I'd prefer to stick to one validation methodology in the application.<br><br>Any insight or help would be much appreciated.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JohnB replied on Friday, August 15, 2008</h2>DamReev,<br><br>I just finished working on a user account wizard where I different rules that would apply based on the user account type being created. What I did was to create a delegate method that takes into account the user account type to decide which rules apply. Here is a partial example of my solution:<br><br>Protected Overrides Sub AddBusinessRules()<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ValidationRules.AddRule(AddressOf UserInformationRequired, New RuleArgs("FirstName", "First Name", RuleSeverity.Error), 0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ValidationRules.AddRule(AddressOf UserInformationRequired, New RuleArgs("LastName", "Last Name", RuleSeverity.Error), 0)<br><br>End Sub<br><br>Private Shared Function UserInformationRequired(ByVal target As Object, ByVal e As Csla.Validation.RuleArgs) As Boolean<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim pUserAccount As UserAccount = DirectCast(target, UserAccount)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If pUserAccount._userType = UserTypes.Customer Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If pUserAccount._userType = UserTypes.Employee Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If e.PropertyName.Equals("FirstName") Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If pUserAccount.FirstName.Length = 0 Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.Description = "First Name is required."<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If e.PropertyName.Equals("LastName") Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If pUserAccount.LastName.Length = 0 Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.Description = "Last Name is required."<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return True<br>End Function<br><br>Hope this helps.<br>John<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, August 15, 2008</h2>Hi,<br><br>Just a crazy idea off the top of my head..<br><br>Your object is designed to be used in a wizard, so maybe it should know what step it's on as well.&nbsp; So maybe it could have a NextStep and PreviousStep methods.&nbsp; They could just track using a number the current state.&nbsp; <br><br>You could then assign priorities to match the state.. and then run only the rules at that priority or lower.&nbsp; Either that or you could always run the rules in NextStep, and the rules themselves take into account the current "step" of the object.<br><br>HTH<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DamReev replied on Friday, August 15, 2008</h2>Thanks guys for the ideas. Both aren't bad. I was trying to stay away from maintaining state in the business object (this was going to be controlled by the presenter), but the idea of using priority is very intriguing and I will look into that.<br><br>Thanks again.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, August 15, 2008</h2>Well, if it helps, you're designed the BO to fit a certain use case, and that use case is a wizard style 'workflow,' so having the BO help manage those transitions makes sense.&nbsp; I know workflow isn't be best word to use for what I mean, but I can't think of a better work and I think it gets the point across.<br><br>Just my $0.02 though.. like I said, it could be a crazy idea!<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
