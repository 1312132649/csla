<html><header><title>Is there a way of accessing the value of a property through the PropertyInfo object</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Is there a way of accessing the value of a property through the PropertyInfo object</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5604.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>stefan posted on Thursday, October 16, 2008</h2>Hi,<br><br>as I described in a previous post, I expose the PropertyInfo objects through an interface <br>as IPropertyInfo values. I use this to normalize validation into a separate module <br>(like the "Assignments" in PTracker.Library). This way I can pass a reference of the PropertyInfo <br>to the AddRule call.<br><br>In addition to that, I would like to use these propertyInfo references in my custom validation rule <br>methods, which are defined in the same module. I want to access the current values of the underlying properties, bypassing any authorization checks.<br><br>The only way of accessing the values known by now are:<br>&nbsp;- Calling ReadProperty from within the object<br>&nbsp;- Disable the auth checks first, call GetProperty, reenable authorization checking; from within the <br>&nbsp;&nbsp; object (I haven't seen an example/recommendation of doing it that way yet!)<br><br>OK, there is a third one: Csla.Utilities.CallByName(target, e.PropertyName, Csla.CallType.Get)<br>But that uses reflection. Having access to the PropertyInfo objects could provide a faster way.<br><br><b>Are there any means of achieving readonly access to the values from an internal/friendly scope?<br></b><br>Stefan<br><br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Thursday, October 16, 2008</h2><P>I may be missing something, but if you have a System.Reflection.PropertyInfo object, it has a GetValue() method that you can use&nbsp;-- as well as a SetValue() for modifying the property if desired.</P>
<P>You just pass as the first parameter the object whose property you are trying to get/set.</P>
<P>The problem, though, is that those will go through the normal property getter/setter. </P>
<P>What I did was use an underlying infrastructure that allows direct access to the backing fields, so you can bypass CLSA entirely. Typically, I only do this when loading the object, or in rare special case scenarios. </P>
<P>I just upgraded to 3.5, so I don't know what the implications for managed fields are. </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>stefan replied on Thursday, October 23, 2008</h2>OK, I found that this is just a matter of exposing internal access to ByPassPropertyChecks <br>from MyBusinessBase.<br><br><b>Now I still have to include this check in every custom CanReadProperty/CanWriteProperty override!!!<br>Finding a way through the PropertyInfo object would be nicer.<br></b><br>Stefan<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
