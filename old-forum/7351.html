<html><header><title>Object design </title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Object design </h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7351.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>sunny posted on Tuesday, July 28, 2009</h2><P class=MsoNormal>I am having a hard time deciding between info object and editable object below is my scenario.</P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal><STRONG><U>Root object (Matter)</U></STRONG></P>
<P class=MsoNormal>Matter Id </P>
<P class=MsoNormal>Matter reported date</P>
<P class=MsoNormal><B>.<o:p></o:p></B></P>
<P class=MsoNormal><B>.<o:p></o:p></B></P>
<P class=MsoNormal><B>Contacts (of </B>Mattercontacts)<B><o:p></o:p></B></P>
<P class=MsoNormal><B><o:p>&nbsp;</o:p></B></P>
<P class=MsoNormal><o:p></o:p><STRONG><U>Childlist object (MatterContacts)</U></STRONG></P>
<P class=MsoNormal>&nbsp;</P>
<P class=MsoNormal><STRONG>&nbsp;&nbsp;&nbsp;<U>Child object (Mattercontact)&nbsp;</U></STRONG></P>
<P class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Suffix</P>
<P class=MsoNormal dir=ltr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Role</P>
<P class=MsoNormal dir=ltr>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Contact id (SSN or FID)</P>
<P class=MsoNormal><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>.</P>
<P class=MsoNormal><STRONG><U>ObjectList <SPAN>&nbsp;</SPAN>MasterContacts</U></STRONG> </P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>&nbsp;&nbsp;&nbsp;<STRONG><U>Object <SPAN>&nbsp;</SPAN><SPAN>&nbsp;</SPAN>MasterContact</U></STRONG></P>
<P class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Contact id (SSN or FID)</P>
<P class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;First Name</P>
<P class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Last Name</P>
<P class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Company Name</P>
<P class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DOB</P>
<P class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Address 1</P>
<P class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;City&nbsp;&nbsp;</P>
<P class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;State</P>
<P class=MsoNormal>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZIP</P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>One off the properties of the child object mattercontact is the SSN or FID. When a user in the UI adds a contact (associates a contact) to the matter they have the option of choosing from existing list of mastercontacts in the system or adding a new one to the master contacts list and associating that contact with the matter in one step. </P>
<P class=MsoNormal>&nbsp;</P>
<UL>
<LI>
<DIV class=MsoNormal>What I am having a problem with is whether the mattercontact should have an editable child object as contact or a contactinfo object. </DIV></LI>
<LI>
<DIV class=MsoNormal>Or should it be more like the assignment module in projecttracker.</DIV></LI>
<LI>
<DIV class=MsoNormal>OR HAVE I GOT THIS WHOLE THING WRONG <SPAN><SPAN>L</SPAN></SPAN> and I am still designing it based on data.</DIV></LI></UL>
<P class=MsoNormal>Please advice.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, July 28, 2009</h2><P>You have two overlapping usage scenarios here.</P>
<P>One is that the user can associate a contact with a matter. So you'll probably have MatterEdit with a list of ContactAssociation objects - all editable. And you'll have a read-only list of ContactInfo objects they can select from.</P>
<P>Another usage scenario is adding a contact, which is really a separate scenario that the user can perform - basically temporarily interrupting the original scenario. To do this, you'll probably have a ContactEdit object. When it saves, the read-only list of ContactInfo will refresh so the new contact is in the list (there are a few ways to do that).</P>
<P>Your controller/UI code/whatever is using the objects can also detect the save completion and can add the association.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>sunny replied on Wednesday, July 29, 2009</h2><P>Thank you, I shall do that. <o:p></o:p></P>
<P>Just one more thing, can an editable root object have both readonlychildlist and editablechild objects. I was not sure how it would work. I was not being able to find any examples of it.<o:p></o:p></P>
<P>Really appreciate your quick response and help.<o:p></o:p></P>
<P>
<P>Sunny</P></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, July 29, 2009</h2><P>Technically yes, but generally it isn't the best idea.</P>
<P>Remember that, in a 3-tier deployment, the object graph moves from server to client on a fetch, and from client-to-server-and-back on a save. The "object graph" includes the root object, and any objects it references.</P>
<P>That would mean your read-only list would round-trip too, and probably for no reason.</P>
<P>So it is better to model this as a <EM>using</EM> relationship rather than a <EM>containment</EM> relationship. </P>
<P>Containment is where one object contains another - a parent-child relationship. The root object contains its child objects, and they travel together.</P>
<P>Using is where one object references another, but there is no parent-child relationship. The objects travel separately, and just interact as needed.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RedShiftZ replied on Wednesday, July 29, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>RockfordLhotka:</strong></div><div><p>Using is where one object references another, but there is no parent-child relationship. The objects travel separately, and just interact as needed.</p></div></BLOCKQUOTE><br><br>Rocky,<br>&nbsp; Is there an example of this somewhere? If it's in the ProjectTracker, could you point out where?<br><br>Thanks,<br><br>Jeff Young<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, July 29, 2009</h2>






 





<div class=Section1>

<p class=MsoNormal><span>You can look in ProjectTracker to see how a new resource is
assigned to a project. The usage scenario centers around the Project object,
but makes use of ResourceList.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>Rocky</span><b><span><o:p></o:p></span></b></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

</div>



</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>sunny replied on Wednesday, July 29, 2009</h2><P>Hi,<o:p></o:p></P>
<P>Thanks, I took a look at projecttracker code; I am still not clear about the difference between containment and using. The below code&nbsp;from project.vb (EditableRootObject)<o:p></o:p></P>
<P><SPAN>Private</SPAN><SPAN> <SPAN>Shared</SPAN> ResourcesProperty <SPAN>As</SPAN> PropertyInfo(<SPAN>Of</SPAN> ProjectResources) = RegisterProperty(<SPAN>New</SPAN> PropertyInfo(<SPAN>Of</SPAN> ProjectResources)(<SPAN>"Resources"</SPAN>))<o:p></o:p></SPAN></P>
<P><SPAN>Public</SPAN><SPAN> <SPAN>ReadOnly</SPAN> <SPAN>Property</SPAN> Resources() <SPAN>As</SPAN> ProjectResources<o:p></o:p></SPAN></P>
<P><SPAN>Get<o:p></o:p></SPAN></P>
<P><SPAN>If</SPAN><SPAN> <SPAN>Not</SPAN> FieldManager.FieldExists(ResourcesProperty) <SPAN>Then<o:p></o:p></SPAN></SPAN></P>
<P><SPAN>LoadProperty(<SPAN>Of</SPAN> ProjectResources)(ResourcesProperty, ProjectResources.NewProjectResources())<o:p></o:p></SPAN></P>
<P><SPAN>End</SPAN><SPAN> <SPAN>If<o:p></o:p></SPAN></SPAN></P>
<P><SPAN>Return</SPAN><SPAN> GetProperty(<SPAN>Of</SPAN> ProjectResources)(ResourcesProperty)<o:p></o:p></SPAN></P>
<P><SPAN>End</SPAN><SPAN> <SPAN>Get<o:p></o:p></SPAN></SPAN></P>
<P><SPAN>End</SPAN><SPAN> <SPAN>Property</SPAN></SPAN><o:p></o:p></P>
<P><SPAN>my understanding is that this is a reference to <SPAN>&nbsp;</SPAN>(</SPAN><SPAN>ProjectResources) </SPAN><SPAN>EditableChildList<o:p></o:p></SPAN></P>
<P><SPAN>if this is an example of&nbsp;using then, if this were implemented as containment what would the code be like. I am sorry to keep bothering you as I am trying to figure the best approach to design my BO. I do not have a lot of experience in .NET and new to CSLA (just been reading your expert vb 2008 book).</SPAN><o:p></o:p></P>
<P>My requirement is this <o:p></o:p></P>
<P><SPAN><SPAN>路<SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN>A user creates a matter <o:p></o:p></P>
<P><SPAN><SPAN>路<SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN>adds LOB specific Info to the matter (matter to LOBdata is one - to -one)<o:p></o:p></P>
<P><SPAN><SPAN>路<SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN>Associates existing contacts to matter and specifies the role they play (one - to many)<o:p></o:p></P>
<P><SPAN><SPAN>路<SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN></SPAN>adds notes and attachments to matter ( one - to -many)<o:p></o:p></P>
<P>So this is what I came up with<o:p></o:p></P>
<P><STRONG>Matter (editablerootobject)</STRONG><o:p></o:p></P>
<P>&nbsp;&nbsp;&nbsp;matterid<o:p></o:p></P>
<P>&nbsp;&nbsp;&nbsp;matterdate<o:p></o:p></P>
<UL>
<LI class=MsoNormal>&nbsp;&nbsp;&nbsp;.<o:p></o:p></LI>
<LI class=MsoNormal>&nbsp;&nbsp;&nbsp;.<o:p></o:p></LI></UL>
<P>&nbsp;&nbsp;&nbsp;LOBData as ECLOB (Editablechild object)<o:p></o:p></P>
<P>&nbsp;&nbsp;&nbsp;Contacts as RLContacts (readonly collection)<o:p></o:p></P>
<P>&nbsp;&nbsp;&nbsp;Notes as RLNotes&nbsp;(readonly collection)</P>
<P>The Matter fields and LineOfBusiness (LOBData) fields are all shown in the same tab. The Contacts and Notes are displayed on different tabs in the grids. When the user edits the matter fields he or she does not necessarily modify contacts or notes.<o:p></o:p></P>
<P>My reason for making the contacts and notes as ReadOnlyList objects&nbsp;was that they both have huge number of fields and rows (100s).&nbsp; By making them ReadOnlyObjects I could design the object to have only the necessary fields required to display in the grid.&nbsp;If the user was going to edit / add or delete the contacts&nbsp;at that point I would create a new&nbsp;ERContact or get existing ERContact and allow adding&nbsp;/editing/deleting to it.<o:p></o:p></P>
<P class=MsoNormal><o:p>&nbsp;Thanks in advance I really appreciate all your guidance and help.</o:p></P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, July 29, 2009</h2>






 





<div class=Section1>

<p class=MsoNormal><span>Project <i>contains</i> ProjectResources. ProjectResources is an
editable child list that is owned/contained by Project.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>ResourceList, on the other hand, is used as part of the <i>assign
a resource</i> usage scenario when the user clicks on a button or link to
assign a resource to the project. That&#8217;s all orchestrated by the UI code
(code-behind, controller, or whatever model you are using &#8211;
ProjectTracker uses code-behind).<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>So technically there&#8217;s not even a <i>using</i>
relationship between Project and ResourceList, because the UI acts as an
intermediary.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>Rocky</span><b><span><o:p></o:p></span></b></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

</div>



</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, July 29, 2009</h2><P>Yes.</P>
<P>I do that all the time.</P>
<P>In the Dataportal_Fetch you just load up the ROC using whatever key values are in the Root BO.</P>
<P>No need to "save" the ROC but it can be useful to loop over it to check other values that do need to be saved.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, July 29, 2009</h2>






 





<div class=Section1>

<p class=MsoNormal><span>The other thing you can do to retrieve several root objects at
once is to use a &#8216;unit of work&#8217; object. Basically a ReadOnlyBase or
CommandBase subclass that brings back a group of objects as required for a
usage scenario (typically to populate a UI form/page).<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>For example:<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>[Serializable]<o:p></o:p></span></p>

<p class=MsoNormal><span>public class CustomerDataRetriever :
ReadOnlyBase&lt;CustomerDataRetriever&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span>{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp; public CustomerEdit Customer { get; private set; }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp; public CategoryList Categories { get; private set; }<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>&nbsp; public static CustomerDataRetriever GetData(int custId)<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; return
DataPortal.Fetch&lt;CustomerDataRetriever&gt;(<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new
SingleCriteria&lt;CustomerDataRetriever, int&gt;(custId));<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>&nbsp; private void DataPortal_Fetch(<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; SingleCriteria&lt;CustomerDataRetriever,
int&gt; criteria)<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; this.Customer =
DataPortal.Fetch&lt;CustomerEdit&gt;(<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new
SingleCriteria&lt;CustomerDataRetriever, int&gt;(criteria.Value));<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; this.Categories =
DataPortal.Fetch&lt;CategoryList&gt;();<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>This UOW object goes through the data portal and loads a
CustomerEdit and CategoryList object while on the server, and returns both
objects to the caller. The caller (probably the UI) can now use both objects to
bind to the UI and let the user do what&#8217;s needed.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>I usually use ROB subclasses like this to retrieve data, because
they are simple and fast.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>For a save operation you need to use a CommandBase subclass,
because your editable root objects need to round-trip &#8211; go to the server,
and come back.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>Rocky</span><b><span><o:p></o:p></span></b></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

</div>



</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
