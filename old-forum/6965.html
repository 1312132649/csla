<html><header><title>RemoveAll method required on child collection</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>RemoveAll method required on child collection</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6965.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>j055 posted on Tuesday, May 19, 2009</h2>Hi<br /><br />I'd like to provide a method on a child collection to remove all the collection objects and then delete all of the corresponding rows in the database with one statement. Do I have to implement this independently of the framework or can/should I do this in the Child_Update method of the collection for example?<br /><br />The book seems to mainly talk about handling deletes in the collection's child object for example but it's more efficient for me to do the database delete in one hit in this case. I'm wondering if there's a consistent approach to use for such a requirement?<br /><br />Many thanks<br />Andrew<br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, May 19, 2009</h2><P>You have an editable root collection. A root object that inherits from BLB.</P>
<P>In this case you can use the immediate delete feature of the data portal, or a command object, as you choose. Either way, you are sending a message to the server to do the delete. I haven't tried this, but I think it should work (or be close anyway):</P>
<P>public class MyList : BusinessListBase&lt;MyList, MyChild&gt;<BR>{<BR>&nbsp; public void RemoveAll()<BR>&nbsp; {<BR>&nbsp;&nbsp;&nbsp; DataPortal.Delete&lt;Mylist&gt;();<BR>&nbsp;&nbsp;&nbsp; this.Clear();<BR>&nbsp;&nbsp;&nbsp; DeletedList.Clear();<BR>&nbsp;&nbsp;&nbsp; MarkNew();<BR>&nbsp; }</P>
<P>&nbsp; private void DataPortal_Delete()<BR>&nbsp; {<BR>&nbsp;&nbsp;&nbsp; // delete all items from database<BR>&nbsp; }<BR>}</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>j055 replied on Wednesday, May 20, 2009</h2>Hi<br /><br />OK thanks, but is there a way to do something similar in a child collection? Actually, in my case it's a grandchild collection. <br /><br />I tried this:<br /><br />        internal void RemoveAll(byte orGroup)<br />        {<br />            DataPortal.UpdateChild(new SingleCriteria(orGroup));<br />            DeletedList.Clear();<br />            Clear();<br />        }<br /><br />        private void Child_DeleteSelf()<br />        {<br />            Debug.WriteLine("Child_DeleteSelf");<br />        }<br /><br />        private void Child_Update()<br />        {<br />            Debug.WriteLine("Child_Update");<br />        }<br /><br />But I get System.NotImplementedException: Child_Update not implemented.<br /><br />Is using the command object the way to go in this case? <br /><br />Thanks again<br />Andrew<br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mbblum replied on Wednesday, May 20, 2009</h2>In this code sample UpdateChild is passing a SingleCriteria param, but the Child_Update has no param. The method signatures do not match, which is probably the source of the Not Implemented Exception. Try adding to Child_Update the SingleCriteria param.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>j055 replied on Wednesday, May 20, 2009</h2>Hi there<br /><br />Thanks for pointing that out. I have tried the SingleCriteria param among other things but I still get the System.NotImplementedException: Child_Update not implemented error.<br /><br />Any ideas?<br />Thanks<br />Andrew</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fintanv replied on Thursday, May 21, 2009</h2>If you could post the parent and the child code as it currently stands, it would help us to understand what is going on.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>j055 replied on Thursday, May 21, 2009</h2>Hi<br /><br />I've been looking into my requirements in a bit more detail. I think my 'RemoveAll' method is floored because I can just delete it's parent. This is my first real CSLA project do I'm still getting to grips with some of the concepts. <br /><br />One thing you might be able to clear up for me. Is it acceptable to use DataPortal.Delete in a child object? E.g. <br /> <br /><br />        internal static FilterParameterGroup GetFilterParameterGroup(object data)<br />        {<br />            return DataPortal.FetchChild(data);<br />        }<br /><br />        internal static void DeleteFilterParameterGroup()<br />        {<br />            DataPortal.Delete ();<br />        }<br /><br />Thanks<br />Andrew<br /><br /><br /></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
