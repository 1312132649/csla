<html><header><title>ReportingServices Local Mode with CSLA Object as Datas Source</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ReportingServices Local Mode with CSLA Object as Datas Source</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7467.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>BigPines2 posted on Monday, August 17, 2009</h2>I am working on a CSLA WinForms app which uses ReportingServices local mode. I am using VS2005 as the IDE. I can't get a CSLA ReadOnly collection object to work as the data source in an rdlc report to save my life! I have searched the forum and everyone else seems to be able to get it to work so I am really scratching my head here.<br><br>I have tried creating a datasource directly from the BO and also converting the BO to a dataset first and then creating a datasource from that but in both cases, when I try to run the report, the ReportViewer control displays the error: <b>"A data source instance has not been supplied for the data source [Dataset Name]"</b><br><br>The only way I have been able to get this to work is to creat the data source directly from a stored procedure and use the results of hitting the sproc directly as the data source for the report. When I do this, everything works fine so I know the basic code is correct. However, I don't want to have to create a new object just for fetching the report results and then re-fetch this data when it is already available in the collection object!<br><br>Naturally, I would prefer to use the CSLA collection directly like this:<br><br><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; With ReportViewer1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .ProcessingMode = ProcessingMode.Local<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; With .LocalReport<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .ReportEmbeddedResource = "testApplication.testReport.rdlc"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .DataSources.Add(New ReportDataSource("ProviderList", mCslaList))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End With<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .RefreshReport()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End With</b><br><br>I am using Petar Kozul's Active Objects on top od CSLA so that may be what is causing the problem but I don't see why it would. I am going to create a regular CSLA collection next and test if that works.<br><br>
I have spent almost 10 hours so far trying to figure this out so any help would be greatly appreciated.<br>
<br>Mike<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, August 18, 2009</h2>Hi, <br><br>Download the samples from <a href="http://www.gotreportviewer.com">www.gotreportviewer.com.</a><br><br>Csla objects (both readonlylist and editablelist) work fine with reportviewer. <br><br>It would seem that you either have a problem with the DataSource definition and how the list object is supplied to your report. <br><br>Another pitfall is to make sure that the datasource must be an IEnumerable. A single object (root) that holds a list can not be your datasource (unless you make it into an IEnumerable that has just one item). <br><br>(I am planning to add a couple of reports to the ProjectTracker sample for Csla 3.6.3 for Net 2.0 but that solution requires VisualStudio 2008).<br><br>/jonnybee<br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>BigPines2 replied on Tuesday, August 18, 2009</h2>Thanks for the tips Jonny. I have downloaded the object binding example in your link and I am doing everything the same as the example so there must be something wrong with the object itself. I will look into it further and report back with my findings.<br><br>Mike<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, August 18, 2009</h2>Hi, <br><br>Just added a reportviewer and ResourceReport to the samples project for "Csla 3.6.3 for .Net 2.0". You must download the code directly from Subversion to get this version. This solution is in C# and requires Visual Studio 2008 (but runs on .Net 2.0) and  there is almost no changes in the ReportViewer from VS2005 and code is identical. You should be able to add the ResourceReport WinPart and report definition to an earlier version of the ProjectTracker example project. <br><br>Is your datasource named "ProviderList" in the "Report" - "Data Sources" window? <br>Name must be spelled exacly as shown in this window in order for ReportViewer to find the list of objects. <br><br>Another thing you may try is to make sure to clear the datasources list before you add your own: <br><br><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; With .LocalReport<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .ReportEmbeddedResource = "testApplication.testReport.rdlc"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .DataSources.Clear()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .DataSources.Add(New ReportDataSource("ProviderList", mCslaList))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End With</b><br><br>/jonnybee<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>BigPines2 replied on Wednesday, August 19, 2009</h2>Ah-HA! You were correct. It was the name in the Data Source window of the report!<br><br>I figured that the name provided in DataSources.Add had to match the DATASET or DATATABLE name. Not the name of the Data Source. Makes perfect sense though.<br><br>Thanks for the help! :)<br><br>Mike<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
