<html><header><title>[Csla 3.6.x] GetPropertyConvert(F,P) </title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>[Csla 3.6.x] GetPropertyConvert(F,P) </h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5474.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>stefan posted on Friday, September 26, 2008</h2>Hi Rocky!<br><br>Consider the folling:<br><font size="2">&nbsp;&nbsp;&nbsp; Private Shared MyInfoProperty As PropertyInfo(Of MyReadOnlyInfo) _ <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = RegisterProperty(GetType(MyBO), _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; New PropertyInfo(Of </font><font size="2">MyReadOnlyInfo</font><font size="2">)("MyInfo", "MyInfo", </font><font size="2">MyReadOnlyInfo</font><font size="2">.EmptyInfo))<br>&nbsp;&nbsp;&nbsp; Private m</font><font size="2">MyReadOnlyInfo</font><font size="2"> As </font><font size="2">MyReadOnlyInfo</font><font size="2"> = MyInfoProperty.DefaultValue<br>&nbsp;&nbsp;&nbsp; Public ReadOnly Property MyInfo() As <b>String</b><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return GetPropertyConvert(Of </font><font size="2">MyReadOnlyInfo</font><font size="2">, <b>String</b>)(MyInfoProperty, <b>m</b></font><b><font size="2">MyReadOnlyInfo</font></b><font size="2">)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp; End Property<br></font><br>I would expect that the framework returns the result of the ToString() method on <font size="2">MyReadOnlyInfo</font>, <br>but it does not.<br>Another alternative would be a new overload passing in the desired result:<br>GetPropertyConvert(F,P)(propInfo As PropertyInfo(Of F), <b>returnValue As P</b>)<br><br>But in the case of P being String, calling ToString() should be the expected behaviour...<br><br>Stefan<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, September 26, 2008</h2><P>So what you are suggesting is that Utilities.CoerceValue() should have a special case to handle a target type of string that just calls ToString() in the inbound value rather than trying to do the type coercion?</P>
<P>That may not be a bad idea, as it would probably provide better performance in many cases.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
