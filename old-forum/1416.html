<html><header><title>Enterprise Service runtime exception</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Enterprise Service runtime exception</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1416.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>louis.leung posted on Friday, October 06, 2006</h2>Hi,<br><br>The application that I'm developing is a 3-tier windows form app.&nbsp; The client (ie. windows form) is installed in Machine A (XP Home SP2), and the app server and database are both installed in Machine B (XP Pro SP2).&nbsp; I chose Enterprise Service as the mean of communication between the client and the app server to test out the performance.<br><br>I followed the instructure for implementing Enterprise Sservice as suggested in the "Expert C# 2005 Business Objects" book.&nbsp; I installed the COM+ application on the app server machine with no problem.&nbsp; I also installed the .msi generated by the COM+ on the client machine with no problem.<br><br>However, when I run my client, the following exception was thrown.&nbsp; I tried googling for answers, making sure that DTC is enabled at both client/server, double checking that the COM+ is started at the server machine, but still can't find the answer.<br><br>Anyone seen this exception before or can give me some help ?&nbsp; Thanks in advance.<br><br>-Louis<br><br><br><font face="Garamond">
System.Runtime.InteropServices.COMException was unhandled</font><br>
  Message="Changes to this object and its sub-objects have been disabled (Exception from HRESULT: 0x8011042A)"<br>
  Source="System.EnterpriseServices"<br>
  ErrorCode=-2146368470<br>
  StackTrace:<br>
       at System.EnterpriseServices.RegistrationThreadWrapper.PropInstallResult()<br>
       at System.EnterpriseServices.RegistrationHelper.InstallAssemblyFromConfig(RegistrationConfig&amp; regConfig)<br>
 at
System.EnterpriseServices.RegistrationHelper.InstallAssembly(String
assembly, String&amp; application, String partition, String&amp; tlb,
InstallationFlags installFlags)<br>
 at
System.EnterpriseServices.RegistrationHelper.System.EnterpriseServices.Thunk.IThunkInstallation.DefaultInstall(String
asm)<br>
       at System.EnterpriseServices.Thunk.Proxy.RegisterAssembly(Assembly assembly)<br>
       at System.EnterpriseServices.Thunk.Proxy.LazyRegister(Guid id, Type serverType, Boolean checkCache)<br>
 at System.EnterpriseServices.Thunk.Proxy.CoCreateObject(Type
serverType, Boolean bQuerySCInfo, Boolean&amp; bIsAnotherProcess,
String&amp; uri)<br>
       at System.EnterpriseServices.ServicedComponentProxyAttribute.CreateInstance(Type serverType)<br>
 at
System.Runtime.Remoting.Activation.ActivationServices.IsCurrentContextOK(Type
serverType, Object[] props, Boolean bNewObj)<br>
 at
EnterpriseServicesHost.EnterpriseServicesProxy.GetServerObject() in
C:\Data\Work\alpha\src\Rapid\ESHost\EnterpriseServicesProxy.cs:line 13<br>
 at Csla.DataPortalClient.EnterpriseServicesProxy.Fetch(Type
objectType, Object criteria, DataPortalContext context) in
C:\csla\csla20cs\csla20cs\Csla\DataPortal\Client\EnterpriseServicesProxy.cs:line
52<br>
 at Csla.DataPortal.Fetch(Type objectType, Object criteria) in
C:\csla\csla20cs\csla20cs\Csla\DataPortal\Client\DataPortal.cs:line 184<br>
       at Csla.DataPortal.Fetch<a class="wiki" href="http://www.archonsystems.com/wiki/T">T</a>(Object criteria) in C:\csla\csla20cs\csla20cs\Csla\DataPortal\Client\DataPortal.cs:line 138<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, October 06, 2006</h2>It sure looks like .NET is trying to do some configuration of the COM+ proxy on the client. Perhaps there's some issue with the way the msi was created or run. Certainly that's where you should focus your research, is on the procedure to register a COM+ application on the client.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mel2401 replied on Wednesday, May 02, 2007</h2><P>Hi Louis.</P>
<P>I am experiencing the same problem you had with enterprise services and was hoping that you may have had some success in getting round it. I have communicated with rocky but unfortunately he doesn't seem to have any ideas at the moment apart from the possibility that XP home SP2 doesn't support enterprise services. I am using XP Pro SP2 so that is not an issue for me anyway. Any help you can give me would be greatly appreciated.</P>
<P>Regards,<BR>Mel</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, May 02, 2007</h2><P>You know, in looking at the stack trace again there may be a clue.</P>
<P>Notice about 3-5 lines down into the trace, there's a call to do an install. EnterpriseServices will automatically try to install your assembly into COM+ if it isn't there already, but that takes administrator rights, and really isn't sufficient (because there's extra config that must be done manually).</P>
<P>Is it possible that the assembly somehow isn't installed on the server?</P>
<P>Certainly it appears that <EM>something</EM> isn't installed on the server. I'm guessing it isn't <EM>your object</EM> that can't be changed (that would be a very odd exception if that were the case), but rather that a registry object can't be changed, or that a metadata object for COM+ can't be changed.</P>
<P>Though I don't have a solution, I thought I'd offer up this in the hopes that it provides some insight <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /></P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
