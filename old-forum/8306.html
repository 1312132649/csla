<html><header><title>WPF Treeview, Business Objects and View Models Oh My!</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>WPF Treeview, Business Objects and View Models Oh My!</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8306.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>kevnworking posted on Thursday, January 07, 2010</h2><font face="Arial"><font size="3"><font size="2">Hey All,<br><br>It's Kevin the WPF newbie back for more.&nbsp; I apologize ahead of time if this question has more to do with WPF than CSLA but I'm stumped.<br><br>I have a set of objects that are laid out like this:<br>User Object -&gt; User Modules Collection -&gt; User Module Object<br><br>I have added some view model classes so I could sync up some of the settings of the treeview items controls, specifically I wanted to add an "IsExpanded" property to the view model class so I could maintain the treeview items current expanded or unexpanded "state" when a save occurred on the underlying business objects.&nbsp; With some help from Rocky on another thread I was able to put together view model classes for each of the three classes listed above.<br><br>In my XAML I have the following lines to hook everything up: </font></font></font><font face="Arial"><font size="3"><font size="2">(not sure how to maintain code color)</font></font></font><br><br><font face="Arial"><font size="3"><font size="2">&lt;!-- View Models --&gt;<br>&lt;this:UserViewModel x:Key="UserVM" /&gt;<br>&lt;this:UserModuleCollectionViewModel x:Key="UserModuleCollectionVM" Model="{Binding Source={StaticResource UserVM}, Path=Model.UserModules}" /&gt;<br>&lt;this:UserModuleViewModel x:Key="UserModuleVM" Model="{Binding Source={StaticResource UserModuleCollectionVM}, Path=SelectedUserModule}"/&gt;<br><br>Further down the page I have the XAML for the treeview:<br><br>&lt;TreeView Name="trvModules" <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; Grid.Column="0" <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; DataContext="{Binding Source = {StaticResource UserModuleCollectionVM}}" <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; ItemsSource="{Binding Path=Model}"<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &gt;<br>&nbsp;&nbsp;&nbsp; &lt;TreeView.ItemTemplate&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;HierarchicalDataTemplate ItemsSource="{Binding UserModules}"&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;StackPanel Orientation="Horizontal"&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;CheckBox Margin="1,1,5,1"<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; IsChecked="{Binding Path=HasModuleAccess, Converter={StaticResource IdentityConverter}, Mode=TwoWay}"<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; Checked="chkModules_Checked"<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; Name="chkModules" /&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;TextBlock Style="{DynamicResource TextBlock_MouseOverTrigger_Style}"<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; Text="{Binding Path=DisplayName}"<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp; ToolTip="{Binding Path=ModuleDescription}"&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/TextBlock&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/StackPanel&gt;<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;HierarchicalDataTemplate.ItemContainerStyle&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;Style TargetType="{x:Type TreeViewItem}"&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}" /&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/Style&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/HierarchicalDataTemplate.ItemContainerStyle&gt;<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/HierarchicalDataTemplate&gt;<br>&nbsp;&nbsp;&nbsp; &lt;/TreeView.ItemTemplate&gt;<br>&lt;/TreeView&gt;<br><br>This XAML works great for displaying the data, the treeview is populated with the correct data.&nbsp; Basically I'm back to where I was before I started working on the view models.<br><br>Now, the "</font></font></font><font face="Arial"><font size="3"><font size="2">&lt;HierarchicalDataTemplate.ItemContainerStyle&gt;" tag is there just because I was messing around trying to figure this out.&nbsp; It doesn't work, nor should it because there is no binding to the UserModuleVM object.&nbsp; Which leads me to ask - how do I implement this so I can bind the UserModuleVM's IsExpanded property to the "IsExpanded" property of the tree view item?<br><br>Thanks for any help or advice you can give me...<br><br>Kevin<br></font></font></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kevnworking replied on Monday, January 11, 2010</h2><font face="Arial">Did I now word this very well or is it really a head-scratcher?&nbsp; I know I'm having a tough time with it!<br><br>Kevin<br></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AndresN replied on Wednesday, November 24, 2010</h2><p>Could there please be a chance that you upload the source you ended up with?</p>
<p>(some compilable project, if possible, or at least the XAML+codebehind+CSLA classes)</p>
<p>I&#39;m a total CSLA newbie, but I&#39;m hoping CSLA solves some complexity I&#39;ve been fighting almost a year now. And there&#39;s WPF TreeView on the UI end.</p>
<p>Please!</p>
<p>Andres</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kevnworking replied on Wednesday, November 24, 2010</h2><p>Andres,</p>
<p>I&#39;m afraid I never did figure this out and sort of &quot;shelved&quot; the project until I have time to work on it again.&nbsp; The way my workload has been lately, I&#39;m not sure when that&#39;s going to happen!</p>
<p>I wish I could help you out.</p>
<p>Kevin</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
