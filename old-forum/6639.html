<html><header><title>Duplicating a row in a data grid</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Duplicating a row in a data grid</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6639.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>pagolas posted on Thursday, March 19, 2009</h2>really new to csla need help<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JohnB replied on Thursday, March 19, 2009</h2>Without knowing any details I'll assume that your grid is bound to a BusinessListBase.<br><br>Essentially capture the selected row object and clone it. Take the clone, change the id and add it to your BLB and rebind your grid.<br><br>There are many details left out here but hopefully this points you in the right direction.<br><br>John<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pagolas replied on Tuesday, March 24, 2009</h2><P>thank you very much </P>
<P>but i am fairly new to csla so i just have a few questions</P>
<P>1. Once the row is selected i will create a button that is called duplicate and once this button is pressed it shuld be able to create another row. Does csla have an interface that i can inherit from in order to clone lets say the object cloner interface i.e IClonable interface.</P>
<P>2. I have some of the code that i can post up sop that u understand better how it is bound to the BusinessListBase?</P>
<P>&nbsp;</P>
<P>I really appreciate your help</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>esteban404 replied on Wednesday, March 25, 2009</h2>It may be possible to cast the selected row into your specific object type, then use that to construct the duplicate row w/or without modification. I do it all the time in the case of RO list objects bound to a grid or drop down box where some users need to be able to add to that read only list. It's sweetly fast and easy. It works on a button click or context menu item click. Here's a sample from a DevExpress look up editor that allows this:<br />private void repLuRefDes_ProcessNewValue(object sender, DevExpress.XtraEditors.Controls.ProcessNewValueEventArgs e)<br />{<br />    // adds the new item and sets a reference in a different column based on it, direct relation exists<br />    // between them<br />     object row = repLuRefDes.GetDataSourceRowByKeyValue(e.DisplayValue);<br />     RefDesInfo info = (RefDesInfo)row;<br />     if (row == null) // because it's new, dead give away<br />     {<br />          RefDesInfo i = new RefDesInfo();<br />          i.Part = "Unknown";<br />          i.RefDes = e.DisplayValue.ToString();<br />          i.OpType = MyHeader.ReportingOp;<br />          i.Product = MyHeader.Info.Product;<br />          _refDesList.MyAdd(i); // new constructor to allow adding to the list, does not modify db<br />           gvDefects.SetRowCellValue(gvDefects.FocusedRowHandle, "Component", i.Part);<br />          e.Handled = true;<br />       }<br />       else // row is present, grab value<br />          gvDefects.SetRowCellValue(gvDefects.FocusedRowHandle, "Component", info.Part);<br />}<br /><br />To get around the fact that I'm not modifying the datasource, this event also fires when the databinding sets the read-in data as a NotInList event. A life saver for the have cake and eat it too crowd I deal with.<br /><br />_E</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pagolas replied on Wednesday, March 25, 2009</h2>thank you very much for your input it is greatly appreciated but this is wayyyyyyy to complicated for me man...i am a beginner and i dont even know what DevExpress Editor is . I was thinking of simply creating a duplicate button and then having the code to clone the object inside of that </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pagolas replied on Wednesday, March 25, 2009</h2><FONT color=#0000ff size=2>&nbsp;</FONT>
<P>private<FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> button1_Click(</FONT><FONT color=#0000ff size=2>object</FONT><FONT size=2> sender, </FONT><FONT color=#2b91af size=2>EventArgs</FONT><FONT size=2> e)</P>
<P>{</P>
<P>myList.DuplicateItem(myListDataGridView.CurrentRow.DataBoundItem);</P>
<P>}</P></FONT>
<P>myList is my collection of objects. It shows up in the datagrid when you do the search.</P>
<P>below is the code that shows the data binding nature of my myList</P>
<P>&nbsp;</P><FONT color=#0000ff size=2>
<P>private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> SortAndBindResults(myList</FONT><FONT size=2> list)</P>
<P>{</P>
<P></FONT><FONT color=#008000 size=2>// clear previous results</P></FONT><FONT size=2>
<P>myListBindingSource.DataSource = </FONT><FONT color=#0000ff size=2>null</FONT><FONT size=2>;</P>
<P></FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (list.Count &gt; 0)</P>
<P>{</P>
<P>Csla.</FONT><FONT color=#2b91af size=2>SortedBindingList</FONT><FONT size=2>&lt;myList</FONT><FONT color=#2b91af size=2>Info</FONT><FONT size=2>&gt; sortedList = </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> Csla.</FONT><FONT color=#2b91af size=2>SortedBindingList</FONT><FONT size=2>&lt;<FONT color=#2b91af>myList</FONT></FONT><FONT color=#2b91af size=2>Info</FONT><FONT size=2>&gt;(list);</P>
<P></FONT><FONT color=#008000 size=2>//sortedList.ApplySort("IsWorkCommitted", ListSortDirection.Descending);</P></FONT><FONT size=2>
<P>sortedList.ApplySort(</FONT><FONT color=#a31515 size=2>"myListId"</FONT><FONT size=2>, </FONT><FONT color=#2b91af size=2>ListSortDirection</FONT><FONT size=2>.Ascending);</P>
<P>myListListBindingSource.DataSource = sortedList;</P>
<P>myListDataGridView.Focus();</P>
<P>}</P>
<P></FONT><FONT color=#0000ff size=2>else</P></FONT><FONT size=2>
<P>{</P>
<P></FONT><FONT color=#2b91af size=2>MessageBox</FONT><FONT size=2>.Show(</FONT><FONT color=#a31515 size=2>"No matching lists found"</FONT><FONT size=2>,</P>
<P></FONT><FONT color=#a31515 size=2>"No matching lists"</FONT><FONT size=2>, </FONT><FONT color=#2b91af size=2>MessageBoxButtons</FONT><FONT size=2>.OK);</P>
<P>}</P>
<P>}</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>esteban404 replied on Wednesday, March 25, 2009</h2><P>What is the question?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>esteban404 replied on Wednesday, March 25, 2009</h2>OK, I see your question. I got the post out of series.<br /><br />You're using a DataGridView and so does the editor I use, so the technique is similar. Your object just implements it instead of the UI where I do it. So your DuplicateItem method takes the selected row as an argument and creates the new item from it and resorts the list, right? After you've done that, you may need to select that new item in the list so the user doesn't need to, but that's up to your design. I don't know.<br /><br />By definition, the list item may need to be different/unique in the list, not an exact copy, so you may nee to do something different, but at this point, I don't have a clue about the details of the problem from code posting.<br /><br />Post some question and the community here will try to help.<br /><br />_E</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
