<html><header><title>events not firing after change to WCF</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>events not firing after change to WCF</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6418.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>nj609eagle posted on Friday, February 13, 2009</h2><P>After getting most of the business logic working in my first CSLA application, I made the changed to WCF Data Portal.<SPAN>&nbsp; </SPAN>After much tweaking of the configuration values to get the objects to send and receive.<SPAN>&nbsp; </SPAN>I realized that I forgot to add some Validation Rules.<SPAN>&nbsp; </SPAN>These rules are basic <SPAN>StringRequired</SPAN> rules. When I went to test everything I noticed two problems.</P>
<P><SPAN>1.<SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN>The rules do not appear to be broken when the data is retrieved.<SPAN>&nbsp; </SPAN>Obviously the data should never be saved with these errors, but itâ€™s an old application and the data is what it is and would require the users to fix going forward.<BR><BR></P>
<P><SPAN>2.<SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></SPAN>My events no longer bubble up the parent-child chain.</P>
<P>Any help would be greatly apppreciated.&nbsp; Page Number in C# 2008 book?</P>
<P class=MsoNormal><FONT face=Calibri>All of my classes have:<BR></FONT><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Private</SPAN> <SPAN>Sub</SPAN> <SPAN>New</SPAN>()<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>MyBase</SPAN>.New()<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>_forceInit = 0<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>MarkAsChild() <FONT>&lt;--Not in the Root Application (BB) class<BR></FONT><SPAN>&nbsp;&nbsp;&nbsp; </SPAN><SPAN>End</SPAN> <SPAN>Sub<BR><BR></SPAN></SPAN><SPAN><FONT face=Calibri>Additionally they all have:<BR></FONT></SPAN><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Protected</SPAN> <SPAN>Overloads</SPAN> <SPAN>Overrides</SPAN> <SPAN>Sub</SPAN> OnDeserialized( _<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>ByVal</SPAN><SPAN> context <SPAN>As</SPAN> System.Runtime.Serialization.StreamingContext)<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>_forceInit = 0<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>MyBase</SPAN>.OnDeserialized(context)<BR><SPAN>&nbsp;&nbsp;&nbsp; </SPAN><SPAN>End</SPAN> <SPAN>Sub</SPAN></SPAN><SPAN><o:p></o:p></SPAN></P>
<P class=MsoNormal><FONT face=Calibri>I added to all of the BLB (but these never fire):<BR></FONT><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Protected</SPAN> <SPAN>Overloads</SPAN> <SPAN>Sub</SPAN> OnDeserialized( _<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>ByVal</SPAN><SPAN> context <SPAN>As</SPAN> System.Runtime.Serialization.StreamingContext)<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>_forceInit = 0<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>MyBase</SPAN>.OnDeserialized()<BR><SPAN>&nbsp;&nbsp;&nbsp; </SPAN><SPAN>End</SPAN> <SPAN>Sub</SPAN></SPAN><SPAN><o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><BR></SPAN><BR><FONT face=Calibri>Application BB<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>Section3 BB<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>Section3_2 BB<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN><FONT face=Calibri>CommitteePersonSalaryList BLB<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>CommitteePersonSalary BB<o:p></o:p></FONT></SPAN></P>
<P>CommitteePersonSalary responds to the <SPAN>PropertyChanged</SPAN> Event to set other values of the object.</P>
<P>Section3_2 responds to <SPAN>ChildChanged</SPAN> to set values of its self based on summary totals of CommitteePersonSalary.</P>
<P><B><SPAN>Section3_2 Property Declaration</SPAN></B><SPAN><BR>Private</SPAN><SPAN> <SPAN>Shared</SPAN> CommitteePersonSalaryProperty <SPAN>As</SPAN> PropertyInfo(<SPAN>Of</SPAN> CommitteePersonSalaryList) = RegisterProperty(<SPAN>Of</SPAN> CommitteePersonSalaryList)(<SPAN>New</SPAN> PropertyInfo(<SPAN>Of</SPAN> CommitteePersonSalaryList)(<SPAN>"CommitteePersonSalary"</SPAN>))</SPAN></P>
<P><SPAN>Public</SPAN><SPAN> <SPAN>ReadOnly</SPAN> <SPAN>Property</SPAN> CommitteePersonSalary() <SPAN>As</SPAN> CommitteePersonSalaryList<o:p></o:p></SPAN></P>
<P><SPAN>Get<BR>&nbsp;&nbsp;&nbsp;If</SPAN><SPAN> <SPAN>Not</SPAN> FieldManager.FieldExists(CommitteePersonSalaryProperty) <SPAN>Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</SPAN>LoadProperty(<SPAN>Of</SPAN> CommitteePersonSalaryList)(CommitteePersonSalaryProperty,&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT size=2>CommitteePersonSalaryList.GetCommitteePersonSalaryByApplicationID(</FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.ApplicationID))<BR></FONT><SPAN>End</SPAN> <SPAN>If<BR>&nbsp;&nbsp;&nbsp;Return</SPAN> GetProperty(<SPAN>Of</SPAN> CommitteePersonSalaryList)(CommitteePersonSalaryProperty)<BR><SPAN>End</SPAN> <SPAN>Get<BR>End</SPAN> <SPAN>Property</SPAN><o:p></o:p></SPAN></P>
<P class=MsoNormal><o:p><FONT face=Calibri>&nbsp;</FONT></o:p></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, February 13, 2009</h2>For 1. are you calling ValidationRules.CheckRules before you exit your DataPortal_Fetch?<br><br>For 2., are you using managed child properties?&nbsp; Also, child property changes are bubbling up anymore, by design.&nbsp; Did you recently upgrade your Csla version?&nbsp; What version are you using now?&nbsp; 3.6.1 doesn't require _forceInit any longer.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>nj609eagle replied on Friday, February 13, 2009</h2><P>I'm using&nbsp;version 3.6.1.</P>
<P>did you mean <EM>Also, child property changes are not&nbsp;bubbling up anymore, by design.</EM></P>
<P>If so, why does it work when the object its not serilized using WCF and going directly?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, February 13, 2009</h2>Well it sounds like the event hookups are being lost in serialization.&nbsp; Are you child objects managed?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>nj609eagle replied on Friday, February 13, 2009</h2><P>Yes.&nbsp; You can see from the code above how they are being declared and loaded</P>
<P>I added the _forceInit before changing from 3.6.0 to 3.6.1</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
