<html><header><title>custom NoDuplicate rule and the call of ValidationRules.CheckRules()</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>custom NoDuplicate rule and the call of ValidationRules.CheckRules()</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2578.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>kids_pro posted on Thursday, March 22, 2007</h2>I tried to implement a simple custom validation rule "NoDuplicate" but it doesn't seem to work well.<br>I got the following error message when I tried to load the Parent object.<br><br><b>Exception Details: </b>System.NullReferenceException: Object reference not 
set to an instance of an object.<br><table bgcolor="#ffffcc">

<tr>
<td><code></code><pre>Line 192:        private bool NoDuplicate(object sender, Csla.Validation.RuleArgs e) {<br>Line 193:            Beneficiaries parent = (Beneficiaries)this.Parent;<br><font color="red">Line 194:            foreach (Beneficiary b in parent) {<br></font>Line 195:                if (b.VillGis == _villGis &amp;&amp; !ReferenceEquals(b, this)) {<br>Line 196:                    e.Description = "This village already exist in beneficiary list.";</pre></td></tr></table><br>I add the NoDuplicate like this:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected override void AddInstanceBusinessRules() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ValidationRules.AddInstanceRule(NoDuplicate, "VillGis");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>To clarify here is the class diagram <br><br>
<img src="http://www.sroksreonline.com/Project.gif" alt="Project Diagram"><br><br>I don't know if it necessary to call MarkAsChild() in the Beneficiary constructor or not?<br>If this error cause by my call to ValidationRules.CheckRules() in the Beneficiary constructor?<br><br><b><u>My NoDuplicate rule is simple: </u></b><br>Project has beneficiary which identify by location, and the location can't appear more than one.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, March 23, 2007</h2>You can't use the Parent property in the constructor because it hasn't been set yet. BLB doesn't call SetParent() until after the child object has been created.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kids_pro replied on Friday, March 23, 2007</h2>Is that mean I do not necessary call MarkAsChild() in this constructor overload?<br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
