<html><header><title>MinValue validation</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>MinValue validation</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1287.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Wednesday, September 20, 2006</h2>I must be missing something simple..<br><br>I want to use the CommonRule.MinValue, but I can't figure out how to set it up with ValidationRules.AddRule.<br><br>Just want to ensure a decimal value isn't less than 0.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, September 20, 2006</h2><FONT size=2>
<P>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> MinValue(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2>), </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> MinValueRuleArgs(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2>)(</FONT><FONT color=#ff00ff size=2>"myProperty"</FONT><FONT size=2>, 0))</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, September 21, 2006</h2>Hmm... VB isn't my thing.. I think in C# that would be..<br><br><font color="#008000">ValidationRules</font>.AddRule( <font color="#008000">CommonRules</font>.MinValue&lt;<font color="#0000ff">int</font>&gt;, <font color="#0000ff">new </font><font color="#008000">MinValueRuleArgs</font>&lt;<font color="#0000ff">int</font>&gt;( <font color="#ff0000">"myProperty"</font>, 0 ) );<br><br><br>Well, changing <font color="#0000ff">int </font>to <font color="#0000ff">decimal </font>of course.&nbsp; <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /><br><br>I'll give that a shot, thanks!<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brembot replied on Friday, September 22, 2006</h2><font size="2"><font face="Tahoma">How its gonna work with <font color="#0000ff">Short</font> datatype with the default value is -1? I tried the validation rules it does not work if the value is -1 (negative 1) but if the value is 0 (zero) it works.<br><br>ValidationRules.AddRule(<font color="#0000ff">AddressOf </font>CommonRules.MinValue(<font color="#0000ff">Of Short</font>), New CommonRules.MinValueRuleArgs(<font color="#0000ff">Of Short</font>)(<font color="#a52a2a">"MyProperty"</font>, 1))<br></font></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, September 22, 2006</h2>Are you making sure the rule is run after setting the default to -1?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brembot replied on Friday, September 22, 2006</h2><P><FONT face=Tahoma size=2>Yes, I am sure. I have a variable which datatype is<FONT color=#0000ff> Short</FONT> with default value is -1. When i&nbsp;execute the <FONT color=#0000ff>AddNew</FONT> mehod of the bindingsource in debug mode, the validation rule is executed. i have some properties that have validation rules like integer, byte and string and it works very fine. i wonder, why my short datatype isn't working at all. It is binded to a textbox control having OnPropertyChanged events enabled. When i changed the value of the textbox to 0, the error provider works co'z i have implemented the rules of MinValue of 1 but when i set it to -1, it doesn't seem to work at all. Just only the short datatype has the problem to me.</FONT></P>
<P><FONT face=Tahoma size=2>Thanks</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, September 22, 2006</h2>Does VB Short translate to Int16 or UInt16?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brembot replied on Friday, September 22, 2006</h2><P><FONT face=Tahoma size=2><FONT color=#0000ff><FONT color=#000000>By the way,</FONT> Short</FONT> translate to Int16.</FONT></P>
<P><FONT face=Tahoma size=2>Thanks</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, September 22, 2006</h2>The only thing I can suggest is set a break point on your rule and check the call stack to make sure its being called when the object is created.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brembot replied on Friday, September 22, 2006</h2><P><FONT face=Tahoma size=2>Hello, I have here the attached&nbsp;sample project so that you can test it yourself. I think it is bug in <FONT color=#0000ff>ValidationRules</FONT> or i am missing something. </FONT></P>
<P><FONT face=Tahoma size=2>Thanks in advance,</FONT> </P>
<P><FONT face=Tahoma size=2>Marlon</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, September 22, 2006</h2>I haven't been following this thread, so this may not be useful. However, a few weeks ago someone reported a bug where my CompareTo code was checking for a result of -1 (which should be correct btw - CompareTo is supposed to return -1, 0 or 1) - but it turns out that didn't work with the Short (Int16) data type.<br><br>It appears that Int16's CompareTo implementation itself has a bug, where it returns an arbitrary negative number rather than just -1 like it is supposed to...<br><br>I implemented this fix/workaround for this in the version 2.1 code.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brembot replied on Saturday, September 23, 2006</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>RockfordLhotka:</strong></div><div>I haven't been following this thread, so this may not be useful. However, a few weeks ago someone reported a bug where my CompareTo code was checking for a result of -1 (which should be correct btw - CompareTo is supposed to return -1, 0 or 1) - but it turns out that didn't work with the Short (Int16) data type.<br><br>It appears that Int16's CompareTo implementation itself has a bug, where it returns an arbitrary negative number rather than just -1 like it is supposed to...<br><br>I implemented this fix/workaround for this in the version 2.1 code.<br></div></BLOCKQUOTE><span><font size="2"><br><br>Thanks Rocky for your information. Now, the short datatype will stop bugging me anymore.<br>Btw, Can you post the workaround for the <font color="#0000ff">Short </font>Datatype.<br></font></span></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, September 22, 2006</h2>You're not calling ValidationRules.CheckRules anywhere except in the DataPortal_Create method.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
