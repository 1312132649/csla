<html><header><title>Sorting a collection</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Sorting a collection</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1551.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brownpa1 posted on Friday, October 20, 2006</h2><P>I&nbsp; created a collection called m_colLogEntrys.&nbsp; Each time a user creates or updates an existing record in the Windows Form, I am adding to&nbsp;the m_colLogEntrys&nbsp;collection a log note indicating the date and time and what change or what object was created.&nbsp; Each time I add to that collection, I would like to sort that collection in decending order based on DateTime.&nbsp; I have been searching to try to find out how I can do this, but cannot find anything.&nbsp; Can anyone help?</P>
<P>Here is part of my code:</P>
<P>Dim logentry as LogEntry</P>
<P><FONT size=2><FONT color=#ff0000>'This goes to the LogEntry class and creates the new&nbsp;logentry</FONT><BR></FONT><FONT size=2>logentry = COLibrary.LogEntry.GetNewLogEntry(m_guidId, sbText.ToString, LogSource, LogType)</FONT></P>
<P><FONT size=2><FONT color=#ff0000>'This adds the new log entry to my collection<BR></FONT>m_colLogEntrys.Add(logentry)</FONT></P>
<P><FONT size=2><FONT color=#ff0000>'I would like to sort after a new log entry has been added to the collection</FONT><BR>???? m_colLogEntrys.Sort??????</FONT></P>
<P><FONT size=2>Thank you in advance for you help.</P>
<P>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Friday, October 20, 2006</h2>You can use either the stock SortedBindingList that comes with CSLA or ObjectListView which is in the CSLA contrib project.&nbsp; In either case you add the list to the view and then have the UI (DataGridView, ComboBox, BindingSource, etc.) use the view as the data source.&nbsp; In the case of SortedBindingList you will need to ask the view to re-sort itself whenever you make a change.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brownpa1 replied on Friday, October 20, 2006</h2><P>Thank you, that worked.&nbsp; Instead of using it in my UI, I decided to use it in my LogEntrys Class.&nbsp; Here is the code if anyone is interest</P><FONT color=#0000ff size=2>
<P>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> LogEntrysSorted() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> SortedBindingList(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> LogEntry)<BR><BR></FONT><FONT color=#008000 size=2>&nbsp;&nbsp;&nbsp;'Converting LogEntrys(Me) collection from a BusinessListBase to a SortedBindingList<BR></FONT><FONT color=#008000 size=2>&nbsp;&nbsp;&nbsp;'then sorting the list and pass the sorted list out for use.<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;Dim</FONT><FONT size=2> sortedList </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> SortedBindingList(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> LogEntry) _<BR></FONT><FONT size=2>&nbsp;&nbsp;&nbsp;(</FONT><FONT color=#0000ff size=2>CType </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>,&nbsp;</FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;Global</FONT><FONT size=2>.System.Collections.Generic.IList(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Global</FONT><FONT size=2>.COLibrary.LogEntry)))</P>
<P></FONT><FONT color=#008000 size=2>&nbsp;&nbsp;&nbsp;'sorted by the DateTimeStamp property in LogEntry<BR></FONT><FONT size=2>&nbsp;&nbsp;&nbsp;sortedList.ApplySort(</FONT><FONT color=#800000 size=2>"DateTimeStamp"</FONT><FONT size=2>, ListSortDirection.Descending)</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;Return</FONT><FONT size=2> sortedList<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
