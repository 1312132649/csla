<html><header><title>Business Form</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Business Form</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/488.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael Hildner posted on Tuesday, June 27, 2006</h2><P>As I'm working my way through my first CSLA project (Windows Forms app), I'm thinking about making a BusinessForm class (subclasses Windows.Forms.Form). Thinking if the BusinessForm had a reference to my business object, I could trap FormClosing and then every form would (almost) automatically be able to present "Do you want to save changes? Yes | No | Cancel" based on IsDirty.</P>
<P>Haven't thought about it too much, but I bet there's all sorts of fun stuff (behaviour) you could push up into a common class. I'm sure this isn't an original idea, so I'm wondering what sort of stuff people have put into a base form class.</P>
<P>Just fishing for thoughts,</P>
<P>Mike</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tom Cooley replied on Wednesday, June 28, 2006</h2>Michael,<br><br>I got involved in a project my company started before I did. This was a dataset driven application for a client. When I started, I talked up CSLA and my co-worker was very interested. I got involved in this project around the beginning of the year by adding a few new modules to the application. I did these using CSLA.<br><br>For the purposes of this post, I'll call the client for this project ABC. Also, this is a .Net 1.1 app and therefore uses CSLA 1.<br><br>As I've built this, I've developed a framework for the forms that I use. This is an MDI app so I started out with an ABCChildForm which has some common properties and methods. Things like the BindField method Then, I created an ABCDetailForm which has a SourceObject property like:<br><br>&nbsp; &nbsp; &nbsp; &nbsp; private BusinessBase _sourceObject;<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;public BusinessBase SourceObject<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;{<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;get { return _sourceObject; }<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;set<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;{<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;if (_sourceObject != value)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;{<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;try<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;{<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;this.Cursor = Cursors.WaitCursor;<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;if (value == null)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;_sourceObject = null;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;else<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;_sourceObject = value;<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;OnSourceObjectChanged();<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;}<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;finally<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;{<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;this.Cursor = Cursors.Default;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;}<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;}<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;}<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;protected virtual void OnSourceObjectChanged()<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;{<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}<br><br>The forms that inherit from this do the databinding in the overridden OnSourceObjectChanged method. Similaryly, I created an ABCListForm which has a SourceList property of type SortableCollectionBase. This went back far enough in the inheritance chain of CSLA 1 to allow all the base collection/list types that CSLA 1 provides.<br><br>I also created matching pairs of ABCDetailControl &amp; ABCListControl which ulitmately inherit from UserControl. I use UserControls pretty extensively in WinForms apps and these pair up with their Form counterparts very nicely. There are many other methods and properties that are in these forms &amp; controls but these are the main hooks to CSLA that make other development pretty simple.<br><br>Good luck.<br>Tom<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>burmajam replied on Thursday, June 29, 2006</h2>Hi Tom<br><br>First question is why <br>if (value == null)<br>&nbsp;&nbsp;&nbsp; _sourceObject = null;<br>else<br>&nbsp;&nbsp;&nbsp; _sourceObject = value;<br><br>It could be just _source = value. But I guess that's not much important. <br><br>Another problem that I can see in CSLA 2.0 is Generics. Your _sourceObject should be <br>private BusinessBase&lt;T&gt; _sourceObject;<br><br>thus form should also be generic. So far I didn't solve generic form inheritance problem in design mode (in C#). I think that xal (or someone else) was talking how to solve it in VB. Maybe someone solved it in C# also and can help us :)<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Massong replied on Thursday, June 29, 2006</h2><P>Hi!</P>
<P>Just a thought: Does anybody know if the Visual Studio designer can handle generic forms? Something likes that:</P>
<P><FONT face="Courier New">Class BusinessForm(Of T As BusinessBase(Of T))<BR>&nbsp;&nbsp;&nbsp; Inherits System.Windows.Forms</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp; Private mBusinessObject As T</FONT></P>
<P><FONT face="Courier New">End Class</FONT></P>
<P>Greetings,<BR>Christian</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>burmajam replied on Thursday, June 29, 2006</h2>That's the problem that I was talking about. But as I've mentioned, as far as I can remember someone has explained a workaround for this problem in VB in this or in the old forum. I know that I couldn't solve it in C#. Also as you've said ... this is only designer problem. In runtime it works.<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tom Cooley replied on Thursday, June 29, 2006</h2>The original code did some other things when value != null, but yes this could be simplified as you mentioned.<br><br>Also, as I stated, my solution is for .Net 1.1 and CSLA 1. I'm hoping to move us into .Net 2 very soon and will need to look into this then.<br><br>I'm not sure that making a generic form would gain you much in .Net 2. Having a generic BusinessBase&lt;T&gt; would suffice.<br><br>Tom<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
