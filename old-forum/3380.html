<html><header><title>Toprow of NameValueList with null value</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Toprow of NameValueList with null value</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3380.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>joel posted on Wednesday, August 15, 2007</h2><P>I've seen other posts about how to implement NameValueLists with optional toprows (to allow an unselected value), but I don't think anyone has mentioned the possibility of having a nullable type as the key/index.&nbsp;In most examples, the toprow's index for an "Unselected" value is either "" for strings or 0 for integers.&nbsp; My underlying table uses an int datatype that allows nulls.&nbsp; Historically, I've left the database field null to represent an unselected value, so I'd like to keep it that way.&nbsp; How can I specify in my NameValueList class that it should return a list of (nullable (of Integer), String)?</P>
<P>Joel</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>McManus replied on Wednesday, August 15, 2007</h2><P>Joel,</P>
<P>David Wendelken created some types (SmartInt16, SmartInt32, etc.)&nbsp;that act like a SmartDate. Perhaps you can use a SmartInt32 as the key in the NVL. The key of the toprow can be an empty SmartInt32.</P>
<P>Cheers,<BR>Herman</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Thursday, August 16, 2007</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>McManus:</strong></div><div>
<P>David Wendelken created some types (SmartInt16, SmartInt32, etc.)&nbsp;that act like a SmartDate. Perhaps you can use a SmartInt32 as the key in the NVL. The key of the toprow can be an empty SmartInt32.</P>
<P></div></BLOCKQUOTE></P>
<P>Herman,</P>
<P>Thanks for the plug on the classes!</P>
<P>Here's the way I like to do sql server stored procs for the dropdownlists.&nbsp; </P>
<P>If the record is in insert mode, we bring back a &lt;Choose&gt; tag as the first entry.</P>
<P>If the field is optional, we bring back an empty tag as the next entry.</P>
<P>Sort_Order is a dummy column that allows us to force things to sort in a particular order.</P><FONT color=#0000ff size=2>
<P>CREATE </FONT><FONT color=#0000ff size=2>procedure</FONT><FONT size=2> [MySchema]</FONT><FONT color=#808080 size=2>.</FONT><FONT size=2>[MyApp_MyTable_ddl]<BR>&nbsp;@IsOptional </FONT><FONT color=#0000ff size=2>bit&nbsp;&nbsp; <FONT color=#008000>-- is this an optional field, or must the user choose something?<BR></FONT></FONT><FONT color=#808080 size=2>,</FONT><FONT size=2>@IsInsert&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;</FONT><FONT color=#0000ff size=2>bit&nbsp;&nbsp; <FONT color=#008000>-- are we in insert mode or update mode?<BR></FONT>as<BR></FONT><FONT color=#0000ff size=2><BR>select</FONT><FONT color=#0000ff size=2>&nbsp;<BR></FONT><FONT size=2>&nbsp;tab.Id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>as</FONT><FONT size=2> THE_VALUE<BR>,tab.Description <FONT color=#0000ff>as</FONT> THE_TEXT<BR></FONT><FONT size=2></FONT><FONT color=#808080 size=2>,</FONT><FONT size=2>0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>as</FONT><FONT size=2> SORT_ORDER<BR></FONT><FONT color=#0000ff size=2>from</FONT><FONT size=2> [MySchema].[MyTable]<BR></FONT><FONT color=#0000ff size=2>union</FONT><FONT size=2> </FONT><FONT color=#808080 size=2>all<BR></FONT><FONT color=#0000ff size=2>select<BR></FONT><FONT color=#808080 size=2>&nbsp;NULL<BR></FONT><FONT color=#808080 size=2>,</FONT><FONT color=#ff0000 size=2>''<BR></FONT><FONT color=#808080 size=2>,-</FONT><FONT size=2>1<BR></FONT><FONT color=#0000ff size=2>where</FONT><FONT size=2> @IsOptional </FONT><FONT color=#808080 size=2>=</FONT><FONT size=2> 1<BR></FONT><FONT color=#0000ff size=2>union</FONT><FONT size=2> </FONT><FONT color=#808080 size=2>all<BR></FONT><FONT color=#0000ff size=2>select<BR></FONT><FONT color=#808080 size=2>&nbsp;NULL<BR></FONT><FONT color=#808080 size=2>,</FONT><FONT color=#ff0000 size=2>'&lt;Choose&gt;'<BR></FONT><FONT color=#808080 size=2>,-</FONT><FONT size=2>2<BR></FONT><FONT color=#0000ff size=2>where</FONT><FONT size=2> @IsInsert </FONT><FONT color=#808080 size=2>=</FONT><FONT size=2> 1<BR></FONT><FONT color=#0000ff size=2>order</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>by</FONT><FONT size=2> 3</FONT><FONT color=#808080 size=2>,</FONT><FONT size=2>2</P>
<P>I usually just use strings (because my internal SmartInt32 variables are exposed as string properties).</P>
<P>&nbsp;</P></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
