<html><header><title>Test NoDoubleInit still failing in 3.0 unit tests</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Test NoDoubleInit still failing in 3.0 unit tests</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3355.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>marklindell posted on Thursday, August 09, 2007</h2>This relates to an old post that was never resolved <a HREF="/forums/thread/13903.aspx">here</a>.<br><br><a HREF="/forums/thread/13903.aspx"></a>The reason this test is failing is due to test unit tests having a dependency on the order they are run which was not intended.&nbsp; If your run the test StringRequired() followed by NoDoubleInit(), NoDoubleInit() will fail.<br><br>The reason is that the class level business rules method HasPerTypeRules.AddBusinessRules() will have already been called once and will not be called again so the GlobalContext["Shared"] will not be incremented.<br><br>Rather than trying to clear the internal static state in CSLA, I simply created another HasPerTypeRules2 class and changed it out in the NoDoubleInit() test method.<br><br>Hope this answer the original post.<br><br>Mark Lindell<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>marklindell replied on Thursday, August 09, 2007</h2>As a follow up a similar situation is occuring with AppDomainTestIsCalled().&nbsp; it fails when executed after one of the AppContextTests due to the Global context all ready containing a key that is re-used.&nbsp; The solution to this one is simply to clear the GlobalContext at the beginning of the test.<br><br>Boy, I'm glad I'm testing the tests....<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, August 09, 2007</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>marklindell:</strong></div><div><BR>Boy, I'm glad I'm testing the tests....<BR></div></BLOCKQUOTE></P>
<P>So am I, thanks for the help!</P>
<P>I run the tests as a batch, so they always run in a consistent order (apparently), so I've never encountered any of the reported issues... </P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
