<html><header><title>BusinessList of IInterface</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>BusinessList of IInterface</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3614.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Friday, September 28, 2007</h2>Hi all,<br><br>I just had some really hard to find problems, which centered around ReportViewer, rdlc reports, and BusinessListBase subclasses.<br><br>The basic problem is this:&nbsp; you have a BLB&lt;MyList, ILineItem&gt; so that it can hold any object which implements a particular interface.&nbsp; In my case, I also have a LineItemBase which all different kinds of line items ultimately inherit from (NoteLineItem, SimpleLineItem, BundleLineItem, etc.).<br><br>The problem was showing up as this; my report, which listed the line items in a table, woudl very rarely give me #Error in one or two of the columns.&nbsp; Additionally, I would get errors if I tried to use a boolean property defined on ILineItem to hide a cell within the table.&nbsp; <br><br>Adding to the frustration, it only happened when items would be in a certain order.&nbsp; Changing the order of the items would allow everything to work just fine!&nbsp; <br><br>It turns out, that for whatever reason, sometimes, when items where in a certain order (which thankfully, the order was consistent and so I could reproduce the error reliably), a TargetInvokationException was being thrown, due to a type mismatch or something along those lines.&nbsp; <br><br>It seems that for certain properties, on certain types, once the ReportViewer / LocalReport saw the type, it expected the next time in the list to have exactly the same type.&nbsp; Again, for some reason, changing the order of the items would allow everything to work fine.<br><br>The solution I found was to implement ICustomTypeDescriptor on the LineItem base class, so that it always returned information about LineItem.&nbsp; The reporting tool then uses this information and everything matches, so it seems to be happy.<br><br>Just wanted to post on this, because even though others have hit this same problem, it would immedately obvious that this was the cause of my reporting headaches, and I'm not sure how well known this issue is.<br><br>I have a sample application which you can use to reproduce the problem; if anyone is interested, I can attach it here.<br><br>Andy<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
