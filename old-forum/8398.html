<html><header><title>Creating an interface for my objects...</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Creating an interface for my objects...</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8398.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ballistic posted on Thursday, January 21, 2010</h2>I'm new to C#, but not CSLA.&nbsp; I am working on a new MVC project and would like to do it the "right" way, which means I need to create interefaces.<br><br>I would like to create an interface that my objects would need to implement.&nbsp; Creating the properties was not a problem, however, when I try to add the Data Portal methods, I keep getting errors.<br><br>For instance when I add the following to my interface: <br>void DataPortal_Insert()<br><br>Then try to implement in my concrete class:<br>protected override void DataPortal_Insert()<br><br>I get the error saying that the method cannot be protected.&nbsp; I would like to keep it protected.&nbsp; Is there any way to do this?<br><br>Or what is the best way to create interfaces for the Data Portal methods?<br><br>Thank you,<br><br>&nbsp;- Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, January 21, 2010</h2><P>You can't really create an interface for the DataPortal_XYZ methods, as they are not public.</P>
<P>The reason they aren't public is that they can't be called by UI code. Typical test code takes the place of UI code, and so shouldn't be able to call those methods either.</P>
<P>The only way to call those methods is through the data portal. If you tried to call them directly, you wouldn't be in the same context as you would be when they were invoked via the data portal, which would make your test invalid to start with.</P>
<P>If you want to have a testable DAL, which is a fine idea, then you should use one of the external DAL techniques discussed in Chapter 18 and in both the Silverlight and Core video series. The video series both include code samples showing external DAL implementations.</P>
<P>But even with an external DAL implementation you don't want or need to invoke the DataPortal_XYZ methods. Instead, one of the models has the DP_XYZ methods invoke the DAL - and so you build tests that takes the place of the DP_XYZ methods when invoking the DAL - thus cleanly testing the DAL itself.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ballistic replied on Friday, January 22, 2010</h2>Rocky,<br><br>That makes sense.<br><br>Basically, what I wanted to do was to for any class that implemented the interface to implement an Insert and Update.&nbsp; <br><br>Since Insert and Update are never directly called (I cannot create a factory method that calls Insert or Update) and instead rely on Save() to determine which Data Portal method to call, I wanted to somehow force them to define both Insert and Update.<br><br>Forcing them to implement Get methods is not a problem, since I just define the static factory method in the interface.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, January 22, 2010</h2><P>One good solution is to create a mock DAL. That allows you to create tests at the top level that do create/fetch/save operations to test create/fetch/insert/update/delete - all very fast and against known mock data.</P>
<P>I talk about this at a high level in Chapter 18, and explicitly&nbsp;(with examples)&nbsp;in the Core 3.8 video series.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ballistic replied on Friday, January 22, 2010</h2>I am now working on defining the Get methods in the interface which my concrete methods will implement and am encountering a problem.<br><br>In my interface I want to define the get method:<br>public interface IMemberRegistration<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IMemberRegistration GetRegistration(int id);<br>&nbsp;&nbsp;&nbsp; }<br><br>And in the concrete class I have the definition:<br>&nbsp;&nbsp;&nbsp; [Serializable]<br>&nbsp;&nbsp;&nbsp; class MemberRegistration : BusinessBase&lt;MemberRegistration&gt;, IMemberRegistration<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static IMemberRegistration GetRegistration(int id)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return DataPortal.Fetch&lt;MemberRegistration&gt;(new SingleCriteria&lt;MemberRegistration, int&gt;(id));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br><br>However, since my GetRegistration is static, the compiler says it can't be used to implement the interface.&nbsp; Is there any way to do this?<br><br>Also, I'm not really sure that my concrete class is calling the correct base class and implementation. Nor am I sure if the return type of the GetRegistration method is correct.<br><br>&nbsp;- Andres<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, January 22, 2010</h2><P>No, you can't define static members in an interface, that's not allowed in C# (or VB).</P>
<P>If you really want to be able to test the factory methods through an interface you'll need to create a separate factory class to contain them as instance methods. That's perfectly fine, I just fine that it makes the overall object API less intuitive.</P>
<P>But testibility requires compromise - often increased complexity and more code - just make sure you get enough value from the testing to offset the increased costs.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ballistic replied on Monday, January 25, 2010</h2>Rocky,<br><br>You are right, I will need to create a separate factory class which would implement the interface.&nbsp; I have always liked being able to create the static factory methods within my business objects.&nbsp; This new approach will require me to think more of where my methods are located.<br><br>This is the first time I do set up a project so it can be tested.&nbsp; Sure hope the returns are worth the added complexity :)<br><br>Thanks for your help,<br><br>&nbsp;- Andy<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
