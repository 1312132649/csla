<html><header><title>IEditableObject CancelEdit questions</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>IEditableObject CancelEdit questions</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1813.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Massong posted on Wednesday, November 22, 2006</h2><P>Hi all,</P>
<P>A few weeks ago I posted about a problem adding new items to a Component One TrueDataGrid (<A HREF="/forums/post/7727.aspx">http://forums.lhotka.net/forums/post/7727.aspx</A>): Pressing ESC to cancel adding gets the application crash with a StackOverflowException.</P>
<P>Yesterday I found out, that commenting out the following methods in the <EM>BusinessBase</EM> class solves this problem:</P>
<P><FONT face="Courier New" size=2>Private Sub IEditableObject_BeginEdit() _<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Implements System.ComponentModel.IEditableObject.BeginEdit<BR>Private Sub IEditableObject_CancelEdit() _<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Implements System.ComponentModel.IEditableObject.CancelEdit<BR>Private Sub IEditableObject_EndEdit() _<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Implements System.ComponentModel.IEditableObject.EndEdit</FONT></P>
<P>Additional to the StackOverflowExcetion we had another strange behaviour of the grid when adding items that has gone after commenting that methods out:</P>
<P>•&nbsp;Click into the AddNew row to add a first row to an empty grid<BR>•&nbsp;Enter no data<BR>•&nbsp;Click into empty space of the grid to cancel adding<BR>•&nbsp;The first row is removed without problems</P>
<P>But:</P>
<P>•&nbsp;Add a first row to the grid<BR>•&nbsp;Add a second row to the grid and enter no data<BR>•&nbsp;Click into empty space of the grid to cancel adding the second row<BR>•&nbsp;The grid turns white with a red cross and the following exception is thrown whenever the mouse is moved over the grid:</P>
<P><FONT face="Courier New" size=2>Index was out of range. Must be non-negative and less than the size of the collection.<BR>Parameter name: index</FONT></P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp; at System.Collections.ArrayList.get_Item(Int32 index)<BR>&nbsp;&nbsp; at C1.Win.C1TrueDBGrid.BaseGrid.ViewRowList.get_Item(Int32 index)<BR>&nbsp;&nbsp; at C1.Win.C1TrueDBGrid.BaseGrid.View.chooseCursor(Point p)<BR>&nbsp;&nbsp; at C1.Win.C1TrueDBGrid.BaseGrid.View.OnMouseMove(MouseEventArgs e)<BR>&nbsp;&nbsp; at cd.c(MouseEventArgs A_0)<BR>&nbsp;&nbsp; at C1.Win.C1TrueDBGrid.BaseGrid.Frame.doMouseMove(MouseEventArgs e)<BR>&nbsp;&nbsp; at C1.Win.C1TrueDBGrid.C1TrueDBGrid.doMouseMove(MouseEventArgs e)<BR>&nbsp;&nbsp; at C1.Win.C1TrueDBGrid.BaseGrid.Frame.OnMouseMove(MouseEventArgs e)<BR>&nbsp;&nbsp; at System.Windows.Forms.Control.WmMouseMove(Message&amp; m)<BR>&nbsp;&nbsp; at System.Windows.Forms.Control.WndProc(Message&amp; m)<BR>&nbsp;&nbsp; at C1.Win.C1TrueDBGrid.C1TrueDBGrid.WndProc(Message&amp; m)<BR>&nbsp;&nbsp; at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)<BR>&nbsp;&nbsp; at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)<BR>&nbsp;&nbsp; at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)</FONT></P>
<P>My questions are:</P>
<P>•&nbsp;Does anybody else use the TrueDataGrid? Have you any problems with the grid?<BR>•&nbsp;Are there known issues with the IEditableObject-implementation? Especially with the IEditableObject.CancelEdit? I remember I read something about problems with the Janus Grid...?<BR>•&nbsp;Can I leave this methods commented out without getting other problems?</P>
<P>Thanks for help!</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, November 22, 2006</h2><P>One common request is to have a switch on BusinessBase that allows the IEditableObject support to be turned off - for this very reason. Some 3rd party grids just don't seem to properly interact with this interface...</P>
<P>That switch would be the equivalent of commenting out the interface implementation, so if commenting it out works for you then so be it <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Massong replied on Thursday, November 23, 2006</h2><P>Hi Rocky,</P>
<P>Thank you very much. Clicking into the wrong place of the grid was very frustrating - when a lot of data had been entered...<BR></P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
