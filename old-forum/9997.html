<html><header><title>Validation of Min/Max Value in csla 4.x</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Validation of Min/Max Value in csla 4.x</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9997.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>tsvideo posted on Friday, January 28, 2011</h2><p>Hello!</p>
<p>&nbsp;I want to Validate 2 Fields MinValue and MaxValue, that MaxValue is more or equal to MinValue.</p>
<p>&nbsp;My first Solution was to make one Validation Object, but this doesn&#39;t Work because the Data Portal throw an exception that there ist already a Element with the same name.</p>
<p>&nbsp;<b>My Code (try) with one Validation Object:</b></p>
<p>&nbsp; /// &lt;summary&gt;</p>
<p>&nbsp; /// ValidateMinMaxString Pr&uuml;fen, ob MaxWert gr&ouml;&szlig;er oder gleich MinWert ist (Umwandlung in Zahl)</p>
<p>&nbsp; /// &lt;/summary&gt;</p>
<p>&nbsp; public class ValidateMinMaxString : Csla.Rules.BusinessRule</p>
<p>&nbsp; {</p>
<p>&nbsp;&nbsp;&nbsp; private Csla.Core.IPropertyInfo _minProperty;</p>
<p>&nbsp;&nbsp;&nbsp; private Csla.Core.IPropertyInfo _maxProperty;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp; public ValidateMinMaxString(Csla.Core.IPropertyInfo primaryProperty, Csla.Core.IPropertyInfo minProperty, Csla.Core.IPropertyInfo maxProperty)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : base(primaryProperty)</p>
<p>&nbsp;&nbsp;&nbsp; {</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _minProperty = minProperty;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _maxProperty = maxProperty;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InputProperties = new List&lt;Csla.Core.IPropertyInfo&gt; { PrimaryProperty };</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InputProperties.Add(minProperty);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InputProperties.Add(maxProperty);</p>
<p>&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp; protected override void Execute(Csla.Rules.RuleContext context)</p>
<p>&nbsp;&nbsp;&nbsp; {</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int minValue;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int maxValue;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (int.TryParse((string)context.InputPropertyValues[_minProperty], out minValue)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp; int.TryParse((string)context.InputPropertyValues[_maxProperty], out maxValue))</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (minValue &gt; maxValue)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.AddErrorResult(&quot;Der Max Wert mu&szlig; gr&ouml;&szlig;er oder gleich dem Min Wert sein&quot;);</p>
<p>&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp; }</p>
<p>&nbsp;Protected void AddBusinessRules()</p>
<p>{</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BusinessRules.AddRule(new&nbsp;ValidateMinMaxString(MinwertProperty,&nbsp;MinwertProperty,&nbsp;MaxwertProperty));<br />BusinessRules.AddRule(new&nbsp;ValidateMinMaxString(MaxwertProperty,&nbsp;MinwertProperty,&nbsp;MaxwertProperty));</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BusinessRules.AddRule(new&nbsp;Csla.Rules.CommonRules.Dependency(MinwertProperty,&nbsp;MaxwertProperty));</p>
<p>}</p>
<p>&nbsp;<b>My Working Solution, with two Validation Objects:</b></p>
<p>&nbsp;&nbsp;///&nbsp;&lt;summary&gt;<br /><br />&nbsp;&nbsp;///&nbsp;ValidateMinMaxString&nbsp;Pr&uuml;fen,&nbsp;ob&nbsp;MaxWert&nbsp;gr&ouml;&szlig;er&nbsp;oder&nbsp;gleich&nbsp;MinWert&nbsp;ist&nbsp;(Umwandlung&nbsp;in&nbsp;Zahl)<br /><br />&nbsp;&nbsp;///&nbsp;&lt;/summary&gt;<br /><br />&nbsp;&nbsp;public&nbsp;class&nbsp;ValidateMinString&nbsp;:&nbsp;Csla.Rules.BusinessRule<br /><br />&nbsp;&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Csla.Core.IPropertyInfo&nbsp;_maxProperty;<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ValidateMinString(Csla.Core.IPropertyInfo&nbsp;primaryProperty,&nbsp;Csla.Core.IPropertyInfo&nbsp;maxProperty)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;base(primaryProperty)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_maxProperty&nbsp;=&nbsp;maxProperty;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InputProperties&nbsp;=&nbsp;new&nbsp;List&lt;Csla.Core.IPropertyInfo&gt;&nbsp;{&nbsp;PrimaryProperty,&nbsp;maxProperty&nbsp;};<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;override&nbsp;void&nbsp;Execute(Csla.Rules.RuleContext&nbsp;context)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;minValue;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;maxValue;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(int.TryParse((string)context.InputPropertyValues[PrimaryProperty],&nbsp;out&nbsp;minValue)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;int.TryParse((string)context.InputPropertyValues[_maxProperty],&nbsp;out&nbsp;maxValue))<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(minValue&nbsp;&gt;&nbsp;maxValue)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;context.AddErrorResult(&quot;Der&nbsp;Min&nbsp;Wert&nbsp;mu&szlig;&nbsp;kleiner&nbsp;oder&nbsp;gleich&nbsp;dem&nbsp;Max&nbsp;Wert&nbsp;sein&quot;);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;///&nbsp;&lt;summary&gt;<br />&nbsp;&nbsp;///&nbsp;ValidateMinMaxString&nbsp;Pr&uuml;fen,&nbsp;ob&nbsp;MaxWert&nbsp;gr&ouml;&szlig;er&nbsp;oder&nbsp;gleich&nbsp;MinWert&nbsp;ist&nbsp;(Umwandlung&nbsp;in&nbsp;Zahl)<br />&nbsp;&nbsp;///&nbsp;&lt;/summary&gt;<br />&nbsp;&nbsp;public&nbsp;class&nbsp;ValidateMaxString&nbsp;:&nbsp;Csla.Rules.BusinessRule<br /><br />&nbsp;&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;Csla.Core.IPropertyInfo&nbsp;_minProperty;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;ValidateMaxString(Csla.Core.IPropertyInfo&nbsp;primaryProperty,&nbsp;Csla.Core.IPropertyInfo&nbsp;minProperty)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;base(primaryProperty)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_minProperty&nbsp;=&nbsp;minProperty;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InputProperties&nbsp;=&nbsp;new&nbsp;List&lt;Csla.Core.IPropertyInfo&gt;&nbsp;{&nbsp;PrimaryProperty,&nbsp;minProperty&nbsp;};<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;protected&nbsp;override&nbsp;void&nbsp;Execute(Csla.Rules.RuleContext&nbsp;context)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;minValue;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;maxValue;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(int.TryParse((string)context.InputPropertyValues[PrimaryProperty],&nbsp;out&nbsp;maxValue)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;int.TryParse((string)context.InputPropertyValues[_minProperty],&nbsp;out&nbsp;minValue))<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(minValue&nbsp;&gt;&nbsp;maxValue)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;context.AddErrorResult(&quot;Der&nbsp;Max&nbsp;Wert&nbsp;mu&szlig;&nbsp;gr&ouml;&szlig;er&nbsp;oder&nbsp;gleich&nbsp;dem&nbsp;Min&nbsp;Wert&nbsp;sein&quot;);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;}</p>
<p>&nbsp;protected&nbsp;void AddBusinessRules()<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BusinessRules.AddRule(new&nbsp;ValidateMinString(MinwertProperty,&nbsp;MaxwertProperty));<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BusinessRules.AddRule(new&nbsp;ValidateMaxString(MaxwertProperty,&nbsp;MinwertProperty));<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BusinessRules.AddRule(new&nbsp;Csla.Rules.CommonRules.Dependency(MinwertProperty,&nbsp;MaxwertProperty));</p>
<pre style="font-family:consolas;">&nbsp;BusinessRules.AddRule(<span style="color:blue;">new</span>&nbsp;Csla.Rules.CommonRules.<span style="color:#2b91af;">Dependency</span>(MaxwertProperty,&nbsp;MinwertProperty));<br />}</pre>
<p><b>My Question:</b></p>
<p>Is there a Way to have only one Validation Object ?</p>
<p>Thank you for help</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Friday, January 28, 2011</h2><p>yes, you can. This rule already exists in CslaContrib: http://cslacontrib.codeplex.com. Look at the LessThan and GreaterThan rules that compare 2 fields.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Friday, January 28, 2011</h2><p>yes, you can. I would however prefer to have separate rules. As separate rules these already exists in CslaContrib: http://cslacontrib.codeplex.com. Look at the LessThan and GreaterThan rules that compare 2 fields.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tsvideo replied on Friday, January 28, 2011</h2><p>Hello Jonny,</p>
<p>thank you for your answer, i would look in CslaContrib.</p>
<p>Thilo</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
