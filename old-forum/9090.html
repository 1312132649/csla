<html><header><title>MVVM - MarkDirty the Model from the ViewModel</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>MVVM - MarkDirty the Model from the ViewModel</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9090.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>t.kehl posted on Wednesday, June 16, 2010</h2><p>Hi.</p>
<p>I have created a BusinessObject Contact (EditableRoot). Now, I have also created a ViewModel which holds a Contact-Object as Model. In the ViewModel, I have extended a Property that I need for Display some Information from a ChildList of Contact. This Property will be binded to the View. I load this property, when I create the ViewModel and save the values, when the ViewModel will save the Model. Now, I am searching the best way, to set the Model Dirty from the ViewModel, when the value of my new Property in the ViewModel has been changed. The Property IsDirty of the Model (BusinessBase) has now setter and the Method MarkDirty() is protected. So, how should I solve this problem?</p>
<p>Thank you for any help!</p>
<p>Best Regards, Thomas</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Wednesday, June 16, 2010</h2><p><div style='padding-left: 50px;background-color:silver'><b>t.kehl<br></b>Now, I have also created a ViewModel which holds a Contact-Object as Model</div></p>
<p>Reading this sentence in your post, I get the feeling that you may not be creating the ViewModel the right way.&nbsp; In fact it appears that you are probebly not creating your object graph (Contact and its ChildList) correctly.&nbsp; If you create them correctly using the Csla techniques, you will not need to Mark Dirty any object manually. When any child in the ChildList is modified, Csla will take care of&nbsp;marking the appropriate objects in the objectgraph dirty.</p>
<p>Finally you create a ViewModel (when using Csla) like this</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public class ContactViewModel : ViewModel&lt;Contact&gt; </p>
<p>With that the Contact automatically becomes the Model in your ViewModel, and you can access any and all of its children using the Model property.&nbsp; In fact &quot;Model&quot; will be the Contact object and can be treated as such.</p>
<p>Jav</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>t.kehl replied on Wednesday, June 16, 2010</h2><p>Hi Jav</p>
<p>I create the ViewModel like you wrote with </p>
<p>public class ContactViewModel : ViewModel&lt;Contact&gt;</p>
<p>But I have the fallowing problem:</p>
<p>Contact has a ChildList SearchTermChildList:</p>
<p>public Child.SearchTermChildList SearchTermChildList {<br />&nbsp;&nbsp; get {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!(FieldManager.FieldExists(SearchTermChildListProperty))) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LoadProperty(SearchTermChildListProperty, Child.SearchTermChildList.GetSearchTermChildList(this.Id));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return GetProperty(SearchTermChildListProperty);<br />&nbsp;&nbsp; }<br />}</p>
<p>The objects in this ChildList are of Type SearchTerm. Each SearchTerm-Objekt has a Property Name. Now, I need all Names of all SearchTermChilds concatenated to one string with LineFeed beteween each Name and show the whole string in a TextBox. The User can now write, change or delete lines in this TextBox. This means, there should be created new Child-Objects, child-objects should be edited or deleted. I plan now, to create the whole string when the ViewModel will be created and also create a Property in the ViewModel, that I can bind this string to the TextBox in the View. Now, when the user will write in the textbox, this property in the ViewModel will be changed what mean, I have to manipulate the child-List, when the Model will be saved. For this, I have also to mark the model as dirty, when the user changes the text in the textbox (so, for example the save-button will be enabled).</p>
<p>I have the meaning, that it should be possible to extend the model with &quot;View-Properties&quot; in the ViewModel and then I should have an interaction between the ViewModel and the Model (perhaps set dirty) - or is this the wrong way?</p>
<p>Instead extend the ViewModel with &quot;DisplayProperties&quot; I could also use IConverter and bind directly to the SearchTermChildList. But on this way, I have the Problem, that the Property SearchTermChildList is readonly and I don&#39;t know a way how I can write the changes back.</p>
<p>Best Regards, Thomas</p>
<p>&nbsp;</p>
<p>
<p><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"></span></span></p>
</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
