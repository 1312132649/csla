<html><header><title>DataGrid not populating from CslaDataProvider</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>DataGrid not populating from CslaDataProvider</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7085.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius posted on Thursday, June 11, 2009</h2><P>I&nbsp;must be missing something, but I don't know what. I have my csla dataprovider:</P><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>csla</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>CslaDataProvider</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> x</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>Key</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="ProcCodeListDataProvider"</FONT></FONT><FONT size=2> </P>
<P></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>FactoryMethod</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="BeginGetMyList"</FONT></FONT><FONT size=2> </P>
<P></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>ObjectType</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="SlTest.Library.MyList, SlTest.Library"</FONT></FONT><FONT size=2> </P>
<P></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>IsInitialLoadEnabled</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="False" &gt;</P></FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;/</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>csla</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>CslaDataProvider</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&gt;</FONT></FONT></P>
<P><FONT color=#000000 size=2>----------------------------------------------------------</FONT></P>
<P><FONT color=#000000 size=2>On a button click, I do this (</FONT></P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>private</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>void</FONT></FONT><FONT size=2> btnSubmit_Click(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2> sender, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>RoutedEventArgs</FONT></FONT><FONT size=2> e)</P>
<P>{</P><FONT size=2>
<P></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>CslaDataProvider</FONT></FONT><FONT size=2> procCodeListProvider = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT><FONT size=2>.Resources[</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"ProcCodeListDataProvider"</FONT></FONT><FONT size=2>] </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>as</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>CslaDataProvider</FONT></FONT><FONT size=2>;</P>
<P></FONT>procCodeListProvider.FactoryParameters.Clear();</P>
<P>procCodeListProvider.FactoryParameters.Add(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT><FONT size=2>.DataContext </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>as</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>CodeListCrit</FONT></FONT><FONT size=2>);</P>
<P>procCodeListProvider.Refresh();</P>
<P>}</P>
<P>----------------------------------------------------------</P>
<P>Everything appears to be working properly, I can even break in the Server DataPortal_Fetch method to make sure my BO is actually being "Fetched".&nbsp; However, my DataGrid is not populated or refreshed&nbsp;from the XAML binding(below)</P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>&lt;</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>data</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>DataGrid</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> x</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>Name</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="grdProcCodeList"</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> Grid.Row</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="4"</FONT></FONT><FONT size=2> </FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>Grid.Column</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="0"</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> Grid.ColumnSpan</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="3"</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>ItemsSource</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="{</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>Binding</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> Source</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>={</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>StaticResource</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> ProcCodesListDataSource</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>},</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> Path</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>=Data}"&gt;</P></FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;/</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>data</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>DataGrid</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&gt;</FONT></FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#000000>----------------------------------------------------------</FONT></P></FONT></FONT>
<P>I'm new to XAML and this concept of databinding is quite awkward to me, because I don't know how to debug this kind of thing since it's totally handled by XAML.&nbsp; What am I missing??</P>
<P>&nbsp;</P>
<P>&nbsp;</P></FONT>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;</P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius replied on Thursday, June 11, 2009</h2><P>On thing has certainly helped me troubleshoot.&nbsp; Let this be a lesson to any other Silverlight newbs:</P>
<P>I hadn't yet&nbsp; subscribed to the CslaDataProvider DataChanged event like so:</P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>private</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>void</FONT></FONT><FONT size=2> CslaDataProvider_DataChanged(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2> sender, System.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>EventArgs</FONT></FONT><FONT size=2> e)</P>
<P>{</P>
<P></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>CslaDataProvider</FONT></FONT><FONT size=2> provider = (</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>CslaDataProvider</FONT></FONT><FONT size=2>)(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT><FONT size=2>.Resources[</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"MyCslaDataProvider"</FONT></FONT><FONT size=2>]);</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>if</FONT></FONT><FONT size=2> (provider.Error != </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>null</FONT></FONT><FONT size=2>)</P>
<P>System.Windows.Browser.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>HtmlPage</FONT></FONT><FONT size=2>.Window.Alert(provider.Error.Message);</P>
<P>}</P></FONT>
<P>Once the framework gets done with the async call for the BO fired from provider.Refresh() in the button click event is when it actually gets data in the provider.Data property (because of how Csla.Silverlight works with the wcf). </P>
<P>Now... I must figure out why I'm getting a "A parameterless constructor was not found for the object."&nbsp; I thought I took care of this with my SILVERLIGHT comilation symbols.&nbsp;Must the constructor on the Server need to be public as well for Silverlight?? or is it something else.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>esaulsberry replied on Thursday, June 11, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>decius:</strong></div><div><FONT size=2>
<P>procCodeListProvider.FactoryParameters.Add(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT><FONT size=2>.DataContext </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>as</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>CodeListCrit</FONT></FONT><FONT size=2>);</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2></P>
<P></FONT></FONT></div></BLOCKQUOTE></P>
<P>Maybe I'm missing something but it seems odd to me you'd be passing the data context of the control as the factory criteria.&nbsp; </P>
<P>You want to make sure any custom criteria classes have public parameterless constructors.</P>
<P>One way to debug binding is to include a value converter that doesn't do anything but give you a place to break.&nbsp; </P>
<P><FONT size=2></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>///</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2> </FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;summary&gt;</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>///</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2> This class exists to aid debugging. By attaching this converter to a binding, you can </P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>///</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2> set a break point as the object is bound and inspect it.</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>///</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2> </FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;/summary&gt;</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>class</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>DebugConverter</FONT></FONT><FONT size=2> : </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>IValueConverter</P></FONT></FONT><FONT size=2>
<P>{</P></FONT><FONT color=#c0c0c0 size=2><FONT color=#c0c0c0 size=2>
<P>#region</FONT></FONT><FONT size=2> IValueConverter Members</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2> Convert(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2> value, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Type</FONT></FONT><FONT size=2> targetType, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2> parameter, System.Globalization.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>CultureInfo</FONT></FONT><FONT size=2> culture)</P>
<P>{</P>
<P></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Debug</FONT></FONT><FONT size=2>.WriteLine(value.ToString());</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>return</FONT></FONT><FONT size=2> value;</P>
<P>}</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2> ConvertBack(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2> value, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Type</FONT></FONT><FONT size=2> targetType, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2> parameter, System.Globalization.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>CultureInfo</FONT></FONT><FONT size=2> culture)</P>
<P>{</P>
<P></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Debug</FONT></FONT><FONT size=2>.WriteLine(value.ToString());</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>return</FONT></FONT><FONT size=2> value;</P>
<P>}</P></FONT><FONT color=#c0c0c0 size=2><FONT color=#c0c0c0 size=2>
<P>#endregion</P></FONT></FONT><FONT size=2>
<P>}</P><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>
<P>Text</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="{</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>Binding</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> Path</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>=ExternalId,</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> Mode</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>=TwoWay,</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> Converter</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>={</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>StaticResource</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> DebugConverter</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>}}"</P></FONT></FONT></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2></FONT></FONT>
<P>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius replied on Friday, June 12, 2009</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>esaulsberry:</strong></div><div>Maybe I'm missing something but it seems odd to me you'd be passing the data context of the control as the factory criteria.&nbsp; </div></BLOCKQUOTE></P>
<P>I'm a newb to Silverlight and XAML.&nbsp; This seemed to make sense to me, but I don't doubt that it could be odd.&nbsp; In the past with Csla, I've always made my own public criteria classes extended from BusinessBase to use as the factory method's parameters.&nbsp; That way I can bind that one class to the UI and perform validation on it from Business base etc, which has made for easy maintenance.&nbsp; So here, that's what I'm trying to do (I set the datacontext of the control as the criteria, then fetch the data with it and bind that result to the DataGrid).&nbsp; Is there a better (or more conventional) way to do this in Silverlight/XAML?? I'm so used to working with BindingSources that I'm really out of my element now.</P>
<P>That debug converter trick will&nbsp;be extremely handy! Thanks so much for that tip</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>esaulsberry replied on Friday, June 12, 2009</h2><P>A couple of things might help:</P>
<P>My CslaDataProviders are usually set to not load automatically (<FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>IsInitialLoadEnabled</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="False"</FONT></FONT>).&nbsp; In code I load criteria parameters.&nbsp; For example, this code is called when the form is loaded.</P><FONT size=2>
<P>_siteListProvider.FactoryParameters.Clear();<BR>_siteListProvider.FactoryParameters.Add(</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>App</FONT></FONT><FONT size=2>.ClientId);<BR>_siteListProvider.FactoryParameters.Add(</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"All Sites"</FONT></FONT><FONT size=2>);<BR>_siteListProvider.Refresh();</FONT></P>
<P><FONT size=2>In my case, SingleCriteria frequently doesn't help for me.&nbsp;&nbsp;I usually have to pass a client ID plus some other value.&nbsp; I wrote a generic criteria class to support this.&nbsp; The corresponding criteria class looks like this:</FONT></P><FONT size=2>
<P></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>///</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2> </FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;summary&gt;<BR></FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>///</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2> A generic class to pass criteria containing the client id plus some other criteria value.<BR></FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>///</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2> </FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;/summary&gt;<BR></FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>///</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2> </FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;typeparam name="B"&gt;</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>The type of the business class using the criteria.</FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;/typeparam&gt;<BR></FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>///</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2> </FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;typeparam name="T"&gt;</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>The type of the "other" criteria value.</FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;/typeparam&gt;<BR></FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>///</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2> </FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;example&gt;</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>portal.BeginFetch(new ClientIdValueCriteria</FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;ParentSiteNVL, string&gt;</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>(clientId, noSelectionLabel));</FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;/example&gt;</P></FONT></FONT><FONT size=2>
<P>[</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Serializable</FONT></FONT><FONT size=2>()]<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>class</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ClientIdValueCriteria</FONT></FONT><FONT size=2>&lt;B, T&gt;:</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>CriteriaBase</FONT></FONT><FONT size=2> <BR>{<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>private</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2> _clientId;<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2> ClientId { </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>get</FONT></FONT><FONT size=2> { </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>return</FONT></FONT><FONT size=2> _clientId; } </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>set</FONT></FONT><FONT size=2> { _clientId = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>value</FONT></FONT><FONT size=2>; } }</FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>private</FONT></FONT><FONT size=2> T _value;<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> T Value { </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>get</FONT></FONT><FONT size=2> { </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>return</FONT></FONT><FONT size=2> _value; } </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>set</FONT></FONT><FONT size=2> { _value = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>value</FONT></FONT><FONT size=2>; } }</P>
<P></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>///</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2> </FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;summary&gt;<BR></FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>///</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2> Silverlight likes a empty public constructor.<BR></FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>///</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2> </FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;/summary&gt;</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> ClientIdValueCriteria() : </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>base</FONT></FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>typeof</FONT></FONT><FONT size=2>(B)) { }</P>
<P></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>///</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2> </FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;summary&gt;<BR></FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>///</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2> Creates a new criteria class.<BR></FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>///</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2> </FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;/summary&gt;<BR></FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>///</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2> </FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;param name="clientId"&gt;</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>The client id for this instance.</FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;/param&gt;<BR></FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>///</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2> </FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;param name="value"&gt;</FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>The value of the non-clientid criteria.</FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;/param&gt;</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> ClientIdValueCriteria(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2> clientId, T value)<BR>: </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>base</FONT></FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>typeof</FONT></FONT><FONT size=2>(B))<BR>{<BR>_clientId = clientId;<BR>_value = value;<BR>}</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>protected</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>override</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>void</FONT></FONT><FONT size=2> OnGetState(Csla.Serialization.Mobile.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>SerializationInfo</FONT></FONT><FONT size=2> info, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>StateMode</FONT></FONT><FONT size=2> mode)<BR>{<BR>info.AddValue(</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"_clientId"</FONT></FONT><FONT size=2>, _clientId);<BR>info.AddValue(</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"_value"</FONT></FONT><FONT size=2>, _value);<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>base</FONT></FONT><FONT size=2>.OnGetState(info, mode);<BR>}</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>protected</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>override</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>void</FONT></FONT><FONT size=2> OnSetState(Csla.Serialization.Mobile.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>SerializationInfo</FONT></FONT><FONT size=2> info, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>StateMode</FONT></FONT><FONT size=2> mode)<BR>{<BR>_clientId = (</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2>)info.Values[</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"_clientId"</FONT></FONT><FONT size=2>].Value;<BR>_value = (T)info.Values[</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"_value"</FONT></FONT><FONT size=2>].Value;<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>base</FONT></FONT><FONT size=2>.OnSetState(info, mode);<BR>}</P>
<P>}</FONT></P>
<P><FONT size=2>Here is the business class, in this case a name value list.</FONT></P><FONT size=2><FONT size=2>
<P>[</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Serializable</FONT></FONT><FONT size=2>()]<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>class</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ParentSiteNVL</FONT></FONT><FONT size=2>:</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>NameValueListBase</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2>&gt;<BR>{</P></FONT><FONT color=#c0c0c0 size=2><FONT color=#c0c0c0 size=2>
<P>#region</FONT></FONT><FONT size=2> Factory &amp; Constructors<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>static</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>void</FONT></FONT><FONT size=2> BeginGetParentSiteNVL(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2> clientId, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>EventHandler</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>DataPortalResult</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ParentSiteNVL</FONT></FONT><FONT size=2>&gt;&gt; handler)<BR>{<BR></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>DataPortal</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ParentSiteNVL</FONT></FONT><FONT size=2>&gt; portal = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>DataPortal</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ParentSiteNVL</FONT></FONT><FONT size=2>&gt;();<BR>portal.FetchCompleted += handler;<BR>portal.BeginFetch(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>SingleCriteria</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ParentSiteNVL</FONT></FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2>&gt;(clientId));<BR>}</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>static</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>void</FONT></FONT><FONT size=2> BeginGetParentSiteNVL(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2> clientId, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2> noSelectionLabel, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>EventHandler</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>DataPortalResult</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ParentSiteNVL</FONT></FONT><FONT size=2>&gt;&gt; handler)<BR>{<BR></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>DataPortal</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ParentSiteNVL</FONT></FONT><FONT size=2>&gt; portal = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>DataPortal</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ParentSiteNVL</FONT></FONT><FONT size=2>&gt;();<BR>portal.FetchCompleted += handler;<BR>portal.BeginFetch(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ClientIdValueCriteria</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ParentSiteNVL</FONT></FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2>&gt;(clientId, noSelectionLabel));<BR>}</P></FONT><FONT color=#c0c0c0 size=2><FONT color=#c0c0c0 size=2>
<P>#if</FONT></FONT><FONT size=2> SILVERLIGHT<BR></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>public ParentSiteNVL() { }<BR></FONT></FONT><FONT color=#c0c0c0 size=2><FONT color=#c0c0c0 size=2>#else<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>private</FONT></FONT><FONT size=2> ParentSiteNVL() { }<BR></FONT><FONT color=#c0c0c0 size=2><FONT color=#c0c0c0 size=2>#endif</P>
<P>#endregion</P>
<P>#region</FONT></FONT><FONT size=2> Data Portal</P></FONT><FONT color=#c0c0c0 size=2><FONT color=#c0c0c0 size=2>
<P>#if</FONT></FONT><FONT size=2> !SILVERLIGHT<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>private</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>void</FONT></FONT><FONT size=2> DataPortal_Fetch(</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>SingleCriteria</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ParentSiteNVL</FONT></FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2>&gt; criteria)<BR>{<BR>Fetch(criteria.Value, </FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"No Parent"</FONT></FONT><FONT size=2>);<BR>}<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>private</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>void</FONT></FONT><FONT size=2> DataPortal_Fetch(</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ClientIdValueCriteria</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ParentSiteNVL</FONT></FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2>&gt; criteria)<BR>{<BR>Fetch(criteria.ClientId, criteria.Value);<BR>}</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>private</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>void</FONT></FONT><FONT size=2> Fetch(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2> clientId, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2> noSelectionLabel)<BR>{<BR>Data.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>OSMobileDataContext</FONT></FONT><FONT size=2> dc = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> Data.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>OSMobileDataContext</FONT></FONT><FONT size=2>();<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>var</FONT></FONT><FONT size=2> parents = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>from</FONT></FONT><FONT size=2> s </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>in</FONT></FONT><FONT size=2> dc.Sites<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>where</FONT></FONT><FONT size=2> s.ClientID == clientId <BR>&amp;&amp; s.IsActive == </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>true<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>orderby</FONT></FONT><FONT size=2> s.ParentSiteID, s.Description<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>select</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> { s.SiteID, s.Description };</FONT></P>
<P><FONT size=2>RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>false</FONT></FONT><FONT size=2>;<BR>IsReadOnly = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>false</FONT></FONT><FONT size=2>;</FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT><FONT size=2>.Add(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>NameValueListBase</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2>&gt;.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>NameValuePair</FONT></FONT><FONT size=2>(0, noSelectionLabel));</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>foreach</FONT></FONT><FONT size=2> (</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>var</FONT></FONT><FONT size=2> p </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>in</FONT></FONT><FONT size=2> parents)<BR>{<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT><FONT size=2>.Add(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>NameValueListBase</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2>&gt;.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>NameValuePair</FONT></FONT><FONT size=2>(p.SiteID, p.Description));<BR>}</P>
<P>IsReadOnly = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>true</FONT></FONT><FONT size=2>;<BR>RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>true</FONT></FONT><FONT size=2>;<BR>}<BR></FONT><FONT color=#c0c0c0 size=2><FONT color=#c0c0c0 size=2>#endif<BR>#endregion<BR></FONT></FONT><FONT size=2>}</P></FONT>
<P>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fintanv replied on Friday, June 12, 2009</h2>You may wish to look at Karl's great tool for debugging SilverLight: <A href="http://karlshifflett.wordpress.com/2009/06/08/glimpse-for-silverlight-viewing-exceptions-and-binding-errors/">http://karlshifflett.wordpress.com/2009/06/08/glimpse-for-silverlight-viewing-exceptions-and-binding-errors/</A></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
