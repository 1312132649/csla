<html><header><title>Object not updating</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Object not updating</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8389.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>strangerd posted on Thursday, January 21, 2010</h2>Hi<br><br>In the documentation somewhere, it talks about objects being "refreshed". After I create a new object and save it into the DB, is the object supposed to be brought back to be used immediately in the application?<br><br>For instance I create a new task with a new DB generated identity field in SQL Server. I want to use the ID in the application immediately afterwards. Is the ID property in the object supposed to have the new ID value from SQL after it has been saved?<br><br>Or is the solution to use SCOPE_IDENTITY() in the stored proc that creates the record.<br><br>Thank you<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Calin replied on Thursday, January 21, 2010</h2>Hi Strangert,<br /><br /> Here is how I achive what you requiere. In the ObjectFactory I have a method DoInsert that inserts the new object in the database. Here some usefull code from it.<br /><br />private void DoInsert(BusinessObject bo)<br />{<br />  ... update the BO properties ...<br /><br /> using (BypassPropertyChecks(bo))<br />            {<br />                LoadProperty(bo, BusinessObject .IdProperty, boEntity.ID);<br />            }<br /><br /> .... rest of the code like MarkAsOld(bo) ...<br />}<br /><br /> Now this is called from the Update method in the Object Factory:<br /><br /> [Transactional(TransactionalTypes.TransactionScope)]<br />        private BusinessObject Update(BusinessObject bo)<br />{<br /> .... update and delete code ...<br /> if(bo.IsNew)<br /> {<br />  DoUpdate(bo);<br /> }<br /> <br /> return bo;<br />}<br /><br />You might have noticed that I use a ORM mapper (nhibernate in this case) this explains the boEntity.ID my data entity get's automaticly updated when saving into the databse, and all I have to do is to load the new id in the business object.<br /><br />Hope this answers your questions,<br />Regards.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>strangerd replied on Thursday, January 21, 2010</h2>Thanks</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, January 21, 2010</h2>Hi, <br><br>When you save a Csla object a new object is returned that will contain f.ex the Id generated in the DB. <br><br>var savedObject = myBO.Save(); <br><br>the new savedObject should then be databound to the UI and will containg the generated id. <br><br>How you get the Id generated in the DB into you BO would depend on the chosen Data Access technology. EntityFramework and ADO.NET are different breeds and I am not sure what you are using. <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>strangerd replied on Thursday, January 21, 2010</h2>Thank you<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>strangerd replied on Friday, January 22, 2010</h2>Hi JonnyBee<br><br>I am using ADO.NET<br><br>Thanks<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
