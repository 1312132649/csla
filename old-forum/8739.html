<html><header><title>Update object reference bound silverlight listbox after save</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Update object reference bound silverlight listbox after save</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8739.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>AaronH posted on Monday, March 29, 2010</h2><p>Wondering how others have handled a similar situation.&nbsp; I have a ViewModel (not a CSLA VM) that exposes 2 properties:&nbsp; VM.Items and VM.CurrentItem (left out getter/setter code for sake of brevity - PropertyChanged is being fired properly.&nbsp; Also, Parent is a EditableRoot)</p>
<p>&nbsp;</p>
<p><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><font face="Consolas" size="2" color="#0000ff"><font face="Consolas" size="2" color="#0000ff"><font face="Consolas" size="2" color="#0000ff">
<p>public&nbsp;</p>
</font></font></font></span><font face="Consolas" size="2" color="#0000ff"><font face="Consolas" size="2" color="#0000ff">
<p>&nbsp;</p>
</font></font></span><font face="Consolas" size="2" color="#0000ff">
<p>&nbsp;</p>
</font></span></p>
<p><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">class</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">MyViewModel</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> : </span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">INotifyPropertyChanged</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">{</span></span></p>
<p><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">&nbsp;&nbsp; public</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">ObservableCollection</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">&lt;</span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">Parent</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">&gt; Items { </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">get</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">; </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">set</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">; } </span></span></p>
<p><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">&nbsp;&nbsp; public</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> </span></span><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;"><span style="font-family:Consolas;color:#2b91af;font-size:x-small;">Parent</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"> CurrentItem { </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">get</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">; </span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">set;</span></span></span><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;">} }</span></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Here is my ListBox declaration (Excluding DataTemplate)</p>
<p>&nbsp;</p>
<p><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><font face="Consolas" size="2" color="#0000ff"><font face="Consolas" size="2" color="#0000ff"><font face="Consolas" size="2" color="#0000ff">
<p>&lt;</p>
</font></font></font></span><font face="Consolas" size="2" color="#0000ff"><font face="Consolas" size="2" color="#0000ff">
<p>&nbsp;</p>
</font></font></span><font face="Consolas" size="2" color="#0000ff">
<p>&nbsp;</p>
</font></span></p>
<p><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;">ListBox</span></span></span><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"> Name</span></span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">=&quot;list&quot;</span></span></span><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"> ItemsSource</span></span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">=&quot;{</span></span></span><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;">Binding</span></span></span><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"> Items</span></span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">}&quot;</span></span></span><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"> SelectedItem</span></span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">=&quot;{</span></span></span><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;"><span style="font-family:Consolas;color:#a31515;font-size:x-small;">Binding</span></span></span><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"> CurrentItem</span></span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">,</span></span></span><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"><span style="font-family:Consolas;color:#ff0000;font-size:x-small;"> Mode</span></span></span><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">=TwoWay}&quot;&gt;</span></span></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>My object model supports a Parent.Children relationship.&nbsp; So, I can call Parent.Children.Add(new Child());</p>
<p>The problem I am having is that when I call Parent.Save(), I need the originally bound object to update to reflect the new item sent back from the server.&nbsp; Failure to do so will cause the newly added child to be inserted whenever the user makes a change to the bound Parent and saves the changes. (because the child.IsNew property will ALWAYS be true)</p>
<p>Manually setting CurrentItem to e.NewObject doesn&#39;t do the trick.&nbsp; Apparently (from my current understanding) a bound ListBox item reference cannot changed or swapped out.&nbsp; What I have found works is the following hack:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; internal void Save(object sender, SavedEventArgs e)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int currentIndex = CurrentItems.IndexOf(CurrentItem);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CurrentItems.Remove(CurrentItem);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CurrentItems.Insert(currentIndex, e.NewObject);<br />&nbsp;&nbsp;&nbsp;&nbsp; // This line alone will not work - it WILL update CurrentItem, but that will leave the bound ListBoxItem pointing to the original object<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CurrentItem = e.NewObject;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>Surely, there must be a better way do this?</p>
<p>Thanks in advance for sharing your thoughts and/or experiences.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AaronH replied on Tuesday, March 30, 2010</h2><p>Ok, so admittedely, I have questioned my own design since I&#39;ve started this approach.&nbsp; My experience with CSLA over the years has been mostly&nbsp;within an ASP.NET context.&nbsp; In an ASP.NET context (let&#39;s exclude Ajax patterns for now), the page was typically rebuilt on post back, relying on business objects that either populated themselves with state from the db&nbsp;on postback, or were stuffed in the session.&nbsp; In either case, the UI was always rebuilt after some user action invoked a postback.</p>
<p>With any SL, WPF, or Win Forms UI, this is obviously not the case.&nbsp; I&#39;m sure I&#39;m killing a dead horse here, so I&#39;m hoping for any links to old conversations on good UI design to accomodate business objects if this is the case.</p>
<p>One thought I had was to have my listbox display records based on ReadOnly objects.&nbsp; This has typically worked well for me from an ASP.NET scenario, Where each item in the listbox contains an edit link/button that when clicked, would present some&nbsp;Add/Edit&nbsp;UI to the user.&nbsp; </p>
<p>What I don&#39;t like about this approach within a thick client context, is that if the user edits a piece of information in the business object (let&#39;s say Person.FirstName), and Person.FirstName is being displayed in a listbox item that is&nbsp;bound to a ReadOnly object, that Person.FirstName won&#39;t be reflected in the listbox item.</p>
<p>So a way around this, of course, is to re-pull the readonly list to reflect any changes that may or may not be displayed in listbox item anyhow.&nbsp; Seems like alot of chattiness to me.&nbsp; In addition, rebuilding the listbox will cause issues, such as losing the spot where the user was when they edited the object.</p>
<p>So that is why I resorted to a list of EditableRoot objects.&nbsp; I would load them all once, and if the user edited one, its changes would be reflected in the bound listbox item as well.</p>
<p>Hopefully this provides some more insight as to my approach.&nbsp; I would really love to hear how some of you have dealt with this challenge.&nbsp; Or maybe I&#39;m not thinking far enough out of the box?</p>
<p>Thanks again!</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, March 30, 2010</h2><p>It almost sounds like the user is editing and saving one item at a time, not editing several items and saving them as a batch?</p>
<p>BLB is designed to support the batch scenario. ERLB is designed to support the one at a time scenario. Maybe you are just using the wrong base type for your list?</p>
<p>Though ERLB must be a root object, it can&#39;t be a child of another object, so if you really do need a parent above the list, then BLB is the only real option.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AaronH replied on Tuesday, March 30, 2010</h2><p>Yes, that&#39;s correct, each object is saved independently of each other.&nbsp; The only reason why I&#39;m using a ERLB is for a transport mechanism.&nbsp; I don&#39;t want to save the BOs via the ERLB because it is to my understanding that the WHOLE ERLB would be sent back if the user edited only one item in the collection.&nbsp; Is this correct?&nbsp; If that&#39;s the case, I want to avoid sending 20 objects (and their children)&nbsp;back to the server just to save one of them.</p>
<p>So what I have is:</p>
<p>ERLB --&gt; Parent Objects (each Parent containing&nbsp;a Children collection).&nbsp; Once the SL client receives the loaded ERLB, the items are copied in the ObservableCollection, and the view is bound to it via the VM.</p>
<p>Who knows, maybe just dealing with sending the entire ERLB is acceptable from a performance standpoint.&nbsp; Admittedely, I haven&#39;t tested to capture the payload size with Fiddler, etc. using the full-blown ERLB approach.&nbsp; Logistically, however, seems like a waste though.</p>
<p>How are other folks handling this design dilemna?</p>
<p>Thanks again!</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, March 30, 2010</h2><p>That&#39;s not correct; a root object in Csla terms means its saved independantly of other objects.&nbsp; So when you leave the row in SL, it should ONLY save that row&#39;s object, not the entire list.&nbsp; You should simply be able to bind the ERLB to your grid and have it work, i would think.&nbsp; That&#39;s how you&#39;d do it in WinForms anyway.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, March 30, 2010</h2><p>Andy is correct. </p>
<p>A BLB saves the list as a batch - the entire list travels to the server, items are saved, and the list returns to the client as a new list.</p>
<p>An ERLB saves one item at a time. That item travels to the server, the item is saved, and the item returns to the client where it replaces the old item in the ERLB. The actual binding source of the list is always the same ERLB instance, but the child item in the list is replaced.</p>
<p>It is possible that the SL data binding doesn&#39;t understand this concept, in a ListBox anyway. I&#39;ve tested and used this technique in the SL datagrid control and it works fine. It doesn&#39;t work in the WPF datagrid control because that control is extremely buggy (or was as of .NET 4 Beta 2 - I haven&#39;t checked the RC).</p>
<p>I would expect the SL data binding to handle this fine though. When the item is replaced in the ERLB, the ERLB raises the appropriate CollectionChanged event to indicate the change. It is just a standard set operation, where an item in the list is set to a new object instance - something that is a native concept in ObservableCollection&lt;T&gt;.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, March 30, 2010</h2><p>There is no such thing as AddNewCore() in SL. We do support the concept in CSLA, but data binding doesn&#39;t know about it. Also, AddNewCore() in SL is async, so it is void, where the .NET implementation returns the new child object.</p>
<p>The reason we put it into the SL codebase is that the pattern is useful, and even if you have to explicitly call AddNew() from your code-behind or viewmodel it is still a really nice way to manage the addition of new items to a list.</p>
<p>Of course, just like on .NET, it is entirely optional.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, March 30, 2010</h2><p>I don&#39;t know if it works <i>automatically</i> with the DataForm.</p>
<p>ERLB triggers off the use of IEditableObject. So if DataForm uses IEO (and I doubt it does) then it would work automatically. If not (which I suspect), then you&#39;ll need to call the IEO methods yourself based on UI events. Just make sure to go through the IEO interface to trigger the behavior.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AaronH replied on Tuesday, March 30, 2010</h2><p>Awesome, thanks for the feedback everyone.&nbsp; I guess I could have checked myself whether it was the case that the entire ERLB was sent back.&nbsp; I was told that it did, so I believed what I heard...</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, March 30, 2010</h2><p>Let&#39;s be very clear on terminology. There&#39;s a difference between the base classes and stereotype names. I&#39;ve been using base classes in this thread.</p>
<p>BLB = BusinessListBase - used for an <em>editable list</em> stereotype</p>
<p>ERLB = EditableRootListBase - used for a <em>dynamic list</em> stereotype</p>
<p>BLB does batch saves of its child objects. ERLB contains <em>root objects</em> and saves them one at a time based on data binding interacting with the child objects through the IEditableObject interface (or your code simulating data binding by using the IEditableObject interface).</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AaronH replied on Wednesday, March 31, 2010</h2><p>Perhaps I should start another thread.&nbsp; If you think I should, let me know.</p>
<p>I&#39;m having 2 issues.&nbsp; This thread began talking about using a iistbox bound to an observableCollection containing EditableRoot objects that I retrieved via an EditableRootList.</p>
<p>So after the question of whether the entire ERLB is sent back to the server or not was cleared up, I now bind the list directly to the ERLB.&nbsp; ONLY, the list i&#39;ve been speaking of is not a list.&nbsp; It is an Accordian control.&nbsp; Why an Accordian control?&nbsp; Because it&#39;s pretty cool, believe it or not.&nbsp; I could have done something similar with expanders, but not quite.&nbsp; I like the fact that the accordian can show only one item at a time.&nbsp; </p>
<p>Anyhow, first issue: unfortunately when adding a new object to the ERLB, the Accordian does not refresh.&nbsp; I tried replacing the Accordian with a listbox, and that DOES work, however.</p>
<p>The second issue is that when I call BeginEdit/ApplyEdit/BeginSave() on any of the objects, it makes 2 calls to the dataportal.&nbsp;&nbsp;So what happens is that either DP.Insert or DP.Update is invoked twice.</p>
<p>Here&#39;s the interesting thing: if I load an individual object via Parent.GetParent(123);, then call BeginEdit/ApplyEdit combo, it does not do this.&nbsp; So I&#39;m wondering if by loading up a EditableRoot into the ERLB, that there is some sort of flag being set by the ERLB that is messing with the internal state of the EditableRoot.&nbsp; REALLY strange.</p>
<p>What&#39;s more strange is that I cannot walk through the CSLA SL&nbsp;code.&nbsp; If I set project references to CSLA projects, it compiles just fine.&nbsp; However, when I go to run, the CSLA barks at me about not being able to find the ClientConfig information.&nbsp; So getting this to work is my top priority for the day, but I cannot walk through the CSLA code to see what&#39;s going on to help me debug my issues.&nbsp; So I guess you could say I&quot;m having 3 issues.</p>
<p>Any thoughts on any of these issues would be most appreciated!</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, March 31, 2010</h2><p><div style='padding-left: 50px;background-color:silver'><b>AaronH<br></b>
<p>The second issue is that when I call BeginEdit/ApplyEdit/BeginSave() on any of the objects, it makes 2 calls to the dataportal.&nbsp;&nbsp;So what happens is that either DP.Insert or DP.Update is invoked twice.</p>
<div style="CLEAR:both;"></div>
</div></p>
<p>This one is easy. ERLB is designed to save the object for you, and that behavior is triggered when you call ApplyEdit() on the object. So your explicit BeginSave() call is redundant and is where the duplicate call occurs.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AaronH replied on Wednesday, March 31, 2010</h2><p>I apologize, I left out a crucial detail from my last post, and it may turn out that i just end up ditching the usage of the Accordian.</p>
<p>So because the Accordian doesn&#39;t reflect the addition of BO&#39;s to a bound ERLB, I instead have an Accordian bound to an ObservableCollection of BO&#39;s.&nbsp; The BO&#39;s are EditableRoots that were loaded from an ERLB.&nbsp;</p>
<p>After the ERLB is returned to the SL client, then the BO&#39;s are copied from the ERLB into the OC at that point.&nbsp; The Accordian does respond to events raised by the OC when adding new items to it, so I&#39;m not sure what events other than INotifyPropertyChanged are being raised by OC that are NOT being raised by ERLB on AddNew.</p>
<p>Anyhow, so when I edit a BO in this scenario, the ERLB is completely out of the picture.&nbsp; So before editing it, I call BeginEdit() and ApplyEdit() after the user clicked &quot;OK&quot; to save their changes.&nbsp; This alone does not invoke a DP.Insert/Update method.&nbsp; Then I invoke BeginSave(), and THEN it makes 2 calls.</p>
<p>So this leads me to believe that ERLB is changing the internal state of the BO when it is being added to it on the server.</p>
<p>Does this make sense?</p>
<p>Man, the things I&#39;m going through in order to get this Accordian to work....</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, March 31, 2010</h2><p>ERLB on Silverlight is an ObservableCollection, so I don&#39;t know why binding to an OC would be any different from binding to an ERLB. </p>
<p>When you call AddNew() on an ERLB, that triggers the AddNewCore() method. In the AddNewCore() method you ultimately call OnCoreAdded() - either synchronously or asynchronously - to get the new item added to the collection.</p>
<p>OnCoreAdded() simply calls Add() to add the item - this Add() method is the ObservableCollection method - no different from calling Add() on any other OC. OnCoreAdded() also raises an AddedNew event for parity with pre-existing CSLA code from other collection types, but that&#39;s not relevant to this particular scenario.</p>
<p>The OC Add() method raises a CollectionChanged event to indicate that a new item was added, and this is what any UI control should be listening for. Obviously ERLB raises that event, because it delegates to its base class to do the add.</p>
<p>The bit about ApplyEdit() doesn&#39;t make sense, unless you are letting the user edit the item before adding it to the ERLB. But if the root object is contained in an ERLB and you call ApplyEdit() such that the edit level goes to 0, that is what triggers ERLB to save the root object.</p>
<p>But the more you describe your scenario, the less I understand why you&#39;d use ERLB at all. You are already manually handling the create/beginedit/applyedit/save operations - so you are already doing everything ERLB would normally do for you, which implies that ERLB is offering essentially zero value.</p>
<p>If the only reason for using ERLB is to get a list of root objects (and not to manage them once they are on the client), then I wouldn&#39;t use ERLB. Instead I think I&#39;d create my own collection using Csla.Core.MobileList&lt;T&gt;. This collection would just have a factory method to get the collection, and would have no provision for saving or managing the items once it returned them to the client.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AaronH replied on Wednesday, March 31, 2010</h2><p>Rocky, that&#39;s exactly right.&nbsp; The ONLY reason at this point for using the ERLB is to bring down my list of editable roots.&nbsp; So other than using it as my transport mechanism to retrieve a list of EditableRoots, it is providing zero value.</p>
<p>Because calling AddNew on the ERLB doesn&#39;t cause a bound Accordian to reflect the newly added item, I introduced the OC as a middle man, because for whatever reason, it is reacting properly to it when invoking OC.Add().&nbsp; When a new EditableRoot is added to the OC, the Accordian updates properly to reflect the new BO.&nbsp; I then at some point invoke BeginSave directly on the new BO, not on any ERLB.</p>
<p>Hopefully this provides you with more insight for my design choice here.</p>
<p>I was not aware of a MobileList.&nbsp; Admittedely, I&#39;ve been out of touch with CSLA for some time as my previous client had me go down the WCF RIA path (nowhere near production&nbsp;ready, imo).&nbsp; But that&#39;s another story :)</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, March 31, 2010</h2><p>MobileList is the base class for all list types in CSLA for Silverlight. It inherits from ObservableCollection and just adds serialization capabilities, so it is the most basic list type that is useful for n-tier development within CSLA.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AaronH replied on Wednesday, March 31, 2010</h2><p>Yeah, I&#39;ve definitely run into a few issues with the control, to be sure.&nbsp; I&#39;m still contemplating abandoning the accordian.&nbsp; We&#39;ll see.&nbsp; But thanks for your thoughts and comments, I really appreciate them.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AaronH replied on Wednesday, March 31, 2010</h2><p>Thanks for all your help, Rocky.&nbsp; Really appreciate it!</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, March 31, 2010</h2><p><div style='padding-left: 50px;background-color:silver'><b>AaronH<br></b>
<p>Anyhow, first issue: unfortunately when adding a new object to the ERLB, the Accordian does not refresh.&nbsp; I tried replacing the Accordian with a listbox, and that DOES work, however.</p>
<div style="CLEAR:both;"></div>
</div></p>
<p>Maybe Accordian has a bug. Keep in mind that the toolkit has various bands of stability, and Accordian is in Preview, which is second from the bottom.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
