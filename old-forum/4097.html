<html><header><title>Need to hide columns in a DevExpress xtraGrid - ver 6.3</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Need to hide columns in a DevExpress xtraGrid - ver 6.3</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4097.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson posted on Friday, December 28, 2007</h2><P>Sure 6.3 is old school - but this is an old VS2003 app using CSLA 1.53.</P>
<P>&nbsp;</P>
<P>I've got a collection (generic) of CSLA Editable root objects that have four collection members.&nbsp; I set the Browseable attribute False wherever I can, but can't find a way to do that for .IsNew, .IsDeleted, and .BrokenRulesString.&nbsp; </P>
<P>So I need to hide these columns after setting my generic collection as the DataSource.&nbsp; The Master/Detail grid is really awesome and it allows all the editing I need.&nbsp; But I really want to hide these silly looking properties.&nbsp; Actually I don't even need them because after any changes made by the user, the object graph is getting written to a csv file - not persisted back to the&nbsp;database from which it was extracted.</P>
<P>I know I want to do something in my Form's load event to iterate the grid's various views (one for master view of the EROs and one each for the four collections) and itereate each's columns collection looking for matches by caption or FieldName and set the visible property to false for them.&nbsp; But I have scoured tutorials and documentation and left msgs on the DevEx forum and am still unable to find the syntax to do this.</P>
<P>I'm trying </P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>With</FONT><FONT size=2> </FONT><FONT color=#808000 size=2>xgrdDisplayData</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;.</FONT><FONT color=#808000 size=2>DataSource</FONT><FONT size=2> = </FONT><FONT color=#808000 size=2>mcolWarrants</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;.</FONT><FONT color=#808000 size=2>Refresh</FONT><FONT size=2>()</P>
<P></FONT><FONT color=#008000 size=2>'TODO: Figure out what class name to use for the Column dude</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;For</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Each</FONT><FONT size=2> </FONT><FONT color=#808000 size=2>oCol</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#808000 size=2>DevExpress</FONT><FONT size=2>.</FONT><FONT color=#808000 size=2>XtraGrid</FONT><FONT size=2>.</FONT><FONT color=#808000 size=2>Columns</FONT><FONT size=2>.</FONT><FONT color=#808000 size=2>GridColumn</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>In</FONT><FONT size=2> </FONT><FONT color=#808000 size=2>xgrdDisplayData</FONT><FONT size=2>.</FONT><FONT color=#808000 size=2>Columns</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If</FONT><FONT size=2> </FONT><FONT color=#808000 size=2>oCol</FONT><FONT size=2>.</FONT><FONT color=#808000 size=2>FieldName</FONT><FONT size=2> = "IsNew" </FONT><FONT color=#808000 size=2>_</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrElse</FONT><FONT size=2> </FONT><FONT color=#808000 size=2>oCol</FONT><FONT size=2>.</FONT><FONT color=#808000 size=2>FieldName</FONT><FONT size=2> = "IsDeleted" </FONT><FONT color=#808000 size=2>_</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OrElse</FONT><FONT size=2> </FONT><FONT color=#808000 size=2>oCol</FONT><FONT size=2>.</FONT><FONT color=#808000 size=2>FieldName</FONT><FONT size=2> = "BrokenRuleString" </FONT><FONT color=#0000ff size=2>Then</P></FONT><FONT size=2>
<P></FONT><FONT color=#808000 size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oCol</FONT><FONT size=2>.</FONT><FONT color=#808000 size=2>Visible</FONT><FONT size=2> = </FONT><FONT color=#0000ff size=2>False</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;Next</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>With</FONT></P>
<P>but, of course, there is no such thing as xgrdDisplayData.Columns (if only it <STRONG>were</STRONG> that easy!!!).</P>
<P>Thanks in advance.<FONT color=#0000ff size=2></P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson replied on Tuesday, January 01, 2008</h2><DIV><FONT face=Fixedsys size=2>I finally found my solution.&nbsp; In case any of you have to do this, I'll offer what I finally found after what I think was WAY too long a time studying the docs.</FONT></DIV>
<DIV><FONT face=Fixedsys size=2></FONT>&nbsp;</DIV>
<DIV><FONT face=Fixedsys size=2>Requirement:</FONT></DIV>
<DIV><FONT face=Fixedsys size=2>-------------</FONT></DIV>
<DIV><FONT face=Fixedsys size=2>I wanted to hide the same three columns (whose names I knew) in both the MasterView and the four detail views related to it.</FONT></DIV>
<DIV><FONT face=Fixedsys size=2></FONT>&nbsp;</DIV>
<DIV><FONT face=Fixedsys size=2>For the MasterView:</FONT></DIV>
<DIV><FONT face=Fixedsys size=2>-------------------</FONT></DIV>
<DIV><FONT face=Fixedsys size=2>When I dropped the grid control on my form, I didn't even notice that DevExpress named the MainView object "GridView1" for me.&nbsp; I spent a lot of wasted time trying to learn the syntax for declaring some object that had the columns collection I wanted and was actually successful with that technique; but it is far easier to just use the one provided (duh) and put code like this in your form's load event:</FONT></DIV>
<DIV><FONT face=Fixedsys size=2></FONT>&nbsp;</DIV>
<DIV>
<P><FONT face=Fixedsys><FONT size=2><FONT color=#0000ff>For</FONT> <FONT color=#0000ff>Each</FONT> <FONT color=#808000>oCol</FONT> <FONT color=#0000ff>As</FONT> <FONT color=#808000>DevExpress</FONT>.<FONT color=#808000>XtraGrid</FONT>.<FONT color=#808000>Columns</FONT>.<FONT color=#808000>GridColumn</FONT> <FONT color=#0000ff>In</FONT> <FONT color=#808000><STRONG><U>GridView1</U></STRONG></FONT>.<FONT color=#808000>Columns</P></FONT></FONT></FONT>
<P><FONT face=Fixedsys><FONT size=2><FONT color=#0000ff>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; If</FONT> <FONT color=#808000>oCol</FONT>.<FONT color=#808000>FieldName</FONT> = "IsNew" <FONT color=#808000>_</P></FONT></FONT></FONT>
<P><FONT face=Fixedsys><FONT size=2><FONT color=#0000ff>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; OrElse</FONT> <FONT color=#808000>oCol</FONT>.<FONT color=#808000>FieldName</FONT> = "IsDeleted" <FONT color=#808000>_</P></FONT></FONT></FONT>
<P><FONT face=Fixedsys><FONT size=2><FONT color=#0000ff>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; OrElse</FONT> <FONT color=#808000>oCol</FONT>.<FONT color=#808000>FieldName</FONT> = "BrokenRulesString" <FONT color=#0000ff>Then</P></FONT></FONT></FONT>
<P><FONT face=Fixedsys><FONT size=2><FONT color=#808000>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; oCol</FONT>.<FONT color=#808000>Visible</FONT> = <FONT color=#0000ff>False</P></FONT></FONT></FONT>
<P><FONT face=Fixedsys><FONT size=2><FONT color=#0000ff>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; End</FONT> <FONT color=#0000ff>If</P></FONT></FONT></FONT>
<P><FONT face=Fixedsys color=#0000ff size=2>Next</FONT></P><FONT face=Fixedsys size=2>
<DIV><FONT face=Fixedsys size=2>I knew it would be simple once I discovered syntax for that object with the columns collection.&nbsp; But this is REALLY simple, eh?&nbsp; A little more work was required for the detail views.</FONT></DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp;</DIV>
<DIV><FONT face=Fixedsys size=2>For the DetailViews:</FONT></DIV>
<DIV><FONT face=Fixedsys size=2>--------------------</FONT></DIV>
<DIV><FONT face=Fixedsys size=2>My study of the docs taught me that there is a PatternView that is a Template for the detail view that will be shown when the user expands the MasterRow and causes a particular Detail View to be shown.&nbsp; That detail view is just a very temporary CLONE of the PatternView that will disappear when the MasterRow is collapsed.&nbsp; So to make my columns invisible, I just needed to trap the event that shows the Detail view and place my code there.&nbsp; The choice of event is important.&nbsp; In fact, so is the control.&nbsp; We need the event on the VIEW, so I had to look at GridView1.&nbsp; Yours will vary by how you name it, of course.&nbsp; There are two that look appealing on the GridView's list: MasterRowExpandING and MasterRowExpandED (caps for emphasis are mine, of course).&nbsp; It turned out that MasterRowExpandING was too soon; the Detail View wasn't available yet via the GetDetailView method.&nbsp; But the MasterRowExpandED was perfect.&nbsp; Here's all the code I needed there:&nbsp; </FONT></DIV>
<DIV><FONT face=Fixedsys></FONT>&nbsp;</DIV>
<DIV><FONT face=Fixedsys><FONT size=1><FONT color=#0000ff><FONT color=#0000ff size=2>
<P>Private</FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT color=#000000 size=2> </FONT><FONT color=#808000 size=2>GridView1_MasterRowExpanded</FONT><FONT color=#000000 size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT color=#000000 size=2> </FONT><FONT color=#808000 size=2>sender</FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2>As</FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT color=#000000 size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT color=#000000 size=2> </FONT><FONT color=#808000 size=2>e</FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2>As</FONT><FONT color=#000000 size=2> </FONT><FONT color=#808000 size=2>DevExpress</FONT><FONT color=#000000 size=2>.</FONT><FONT color=#808000 size=2>XtraGrid</FONT><FONT color=#000000 size=2>.</FONT><FONT color=#808000 size=2>Views</FONT><FONT color=#000000 size=2>.</FONT><FONT color=#808000 size=2>Grid</FONT><FONT color=#000000 size=2>.</FONT><FONT color=#808000 size=2>CustomMasterRowEventArgs</FONT><FONT color=#000000 size=2>) </FONT><FONT color=#0000ff size=2>Handles</FONT><FONT color=#000000 size=2> </FONT><FONT color=#808000 size=2>GridView1</FONT><FONT color=#000000 size=2>.</FONT><FONT color=#808000 size=2>MasterRowExpanded</P>
<P></FONT>Dim</FONT> <FONT color=#808000>oPatternView</FONT> <FONT color=#0000ff>As</FONT> <FONT color=#808000>DevExpress</FONT>.<FONT color=#808000>XtraGrid</FONT>.<FONT color=#808000>Views</FONT>.<FONT color=#808000>Grid</FONT>.<FONT color=#808000>GridView</P></FONT></FONT>
<P><FONT size=1><FONT color=#808000>oPatternView</FONT> = </FONT><FONT size=1><FONT color=#0000ff>CType</FONT>(<FONT color=#808000>GridView1</FONT>.<FONT color=#808000>GetDetailView</FONT>(<FONT color=#808000>e</FONT>.<FONT color=#808000>RowHandle</FONT>, <FONT color=#808000>_ e</FONT>.<FONT color=#808000>RelationIndex</FONT>),&nbsp;</FONT><FONT size=1><FONT color=#808000>DevExpress</FONT>.<FONT color=#808000>XtraGrid</FONT>.<FONT color=#808000>Views</FONT>.<FONT color=#808000>Grid</FONT>.<FONT color=#808000>GridView</FONT>)</FONT></P>
<P><FONT size=1><FONT color=#0000ff>For</FONT> <FONT color=#0000ff>Each</FONT> <FONT color=#808000>oCol</FONT> <FONT color=#0000ff>As</FONT> <FONT color=#808000>DevExpress</FONT>.<FONT color=#808000>XtraGrid</FONT>.<FONT color=#808000>Columns</FONT>.<FONT color=#808000>GridColumn</FONT> <FONT color=#0000ff>In</FONT> <FONT color=#808000>_ oPatternView</FONT>.<FONT color=#808000>Columns</P></FONT></FONT>
<P><FONT size=1><FONT color=#0000ff>&nbsp;&nbsp;&nbsp; If</FONT> <FONT color=#808000>oCol</FONT>.<FONT color=#808000>FieldName</FONT> = "IsNew" <FONT color=#808000>_</P></FONT></FONT>
<P><FONT size=1><FONT color=#0000ff>&nbsp;&nbsp;&nbsp; OrElse</FONT> <FONT color=#808000>oCol</FONT>.<FONT color=#808000>FieldName</FONT> = "IsDeleted" <FONT color=#808000>_</P></FONT></FONT>
<P><FONT size=1><FONT color=#0000ff>&nbsp;&nbsp;&nbsp; OrElse</FONT> <FONT color=#808000>oCol</FONT>.<FONT color=#808000>FieldName</FONT> = "BrokenRulesString" <FONT color=#0000ff>Then</P></FONT></FONT>
<P><FONT size=1><FONT color=#808000>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; oCol</FONT>.<FONT color=#808000>Visible</FONT> = <FONT color=#0000ff>False</P></FONT></FONT>
<P><FONT size=1><FONT color=#0000ff>&nbsp;&nbsp;&nbsp; End</FONT> <FONT color=#0000ff>If</P></FONT></FONT>
<P><FONT color=#0000ff><FONT size=1>Next</FONT></P></FONT>
<P><FONT size=1><FONT color=#808000>oPatternView</FONT> = <FONT color=#0000ff>Nothing</FONT></FONT></P>
<P><FONT color=#0000ff size=1>End Sub</FONT></FONT></P></DIV>
<DIV><FONT face=Fixedsys size=2></FONT>&nbsp;</DIV>
<DIV><FONT face=Fixedsys size=2>Note how friendly the event arguments are: e.RowHandle and e.RelationIndex were exactly what I needed to get my detail view.&nbsp; In my case, I was making exactly the same changes to columns of the same name in each detail view.&nbsp; I think this is probably an unusual case and you are likely to want to look at the value for e.RelationIndex (or otherwise determine which DetailView has come into view to fire this event) so that you'll know what changes need to be made.</FONT></DIV>
<DIV>&nbsp;</DIV>
<DIV>Best of all, in my quick look into the 7.3 docs, it looks as if the same object model is used, so this information should be useful to anyone who wrestles with this issue there, too.</DIV>
<DIV>&nbsp;</DIV>
<DIV>Once you know the syntax, it's really quite impressive what you can do with just a little code with this control - even in the bad old days of .NET 1.1, eh?</DIV>
<DIV>&nbsp;</DIV>
<DIV>Happy New Year!</FONT><FONT color=#0000ff size=2></DIV></FONT></DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>malkav replied on Thursday, April 01, 2010</h2><p>Thank you so much! i was trapped in the same problem for 2 days!!</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
