<html><header><title>A couple of questions and thoughts...</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>A couple of questions and thoughts...</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2201.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>fretje posted on Tuesday, January 23, 2007</h2><P>I Can't believe I'm actually the first one posting in this forum :-D</P>
<P>I am trying out the latest codesmith templates on codesmith 2.8 and I'm confused about something.</P>
<P>If I generate an EditableRootList (CurrencyList)&nbsp;with an EditableChild (Currency), the generated code doesn't compile, because the CurrencyList calls child.Update(cn) while the Currency object has only an Update(SqlConnection cn, CurrencyList parent) method. The CurrencyList should call child.Update(cn, this).</P>
<P>So I figured out... maybe I should use an EditableSwitchable in combination with an EditableRootList... This turns out to compile fine, but now there's another problem:<BR>The CurrencyList has an override for AddNewCore in which it adds an Currency.NewCurrency(), but in this case it should call Currency.NewCurrencyChild().</P>
<P>Have I discovered a bug, or am I missing something?</P>
<P>On a sidenote: How are most of you people using these templates? I would like to have all my objects generated with partial split classes, but I haven't figured out a way to easily re-generate the code-behind files after a database-change.<BR>At this time I'm re-entering all the properties for the template and then cut and paste the code.<BR>In&nbsp;a next step I guess I would create the property set xml-file for each object and then create a batch file which calls codesmith with the xml-file as a parameter for each object.<BR>This seems like a tedious task which can be automated further.</P>
<P>Now I'm mabye dreaming: wouldn't it be possible te generate the property-set into the&nbsp;generated file (in the comment-header or something), then it would be maybe possible with a visual studio extention to right-click on the Currency.designer.cs code-behind file and select "Re-Generate". This would be really nice ;-)</P>
<P>Maybe this is something to start in a new cslacontrib project...</P>
<P>Any Hints, comments, ... feel free!</P>
<P>Greetings,</P>
<P>fretje</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fretje replied on Wednesday, January 31, 2007</h2><P>105 views... seems like a lot of *silent* public...</P>
<P>I've been looking through some more documentation lately, and I found out about the cslaxml feature. I created an xml file for my 2 objects Currency and CurrencyList:</P><FONT color=#0000ff size=2>
<P><FONT face="Courier New">&lt;?</FONT></FONT><FONT face="Courier New"><FONT color=#800000 size=2>xml</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>version</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>1.0</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>encoding</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>UTF-8</FONT><FONT size=2>"</FONT></FONT><FONT color=#0000ff size=2><FONT face="Courier New">?&gt;<BR></FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT color=#800000 size=2>CslaProject</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>xmlns:xsi</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>http://www.w3.org/2001/XMLSchema-instance</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>xsi:noNamespaceSchemaLocation</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>CslaProject.xsd</FONT><FONT size=2>"</FONT></FONT><FONT color=#0000ff size=2><FONT face="Courier New">&gt;<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&lt;</FONT></FONT><FONT face="Courier New"><FONT color=#800000 size=2>ProjectName</FONT><FONT color=#0000ff size=2>&gt;</FONT><FONT size=2>Business.Base</FONT><FONT color=#0000ff size=2>&lt;/</FONT><FONT color=#800000 size=2>ProjectName</FONT></FONT><FONT color=#0000ff size=2><FONT face="Courier New">&gt;<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&lt;</FONT></FONT><FONT face="Courier New"><FONT color=#800000 size=2>GenerationMethod</FONT><FONT color=#0000ff size=2>&gt;</FONT><FONT size=2>SplitPartial</FONT><FONT color=#0000ff size=2>&lt;/</FONT><FONT color=#800000 size=2>GenerationMethod</FONT></FONT><FONT color=#0000ff size=2><FONT face="Courier New">&gt;<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&lt;</FONT></FONT><FONT face="Courier New" color=#800000 size=2>Objects</FONT><FONT color=#0000ff size=2><FONT face="Courier New">&gt;<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</FONT></FONT><FONT face="Courier New"><FONT color=#800000 size=2>Object</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Name</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>CurrencyList</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Namespace</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>Business.Base</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Type</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>EditableRootList</FONT><FONT size=2>"</FONT></FONT><FONT color=#0000ff size=2><FONT face="Courier New">&gt;<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</FONT></FONT><FONT face="Courier New"><FONT color=#800000 size=2>Relationship</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Child</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>Currency</FONT><FONT size=2>"</FONT></FONT><FONT color=#0000ff size=2><FONT face="Courier New"> /&gt;<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</FONT></FONT><FONT face="Courier New" color=#800000 size=2>Object</FONT><FONT color=#0000ff size=2><FONT face="Courier New">&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New"><FONT color=#800000 size=2>Object</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Name</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>Currency</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Namespace</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>Business.Base</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Type</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>EditableChild</FONT><FONT size=2>"</FONT></FONT><FONT color=#0000ff size=2><FONT face="Courier New">&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT face="Courier New">&lt;</FONT></FONT><FONT face="Courier New" color=#800000 size=2>Properties</FONT><FONT color=#0000ff size=2><FONT face="Courier New">&gt;<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</FONT></FONT><FONT face="Courier New"><FONT color=#800000 size=2>Property</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Name</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>Id</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Type</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>DbColumnName</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>Id</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>IsIdentity</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>IsPrimaryKey</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>"</FONT></FONT><FONT color=#0000ff size=2><FONT face="Courier New"> /&gt;<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</FONT></FONT><FONT face="Courier New"><FONT color=#800000 size=2>Property</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Name</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>Description</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Type</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>DbColumnName</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>Description</FONT><FONT size=2>" <FONT color=#0000ff>/</FONT></FONT></FONT><FONT color=#0000ff><FONT size=2><FONT face="Courier New">&gt;<BR></FONT></FONT></FONT><FONT color=#0000ff size=2><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</FONT></FONT><FONT face="Courier New"><FONT color=#800000 size=2>Property</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Name</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>Code</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Type</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>DbColumnName</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>Code</FONT><FONT size=2>"<FONT color=#0000ff>/</FONT></FONT></FONT><FONT color=#0000ff><FONT size=2><FONT face="Courier New">&gt;<BR></FONT></FONT><FONT size=2><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;</FONT></FONT></FONT><FONT face="Courier New"><FONT color=#800000 size=2>Property</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Name</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>Rate</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>Type</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>decimal</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>DbColumnName</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>Rate</FONT><FONT size=2>"</FONT></FONT><FONT color=#0000ff size=2><FONT face="Courier New">/&gt;<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</FONT></FONT><FONT face="Courier New" color=#800000 size=2>Properties</FONT><FONT color=#0000ff size=2><FONT face="Courier New">&gt;<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--</FONT></FONT><FONT face="Courier New" color=#008000 size=2>&lt;Relationship Parent="CurrencyList" /&gt;</FONT><FONT color=#0000ff size=2><FONT face="Courier New">--&gt;<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/</FONT></FONT><FONT face="Courier New" color=#800000 size=2>Object</FONT><FONT color=#0000ff size=2><FONT face="Courier New">&gt;<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&lt;/</FONT></FONT><FONT face="Courier New" color=#800000 size=2>Objects</FONT><FONT color=#0000ff size=2><FONT face="Courier New">&gt;<BR></FONT><FONT face="Courier New">&lt;/</FONT></FONT><FONT face="Courier New"><FONT color=#800000 size=2>CslaProject</FONT><FONT color=#0000ff size=2>&gt;</P></FONT></FONT>
<P>And well... It Works... if i don't put&nbsp;the Relationship tag in the Currency object. </P>
<P>If I do put it in, the Currency object gets created with the Insert and Update functions asking for a parent object reference, while the CurrencyList object always calls the Insert and the Update functions on the Currency object without passing a reference to itself. Same problem like before...</P>
<P>At least I can solve it now with commenting out the Relationship tag, but I think the CurrencyList object should call the insert and update functions passing a reference to itself. Why is it actually that it doesn't do that?</P>
<P>Concerning the automation in visual studio: I also found out about the "Custom Tool" functionality of visual studio, and the built-in Custom Tool of CodeSmith. But till this moment, I stil haven't found a practical use for it in combination with the&nbsp;csla templates. If someone has, I would really like to hear about it!</P>
<P>For now, I add an "objects.xml"-file to my project, and I created an "External tool" which calls the codesmithconsole with the cslaxml template and a generic property file (the current directory is configured as the project directory in the external tool):</P><FONT color=#0000ff size=2>
<P>&lt;</FONT><FONT color=#800000 size=2>propertySet</FONT><FONT color=#0000ff size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&lt;</FONT><FONT color=#800000 size=2>property</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>name</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>XmlFileName</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>&gt;</FONT><FONT size=2>Objects.xml</FONT><FONT color=#0000ff size=2>&lt;/</FONT><FONT color=#800000 size=2>property</FONT><FONT color=#0000ff size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&lt;</FONT><FONT color=#800000 size=2>property</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>name</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>OutputDirectory</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>&gt;</FONT><FONT size=2>.</FONT><FONT color=#0000ff size=2>&lt;/</FONT><FONT color=#800000 size=2>property</FONT><FONT color=#0000ff size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&lt;</FONT><FONT color=#800000 size=2>property</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>name</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>OutputToFile</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>&gt;</FONT><FONT size=2>True</FONT><FONT color=#0000ff size=2>&lt;/</FONT><FONT color=#800000 size=2>property</FONT><FONT color=#0000ff size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&lt;</FONT><FONT color=#800000 size=2>property</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>name</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>Generate</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>&gt;</FONT><FONT size=2>GeneratedClass</FONT><FONT color=#0000ff size=2>&lt;/</FONT><FONT color=#800000 size=2>property</FONT><FONT color=#0000ff size=2>&gt;<BR>&nbsp;&nbsp;&nbsp;&lt;</FONT><FONT color=#800000 size=2>property</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>name</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>OverrideIfExist</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>&gt;</FONT><FONT size=2>True</FONT><FONT color=#0000ff size=2>&lt;/</FONT><FONT color=#800000 size=2>property</FONT><FONT color=#0000ff size=2>&gt;<BR>&lt;/</FONT><FONT color=#800000 size=2>propertySet</FONT><FONT color=#0000ff size=2>&gt;</P></FONT>
<P>I also assigned a shortcut to the external tool. This way, I can easily re-generate the files. </P>
<P>I'm still not happy with this solution though... no easy way of adding a new object (how to generate the user-files the first time?)... the generated files aren't "collapsable" under the user file (anybody knows how to accomplish that?), ...</P>
<P>It would be really nice to have a custom tool specialized for the cslaxml template. One would then be able to apply that custom tool to the "objects.xml"-file, so that the generated files are collapsable under the "objects.xml"-file and so that they are automatically regenerated, when this file changes. The only thing missing then, would be a visual designer for the objects.xml file :-D<BR>This wouldn't be a solution for the user-files though :-S </P>
<P>I've been looking through some documentation about creating a Custom Tool, but it seems quite difficult: a Custom tool natively only generates one file and you have to provide it as a byte-array.&nbsp;The closest I found on the net was this:</P>
<P><A href="http://www.codeproject.com/useritems/VsMultipleFileGenerator.asp">http://www.codeproject.com/useritems/VsMultipleFileGenerator.asp</A></P>
<P>but it isn't really usable with the cslaxml template...</P>
<P>Thanks for any response!</P>
<P>Greetings,</P>
<P>fretje</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
