<html><header><title>Keep User Entered Data on Failed Save</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Keep User Entered Data on Failed Save</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2949.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeCourtney posted on Monday, May 28, 2007</h2><P>I'm new to CSLA 2.1 and ASP.NET, so I have been use ProjectTracker (PTWeb)&nbsp;as a guide for my application's ASP.NET&nbsp;functionallity.&nbsp; (Taking ResourceEdit for example:)&nbsp; I notice when an existing&nbsp;Resource is <STRONG>updated</STRONG> and rules are broken then the ResourceEdit page keeps the changes made by the user&nbsp;in the TextBoxes.&nbsp; However, when a <STRONG>new</STRONG> Resource is being added and rules are broken, then TextBox information is cleared in all TextBoxes.&nbsp; I wish to keep the entered information on an insert (new Resource) eventhough it breaks rules.</P>
<P>For the life of me, I have not been able to figure out why the data is not kept in the TextBoxes in this situation.&nbsp;&nbsp;At first, I thought it might be in the SaveResource section and the currentObject, but it seems to be something on the ProjectEdit.aspx form that is different on the post between Update and Insert.</P>
<P>Can anyone point me in the right direction for desired functionallity?</P>
<P>Thanks.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, May 29, 2007</h2><P>This is due to the way the DetailView control works. It handles update and insert operations very differently, and (imo) Microsoft did a terrible job of supporting the insert scenario. They simply didn't provide a good way to provide default values for new items.</P>
<P>I thought I had code in both ProjectEdit and ResourceEdit to address this, but maybe I only added the code to ProjectEdit.</P>
<P>In any case, there was a thread on here a long time ago about this issue - of getting default values into DetailView for an insert. The solution I put into ProjectEdit is not pretty, but it does work...</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeCourtney replied on Thursday, May 31, 2007</h2><P>Thanks Rocky, Project does retain the entered information...&nbsp; The thread at <A HREF="/forums/permalink/3684/2539/ShowThread.aspx#2539">http://forums.lhotka.net/forums/permalink/3684/2539/ShowThread.aspx#2539</A>&nbsp;helped me out.</P>
<P>All I had to do was add e.KeepInInsertMode = true to the DetailsView_ItemInserted event:</P><FONT size=2>
<P><FONT face="Courier New">protected void DetailsView1_ItemInserted(object sender, DetailsViewInsertedEventArgs e)<BR>{<BR>&nbsp;City city = GetCity();<BR>&nbsp;if (!city.IsNew)<BR>&nbsp;{<BR>&nbsp;&nbsp;Response.Redirect("CityEdit.aspx?id=" + city.Id.ToString());<BR>&nbsp;}<BR>&nbsp;else<BR>&nbsp;{<BR>&nbsp;&nbsp;e.KeepInInsertMode = true;<BR>&nbsp;}<BR>}</FONT></FONT><FONT size=2></P></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
