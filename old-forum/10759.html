<html><header><title>Map complex CSLA BO to Entity Framework with eager loading</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Map complex CSLA BO to Entity Framework with eager loading</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10759.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>BGrojer posted on Monday, October 10, 2011</h2><p>Hi,<br /><br />MyObjectFactory calls a EntityFramework (EF) DAL and load a Entity with several childs. The ObjectFactory maps the result to a CSLA BusinessObject.<br />The child entities are already loaded with a .Include(...) in the same&nbsp;EF query and there is no need to call the database again. How should no&nbsp;map the&nbsp;child-entites to child CSLA child business objects?<br />Should I define another&nbsp;ObjectFactory for the childs and define a GetChildList method that takes a EF Object List as a argument to avoid another call to the database?<br /><br />Thanks,<br />Bernhard</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, October 11, 2011</h2><p>My personal preference is to map BO and ObjectFactory 1:1. </p>
<p>So I would create a </p>
<ul>
<li>new ObjectFactory for the child list and </li>
<li>new ObjectFactory for the child object to map values into BO. </li>
</ul>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>BGrojer replied on Tuesday, October 11, 2011</h2><p>Thank you for your feedback.<br /><br />Does this mean u recommend this:<br /><br />public class MainBOObjectFactory<br />{<br />public MainBO Fetch(int id)<br />{<br />&nbsp;var query = from c in ctx.Products.Include(&quot;Orders&quot;) select c;<br />var result = query.First();<br />&nbsp;var childs = new ChildBOObjectFactory().FetchList(result.Orders);<br /><br />LoadProperty(... properties ...);<br />LoadProperty(... childList&nbsp;...);<br />}<br />}<br /><br />public class ChildBOObjectFactory<br />{<br />public ChildBOList FetchList(IEnumerable&lt;Order&gt; orders)<br />{<br />&nbsp;//for each: map an order to a childBo<br />//return ChildBoList<br />}<br />}</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
