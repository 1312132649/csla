<html><header><title>Declaring variables of generic types</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Declaring variables of generic types</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3368.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Hiren posted on Monday, August 13, 2007</h2><P>Hi,</P>
<P>My projects requires that the UI have a class called 'ApplicationFolder' as a base class which can be used to subclass various other ApplicationFolders such as ContactsFolder, SuppliersFolder etc.</P>
<P>Now my problem is that the ApplicationFolder base class has to have a property called 'Datasource' which exposes a 'ReadOnlyListBase' type of an object. So the subclasses ContactsFolder, SuppliersFolder will have ContactsList, SuppliersList as the corresponding datasources.</P>
<P>How can I define a variable in my 'ApplicationFolder' base class which is of type ReadOnlyBaseList&lt;T&gt; where T is of type ReadOnlyBase?</P>
<P>Thanks in advance for the tips,</P>
<P>Hiren</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Monday, August 13, 2007</h2><P><FONT size=2>Here is one idea:</FONT></P>
<P><FONT color=#0000ff><FONT size=2>Protected<FONT color=#000000> mReadOnlyList </FONT><FONT color=#0000ff>As</FONT></FONT><FONT color=#000000 size=2> IReadOnlyCollection<BR></FONT></FONT><FONT size=2><FONT color=#0000ff>Protected</FONT> mReadOnlyBO <FONT color=#0000ff>As</FONT> IReadOnlyObject</FONT></P>
<P><FONT size=2><FONT color=#0000ff>Public</FONT> <FONT color=#0000ff>Overridable</FONT> <FONT color=#0000ff>Function</FONT> GetReadOnlyBO() <FONT color=#0000ff>As</FONT> IReadOnlyObject<BR>&nbsp;&nbsp;<FONT color=#0000ff>Dim</FONT> mRO <FONT color=#0000ff>As</FONT> SomeBaseRO<BR>&nbsp; mRO = SomeBaseRO.NewSomeBaseRO<BR>&nbsp; 'set some properties here<BR>&nbsp; <FONT color=#0000ff>Return</FONT> mRO <BR><FONT color=#0000ff>End</FONT> <FONT color=#0000ff>Function</P></FONT></FONT>
<P><FONT size=2><FONT color=#0000ff>Public</FONT> <FONT color=#0000ff>Overridable</FONT> <FONT color=#0000ff>Function</FONT> GetROC() <FONT color=#0000ff>As</FONT> IReadOnlyCollection<BR>&nbsp; <FONT color=#0000ff>Return</FONT> </FONT><FONT size=2><FONT color=#0000ff>Nothing<BR></FONT><FONT color=#0000ff>End</FONT> </FONT><FONT color=#0000ff><FONT size=2>Function</FONT></P>
<P><FONT size=2>=================================================================================</FONT></P>
<P><FONT color=#000000 size=2>In the subclasses you can override either method and do things like:</FONT></P><FONT color=#000000>
<P><FONT size=2><FONT color=#0000ff>Public</FONT> <FONT color=#0000ff>Overrides</FONT> <FONT color=#0000ff>Function</FONT> GetROC() <FONT color=#0000ff>As</FONT> IReadOnlyCollection<BR>&nbsp; <FONT color=#0000ff>Return</FONT> SomeRealROC.GetSomeRealROC("", <FONT color=#0000ff>Me</FONT>.ID)<BR><FONT color=#0000ff>End</FONT> <FONT color=#0000ff>Function</P></FONT></FONT></FONT>
<P><FONT color=#000000 size=2>You can also&nbsp;add other propeties and methods to a subclass of the IReadOnlyCollection Interface and then attempt to use this new subclass of the collection interface&nbsp;in your base class. Save you from coding things in each concrete class. You can always cast the interface to the actual concrete type too.</FONT></P>
<P><FONT color=#000000 size=2>Joe</FONT></P>
<P></FONT><BR><FONT size=2>&nbsp;</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Hiren replied on Monday, August 13, 2007</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>JoeFallon1:</strong></div><div> 
<P><FONT size=2>Here is one idea:</FONT></P>
<P><FONT color=#0000ff><FONT size=2>Protected<FONT color=#000000> mReadOnlyList </FONT><FONT color=#0000ff>As</FONT></FONT><FONT color=#000000 size=2> IReadOnlyCollection<BR></FONT></FONT><FONT size=2><FONT color=#0000ff>Protected</FONT> mReadOnlyBO <FONT color=#0000ff>As</FONT> IReadOnlyObject</FONT></P>
<P><FONT size=2><FONT color=#0000ff>Public</FONT> <FONT color=#0000ff>Overridable</FONT> <FONT color=#0000ff>Function</FONT> GetReadOnlyBO() <FONT color=#0000ff>As</FONT> IReadOnlyObject<BR>&nbsp;&nbsp;<FONT color=#0000ff>Dim</FONT> mRO <FONT color=#0000ff>As</FONT> SomeBaseRO<BR>&nbsp; mRO = SomeBaseRO.NewSomeBaseRO<BR>&nbsp; 'set some properties here<BR>&nbsp; <FONT color=#0000ff>Return</FONT> mRO <BR><FONT color=#0000ff>End</FONT> <FONT color=#0000ff>Function</P></FONT></FONT>
<P><FONT size=2><FONT color=#0000ff>Public</FONT> <FONT color=#0000ff>Overridable</FONT> <FONT color=#0000ff>Function</FONT> GetROC() <FONT color=#0000ff>As</FONT> IReadOnlyCollection<BR>&nbsp; <FONT color=#0000ff>Return</FONT> </FONT><FONT size=2><FONT color=#0000ff>Nothing<BR></FONT><FONT color=#0000ff>End</FONT> </FONT><FONT color=#0000ff><FONT size=2>Function</FONT></P>
<P><FONT size=2>=================================================================================</FONT></P>
<P><FONT color=#000000 size=2>In the subclasses you can override either method and do things like:</FONT></P><FONT color=#000000>
<P><FONT size=2><FONT color=#0000ff>Public</FONT> <FONT color=#0000ff>Overrides</FONT> <FONT color=#0000ff>Function</FONT> GetROC() <FONT color=#0000ff>As</FONT> IReadOnlyCollection<BR>&nbsp; <FONT color=#0000ff>Return</FONT> SomeRealROC.GetSomeRealROC("", <FONT color=#0000ff>Me</FONT>.ID)<BR><FONT color=#0000ff>End</FONT> <FONT color=#0000ff>Function</P></FONT></FONT></FONT>
<P><FONT color=#000000 size=2>You can also&nbsp;add other propeties and methods to a subclass of the IReadOnlyCollection Interface and then attempt to use this new subclass of the collection interface&nbsp;in your base class. Save you from coding things in each concrete class. You can always cast the interface to the actual concrete type too.</FONT></P>
<P><FONT color=#000000 size=2>Joe</FONT></P>
<P></FONT><BR><FONT size=2>&nbsp;</FONT></P>
<P></div></BLOCKQUOTE></P>
<P>Thanks for the tip Joe, but my problem is as follows:</P>
<P>I've extend Rocky's base classe 'ReadOnlyListBase' as follows:</P><FONT color=#0000ff size=2>
<P>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>abstract</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>class</FONT><FONT size=2> <FONT><FONT color=#008080 size=2>My</FONT></FONT></FONT><FONT color=#008080 size=2>ReadOnlyListBase</FONT><FONT size=2>&lt;T, C&gt; : Csla.</FONT><FONT color=#008080 size=2>ReadOnlyListBase</FONT><FONT size=2>&lt;T, C&gt;<BR></FONT><FONT color=#0000ff size=2>where</FONT><FONT size=2> T : Csla.</FONT><FONT color=#008080 size=2>ReadOnlyListBase</FONT><FONT size=2>&lt;T, C&gt;<BR></FONT><FONT color=#0000ff size=2>where</FONT><FONT size=2> C : Csla.</FONT><FONT color=#008080 size=2>ReadOnlyBase</FONT><FONT size=2>&lt;C&gt;<BR>{<BR></FONT><FONT size=2><FONT size=2></FONT><FONT color=#0000ff size=2>protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>abstract</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> Refresh();</FONT><BR>}</FONT></P>
<P><FONT size=2>So, all my ReadOnlyListBase classes should override the 'Refresh' method. Having done that,</FONT></P>
<P><FONT size=2>in my ApplicationFolder class, I now want to have the ability to define a member variable as such:</FONT></P>
<P><FONT size=2>private MyReadOnlyListBase _datasource;</FONT></P>
<P><FONT size=2>public void Refresh(){<BR>&nbsp;&nbsp;&nbsp;_dataSource.Refresh();<BR></FONT><FONT size=2>}</FONT></P>
<P><FONT size=2>I can't somehow determine how to be able to declare a variable of type 'MyReadOnlyListBase', given that I don't know the types for T and C.</FONT></P>
<P><FONT size=2>I hope I'm making myself understood in this case.</FONT></P>
<P><FONT size=2>Thanks,</FONT></P>
<P><FONT size=2>Hiren</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>McManus replied on Monday, August 13, 2007</h2><P><FONT face=Verdana size=2>Hiren,</FONT></P>
<P><FONT face=Verdana size=2>You can't have polymorphism when using a generic base class. However, you can define an interface (for instance IRefresh) that has one method: </FONT></P>
<P><FONT face="Courier New" color=#000000 size=2>public interface IRefresh<BR></FONT><FONT face="Courier New" color=#000000 size=2>{<BR>&nbsp;&nbsp;&nbsp;void Refresh();</FONT><FONT face="Courier New"><BR></FONT><FONT face="Courier New" color=#000000 size=2>}</FONT></P>
<P><FONT face=Verdana color=#000000 size=2>Then implement this interface in your base class (make sure that T must inherit from MyReadOnlyListBase&lt;T,C&gt; instead of Csla.ReadOnlyListBase&lt;T,C&gt;):</FONT></P>
<P><FONT face="Courier New"><FONT size=2>public <FONT color=#0000ff>abstract</FONT> <FONT color=#0000ff>class</FONT> <FONT color=#008080>My</FONT><FONT color=#008080>ReadOnlyListBase</FONT>&lt;T, C&gt; : Csla.<FONT color=#008080>ReadOnlyListBase</FONT></FONT></FONT><FONT face="Courier New"><FONT size=2>&lt;T, C&gt;, <FONT color=#000000>IRefresh</FONT><BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;where</FONT> T : <FONT color=#008080>MyReadOnlyListBase</FONT></FONT></FONT><FONT face="Courier New"><FONT size=2>&lt;T, C&gt;<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;where</FONT> C : Csla.<FONT color=#008080>ReadOnlyBase</FONT></FONT></FONT><FONT face="Courier New" size=2>&lt;C&gt;<BR>{<BR></FONT><FONT face="Courier New"><FONT size=2><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;protected</FONT> <FONT color=#0000ff>abstract</FONT> <FONT color=#0000ff>void</FONT> Refresh();</FONT></FONT></P>
<P><FONT face="Courier New"><FONT size=2>&nbsp;&nbsp;&nbsp;void IRefresh.Refresh()<BR>&nbsp;&nbsp;&nbsp;{<BR></FONT></FONT><FONT face="Courier New"><FONT size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.Refresh();<BR>&nbsp;&nbsp;&nbsp;}<BR>}</FONT></FONT></P>
<P><FONT face=Verdana size=2>Now you can have the following code in your ApplicationFolder class:</FONT></P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp;private IRefresh _dataSource;</FONT></P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp;public void Refresh()<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_dataSource.Refresh();<BR>&nbsp;&nbsp;&nbsp;}</FONT></P>
<P><FONT face=Verdana size=2>Cheers,<BR>Herman</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Monday, August 13, 2007</h2><P>Thanks Herman.</P>
<P>You gave him the code sample that I was describing in my rambling post.</P>
<P>I suggested extending the Interface and adding whatever methods he needs.</P>
<P>But it is much clearer in your post.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Hiren replied on Wednesday, August 15, 2007</h2><P>Thanks, that makes it clear!!</P>
<P>Herman &amp; Joe, thanks a ton for your time and inputs!</P>
<P>Cheers,</P>
<P>Hiren</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
