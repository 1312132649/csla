<html><header><title>Is Exists &quot;the&quot; Model?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Is Exists &quot;the&quot; Model?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4407.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>gb1 posted on Monday, February 25, 2008</h2><P><FONT face=Arial size=2>Hi,</FONT></P>
<P><FONT face=Arial size=2>Very new to the framework. Still grappeling with it. </FONT><FONT face=Arial size=2>In a web application, I have a need for a class the doesn't necessarily have any properites but possibly just some static methods&nbsp;that perform its business logic.</FONT></P>
<P><FONT face=Arial size=2>Something like:</FONT></P><FONT face="Courier New" size=2>public class Something<BR>{<BR>&nbsp;&nbsp;&nbsp;public static void DoSomething1(int idToActUpon, int number)<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//do work<BR>&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;public static void DoSomething2(int IdToActUpon, string thing)<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// do work <BR>&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;etc..<BR>}</FONT><BR>
<P><FONT face=Arial size=2>I am trying to understand how best to accomplish this in CSLA. Going through the book, the model seems to be the "Exists" example for Project and Resource classes and using CommandBase. So each of my DoSomething methods above would be internal private command base classes that incorporate their logic.</FONT></P>
<P><FONT face=Arial size=2>Here is where it gets a little fuzzy for me.</FONT></P>
<P><FONT face=Arial size=2>1) What would the class (Something in the example above) inherit from in CSLA? Or wouldn't it inherit from anything?<BR>2) How would I apply validation (or authorization for that matter) to these DoSomething methods?</FONT></P>
<P><FONT face=Arial size=2>I appreciate any direction you could give to&nbsp;this CLSA newbie.</FONT></P>
<P><FONT face=Arial size=2>Thanks</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>gb1 replied on Thursday, February 28, 2008</h2>Just a little direction is all I need. Can anyone help?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael Hildner replied on Thursday, February 28, 2008</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>gb1:</strong></div><div>
<P><FONT face=Arial size=2>1) What would the class (Something in the example above) inherit from in CSLA? Or wouldn't it inherit from anything?<BR>2) How would I apply validation (or authorization for that matter) to these DoSomething methods?</FONT></P>
<P></div></BLOCKQUOTE></P>
<P>1) The class inherits from CommandBase.</P>
<P>2) I'm not sure about validation, but for authorization you can check e.g.</P>
<P>&nbsp;&nbsp;&nbsp; [Serializable()]<BR>&nbsp;&nbsp;&nbsp; public class CurrentAPPriceCommand : CommandBase<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #region Authorization Methods</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static bool CanExecuteCommand()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // TODO: customize to check user role<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //return ApplicationContext.User.IsInRole("");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #endregion</P>
<P>HTH some,</P>
<P>Mike</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, February 28, 2008</h2>Chapter 7 walks through a command template, showing where you'd do client-side code, server-side code, then client-side code again. That should be a useful discussion for you.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Thursday, February 28, 2008</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>gb1:</strong></div><div>
<P><FONT face=Arial size=2>Hi,</FONT></P>
<P><FONT face=Arial size=2>Very new to the framework. Still grappeling with it. </FONT><FONT face=Arial size=2>In a web application, I have a need for a class the doesn't necessarily have any properites but possibly just some static methods&nbsp;that perform its business logic.</FONT></P>
<P><FONT face=Arial size=2>...</FONT></P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp;public static void DoSomething1(int idToActUpon, int number)<BR>...</FONT></P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp;public static void DoSomething2(int IdToActUpon, string thing)<BR></FONT></div></BLOCKQUOTE></P>
<P>Here's my $0.02. </P>
<P>I wouldn't ever use a CommandBase&nbsp; (e.g. something like Exists) for business logic, because you lose much of the CSLA&nbsp;benefits (undo,&nbsp;validation rules,&nbsp;binding, authorization rules), and&nbsp;it seems to me like CSLA internally implements these as a specialized object much like BusinessBase (the command executes via a DataPortal_Update-like call). </P>
<P>The alternative I would suggest is to use a real BusinessBase derived class, where the input parameters to your "static" methods are instead properties of the a corresponding BO, and you do the same processing you'd do in the "Execute" method of a CommandBase type object in the DataPortal_Update() method of the BO. </P>
<P>This lets you validate the input, do data binding for the input, etc. </P>
<P>Any "method" you want to execute via CSLA can be almost by rote implemented as a BO where the parameters are instead properties and you execute the method logic when the BO is "saved". We are having great success with this technique as we port our existing legacy C++ applicaton to CSLA. </P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>gb1 replied on Friday, February 29, 2008</h2><font size="2"><font face="Tahoma">Thanks for the replies everyone. It looks like I have a few options.<br><br>rsbaker0. I like this idea. It would give me the flexibility to do all that CSLA brings (validation, auth, etc.) but upon looking at it, and using my example, wouldn't that turn each of my static DoSomething methods into separate classes. Otherwise how would DataPortal_Update() act upon the two differrent functions. If i have a couple of these situations it seems like it could get quite message fairly quickly.<br><br>Maybe I am still wrestling with CSLA and the idea of responsibility driven architecture. I know i have read on this forum how with a proper responsibilty driven architecture you'll end up with way more classes than you thought you would from a pure object model.</font></font><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, February 29, 2008</h2><P>The DataPortal concept is very flexible. </P>
<P>Since you are new you may not be aware that there are many ways to branch your code in the DP.</P>
<P>1. I think you can use strongly typed Criteria objects and then pass them to the corresponding DP which takes that type of Criteria. Rocky's fraemwork then takes care of calling the right one. </P>
<P>e.g. </P>
<P>Protected Overrides Sub DataPortal_Fetch(ByVal criteria As MyCriteria1)</P>
<P>Protected Overrides Sub DataPortal_Fetch(ByVal criteria As MyCriteria2)</P>
<P>2. You can call the standard DP method:</P>
<P>Protected Overrides Sub DataPortal_Fetch(ByVal criteria As Object)</P>
<P>Inside this one method you can perform branching:</P>
<P>If TypeOf(criteria) Is MyCriteria1 Then<BR>&nbsp;&nbsp; 'do something<BR>ElseIf TypeOf(criteria) Is MyCriteria2 Then<BR>&nbsp; 'do something else<BR>End If</P>
<P>3. If you have 2 factory methods which both use the same criteria then you need another way to perform the branching. I added a String Parameter to my Criteria classes called MethodName.</P>
<P>If TypeOf(criteria) Is MyCriteria1 Then<BR>&nbsp; Dim crit As MyCriteria1 = CType(criteria, MyCriteria1)</P>
<P>&nbsp; If crit.MethodName = "Method1" Then<BR>&nbsp;&nbsp;&nbsp;&nbsp; 'do something<BR>&nbsp; ElseIf crit.MethodName = "Method2" Then<BR>&nbsp;&nbsp;&nbsp; 'do something else<BR>&nbsp; End If</P>
<P>ElseIf TypeOf(criteria) Is MyCriteria2 Then<BR>&nbsp; 'do something else<BR>End If</P>
<P>This should give you some ideas of the various ways you can branch your code.</P>
<P>Joe</P>
<P><BR>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Friday, February 29, 2008</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>gb1:</strong></div><div><FONT face=Tahoma size=2>...</FONT><FONT face=Tahoma><BR><FONT size=2>rsbaker0. I like this idea. It would give me the flexibility to do all that CSLA brings (validation, auth, etc.) but upon looking at it, and using my example, wouldn't that turn each of my static DoSomething methods into separate classes. Otherwise how would DataPortal_Update() act upon the two differrent functions. If i have a couple of these situations it seems like it could get quite message fairly quickly.<BR>...</FONT></FONT></div></BLOCKQUOTE></P>
<P>Yes, this is exactly what happens. You can use several techniques to keep the scoping&nbsp;or organization&nbsp;similar to what you had before (e.g. use a namespace, nested classes, etc).</P>
<P>You'll find neat capabilities that you didn't anticpate by using BusinessBase derived objects rather than CommandBase objects. For instance, it becomes trivial to get the input onto a screen for testing, and you can even have "lists" of your "DoSomethings", etc. </P>
<P>It can also be easier to modify down the road if you find you need an additional input -- just add the new property and CSLA will take care of getting it server side for your update processing. </P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
