<html><header><title>Dynamic Editable Collection - how to prevent duplicate root objects from being created?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Dynamic Editable Collection - how to prevent duplicate root objects from being created?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9388.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>xvblack posted on Tuesday, August 17, 2010</h2><p>Hi,</p>
<p>I&#39;ve been using CSLA .NET for some time now and I&#39;ve just come across the need to use a Dynamic Root Collection bound to a datagridview control. </p>
<p>I&#39;ve got&nbsp;it all&nbsp;working apart from one thing that I&#39;m at a loss to resolve. When a User adds a new row to the datagrid how can you&nbsp;check if the entry they&#39;re adding already exists? For example, the grid shows a collection of Dynamic Root&nbsp;objects that have code and desciption properties. The code property is actually databound to the primary key of an underlying database table and therefore cannot be duplicated.</p>
<p>If the User tries to add a key that already exists the Data Portal throws an exception saying you cannot add a duplicate primary key (which is expected). Is there anyway to trap this error before it gets to the Data Portal? The root object has an &#39;exists&#39; method but the question is how do I trap the error in the first place?</p>
<p>Any help would be much appreaciated.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Tuesday, August 17, 2010</h2><p>You can create a BusinessRule (or ValidationRule, depemding upon the Csla version you are using) for your code property.&nbsp; The rule (which will run as soon as the user tabs out of the code field)&nbsp;should check the entered code against the other items in the DataGrid to see if there is a duplication.&nbsp; If so, it will register as a broken rule and the user will get am immediate warning in the UI.</p>
<p>The above assumes that all your existing data is already loaded in the DataGrid (which would be rare).&nbsp; Normally, you will have to write code in your BusinessRule&nbsp;to check for this duplication in the database also.&nbsp; I believe some of Rocky&#39;s sample projects do demonstrate that.</p>
<p>Jav</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xvblack replied on Wednesday, August 18, 2010</h2><p>Thanks for the quick response Jav. I&#39;ve looked at Rocky&#39;s examples and have found the relevant bit of code. </p>
<p>It all works fine now!</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
