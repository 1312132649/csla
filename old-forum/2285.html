<html><header><title>SortedBindingList, FilteredBindingList inconsistancy</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>SortedBindingList, FilteredBindingList inconsistancy</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2285.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>paulhumphris posted on Tuesday, February 06, 2007</h2><P><FONT face=Verdana size=2>I am trying to use the FilteredBindingList on one of my BusinessObjects that inherits from ReadOnlyListBase. However, once I have created the FilteredBindingList the SupportsSorting property returns false also when the same object is loaded into a SortedBindingList the SupportsSorting property is true.</FONT></P><FONT color=#2b91af size=1>
<P><FONT face="Courier New" size=2>ProductSearchResultList</FONT></FONT><FONT face="Courier New" size=2> products = <FONT color=#2b91af>ProductSearchResultList</FONT>.GetProductSearchResultList(<FONT color=#a31515>"monitor"</FONT>);</FONT></P>
<P><FONT size=2><FONT face="Courier New"><FONT color=#2b91af>FilteredBindingList</FONT>&lt;<FONT color=#2b91af>ProductSearchResultInfo</FONT>&gt; filtered = <FONT color=#0000ff>new</FONT> <FONT color=#2b91af>FilteredBindingList</FONT>&lt;<FONT color=#2b91af>ProductSearchResultInfo</FONT>&gt;(products);<BR><FONT color=#0000ff>bool</FONT> test = filtered.SupportsSorting;</FONT></FONT></P>
<P><FONT size=2><FONT face="Courier New"><FONT color=#2b91af>SortedBindingList</FONT>&lt;<FONT color=#2b91af>ProductSearchResultInfo</FONT>&gt; sorted = <FONT color=#0000ff>new</FONT> <FONT color=#2b91af>SortedBindingList</FONT>&lt;<FONT color=#2b91af>ProductSearchResultInfo</FONT>&gt;(products);<BR><FONT color=#0000ff>bool</FONT> test2 = sorted.SupportsSorting;</FONT></FONT></P>
<P><FONT face=Verdana size=2>The example code above will return false for "test" and true for "test2".&nbsp; Since both the FilteredBindingList and the SortedBindingList use an IBindingList to return the SupportsSorting property I am a little confused as to why I am getting different behaviour.</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Tuesday, February 06, 2007</h2>This is because FilteredBindingList provides filtering and SortedBindingList provides sorting.&nbsp; They are composable however, so you can do this:<br><p><font color="#2b91af" size="1"><font face="Courier New" size="2">ProductSearchResultList</font></font><font face="Courier New" size="2"> products = <font color="#2b91af">ProductSearchResultList</font>.GetProductSearchResultList(<font color="#a31515">"monitor"</font>);</font></p>
<p><font size="2"><font face="Courier New"><font color="#2b91af">FilteredBindingList</font>&lt;<font color="#2b91af">ProductSearchResultInfo</font>&gt; filtered = <font color="#0000ff">new</font> <font color="#2b91af">FilteredBindingList</font>&lt;<font color="#2b91af">ProductSearchResultInfo</font>&gt;(products);<br><font color="#0000ff">bool</font> test = filtered.SupportsSorting;</font></font></p>
<p><font size="2"><font face="Courier New"><font color="#2b91af">SortedBindingList</font>&lt;<font color="#2b91af">ProductSearchResultInfo</font>&gt; sorted = <font color="#0000ff">new</font> <font color="#2b91af">SortedBindingList</font>&lt;<font color="#2b91af">ProductSearchResultInfo</font>&gt;(</font></font><font size="2"><font face="Courier New"><font color="#ff0000">filtered</font></font></font><font size="2"><font face="Courier New">);<br><font color="#0000ff">bool</font> test2 = sorted.SupportsSorting;</font></font></p>You could also look at the ObjectListView in CSLAcontrib, which does both sorting and filtering of any IList.&nbsp; This does mean that you lose strong typing as it behaves like a DataView instead of an IList&lt;T&gt;.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>paulhumphris replied on Tuesday, February 06, 2007</h2><P><FONT face=Verdana size=2>I see what you are saying and I also found that somewhere else after making the post.</FONT></P>
<P><FONT face=Verdana size=2>Does raise the question of why the FilteredBindingList.ApplySort method is public if it is not useable?</FONT></P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Tuesday, February 06, 2007</h2>It most likely delegates to the underlying IBindingList if possible.&nbsp; So if the underlying IBindingList supported sorting, then it would pass the ApplySort method down to it.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, February 06, 2007</h2>Actually, I think it throws an InvalidOperationException or something like that if you call ApplySort and AllowSort is false.&nbsp; If it doesn't, it probably should.<br><br>I'm pretty sure I got such an exception when trying to add to a list and AllowNew was false.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Tuesday, February 06, 2007</h2>I took a look at the source code and it does delegate sorting to the underlying IBindingList if it supports sorting.&nbsp; So the following code would allow you to call filtered.ApplySort()<br><br><p><font color="#2b91af" size="1"><font face="Courier New" size="2">ProductSearchResultList</font></font><font face="Courier New" size="2"> products = <font color="#2b91af">ProductSearchResultList</font>.GetProductSearchResultList(<font color="#a31515">"monitor"</font>);</font></p><p><font size="2"><font face="Courier New"><font color="#2b91af">SortedBindingList</font>&lt;<font color="#2b91af">ProductSearchResultInfo</font>&gt; sorted = <font color="#0000ff">new</font> <font color="#2b91af">SortedBindingList</font>&lt;<font color="#2b91af">ProductSearchResultInfo</font>&gt;(products);<br><font color="#0000ff">bool</font> test2 = sorted.SupportsSorting;</font></font>

</p><p><font size="2"><font face="Courier New"><font color="#2b91af">FilteredBindingList</font>&lt;<font color="#2b91af">ProductSearchResultInfo</font>&gt; filtered = <font color="#0000ff">new</font> <font color="#2b91af">FilteredBindingList</font>&lt;<font color="#2b91af">ProductSearchResultInfo</font>&gt;(sorted);<br><font color="#0000ff">bool</font> test = filtered.SupportsSorting;</font></font></p>
<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, February 06, 2007</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>Actually, I think it throws an InvalidOperationException or something like that if you call ApplySort and AllowSort is false.&nbsp; If it doesn't, it probably should.<BR><BR>I'm pretty sure I got such an exception when trying to add to a list and AllowNew was false.<BR></div></BLOCKQUOTE></P>
<P>I always delegate the call - relying on the underlying implementation to throw any exceptions - unless the original list isn't an IBindingList, in which case I throw an exception directly.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>paulhumphris replied on Wednesday, February 07, 2007</h2><P><FONT face=Verdana size=2>Thanks all, I think its clearly now.....</FONT></P>
<P><FONT face=Verdana size=2>The FilteredBindingList cannot perform sorting unless it has been constructed from a SortedBindingList.</FONT></P>
<P><FONT face=Verdana size=2>Cheers</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, February 07, 2007</h2><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>RockfordLhotka:</strong></div><div>I always delegate the call - relying on the underlying implementation to throw any exceptions - unless the original list isn't an IBindingList, in which case I throw an exception directly.</div></BLOCKQUOTE><br><br>Right... I didn't necessarly mean Csla code, just that at some point something would / should.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
