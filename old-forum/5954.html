<html><header><title>Problem with tabbing thru' TextBoxes after NewData() and Rebinding.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Problem with tabbing thru' TextBoxes after NewData() and Rebinding.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5954.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>andrewrajcoomar posted on Monday, December 08, 2008</h2><P>I am having an issue where my textboxes require that I tab twice to exit them if I entered a value. If no value, regular behaviour, once is good enough. This only happens when I am trying to add new data and have a new object. No problems with edits.</P>
<P>Really grateful for any help.</P>
<P>&nbsp;</P>
<P>I have a form with two page tabs. Tab1 contains a grid that&nbsp;binds to a readonly collection. Tab2 is for new data and is bound to a businessbaseobject. </P>
<P>On Tab2 I have a "New" button. When the user clicks it, I have this in my click event:</P><FONT size=2>
<BLOCKQUOTE dir=ltr>
<P></FONT>&nbsp;</P><FONT size=2><FONT color=#0000ff size=2>
<P>Me</FONT><FONT size=2>.ChartFieldOverrideBindingSource.CancelEdit()</P></FONT>
<P></FONT><FONT color=#008000 size=2>' get a new object</P></FONT><FONT size=2>
<P>_ChartFieldOverride = ChartFieldOverride.NewChartFieldOverride()</P>
<P></FONT><FONT color=#008000 size=2>' rebind UI</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.ChartFieldOverrideBindingSource.DataSource = _ChartFieldOverride</P>
<P></FONT><FONT color=#008000 size=2>' repaint UI (set all textbox.text to string.empty)</P></FONT><FONT size=2>
<P>RefreshControls()</P>
<P></FONT><FONT color=#008000 size=2>' put focus to first textbox control</P></FONT><FONT size=2>
<P>txtTransfer_ID.Focus()</P></BLOCKQUOTE>
<P dir=ltr></FONT><FONT size=2>This code works, EXCEPT, for some reason, any textbox that I enter a value in REQUIRES A DOUBLE TAB.</FONT></P>
<P dir=ltr><FONT size=2></FONT>&nbsp;</P>
<P dir=ltr><FONT size=2>========================== COMPLETE CODE LISTING =================================</FONT></P><FONT size=2><FONT color=#0000ff size=2>
<P>Imports</FONT><FONT size=2> Csla</P></FONT><FONT color=#0000ff size=2>
<P>Imports </FONT><FONT size=2>MIST.Common</P></FONT><FONT color=#0000ff size=2>
<P>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> ucChartFieldOverride</P>
<P></FONT><FONT color=#0000ff size=2>Inherits</FONT><FONT size=2> WinPart</P>
<P>#</FONT><FONT color=#0000ff size=2>Region</FONT><FONT size=2> </FONT><FONT color=#a31515 size=2>"Variables"</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>WithEvents</FONT><FONT size=2> _ChartFieldOverrideList </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> ChartFieldOverrideList</P>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>WithEvents</FONT><FONT size=2> _ChartFieldOverride </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> ChartFieldOverride</P>
<P>#</FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P></FONT><FONT size=2>
<P>#</FONT><FONT color=#0000ff size=2>Region</FONT><FONT size=2> </FONT><FONT color=#a31515 size=2>"Properties"</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>ReadOnly</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</FONT><FONT size=2> ChartFieldOverrideList() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> ChartFieldOverrideList</P>
<P></FONT><FONT color=#0000ff size=2>Get</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> _ChartFieldOverrideList</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Get</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>ReadOnly</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</FONT><FONT size=2> ChartFieldOverride() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> ChartFieldOverride</P>
<P></FONT><FONT color=#0000ff size=2>Get</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> _ChartFieldOverride</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Get</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</P></FONT><FONT size=2>
<P>#</FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P></FONT><FONT size=2>
<P>#</FONT><FONT color=#0000ff size=2>Region</FONT><FONT size=2> </FONT><FONT color=#a31515 size=2>"Constructor"</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> chartFieldOverrideList </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> ChartFieldOverrideList)</P>
<P>InitializeComponent()</P>
<P>_ChartFieldOverrideList = chartFieldOverrideList</P>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.ChartFieldOverrideListBindingSource.DataSource = </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> SortedBindingList(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> ChartFieldOverrideInfo)(chartFieldOverrideList)</P>
<P>_ChartFieldOverride = ChartFieldOverride.NewChartFieldOverride()</P>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.ChartFieldOverrideBindingSource.DataSource = ChartFieldOverride</P>
<P>ApplyAuthorizationRules()</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P>#</FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P></FONT><FONT size=2>
<P>#</FONT><FONT color=#0000ff size=2>Region</FONT><FONT size=2> </FONT><FONT color=#a31515 size=2>" WinPart Code "</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetIdValue() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> _ChartFieldOverrideList</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> ToString() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#a31515 size=2>"ChartField Overrides Maintenance"</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> ucChartField_CurrentPrincipalChanged(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.EventArgs) </FONT><FONT color=#0000ff size=2>Handles</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.CurrentPrincipalChanged</P>
<P>ApplyAuthorizationRules()</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P>#</FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> ApplyAuthorizationRules()</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P>#</FONT><FONT color=#0000ff size=2>Region</FONT><FONT size=2> </FONT><FONT color=#a31515 size=2>"Form Events"</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> ucChartFieldOverrides_Load(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.EventArgs) </FONT><FONT color=#0000ff size=2>Handles</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.Load</P>
<P></FONT><FONT color=#0000ff size=2>With</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.ChartFieldOverrideListDataGridView</P>
<P>.RowHeadersVisible = </FONT><FONT color=#0000ff size=2>False</P></FONT><FONT size=2>
<P>.SelectionMode = DataGridViewSelectionMode.FullRowSelect</P>
<P>.AllowUserToAddRows = </FONT><FONT color=#0000ff size=2>False</P></FONT><FONT size=2>
<P>.AllowUserToDeleteRows = </FONT><FONT color=#0000ff size=2>False</P></FONT><FONT size=2>
<P>.AllowUserToOrderColumns = </FONT><FONT color=#0000ff size=2>True</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>With</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>'BindingNavigatorAddNewItem.Enabled = True</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>'BindingNavigatorDeleteItem.Enabled = True</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> ChartFieldOverrideListDataGridView_DoubleClick(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.EventArgs) </FONT><FONT color=#0000ff size=2>Handles</FONT><FONT size=2> ChartFieldOverrideListDataGridView.DoubleClick</P>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> oUtils </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Utilities = </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> Utilities</P>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> id </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2> = oUtils.GetRowID(</FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.ChartFieldOverrideListDataGridView.CurrentRow, </FONT><FONT color=#a31515 size=2>"Xfr_ChartField_Override_ID"</FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> id &lt;&gt; 0 </FONT><FONT color=#0000ff size=2>Then</P></FONT><FONT size=2>
<P>GoToPage(2)</P>
<P></FONT><FONT color=#008000 size=2>' rebind UI and set controls</P></FONT><FONT size=2>
<P>_ChartFieldOverride = ChartFieldOverride.GetChartFieldOverride(id)</P>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.ChartFieldOverrideBindingSource.DataSource = _ChartFieldOverride</P>
<P>btnDelete.Enabled = </FONT><FONT color=#0000ff size=2>True</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P>#</FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P></FONT><FONT size=2>
<P>#</FONT><FONT color=#0000ff size=2>Region</FONT><FONT size=2> </FONT><FONT color=#a31515 size=2>"Private Methods"</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> SaveData()</P>
<P></FONT><FONT color=#0000ff size=2>Using</FONT><FONT size=2> busy </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> StatusBusy(</FONT><FONT color=#a31515 size=2>"Saving..."</FONT><FONT size=2>)</P>
<P></FONT><FONT color=#008000 size=2>' stop the flow of events</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.ChartFieldOverrideListBindingSource.RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2>False</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.ChartFieldOverrideBindingSource.RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2>False</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.ChartFieldOverrideBindingSource.EndEdit()</P>
<P></FONT><FONT color=#008000 size=2>' do the save</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Try</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> temp </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> ChartFieldOverride = _ChartFieldOverride.Clone</P>
<P>_ChartFieldOverride = temp.Save</P>
<P></FONT><FONT color=#008000 size=2>' rebind the UI</P></FONT><FONT size=2>
<P>_ChartFieldOverrideList = ChartFieldOverrideList.GetChartFieldOverrideList()</P>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.ChartFieldOverrideListBindingSource.DataSource = _ChartFieldOverrideList</P>
<P>ApplyAuthorizationRules()</P>
<P></FONT><FONT color=#0000ff size=2>Catch</FONT><FONT size=2> ex </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Csla.DataPortalException</P>
<P>MessageBox.Show(ex.BusinessException.ToString, _</P>
<P></FONT><FONT color=#a31515 size=2>"Error saving"</FONT><FONT size=2>, MessageBoxButtons.OK, _</P>
<P>MessageBoxIcon.Exclamation)</P>
<P></FONT><FONT color=#0000ff size=2>Catch</FONT><FONT size=2> ex </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Exception</P>
<P>MessageBox.Show(ex.ToString, _</P>
<P></FONT><FONT color=#a31515 size=2>"Error saving"</FONT><FONT size=2>, MessageBoxButtons.OK, _</P>
<P>MessageBoxIcon.Exclamation)</P>
<P></FONT><FONT color=#0000ff size=2>Finally</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.ChartFieldOverrideListBindingSource.RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2>True</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.ChartFieldOverrideBindingSource.RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2>True</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.ChartFieldOverrideListBindingSource.ResetBindings(</FONT><FONT color=#0000ff size=2>False</FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.ChartFieldOverrideBindingSource.ResetBindings(</FONT><FONT color=#0000ff size=2>False</FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Try</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Using</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> GoToPage(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> pg </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> pg = 1 </FONT><FONT color=#0000ff size=2>Then</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.TabControl1.SelectedTab = TabPage1</P>
<P></FONT><FONT color=#0000ff size=2>Else</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.TabControl1.SelectedTab = TabPage2</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> RefreshControls()</P>
<P>Xfr_Chartfield_Override_IDLabel1.Text = </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>.Empty</P>
<P>txtTransfer_ID.Text = </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>.Empty</P>
<P>txtPortfolio.Text = </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>.Empty</P>
<P>txtBusiness_Unit.Text = </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>.Empty</P>
<P>txtProduct.Text = </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>.Empty</P>
<P>txtDept_Id.Text = </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>.Empty</P>
<P>txtActivity_Code.Text = </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>.Empty</P>
<P>txtOperating_Unit.Text = </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>.Empty</P>
<P>txtComment.Text = </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>.Empty</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> ID(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> datarow </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> DataGridViewRow) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> datarow </FONT><FONT color=#0000ff size=2>IsNot</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Nothing</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Then</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>For</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Each</FONT><FONT size=2> cell </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> DataGridViewCell </FONT><FONT color=#0000ff size=2>In</FONT><FONT size=2> datarow.Cells</P>
<P></FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> cell.OwningColumn.Name() = </FONT><FONT color=#a31515 size=2>"Xfr_Chartfield_Override_ID"</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Then</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>DirectCast</FONT><FONT size=2>(cell.Value, </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2>Exit</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>For</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Next</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT><FONT size=2>
<P>#</FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P></FONT><FONT size=2>
<P>#</FONT><FONT color=#0000ff size=2>Region</FONT><FONT size=2> </FONT><FONT color=#a31515 size=2>"Button Events"</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> btnNew_Click(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.Object, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.EventArgs) </FONT><FONT color=#0000ff size=2>Handles</FONT><FONT size=2> btnNew.Click</P>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.ChartFieldOverrideBindingSource.CancelEdit()</P>
<P></FONT><FONT color=#008000 size=2>' get a new chartfieldoverride object</P></FONT><FONT size=2>
<P>_ChartFieldOverride = ChartFieldOverride.NewChartFieldOverride()</P>
<P></FONT><FONT color=#008000 size=2>' rebind UI</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.ChartFieldOverrideBindingSource.DataSource = _ChartFieldOverride</P>
<P></FONT><FONT color=#008000 size=2>' repaint UI (set all textbox.text to string.empty)</P></FONT><FONT size=2>
<P>RefreshControls()</P>
<P>txtTransfer_ID.Focus()</P>
<P>btnDelete.Enabled = </FONT><FONT color=#0000ff size=2>False</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> btnSave_Click(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.Object, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.EventArgs) </FONT><FONT color=#0000ff size=2>Handles</FONT><FONT size=2> btnSave.Click</P>
<P>SaveData()</P>
<P>GoToPage(1)</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> btnClose_Click(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.Object, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.EventArgs) </FONT><FONT color=#0000ff size=2>Handles</FONT><FONT size=2> btnClose.Click</P>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.Close()</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P>
<P>&nbsp;</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> btnCancel_Click(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.Object, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.EventArgs) </FONT><FONT color=#0000ff size=2>Handles</FONT><FONT size=2> btnCancel.Click</P>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.ChartFieldOverrideBindingSource.CancelEdit()</P>
<P>RefreshControls()</P>
<P>GoToPage(1)</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P>#</FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P>
<P>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>sergeyb replied on Monday, December 08, 2008</h2>









 

 
  
 




<div class=Section1>

<p class=MsoNormal><span>I am guessing that an exception is thrown in the process of
updating the value in your object somewhere.&nbsp; Run with exceptions turned on
in debugger to verify.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><b><span>Sergey Barskiy<o:p></o:p></span></b></p>

<p class=MsoNormal><b><i><span>Principal Consultant<o:p></o:p></span></i></b></p>

<p class=MsoNormal><span>office: 678.405.0687 |
mobile:&nbsp;404.388.1899</span><span><o:p></o:p></span></p>

<p class=MsoNormal><span><img width=119 height=26 id="Picture_x0020_1" alt="cid:_2_0648EA840648E85C001BBCB886257279"><br>
</span><b><span>Microsoft Worldwide Partner of the Year |</span></b><span> </span><b><span>Custom
Development Solutions, Technical Innovation</span></b><span><o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<div>

<p class=MsoNormal><b><span>From:</span></b><span> andrewrajcoomar
[mailto:cslanet@lhotka.net] <br>
<b>Sent:</b> Monday, December 08, 2008 6:10 PM<br>
<b>To:</b> Sergey Barskiy<br>
<b>Subject:</b> [CSLA .NET] Problem with tabbing thru' TextBoxes after NewData()
and Rebinding.<o:p></o:p></span></p>

</div>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p>I am having an issue where my textboxes require that I tab twice to exit
them if I entered a value. If no value, regular behaviour, once is good enough.
This only happens when I am trying to add new data and have a new object. No
problems with edits.<o:p></o:p></p>

<p>Really grateful for any help.<o:p></o:p></p>

<p>&nbsp;<o:p></o:p></p>

<p>I have a form with two page tabs. Tab1 contains a grid that&nbsp;binds to a
readonly collection. Tab2 is for new data and is bound to a businessbaseobject.
<o:p></o:p></p>

<p>On Tab2 I have a &quot;New&quot; button. When the user clicks it, I have
this in my click event:<o:p></o:p></p>

<blockquote>

<p>&nbsp;<o:p></o:p></p>

<p><span>Me</span><span>.ChartFieldOverrideBindingSource.CancelEdit()<o:p></o:p></span></p>

<p><span>' get a new object<o:p></o:p></span></p>

<p><span>_ChartFieldOverride =
ChartFieldOverride.NewChartFieldOverride()<o:p></o:p></span></p>

<p><span>' rebind UI<o:p></o:p></span></p>

<p><span>Me</span><span>.ChartFieldOverrideBindingSource.DataSource = _ChartFieldOverride<o:p></o:p></span></p>

<p><span>' repaint UI (set all
textbox.text to string.empty)<o:p></o:p></span></p>

<p><span>RefreshControls()<o:p></o:p></span></p>

<p><span>' put focus to first textbox
control<o:p></o:p></span></p>

<p><span>txtTransfer_ID.Focus()<o:p></o:p></span></p>

</blockquote>

<p><span>This code works, EXCEPT, for some reason, any
textbox that I enter a value in REQUIRES A DOUBLE TAB.</span><o:p></o:p></p>

<p>&nbsp;<o:p></o:p></p>

<p><span>========================== COMPLETE CODE
LISTING =================================</span><o:p></o:p></p>

<p><span>Imports</span><span> Csla<o:p></o:p></span></p>

<p><span>Imports </span><span>MIST.Common<o:p></o:p></span></p>

<p><span>Public</span><span> <span>Class</span>
ucChartFieldOverride<o:p></o:p></span></p>

<p><span>Inherits</span><span> WinPart<o:p></o:p></span></p>

<p><span>#<span>Region</span> <span>&quot;Variables&quot;<o:p></o:p></span></span></p>

<p><span>Private</span><span> <span>WithEvents</span>
_ChartFieldOverrideList <span>As</span>
ChartFieldOverrideList<o:p></o:p></span></p>

<p><span>Private</span><span> <span>WithEvents</span>
_ChartFieldOverride <span>As</span> ChartFieldOverride<o:p></o:p></span></p>

<p><span>#<span>End</span> <span>Region<o:p></o:p></span></span></p>

<p><span>#<span>Region</span> <span>&quot;Properties&quot;<o:p></o:p></span></span></p>

<p><span>Public</span><span> <span>ReadOnly</span> <span>Property</span> ChartFieldOverrideList() <span>As</span> ChartFieldOverrideList<o:p></o:p></span></p>

<p><span>Get<o:p></o:p></span></p>

<p><span>Return</span><span> _ChartFieldOverrideList<o:p></o:p></span></p>

<p><span>End</span><span> <span>Get<o:p></o:p></span></span></p>

<p><span>End</span><span> <span>Property<o:p></o:p></span></span></p>

<p><span>Public</span><span> <span>ReadOnly</span> <span>Property</span> ChartFieldOverride() <span>As</span> ChartFieldOverride<o:p></o:p></span></p>

<p><span>Get<o:p></o:p></span></p>

<p><span>Return</span><span> _ChartFieldOverride<o:p></o:p></span></p>

<p><span>End</span><span> <span>Get<o:p></o:p></span></span></p>

<p><span>End</span><span> <span>Property<o:p></o:p></span></span></p>

<p><span>#<span>End</span> <span>Region<o:p></o:p></span></span></p>

<p><span>#<span>Region</span> <span>&quot;Constructor&quot;<o:p></o:p></span></span></p>

<p><span>Public</span><span> <span>Sub</span> <span>New</span>(<span>ByVal</span>
chartFieldOverrideList <span>As</span>
ChartFieldOverrideList)<o:p></o:p></span></p>

<p><span>InitializeComponent()<o:p></o:p></span></p>

<p><span>_ChartFieldOverrideList =
chartFieldOverrideList<o:p></o:p></span></p>

<p><span>Me</span><span>.ChartFieldOverrideListBindingSource.DataSource = <span>New</span> SortedBindingList(<span>Of</span>
ChartFieldOverrideInfo)(chartFieldOverrideList)<o:p></o:p></span></p>

<p><span>_ChartFieldOverride =
ChartFieldOverride.NewChartFieldOverride()<o:p></o:p></span></p>

<p><span>Me</span><span>.ChartFieldOverrideBindingSource.DataSource = ChartFieldOverride<o:p></o:p></span></p>

<p><span>ApplyAuthorizationRules()<o:p></o:p></span></p>

<p><span>End</span><span> <span>Sub<o:p></o:p></span></span></p>

<p><span>#<span>End</span> <span>Region<o:p></o:p></span></span></p>

<p><span>#<span>Region</span> <span>&quot; WinPart Code &quot;<o:p></o:p></span></span></p>

<p><span>Protected</span><span> <span>Overrides</span> <span>Function</span> GetIdValue() <span>As</span>
<span>Object<o:p></o:p></span></span></p>

<p><span>Return</span><span> _ChartFieldOverrideList<o:p></o:p></span></p>

<p><span>End</span><span> <span>Function<o:p></o:p></span></span></p>

<p><span>Public</span><span> <span>Overrides</span> <span>Function</span> ToString() <span>As</span>
<span>String<o:p></o:p></span></span></p>

<p><span>Return</span><span> <span>&quot;ChartField
Overrides Maintenance&quot;<o:p></o:p></span></span></p>

<p><span>End</span><span> <span>Function<o:p></o:p></span></span></p>

<p><span>Private</span><span> <span>Sub</span>
ucChartField_CurrentPrincipalChanged(<span>ByVal</span>
sender <span>As</span> <span>Object</span>,
<span>ByVal</span> e <span>As</span>
System.EventArgs) <span>Handles</span> <span>Me</span>.CurrentPrincipalChanged<o:p></o:p></span></p>

<p><span>ApplyAuthorizationRules()<o:p></o:p></span></p>

<p><span>End</span><span> <span>Sub<o:p></o:p></span></span></p>

<p><span>#<span>End</span> <span>Region<o:p></o:p></span></span></p>

<p><span>Private</span><span> <span>Sub</span> ApplyAuthorizationRules()<o:p></o:p></span></p>

<p><span>End</span><span> <span>Sub<o:p></o:p></span></span></p>

<p><span>#<span>Region</span> <span>&quot;Form Events&quot;<o:p></o:p></span></span></p>

<p><span>Private</span><span> <span>Sub</span>
ucChartFieldOverrides_Load(<span>ByVal</span> sender <span>As</span> <span>Object</span>, <span>ByVal</span> e <span>As</span>
System.EventArgs) <span>Handles</span> <span>Me</span>.Load<o:p></o:p></span></p>

<p><span>With</span><span> <span>Me</span>.ChartFieldOverrideListDataGridView<o:p></o:p></span></p>

<p><span>.RowHeadersVisible = <span>False<o:p></o:p></span></span></p>

<p><span>.SelectionMode = DataGridViewSelectionMode.FullRowSelect<o:p></o:p></span></p>

<p><span>.AllowUserToAddRows = <span>False<o:p></o:p></span></span></p>

<p><span>.AllowUserToDeleteRows = <span>False<o:p></o:p></span></span></p>

<p><span>.AllowUserToOrderColumns = <span>True<o:p></o:p></span></span></p>

<p><span>End</span><span> <span>With<o:p></o:p></span></span></p>

<p><span>'BindingNavigatorAddNewItem.Enabled
= True<o:p></o:p></span></p>

<p><span>'BindingNavigatorDeleteItem.Enabled
= True<o:p></o:p></span></p>

<p><span>End</span><span> <span>Sub<o:p></o:p></span></span></p>

<p><span>Private</span><span> <span>Sub</span> ChartFieldOverrideListDataGridView_DoubleClick(<span>ByVal</span> sender <span>As</span> <span>Object</span>, <span>ByVal</span> e <span>As</span> System.EventArgs) <span>Handles</span>
ChartFieldOverrideListDataGridView.DoubleClick<o:p></o:p></span></p>

<p><span>Dim</span><span> oUtils <span>As</span> Utilities = <span>New</span> Utilities<o:p></o:p></span></p>

<p><span>Dim</span><span> id <span>As</span> <span>Integer</span>
= oUtils.GetRowID(<span>Me</span>.ChartFieldOverrideListDataGridView.CurrentRow,
<span>&quot;Xfr_ChartField_Override_ID&quot;</span>)<o:p></o:p></span></p>

<p><span>If</span><span> id &lt;&gt; 0 <span>Then<o:p></o:p></span></span></p>

<p><span>GoToPage(2)<o:p></o:p></span></p>

<p><span>' rebind UI and set controls<o:p></o:p></span></p>

<p><span>_ChartFieldOverride =
ChartFieldOverride.GetChartFieldOverride(id)<o:p></o:p></span></p>

<p><span>Me</span><span>.ChartFieldOverrideBindingSource.DataSource = _ChartFieldOverride<o:p></o:p></span></p>

<p><span>btnDelete.Enabled = <span>True<o:p></o:p></span></span></p>

<p><span>End</span><span> <span>If<o:p></o:p></span></span></p>

<p><span>End</span><span> <span>Sub<o:p></o:p></span></span></p>

<p><span>#<span>End</span> <span>Region<o:p></o:p></span></span></p>

<p><span>#<span>Region</span> <span>&quot;Private Methods&quot;<o:p></o:p></span></span></p>

<p><span>Private</span><span> <span>Sub</span> SaveData()<o:p></o:p></span></p>

<p><span>Using</span><span> busy <span>As</span> <span>New</span> StatusBusy(<span>&quot;Saving...&quot;</span>)<o:p></o:p></span></p>

<p><span>' stop the flow of events<o:p></o:p></span></p>

<p><span>Me</span><span>.ChartFieldOverrideListBindingSource.RaiseListChangedEvents = <span>False<o:p></o:p></span></span></p>

<p><span>Me</span><span>.ChartFieldOverrideBindingSource.RaiseListChangedEvents = <span>False<o:p></o:p></span></span></p>

<p><span>Me</span><span>.ChartFieldOverrideBindingSource.EndEdit()<o:p></o:p></span></p>

<p><span>' do the save<o:p></o:p></span></p>

<p><span>Try<o:p></o:p></span></p>

<p><span>Dim</span><span> temp <span>As</span> ChartFieldOverride =
_ChartFieldOverride.Clone<o:p></o:p></span></p>

<p><span>_ChartFieldOverride = temp.Save<o:p></o:p></span></p>

<p><span>' rebind the UI<o:p></o:p></span></p>

<p><span>_ChartFieldOverrideList = ChartFieldOverrideList.GetChartFieldOverrideList()<o:p></o:p></span></p>

<p><span>Me</span><span>.ChartFieldOverrideListBindingSource.DataSource =
_ChartFieldOverrideList<o:p></o:p></span></p>

<p><span>ApplyAuthorizationRules()<o:p></o:p></span></p>

<p><span>Catch</span><span> ex <span>As</span>
Csla.DataPortalException<o:p></o:p></span></p>

<p><span>MessageBox.Show(ex.BusinessException.ToString,
_<o:p></o:p></span></p>

<p><span>&quot;Error saving&quot;</span><span>, MessageBoxButtons.OK, _<o:p></o:p></span></p>

<p><span>MessageBoxIcon.Exclamation)<o:p></o:p></span></p>

<p><span>Catch</span><span> ex <span>As</span> Exception<o:p></o:p></span></p>

<p><span>MessageBox.Show(ex.ToString, _<o:p></o:p></span></p>

<p><span>&quot;Error saving&quot;</span><span>, MessageBoxButtons.OK, _<o:p></o:p></span></p>

<p><span>MessageBoxIcon.Exclamation)<o:p></o:p></span></p>

<p><span>Finally<o:p></o:p></span></p>

<p><span>Me</span><span>.ChartFieldOverrideListBindingSource.RaiseListChangedEvents = <span>True<o:p></o:p></span></span></p>

<p><span>Me</span><span>.ChartFieldOverrideBindingSource.RaiseListChangedEvents = <span>True<o:p></o:p></span></span></p>

<p><span>Me</span><span>.ChartFieldOverrideListBindingSource.ResetBindings(<span>False</span>)<o:p></o:p></span></p>

<p><span>Me</span><span>.ChartFieldOverrideBindingSource.ResetBindings(<span>False</span>)<o:p></o:p></span></p>

<p><span>End</span><span> <span>Try<o:p></o:p></span></span></p>

<p><span>End</span><span> <span>Using<o:p></o:p></span></span></p>

<p><span>End</span><span> <span>Sub<o:p></o:p></span></span></p>

<p><span>Private</span><span> <span>Sub</span> GoToPage(<span>ByVal</span> pg <span>As</span> <span>Integer</span>)<o:p></o:p></span></p>

<p><span>If</span><span> pg = 1 <span>Then<o:p></o:p></span></span></p>

<p><span>Me</span><span>.TabControl1.SelectedTab = TabPage1<o:p></o:p></span></p>

<p><span>Else<o:p></o:p></span></p>

<p><span>Me</span><span>.TabControl1.SelectedTab = TabPage2<o:p></o:p></span></p>

<p><span>End</span><span> <span>If<o:p></o:p></span></span></p>

<p><span>End</span><span> <span>Sub<o:p></o:p></span></span></p>

<p><span>Private</span><span> <span>Sub</span> RefreshControls()<o:p></o:p></span></p>

<p><span>Xfr_Chartfield_Override_IDLabel1.Text = <span>String</span>.Empty<o:p></o:p></span></p>

<p><span>txtTransfer_ID.Text = <span>String</span>.Empty<o:p></o:p></span></p>

<p><span>txtPortfolio.Text = <span>String</span>.Empty<o:p></o:p></span></p>

<p><span>txtBusiness_Unit.Text = <span>String</span>.Empty<o:p></o:p></span></p>

<p><span>txtProduct.Text = <span>String</span>.Empty<o:p></o:p></span></p>

<p><span>txtDept_Id.Text = <span>String</span>.Empty<o:p></o:p></span></p>

<p><span>txtActivity_Code.Text = <span>String</span>.Empty<o:p></o:p></span></p>

<p><span>txtOperating_Unit.Text = <span>String</span>.Empty<o:p></o:p></span></p>

<p><span>txtComment.Text = <span>String</span>.Empty<o:p></o:p></span></p>

<p><span>End</span><span> <span>Sub<o:p></o:p></span></span></p>

<p><span>Private</span><span> <span>Function</span> ID(<span>ByVal</span> datarow <span>As</span>
DataGridViewRow) <span>As</span> <span>Integer<o:p></o:p></span></span></p>

<p><span>If</span><span> datarow <span>IsNot</span> <span>Nothing</span>
<span>Then<o:p></o:p></span></span></p>

<p><span>For</span><span> <span>Each</span> cell <span>As</span>
DataGridViewCell <span>In</span> datarow.Cells<o:p></o:p></span></p>

<p><span>If</span><span> cell.OwningColumn.Name() = <span>&quot;Xfr_Chartfield_Override_ID&quot;</span>
<span>Then<o:p></o:p></span></span></p>

<p><span>Return</span><span> <span>DirectCast</span>(cell.Value,
<span>Integer</span>)<o:p></o:p></span></p>

<p><span>Exit</span><span> <span>For<o:p></o:p></span></span></p>

<p><span>End</span><span> <span>If<o:p></o:p></span></span></p>

<p><span>Next<o:p></o:p></span></p>

<p><span>End</span><span> <span>If<o:p></o:p></span></span></p>

<p><span>End</span><span> <span>Function<o:p></o:p></span></span></p>

<p><span>#<span>End</span> <span>Region<o:p></o:p></span></span></p>

<p><span>#<span>Region</span> <span>&quot;Button Events&quot;<o:p></o:p></span></span></p>

<p><span>Private</span><span> <span>Sub</span> btnNew_Click(<span>ByVal</span> sender <span>As</span>
System.Object, <span>ByVal</span> e <span>As</span>
System.EventArgs) <span>Handles</span> btnNew.Click<o:p></o:p></span></p>

<p><span>Me</span><span>.ChartFieldOverrideBindingSource.CancelEdit()<o:p></o:p></span></p>

<p><span>' get a new chartfieldoverride
object<o:p></o:p></span></p>

<p><span>_ChartFieldOverride = ChartFieldOverride.NewChartFieldOverride()<o:p></o:p></span></p>

<p><span>' rebind UI<o:p></o:p></span></p>

<p><span>Me</span><span>.ChartFieldOverrideBindingSource.DataSource = _ChartFieldOverride<o:p></o:p></span></p>

<p><span>' repaint UI (set all
textbox.text to string.empty)<o:p></o:p></span></p>

<p><span>RefreshControls()<o:p></o:p></span></p>

<p><span>txtTransfer_ID.Focus()<o:p></o:p></span></p>

<p><span>btnDelete.Enabled = <span>False<o:p></o:p></span></span></p>

<p><span>End</span><span> <span>Sub<o:p></o:p></span></span></p>

<p><span>Private</span><span> <span>Sub</span> btnSave_Click(<span>ByVal</span> sender <span>As</span>
System.Object, <span>ByVal</span> e <span>As</span>
System.EventArgs) <span>Handles</span> btnSave.Click<o:p></o:p></span></p>

<p><span>SaveData()<o:p></o:p></span></p>

<p><span>GoToPage(1)<o:p></o:p></span></p>

<p><span>End</span><span> <span>Sub<o:p></o:p></span></span></p>

<p><span>Private</span><span> <span>Sub</span> btnClose_Click(<span>ByVal</span> sender <span>As</span>
System.Object, <span>ByVal</span> e <span>As</span>
System.EventArgs) <span>Handles</span> btnClose.Click<o:p></o:p></span></p>

<p><span>Me</span><span>.Close()<o:p></o:p></span></p>

<p><span>End</span><span> <span>Sub<o:p></o:p></span></span></p>

<p><span>&nbsp;<o:p></o:p></span></p>

<p><span>Private</span><span> <span>Sub</span> btnCancel_Click(<span>ByVal</span> sender <span>As</span>
System.Object, <span>ByVal</span> e <span>As</span>
System.EventArgs) <span>Handles</span> btnCancel.Click<o:p></o:p></span></p>

<p><span>Me</span><span>.ChartFieldOverrideBindingSource.CancelEdit()<o:p></o:p></span></p>

<p><span>RefreshControls()<o:p></o:p></span></p>

<p><span>GoToPage(1)<o:p></o:p></span></p>

<p><span>End</span><span> <span>Sub<o:p></o:p></span></span></p>

<p><span>#<span>End</span> <span>Region<o:p></o:p></span></span></p>

<p><span>End</span><span> <span>Class<o:p></o:p></span></span></p>

<p class=MsoNormal><br>
<br>
<o:p></o:p></p>

</div>



</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>andrewrajcoomar replied on Monday, December 08, 2008</h2><P>I am running in Debug configuration. I have breakpoint in the form and in the&nbsp;object class. No code execution takes place when I am hitting tab. Don't even see the setter on the property, firing for propertyhaschanged.</P>
<P>By the way, I am on VS 2005 and CSLA.Net 2.1.4.0.</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
