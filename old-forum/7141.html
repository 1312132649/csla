<html><header><title>objectfactory wish</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>objectfactory wish</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7141.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong posted on Monday, June 22, 2009</h2><P>The internal IManageProperties interface offers the posibility of loading a property without a strictly typed argument. Can the ObjectFactory be extended with an overloaded LoadProperty?</P>
<P>This because we don't know the type at designtime, being dynamic.</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>protected</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>void</FONT></FONT><FONT size=2> LoadProperty(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2> obj, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2><FONT color=#2b91af size=2><FONT color=#2b91af size=2>IPropertyInfo</FONT></FONT><FONT size=2><FONT color=#000000> propertyInfo</FONT></FONT></FONT></FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2> newValue)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>var</FONT></FONT><FONT size=2> target = obj </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>as</FONT></FONT><FONT size=2> Core.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>IManageProperties</FONT></FONT><FONT size=2>;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>if</FONT></FONT><FONT size=2> (target != </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>null</FONT></FONT><FONT size=2>)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;target.LoadProperty(propertyInfo, newValue);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>throw</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ArgumentException</FONT></FONT><FONT size=2>(</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Resources</FONT></FONT><FONT size=2>.IManagePropertiesRequiredException);<BR>}</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Monday, June 22, 2009</h2>Hi, <br><br>The ObjectFactory baseclass exposes the BypassPropertyChecks that essentially changes the behaviour of SetProperty to LoadProperty. Code sample: <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var result =<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (Business.ProductEdit)Activator.CreateInstance(typeof(Business.ProductEdit), true);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i>&nbsp; //&nbsp; data access code omitted for clarity </i><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using (BypassPropertyChecks(result))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // <i>set properties here acts like LoadProperty</i><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result.Id = dr.GetString("Id");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result.Name = dr.GetString("Name");<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>/jonnybee<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong replied on Monday, June 22, 2009</h2><P>I know about the BypassPropertyChecks, but with readonly businessobjects that isn't enough. Then u'll have to create an constructor with parameters which results into 2 differend ways and our monkeys see two differend bananas..</P>
<P>Just using 1 way: LoadProperty<BR><BR>And even with using reflection it still requires a property setter.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Monday, June 22, 2009</h2>Hi,<br><br>You could create a internal Set method that uses LoadProperty on a ReadOnly object. <br>(and if your ObjectFactory is in another assembly - use the "InternalsVisibleTo" attribute to make it a friend assembly).<br><br>/jonny<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong replied on Monday, June 22, 2009</h2><P>Thanks jonny,</P>
<P>They are all posibilities, but we decided to use the LoadProperty methods from within the ObjectFactory, just missing the less-strict LoadProperty method described as above. Every new version of Csla i just copy paste it in the Csla code.</P>
<P>Greetings,<BR>Raymond de Jong</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong replied on Friday, July 17, 2009</h2>Can this be put on the wish list or shall i implement this in our own layer?<BR><BR>I&nbsp;did&nbsp;forgot this after upgrading to 3.7 it and i got a new "bug" work item from an TFS build agent on my name :)<BR>This is the only modification i need to make in the Csla code, maybe i should implement it on our own layer but that's just more work since i don't have access to Core.IManageProperties.<BR><BR>Anyway since the source is included in the tfs build solution it results into version numbering the Csla.dll into our own version, which is&nbsp;not really wrong, but could stay the original Csla version. Including the source also means alot of warnings, for silverlight with a reason but for WPF the C5 stuff is being our warning friend.. However, lowering the warning lvl to 0 does solve that :)<BR><BR></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, July 17, 2009</h2>I'll add this to the wish list.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
