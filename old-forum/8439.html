<html><header><title>Using One Criteria Class for differents searchs criterias in Object Lists (BussinessListBase, ReadOnlyListBase)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Using One Criteria Class for differents searchs criterias in Object Lists (BussinessListBase, ReadOnlyListBase)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8439.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>foxhard posted on Friday, January 29, 2010</h2><b>Hi,<br><br>I have a class ContactList : BusinessListBase&lt;ContactList, ContactChild&gt;.<br><br>I need get Contacts <br>- by State<br>- by Category<br>- by Country,<br>
- by City,<br>- by State and Category<br>- by State and Category and Country and City<br><br>The If I use the Criteria class..then I will need 6 Criteria Classes...one for each search criteria.<br><br>Then I think I need only one Criteria class with all search criterias that you needs...<br><br>This is a example:</b> <br><br><font color="#0000ff">enum SearchType<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp; ByState,<br>&nbsp;&nbsp;&nbsp;&nbsp; ByCategory,<br>&nbsp;&nbsp;&nbsp;&nbsp; ByCountry,<br>&nbsp;&nbsp;&nbsp;&nbsp; ByCity,<br>&nbsp;&nbsp;&nbsp;&nbsp; ByStateCategory,<br>&nbsp;&nbsp;&nbsp;&nbsp; ByStateCategoryCountryCity,<br>}<br><br>[Serializable]<br>internal class SpecialFilterCriteria: CriteriaBase<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp; Public int ContactId {Get; Set;}<br>&nbsp;&nbsp;&nbsp;&nbsp; Public int StateId {Get; Set;}<br>&nbsp;&nbsp;&nbsp;&nbsp; Public int CategoryId {Get; Set;}<br>&nbsp;&nbsp;&nbsp;&nbsp; Public int CountryId {Get; Set;}<br>&nbsp;&nbsp;&nbsp;&nbsp; Public int CityId {Get; Set;}<br>&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp; Public SearchType Kind {Get; Set;}<br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp; Public SpecialFilterCriteria(){}<br>}<br></font> 
<br><b>Then In Factory Methods region:</b><br><br><font color="#0000ff">public static ContactList GetContactsByStateId(int stateId)<br>{<br>&nbsp;&nbsp;&nbsp; return DataPortal.Fetch&lt;ContactList&gt;(new SpecialCriteria(){<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Kind=ByState,<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; StateId=stateId});<br>}<br>public static ContactList GetContactsByCategoryId(int categoryId)<br>{<br>&nbsp;&nbsp;&nbsp; return DataPortal.Fetch&lt;ContactList&gt;(new SpecialCriteria(){<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Kind=ByCategory,<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CategoryId=stateId});<br>}<br>public static ContactList GetContactsByCountryId(int countryId)<br>{<br>&nbsp;&nbsp;&nbsp; return DataPortal.Fetch&lt;ContactList&gt;(new SpecialCriteria(){<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Kind=ByCountry,<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Countryd=countryId});<br>}<br>public static ContactList GetContactsByCityId(int cityId)<br>{<br>&nbsp;&nbsp;&nbsp; return DataPortal.Fetch&lt;ContactList&gt;(new SpecialCriteria(){<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Kind=ByCity,<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CityId=cityId});<br>}<br>public static ContactList GetContactsByStateIdCategoryId(int stateId, int categoryId)<br>{<br>&nbsp;&nbsp;&nbsp; return DataPortal.Fetch&lt;ContactList&gt;(new SpecialCriteria(){<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Kind=ByStateCategory,<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; StateId=stateId,<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CategoryId=categoryId});<br>}<br>public static ContactList GetContactsByStateIdCategoryIdCountryIdCityId(int stateId,<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; int categoryId,<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; int countryId,<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; cityId)<br>{<br>&nbsp;&nbsp;&nbsp; return DataPortal.Fetch&lt;ContactList&gt;(new SpecialCriteria(){<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Kind=ByStateCategoryCountryCity,<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; StateId=stateId,<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CategoryId=categoryId,<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Countryd=countryId,<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CityId=cityId});<br>}</font><br><br><b>Then in the DataAccess region, you have only one DataPortal_Fetch() using switch for differents types of searches.</b><br><br><font color="#0000ff">private void DataPortal_Fetch(SpecialFilterCriteria criteria)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp; //....code...<br>&nbsp;&nbsp;&nbsp; switch(criteria.Kind)<br>&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case </font><font color="#0000ff">ByState:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Code to get data from database with specific filter.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br>&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; case ByCategory:<br></font><font color="#0000ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Code to get data from database with specific filter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br></font><font color="#0000ff">
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case ByCountry:<br></font><font color="#0000ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Code to get data from database with specific filter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br></font><font color="#0000ff">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case ByCity:<br></font><font color="#0000ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Code to get data from database with specific filter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br></font><font color="#0000ff">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ByStateCategory:<br></font><font color="#0000ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Code to get data from database with specific filter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br></font><font color="#0000ff">
&nbsp; &nbsp;&nbsp; &nbsp; ByStateCategoryCountryCity:<br></font><font color="#0000ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Code to get data from database with specific filter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br>&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; //....more code...<br>}</font><br><br><b>What do you thing about that?....is it good, bad, more or less, not recommended???...why???<br><br>Thanks,<br>Cristhiam</b><br><br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ballistic replied on Friday, January 29, 2010</h2>Personally, I would create the 6 different criteria classes and only have the fields each one needed.&nbsp; It's really not that much more code.<br><br>Having said that, I like the solution you came up with.&nbsp; I have come across similar situations where I needed to pull from the same data source, just vary the criteria.&nbsp; Had I come up with your solution, I would have used it :)<br><br>&nbsp;- Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, January 29, 2010</h2>Don't think there's anything wrong with your approach, and I've done similar things in the past.&nbsp; If you have rules (like if you specify the Kind is State, and you want to require state) you should create a BB subclass which acts as the criteria.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xAvailx replied on Friday, January 29, 2010</h2>Why don't you make the criteria public and just have one factory method that takes in the criteria with the settings from the consumer?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>foxhard replied on Friday, January 29, 2010</h2><b><span id="result_box" class="short_text"><span>I have thought about doing something like this</span></span></b>:<br><br><b>Now I have added a new Criteria Class...look at the code:</b><br><font color="#0000ff"><br>public enum SearchType<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp; ByState,<br>&nbsp;&nbsp;&nbsp;&nbsp; ByCategory,<br>&nbsp;&nbsp;&nbsp;&nbsp; ByCountry,<br>&nbsp;&nbsp;&nbsp;&nbsp; ByCity,<br>&nbsp;&nbsp;&nbsp;&nbsp; ByStateCategory,<br>&nbsp;&nbsp;&nbsp;&nbsp; ByStateCategoryCountryCity,<br>}<br><br>[Serializable]<br>public class SpecialFilterCriteria: CriteriaBase<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp; Public int ContactId {Get; Set;}<br>&nbsp;&nbsp;&nbsp;&nbsp; Public int StateId {Get; Set;}<br>&nbsp;&nbsp;&nbsp;&nbsp; Public int CategoryId {Get; Set;}<br>&nbsp;&nbsp;&nbsp;&nbsp; Public int CountryId {Get; Set;}<br>&nbsp;&nbsp;&nbsp;&nbsp; Public int CityId {Get; Set;}<br> <br>&nbsp;&nbsp;&nbsp;&nbsp; Public SpecialFilterCriteria(){}<br>}<br><br></font><font color="#0000ff">[Serializable]<br>private class MainCriteria: CriteriaBase<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp; Public SpecialCriteria Criteria </font><font color="#0000ff">{Get; private Set;}</font><br>&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000ff">Public SearchType Kind </font><font color="#0000ff">{Get; private Set;}</font><br><font color="#0000ff"><br>&nbsp;&nbsp;&nbsp;&nbsp; Public SpecialFilterCriteria(SpecialCriteria criteria, SearchType kind)<br>&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; this.Criteria = criteria;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; this.Kind = kind; &nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp; }<br>}<br>
</font><br><b>Then In Factory Methods region:</b><br><br><font color="#0000ff">public static ContactList GetContacts(SpecialFilterCriteria criteria, SearchType searchType)<br>{<br>&nbsp;&nbsp;&nbsp; return DataPortal.Fetch&lt;ContactList&gt;(new MainCriteria(criteria, searchType));<br>}<br></font><br><b>Then in the DataAccess region, you have only one DataPortal_Fetch() using switch for differents types of searches.</b><br><br><font color="#0000ff">private void DataPortal_Fetch(MainCriteria mainCriteria)<br>{<br>&nbsp;&nbsp;&nbsp;&nbsp; //....code...<br>&nbsp;&nbsp;&nbsp; switch(mainCriteria.Kind)<br>&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case </font><font color="#0000ff">ByState:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Code to get data from database with specific filter. <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br>&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; case ByCategory:<br></font><font color="#0000ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Code to get data from database with specific filter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br></font><font color="#0000ff">
&nbsp;&nbsp; &nbsp; &nbsp;&nbsp; case ByCountry:<br></font><font color="#0000ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Code to get data from database with specific filter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br></font><font color="#0000ff">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; case ByCity:<br></font><font color="#0000ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Code to get data from database with specific filter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br></font><font color="#0000ff">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ByStateCategory:<br></font><font color="#0000ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Code to get data from database with specific filter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br></font><font color="#0000ff">
&nbsp; &nbsp;&nbsp; &nbsp; ByStateCategoryCountryCity:<br></font><font color="#0000ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Code to get data from database with specific filter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br>&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; //....more code...<br>}</font><br><br><b>What do you think about that?</b><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, February 01, 2010</h2><P>I'd get rid of the private criteria class, and move the kind property to the public one.&nbsp; I'd also probably change it to inherit BusinessBase, so I can attach rules which take Kind into account (so if you choose state it requires a value for state).</P>
<P>But that's me and I don't think you're off base at all.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xAvailx replied on Monday, February 01, 2010</h2>I think here we get to personal preference...for example I would probably only have one criteria, I don't see the benefit of passing in two criteria classes, but then again I don't know your requirements. </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>am_fusion replied on Tuesday, February 02, 2010</h2><P>As was previously stated by others, I think your approach is fine.&nbsp; I, however, do not like the switch code.&nbsp; It is a little 'smelly'&nbsp; considering that every new filter will grow the switch statement.&nbsp; Eventually you may end up with a&nbsp;DataPortal_Fetch where you&nbsp;won't be able to see the begining from the end (a sign that the method has gotten too large).&nbsp; Also, this design may lead to duplicate code within&nbsp;each of the&nbsp;case segments.&nbsp;&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
