<html><header><title>Deleting value in a databound DataGridViewTextBoxColumn sets bound member to 'Nothing'</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Deleting value in a databound DataGridViewTextBoxColumn sets bound member to 'Nothing'</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1330.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>stefan posted on Tuesday, September 26, 2006</h2>Hi,<br><br>I have bound a child collection (BusinessListBase) to a DataGridView-control, allowing inline-editing.<br>I get a SqlException when I try to edit a string member of one child inside the datagrid. Selecting the field and pressing 'Del' or reducing the string length using the backspace key have the same effect: Databinding sets the bound object-member to 'Nothing', instead of&nbsp; setting it to a 'zerolength-string', as I would expect (and as 'normal' textboxes do). My stored procedure then cannot handle this, as it expects an non-null parameter.<br><br>I'm feeling a little stupid asking this, as I am just using a standard databinding approach. <br>(It must be simple!)<br><br>Do I really need to step into CellValidating?<br><br>Any hint would be greatly appreciated!<br><br>Stefan<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rgreen replied on Monday, October 02, 2006</h2><P>Do you have code in your setter to handle null values?&nbsp; The following code sample comes from Lhotka's CSLA sample application in the project.cs file.</P>
<P>&nbsp;&nbsp;&nbsp; public string Name<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...</P>
<P>&nbsp;&nbsp;&nbsp; (System.Runtime.CompilerServices.MethodImplOptions.NoInlining)]<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CanWriteProperty(true);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <STRONG>if (value == null) value = string.Empty;<BR></STRONG>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_name != value)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _name = value;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, October 02, 2006</h2><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>rgreen:</strong></div><div>if (value == null) value = string.Empty;</div></BLOCKQUOTE><br><br>This can be simplified a bit in .Net 2.0.<br><br>value ?? ""; // is equivolent to if (value == null) value = string.Empty;<br><br>HTH<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Mark replied on Monday, October 02, 2006</h2><P>It would actually be...</P>
<P>value = value ?? String.Empty;&nbsp; // or "", whichever you prefer</P>
<P>I'm not sure I'd be in favor of the above code, though, because it will always result in a new string being assigned to "value", even when it's not necessary.&nbsp;&nbsp;Since strings are immutable, you'll end up&nbsp;with a little extra memory usage as the new string is allocated and the old string is disposed of.&nbsp; You're probably not talking about a lot of extra memory usage with this code, but thought I'd mention it.&nbsp; </P>
<P>For what it's worth...</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, October 03, 2006</h2>Ya, forgot the assignment part.<br><br>Its true that strings are immutable, but we aren't changing the string, we are doing a reference assignment.<br><br>Try this in a console application.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000ff">string </font>x, y;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; x = <font color="#ff0000">" My string"</font>;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; y = x;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#008000">Console</font>.WriteLine( <font color="#0000ff">object</font>.ReferenceEquals( x, y ) );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#008000">Console</font>.ReadLine();<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
