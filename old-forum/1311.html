<html><header><title>Proposal for Lists (ReadOnly and BusinessList)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Proposal for Lists (ReadOnly and BusinessList)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1311.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fabio posted on Saturday, September 23, 2006</h2>Hi.<br><i><b>Fact:</b></i> I like to work with ObjectBinding using BindingSource.<br><br><i><b>Actual scenario:</b></i><br>Our lists are inherited from BindingList and BindingList have public properties (getter <b>and setter</b>):<br>AllowNew, AllowEdit, AllowRemove.<br>Unfortunally BindingList don't use internally it's properties to know if an item can be added, removed or edited.<br><br>BusinessListBase and ReadOnlyBindingList are inherited from Core.ExtendedBindingList<br><br>ReadOnlyBindingList&nbsp; have IsReadOnly property with public getter <b>and setter</b> .<br>
<br>
Chapter 7 explain how use public static method for authorization in List.<br>
<br>From UI BindingSource have <b>setter</b> only for AllowNew. Navigators and other component use the BindingSource properties to know what are allowed.<br><br><i><b>Proposal:<br></b></i>To protect the lists and improve the capability to use BindingSource i think we can use the <i>new modifier </i>for the properties AllowNew, AllowEdit, AllowRemove in the Core.ExtendedBindingList.<br>For example:<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <font color="#0000ff">public new bool</font> AllowNew<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <font color="#0000ff">get </font>{ <font color="#0000ff">return base</font>.AllowNew; }<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <font color="#0000ff">protected set</font> { <font color="#0000ff">base</font>.AllowNew = <font color="#0000ff">value</font>;}<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>Similar for the others properties.<br><br>In the <b>Initialize() </b>of our list we can put the code for properlly set the properties AllowNew, AllowEdit, AllowRemove (using Authorization for example).<br><br>Using new modifier we can have (on the fly):<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; private bool _allowGetItem = true;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public new T this[int index]<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; get<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (!_allowGetItem) <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; throw new Exception("Can't Getobj");<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return base.Items[index];<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; set<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (!base.AllowEdit)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; throw new Exception("Can't Setobj");<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; base.SetItem(index, value);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br><br><i><b>Result:<br></b></i>ObjectBindig work better.<br>ReadOnlyList don't have the "strange" behaviour, at run time, if you  set AllowRemove or AllowNew (intent to set AllowNew cause a compile error).<br>Existing code still working (... so and so... depend on what somebody doing with it's own list... for example for me cause a little problem but ...)<br>Rocky can add some standard AuthorizationRule for collection too.<br><br>Any suggestion ?<br><br>Bye.<br>Fabio<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Saturday, September 23, 2006</h2>I believe those properties are there so that databound controls know whether to allow those actions or not, but they don't limit what you actually can do with the list in code.<br>If you need to fully lock the list, you could use the read only list,
and set IsReadOnly = true when appropiate. That won't actually stop you
from editing the items, just adding / removing. To enable/disable
editing of the items, you need to implement something in your actual
items.<br>You could easily do that by creating a class that inherits from businessbase and overriding CanReadProperty and CanWriteProperty and returning false there if IsReadonly = True. Is readonly could be automatically changed in the items when you set IsReadonly= true in the collection.<br><br>Both editable and readonly collections inherit from ExtendedBindingList. ExtendedBindingList only adds a RemovingItem event that the standard BindingList doesn't have. (And no, ListChanged can't be used to know which item is being removed.)<br><br>The locking of getting items sounds interesting... Where would you use it and why?<br>Even if something like that doesn't make it into the framework, you could just implement that in your own base class and inherit your BOs from that (I know I'm just stating the obvious).<br><br><br>Andr√©s</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fabio replied on Sunday, September 24, 2006</h2>Hola Andres... cuando vamos a tomar esa cerveza?<br>Well... now something serious..<br><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>xal:</strong></div><div><br>Even if something like that doesn't make it into the framework, you could just implement that in your own base class and inherit your BOs from that (I know I'm just stating the obvious).<br></div></BLOCKQUOTE><br>Yes... you know that i have something like 3 class before a concrete BO...<br><br><b>To the point:<br></b>Suppose that you are a freelancer and that you don't know who, when and for what somebody use the BO you have implement. Now suppose that I'm a user of your BO.<br>I had see a class on your assembly and i think i can use that class for something (note: i use PTracker and I know PT is only an example). <br>Like user of your class i can write this code:<br><font size="2">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ProjectTracker.Library.ResourceList rl = ProjectTracker.Library.ResourceList.GetResourceList();<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rl.AllowEdit = true;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rl.AllowNew = true;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; rl.AllowRemove = true;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ProjectTracker.Library.ResourceInfo ri = rl.AddNew();<br></font>I can copile the code and, at run time, i recive an exception for AddNew.<br>So, IsReadOnly is protected but the other properties are some confused.... i can't set IsReadOnly but i can set AllowRemove and so on.<br>For Binding matter I, like user of your class, can set AllowEdit, and so on, and if I use an ObjectBinding navigator the buttons for adding, removing and editing a BO are enabled... this mean that you give me the option to have a "hunts the joker" effect in the front-end.<br><i>"hunts the joker" mean that the operator (user of the application) can click the add button and the action send him the message "you can't add!!".</i><br>These matters are only for preventing, an improper use of BO, at copile-time.<br><br>If you look on chapter 7 you can find <br><b><font size="2">public static bool CanAddObject()</font></b><br>All "public static" method, mean that the user of your class can't use a BindingSource directly but he need prevent "hunts the joker" using specific methods... (you are optimistic, and your user must write some more code). Remember that the <i>AddNew</i> method is public in the BindingList and you can write a BoEditableList overriding <i>AddNewCore</i> and the user (user of your class) can use a BindingSource with Navigator and a grid (for example) without write "special" code to add new item.<br><br><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>xal:</strong></div><div><br>
The locking of getting items sounds interesting... Where would you use it and why?<br>
</div></BLOCKQUOTE><br>
<br>I think that we can prevent something using the <i>new modifier </i>and, the implementation, can enable Rocky ("the Rock") to give us a standard <i>per type rules</i> for collection too (without the necessity to use static methods)<i> </i>for all BOLists<i>.<br></i><br>I would like to have something more, like a IAuthorizationProvider and IBrokenRuleProvider to inject (by config or an IoC FW ;) ) a class to read Authorization and Rules from XML, DB and so on.... but this is another matter (step-by-step).<br><br>Bye<br>Fabio.<br><br>P.S. When i have an idea i post it, then <i>the Rock </i>maximize it.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
