<html><header><title>Strange databound combo box behaviour</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Strange databound combo box behaviour</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1662.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>gajit posted on Wednesday, November 01, 2006</h2>I have a problem that I'm sure I've come across before and worked around it, but for the life of me cannot figure out what the problem is.<br><br>I have a windows form with a number of textboxes and a couple of combo boxes. All the textboxes are bound to my BO (businessbase) as are the comboboxes advanced databinding properties. The datasource for the 2 comboboxes are bound to a NameValueList and a ReadOnlyListBase respectively.<br><br>I am also using a bindingsourcerefresh and Errorprovider on my form.<br><br>My problem appears to be with the NameValueList source.<br><br>When the form initially loads. The dropdownlist has a value in it (the first in the list). I have a number of brokenrules on my form by default, but as soon as I correct one of them ( value in a text box), and navigate off of the control, the dropdownlist value disappears.<br><br>I also never receive a error icon against the control when it is empty - I don't know if that's normal behaviour or not, even though I have a validation rule (stringrequired).<br><br>Any ideas?<br><br>Thanks,<br>Gaj.<br><br><br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Thursday, November 02, 2006</h2>Are the comboboxes bound to your BO with their SelectedValue/SelectedIndex?<br><br>I had this issue when my BO had a Guid.Empty by default, but in my namevaluelist there was no corresponding entry .... <br><br><br>Bayu</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>gajit replied on Thursday, November 02, 2006</h2>The combobox SelectedValue is where I have my binding to the BO.<br><br>So, to clarify...<br><br>combobox.Datasource = BranchListBindingSource (NameValueList)<br>combobox.DisplayMember = "Key"<br>combobox.ValueMember = "Key"<br>combobox.Databindings.SelectedValue = Customer_BindingSource - BRANCH <br><br>There doesn't appear to be anything wrong...<br>By default, the BRANCH column on the BO will be empty... could this be the problem? And the combobox. because it is a DropdownList type HAS to have a value in it? If so, I'm still not understanding why the errorprovider icon doesn't dispay next to the control if the validationrule is broken...<br><br>Any help would be appreciated.<br><br>Thanks,<br>Gaj.<br><br><br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, November 02, 2006</h2>What does your property get / set look like?&nbsp; Are you sure you're storing the value in the proper field?&nbsp; Are you sure the property is not bound to another control on the form?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>gajit replied on Thursday, November 02, 2006</h2>Hey ajj..<br><br>Fixed it I believe... or least found the workaround...<br><br>Everything looks good in the property Sets/Gets - and no other controls on the form bind to the BRANCH column.<br><br>HOWEVER, I have found the reason for no error provider - I didn't have my validationrule in place. Soooo, I have added this, and it appeared to give a little more understanding to what is happening.<br><br>I would have expected that the bo.BRANCH&nbsp; column would be updated by whatever item is currently set in the combobox, or that the combobox would display an empty value. But it appears that the first combobx entry was being displayed, but not actually binding it's value to the BO...<br><br>When the form was being opened, I was instantiating my BO binding in the New() method and the combobox datasource in the _Load event...<br><br>I moved the combobox datasource instantiate into the New() method BEFORE the BO instantiate and it appears to work fine.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.BranchListBindingSource.DataSource = BranchList.GetList<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.CustomerBindingSource.DataSource = mCustomer<br><br>Not sure WHY this would have an impact, but I'm happy... (for now...)<br><br>Thanks,<br>Gaj.<br><br><br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, November 02, 2006</h2>Ahh, I think what was happening is that you assigned the BO to the binding source, the assign the list to its binding source... which causes the combo to load, which causes a list changed event, which may or may not be putting the value into the BO.&nbsp; Then things get out of sync.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Devi replied on Monday, March 31, 2008</h2><P>I am using the version 2.1.4</P>
<P>I&nbsp;have a combobox in an editable grid..&nbsp;Its datasourse property is set&nbsp;to a NamevalueListBase class and DispalyMember, ValueMember are also&nbsp;set..And Its selecetedValue property is bind to tthe CourseID in the BusinessObject Course. In the UI, i use like these.. bindingSourseCourse.Datasourse = CourseNVL();</P>
<P>// I set the DataSourse&nbsp;of&nbsp; bindingSourseCourse as&nbsp;CourseNVL in the design.</P>
<P>bt while opening this form, i get an error in the combobox like this..</P>
<P>"DataGridView DefaultError Dialog</P>
<P>System.ArguementException : DataGridViewComboboxCell value is not valid.</P>
<P>To replace this default Dialog please handle the DataError event"</P>
<P>But when i initialize value for the CourdeID in the BO, it works properly.. But i want to set the Combobox null while loading the form.. </P>
<P>How can i do that...</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Thursday, November 02, 2006</h2><BLOCKQUOTE><div><img src="/Themes/alternate1/images/icon-quote.gif"> <strong>gajit:</strong></div><div><br><br>By default, the BRANCH column on the BO will be empty... could this be the problem? And the combobox. because it is a DropdownList type HAS to have a value in it? If so, I'm still not understanding why the errorprovider icon doesn't dispay next to the control if the validationrule is broken...<br><br></div></BLOCKQUOTE><br><br>This could definitely be the problem. I am not saying it actually <i>is</i>, but this greatly resembles the issue I faced with my default Guid.Empty value that did not have an entry in my NVL. I guess the error provider is not shown because there is not really an error ..... you just set up your UI in a inconvenient way such that you cannot edit the BRANCH as you like. <br><br>On my NVLs I tend to make a shared GetDefaultValueID property as follows (example taken from a StatusNVL):<br><br>&nbsp;&nbsp;&nbsp; Public Shared Function GetDefaultStatusID() As Integer<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim list As StatusNVL = GetList()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If list.Count &gt; 0 Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return list.Items(0).Key<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Throw New NullReferenceException("No statuses available; default Status can not be returned")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp; End Function<br><br>This function is sued in the dp_create of my BOs to initialize a status-id.<br><br>Bayu<br><br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
