<html><header><title>Subclassing Csla Classes</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Subclassing Csla Classes</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/682.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav posted on Thursday, July 20, 2006</h2><P>Here is one way to subclass a Csla class that seems to work.<BR>Class Base_Class is a Root class inherited from Csla.BusinessBase.&nbsp; Class Sub_Class is inherited from Base_Class.</P>
<P>In Base_Class:</P>
<P>1. Make the Criteria class Protected so it can be used from Sub_Class<BR>2. In DataAccess section, separate almost all of the DataPortal_Create code into a new Method:</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Protected Sub CreateObject(param1, param2........)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End Sub</P>
<P>3. Change the DataPortal_Create method to</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Protected Overrides Sub DataPortal_Create(ByVal Criteria As Object)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim crit As Criteria = CType(Criteria, Criteria)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CreateObject(crit.param1, crit.param2 ............)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End Sub</P>
<P>4. Do the same thing with the DataPortal_Fetch by separating the implementaition code into a Protected FetchObject method.</P>
<P>In Sub_Class:</P>
<P>1. No Criteria class is created.&nbsp; We will use the Protected Criteria class of the Base_Class<BR>2. Create your Factory methods as necessary in the same way as we do.&nbsp;<BR>3. In DataAccess section, the DataPortal_Create and DataPortal_Fetch will read the same as in the Base_Class above.&nbsp; The only difference will be if you need to initialize some additional variables in the Sub_Class.</P>
<P>Since it is the BaseClass that is totally&nbsp;in-charge of all data, we do not need to do anything to the Save method or to the Insert, Update, Delete methods.&nbsp; Sub_Class will only access the Base_Class data through the Base_Class Properties, Base_Class Instance Variables will remain Private.&nbsp; Sensitive data in Base_Class can be shielded by making the Properties of that data Protected and not offering Public access in the Sub_Class.&nbsp; One can create multiple Sub_Classes on top of the same Base_Class&nbsp;to handle different situations.&nbsp; One can even place these Sub_Classes in different Assemblies, further customizing the access.</P>
<P>Jav</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>malloc1024 replied on Thursday, July 20, 2006</h2>Thanks for sharing.&nbsp; This should be in a "sticky" so it doesn't get lost in this forum.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tom Cooley replied on Thursday, July 20, 2006</h2>Correct me if I'm wrong, but having the Criteria in the base class will result in the DataPortal creating the base class - not the sub class. The DataPortal.Create method uses reflection on the Criteria class to determine its parent class (the one it's nested inside of). In this case, it is the base class.<br><br>To accomplish your intent, you need the Criteria class to inherit from Core.CriteriaBase.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mr_lasseter replied on Thursday, July 20, 2006</h2>Could you please provide an example of doing so?&nbsp; I have been struggling with this for some time.&nbsp; Thanks.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Thursday, July 20, 2006</h2><P>Tom,</P>
<P>You are correct up to a point (see below).&nbsp; I am using the following call in my SubClass</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return Csla.DataPortal.Create(<STRONG>Of&nbsp; MySubClass</STRONG>)(New Criteria(param1, param2......))</P>
<P>When I walk it through to the DataPortal Module into the function </P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Public Function Create(Of T)(ByVal criteria As Object) As T</P>
<P>the type of T (which in my case is MySubClass)&nbsp;is used to create the object.</P>
<P>Initially there were two reason why I decided to eliminate the Criteria from SubClass:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. I was trying to directly call the DataPortal_xxx of the BaseClass, and the type mismatch of Criteria class was a problem.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2. I thought the two criteria classes will be confusing</P>
<P>Now that I am taking the parameters from the Criteria class in the SubClass and passing them straight to a separate Method, the first reason shouldn't apply.&nbsp; But I decided to continue with a single Criteria class.</P>
<P>Now if you did make your call as follows:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return Csla.DataPortal.Create(New Criteria(param1, param2......))</P>
<P>then you will need to include the criteria class of the SubClass, and I expect it will work too.</P>
<P>I must add that this project only began this morning.&nbsp; So far in one object hierarchy that I am testing it with it seems to be working correctly.&nbsp; If there are other repurcussions, only time will tell.<img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /></P>
<P>Jav</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
