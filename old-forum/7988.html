<html><header><title>Getting object properties through the CslaDataProvider control</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Getting object properties through the CslaDataProvider control</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7988.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>russelle posted on Thursday, November 12, 2009</h2>I am instantiating a business object through the CslaDataProvider control. How do you then reference the properties of the object in C# code? Most of my WPF controls bind directly to the object, and they work fine, but there are a few I need to set manually, but I can't seem to find a way to reference these properties.<br /><br />Here's some code:<br /><br />private Csla.Wpf.CslaDataProvider _dpHousehold;<br /><br />_dpHousehold = this.FindResource("Household") as Csla.Wpf.CslaDataProvider;<br /><br />using (_dpHousehold.DeferRefresh())<br />                {<br />                    _dpHousehold.FactoryParameters.Clear();<br />                    _dpHousehold.FactoryMethod = "GetHousehold";<br />                    _dpHousehold.FactoryParameters.Add((int)comboBoxSearchResults.SelectedValue);<br />                    _dpHousehold.Refresh();<br />                }<br /><br />At this point I'd like to reference a property like _dpHousehold.AddressLine1 but haven't found a syntax to do so.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>richardb replied on Friday, November 13, 2009</h2><P>Try this maybe (VB.Net I'm afraid :-)</P>
<P>CType(_dpHousehold.Data, HouseHold).Addressline1</P>
<P>of course you might want to cast it first and put some checking in to make sure there is something in the _dphousehold.Data property and that it is of the right type.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, November 13, 2009</h2><P>The data provider exposes the business object via its Data property.</P>
<P>So once you get the data provider reference, you can get at the object:</P>
<P>var dp = Resources["MyDataProvider"] as CslaDataProvider;<BR>if (dp != null)<BR>{<BR>&nbsp; var&nbsp;cust = dp.Data as Customer;<BR>&nbsp; if (cust != null)<BR>&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;cust.Name = "Rocky";<BR>&nbsp; }<BR>}</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>russelle replied on Friday, November 13, 2009</h2>Thanks, Rocky. Hope we see you back in Denver again soon!<br />Regards,<br />Russell</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
