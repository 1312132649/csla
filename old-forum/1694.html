<html><header><title>CSLA 2.1 New Validation Rule Handler</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA 2.1 New Validation Rule Handler</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1694.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Vinodonly posted on Monday, November 06, 2006</h2><P>I'm having my validation rule handler with following signature</P>
<P><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> OrderCfmDtChk(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Order)(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> target </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> T, _</P>
<P></FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Validation.RuleArgs) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean</FONT></P>
<P><FONT color=#0000ff size=2>here the&nbsp;e parameter is also a subclass of RuleArgs and thus provides additional parameter, </FONT><FONT color=#0000ff size=2>I'm trying to add this rule with following line but is giving a compile time error :-</FONT></P><FONT size=2>
<P>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> Order)(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> OrderCfmDtChk(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> Order), _</P>
<P></FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> DaysValueRuleArgs(</FONT><FONT color=#800000 size=2>"OrderCfmDt"</FONT><FONT size=2>, 7))</FONT></P>
<P><FONT size=2></FONT>&nbsp;</P>
<P><FONT size=2>Can anybody help in this..</FONT></P>
<P><FONT color=#0000ff size=2>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Vinodonly replied on Tuesday, November 07, 2006</h2><P>can anybody help on this.</P>
<P>If i don't use the custom RuleArgs then below given line is working fine, and is performing validation also.</P><FONT size=2>
<P>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> Order)(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> OrderCfmDtChk(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> Order), </FONT><FONT color=#800000 size=2>"OrderCfmDt"</FONT><FONT size=2>)</FONT></P>
<P><FONT size=2>but in this case i have to hard code value inside the validator, whereas i want to pass additional parameters through custom Rule Args as specified in my initial post.</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, November 07, 2006</h2>You need to create your own subclass of RuleArgs and have your function accept that.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Vinodonly replied on Tuesday, November 07, 2006</h2><P>Kindly note i have done that and this is the method signature for the same </P>
<P>&nbsp;</P>
<P><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> OrderCfmDtChk(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Order)(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> target </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> T, _</P>
<P></FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Validation.RuleArgs) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean</FONT></P>
<P><FONT color=#0000ff size=2></FONT>&nbsp;</P>
<P><FONT color=#0000ff size=2>But when i use following line to add this rule, it is giving compile timer error :-</FONT></P>
<P><FONT color=#0000ff size=2></FONT>&nbsp;</P>
<P><FONT size=2> </FONT></P>
<P>ValidationRules.AddRule(<FONT color=#0000ff size=2>Of</FONT><FONT size=2> Order)(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> OrderCfmDtChk(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> Order), _</P>
<P></FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> DaysValueRuleArgs(</FONT><FONT color=#800000 size=2>"OrderCfmDt"</FONT><FONT size=2>, 7))</FONT></P>
<P><FONT size=2></FONT>&nbsp;</P>
<P><FONT size=2>Can you pls help me in telling what&nbsp;code i should exactly write so this rule can be added. </FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Vinodonly replied on Tuesday, November 07, 2006</h2><P>Further to my previous message, this is the custom Rule Args class, Validation rule handler converts the passed e parameter to this class by using following code <FONT size=2></P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>Dim</FONT><FONT color=#000000 size=2> Days </FONT><FONT color=#0000ff size=2>As</FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT color=#000000 size=2> = </FONT><FONT color=#0000ff size=2>CType</FONT><FONT size=2><FONT color=#000000>(e, DaysValueRuleArgs).Days</FONT></FONT></P>
<P><FONT size=2><FONT color=#000000></FONT></FONT>&nbsp;</P>
<P><FONT size=2>&nbsp;</P></FONT></FONT><FONT color=#0000ff size=2></FONT>
<P><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> DaysValueRuleArgs</P>
<P></FONT><FONT color=#0000ff size=2>Inherits</FONT><FONT size=2> Csla.Validation.RuleArgs</P>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> mDays </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>ReadOnly</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</FONT><FONT size=2> Days() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Get</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> mDays</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Get</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> propertyName </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> Days </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2>MyBase</FONT><FONT size=2>.New(propertyName)</P>
<P>mDays = Days</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> ToString() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>MyBase</FONT><FONT size=2>.ToString &amp; </FONT><FONT color=#800000 size=2>"?Days="</FONT><FONT size=2> &amp; mDays.ToString</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, November 07, 2006</h2>You need to use the AddRule(Of T, R)() overload, so you can specify the type of both the target and arguments parameters.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Vinodonly replied on Wednesday, November 08, 2006</h2><P>please excuse me for nagging so much for this problem but i'm still not able to get rid of compiler errors. can u pls help me in advising what is the exact line to write through which this rule can be added, pls help</P>
<P>Here is the summary of my previous posts.</P>
<P>Custom Rules Args :- <FONT size=2>DaysValueRuleArgs</FONT></P>
<P><FONT size=2>Validation routine :- OrderCfmDtChk (Signature was given in my previous post)</FONT></P>
<P><FONT size=2></FONT>&nbsp;</P>
<P><FONT size=2>I'm writing following line currently and it is giving compile time error :-</FONT></P>
<P><FONT size=2></FONT>&nbsp;</P>
<P>ValidationRules.AddRule(<FONT color=#0000ff size=2>Of</FONT><FONT size=2> Order)(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> OrderCfmDtChk(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> Order), _</P>
<P></FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> DaysValueRuleArgs(</FONT><FONT color=#800000 size=2>"OrderCfmDt"</FONT><FONT size=2>, 7))</FONT></P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, November 08, 2006</h2>From Rocky's comments, I think you need<br><br>ValidationRules.AddRule( Of Order, Of DayValueRuleArgs )<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Vinodonly replied on Wednesday, November 08, 2006</h2>Finally it is working but i had to do major changes. I'm pasting&nbsp;main points here. Please Refer to <FONT size=2>
<P>MaxValue and&nbsp; <FONT size=2>MaxValueRuleArgs for more info </FONT></P>
<P><FONT size=2>This is the AddRule line :-</FONT></P><FONT size=2><FONT size=2>
<P>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> OrderCfmDtChk(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2>), _</P>
<P></FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> DaysValueRuleArgs(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2>)(</FONT><FONT color=#800000 size=2>"OrderCfmDt"</FONT><FONT size=2>, 7))</FONT></P>
<P><FONT size=2>Here is the validator signature and few important lines of code to retreive property value &amp; parameter value :-</FONT></P>
<P><FONT size=2></FONT>&nbsp;</P><FONT size=2><FONT color=#0000ff size=2>
<P>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> OrderCfmDtChk(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IComparable)(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> target </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, _</P>
<P></FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Validation.RuleArgs) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> PropValue </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#0000ff size=2>CStr</FONT><FONT size=2>(CallByName(target, e.PropertyName, CallType.Get))</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> Days </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2> = </FONT><FONT color=#0000ff size=2>DirectCast</FONT><FONT size=2>(e, DaysValueRuleArgs(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2>)).Days</FONT></P>
<P><FONT size=2></FONT>&nbsp;</P>
<P>&amp; Finally here is the custom rule args and it's new constructor </P><FONT color=#0000ff size=2>
<P>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> DaysValueRuleArgs(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T)</P></FONT>
<P>........</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> propertyName </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> Days </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2>)</P></FONT>
<P><FONT size=2></FONT>&nbsp;</P>
<P><FONT size=2>I hope this will help if somebody else is trying this... </P></FONT></FONT></FONT></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
