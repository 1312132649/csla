<html><header><title>Configuration files location &amp; accessibility</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Configuration files location &amp; accessibility</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/139.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>marioe2000 posted on Thursday, May 18, 2006</h2><P class=MsoNormal><SPAN>I just got my hands on Lhotka’s VB.NET Business Objects book last weekend and have been living off of it for that last few days (well not true, I did have a little food and some water last night but only because my wife made me do it). <o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>I had been struggling for a few weeks trying to construct a very basic class hierarchy to support an OO business model implementation and while researching how to build that I stumbled upon the CSLA on the net. Thank you Rockford Lhotka for sharing your experience and allowing a .NET newbie like me to become productive faster while not sacrificing Object Orientation. I’m currently re-writing my BO’s to use the CSLA and have come to a question I can’t find a clear answer in the book or the forums.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>I cannot figure out how the configuration files work in a distributed environment where we have different physical tiers for the client and the data server. I fully understand the concept of a .NET object flying across the network from the data portal to the UI and then back again. But my question is where does the .config files go? Must they get deployed to both physical tiers? Is clear to me that the BO can easily find the .config while it’s code runs on the client, but when the BO is running on the server (for a db related process) how does it know where to look for the .config file? Where does it look for it? In the same location as the .dll containing the code for the BO? I’m guessing that’s where is supposed to go but I want to be sure of it and what goes on backstage.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Mario Estrella</SPAN><SPAN><o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>CIMSA Logistics<o:p></o:p></SPAN></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Skeeboe replied on Thursday, May 18, 2006</h2>It will use the web.config on the dataportal. Be sure to add the channels section below. I believe its essential for IIS6 but I'm not 100%.<br><br>&nbsp;&nbsp;&nbsp; &lt;system.runtime.remoting&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;application&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;service&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;wellknown mode="SingleCall" objectUri="DataPortal.rem" type="CSLA.Server.DataPortal, CSLA.Server.DataPortal"/&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;wellknown mode="SingleCall" objectUri="ServicedDataPortal.rem" type="CSLA.Server.ServicedDataPortal.DataPortal, CSLA.Server.ServicedDataPortal"/&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/service&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;channels&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;channel ref="http"&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;serverProviders&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;provider ref="wsdl" /&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;!-- TODO: comment the following two lines for .NET 1.0 --&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;formatter ref="soap" typeFilterLevel="Full" /&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;formatter ref="binary" typeFilterLevel="Full" /&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/serverProviders&gt;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/channel&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/channels&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;/application&gt;<br>&nbsp;&nbsp;&nbsp; &lt;/system.runtime.remoting&gt;<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>marioe2000 replied on Friday, May 19, 2006</h2><P>I'm building a winforms application so i'm guessing that the "executable.exe.config" file instead of the web.config file right?</P>
<P>Thanks</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, May 19, 2006</h2>Yes, but if you use IIS as a remoting host, you need to setup Web.Config as described above.&nbsp; If your business logic or data access code requires settings from a configuration file, they'll have to go in Web.config as well as app.exe.config.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>guyroch replied on Friday, May 19, 2006</h2><DIV>
<DIV>Getting remoting to work the first time involves a few steps.</DIV>
<DIV>&nbsp;</DIV>
<DIV>1. Create a web project and copy all CSLA assemblies into the bin directory (or add a reference to all CSLA assemblies).</DIV>
<DIV>&nbsp;</DIV>
<DIV>2. Add a web.config file to your web project and add to the following in the web.config file.</DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp; &lt;system.runtime.remoting&gt;<BR>&nbsp;&nbsp;&nbsp; &lt;application&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;service&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;wellknown mode="SingleCall" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; objectUri="WebPortal.rem" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; type=" CSLA.Server.DataPortal, CSLA.Server.DataPortal" /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/service&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;channels&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;channel ref="http"&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;serverProviders&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;provider ref="wsdl" /&gt; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;!-- TODO: comment the following two lines for .NET 1.0 --&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;formatter ref="soap" typeFilterLevel="Full" /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;formatter ref="binary" typeFilterLevel="Full" /&gt; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/serverProviders&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/channel&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/channels&gt;<BR>&nbsp;&nbsp;&nbsp; &lt;/application&gt;<BR>&nbsp; &lt;/system.runtime.remoting&gt;</DIV>
<DIV>&nbsp;</DIV>
<DIV>The objectUri="WebPortal.rem" is a logical name that you are giving to your remoting server.&nbsp; If you look closely, it points to the "CSLA.Server.DataPortal" assembly - type="CSLA.Server.DataPortal, CSLA.Server.DataPortal".</DIV>
<DIV>&nbsp;</DIV>
<DIV>3. Create a virtual directory under IIS and have it pointed to your web project directory created in step 1.&nbsp; For the purpose of this thread, I will call the virtual directory "MyRemotingTest".</DIV>
<DIV>&nbsp;</DIV>
<DIV>4. Then test that remoting is actually working by typing the following in your browser address bar.&nbsp; If you look closely you will notice the specific location of "MyRemotingTest" and " WebPortal.rem".<BR>&nbsp;<BR><A href="http://localhost/MyRemotingTest/WebPortal.rem?wsdl">http://localhost/MyRemotingTest/WebPortal.rem?wsdl</A> <BR>&nbsp;<BR>If remoting does not works, you will get a page not found error. But if it works, you should get something that starts like this.</DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp;&lt;?xml version="1.0" encoding="UTF-8" ?&gt; <BR>- &lt;definitions name="DataPortal" targetNamespace=" <A href="http://schemas.microsoft.com/clr/nsassem/CSLA.Server/">http://schemas.microsoft.com/clr/nsassem/CSLA.Server/</A><BR>&nbsp;CSLA.Server.DataPortal%2C%20Version%3D1.51.2220.312%2C%20Culture%3Dneu'<BR>&nbsp;tral%2C%20PublicKeyToken%3D8b12744985d32620" <BR>&nbsp;<BR>There is no point in doing anything else before you can established that remoting is working. So make sure you make it work before going on. <BR>&nbsp;<BR>5. Now that you have been able to confirm that remoting does work, modify your app.config file on your client and add the following.&nbsp; Notice the location of "MyRemotingTest" and "WebPortal.rem", this is very important.<BR>&nbsp;<BR>&nbsp;&lt;configuration&gt;<BR>&nbsp;&nbsp; &lt;appSettings&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;add key="Authentication" value="CSLA" /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp; &lt;add key="PortalServer" value=" <A href="http://localhost/MyRemotingTest/WebPortal.rem">http://localhost/MyRemotingTest/WebPortal.rem</A>" /&gt;<BR>&nbsp;&nbsp; &lt;/appSettings&gt;&nbsp; <BR>&lt;/configuration&gt;</DIV>
<DIV>&nbsp;</DIV>
<DIV>This should now give your client access to the server using remoting. </DIV>
<DIV>&nbsp;</DIV>
<DIV>6. For your database connection string, add the following in your web.config file.<BR>&nbsp;<BR>&nbsp;&lt;appSettings&gt; <BR>&nbsp;&nbsp; &lt;add key="Authentication" value="CSLA" /&gt;</DIV>
<DIV>&nbsp;&nbsp; &lt;!-- Security Connection String --&gt;<BR>&nbsp;&nbsp; &lt;add key="DB:Security" value="data source=(local);initial catalog=SecurityDB;user id=sa;password=p1234567;Connect Timeout=120" /&gt; </DIV>
<DIV>&nbsp;&nbsp; &lt;!-- Foundation Connection String --&gt;<BR>&nbsp;&nbsp; &lt;add key="DB:Foundation" value="data source=(local);initial catalog=FoundationDB;user id=sa;password=p1234567;Connect Timeout=120" /&gt;</DIV>
<DIV>&nbsp;&lt;/appSettings&gt;</DIV>
<DIV>Notice that the source=(local) and not localhost. The parenthesis are required. <BR>&nbsp;<BR>7. I'm using CSLA security in this example, not integrated security.&nbsp; Also, I'm not using Enterprise Services so I have not included the ServiceDataProtal in this example, just the DataPortal.</DIV>
<DIV>&nbsp;</DIV>
<DIV>THIS EXAMPLE IS FOR CSLA 1.x, not 2.0.&nbsp; But I they are not that different.</DIV>
<DIV><BR>Hope this helps</DIV>
<DIV>&nbsp;</DIV></DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>marioe2000 replied on Saturday, May 20, 2006</h2><P>WOW !!! it's amazing to get such rich feedback ... Not only is the CSLA a great framework, but it also has a great community backing it up .... </P>
<P>Thank you All ... </P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
