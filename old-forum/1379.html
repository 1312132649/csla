<html><header><title>Connection.open() on updating projectresource</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Connection.open() on updating projectresource</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1379.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ton Smeets posted on Tuesday, October 03, 2006</h2><P>Hello,</P>
<P>I'm new to CSLA. It is a very impressive framework. I bought the book after I discovered your site, and I intend to use it in developing my software. While reading the book,&nbsp;I came to the part where a ProjectResource get updated (page 441). Paging back (page 438)&nbsp;I discovered that the connection is opened by the ProjectResource, UpdateAssignment() is called, passing&nbsp;the connectionstring,&nbsp;then the commandobject is created, DoAddUpdate is called and the command is executed. In fact the insert and delete commands work the same way.</P>
<P>My question is; Could the Connection.Open() be called within DoAddUpdate() instead, by passing is the connection as a parameter.</P>
<P>Or am I missing the big picture here.</P>
<P>However, thanx for the great work.</P>
<P>Ton Smeets.</P>
<P>PS. I am from the Netherlands, and cann't&nbsp;figure out what 'leveraging' means. Please help me out here to.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JHurrell replied on Tuesday, October 03, 2006</h2>Hi Tom and welcome to CSLA.<br><br>I can answer your question about "leveraging." Leverage means to use one thing to help you with another thing. In simple terms, think of using a lever like a metal bar to help you lift something heavy.<br><br>In the context of the book, Rocky uses "leverage" to mean: take a concept or piece of code that he's  described and use it somewhere else.<br><br>- John<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ton Smeets replied on Tuesday, October 03, 2006</h2><P>Wow,</P>
<P>Thank you for responding so quickly. I thought it might mean something like that.</P>
<P>Anyway, thank you.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, October 04, 2006</h2><P>The key thing to remember when looking at Project Tracker is that it is just a sample - it is only one way to build and use BOs.</P>
<P>For Example here is what some Fetch code looks like in one of my BOs:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> DataPortal_Fetch(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> criteria </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>)<BR>&nbsp; </FONT><FONT size=2>DoFetch(criteria)<BR>&nbsp; ValidationRules.CheckRules()<BR></FONT><FONT size=2></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> DoFetch(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> criteria </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>)<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> cn </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IDbConnection<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Try<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>cn = DAL.CreateConnection<BR>&nbsp;&nbsp;&nbsp; cn.Open()<BR>&nbsp;&nbsp;&nbsp; PreFetchData(criteria, cn)<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>FetchData(criteria, cn)<BR>&nbsp;&nbsp;&nbsp; PostFetchData(criteria, cn)<BR>&nbsp;&nbsp;&nbsp; FetchChildren(criteria, cn)<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Finally<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>cn.Close()<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Try<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT>
<P>As you can see - I call a Protected Overridable Sub called DoFetch which creates the connection (using my own DAL code which creates a SQL or Oracle connection as needed), opens it and passes it as a parameter to 4 other methods which are all Protected Overridable.</P>
<P>Using this style of code, I can use Codesmith to generate a Base class.<BR>Then in my final type I can hand write code and Override any of the methods to add functionality.<BR>If I need to use the Base functionality the Overriden method will make the call to MyBase and then add whatever it needs. If I need to change it completely, I just omit the call to MyBase.</P>
<P>Hope that helps.</P>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ton Smeets replied on Wednesday, October 04, 2006</h2><P>Yes, I get the picture.</P>
<P>Reading further in Rocky's book some thing got clear to me.</P>
<P>Thank you for your response.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
