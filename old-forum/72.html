<html><header><title>Exposing Vaidation rules that could benefit the UI?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Exposing Vaidation rules that could benefit the UI?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/72.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Helen W posted on Thursday, May 11, 2006</h2><P>First, a huge thank you for an awesome business object framework. I've learned so much just by stepping through your code.</P>
<P>I would like to suggest that some validation rules for properties, e.g. the maximum length rule, could be very useful to the UI developer. Perhaps an attribute for validation rules that affect values easily set for UI controls could allow some of these validation rules to be used by the UI devleoper?</P>
<P>I like my UI to be offer immediate feedback whenever possible, and setting the maximum length that can be entered into a textbox (for example) or a regex that specifies the format for input allows me to give that feedback.</P>
<P>Just a thought.</P>
<P>Helen</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tamir replied on Thursday, May 11, 2006</h2><P class=MsoNormal dir=ltr>Not long ago, I did something like that.</P>
<P class=MsoNormal dir=ltr><A href="http://www.airosafe.com/products/ice.aspx">Airosafe ICE™</A><SPAN>&nbsp; </SPAN>(my company main product, not literally mine…) UI uses heavily this concept. I'll explain:</P>
<P class=MsoNormal dir=ltr>First, let me mention that the UI is a web application. I wanted to just "Bind" property to textbox and so obtain the following:</P>
<UL>
<LI class=MsoNormal>Server validation. </LI>
<LI class=MsoNormal>Client validation.</LI>
<LI class=MsoNormal>Enable\Disable Save button according to the Controls.</LI></UL>
<P class=MsoNormal dir=ltr><o:p>&nbsp;</o:p></P>
<P class=MsoNormal dir=ltr>Let's look at class 'Device' (may represent: PC, Router, Switch etc), it has a 'MacAddress' property. I assigned 'MacAddressRuleAttribute' Attribute to this property.</P>
<P class=MsoNormal dir=ltr><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN>[MacAddressRule()]<o:p></o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN>public</SPAN><SPAN> <SPAN>string</SPAN> MacAddress<o:p></o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN>{<o:p></o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>get</SPAN>...<o:p></o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>set</SPAN>...<o:p></o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN>}<o:p></o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN>Then in the when I want to bind this property:<o:p></o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN>Binder.Bind(txtMacAddress,macAddressObject,"MacAddress")<o:p></o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN>It's not exactly the way I implemented but you get the idea…<o:p></o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN>You are invited to look at the end result. You may <A href="http://www.airosafe.com/products/download-product.aspx">download</A> and install it, or you can just look at a <A href="http://www.airosafe.com/support/training.aspx">flash demonstration</A> .Notice the red frame when the text box has invalid data, also notice that the Save button is disabled until all controls on the page is valid. Looks familiar..?<o:p></o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN>I'm on the process of combining my work with csla.net, when I'm done I'll write an article.<o:p></o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN>P.s <o:p></o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN>In the flash demonstration there a delay with the red frame and the enable state of the save button that caused by the program used to create it. Plus there a nice tooltip that says why the textbox is not valid that is not shown also on the flash demonstration.<o:p></o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal dir=ltr><SPAN>Tamir<o:p></o:p></SPAN></P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>BARRY4679 replied on Thursday, May 11, 2006</h2><p>Hi Helen,<br /><br />one of the aims is to move business rules, such as validation, out of the UI, and into the BO&#39;s. This way the validation rules can be consistently applied by any other UI&#39;s, and be available back at the server (if there is one) as a belt-and-braces check just before the db is updated.<br /><br />Also don&#39;t forget that the BO&#39;s are present inside the UI, so in that sense the rules are available for immediate feedback without any server roundtrip.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Vaxman2 replied on Thursday, May 11, 2006</h2><P>I think it would be nice to stop someone from typing a 60 character note into a 10 char field and then being told they can only enter 10 chars max,&nbsp;by setting the textbox maxlength to 10.. It would be the UI developer's choice to implement, and the business object would still do it's own rule checking.</P>
<P>I think someone mentioned making information like this available with attributes on the old forum..</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>hurcane replied on Friday, May 12, 2006</h2>I've mentioned this several times before on other threads. What is working for us is to define an interface for UI validation. The interface contains the properties that UI controls can use to make the user experience more immediate. Here's an example of how I might state some interfaces:<br><br>Interface ITextboxStringInput<br><blockquote>ReadOnly Property IsRequired As Boolean<br>ReadOnly Property IsReadOnly As Boolean<br>ReadOnly Property MaxLength As Integer<br>Function TryFormat(ByRef Text as String) As Boolean<br></blockquote>End Interface<br><br>Interface ITextboxDoubleInput<br><blockquote>Readonly Property IsRequired As Boolean<br>ReadOnly Property IsReadOnly As Boolean<br>ReadOnly Property Precision As Integer<br>Function TryFormat(ByRef Text As String) As Boolean<br></blockquote>End Interface<br><br>The business object needs a dictionary (keyed by property name) to hold objects that support these interfaces. They can be exposed directly as a dictionary or they can be exposed through functions. (We use a function that takes the property name as a parameter.)<br><br>For Windows Forms projects, a custom textbox control can get at these properties through the databindings. The datasource of the Text property's binding would be the business object. The binding also exposes the property name on the business object. These properties can be used to retrieve the interface from the data source.<br><br>The IsReadOnly and IsRequired properties can be used to change the visual appearance of the control. The TryFormat is used during the KeyPress event to ensure that the format is correct. For the double, for example, a RegEx pattern is used to validate the Text parameter. The parameter is ByRef for strings. The string may need to be converted to uppercase for input, and TryFormat can handle that. You could have the interface simply expose the RegEx pattern. We didn't do that because we couldn't come up with a single regular expression to handle all the acceptable date formats. We allow shortcuts (e.g. 2W for 2 weeks from today), and that is acceptable during TryFormat.<br><br>To do this, you need "smart" data objects to implement the interface(s). Ours were fairly easy to develop. For the MaxLength on the string, the smart data object figures it out automatically from the parameters passed during construction, which are a datareader and a column name. The smart data object can access the schema data from the data reader to get the length/size of the column. The Doubles are also able to get their precision from the schema data available through the data reader.<br><br>This works great for our Windows Forms projects. I don't know if this is feasible for ASP.NET projects; I've never worked on one.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
