<html><header><title>Newbie -- Validation / Authorization Question</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Newbie -- Validation / Authorization Question</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2422.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>raspa posted on Friday, February 23, 2007</h2><P>I have the following business rule</P>
<P>A "visitor"&nbsp;role&nbsp;can&nbsp;create an event as long as the date is not in the past. An "agent" or "administrator" role can do any date.</P>
<P>A have an&nbsp;Event object which is created in a "Booking" page. The event date is passed as a query string parameter to the page so I would like to validate the rule before the user enters all the data and submits the form.</P>
<P>Not sure if the approach I used is correct:</P>
<P>I overloaded the Book CanAddObject and put a call to the Booking Page </P>
<P>In Booking page:</P>
<P>private void ApplyAuthorizationRules()<BR>{<BR>&nbsp;&nbsp;&nbsp;if (!Book.CanAddObject(_eventDate) )<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;hide form and display message&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;}<BR>}</P>
<P>public static bool CanAddObject(DateTime eventDate)<BR><FONT color=#0000ff>{<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff>if</FONT> (eventDate &lt; <FONT color=#008080>DateTime</FONT>.Now)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT color=#0000ff>return</FONT> (Csla.<FONT color=#008080>ApplicationContext</FONT>.User.IsInRole(<FONT color=#800000>"Agent"</FONT>) || Csla.<FONT color=#008080>ApplicationContext</FONT>.User.IsInRole(<FONT color=#800000>"Administrator"</FONT>));<BR>&nbsp;&nbsp;&nbsp;<FONT color=#0000ff>else<BR></FONT>{<BR>&nbsp;&nbsp;&nbsp;<FONT color=#008000>// otherwise do a regular validation<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff>return</FONT><FONT size=1><FONT size=3> CanAddObject();<BR></FONT><FONT size=3>}</FONT></P>
<P></FONT><FONT size=3>Is that the correct approach? I wanted to implement a validation rule without instantiating the object but I'm not sure how to do it. </FONT></P>
<P>Thank you for your time</P>
<P>Rafael</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, February 26, 2007</h2>Hi,<br><br>A cleaner way might be to create a static rule method which checks the date and role.&nbsp; You could then have a broken rule which checks the value and role.<br><br>That of course assumes that EventDate is ediable after the object is created.<br><br>Andy<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
