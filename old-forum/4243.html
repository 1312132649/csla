<html><header><title>BusinessBase.Parent OnChangedEvent ?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>BusinessBase.Parent OnChangedEvent ?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4243.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ShawnCamp posted on Saturday, January 26, 2008</h2><P><FONT face=Arial size=2>As a developer I often need the ability to allow the user to use a grid control to enter one or many child objects. Under the covers this grid control is of course bound to a CSLA child collection. In many cases I’ve needed the ability to implement a rule that says a value is Unique within the parent collection. Sometimes this is because of a unique key constraint in the database, and other times its just a business requirement. <BR></FONT><FONT face=Arial size=2><BR>CSLA business rules are great out of the box for validating the values in the current object, but gets slightly more involved when the value you are validating is actually in another object.<BR>In a past project I implemented a UniqueValue rule by passing in the parent collection to the child factory method and storing a reference to the parent in a member variable. It was then available by the time the CheckRules() method was fired. This worked well, but passing in the parent is tedious, especially in code generation scenarios.<BR><BR>In the latest release of CSLA I notice that the Parent property in Csla.Core.BusinessBase is now marked Protected. This makes it easier to get reference to the parent object, but it’s not populated until it’s been added to the parent collection (after the CheckRules() method has been called);<BR><BR>I've looked at the Parent code section in the Csla.Core.BusinessBase class and the definition looks like:<BR>&nbsp;&nbsp;&nbsp; <BR><FONT color=#0000ff size=2>#region</FONT><FONT size=2> Parent/Child link</FONT></P>
<P><FONT size=2>[</FONT><FONT color=#2b91af size=2>NotUndoable</FONT><FONT size=2>()]<BR>[</FONT><FONT color=#2b91af size=2>NonSerialized</FONT><FONT size=2>()]<BR></FONT><FONT color=#0000ff size=2>private</FONT><FONT size=2> Core.</FONT><FONT color=#2b91af size=2>IParent</FONT><FONT size=2> _parent;</P>
<P></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;summary&gt;<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> Provide access to the parent reference for use<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> in child object code.<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;/summary&gt;<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;remarks&gt;</P></FONT><FONT size=2>
<P></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> This value will be Nothing for root objects.<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;/remarks&gt;</P></FONT><FONT size=2>
<P>[</FONT><FONT color=#2b91af size=2>EditorBrowsable</FONT><FONT size=2>(</FONT><FONT color=#2b91af size=2>EditorBrowsableState</FONT><FONT size=2>.Advanced)]<BR></FONT><FONT color=#0000ff size=2>protected</FONT><FONT size=2> Core.</FONT><FONT color=#2b91af size=2>IParent</FONT><FONT size=2> Parent<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>get</FONT><FONT size=2> { </FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> _parent; <BR>}</P>
<P></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;summary&gt;<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> Used by BusinessListBase as a child object is <BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> created to tell the child object about its<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> parent.<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;/summary&gt;<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;param name="parent"&gt;</FONT><FONT color=#008000 size=2>A reference to the parent collection object.</FONT><FONT color=#808080 size=2>&lt;/param&gt;<BR></FONT><FONT color=#0000ff size=2>internal</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> SetParent(Core.</FONT><FONT color=#2b91af size=2>IParent</FONT><FONT size=2> parent)<BR>{<BR>&nbsp;&nbsp;&nbsp;_parent = parent;<BR>}</P></FONT><FONT color=#0000ff size=2>
<P>#endregion<BR><BR></FONT></FONT><BR><FONT face=Arial size=2>Is there a specific reason the Parent property doesn't expose an OnChanged event handler or and overridable OnChangedMethod?&nbsp; If not, Rocky is a possibility one could be added?</FONT></P>
<P><BR><FONT face=Arial size=2>Thanks,</FONT></P>
<P><FONT face=Arial size=2>Shawn Camp</FONT></P>
<P><FONT face=Arial size=2></FONT>&nbsp;</P><FONT face=Arial size=2></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, January 28, 2008</h2><P>Child objects do raise an event - either PropertyChanged or ListChanged, because a child can only be one of BusinessBase or BusinessListBase.</P>
<P>In CSLA .NET 3.5 child objects' events are automatically handed by their parent, which raises its corresponding changed event - all the way up the chain.</P>
<P>So in your case, you can simply handle the parent list's ListChanged event to check the rule, because that event will (in 3.5) be raised when the list itself changes, or when any of its child objects are changed.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
