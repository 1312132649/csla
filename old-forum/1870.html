<html><header><title>Question re: children of root objects (no collection)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Question re: children of root objects (no collection)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1870.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>willwise posted on Wednesday, November 29, 2006</h2>Hi folks,<br><br>I've been digging into CSLA as my current client is using it.&nbsp; Much to like!<br><br>I'm designing a new portal and have run into one small problem. I have a workaround but I'd rather do things the "right" way so here goes...<br><br>I have an editable root object that contains a child object directly; that is, it does not have a collection of child objects but just a single child object.&nbsp; It's accessed like so:<br><br>EditableRoot.EditableChild<br><br>The only issue I'm having is figuring out how to mark the child object for deletion.&nbsp; I'm using version 1.1 of the framework.&nbsp; Calling Delete directly as the parent root object is not a collection.<br><br>Any help much appreciated!<br><br>Kind Regards,<br>Will<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, November 30, 2006</h2>Will,<br><br>I agree, there is much to like!<br><br>A child as you have setup normally cannot be deleted by itself, it would only be deleted if the parent object is itself marked as deleted.<br><br>This usually makes sense.&nbsp; What happens when you delete the child?&nbsp; Does the EditableRoot.EditableChild property now return null?&nbsp; An 'empty' object (kind of like String.Empty, or DbNull.Value)?<br><br>That said, you CAN delete the data behind the child based on some condition.&nbsp; Alternately, I guess you could call the IEditableBusinessObject.DeleteChild() method... but I would expose a method on the Root object which will call that method on the child object.&nbsp; I would think that makes the most sense for your scenario.<br><br>HTH<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>willwise replied on Thursday, November 30, 2006</h2>My solution to this problem was to modify the first line of the Update method in the child object from:<br><br><font face="Courier New">If Not Me.IsDirty Then Exit Sub</font><br><br>to:<br><br><font face="Courier New">If Not (Me.IsDirty Or Parent.IsDeleted) Then Exit Sub</font><br><br>and also modify the test for <font face="Courier New">Me.IsDeleted </font>to include the parent in the test like so:<br><br><font face="Courier New">If Me.IsDeleted Or Parent.IsDeleted Then<br>&nbsp;&nbsp;&nbsp; ' Delete the child object...<br>End If<br></font><br>This seems to do the trick without too much fuss. Would this be considered to follow CSLA best practices for this case if there are any that are applicable?<br><br>Thanks again!<br>Will<br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
