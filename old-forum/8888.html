<html><header><title>per instance rules -- living without them</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>per instance rules -- living without them</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8888.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>artsd posted on Wednesday, May 05, 2010</h2><p>I have just started looking at CSLA for Silverlight. I have the Expert C# 2008 Bus Obj book (and 2005 and original version too even though I never read them :-) ). So I am starting with CSLA 4 Beta 1.</p>
<p>I was going to ask if my situation warranted the use of per instance rules but I just read in another post by Rocky that per instance rules have been eliminated in v4 due to large overhead.</p>
<p>I will set up my scenario anyway and maybe someone can tell me if I will still be able to accomplish my goal. I am trying to recreate some existing functionality in a 10+ year old C++/DCOM medical records system so I am limited and what I can change.</p>
<p>In current system, properties of the patient record and the current logged in user drive all other field requirements. This is all user configurable. In the below example, nothing is hard-coded; patient types, patient phases, and user types are all database driven and configurable by my customer.</p>
<p>So for example, my customer can configure system to say if patient is of type &#39;inpatient&#39; and currently in phase &#39;initial intake&#39; and the user is of type &#39;intake clerk&#39;, then the Last Name field is required.</p>
<p>But if the patient is changed to phase &#39;billing intake&#39; and the user is of type &#39;billing admin&#39;, then the Last Name and SSN are required. Changing the type/phase/user type does not need to change the requirements immediately/dynamically -- after reload of object is fine.</p>
<p>It gets a little worse because any child record owned by the patient (a 10 node deep and very wide hierarchy of child records exists under the patient) will also need to know the patient&#39;s type and phase in order to properly enforce the child record&#39;s requirements.</p>
<p>Because of lack of per-instance rules, not only can I not add the rules dynamically to instance of object but I don&#39;t think I have access to other properties of object either in the per type rules. So I don&#39;t know if I will be able to access patient&#39;s type/phase in the patient record let alone one of the patient&#39;s child records.</p>
<p>Is the any hope for me?</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Thursday, May 06, 2010</h2><p>Per-type rules have access to the object instance when they are executed. The only reason they are &quot;per-type&quot; is that the rule is created once for the business object type, instead of once for each business object instance.</p>
<p>Per-instance rules are so expensive in terms of performance and memory, that they are nearly useless - which is why they are being removed. While they can be used successfully - with great care and understanding of their negative impact - they just aren&#39;t a good idea.</p>
<p>But per-type rules can be very context-sensitive, and they get passed a reference to the target object (that&#39;s the first parameter) so they can alter their behavior based on the state of the target object.</p>
<p>You probably won&#39;t be able to use the CommonRules implementations - you&#39;ll need your own more powerful implementations - but you can do what you are asking.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>artsd replied on Thursday, May 06, 2010</h2><p>Thanks Rocky. Sounds like I can make it work. I am just starting out learning CSLA and using InventoryDemo as a starting point. Thanks.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
