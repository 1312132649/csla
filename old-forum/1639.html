<html><header><title>IBindingLsitView a simple implementation</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>IBindingLsitView a simple implementation</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1639.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>MatDavena posted on Tuesday, October 31, 2006</h2><P class=MsoNormal><SPAN>Hi Evertybody,<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>I’m relatively new <SPAN>&nbsp;</SPAN>to CSLA. I think it’s a great framework and I choose to adopt it for my current project. I appreciate the Rocky’ SortedBindingList and FilteredBindingList, but in my project I have the need to give the user more flexibility on the presented data. That is the user could sort the information on multiple properties and dinamically filter the data basing on some quick selection<SPAN>&nbsp; </SPAN>So I provide a simple implementation of <SPAN>&nbsp;</SPAN>the IBindingListView interface, trying to save Rocky’s work as match as possible. The new class is BindingListView&lt;T&gt;.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><B><SPAN>View on data<o:p></o:p></SPAN></B></P>
<P class=MsoNormal><SPAN>Like the Rocky’s classes, the BindingListView do not create a copy of the data, but just a view on data, represented by a collection of ListItem object. The ListItem class has the responsibility to hold a reference to the original item, to hold the original position in the source list, and to cache values needed for the sorting process. <o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>The view (ListItem collecion) <SPAN>&nbsp;</SPAN>is created at the instantiation time and updated in only two cases: the filter is changed, the source list is changed. <o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>When an item is added in the source list, the corresponding ListItem is simply appended to the view.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>When an item is deleted from the source list, the corresponding ListItem is deleted.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>When an item is changed, the corresponding ListItem is refreshed.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><B><SPAN>Sorting<o:p></o:p></SPAN></B></P>
<P class=MsoNormal><SPAN>For sorting I wrote a modified version of the Brian Noyes’ SortComparer (from his great book: Data Binding with Windows Forms 2.0). We can filter the list programmatically by setting the Sort property of the BindingList like the following sample:<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>CustomerList list = CustomerList.GetCustomerList(criteria);<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>BindingListView&lt;Customer&gt; view = new BindingListView&lt;Customer&gt;(list);<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>view.Sort = “Name ASC, Age DESC”;<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;</SPAN><o:p></o:p></SPAN></P><SPAN>
<P class=MsoNormal><SPAN><STRONG>Filtering<o:p></o:p></STRONG></SPAN></P>
<P class=MsoNormal><SPAN>For the filtering process I used the same Predicate approach of the Jesse Johnston implementation ot IBindingListView (look at <A href="http://www.teamjohnston.net/cs/blogs/jesse">http://www.teamjohnston.net/cs/blogs/jesse</A> for more details). For each filter condition is instantiated a Predicate class with a method (the predicate delegate) that evaluate whether a specified item instance meets the filter criteria. I created a different class for each of the primitive data types to avoid unnecessary boxing/unboxing operations. To filter the view we have to pass a filter string to the BindingListView class. The filter string the class accept are quite simple, because I have not the time to write a powerfull parser. We can write a filter like the following:<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>CustomerList list = CustomerList.GetCustomerList(criteria);<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>BindingListView&lt;Customer&gt; view = new BindingListView&lt;Customer&gt;(list);<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>view.Filter = “Name = ‘John’ AND Age = 32”;<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>The conditions on the different properties must be in AND. For string we can use the metacharacters “*” or “%” to simulate a Like condition, or we can specify a Regular Expression in this form:<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>CustomerList list = CustomerList.GetCustomerList(criteria);<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>BindingListView&lt;Customer&gt; view = new BindingListView&lt;Customer&gt;(list);<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>view.Filter = “Phone = Regex(“<CODE><SPAN>\b\d{3}-3434<SPAN>”</SPAN></SPAN></CODE>) AND Age=32”;<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>If you want it, you can download the source code from my personal web space: <A href="http://www.webalice.it/matteo.davena/en/BindingListView.html">http://www.webalice.it/matteo.davena/en/BindingListView.html</A><o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>I will appreciate</SPAN><SPAN> your <SPAN>feedback.<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN>Many thanks,<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>Matteo D’Avena</SPAN><SPAN><o:p></o:p></SPAN></P>
<P class=MsoNormal></SPAN></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Tuesday, October 31, 2006</h2>Now that's a hell of a first post dude!<br><br>Great work!<br>Welcome to the forum!<br><br>Bayu<br><br><br>PS: too bad I have no immediate use for your work. Using Infragistics' stuff I have all these kinds of needs fulfilled already. <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Tuesday, October 31, 2006</h2>Welcome to the boards!&nbsp; I will definitely be taking a look at this to see if I can get any ideas for the ObjectListView.&nbsp; You can find it as part of the CSLAcontrib project.<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MatDavena replied on Tuesday, October 31, 2006</h2>Thanks guys for your reply!<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brembot replied on Wednesday, December 20, 2006</h2><font face="Tahoma"><font size="2">Hello Mat,<br><br>I have used your BindingListView and it's very easy to implement. I think it's better if you create a powerful parser for the filters.<br><br>Thanks<br></font></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DansDreams replied on Thursday, December 21, 2006</h2><P>I've found the DevExpress controls are more than happy to manage all that for me such that I haven't had a need for the sorted or filtered lists.&nbsp; You can imagine the hours that saves me.&nbsp; Just a thought for people considering using a 3rd party suite.</P>
<P>Also, I expect Rocky's going to support LINQ in CSLA 3.0, and it's probably wise to start thinking that way.&nbsp; I think that's&nbsp;the general direction&nbsp;Matteo has taken.&nbsp; The real key I think is being careful where you put the criteria parsing that was suggested.&nbsp; I know zero about linq other than basically what it is, but at this point anything I designed for filtering would take a strong consideration of what's coming from Microsoft.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
