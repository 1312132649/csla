<html><header><title>more combobox fun</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>more combobox fun</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2933.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Tuesday, May 22, 2007</h2>Hi all,<br><br>I'm having a problem.&nbsp; I have a UserControl, which has a combobox on it.&nbsp; The text property is bound to a property on my BO, which is fine.&nbsp; The BO is a child of another BO, which is edited by the main form.<br><br>The problem I'm having is that the SelectedIndexChanged event fires unexpected; basically, the form containing the usercontrol has its MdiParent property set, and this for some reason is causing the SelectedIndexChanged event to fire. <br><br>I need code to run UNLESS the control is loading, and this works fine... except for this unexpected event.<br><br>Any idea why this is happening?<br><br>Thanks<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Tuesday, May 22, 2007</h2><P>Andy,</P>
<P>I have been doing Web development for the last year, but I remember being plagued with this same&nbsp;problem when working in WinForms.&nbsp; I am sure you are enclosing you code with "If SelectedIndex &gt; -1". &nbsp;As I recall when you set up the ComboBox DataSource, the SelectedIndex by itself changes to&nbsp;zero -&nbsp;which will make it&nbsp;barge right into your code. Is it possible that your combobox is firing in response to the datasource being set?&nbsp; </P>
<P>I also remeber that my ComboBoxes behaved much better when I set up the DisplayMember and the ValueMember properties first - before setting up the DataSource property.</P>
<P>Jav</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, May 23, 2007</h2>Jav,<br><br>Yes, I did run into the problem of setting the datasource for the combobox and having that reset the index.&nbsp; I handled that by having an isLoading flag, which I set while I'm setting up the data sources.<br><br>This is occuring because for some reason the event is firing again when the MdiParent property of the form is set.. I've confirmed this by looking at the call stack.&nbsp; The odd thing is that this doesn't happen on my other forms, it just seems to happen on this form where I have a user control on the form (which itself is on a UltraTabPage).&nbsp; <br><br>With other comboboxes I've been pretty successful in using them and setting DisplayMember and the Datasource via the designer.&nbsp; The trick is when you actually fill in the proper datasource, you turn off binding events, set teh DS, then turn them on, and finally call ResetBindings( false ).&nbsp; that normally works pretty well..<br><br>Andy<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
