<html><header><title>ModelBinder System.MissingMethodException: Cannot create an instance of an interface</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ModelBinder System.MissingMethodException: Cannot create an instance of an interface</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/12890.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>richardb posted on Wednesday, May 27, 2015</h2><p>This is possbily related to my previous post around odd grid binding behaviour (waiting for approval).</p>
<p>I have an MVC 5 web app and a model with child objects and am binding this in a Kendo grid control. &nbsp;When attempting to update a child row the model binder appears to be throwing an error, and the call to the update method in the controller never gets fired.</p>
<p>&quot;System.MissingMethodException: Cannot create an instance of an interface&quot;. &nbsp;The key indicator seems to be <b>&quot;MissingMethodException: Cannot create an instance of an interface. Object type &amp;#39;Csla.Core.IParent&quot;</b></p>
<p>So it looks like it&#39;s failing trying to work out the parent property of the child. &nbsp;.Net can&#39;t spin up an interface - it needs the real concrete class.</p>
<p>Now I don&#39;t think this is a CSLA issue, but rather a Kendo grid + Csla binder interaction going on here, and I know grids and binding always throw some fun issues into the mix. &nbsp;I have set the MVC default model binder to use the Csla version.</p>
<p>Any ideas? &nbsp;The razor form binds directly to the model - not using the CslaViewModelBase (maybe I can try that).</p>
<p>I can work around this by using custom commands (a.k.a firing my own JavaScript ajax calls), but want to know what the real issue is here. &nbsp;</p>
<p>I&#39;ve used this technique kendo grid + poco (plain old class objects) on another project and this binding action approach all works fine. &nbsp;So is it kendo + csla model binder problem?</p>
<p>I&#39;ll post this into the kendo forums too, but I know I&#39;ll get the Csla insights here.</p>
<p>Thanks,</p>
<p>Richard.</p>
<p>&nbsp;</p>
<p>Here&#39;s part of the stack trace.</p>
<p>[MissingMethodException: Cannot create an instance of an interface.]</p>
<p>&nbsp; &nbsp;System.RuntimeTypeHandle.CreateInstance(RuntimeType type, Boolean publicOnly, Boolean noCheck, Boolean&amp;amp; canBeCached, RuntimeMethodHandleInternal&amp;amp; ctor, Boolean&amp;amp; bNeedSecurityCheck) +0</p>
<p>&nbsp; &nbsp;System.RuntimeType.CreateInstanceSlow(Boolean publicOnly, Boolean skipCheckThis, Boolean fillCache, StackCrawlMark&amp;amp; stackMark) +113</p>
<p>&nbsp; &nbsp;System.RuntimeType.CreateInstanceDefaultCtor(Boolean publicOnly, Boolean skipCheckThis, Boolean fillCache, StackCrawlMark&amp;amp; stackMark) +232</p>
<p>&nbsp; &nbsp;System.Activator.CreateInstance(Type type, Boolean nonPublic) +83</p>
<p>&nbsp; &nbsp;System.Activator.CreateInstance(Type type) +66</p>
<p>&nbsp; &nbsp;System.Web.Mvc.DefaultModelBinder.CreateModel(ControllerContext controllerContext, ModelBindingContext bindingContext, Type modelType) +554</p>
<p>&nbsp;</p>
<p>[MissingMethodException: Cannot create an instance of an interface. Object type &amp;#39;Csla.Core.IParent&amp;#39;.]</p>
<p>&nbsp; &nbsp;System.Web.Mvc.DefaultModelBinder.CreateModel(ControllerContext controllerContext, ModelBindingContext bindingContext, Type modelType) +630</p>
<p>&nbsp; &nbsp;System.Web.Mvc.DefaultModelBinder.BindComplexModel(ControllerContext controllerContext, ModelBindingContext bindingContext) +1136</p>
<p>&nbsp; &nbsp;System.Web.Mvc.DefaultModelBinder.BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext) +633</p>
<p>&nbsp; &nbsp;Castle.Proxies.DefaultModelBinderProxy.BindModel_callback(ControllerContext controllerContext, ModelBindingContext bindingContext) +45</p>
<p>&nbsp; &nbsp;Castle.Proxies.Invocations.DefaultModelBinder_BindModel.InvokeMethodOnTarget() +191</p>
<p>&nbsp; &nbsp;Castle.DynamicProxy.AbstractInvocation.Proceed() +117</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>ajj3085 replied on Wednesday, May 27, 2015</h2><p>I think we had something similar in MVC2 or 3.&nbsp; Basically what we had to do was include the .Net type information so that if it saw one of our interfaces or abstract base classes, it would look at the type information (which got embedded in a data- attribute).&nbsp; </p>
<p>That said though, the Parent property shouldn&#39;t be used in your view at all, and I can&#39;t really think why it would be necessary.&nbsp; What does your view look like, do you use .Parent anywhere?&nbsp; </p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>richardb replied on Thursday, May 28, 2015</h2><p>Thanks. &nbsp;Well the parent property gets serialized down by default in by the Ajax json serializer when the grid is loaded. &nbsp;I did think about customizing the serializer to remove it but after more research around kendo grid and thinking about the problem overnight I realised I&#39;m partly being stupid.</p>
<p>Although inline grid editing (MVC) gives the illusion I&#39;m editing a child, in reality we are editing one object. &nbsp;The kendo grid posts back the row being edited, not the whole model tree. &nbsp;So the MVC model binder has no idea that its a child object with a parent - a parent of what type - it can&#39;t figure it out? &nbsp;As you say, maybe you can do something to help it work it out. &nbsp;Also, if I did get pass the binder remember I&#39;m trying to new-up a child here, which my csla model should not allow, unless I tweak and frig it, which is a bad workaround IMHO. &nbsp;So, really here, the use case is I&#39;m editing a root businessbase object, and if I really want to do that I should create a root version object that allows this rather than trying to do it as a child model.</p>
<p>The Kendo grid MVC version also really does NOT support &quot;complex models&quot;.</p>
<p>In the end, the solution I used was to use a viewmodel. &nbsp;So when the grid loads, I map (using the wondeful AutoMapper) my children into a list of viewmodels (simple poco&#39;s) and bind that to the grid. &nbsp;The kendo grid can then post the child vm back nicely and then I load up my parent model and its children, fidn the model I&#39;m editing and map the changes back from the vm into the child - thus I get the csla business rules firing as required.</p>
<p>The viewmodel works for me in my MVC world. &nbsp;If I was doing a WPF UI I know from experience that the grid controls do tend to support complex objects, and that a WPF grid would typically be able to do a save call on the parent which would then ripple down to the children and save our amended child.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>ajj3085 replied on Thursday, May 28, 2015</h2><p>Oh, are you directly serializing a Csla object to a web browser or something?&nbsp; The view model approach is correct, you shouldn&#39;t expose your Csla model directly from a web service: <a href="http://www.lhotka.net/cslanet/faq/ObjectsAsServiceContract.ashx">http://www.lhotka.net/cslanet/faq/ObjectsAsServiceContract.ashx</a></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>richardb replied on Thursday, May 28, 2015</h2><p>Its an MVC razor view so its ok to send a csla model down. &nbsp;Not a web service.</p>
<p>But thanks again.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, May 28, 2015</h2><p>Ok, then I&#39;m not clear on where the AJAX serializer comes into play.&nbsp; At any rate, the Parent property shouldn&#39;t be getting sent to the browser at all.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
