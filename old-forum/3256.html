<html><header><title>WAY OT: Too Smart a Client?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>WAY OT: Too Smart a Client?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3256.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>tmg4340 posted on Tuesday, July 24, 2007</h2><P><FONT face=Tahoma size=2>OK - this is about as far away from CSLA as you can get.&nbsp; But I've seen some pretty smart folks here...</FONT></P>
<P><FONT face=Tahoma size=2>I'm beginning to do some work on a project for my wife to help her manage a business she runs out of the house.&nbsp; I will be using CSLA for the project, but this will be a single-user desktop app.&nbsp; I suppose it's possible that it could expand to multiple users, but that's not something either of us see in the foreseeable future.</FONT></P>
<P><FONT face=Tahoma size=2>Anyway, this will be on her laptop, and she will have some percentage of work done out of the house - and off our internal network.&nbsp; She may go to places where she has internet access, and she may go to places where she's got nothing but her laptop.</FONT></P>
<P><FONT face=Tahoma size=2>We have a web server that hosts a site for her, and it's also hosting SQL Server 2005 for my development work.&nbsp; Since she's already talking about incorporating some functionality into her website at a later date,&nbsp;I decided to forego using SQL Server Express and just go directly to "the big box".</FONT></P>
<P><FONT face=Tahoma size=2>Classic "smart client" scenario, right?&nbsp; Well... here's where I'm probably overthinking it.</FONT></P>
<P><FONT face=Tahoma size=2>The plan is to support three modes of data - direct SQL Server connection (for when she's at home), a web service (for when she out, but&nbsp;has internet access), and disconnected local (for when it's her and the laptop).&nbsp; My question relates to how to manage that data synchronization.&nbsp; I'm going to be building a facade in front of all this that my CSLA objects will interface with, so that they never have to know which data-access methods are available.</FONT></P>
<P><FONT face=Tahoma size=2>The longer I look at the problem, the more I'm leaning towards just having everything run off the local data, and have the SQL Server/web-service update as an "extension"&nbsp;after the local-data&nbsp;update.&nbsp; The reason for that is that I don't want her to have to remember to sync the data to her laptop before she leaves the house.&nbsp; Plus, it makes the facade a little easier, since the facade essentially becomes the local-data update.</FONT></P>
<P><FONT face=Tahoma size=2>The issues are obvious - do I really want the entire database stored locally in persistent files?&nbsp; That's a big download hit - but it only happens once.&nbsp; After that, it's all incremental updates.&nbsp; There's no concurrency issues - she's the only user.&nbsp; The functionality of DataSets in .NET provide me with just about everything I need from a referential-integrity standpoint, but I have to be careful about it or else I'm potentially using a huge memory footprint.&nbsp; Obviously this also adds another layer to the update process, which adds more time.&nbsp; And it's not the most efficient from a database perspective either - my options for grouping operations in stored procedures is pretty limited under this scenario unless the local schema deviates quite a bit from the database.&nbsp; But the&nbsp;number of&nbsp;record updates for any operation&nbsp;is pretty minimal, and if I take a little time to build a localized transaction logger, I can isolate the records to update pretty quickly.</FONT></P>
<P><FONT face=Tahoma size=2>Storing the entire database locally also allows me to give her full functionality wherever she is, which is not as important as it sounds, but would be a "nice to have".&nbsp; However, she will need enough functionality offline that the amount of data I'd have to synchronize is not much less than the entire schema anyway.</FONT></P>
<P><FONT face=Tahoma size=2>None of this fits very well within a web scenario, but the kind of functionality she's wanting from the web page is largely report-based, so the facade&nbsp;wouldn't be&nbsp;much use there - and neither&nbsp;would my CSLA objects.</FONT></P>
<P><FONT face=Tahoma size=2>I considered using SQL Server Express locally and setting up some merge replication, but that seems like using a sledgehammer to kill a fly.&nbsp; Of course, storing the entire database in persistent DataSet-based cache files is not exactly a lightweight solution either... but I see it as easier to manage for schema changes than an actual DB.</FONT></P>
<P><FONT face=Tahoma size=2>So what am I missing?&nbsp; Why is this an idea&nbsp;I should run away from?&nbsp; Should I just use SQL Server Express?</FONT></P>
<P><FONT face=Tahoma size=2>- Scott</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, July 25, 2007</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>tmg4340:</strong></div><div>
<P><FONT face=Tahoma size=2>The longer I look at the problem, the more I'm leaning towards just having everything run off the local data, and have the SQL Server/web-service update as an "extension"&nbsp;after the local-data&nbsp;update.&nbsp; The reason for that is that I don't want her to have to remember to sync the data to her laptop before she leaves the house.&nbsp; Plus, it makes the facade a little easier, since the facade essentially becomes the local-data update.</FONT></P>
<P></div></BLOCKQUOTE></P>
<P>In general I think this is the right answer and is what I recommend for most apps like this. Think about Outlook in cached mode, it always works against its local data store, and then does background sync to receive/send data.</P>
<P>Microsoft is investing pretty heavily in making this model easier/better. Look at SQLce and SQL Sync Services. They are building the infrastructure so you can use SQLce on the client, and use sync services to do most of the hard work of getting the data to/from the central database.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Justin replied on Wednesday, July 25, 2007</h2><P>The problem we ran into with always using a local store with background sync is that if the db your working with is a large multiuser backend keeping the whole thing in sync is not feasible. Yet if the user does have a connection to the core system they should have the benifits of searching the whole thing (at least in our situation). Outlook doesn't really have this issue since it's just replicating <EM>your </EM>inbox<EM> </EM>not everyones mailbox.</P>
<P>This may not be an issue with your app though.</P>
<P>The way we did it was have used a web service for all network connectivity, and the XML used for the web service was cached locally if offline. So if you had connectivity you had the benefits of the large db, while offline it just returned results from the local XML cache but CSLA always saw the web service as active.</P>
<P>Justin</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tmg4340 replied on Wednesday, July 25, 2007</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>RockfordLhotka:</strong></div><div> 
<P>Microsoft is investing pretty heavily in making this model easier/better. Look at SQLce and SQL Sync Services. They are building the infrastructure so you can use SQLce on the client, and use sync services to do most of the hard work of getting the data to/from the central database.</P>
<P></div></BLOCKQUOTE></P>
<P><FONT face=Tahoma size=2>Thanks for the info.&nbsp; I didn't know SQL CE had "graduated" to the desktop.&nbsp; SQL SS is still in beta, and I don't think I can wait for the Orcas release, but I'll take a look at it.&nbsp; Hopefully it's far enough along that I can use it.&nbsp; From my initial look, it sounds pretty much like what I would have written anyway.</FONT></P>
<P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>Justin:</strong></div><div> </P>
<P>The problem we ran into with always using a local store with background sync is that if the db your working with is a large multiuser backend keeping the whole thing in sync is not feasible. Yet if the user does have a connection to the core system they should have the benifits of searching the whole thing (at least in our situation). Outlook doesn't really have this issue since it's just replicating <EM>your </EM>inbox<EM> </EM>not everyones mailbox.</P>
<P></div></BLOCKQUOTE></P>
<P><FONT face=Tahoma size=2>This isn't a multiuser backend - my wife will be the only user for the foreseeable future.&nbsp; In fact, if my wife wasn't thinking about adding some functionality to her website in the future, I wouldn't even be thinking about this - I'd just keep the data local to the app.&nbsp; So&nbsp;all data in the "big backend" is hers anyway.&nbsp; I'm just trying to save myself headaches for the web parts&nbsp;later.</FONT></P>
<P><FONT face=Tahoma size=2>- Scott</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Wednesday, July 25, 2007</h2><P>If this is how "Big Brother" is doing it...</P>
<P><A href="http://blogs.msdn.com/dieterz/archive/2005/11/07/489893.aspx">http://blogs.msdn.com/dieterz/archive/2005/11/07/489893.aspx</A></P>
<P>...then it's good enough for me.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tmg4340 replied on Wednesday, July 25, 2007</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>SonOfPirate:</strong></div><div>
<P>If this is how "Big Brother" is doing it...</P>
<P><A href="http://blogs.msdn.com/dieterz/archive/2005/11/07/489893.aspx">http://blogs.msdn.com/dieterz/archive/2005/11/07/489893.aspx</A></P>
<P>...then it's good enough for me.</P>
<P></div></BLOCKQUOTE></P>
<P><FONT face=Tahoma size=2>I thought about doing it this way - just dumping the direct SQL connection and doing everything through a web service.&nbsp; I may still do it.&nbsp; But she will be working from the house at least half the time, and I didn't want the app to incur the web-service overhead unless it was necessary.</FONT></P>
<P><FONT face=Tahoma size=2>It's interesting to see how MS is moving more of their apps to the "Outlook style"...</FONT></P>
<P><FONT face=Tahoma size=2>- Scott</FONT></P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
