<html><header><title> How to provide Readonly remote to Dbase (dbf) files using CSLA</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1> How to provide Readonly remote to Dbase (dbf) files using CSLA</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5155.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>cash_pat posted on Friday, July 25, 2008</h2>&nbsp;How to provide Readonly remote access to Dbase (dbf) files using CSLA. I am confused over:<br><br>a) I tried a test run by addding an OleDB connection string to my app.config file. Looks like CSLA defaults to Sql Server !<br>b) Is it possible to use CSLA for accessing dbf files.<br>c) If possible then what portions of CSLA do I have to change to enable the access.<br>d) Any sample posts that could point in the right direction. I tried searching for Oledb but the search results were not very informative<br>e) I have all the CSLA books. which ones would send me in the right direction.<br><br>f) Can i get all the features of CSLA while accessing dbf files<br><br>any ideas<br><br><br>regards<br><br>cash pat<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>triplea replied on Friday, July 25, 2008</h2><P>Hi</P>
<P>a) If you did your change and test on PTracker then this wouldnt work. In that example SQL Connections/Commands are used so of course changing the App.config would make no difference. I think thats what you mean by saying it defaults to SQL server, if not please correct me.</P>
<P>b) Sure, any datasource really.</P>
<P>c) The dataportal_XYZ methods (Fetch/Insert/Update/Delete and maybe Create). Using ADO or any other DA way you would normally use.</P>
<P>f) Yes</P>
<P>Hope this helps</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson replied on Friday, July 25, 2008</h2><P>Pat, </P>
<P>It seems likely you are confusing CSLA <STRONG><FONT color=#000080>framework code</FONT></STRONG> with PTracker&nbsp; <STRONG><FONT color=#a52a2a>application sample code</FONT></STRONG>.&nbsp; PTracker is an example of an application using the CSLA libraries with Business Object code that uses Sql Server for data persistance.&nbsp; But you can use any technique you want (including writing text files, XML, the registry, Oracle, Access, dBase, FoxPro, ad nauseum) to do your CRUD methods in the DataPortal_XYZ methods of your individual Business Objects.&nbsp; Just be sure and reference the correct dot NET System.Data.&lt;your choice here&gt; &nbsp;libraries in your Business Object code.</P>
<P><BR>&gt;&gt;a) I tried a test run by addding an OleDB connection string to my app.config file. Looks like CSLA defaults to Sql Server ! &lt;&lt;<BR>CSLA doesn't default to ANY database engine usage.&nbsp; </P>
<P>&gt;&gt;b) Is it possible to use CSLA for accessing dbf files.&lt;&lt;<BR>Yes, certainly it is.</P>
<P>&gt;&gt;c) If possible then what portions of CSLA do I have to change to enable the access.&lt;&lt;<BR>You needn't (and shouldn't) change any CSLA code.</P>
<P>&gt;&gt;d) Any sample posts that could point in the right direction. I tried searching for Oledb but the search results were not very informative&lt;&lt;<BR>Just look for code samples that use Microsoft Access.&nbsp; The connection string for dBase will be different , of course, but the use of the OleDb objects will be the same for dBase.&nbsp; You'll find yourself using code like this:</P>
<P>&nbsp; Dim cn As New OleDbConnection(&lt;your value here&gt;))<BR>&nbsp;&nbsp;Dim cmd As New OleDbCommand<BR>&nbsp;&nbsp;Dim tr As OleDbTransaction</P>
<P>The &lt;your value here&gt; portion will contain your technique for retrieving your database's connection string.&nbsp; Best technique is to use some function to return it rather than using a literal string value, of course.&nbsp; In Expert VB 2005 Business Objects (CSLA 2), Rocky uses a helper class in PTracker, for example (see page 427 and the discussion of Database.PTrackerConnection).&nbsp; In CSLA 1, Rocky provided a Protected DB() method of BusinessBase that offered the same functionality.&nbsp; Both of these are just wrappers that will extract the Connection String stored in&nbsp;your app's&nbsp;config file.</P>
<P>&gt;&gt;e) I have all the CSLA books. which ones would send me in the right direction.&lt;&lt;<BR>They all should</P>
<P>&gt;&gt;f) Can i get all the features of CSLA while accessing dbf files&lt;&lt;<BR>Yes.</P>
<P>Again, the trick is to use the OleDbConnection, OleDbCommand, and OleDbTransaction objects rather than SqlConnection, SqlCommand, and SqlTransaction (which are unique to SqlServer).&nbsp; And it will be easiest to use these if you provide references to the System.Data.OleDb library at the project level.</P>
<P>Hope this helps.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
