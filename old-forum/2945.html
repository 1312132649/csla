<html><header><title>C# templates not retrieving all parameters in stored procedure</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>C# templates not retrieving all parameters in stored procedure</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2945.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ChristianPena posted on Friday, May 25, 2007</h2><P>Good morning,</P>
<P>I would like to first thank you for the CSLAContrib templates. They really make a big difference when generating partial classes.</P>
<P>The issue I am encountering occurs in the nightly build and release versions of the C# templates in CodeSmith 2.6 and 3.2 when interfacing with a SQL Express 2005 database. The issue occurs when generating a read only root list from a stored procedure accepting two parameters. The first parameter is incorporated into the template but the second parameter is not. As a result, the factory method accepts one parameter, the criteria class contains one parameter, and the dataportal fetch method only sends one parameter to the stored procedure being executed.</P>
<P>While I intend to debug the issue as best as I can when I have some time this weekend, I am wondering if anyone else has encountered the issue or can reproduce it.</P>
<P>Please let me know if you want me to provide sample input: table definitions, xml parameter sets, and the code generated as I have these in a zip file, but cannot upload them as this has been restricted. I will paste the contents here:</P>
<P>SQL Definitions:</P>
<P><FONT face="Courier New" size=1>CREATE TABLE [dbo].[Person](<BR>&nbsp;[PersonID] [int] IDENTITY(1,1) NOT NULL,<BR>&nbsp;[FirstName] [varchar](50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,<BR>&nbsp;[LastName] [varchar](50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,<BR>&nbsp;CONSTRAINT [PK_Person] PRIMARY KEY CLUSTERED <BR>(<BR>&nbsp;[PersonID] ASC<BR>)WITH (PAD_INDEX&nbsp; = OFF, IGNORE_DUP_KEY = OFF) ON [PRIMARY]<BR>) ON [PRIMARY]</FONT></P>
<P><FONT face="Courier New" size=1>GO</FONT></P>
<P><FONT face="Courier New" size=1>CREATE TABLE [dbo].[Group](<BR>&nbsp;[GroupID] [int] IDENTITY(1,1) NOT NULL,<BR>&nbsp;[Name] [varchar](50) COLLATE SQL_Latin1_General_CP1_CI_AS NOT NULL,<BR>&nbsp;CONSTRAINT [PK_Group] PRIMARY KEY CLUSTERED <BR>(<BR>&nbsp;[GroupID] ASC<BR>)WITH (PAD_INDEX&nbsp; = OFF, IGNORE_DUP_KEY = OFF) ON [PRIMARY]<BR>) ON [PRIMARY]</FONT></P>
<P><FONT face="Courier New" size=1>GO</FONT></P>
<P><FONT face="Courier New" size=1>CREATE TABLE [dbo].[GroupPerson](<BR>&nbsp;[GroupID] [int] NOT NULL,<BR>&nbsp;[PersonID] [int] NOT NULL,<BR>&nbsp;CONSTRAINT [PK_GroupPerson] PRIMARY KEY CLUSTERED <BR>(<BR>&nbsp;[GroupID] ASC,<BR>&nbsp;[PersonID] ASC<BR>)WITH (PAD_INDEX&nbsp; = OFF, IGNORE_DUP_KEY = OFF) ON [PRIMARY]<BR>) ON [PRIMARY]</FONT></P>
<P><FONT face="Courier New" size=1>GO</FONT></P>
<P><FONT face="Courier New" size=1>CREATE PROCEDURE [dbo].[GetPersonInfo] <BR>&nbsp;@LastName varchar(50) = '', <BR>&nbsp;@GroupName varchar(50) = ''<BR>AS<BR>BEGIN<BR>&nbsp;SET NOCOUNT ON;</FONT></P>
<P><FONT face="Courier New" size=1>&nbsp;SELECT Person.PersonID, FirstName, LastName,<BR>&nbsp;&nbsp;[Group].Name<BR>&nbsp;FROM Person<BR>&nbsp;&nbsp;LEFT JOIN GroupPerson<BR>&nbsp;&nbsp;&nbsp;ON Person.PersonID = GroupPerson.PersonID<BR>&nbsp;&nbsp;LEFT JOIN [Group]<BR>&nbsp;&nbsp;&nbsp;ON GroupPerson.GroupID = [Group].GroupID<BR>&nbsp;WHERE LastName LIKE @LastName<BR>&nbsp;&nbsp;AND Coalesce([Group].Name, '') LIKE @GroupName<BR>END<BR></FONT></P>
<P>XML Parameter Set used to generate the class:</P>
<P><FONT face="Courier New" size=1>&lt;?xml version="1.0" encoding="utf-8"?&gt;<BR>&lt;codeSmith&gt;<BR>&nbsp;&lt;propertySet&gt;<BR>&nbsp;&nbsp;&lt;property name="ResultSetIndex"&gt;0&lt;/property&gt;<BR>&nbsp;&nbsp;&lt;property name="ObjectName"&gt;PersonInfoList&lt;/property&gt;<BR>&nbsp;&nbsp;&lt;property name="ChildName"&gt;PersonInfo&lt;/property&gt;<BR>&nbsp;&nbsp;&lt;property name="RootCommand"&gt;<BR>&nbsp;&nbsp;&nbsp;&lt;connectionString&gt;Data Source=WORKSTATION\SQLEXPRESS;Initial Catalog=Sample;Integrated Security=true;Connection Timeout=1;&lt;/connectionString&gt;<BR>&nbsp;&nbsp;&nbsp;&lt;providerType&gt;SchemaExplorer.SqlSchemaProvider,SchemaExplorer.SqlSchemaProvider&lt;/providerType&gt;<BR>&nbsp;&nbsp;&nbsp;&lt;command&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&lt;owner&gt;dbo&lt;/owner&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&lt;name&gt;GetPersonInfo&lt;/name&gt;<BR>&nbsp;&nbsp;&nbsp;&lt;/command&gt;<BR>&nbsp;&nbsp;&lt;/property&gt;<BR>&nbsp;&nbsp;&lt;property name="ClassNamespace" /&gt;<BR>&nbsp;&nbsp;&lt;property name="PropertyAuthorization"&gt;Both&lt;/property&gt;<BR>&nbsp;&nbsp;&lt;property name="AuthorizationRules"&gt;True&lt;/property&gt;<BR>&nbsp;&nbsp;&lt;property name="TransactionalType"&gt;None&lt;/property&gt;<BR>&nbsp;&nbsp;&lt;property name="GenerationMethod"&gt;Single&lt;/property&gt;<BR>&nbsp;&nbsp;&lt;property name="ClassType"&gt;Generated&lt;/property&gt;<BR>&nbsp;&lt;/propertySet&gt;<BR>&lt;/codeSmith&gt;</FONT></P>
<P>Thanks in advance,</P>
<P>Christian</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ChristianPena replied on Friday, May 25, 2007</h2>After re-running the class generation just now, it appears that is generating the code correctly now. This is quite odd, but I wonder if it is some sort of caching issue within codesmith... Still looking to see if anyone can recreate this issue.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
