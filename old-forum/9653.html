<html><header><title>silverlight using singleton pattern</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>silverlight using singleton pattern</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9653.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>lacota posted on Tuesday, October 19, 2010</h2><p>I need to use a singleton namevalue list in a view model. I am using the sample ProductList as a template. I am not clear how I would implement this. The callback is async but I need to use the results inline with the method calling it. Can anyone point me in the right direction here? Thanks</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>lacota replied on Tuesday, October 19, 2010</h2><p>I tried doing the following;</p>
<p>MySingleton mySingleton = null;</p>
<p>MySingleton.Get((o, e1) = &gt;) {</p>
<p style="padding-left:30px;">if (e1.Error == null &amp;&amp; e1.Object != null) {</p>
<p style="padding-left:30px;">mySingleton = e1.Object;</p>
<p style="padding-left:30px;">}</p>
<p>}</p>
<p>I got a serialization error when the singleton was a namevaluelist but it worked fine when it was a readonly list. I don&#39;t know if this is a bug in the silverlight implementation of the csla.namevaluelist&nbsp;or an error in my implementation.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Tuesday, October 19, 2010</h2><p>I usually maintain the cached value within the business class, so the singleton access occurs through the factory method. So in a read-only class of some sort you&#39;d do this (typed off the top of my head, so probably not exactly right):</p>
<p>private static MyList _cache;<br /><br />public static void GetList(DataPortalResult&lt;MyList&gt; callback)<br />{<br />&nbsp; if (_cache != null)<br />&nbsp;&nbsp;&nbsp; callback(this, new DataPortalResult&lt;MyList&gt;(_cache, null));<br />&nbsp; else<br />&nbsp;&nbsp;&nbsp; DataPortal.BeginFetch&lt;MyList&gt;((o, e) =&gt;<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _cache = e.Object;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; callback(o, e);<br />&nbsp;&nbsp;&nbsp; });<br />}<br /><br />public static void ClearCache()<br />{<br />&nbsp; _cache = null;<br />}</p>
<p>Basically the same pattern as you use with a sync factory method, but with an async factory method.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>lacota replied on Wednesday, October 20, 2010</h2><p>That&#39;s what I have. And it works when the singleton is a readonlylist but I get a serialization error when the singleton is a namevaluelist. It can&#39;t seem to be able to find the type of the value. </p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
