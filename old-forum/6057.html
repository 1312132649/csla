<html><header><title>Coding Business Objects with CSLA 3.6 and LINQ to SQL- but no data in grid</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Coding Business Objects with CSLA 3.6 and LINQ to SQL- but no data in grid</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6057.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Lyndon posted on Saturday, December 27, 2008</h2><P>Hi,</P>
<P>I have coded my business objects ( a list class, a single&nbsp;entity&nbsp;class&nbsp;and the info class&nbsp;, along with code for a web based front end and the structure to represent a DAL and a Library,&nbsp;to reflect the examples in the book Expert C# 2008 Business Objects. However, while everything compiles correctly, no data is returned to the grid i have created.</P>
<P>I am utilizing Windows Authentication, making sure that the web site disables anonymous access and enables Windows Authentication etc. I have set the appropriate changes in the web.config file.</P>
<P>I am suspecting that I am missing something small. <STRONG>Any ideas as to what might cause no data to show up?</STRONG> (there is data in the&nbsp; table in the database&nbsp;&nbsp; ;-)&nbsp; )</P>
<P>I have installed the project tracker application&nbsp; which points to the projecttracker database on the same sql server as my above application and it works, so I am pretty sure much of the database itself is properly configured on the server.</P>
<P>I can include my code in a subsequent reply to this post. Was just wondering if this was something really simple that I havent configured?</P>
<P>Thanks</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>lukky replied on Saturday, December 27, 2008</h2>Lyndon,<br><br>Does the data make it into the BOs ?<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Lyndon replied on Saturday, December 27, 2008</h2><P>From what I can see no.</P>
<P>I did look a little further into my code for the web page and noticed that I hadnt coded in the</P><FONT color=#ff0000 size=2>
<P>OnSelectObject</FONT><FONT color=#0000ff size=2>="PriorityListDataSource_SelectObject" as part of the CSLA datasource. So it wasnt linking up with the code to go get the business object</FONT></P>
<P><FONT color=#0000ff size=2>I finally fixed that, but now it looks for the database and cannot find the database name, even though its in the app.config, web.config, and the Database.cs code in the DAL library.</FONT></P>
<P><FONT color=#0000ff size=2>In running a trace, it looks like it isnt authorizing me to do the select. It seems to skip that code and go directly to a deny authorization segment.</FONT></P>
<P><FONT color=#0000ff size=2>I am assuming then it must be something to do with the security classes.</FONT></P>
<P><FONT color=#0000ff size=2>In Lhotka's latest book he seeems to imply that if Windows authentication is used that PTPrincipal and PTSecurity arent needed. So I havent included any specialized code ( used for custom authentication) in my solution/projects. I just wanted to get data back initially without imposing any role restrictions. Can all parts of the security model be 'ignored' initially for authorization/authentication if&nbsp; one is intending to use Windows Integrated Security ? Or are their certain base parts of the security model that must be in place , even if windows autheincation is used?</FONT></P>
<P><FONT color=#0000ff size=2>web.config file has csla.authentication="Windows" and&nbsp; authenication mode =Windows and identity impersonate = true.&nbsp; IIS server has anonymous access disabled, windows authentication enabled and impersonation enabled.</FONT></P>
<P><FONT color=#0000ff size=2></FONT>&nbsp;</P>
<P><FONT color=#0000ff size=2>Thanks</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Monday, December 29, 2008</h2><P>Is the database located on the same box as the web server?</P>
<P>If not, then you have run into the problem of 2 network hops which is difficult to do with Windows security. See p431 of the C# 2008 book. Rocky does not solve the problem for you in this case. You may have to Google this one.</P>
<P>Try the same solution using custom Principal code and it should work fine across 2 hops.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Lyndon replied on Tuesday, December 30, 2008</h2><P>Hi Joe,</P>
<P>Thank you.</P>
<P>Yes it is on the same box as the web server. At this point I am trying only the simplest of&nbsp; configurations. ie everything on one machine, and no special security -Windows Authentication only. Whenever I try out new versions of the CSLA framework , my first goal is to just get data to appear on the grid using the new framework.</P>
<P>I now have it as far as hanging in the dataportal fetch area. The message coming back in the web application is</P>
<P>DataPortal.Fetch failed (Database name not found in config file (HRSMV20)) in the Dataportal.cs program.</P>
<P>Modelling after the project tracker application, I have the following code in my Database.cs file</P><FONT color=#0000ff size=2>
<P>using</FONT><FONT size=2> System;</P></FONT><FONT color=#0000ff size=2>
<P>using</FONT><FONT size=2> System.Collections.Generic;</P></FONT><FONT color=#0000ff size=2>
<P>using</FONT><FONT size=2> System.Linq;</P></FONT><FONT color=#0000ff size=2>
<P>using</FONT><FONT size=2> System.Text;</P></FONT><FONT color=#0000ff size=2>
<P>namespace</FONT><FONT size=2> HRSMCSLA3.DAL</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>class</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>Database</P></FONT><FONT size=2>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>const</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> HRSMV20 = </FONT><FONT color=#a31515 size=2>"HRSMV20"</FONT><FONT size=2>;</P>
<P>}</P>
<P>}</P>
<P>The linq to SQL dbml file name &nbsp;is HRSMV20</P>
<P>AND</P>
<P>my web.config file includes the following along with the app.config files</P><FONT color=#0000ff size=2>
<P>&lt;</FONT><FONT color=#a31515 size=2>connectionStrings</FONT><FONT color=#0000ff size=2>&gt;</P>
<P>&lt;</FONT><FONT color=#a31515 size=2>add</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>name</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>HRSMCSLA3.DAL.Properties.Settings.HRSMV20ConnectionString</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>connectionString</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>Data Source=LYNDON-MAIN\VS2008;Initial Catalog=HRSMV20;Integrated Security=True</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>providerName</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>System.Data.SqlClient</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>/&gt;</P>
<P>&lt;/</FONT><FONT color=#a31515 size=2>connectionStrings</FONT><FONT color=#0000ff size=2>&gt;</FONT></P>
<P><FONT color=#0000ff size=2>CSLA Authenication is Windows</FONT></P>
<P><FONT color=#0000ff>Authentication Mode is Windows</FONT></P>
<P><FONT color=#0000ff>Impersonate =true</FONT></P>
<P><FONT color=#0000ff>and</FONT></P>
<P><FONT color=#0000ff><FONT size=2>Anonymous access turned off, Windows Integrated Security is turned on (using IIS 7.0)</FONT></FONT></P>
<P><FONT color=#0000ff><FONT size=2></FONT></FONT>&nbsp;</P>
<P><FONT color=#0000ff><FONT size=2>My mistake is probably something really simple- but these are the hardest to trackdown&nbsp;&nbsp; ;-)&nbsp; :(</P></FONT></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Lyndon replied on Friday, January 02, 2009</h2><P>Problem resolved.</P>
<P>Developer error :(</P>
<P>I had assumed the name in the&nbsp;connect string in the app.config file was supposed to be the same as the web.config.</P>
<P>It wasnt.</P>
<P>Lhotka's project tracker example had it correct. I didnt&nbsp; </P>
<P>My bad.</P>
<P>Thanks for everyones help</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
