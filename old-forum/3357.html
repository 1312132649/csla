<html><header><title>Accessing database from another machine</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Accessing database from another machine</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3357.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>kc123 posted on Thursday, August 09, 2007</h2>Hi,<br><br>I have done 2 csla projects so far and both are in a single machine, meaning the UI layer, BO layer and the database are all in a single machine.<br><br>Recently we are going to do a csla project at work and the database is in a separate server.&nbsp; So I modify the app.config file to look like this<br><br><br>&lt;add name="VIP3Connection"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ConnectionString="Data Source=139.69.2.70,1433; Network Library=DBMSSOCN; Initial Catalog=TestDatabase; user id=sa; password=;"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ProviderName="System.Data.SqlClient"/&gt;<br><br>where 139.69.2.70 is the IP address of the database server.<br><br>When I run it, I got a "Configuration system failed to initialized" error when the program is trying to access the ConfigurationManager.AppSettings("CslaDataPortalProxy").&nbsp; Does anybody knows that what other step(s) that I am missing here?<br><br>Your help will be highly appreciated!<br><br>KC<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, August 09, 2007</h2><FONT color=#0000ff size=2>
<P><FONT color=#0000ff size=2><FONT color=#000000>My config file looks like this:</FONT></P>
<P></FONT>&lt;</FONT><FONT color=#a31515 size=2>appSettings</FONT><FONT color=#0000ff size=2>&gt;<BR></FONT><FONT color=#0000ff size=2>&nbsp; &lt;</FONT><FONT color=#a31515 size=2>add</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>key</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>ConnectionString</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>value</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>data source=myServer;database=someDB;User ID=myAppUser;password=somePwd</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> /&gt;<BR></FONT><FONT color=#0000ff size=2>&nbsp; &lt;</FONT><FONT color=#a31515 size=2>add</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>key</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>CslaAuthentication</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>value</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>CSLA</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> /&gt;<BR></FONT><FONT color=#0000ff size=2>&lt;/</FONT><FONT color=#a31515 size=2>appSettings</FONT><FONT color=#0000ff size=2>&gt;</FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#000000>The <FONT size=2>ApplicationContext module looks in the config file for the setting: key="</FONT></FONT><FONT color=#000000>CslaDataPortalProxy".</FONT></FONT></P>
<P><FONT size=2>If it does not find it then it configures the DataPortal as Local.</FONT></P><FONT color=#0000ff size=2>
<P>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>ReadOnly</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</FONT><FONT size=2> DataPortalProxy() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String<BR></FONT><FONT color=#0000ff size=2>Get<BR></FONT><FONT color=#0000ff size=2>&nbsp; Dim</FONT><FONT size=2> result </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> =&nbsp;ConfigurationManager.AppSettings(</FONT><FONT color=#ff00ff size=2>"CslaDataPortalProxy"</FONT><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2>&nbsp; If</FONT><FONT size=2> Len(result) = 0 </FONT><FONT color=#0000ff size=2>Then<BR></FONT><FONT size=2>&nbsp;&nbsp;&nbsp; result = </FONT><FONT color=#ff00ff size=2>"Local"<BR></FONT><FONT color=#0000ff size=2>&nbsp; End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If<BR></FONT><FONT color=#0000ff size=2>&nbsp; Return</FONT><FONT size=2> result<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Get<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</P></FONT>
<P><FONT color=#0000ff size=2><FONT color=#000000>Joe</FONT></FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#000000></FONT>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kc123 replied on Thursday, August 09, 2007</h2>Thanks for your pointer.&nbsp; You gave me some idea so at least now I can read from the database, although I am not doing it right (hard coding instead of reading from the app.config file)<br><br>In Rocky's code, he put the connection string in the connectionStrings node of the app.config file instead of in the appSettings node of the app.config file, like in your example.&nbsp; Then he has a Module named Database and has two string properties of ConnectionString for the program to read from.&nbsp; Thats what I did and I am getting error.<br><br>But when I hard coded the connection string into the property, it works, I can read from the database.<br><br>Here are the relevant code that does not work:<br><br>Imports System.Configuration.ConfigurationManager<br>Public Module Database<br>&nbsp;&nbsp;&nbsp; Public ReadOnly Property VIP3Connection() As String<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return ConnectionStrings("VIP3Connection").ConnectionString<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp; End Property<br>End Module<br><br><br>Then in the app.config file, I have:<br><br>&lt;ConnectionStrings&gt;<br>&nbsp;&nbsp;&nbsp; &lt;add name="VIP3Connection"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ConnectionString="Data Source=139.69.2.70,1433; Network Library=DBMSSOCN; Initial Catalog=TestDatabase; user id=sa; password=;"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ProviderName="System.Data.SqlClient"/&gt;<br>&nbsp; &lt;/ConnectionStrings&gt;<br><br><br>But when I do this, it work:<br><br>Public Module Database<br>
&nbsp;&nbsp;&nbsp; Public ReadOnly Property VIP3Connection() As String<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return "Data Source=139.69.2.70,1433; Network Library=DBMSSOCN; Initial Catalog=TestDatabase; user id=sa; password=;"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>
&nbsp;&nbsp;&nbsp; End Property<br>
End Module<br><br>Plus commenting out the ConnectionStrings node in the app.config file.<br><br>So for some reason I have trouble reading from the app.config file.<br><br>KC<br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
