<html><header><title>Validation of children in a collection object</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Validation of children in a collection object</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/944.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai posted on Friday, August 18, 2006</h2><P>Hi guys.</P>
<P>I have seen similar posts to this but no definitive answer.&nbsp;&nbsp;Say you have a collection that contains child objects and you add several children before calling save.&nbsp; What if one of those children violates a business rule?&nbsp; You get an "Object is not valid and cannot be saved" exception but how can you tell the user why the object is not valid?&nbsp; The collection will have an empty BrokenRulesCollection and it seems the only way to know what the broken rule is and indeed which object is breaking it is to use the debugger - obviously not possible on a user's pc.&nbsp; </P>
<P>How have other people soleved this problem?&nbsp; I tried to work out a way to look at the object's properties, determine which were business objects and check their BrokenRulesCollection properties too but it got really messy, especially when children had child collections themselves!</P>
<P>Any help or advise with this would be great.&nbsp; This is more of a problem in the web, as I can use an errorprovider and datagridview with a windows form.</P>
<P>John.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Friday, August 18, 2006</h2>The way I like the best so far is to pop up a dialog that has a tree on it.&nbsp; The tree displays the broken rules for the parent and all of its children.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RangerGuy replied on Friday, August 18, 2006</h2><P>For the web ui... could you loop thru all the child collections checking for invalid children and grab the broken rules for each child?</P>
<P>I haven't touched validation yet so it's only a guess :)</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai replied on Friday, August 18, 2006</h2><P>This is a reply to both Brian and RangerGuy.</P>
<P>Yes you can loop thru an object and display the child broken rules in a treeview or otherwise, but the key here is that you would have to code this functionality for every collection object i.e. I have not found a way to generically do this for all objects and show broken rules in a single dialog box. That is the real problem!</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Friday, August 18, 2006</h2>You can use reflection to iterate over the properties and look for properties that implement IDataErrorInfo or IList.&nbsp; You can walk down these properties to the children, grandchildren, etc. and build the tree.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai replied on Saturday, August 19, 2006</h2><P>Brian</P>
<P>That is what I tried to do but struggled.&nbsp; Do you have any code you could post to do this?</P>
<P>TIA</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Saturday, August 19, 2006</h2><P>To each of my Objects and Collections&nbsp;I have added:</P>
<P>Public ReadOnly Property BrokenRulesString() as String&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' Use a StringBuilder to Concatenate all BrokenRulesStrings from all Children<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<BR>End Property</P>
<P>If a Collection is not valid, I call its BrokenRulesString to get a listing of broken rules of all its children.&nbsp; Each object identifies itself in the list of broken rules it sends back, and also inserts line breaks etc as needed.&nbsp; Empty String comes back if no rules are broken.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </P>
<P>Jav</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tetranz replied on Friday, August 18, 2006</h2>If you're showing the collection on a grid then, I don't know about other grids but the Janus grid very nicely highlights objects with broken rules using IDataErrorInfo<br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
