<html><header><title>Extending NameValueListBase for multilanguage purposes</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Extending NameValueListBase for multilanguage purposes</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/652.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>stefan posted on Tuesday, July 18, 2006</h2>Hi,<br><br>in order to facilitate at least multilingual reports, I need to find a way to provide my presentation layer with the translated versions of the strings that are kept in all those lookup-tables. <br>Think of a 'payment mode' that's presented depending on the origin of the customer. <br><br>First I thought of extending NameValueListBase, providing it with a Lanuage_ID Property somewhere, i.e. inside its criteria class, making all NameValueListBase derived objects language-aware by default.<br><br>I wonder if&nbsp; there's an easier way to accomplish this.<br>Perhaps I should just inherit from NameValueListBase, add the language property, and use this one as my base class in the future, thus avoiding conflicts with future CSLA updates.<br><br>Any help is appreciated.<br><br>Stefan<br><br><br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, July 18, 2006</h2><P>I would suggest your second option: creating a subclass of NVLB to add the language property.</P>
<P>However, I would also suggest that .NET has a partial answer for you in the form of Culture. On the Thread object you'll find a couple culture properties, and most code keys off the UICulture&nbsp;for this sort of thing.</P>
<P>The data portal even carries the client-side culture values over to the server (look at Chapter 4 and the discussion of ApplicationContext), so you get consistent access to the user's culture even on the application server.</P>
<P>If you can use the built-in culture value, perhaps you don't need a custom NVLB at all, but rather can just have your DataPortal_Fetch() rely on this standard value.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>stefan replied on Tuesday, July 18, 2006</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>RockfordLhotka:</strong></div><div><p>...</p><p>However, I would also suggest that .NET has a partial answer for you in the form of Culture. On the Thread object you'll find a couple culture properties, and most code keys off the UICulture&nbsp;for this sort of thing.</p>
<p>...</p><p>If you can use the built-in culture value, perhaps you don't need a custom NVLB at all, but rather can just have your DataPortal_Fetch() rely on this standard value.</p></div></BLOCKQUOTE><br><br>Thanks Rocky for your reply an your hint towards the Thread.Culture object and DataPortal features.<br><br>However they intend to provide what's called localization (Is this the right word?).<br>So it's something that's client-based. I need something that's data-based. <br>Remember the customer from India, who's receiving his invoice in English (data-based), <br>whereas our software-user edits the&nbsp; invoice in his localized language (client-based).<br><br>So I will go with my second option.<br><br>Thanks again,<br><br>Stefan<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, July 18, 2006</h2><P>No problem, use what works <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /></P>
<P>But to be clear, the thread culture settings are for locationalization - that's why they are in .NET in the first place. The culture specifies the language in use on the client workstation, which is typically the language the user wants to see. .NET automatically uses this culture setting to pull resources based on that culture (CSLA .NET uses this to localize all its string values for instance).</P>
<P>However, you can get the language value (such as en for english, ru for russian, etc.) from the culture object as well. Your code can then use that language value to tailor its data queries.</P>
<P>Of course I could be totally misunderstanding your problem - but if all you need to do is pass a language value (such as en, es, ro, it and so forth) to the server so your data portal code can do the right queries per-language, then culture already does this for you.</P>
<P>On the other hand, if your database includes the customer's language choice and you are tailoring the data queries based on that customer data value, then I don't see why you'd pass it via criteria at all. The value is already in the database after all, so it doesn't (to me anyway) make sense to pull it back to the client just to send it to the server again.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kids_pro replied on Sunday, July 23, 2006</h2>Rocky,<br><br>I also run into the same situation.<br>Using thread culture might not work since windows does not know my culture yet.<br>What I been thinking is to path something to dataportal so that it return correct language.<br><br>Thanks,<br>Kids<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bonio replied on Monday, July 24, 2006</h2>With reference to:<BR><BR>"..I would suggest your second option: creating a subclass of NVLB to add the language property..."<BR><BR>....as a relative noob to programming, how would you go about subclassing the NVLB or more particularly its Criteria class?<BR><BR>Sorry for the dumbass question, but still learning <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /><BR><BR><BR>Thanks<BR><BR>Bonio</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, July 24, 2006</h2>




<DIV align=left><SPAN class=294125514-24072006><FONT face=Arial color=#0000ff size=2>You can see how to do this in chapters 7 and 
8.</FONT></SPAN></DIV>
<DIV align=left><SPAN class=294125514-24072006><FONT face=Arial color=#0000ff size=2></FONT></SPAN>&nbsp;</DIV>
<DIV align=left><SPAN class=294125514-24072006><FONT face=Arial color=#0000ff size=2>Rocky</FONT></SPAN></DIV><BR>
<BLOCKQUOTE>....as 
  a relative noob to programming, how would you go about subclassing the NVLB or 
  more particularly its Criteria class?<BR></BLOCKQUOTE></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Gort replied on Thursday, November 04, 2010</h2><p>I did it this way:<br />&nbsp;<br />&nbsp;//Factory Method<br />&nbsp;private static Hashtable _list;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static AddressTypeList GetAll()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_list == null)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { //initial load, just get the default culture list<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _list = new Hashtable();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _list[Thread.CurrentThread.CurrentCulture.Name] = DataPortal.Fetch&lt;AddressTypeList&gt;();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if (_list[Thread.CurrentThread.CurrentCulture.Name] == null)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { //need to load the list for this culture<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _list[Thread.CurrentThread.CurrentCulture.Name] = DataPortal.Fetch&lt;AddressTypeList&gt;();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return (AddressTypeList)_list[Thread.CurrentThread.CurrentCulture.Name];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>And in my Fetch, I have:<br />&nbsp;do<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.Add(new NameValuePair(reader.GetInt32(&quot;AddressTypeId&quot;), ResourceHelper.GetResource(reader.GetString(&quot;AddressTypeCd&quot;), ResourceFiles.Lookups, true)));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } while (reader.Read());</p>
<p>In my database, I have &#39;AddressType_Home&#39;, &#39;AddressType_Work&#39;, etc. which matches key/values in my resource files.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
