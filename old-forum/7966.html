<html><header><title>Implementing Add/Remove for 2 ListBoxes in Silverlight</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Implementing Add/Remove for 2 ListBoxes in Silverlight</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7966.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Gareth posted on Tuesday, November 10, 2009</h2><P>Hi all, I've got myself stuck on a problem in CSLA for Silverlight that I can't seem to get my head around.</P>
<P>I'm implementing the concept of two list boxes, the first containing items that have been selected, the second containing items that are available for selection. The contents of each are mutually exclusive.</P>
<P>There are Add and Remove buttons to move listitems between the two boxes, along with a Save and Cancel button. (See attached screen shot).</P>
<P>The two list boxes use a CSLA data provider to source the data. This works okay to load the initial values as you can see from the screen shot.</P>
<P>Clicking on Add&nbsp;executes the following code:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>private</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>void</FONT></FONT><FONT size=2> AddButton_Click(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2> sender, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>RoutedEventArgs</FONT></FONT><FONT size=2> e) {</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>var</FONT></FONT><FONT size=2> srce = availColourData.Data </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>as</FONT></FONT><FONT size=2> Business.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ProductColourList</FONT></FONT><FONT size=2>;</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>var</FONT></FONT><FONT size=2> dest = usedColourData.Data </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>as</FONT></FONT><FONT size=2> Business.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ProductColourList</FONT></FONT><FONT size=2>;</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2> index = AvailColorListBox.SelectedIndex;</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>if</FONT></FONT><FONT size=2> (index &gt;= 0) {</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;var</FONT></FONT><FONT size=2> item = srce[index];</P>
<P>&nbsp;&nbsp;&nbsp;srce.Remove(item);</P>
<P>&nbsp;&nbsp;&nbsp;dest.Add(item);</P>
<P>}}</P>
<P>.<FONT size=3>and that moves the selected item across to the other list box.</FONT></P>
<P><FONT size=3>When I click on Save I want to save the items that are in the 'selected items' list box.</FONT></P>
<P><FONT size=3>This is where my problem is, I can't work out how to do this.</FONT></P>
<P><FONT size=3>My colour list business objects are defined as follows:</FONT></P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>partial</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>class</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ProductColourList</FONT></FONT><FONT size=2> : </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>BusinessListBase</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ProductColourList</FONT></FONT><FONT size=2>, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ProductColour</FONT></FONT><FONT size=2>&gt;</FONT></P><FONT size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>partial</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>class</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ProductColour</FONT></FONT><FONT size=2> : </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>BusinessBase</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ProductColour</FONT></FONT><FONT size=2>&gt;</FONT></P>
<P><FONT size=2><FONT size=3>Ideally I want to save all the 'selected items' in one go, not make a call through the layers each time. </FONT></FONT></P>
<P><FONT size=2><FONT size=3>Currently I'm getting an Update method not implemented error because I don't know where to implement my update method, having got all confused about how I should be doing this.</FONT></FONT></P>
<P><FONT size=2><FONT size=3>I've looked in the samples and I can't find anything similar. Has anyone implemented anything like this?</FONT></FONT></P>
<P><FONT size=2><FONT size=3>Cheers,</FONT></FONT></P>
<P><FONT size=2><FONT size=3>Gareth.</FONT></P></FONT></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DancesWithBamboo replied on Tuesday, November 10, 2009</h2>I haven't done this exact thing yet so take this for what it is worth.&nbsp; <br><br>I would make only 1 BO list bound to both ListBoxes and have a "Selected" property on the ProductColour BO.&nbsp; Then when you move it from list to list you simple flip the flag.&nbsp; You can bind the visible property of your "Selected" list ListItems to this property and the "Unselected" list ListItems to the inverse of it.&nbsp; When you Save, you just decide if it is an Insert/Update/Delete based on the flag.&nbsp; <br><br>By the way, drag-and-drop would be nice between the 2 listboxes.<br><br>Cheers<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Gareth replied on Monday, November 16, 2009</h2>Ok, so I managed to bind 1 BO List to the GUI Listboxes using a Selected property to bind via a VisibilityConverter. <br />The items display and can be added and removed. However the non-Visible (collapsed) items still show up as a thin horizontal line in the Listbox. I assume its because the ListBoxItem is visible but the TextBlock inside is hidden. How can I change the Visibility of each ListBoxItem?<br /><br />See attached code.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
