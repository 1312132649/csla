<html><header><title>Child insert but no update</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Child insert but no update</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7606.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Vlam100 posted on Friday, September 11, 2009</h2>Hi All,<br /><br />I am new to the CSLA frame work and I am doing my first project. using vb.net one of my requirements is to do an Import from a excel spreadsheet.<br /><br />I have a parent object EmployeeImport, and then two child objects EmployeeImportItem which represent one record and then EmployeeImportItems which is the collection of employeeimprtItem.<br /><br />For new Employees in the spreadsheet I call the newEmployee  factory method in the employeeImportItem and it sets the values of all the properties.<br /><br />For existing participants I call the getEmployee factory Method in the EmployeeImprtItem and do a fetch to get all the values and then overwrite with values from the spreadsheet<br /><br /><br /><br />I then add them to the collection.<br /><br />resource.add me.add(resource)<br /><br />after everything has been added to the collection I call mybase.save to save the the data, but at this stage it will only do the insert for the new employees..child_insert in the child and whatever I do I cant get the Child_update to fire for the existing employees.  From tha parent I call <br /><br />DataPortal.UpdateChild(ReadProperty(Of EmployeeImportItems)(ItemsProperty), Me)</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
