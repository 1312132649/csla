<html><header><title>new syntax for adding items to collections</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>new syntax for adding items to collections</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7117.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>matt tag posted on Wednesday, June 17, 2009</h2><font size="1" face="Verdana"><br>Bear with me, please-&nbsp; just learning the intricacies of CSLA 3.6.3.&nbsp; (trying to convert a project from 1.51, ooof).<br><br>In the old days, when adding an item to a collection, I would often have methods like this one on my collection classes<br><br>Class CollectionOfObjs<br><br>&nbsp;&nbsp;&nbsp; Public Function Add() As SomeObj<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim o As </font><font size="1" face="Verdana">SomeObj</font><font size="1" face="Verdana"> = </font><font size="1" face="Verdana">SomeObj</font><font size="1" face="Verdana">.NewObject<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List.Add(o)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return o<br>&nbsp;&nbsp;&nbsp; End Function<br><br>End Class<br><br>Now, the Add method is built into the BusinessListBase, so my old Add method above has a naming conflict.&nbsp; My first thought was I could just remove my own Add method above.&nbsp; However, SomeObj.NewObject is scoped as Friend, so I currently cannot easily move the "add" code to the UI.&nbsp; So this won't work from the UI.<br><br>o = fList.Add(SomeObj.NewObject)&nbsp;&nbsp; &lt;- does not work, NewObject is "Friend" and inaccessible from UI<br><br>Is the preferred convention to simply rename my "Add" function above to "AddItem" and leave it as-is, or should I instead change the scoping of the </font><font size="1" face="Verdana">NewObject </font><font size="1" face="Verdana">factory method on the child object to Public so I can add it from the UI?<br><br></font><font size="1" face="Verdana">thanks<br>matt tag<br></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, June 17, 2009</h2><P>Actually Add() is part of (I think) BindingList&lt;T&gt; - it comes from some Microsoft base class, not mine.</P>
<P>I think you can do as you suggest - create AddItem().</P>
<P>You can also use the IBindingList approach to "light up" the AddNew() method by overriding AddNewCore(), and that might be the better idea. Then you'd work automatically with data binding against grids too.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>matt tag replied on Wednesday, June 17, 2009</h2><font size="1" face="Verdana">overriding AddNewCore will work also - except in the cases where I need to pass in some parameter from the outside that in turn gets passed to the child .NewObject&nbsp; For example, the NewObject might be passed a Default value or something.&nbsp; Then my code is more like<br><br></font><font size="1" face="Verdana">Class CollectionOfObjs<br><br>&nbsp;&nbsp;&nbsp; Public Function AddItem(iDefaultValue as integer) As SomeObj<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim o As </font><font size="1" face="Verdana">SomeObj</font><font size="1" face="Verdana"> = </font><font size="1" face="Verdana">SomeObj</font><font size="1" face="Verdana">.NewObject(</font><font size="1" face="Verdana">iDefaultValue)</font><br><font size="1" face="Verdana">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List.Add(o)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return o<br>&nbsp;&nbsp;&nbsp; End Function<br><br>End Class<br><br><br>I'm not sure how I would pass these default values through to an overridden AddNewCore.<br></font><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, June 17, 2009</h2>Yeah, you really can't pass any parameters to AddNewCore() - that's one limitation of the approach. That whole thing is designed to support datagrid controls through data binding, and of course data binding would never have a parameter (or any knowledge of such a concept) to pass into the method.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
