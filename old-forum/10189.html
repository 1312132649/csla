<html><header><title>Question Re Busines Rule that depends upon Two Properties</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Question Re Busines Rule that depends upon Two Properties</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10189.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav posted on Tuesday, March 22, 2011</h2><p>My two properties are a bool? and a string.<br />The Rule is that if bool = true then the string must not be empty.<br /><br />I can use a single BusinessRule class for both Properties by using two Constructor overloads.<br />But the&nbsp;PropertyStatus control can only reflect the state of one property.&nbsp; SL&#39;s built-in mechanism has the same issue.</p>
<p>I was thinking of creating a single property in the ViewModel that could reflect the state of the two Model properies, and then attach the PropertyStatus control to it.&nbsp; But perhaps there is a simpler solution.&nbsp; I have a number of these kind of couplets.</p>
<p>Jav</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Tuesday, March 22, 2011</h2><p>Create your own BusinessRule that inherits from Required rule and add a Dependency rule from BoolProperty to SomeProperty - something like this: </p>
<p>&nbsp;&nbsp;&nbsp; <span style="color:#0000ff;font-weight:bold;">public</span>&nbsp;<span style="color:#ff0000;">class</span>&nbsp;RequiredWhenOtherIsTrue : Csla<span style="color:#006400;">.</span>Rules<span style="color:#006400;">.</span>BusinessRule<br />
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#006400;">{</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;font-weight:bold;">private</span>&nbsp;IPropertyInfo _boolProperty<span style="color:#006400;">;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;font-weight:bold;">public</span>&nbsp;<span style="color:#191970;font-weight:bold;">RequiredWhenOtherIsTrue</span><span style="color:#006400;">(</span>IPropertyInfo primaryProperty<span style="color:#006400;">,</span>&nbsp;IPropertyInfo boolProperty<span style="color:#006400;">)</span>&nbsp;:&nbsp;<span style="font-weight:bold;">base</span><span style="color:#006400;">(</span>primaryProperty<span style="color:#006400;">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#006400;">{</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_boolProperty = boolProperty<span style="color:#006400;">,</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;font-weight:bold;">if</span>&nbsp;<span style="color:#006400;">(</span>InputProperties ==&nbsp;<span style="font-weight:bold;">null</span><span style="color:#006400;">)</span>&nbsp;InputProperties =&nbsp;<span style="color:#008b8b;font-weight:bold;">new</span>&nbsp;System<span style="color:#006400;">.</span>Collections<span style="color:#006400;">.</span>Generic<span style="color:#006400;">.</span>List<span style="color:#006400;">&lt;</span>IPropertyInfo<span style="color:#006400;">&gt;();</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InputProperties<span style="color:#006400;">.</span><span style="color:#191970;font-weight:bold;">Add</span><span style="color:#006400;">(</span>boolProperty<span style="color:#006400;">);</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#006400;">}</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;font-weight:bold;">protected</span>&nbsp;<span style="color:#a52a2a;">override</span>&nbsp;<span style="color:#ff0000;">void</span>&nbsp;<span style="color:#191970;font-weight:bold;">Execute</span><span style="color:#006400;">(</span>Csla<span style="color:#006400;">.</span>Rules<span style="color:#006400;">.</span>RuleContext context<span style="color:#006400;">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#006400;">{</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#000080;">var</span>&nbsp;booltest =&nbsp;<span style="color:#006400;">(</span><span style="color:#ff0000;font-weight:bold;">bool</span><span style="color:#006400;">)</span>&nbsp;context<span style="color:#006400;">.</span>InputPropertyValues<span style="color:#006400;">[</span>_boolProperty<span style="color:#006400;">];</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;font-weight:bold;">if</span>&nbsp;<span style="color:#006400;">(</span>booltest<span style="color:#006400;">)</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-weight:bold;">base</span><span style="color:#006400;">.</span><span style="color:#191970;font-weight:bold;">Execute</span><span style="color:#006400;">(</span>context<span style="color:#006400;">);</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#006400;">}</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#006400;">}</span></p>
<p>&nbsp;&nbsp;&nbsp; <span style="color:#0000ff;font-weight:bold;">protected</span>&nbsp;<span style="color:#a52a2a;">override</span>&nbsp;<span style="color:#ff0000;">void</span>&nbsp;<span style="color:#191970;font-weight:bold;">AddBusinessRules</span><span style="color:#006400;">()</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#006400;">{</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#008000;">// call base class implementation to add data annotation rules to BusinessRules&nbsp;</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-weight:bold;">base</span><span style="color:#006400;">.</span><span style="color:#191970;font-weight:bold;">AddBusinessRules</span><span style="color:#006400;">();</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BusinessRules<span style="color:#006400;">.</span><span style="color:#191970;font-weight:bold;">AddRule</span><span style="color:#006400;">(</span><span style="color:#008b8b;font-weight:bold;">new</span>&nbsp;<span style="color:#191970;font-weight:bold;">RequiredWhenOtherIsTrue</span><span style="color:#006400;">(</span>SomeProperty<span style="color:#006400;">,</span>&nbsp;BoolProperty<span style="color:#006400;">);</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BusinessRules<span style="color:#006400;">.</span><span style="color:#191970;font-weight:bold;">AddRule</span><span style="color:#006400;">(</span><span style="color:#008b8b;font-weight:bold;">new</span>&nbsp;<span style="color:#191970;font-weight:bold;">Dependency</span><span style="color:#006400;">(</span>BoolProperty<span style="color:#006400;">,</span>&nbsp;SomeProperty<span style="color:#006400;">);</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#006400;">}</span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Tuesday, March 22, 2011</h2><p>Johny,</p>
<p>Thank you.&nbsp; I think I get it.&nbsp; Rocky does mention the Dependency rule in his Objects eBook.&nbsp; Should have looked in there first.</p>
<p>Jav</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
