<html><header><title>Set DataPortalProxy from dll</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Set DataPortalProxy from dll</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4379.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>madsgonzo@hotmail.com posted on Wednesday, February 20, 2008</h2><P>Hi</P>
<P>I´m creating a shared addin for Office word, Outlook and Excel. When the addin is build a <EM>.dll</EM> and a <EM>.dll.config</EM>&nbsp;is created, but the&nbsp;ConfugurationManager used in CSLA can not read&nbsp;the <EM>.dll.config</EM> file - so it always returns a LocalDataPortalProxy, and i use a remote one.</P>
<P>This seems to be by .NET design. But I need a Shared Addin, to many problems using VSTO.<BR>In VSTO I could use a .dll with no problems.</P>
<P>Is there any way I can force a RemoteProxy without changing CSLA? Or does any one have a better idea?</P>
<P>Have a nice day.<BR>Mads</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, February 20, 2008</h2>I have an outlook add-in and it uses the assembly.dll.config file.&nbsp; Are you sure you're deploying it correctly?&nbsp; My add-in wouldn't work because my db connection is in that file.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>madsgonzo@hotmail.com replied on Wednesday, February 20, 2008</h2><FONT color=#0000ff size=2>
<P><FONT color=#000000>This is the content of the office.dll.config file. </FONT></P>
<P>&lt;?</FONT><FONT color=#a31515 size=2>xml</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>version</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>1.0</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>encoding</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>utf-8</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>?&gt;<BR>&lt;</FONT><FONT color=#a31515 size=2>configuration</FONT><FONT color=#0000ff size=2>&gt;<BR>&lt;</FONT><FONT color=#a31515 size=2>appSettings</FONT><FONT color=#0000ff size=2>&gt;</FONT><FONT color=#0000ff size=2><BR>&lt;</FONT><FONT color=#a31515 size=2>add</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>key</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>CslaDataPortalProxy</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>value</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>Csla.DataPortalClient.RemotingProxy, Csla</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> /&gt;<BR>&lt;</FONT><FONT color=#a31515 size=2>add</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>key</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>CslaDataPortalUrl</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> </FONT><FONT color=#ff0000 size=2>value</FONT><FONT color=#0000ff size=2>=</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2>http://win2003svr/Host/RemotingPortal.rem</FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2> /&gt;<BR>&lt;/</FONT><FONT color=#a31515 size=2>appSettings</FONT><FONT color=#0000ff size=2>&gt;<BR>&lt;/</FONT><FONT color=#a31515 size=2>configuration</FONT><FONT color=#0000ff size=2>&gt;</FONT></P>
<P><FONT color=#0000ff size=2>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>madsgonzo@hotmail.com replied on Thursday, February 21, 2008</h2><P><FONT face=Arial size=2>If I create a&nbsp;C:\Program Files\Microsoft Office\OFFICE11\WINWORD.EXE.config file CSLA reads the information just fine. But I can´t distribute config files to the end-users Office folder.</FONT></P>
<P><FONT face=Arial size=2>Is there some way to force CSLA to read from a given config file? </FONT></P>
<P><FONT size=2><FONT face=Arial>Something like:</FONT><BR></FONT></P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> currentDomain </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> AppDomain = AppDomain.CurrentDomain<BR></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> strPath </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = IO.Path.GetDirectoryName(Reflection.Assembly.GetExecutingAssembly.Location) &amp; </FONT><FONT color=#a31515 size=2>"\app.exe.config"<BR></FONT><FONT size=2>currentDomain.SetupInformation.ConfigurationFile = strPath</FONT></P>
<P><FONT face=Arial size=2>Mads</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, February 21, 2008</h2>Csla doesn't provide for that, so you'd have to modify Csla to do it yourself.&nbsp; I'm suprised, because my outlook plugin doesn't require me to do anything special.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
