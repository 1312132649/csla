<html><header><title>Deleting last item in DataGridView</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Deleting last item in DataGridView</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2300.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tray posted on Thursday, February 08, 2007</h2><P>I'm using an EditableRootList and binding it to a DataGridView through a BindingSource.</P>
<P>When I delete the last object in the list using in-place editing, the DataGridView throws an execption stating that 'System.IndexOutOfRangeException: Index 41 does not have a value.'</P>
<P>I'm trying to use the DataError event of the DataGridView control to select the row above the deleted row, but the deleted row stays in the DataGridView with no data in the cells.</P>
<P>How can I get the DataGridView to delete a row in the way that the user expects?</P>
<P>Tray</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, February 09, 2007</h2>All the objects in the ERLB are returning unique values from GetIdValue()?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tray replied on Friday, February 09, 2007</h2><P><FONT face=Arial color=#000080 size=2>Hi Rocky,</FONT></P>
<P><FONT face=Arial color=#000080 size=2>The ERBL is called CategoryList.</FONT></P>
<P><FONT face=Arial color=#000080 size=2>I have a Category root class with a private mCategoryID as Integer as the Id value. This member is returned as an object in the GetIdValue() method. mCategoryID is an identity field (incremental) updated from the db during Save(). I <EM>have not</EM> implemented a temporary primary key field in the class as the object is being updated everytime the user moves away from the row, so I gathered that there would not be any conflicts (only 1 new item can exists at a time - it either gets cancelled or accepted before any other operations can be performed).</FONT></P>
<P><FONT face=Arial color=#000080 size=2>Any ideas?</FONT></P>
<P><FONT face=Arial color=#000080 size=2>Love the framework - brilliant job.</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tray replied on Friday, February 09, 2007</h2><P><FONT face=Arial size=2>Hi again Rocky,</FONT></P>
<P><FONT face=Arial size=2>I decided to try using a SortedBindingList to add some functionality for the user and it fixed my deletion problem. (NB: I got the exception message above for any index in the list - not only the last index.)</FONT></P>
<P><FONT face=Arial size=2>Not sure why, but the ERLB doesn't seem to handle the in-place deletion of an object as well as the SortedBindingList does. Any ideas Rocky?</FONT></P>
<P><FONT face=Arial size=2>This has now created another problem that I have to investigate:</FONT></P>
<UL>
<LI><FONT face=Arial><FONT size=2>I cannot add a new item to the list using in-place editing. SortedBindingList throws an exception (at line 793&nbsp;in Private Function OriginalIndex(ByVal SortedIndex As Integer) As Integer) stating:<BR><EM>'Index was out of range. Must be non-negative and less than the size of the collection.<BR>Parameter name: index'.</EM></FONT></FONT></LI></UL>
<P><FONT face=Arial size=2>I noticed that SortedBindingList does not have an AddNewCore() method for the databinding to call.</FONT></P>
<P><FONT face=Arial size=2>Anyway, I'll keep looking around.</FONT></P>
<P><FONT face=Arial size=2>If you could point me in the right direction, that would be great <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /></FONT></P>
<P><FONT face=Arial><FONT size=2>Tray</FONT></P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, February 22, 2007</h2>SortedBindingList is merely a view over another list, so if you want to AllowNew, that source list must handle that by implementing AddNewCore().</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, February 22, 2007</h2><P>To follow on, here's a very simple ERLB bound to a grid - and a SortedBindingList view of that ERLB bound to another grid.</P>
<P>I set up the Root object so its unique id value is assigned by DP_Insert(), so it should be quite comparable to your example. I'm able to add and remove items from the grid without a problem, so I'm wondering if you can look at this and see how it differs from what you are doing?</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
