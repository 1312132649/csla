<html><header><title>Mutliple Binding Sources, One object?  Can CSLA help with this?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Mutliple Binding Sources, One object?  Can CSLA help with this?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5176.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>awbacker posted on Wednesday, July 30, 2008</h2><P>Posting here as a last resort, since all experimenting has shown that this won't work.&nbsp; I'm hoping there is something in CSLA, BindingSourceRefresh, or 3.6 that might make this kind of scenario possible.&nbsp; </P>
<P>I have a wizard like process where 3+ different user controls are shown in succession.&nbsp; Each one needs to bind to the same object (which is passed in).&nbsp;&nbsp; I have a function that will call BeginEdit if the edit level is &gt; 0, which I have tried using, before it binds to the datasource... so...&nbsp; </P>
<P>To forestall questions.. I have tried not calling BeginEdit(), but source2 won't elevate the edit level if x is still bound to source1.&nbsp; I have tried suspend/resume binding, tried unbinding before going to the next step, and a bunch of other little tweaks =)&nbsp; I've put my time in on this one :(</P>
<BLOCKQUOTE dir=ltr>
<P dir=ltr><FONT face="Courier New" size=2>BindWithBegin( source, obj ) {<BR>&nbsp;&nbsp;&nbsp; if (obj.editLevel &gt; 0) obj.BeginEdit(); source.DataSource=obj; <BR>}<BR>x.Name = "start";<BR>BindWithBegin( source1, x );<BR>x.Name = "after 1";<BR>BindWithBegin( source2, x);<BR>x.Name = "after 2";<BR>BindWithBegin( source3, x);<BR>x.Name = "after 3";<BR>UnbindBindingSource( source3,&nbsp;false );<BR>-- x.Name should = "after 2"<BR>UnbindBindingSource( source2, false );<BR>-- x.Name should = "after 1"</FONT><BR></P></BLOCKQUOTE>
<P dir=ltr>I have tried unbinding in any way possible, but when I completely unbind and then bind to a new source the EditLevel increases.&nbsp; This is fine, except that it makes re-binding when going *backwards* in the process impossible, since everything gets corn-fused and undo doesn't work any more.&nbsp; </P>
<P dir=ltr>Any ideas on this, or am I just off my rocker?&nbsp; </P>
<P dir=ltr>//Andrew</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, July 30, 2008</h2><P>The rule is that if the object is bound to a bindingsource it will have an elevated edit level. That's inescapable because that's how the bindingsource works.</P>
<P>(technically it IS escapable, because in 3.5 and higher you can disable IEditableObject entirely, so the bindingsource's calls will have no effect)</P>
<P>But it should work in a wizard scenario if the current panel completely unbinds AND gets the edit level to 0 before allowing the next (or previous) panel to bind to the object.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
