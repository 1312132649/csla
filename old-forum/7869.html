<html><header><title>Button_Click to Fetch Data using CslaDataProvider in MainPage.xaml returns only Error</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Button_Click to Fetch Data using CslaDataProvider in MainPage.xaml returns only Error</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7869.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav posted on Sunday, October 25, 2009</h2>using Csla 3.8.0 for a Silverlight project. I am trying to follow the NTierArch video.<br /><br />My object graph loads just fine using a call to:<br />        public static EFrame GetEFrame()<br />        {<br />            return DataPortal.Fetch();<br />        }<br />in the FrameLibrary.Server.<br /><br />However, trying to use code in FrameLibrary.Client from MainPage.xaml gives me an error.  Here is what I have in the MainPage.xaml<br /><br />Csla:ErrorDialog x:Key="DataErrorDialog"<br />                          DialogTitle="=Error"<br />                          DialogFirstLine="An Error Has Occured"<br />                          ShowExceptionDetail="False" /><br /><br />Csla:CslaDataProvider x:Key="data"<br />ObjectType="FrameLibrary.EFrame, EFrame"<br />                               ManageObjectLifetime="True"<br />                               FactoryMethod="GetEFrame"<br />                               DataChangedHandler="{StaticResource DataErrorDialog}"<br />                               IsInitialLoadEnabled="True" /><br /><br />Button Width="75"                Csla:InvokeMethod.TriggerEvent="Click"<br />                        Csla:InvokeMethod.Target="{StaticResource data}"<br />                        Csla:InvokeMethod.MethodName="EFrame.GetEFrame"<br />                        Content="Get Frame" /><br /><br />Here is the error:<br /><br />[Main Instruction]<br />An unhandled exception ('Unhandled Error in Silverlight Application <br />Code: 4004    <br />Category: ManagedRuntimeError       <br />Message: System.NullReferenceException: Object reference not set to an instance of an object.<br />   at Csla.Silverlight.InvokeMethod.CallMethod(Object sender, EventArgs e)<br />   at System.Windows.Controls.Primitives.ButtonBase.OnClick()<br />   at System.Windows.Controls.Button.OnClick()<br />   at System.Windows.Controls.Primitives.ButtonBase.OnMouseLeftButtonUp(MouseButtonEventArgs e)<br />   at System.Windows.Controls.Control.OnMouseLeftButtonUp(Control ctrl, EventArgs e)<br />   at MS.Internal.JoltHelper.FireEvent(IntPtr unmanagedObj, IntPtr unmanagedObjArgs, Int32 argsTypeIndex, String eventName)     <br />') occurred in iexplore.exe [6016].<br /><br /><br />It looks like my code in FrameLibrary.Client is not even called. <br /><br />Would appreciate some suggestions.<br />Javed</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Sunday, October 25, 2009</h2>It is possible that you hit a Beta 1 bug. Please try with Beta 2 (just released) and see if the problem still exists.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Monday, October 26, 2009</h2>I am now using 3.8.0 beta2<br />Thank you for refreshing the sample code for 3.8 - it should be immensely helpful.<br /><br />It is possible that my problem is my lack of complete understanding of how things are supposed to work. <br /><br />Here is my CslaDataProvider:<br /><br />Csla:CslaDataProvider x:Key="data"<br />ManageObjectLifetime="True"<br />IsInitialLoadEnabled="True"<br />ObjectType="FrameLibrary.EFrame, FrameLibrary, Version=..., Culture=neutral, PublicKeyToken=null"<br />FactoryMethod="GetEFrame" /><br /><br />Here is the Button that I want to click to fetch the object graph (this is just to test the process):<br /><br />StackPanel Height="24"<br />                        Width="312"<br />                        Canvas.Left="34"<br />                        Canvas.Top="575"<br />                        Orientation="Horizontal"<br />                        DataContext="{Binding Source={StaticResource data}}"><br />                Button Width="75"<br />                        Csla:InvokeMethod.TriggerEvent="Click"<br />                        Csla:InvokeMethod.MethodName="GetEFrame" ******************************<br />                        Content="Get Frame" /><br />            <br /><br />I added the ***** to mark the line where I am getting the following error:<br /><br />AG_E_PARSER_BAD_PROPERTY_VALUE [Line: 631 Position: 54]<br /><br />It looks like the only acceptable MethodName values are Cancel, Delete and Save, everything else generates that error.<br /><br />Also my CslaDataProvider is marked IsInitialLoadEnabled="True".  But my GetEFrame method is not called (method has a breakpoint which is never hit)<br /><br />Thanks for your help.<br /><br />Javed</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, October 26, 2009</h2>InvokeMethod invokes a method on the current DataContext. Obviously the<br />method you want to invoke must be implemented on that DataContext.<br /><br />Your DataContext is the data provider control, and the standard<br />CslaDataProvider control doesn't implement a method called GetEFrame, so you<br />should get an exception for trying to use a method that doesn't exist.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Monday, October 26, 2009</h2>Thanks Rocky.<br /><br />Obviously I have some reading to do. <br /><br />Javed</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, October 26, 2009</h2>If you want to load data, the Refresh() method on CslaDataProvider is what triggers the data provider to call the object's factory method. You can use InvokeMethod to call Refresh.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
