<html><header><title>Bound DataGridView with bound ComboBox issue resolved</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Bound DataGridView with bound ComboBox issue resolved</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1624.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Mat posted on Sunday, October 29, 2006</h2>I've been tearing my hair out with this one for a short while, and found nothing in the forum archives to help me along, so thought I'd document it for others.<br><br>I have a DataGridView, containing a ComboBox roughly following the Project Edit section of the Windows Forms UI chapter of the book.<br><br>On closing my dialog, I get the following error dialog, numerous times:<br><br><div><span>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; "DataGridView Default Error Dialog</span><br><span>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; The following exception occurred in the DataGridView:</span><br><span>&nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp; System.ArgumentException: DataGridViewComboBoxCell value is not valid.</span><br><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; To replace this default dialog please handle the DataError event."</span><br></div><br>All well and good, but what is the cause, and how to fix it!<br><br>A good bit of googling reveled a blog entry at <a href="http://devauthority.com/blogs/jwooley/archive/2005/12/02/638.aspx">http://devauthority.com/blogs/jwooley/archive/2005/12/02/638.aspx</a>. Basically, the grid is still bound to its data source, when the ComboBox's data source is disposed.<br><br>Rather than taking the approach of messing with the dispose function, I solved the problem by fiddling with ordering of initialisation of the binding sources. This is in the InitializeComponent function, inside the Form.Designer.cs file.<br><br><font face="Courier New" size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void InitializeComponent()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.components = new System.ComponentModel.Container();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.dataGridBindingSource = new System.Windows.Forms.BindingSource(this.components);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.comboBoxBindingSource = new System.Windows.Forms.BindingSource(this.components);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...<br></font><br>Hope this is useful to someone, should they come across the same problem.<br><br>Mat<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Cslah replied on Saturday, May 12, 2007</h2>Thanks for the post. I had the same error and tried your solution but it didn't work for me, but helped me solve it! What I ended up doing was loading the combo box binding sources before the data grid binding source. Having it the other way around was causing the crash for me.<BR><BR>Not sure if it matters but my UI is in VB.NET and the library is in C#. </div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
