<html><header><title>A bit OT:  TransactionScope and @@trancount</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>A bit OT:  TransactionScope and @@trancount</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5076.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Wednesday, July 09, 2008</h2>HI,<br><br>I was wondering if anyone noticed this.&nbsp; I have an SP that will start a transaction if @@trancount is 0, and commit or rollback based on if the update failed.&nbsp; <br><br>I'm calling this procedure in a dataportal method that has the TS attribute, but the sp still has it's @@trancount at zero.&nbsp; I thought this was odd..&nbsp; anyone have any explanation?<br><br>Thanks<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>detritus replied on Sunday, September 07, 2008</h2>Just as a note, assuming you're talking with Microsoft SQL Server, your SP should commit the transaction only if it's the owner of it (and the action is successful of course). SQL Server complains if the @@trancount is different before and after the call to the SP.<br><br>Sinan<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
