<html><header><title>Hiding business logic in database, but how do you hide in server side BOs</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Hiding business logic in database, but how do you hide in server side BOs</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9740.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>timster posted on Wednesday, November 10, 2010</h2><p>We are designing an applicaiton that will run within a security hardened, &nbsp;networked, application server&nbsp; &quot;appliance&quot; which is accessed from winforkms applications installed on a number of clients machines.&nbsp; Some of the business logic is is confidential and we are considering using encrypted Stored Procs in the appliance&#39;s database to hide this logic from prying eyes.</p>
<p>I know we can use obfuscation but supposing we wanted to hide some business logic&nbsp;in the server side business objects, not in the database, but we didn&#39;t want this logic to exist on the client machines (in our case its a calculation).&nbsp; We could use web services, but then we loose all the data binding, N level undo and so on that CSLA.NET based objects provides.</p>
<p>It seems that I need&nbsp;different objects on the server to those on the client and could implement this with an additional tier, but this seems to need a lot of duplicated code.</p>
<p>Anyone got any ideas&nbsp;/ design patterns / examples aboiut how I can do this without having a code management nightmare?</p>
<p>Thanks</p>
<p>Tim</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Savij replied on Wednesday, November 10, 2010</h2><p>Tim,</p>
<p>If you are using csla 4 you can do this. Just setup your files to run client and server side like you would for silverlight. You would have one bl.client.cs and one bl.cs and one bl.server.cs. All three classes would be declared as public partial bl {}. Link the bl.cs to the client project and leave the original and the server one in a server project.</p>
<p>Now just create an async business rule on your property that is databound. Your propietary code will reside only on the bl.server.cs which is only deployed to your secured server. The answer would come back async and automatically be databound.</p>
<p>I am sure you can do this as well in a non-async manner, but I have never tried it that way as our client is Silverlight when I tried doing something similar.</p>
<p>Let me know if that helped!</p>
<p>[EDIT]</p>
<p>Tim, I may have spoken too soon, what I describe above still leaves the business rule class in the bl.cs class which does end up on the client. I think to make it work, you can put the business rule class in both the bl.client.cs and the bl.server.cs. In the client side, the business rule will call it&#39;s execute method which would have no implementation, but on the server side your business rule class would hold your propietary code. That should work, but again I have not tried it.</p>
<p>-Jeff</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>timster replied on Wednesday, November 10, 2010</h2><p>Hi Jeff</p>
<p>Thanks for your prompt reply - but what if I am using 3.8?&nbsp; Is it possible to do similar things with that version?</p>
<p>Regards</p>
<p>Tim</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Savij replied on Wednesday, November 10, 2010</h2><p>Yes, I think 3.8 also supports the split tiers because 3.8 is what the silverlight videos are based on.</p>
<p>-Jeff</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>timster replied on Wednesday, November 10, 2010</h2><p>Jeff</p>
<p>Thats brilliant - I will experiment and let you know how I do.</p>
<p>Pretty obvious really - I&#39;m kicking myself for not thinking about it before!</p>
<p>Thanks again</p>
<p>Tim</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Savij replied on Wednesday, November 10, 2010</h2><p>Lemme know how it goes....</p>
<p>-Jeff</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, November 10, 2010</h2><p>If it were me, I&#39;d try to do this in a clean OO way, by having the business objects collaborate with (call) <em>other objects</em> that are only installed on the server.</p>
<p>So all your server-only logic would go into its own project (assembly) that is only deployed to the server. Your business library project will reference this project, but will only call it when you know the code is executing on the server (in your DataPortal_XYZ methods for example).</p>
<p>Remember that the .NET type loader only loads types (and thus assemblies) on-demand. Your business library, when running on the client, still references the server-only assembly, but if you never use its types, .NET won&#39;t try to load it (and fail of course, because that assembly wouldn&#39;t be found on the client).</p>
<p>No compiler directives or duplicated code - just basic OO separation of concerns and collaboration.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>timster replied on Sunday, November 14, 2010</h2><p>Rocky</p>
<p>Thanks for your invaluable insight into this one!&nbsp; The partial classes solution does work but I will try your solution as well - its really only a couple of methods anyway so its no big deal plus the compilation and distribution for your solution seems to be a lot easier to manage.</p>
<p>Thanks again</p>
<p>Tim</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>timster replied on Sunday, November 14, 2010</h2><p>The partial classes solution you outlined but when logging back into the forum just now I noticed Rocky&#39;s solution, so will try his solution as well.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
