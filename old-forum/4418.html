<html><header><title>IsSelfDirty Implementation in 3.5 Beta 2</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>IsSelfDirty Implementation in 3.5 Beta 2</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4418.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>trives posted on Tuesday, February 26, 2008</h2><P>Hi Rocky,</P>
<P>Thanks for including the IsSelfDirty and IsSelfValid properties in the ITrackStatus interface.&nbsp; I have a comment about the implementation of IsSelfDirty in BusinessListBase and FieldData.</P>
<P>When I suggested IsSelfDirty, I was thinking&nbsp;that its value would indicate whether or not a business object&nbsp;was dirty, without considering the dirty status of any child objects.&nbsp; The value of IsSelfDirty would indicate a "private" dirty status&nbsp;instead of&nbsp;a "collective" dirty status that the IsDirty property provides.</P>
<P>The original post gave an example for just BusinessBase, but I was thinking the implementation for BusinessListBase would be along the lines of:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>bool</FONT><FONT size=2> Core.</FONT><FONT color=#2b91af size=2>ITrackStatus</FONT><FONT size=2>.IsSelfDirty<BR>{<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; get</FONT><FONT size=2> { </FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> false; }<BR>}</FONT></P>
<P><FONT size=2><FONT size=3>This is because an editable collection doesn't normally have any editable properties of its own.&nbsp; There is no private _isDirty field.&nbsp; So, it's private state is never&nbsp;dirty.</FONT></FONT></P>
<P><FONT size=2><FONT size=3>For FieldData,&nbsp;I&nbsp;was thinking the implementation would be similar to that of BusinessBase since FieldData has an _isDirty field.</FONT></FONT></P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>bool</FONT><FONT size=2> IsSelfDirty<BR>{<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; get</FONT><FONT size=2> { </FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> _isDirty; }<BR>}</P></FONT>
<P><FONT size=2><FONT size=3>Hopefully, this clarifies the distinction between IsSelfDirty and IsDirty that was in my head. </FONT></FONT></P>
<P><FONT size=2><FONT size=3>Also, thank you for considering the suggestion about using the provider pattern for object level authorization.&nbsp; I understand the time constraints for the book prevent you from doing anything in 3.5, and I agree that a good design for authorization needs a lot of thought and analysis.</FONT></FONT></P>
<P><FONT size=2><FONT size=3>Tim</FONT></P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, February 26, 2008</h2><P>Thanks for the comments.</P>
<P>I think the FieldData implementation is correct as it is. If the FieldData contains a complex object it should act as a pass-through to that underlying object. The local _isDirty value is really there only for managing primitive values.</P>
<P>I'm not as confident on BLB, but I think the current implementation is correct. Certainly if you've added or deleted items the list should be considered dirty, because the state of the list is its contents. And following that train of thought (that its state is its contents) then a changed child also means the list has been changed.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>trives replied on Tuesday, February 26, 2008</h2><P>Okay.&nbsp; Would it make sense and is it feasible to add a protected, virtual IsSelfDirty in BusinessListBase, like IsSelfValid?&nbsp; This way, I could override IsSelfDirty.</P>
<P>If not, I guess I can just redefine the explicit implementation of IsSelfDirty in a custom base class that inherits from BusinessListBase.&nbsp; Somehow that doesn't seem very proper to me, but it seems to work.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rasupit replied on Tuesday, February 26, 2008</h2>I can concur with Rocky on this that the IsSelfDirty is working correctly.&nbsp; Here is the unit test that I ran when testing of my generated code.<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Project p = GetSUT();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; p.Resources[0].Role = 6;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assert.IsTrue(p.IsDirty);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assert.IsFalse(p.IsSelfDirty);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assert.IsTrue(p.Resources[0].IsDirty);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assert.IsFalse(p.Resources[1].IsDirty);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; p = p.Save();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assert.IsFalse(p.IsDirty);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assert.AreEqual(6, p.Resources[0].Role);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; p = Project.GetProject(id);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assert.IsFalse(p.IsDirty);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assert.AreEqual(6, p.Resources[0].Role);<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, February 27, 2008</h2><P>I agree with Rocky too.</P>
<P>Note: the comments for IsSelfDirty and IsSelfValid&nbsp;in the Beta are not reflective of what is coded.</P>
<P>I assume they are on the TODO list.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, February 27, 2008</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>JoeFallon1:</strong></div><div>
<P>I assume they are on the TODO list.</P>
<P></div></BLOCKQUOTE></P>
<P>Oh, make no such assumptions. I'm sure there's a lot of cleanup to do, and I'm not aware of it all, so please point out what you find.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
