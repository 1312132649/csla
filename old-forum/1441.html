<html><header><title>Import from XML to hydrate DTO?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Import from XML to hydrate DTO?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1441.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>swegele posted on Tuesday, October 10, 2006</h2><P>Hi all,&nbsp; this hopefully extends the talk a couple months ago on DTO's embedded in business objects.&nbsp; </P>
<P>We have adopted the idea of a DTO as a&nbsp;class (like Rocky mentioned) that is used by BO's privately for db data.&nbsp; All properties in BO actually expose the fields in the DTO&nbsp;class (except for child collections).&nbsp; We also used Petar's idea of attributes to enable auto sql fetching/population via reflection so I never have to write a sql statement manually (well worth it).&nbsp; Simple example below.</P><FONT size=2>
<P>&lt;Serializable(), DBTable(</FONT><FONT color=#800000 size=2>"JTRep"</FONT><FONT size=2>)&gt; _</P>
<P></FONT><FONT color=#0000ff size=2>Friend</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> JTRepVariables</P>
<P>&nbsp;&nbsp;&nbsp;&lt;DBPrimaryKey(</FONT><FONT color=#800000 size=2>"RepID"</FONT><FONT size=2>)&gt; </FONT><FONT color=#0000ff size=2>Friend</FONT><FONT size=2> mRepID </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = JTMisc.JTGeneral.getNewGUID</P>
<P>&nbsp;&nbsp;&nbsp;&lt;DBRequired(</FONT><FONT color=#800000 size=2>"LastName"</FONT><FONT size=2>)&gt; </FONT><FONT color=#0000ff size=2>Friend</FONT><FONT size=2> mLastName </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#800000 size=2>""</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&lt;DBNullable(</FONT><FONT color=#800000 size=2>"FirstName"</FONT><FONT size=2>)&gt; </FONT><FONT color=#0000ff size=2>Friend</FONT><FONT size=2> mFirstName </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#800000 size=2>""</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&lt;DBNullable(</FONT><FONT color=#800000 size=2>"MiddleName"</FONT><FONT size=2>)&gt; </FONT><FONT color=#0000ff size=2>Friend</FONT><FONT size=2> mMiddleName </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#800000 size=2>""</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&lt;DBNullable(</FONT><FONT color=#800000 size=2>"SSN"</FONT><FONT size=2>)&gt; </FONT><FONT color=#0000ff size=2>Friend</FONT><FONT size=2> mSSN </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#800000 size=2>""</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&lt;DBNullable(</FONT><FONT color=#800000 size=2>"RecordActive"</FONT><FONT size=2>)&gt; </FONT><FONT color=#0000ff size=2>Friend</FONT><FONT size=2> mRecordActive </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2> = 1</P>
<P>&nbsp;&nbsp;&nbsp;&lt;DBInsertAudit(</FONT><FONT color=#800000 size=2>"InsertRepID"</FONT><FONT size=2>)&gt; </FONT><FONT color=#0000ff size=2>Friend</FONT><FONT size=2> mInsertRepID </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#800000 size=2>""</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&lt;DBInsertAudit(</FONT><FONT color=#800000 size=2>"InsertDate"</FONT><FONT size=2>)&gt; </FONT><FONT color=#0000ff size=2>Friend</FONT><FONT size=2> mInsertDate </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> SmartDate</P>
<P>&nbsp;&nbsp;&nbsp;&lt;DBInsertAudit(</FONT><FONT color=#800000 size=2>"InsertOSLogin"</FONT><FONT size=2>)&gt; </FONT><FONT color=#0000ff size=2>Friend</FONT><FONT size=2> mInsertOSLogin </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#800000 size=2>""</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&lt;DBInsertAudit(</FONT><FONT color=#800000 size=2>"InsertMachineID"</FONT><FONT size=2>)&gt; </FONT><FONT color=#0000ff size=2>Friend</FONT><FONT size=2> mInsertMachineID </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#800000 size=2>""</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&lt;DBUpdateAudit(</FONT><FONT color=#800000 size=2>"UpdateRepID"</FONT><FONT size=2>)&gt; </FONT><FONT color=#0000ff size=2>Friend</FONT><FONT size=2> mUpdateRepID </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#800000 size=2>""</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&lt;DBUpdateAudit(</FONT><FONT color=#800000 size=2>"UpdateDate"</FONT><FONT size=2>)&gt; </FONT><FONT color=#0000ff size=2>Friend</FONT><FONT size=2> mUpdateDate </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> SmartDate</P>
<P>&nbsp;&nbsp;&nbsp;&lt;DBUpdateAudit(</FONT><FONT color=#800000 size=2>"UpdateOSLogin"</FONT><FONT size=2>)&gt; </FONT><FONT color=#0000ff size=2>Friend</FONT><FONT size=2> mUpdateOSLogin </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#800000 size=2>""</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&lt;DBUpdateAudit(</FONT><FONT color=#800000 size=2>"UpdateMachineID"</FONT><FONT size=2>)&gt; </FONT><FONT color=#0000ff size=2>Friend</FONT><FONT size=2> mUpdateMachineID </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#800000 size=2>""</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&lt;DBRequired(</FONT><FONT color=#800000 size=2>"RowGuid"</FONT><FONT size=2>)&gt; </FONT><FONT color=#0000ff size=2>Friend</FONT><FONT size=2> mRowGuid </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Guid = Guid.NewGuid</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> ToString() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return</FONT><FONT size=2> mLastName.Trim &amp; </FONT><FONT color=#800000 size=2>", "</FONT><FONT size=2> &amp; mFirstName.Trim &amp; </FONT><FONT color=#800000 size=2>" "</FONT><FONT size=2> &amp; mMiddleName.Trim</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#000000 size=3></FONT></FONT>&nbsp;</P>
<P><FONT color=#0000ff size=2><FONT color=#000000 size=3>So any flavor of a Rep object (of which we have probably 8 - 10) uses this internally and exposes properties appropriate to that use case.&nbsp; (ReadOnly, Editable, or Relationships)&nbsp; Editable Rep has an instance of RepVariables and exposes those appropriately as read/write whereas ReadOnly Rep only exposes the Rep Variables as readonly properties.&nbsp; This saved us quite a bit of work when we started building our objects that represented the many to many relationships.</FONT></FONT></P>
<P>&nbsp;</P>
<P>Aside from feedback about this...Here is what I need help with.&nbsp; I need to write an importer that takes XML, validates it, and then hydrates a BO.&nbsp; This XML would be coming from external sources somewhere else in the enterprise.&nbsp; One particular scenario is that we will be exporting data to robots who perform tasks and then give us back ASCII files.&nbsp; Thos will be transformed (XSLT) into XMLa and then imported for being hydrated into business objects.</P>
<P>Should I make an XML schema that maps one to one to the DTO's we have defined?&nbsp; I don't want to reinvent the wheel and my gut says I can reuse what I already have somehow.</P>
<P>Thanks</P>
<P>Sean</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, October 10, 2006</h2>Here's a DTO:<br><br>Public Class JTRepVariables<br>&nbsp; Public FirstName As String<br>&nbsp; Public LastName As String<br>&nbsp; ' ...<br>End Class<br><br>You can very easily get this into and out of XML by using the XmlSerializer. Almost no code required! .NET itself does all the hard work, and you can just sit back and smile.<br><br>There are some serious restrictions on how you implement the DTO code itself, but if you can live with them this is my preferred approach.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>swegele replied on Tuesday, October 10, 2006</h2><P>couple&nbsp;questions then:</P>
<P>1.&nbsp; Would I just generate an xml schema based on one of my xmlserialized DTO's and use that as my contract with the outside then?&nbsp; </P>
<P>2.&nbsp; Where is the appropriate place to put&nbsp;the method reside that accepts the xml and translates it into a DTO?</P>
<P>3.&nbsp; You mention "serious consequences" on doing DTO's this way...curious what your thinking of there.</P>
<P>&nbsp;</P>
<P>Sean</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
