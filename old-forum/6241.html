<html><header><title>Why does the target method of PropertyChanged needs to be public to be serialized?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Why does the target method of PropertyChanged needs to be public to be serialized?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6241.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>mikemir8 posted on Thursday, January 22, 2009</h2>Just curious about this, but why does the target method of eventhandlers like PropertyChanged and Saved need to be public to be serialized?<br><br>- Miguel<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, January 23, 2009</h2>Not sure I follow..<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Friday, January 23, 2009</h2><P>^^^</P>
<P>This strikes me as odd also. My experience is that event *handlers* are rarely public. </P>
<P>What symptoms are you experiencing that suggest these need to be public?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mikemir8 replied on Friday, January 23, 2009</h2>I have a static class that listens for the PropertyChanged event of certain objects (following the Observer pattern), and I started noticing that after saving the object with autoclone enabled, the events were no longer hooked up. Of course I had my event handlers as private.<br><br>So I went and looked at the implementation of PropertyChanged in BindableBase:<br><br>&nbsp;&nbsp;<font color="#000080">&nbsp;</font><font color="#000080"> public event PropertyChangedEventHandler PropertyChanged<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (<font color="#ff0000">value.Method.IsPublic</font> &amp;&amp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (value.Method.DeclaringType.IsSerializable || <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; value.Method.IsStatic))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _serializableHandlers = (PropertyChangedEventHandler)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Delegate.Combine(_serializableHandlers, value);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _nonSerializableHandlers = (PropertyChangedEventHandler)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Delegate.Combine(_nonSerializableHandlers, value);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</font><br><br>Of course, after a serialization, only serializable handlers will be re-hooked up automatically. What I don't get (not saying it's wrong, just don't get it) is why the target method needs to be public to be added to the serializable handlers.<br><br>- Miguel<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, January 23, 2009</h2>I honestly don't remember. This was a pattern I developed around 2003 or 2004 to deal with the event serialization issues, and I did a lot of research on it then - but that was 4-5 years ago :(<br><br>If you can establish that the BinaryFormatter and NDCS will reestablish hookups to non-public event handlers I'll certainly consider changing the code.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mikemir8 replied on Friday, January 23, 2009</h2>Thanks for the answer Rocky. For now, I guess I'll leave it as is since it's not really causing me a problem. Besides, my experience says that things so specific usually have a good reason... even if sometimes we forget =)<br><br>Maybe later I can come back to this and do some and play around a little bit.<br><br>- Miguel<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, January 23, 2009</h2>I've actually given serious consideration to simplifying this code, and <i>never</i> trying to maintain the event hookup.<br><br>I believe Microsoft's more recent event implementations follow that pattern, where they simply leave all events unhooked on deserialization.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
