<html><header><title>PropertyInfo&lt;Guid&gt; ... = RegisterProperty(...) doesn't generate a new Guid</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>PropertyInfo&lt;Guid&gt; ... = RegisterProperty(...) doesn't generate a new Guid</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5412.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>k2so posted on Tuesday, September 16, 2008</h2>Hi,<br><br>using CSLA3.5, .Net3.5<br><br><br>In a child BO, I have the property definition as following:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private static PropertyInfo&lt;Guid&gt; RowGuidProperty =<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RegisterProperty&lt;Guid&gt;(typeof(Document), new PropertyInfo&lt;Guid&gt;("RowGuid", "Row guid", Guid.NewGuid()));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [System.ComponentModel.DataObjectField(true, true)]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public Guid RowGuid<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return GetProperty&lt;Guid&gt;(RowGuidProperty); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>// in data access, I have a Child_Create() defined, with just a line of ValidationRules.CheckRules<br><br>1. Seems like the RegisterProperty line is only called once (at the first time the object is created, when a new object is created, it is not executed). It is generating the same Guid everytime a new child object is created Is this normal?<br>2. If 1. is true, how can I default a new Guid everytime a new child object is created, without calling the Guid.NewGuid() inside Child_Create()?<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Tuesday, September 16, 2008</h2><P>This is by design, actually - and I raised this similar issue before -</P>
<P>A similar circumstance where one might do a ChildCollection.NewCollection() as an initial value for a child property -- you could create two root objects and both would have a handle to the same "NewCollection" - because code isn't rerun - it just stores the result of the code as the default value. </P>
<P>So your problem is similar to this but not quite the same...&nbsp; </P>
<P>What is similar is that the initial value of the property does not end up being&nbsp;the code that gets run each time for a created instance. Obviously, as you're discovering, the generated guid from Guid.NewGuid is getting stored as the default value for this property.</P>
<P>You'll just need to do this assignment in DP_Create rather than in registering the property. </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fintanv replied on Tuesday, September 16, 2008</h2><P>1. Yes as it is static.</P>
<P>2. What about:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>static</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>PropertyInfo</FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2>Guid</FONT><FONT size=2>&gt; RowGuidProperty = RegisterProperty&lt;</FONT><FONT color=#2b91af size=2>Guid</FONT><FONT size=2>&gt;(</FONT><FONT color=#0000ff size=2>typeof</FONT><FONT size=2>(Document), </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>PropertyInfo</FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2>Guid</FONT><FONT size=2>&gt;(</FONT><FONT color=#a31515 size=2>"RowGuid"</FONT><FONT size=2>, </FONT><FONT color=#a31515 size=2>"Row guid"</FONT><FONT size=2>, </FONT><FONT color=#2b91af size=2>Guid</FONT><FONT size=2>.Empty));</P>
<P>[System.ComponentModel.</FONT><FONT color=#2b91af size=2>DataObjectField</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>)]</P>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>Guid</FONT><FONT size=2> RowGuid</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>get</P></FONT><FONT size=2>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (ReadProperty&lt;</FONT><FONT color=#2b91af size=2>Guid</FONT><FONT size=2>&gt;(RowGuidProperty) == </FONT><FONT color=#2b91af size=2>Guid</FONT><FONT size=2>.Empty)</P>
<P>{</P>
<P>LoadProperty&lt;</FONT><FONT color=#2b91af size=2>Guid</FONT><FONT size=2>&gt;(RowGuidProperty, </FONT><FONT color=#2b91af size=2>Guid</FONT><FONT size=2>.NewGuid());</P>
<P>}</P>
<P></FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> GetProperty&lt;</FONT><FONT color=#2b91af size=2>Guid</FONT><FONT size=2>&gt;(RowGuidProperty);</P>
<P>}</P>
<P>}</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Tuesday, September 16, 2008</h2><P>You may want to be careful about doing this here and rather put it in the DP_Create because you'll only get the guid established if the property is accessed.</P>
<P>Generally when accessing my properties for data access/etc I am using ReadProperty, and my Guid would not be generated. </P>
<P>Just my two cents</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>k2so replied on Tuesday, September 16, 2008</h2>thx y'all for the insights!<br>that was quick :]<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
