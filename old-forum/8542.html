<html><header><title>CSLA 4.0 Preview 2 / SL4 - ViewModel Related Bugs... </title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA 4.0 Preview 2 / SL4 - ViewModel Related Bugs... </h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8542.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>SWITCH posted on Tuesday, February 16, 2010</h2><p>I have been working on a proof of concept application using the current CSLA 4.0 Preview 2&nbsp;release and Silverlight 4 and have uncovered a few problems that appear as though they could be bugs in the CSLA framework. So far, they have been mostly related to the ViewModel support:</p>
<ol>
<li>In <em>\Csla\Csla.core\Reflection\MethodCaller.cs</em> the <em>privateMethodFlags</em>&nbsp;constant has been changed to exclude the <em>BindingFlags.NonPublic </em>binding flag. This causes a problem in the <em>MethodCaller </em>class when <em>FindMethod </em>is called because it is not able to locate the private method named &quot;<em>QueryCompleted</em>&quot; and thus cannot return a <em>MethodInfo </em>object. Ultimately, this throws an <em>ArgumentNullException</em>:&nbsp;&quot;<em>Value cannot be null. Parameter name: method</em>&quot;.<br /><br />Commenting out the compiler directive was the workaround I found for this issue.<br /><br /><em>private const BindingFlags privateMethodFlags =<br />&nbsp; BindingFlags.Public |<br /><strong>//#if !SILVERLIGHT</strong><br />&nbsp; BindingFlags.NonPublic |<br /></em><em><strong>//#endif<br /></strong>&nbsp; BindingFlags.Instance |<br />&nbsp; BindingFlags.FlattenHierarchy;<br /><br /></em>I am not sure the reason this was done and if it is a bug, but maybe someone could shed some more light on this?<br />.</li>
<li>In the <em>\CSLA\Source\Csla.Xaml\ViewModelBase.cs </em>class the <em>[Browsable(false)]</em> attribute is specified on&nbsp;two properties(<em>ManageObjectLifetime </em>&amp; <em>Error</em>) which is causing the following compile errors and which had to be commented out in order to get the<em> Csla.Silverlight</em> project to compile:<br />
<ul>
<li>error CS0246: The type or namespace name &#39;Browsable&#39; could not be found (are you missing a using directive or an assembly reference?)</li>
<li>error CS0246: The type or namespace name &#39;BrowsableAttribute&#39; could not be found (are you missing a using directive or an assembly reference?)</li>
</ul>
</li>
</ol>
<p>This makes me wonder if the CSLA 4.0 Preview 2 Release is ready for use with SL4? Can anyone comment? Should I really be using the latest 3.8.2 drop of CSLA \ CSLA Light for my proof of concept app?</p>
<p>Thanks, Richard</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Tuesday, February 16, 2010</h2><p>First, it is a preview release - it isn&#39;t ready for use at all really <img src="http://forums.lhotka.net/emoticons/emotion-2.gif" alt="Big Smile" /></p>
<p>But I really do appreciate that you are trying to use it and that you are providing feedback - that is exactly the reason for doing the preview releases! I can&#39;t tell you how valuable feedback is at this stage!</p>
<p>------</p>
<p>Issue 1 was reported earlier and has been fixed in svn.</p>
<p>The MethodCaller code that creates the delegates to invoke methods without reflection was entirely reworked - which is a really big thing - so it isn&#39;t surprising that there&#39;s a bug or two. Additionally, in SL reflection was used up to now - so this is the point at which SL gets rid of that use of reflection in favor of a faster approach - but again, a big change.</p>
<p>I&#39;m rather surprised that this is the only bug we&#39;ve found thus far actually.</p>
<p>Issue 2 was also reported earlier and has been fixed in svn.</p>
<p>To help prevent this, I subsequently spent the time to put together a build server. That wasn&#39;t easy, as none of the open-source build server technologies support .NET 4 yet, so I had to cobble together something that could be executed by TeamCity via command line. That&#39;s working, but isn&#39;t ideal. However, it at least ensures that any code checked in is built against both .NET and SL.</p>
<p>----</p>
<p>Of course things are more complex now, because the VS10 RC is out, but SL4 doesn&#39;t work with it. So I have two machines running the RC, but must do most dev work on Beta 2 <img src="http://forums.lhotka.net/emoticons/emotion-7.gif" alt="Tongue Tied" /></p>
<p>I just today created an RC branch so at least some of the basic RC work can be done (in the Csla.Xaml and Csla.Web/Csla.Web.Mvc projects anyway). But it is an ugly situation that makes SL4 work rather challenging.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Tuesday, February 16, 2010</h2><p>I should also say...</p>
<p>If you are actually doing a meaningful POC then use 3.8.2.</p>
<p>You should only use 4 if you are interested in helping provide feedback.</p>
<p>The next preview (hopefully this week) of 4 will include some semi-working business/validation rule subsystem changes. I expect that will break nearly everything, so hold onto your shorts for that one!</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SWITCH replied on Wednesday, February 17, 2010</h2><p>Hi Rocky,</p>
<p>Thanks for the detailed feedback! It&#39;s much appreciated. That&#39;s great you had already caught and fixed&nbsp;them... guess I need to get better at searching the buglog first before posting. You guys always move so quick it&#39;s hard to keep up sometimes! ;) </p>
<p>I wasn&#39;t sure how far along the preview version was but I thought I would give it a shot since we are just starting out on the POC. We are hitting the same issues with VS 2010 RC and SL4, which is making our lives tough too (we decided to stick with VS2010 Beta 2 and SL4 Beta 2). If time constraints allow, we&#39;ll stick with CLSA 4.0 and keep the feedback coming, but we may fall back to 3.8.2 if time is short.</p>
<p>Cheers, Richard</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
