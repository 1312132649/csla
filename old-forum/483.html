<html><header><title>Clean OO design - Inheritance and Factory Pattern</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Clean OO design - Inheritance and Factory Pattern</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/483.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>btyndall posted on Tuesday, June 27, 2006</h2><P>I'm just wondering within the CSLA or general OO design what the best way to handle "cleaning up" properties for other developers to work off of.&nbsp; For example: </P>
<P>1) The database design is assumed to be out of your control.&nbsp; Lets say you are have the Employees table from the Northwind&nbsp;database but you have two additional fields:<BR><FONT face=Tahoma color=#800080 size=2>EmployeeType char(1) -- which is the single character 'P' or 'F' (parttime / fulltime)<BR>IsSalaried char(1)&nbsp;-- which is the single character&nbsp;'T' or&nbsp;'F' (true/false)</FONT></P>
<P>2)&nbsp;&nbsp;&nbsp;If you are using code generation maybe your EmployeeBase class has <BR><FONT face=Tahoma color=#800080 size=2>Property EmployeeType() as Char ...<BR>'and<BR>Property IsSalaried() as Char ....</FONT></P>
<P>3) Then in the Employee business object (inherits from EmployeeBase) -&nbsp;you want your fellow developers to use ... you have:<BR><FONT face=Tahoma color=#800080 size=2>Enum EmpType<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PartTime<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FullTime<BR>End Enum</FONT></P>
<P><FONT face=Tahoma color=#000080 size=2><FONT color=#800080>Property Overloads EmployeeType() as&nbsp;EmpType ...<BR>'and<BR>Property Overloads IsSalaried() as Boolean ...<BR></FONT><BR><FONT face="Times New Roman" color=#000000 size=3>My question is if I use the method in #3 to "clean up" the base class.&nbsp; Then the factory method that creates the Employee class needs to DirectCast down to&nbsp;EmployeeBase and then DirectCast back to Employee before it is returned loaded with data.</FONT></FONT></P>
<P>&nbsp;Is this the right way to deal with this situation?&nbsp; I would like to use code generation and changing the database is not an option.&nbsp; Is there any negative consequences from Overloading the Properties? from the casting ?&nbsp; Should I add properties instead?<BR><BR>Any guidance or ideas would be appreciated,<BR>Thanks,<BR>BTyndall</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jwooley replied on Tuesday, June 27, 2006</h2><P>This sounds less like a problem with inheritance and patterns, and more a problem with your code gen implementation. From the sounds of things, you would probably need to move to a meta-driven code gen methodology where the data types and mapping are&nbsp;included in a separate XML file. I recommend checking out Kathleen Dollard's Code Gen book (<A href="http://www.bookpool.com/sm/1590591372">http://www.bookpool.com/sm/1590591372</A>).</P>
<P>Jim Wooley<BR><A href="http://devauthority.com/blogs/jwooley/default.aspx">http://devauthority.com/blogs/jwooley/default.aspx</A></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, June 27, 2006</h2>Hi BTyndall,<br><br>Probably the best way to go is to ditch your EmployeeType (char) and IsSaliaried (char) properties, and in your base class define the EmployeeType enum and the two properties (strongly typed).<br><br>The code in your DataPortal_Fetch and Insert/Update should translate between boolean and T or F; same goes for the EmployeeType property.<br><br>You'll be much better off; there really doesn't seem to be a need for the EmployeeType (char) and IsSalaried (char) in your business model at all.<br><br>HTH<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>btyndall replied on Tuesday, June 27, 2006</h2><P>Sounds like I should always fix the problem in the base entity class... I ran into some stuff on the web talking about LSP (<A href="http://terrysmith.net/software/dotnet_ebook/chapter6.html">http://terrysmith.net/software/dotnet_ebook/chapter6.html</A>) and Inheritance .... seems like I should stay away from breaking LSP.&nbsp; On a whim I wrote 2 Java classes and Java allows you to change the type of a public property/field also.</P>
<P>Grabbed that exact&nbsp;Kathleen Dollard CodeGen book last week ... and picked up the CSLA VB.NET book this past weekend.&nbsp; The CodeGen book is really good.&nbsp; Have alot of stuff written in XSLT all ready to go.&nbsp; Still working on my Database to XML metadata extraction piece.&nbsp; Eventually I'll post my efforts.</P>
<P>Thanks again,<BR>BTyndall</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
