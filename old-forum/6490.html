<html><header><title>ValidationRules Quirk</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ValidationRules Quirk</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6490.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ian posted on Monday, February 23, 2009</h2><P>I just discovered something a little quirky with the ValidationRulesin Csla 3.6.0.&nbsp; My Customer object has a simple validation rule:</P><FONT size=1>
<P></FONT><FONT color=#0000ff size=1>protected</FONT><FONT size=1> </FONT><FONT color=#0000ff size=1>override</FONT><FONT size=1> </FONT><FONT color=#0000ff size=1>void</FONT><FONT size=1> AddBusinessRules()</P>
<P>{</P>
<P>ValidationRules.AddRule(Csla.Validation.</FONT><FONT color=#2b91af size=1>CommonRules</FONT><FONT size=1>.StringRequired,</FONT><FONT color=#0000ff size=1>new</FONT><FONT size=1> Csla.Validation.</FONT><FONT color=#2b91af size=1>RuleArgs</FONT><FONT size=1>(CustomerNameProperty));</P>
<P>}</P>
<P><FONT size=3>In my test program I have simply:</FONT></P><FONT size=1>
<P></FONT><FONT color=#2b91af size=1>Customer</FONT><FONT size=1> customer = </FONT><FONT color=#2b91af size=1>Customer</FONT><FONT size=1>.NewCustomer();</P>
<P>customer.CustomerName = </FONT><FONT color=#a31515 size=1>"New Customer"</FONT><FONT size=1>;&nbsp; &lt;- put breakpoint here</FONT></P>
<P><FONT size=1>customer.Phone = </FONT><FONT color=#a31515 size=1>"555555"</FONT><FONT size=1>;&nbsp; &lt;- put breakpoint here</FONT></P>
<P><FONT size=1><FONT size=3>Put a breakpoint on both the customer.Phone line and the customer.CustomerName&nbsp;line and run the code.&nbsp; When execution stops on the CustomerName line, just hit F5 and continue to the Phone line.&nbsp; With execution stopped at that line, check the IsValid property using intellisense of the Customer object.&nbsp; IsValid = True, which is to be expected. </FONT></FONT></P>
<P><FONT size=3>Now, restart the code, but this time when execution is on the CustomerName line, check the IsValid property using intellisense.&nbsp; Note that IsValid = False, which is to be expected since the name property hasn't been set yet.&nbsp; Hit F5 and continue to the Phone line and check IsValid again.&nbsp; It's still false even though the name property has a value.&nbsp; I know that it's not just the intellisense being "out of date" because if you continue to a Save() call, Csla throws an exeception because there is still a broken rule.&nbsp; </FONT></P>
<P><FONT size=3>I don't know if it makes a difference, but I'm using private backing fields.</FONT></P>
<P><FONT size=1><FONT size=3></FONT>&nbsp;</P></FONT></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
