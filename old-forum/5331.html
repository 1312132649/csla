<html><header><title>Clear Items from BusinessListBase</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Clear Items from BusinessListBase</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5331.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>bcrowell posted on Sunday, August 31, 2008</h2>I'm trying to implement a method that clears all of the items from a BusinessListbase biz object and delete the underlying entries in the database. My method looks like this:<br><br>Public Overloads Sub ClearAll()<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For Each res As ContentJournalAssignment In Me<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Remove(res)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next<br><br>End Sub<br><br>I'm calling the method like this:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim _CI As HTMLContentItem <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _CI.GetContentItem(165500)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _CI.JournalList.ClearAll()<br><br>I'm getting this error:<br><br>Collection was modified; enumeration operation may not execute.<br><br>-----------------------<br>Can someone shed some light on this. I appear to not understand how to delete with deleting child objects. Thanks.<br><br><br><br><br><br>&nbsp;<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tetranz replied on Sunday, August 31, 2008</h2>I think the collection's Clear method does exactly what you want with no more code required.<br><br>In general, if you want to Remove or Add (I'm not sure about change) items in a collection, you can't do that while looping through that same collection with a For Each. The iterator gets confused. The way I do that is to add the items to be removed to another temporary collection. A simple List of T will do. Then loop around that collection to do the Removing.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rasupit replied on Sunday, August 31, 2008</h2>Other way is to use "for" loop and iterate from last to first item.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>bcrowell replied on Sunday, August 31, 2008</h2>Thanks for this. I've got the list.clear to work without errors but the underlying objects are not deleted. In fact, the delete_child method is never called even after an applyedit and save. <br>The same thing happens if I use the other sugestion and iterate backwards through the collection. The objects end up in the deleted list but don't actually get deleted from the&nbsp; dbase.<br><br>Any ideas? Many thanks.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>bcrowell replied on Sunday, August 31, 2008</h2>Thanks for this. I've got the list.clear to work without errors but the
underlying objects are not deleted. In fact, the delete_child method is
never called even after an applyedit and save. <br>The same thing
happens if I use the other sugestion and iterate backwards through the
collection. The objects end up in the deleted list but don't actually
get deleted from the&nbsp; dbase.<br><br>Any ideas? Many thanks.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Sunday, August 31, 2008</h2>You are using 3.5 and the child data portal? That's the only way you'd automatically get Child_DeleteSelf() to be called. Note that the method name is Child_DeleteSelf(), not Child_Delete() for consistency with the DataPortal_XYZ method names.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
