<html><header><title>ApplicationContext.User with Active Directory-based security</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ApplicationContext.User with Active Directory-based security</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10548.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>TSF posted on Thursday, July 21, 2011</h2><p>I&#39;m using Active Directory for security, and I read in Rocky&#39;s e-book that with Windows security (unless Kerberos is enabled), the identity can take only one hop.&nbsp; Because of this, I&#39;m trying to figure out the best place in the BO for using the Csla.ApplicationContext.User.Identity.Name property in order to pass along the User ID&nbsp;to the database for recording the transaction history.</p>
<p><strong>Would the factory methods be the best place to reference this User ID property?</strong>&nbsp; It would seem that regardless of whether we deployed as a 3-tier or 4-tier (physical) the factory methods would always be at most one network hop away from the user.&nbsp; The facotry methods would then pass the user ID as a string to the DAL.</p>
<p><strong>Or does this differ depending on whether it is a WPF vs Silverlight app?</strong>&nbsp; Thanks.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Thursday, July 21, 2011</h2><p>In a 3-tier deployment, the &quot;hop&quot; is usually from the client workstation (where the user logged in) to the app server. So the app server (DataPortal_XYZ or object factory) methods will have access to the user&#39;s Windows identity. Basically, in most Windows apps, any code running on the app server has access to the user&#39;s identity.</p>
<p>The problem is that the app server can&#39;t impersonate the Windows user when calling the database server, because that would be a second &quot;hop&quot;.</p>
<p>A 4-tier Silverlight app is different, because the first hop is from the browser to the web server, so the Windows identity can&#39;t flow to the app server. But in reality this is rarely an issue, because most 4-tier deployments are done for security reasons, and the user is usually not authenticating against AD in such apps. But if your app is 4-tier and does use AD to authenticate the end user&#39;s browser session, then you are limited to having the identity in the browser and web server only.</p>
<p>In that case, the last normal CSLA code you can write to get the identity is in an inspector object that runs on the web server. This involves the use of the MobileFactory attribute, and is described in the ebook series.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
