<html><header><title>How Do I Trigger Validation ??</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How Do I Trigger Validation ??</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6991.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>NickTaylor posted on Saturday, May 23, 2009</h2><P>Hi, I wonder if anyone can help with this simple little problem. I am relitively new to CSLA and dot net, so forgive my ignorance!</P>
<P>I have a simple&nbsp;windows form which is essentially a maintenance form for a business object. My problem is that if I dont enter any data in a field, the validation rules&nbsp;are not triggered even though there are authorisation rules in the business object. In this instance its just a CommonRules.StringRequired rule, as the field cannot be empty.</P>
<P>If however, I enter some text and then delete it again, the rule is triggered and the error provider displays the appropriate warning&nbsp;icon.</P>
<P>Ideally when I try to Save the data&nbsp;to the business object I would like the validation rules to fire and identify any fields that contain invalid ( or empty ) data.</P>
<P>I'm sure this is really&nbsp;easy, but I dont know how to do it...!?</P>
<P>Any help would be gratefully received...</P>
<P>Many&nbsp;thanks,</P>
<P>Nick&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>whelzer replied on Saturday, May 23, 2009</h2>Its probably just your binding.&nbsp; Right click your text box and Go to DataBindings , click Advanced and ensure that OnPropertyChanged is the binding type selected, (its probably OnValidation right now....)<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>NickTaylor replied on Saturday, May 23, 2009</h2><P>Thanks for the advice, and you were correct about the setting of the data source update mode. I have now changed this to OnPropertyChanged, however the problem is still persisting... </P>
<P>Any other suggestions would be most welcome...</P>
<P>Thanks,</P>
<P>Nick</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>McManus replied on Saturday, May 23, 2009</h2>Hi Nick,<br /><br />Probably you don't call ValidationRules.CheckRules() in the DataPortal_Create() method. Therefore, the rules are not evaluated until a PropertyChanged event occurs.<br /><br />Hope this helps!<br /><br />Cheers,<br />Herman</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>NickTaylor replied on Sunday, May 24, 2009</h2><P>Hi Herman,</P>
<P>Thanks, that certainly helps me out. Everytime I create a new record, I now see the form controls placed into their error state right from the start. Do you&nbsp;know if&nbsp;there is&nbsp;anyway that I could expose the call to ValidationRules.CheckRules() as a public method on the business object ?&nbsp;I could then call something like _boCustomer.CheckRules() as part of the forms Save() method code. This in turn would ensure that the&nbsp;_boCustomer.IsValid flag is set correctly and I can then pick up on this during the save method code. </P>
<P>By the fact that this functionality isn't there probably means my thinking is wrong, but it would seem useful to be able to trigger this as part of my Save() method code.</P>
<P>Thanks,</P>
<P>Nick</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>McManus replied on Sunday, May 24, 2009</h2>Hi Nick,<br /><br />You could make a public method Validate() or something like that, which in turn calls ValidationRules.CheckRules(), but that is a BAD idea.<br /><br />The business object is responsible for maintaining its own state and must not depend on someone else for that.<br /><br />Grtz,<br />Herman</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>NickTaylor replied on Sunday, May 24, 2009</h2><P>Yes, I would agree on that one Herman.</P>
<P>How about I put a call to ValidationRules.CheckRules() within my DataPortal_Update() and DataPortal_Insert() methods. I could then throw an exception if any of the data is invalid. Does that make sense...?</P>
<P>Thanks,</P>
<P>Nick</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mbblum replied on Sunday, May 24, 2009</h2>The BO properties IsValid and IsSavable should be false until all validation rules pass. This is managed by the CSLA fraamework. <br /><br />If you are not getting this functionality, then my suggestion is to review the samples with CSLA to observe how they achieve this. <br /><br />When IsSavable is false, the CSLA framework on a call to Save the BO will through an exception and not call Dataportal_XYZ, i.e. it is too late to be calling CheckRules in those methods.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
