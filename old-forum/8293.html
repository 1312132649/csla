<html><header><title>Question - Design Name/Value List Objects </title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Question - Design Name/Value List Objects </h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8293.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>foxhard posted on Wednesday, January 06, 2010</h2><font face="Verdana" size="2"><font color="#000000"><b><font><span>Hi. </span><br><br><span>In my work some people are using this way to coding nameValueList classes...I don't know if this is correct.</span></font></b><br></font><br>------------------------------</font>
<div id=":sw" class="ii gt"><font face="Verdana" size="2">------------------------------</font><font face="Verdana" size="2">------------------------------</font><font face="Verdana" size="2">------------------------------</font><font face="Verdana" size="2">------------------------------</font><font face="Verdana" size="2">----------------------<br>&nbsp;&nbsp;&nbsp; [Serializable()] <br>&nbsp;&nbsp;&nbsp; public class LoanSimpleList : Csla.NameValueListBase&lt;int, string&gt;<br>
&nbsp;&nbsp;&nbsp; {<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; #region Factory Methods<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; private LoanSimpleList()<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; { /* require use of factory method */ }<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; private static LoanSimpleList _list;<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static LoanSimpleList GetLoanSimpleList()<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span> //if (_list == null)</span><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _list = DataPortal.Fetch&lt;</font><font face="Verdana" size="2">LoanSimpleList&gt;(new Criteria(typeof(</font><font face="Verdana" size="2">LoanSimpleList)));<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return _list;<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static LoanSimpleList GetLoanSimpleListByClientId(</font><font face="Verdana" size="2">int clientId)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>&nbsp;&nbsp; //if (_list == null)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _list = DataPortal.Fetch&lt;</font><font face="Verdana" size="2">LoanSimpleList&gt;(new SingleCriteria&lt;LoanSimpleList,</font><font face="Verdana" size="2">int&gt;(clientId));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return _list;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span> /*public static void InvalidateCache()</span><br><span>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {</span><br><span>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; _list = null;</span><br><span>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }*/</span><br><br>...<br>}<br>------------------------------</font><font size="2">
</font><font face="Verdana" size="2">------------------------------</font><font face="Verdana" size="2">------------------------------</font><font face="Verdana" size="2">------------------------------</font><font face="Verdana" size="2">------------------------------</font><font face="Verdana" size="2">------------------------------</font><font face="Verdana" size="2">-<br><br><b><font color="#0000ff">Then this class is used like this:</font></b><br><br>private LoanSimpleList _loanList;<br><br>public void Method1()<br>&nbsp;&nbsp;&nbsp; _loanlist = LoanSimpleList.</font><font size="2">
</font><font face="Verdana" size="2">GetLoanSimpleList():<br>}<br><br>public void Method2(int clientId)<br>
{<br>
&nbsp;&nbsp;&nbsp; _loanlist = LoanSimpleList.</font><font face="Verdana" size="2">GetLoanSimpleListByClientId(</font><font face="Verdana" size="2">clientId):<br>
}<br><br><br><b>Before you can see the the line //if (_list == null), this is comment, because the data must be changed in each call.<br><br>My question is if that is OK?</b>...maybe the correct way will be uncomment that lines and use the InvalidateCache Method...like this:<br><br><br>private LoanSimpleList _loanList;<br><br>
public void Method1()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LoanSimpleList.</font><font size="2">
</font>

<font face="Verdana" size="2">InvalidateCache();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _loanlist = LoanSimpleList.</font><font face="Verdana" size="2">GetLoanSimpleList():<br>
}<br><br>
public void Method2(int clientId)<br>

{<br>
&nbsp;&nbsp;&nbsp; LoanSimpleList.</font><font size="2">
</font><font face="Verdana" size="2">InvalidateCache();<br>&nbsp;&nbsp;&nbsp; _loanlist = LoanSimpleList.</font><font face="Verdana" size="2">GetLoanSimpleListByClientId(</font><font face="Verdana" size="2">clientId):<br>

}<br><br><br><b><font color="#0000ff"><span>Then....What is correct?</span>....How you explanain the correct use of InvalidateCache Method?...<br><br>Regards,<br><br></font></b></font>


</div></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Thursday, January 07, 2010</h2>This is definitely not going to do what you want unless you use the second variation, where you explicitly discard the saved list on each fetch using the InvalidateCache method, and then you have lost the benefit of keeping a static list around anyway. (If you don't discard the list each time, then you'll get the wrong list if you retrieve for a different client id).<br /><br />An improvement on this that would take advantage of the caching would be to also keep the last clientId that goes with the current value of _list.  That way, repeated fetches for the same client id (or the global list) will return the previously fetched list as long as it matches. <br /><br />I have the impression that the most common use of NameValue lists is for an essentially static set of values that is lazy-loaded just once for the duration of the application. The InvalidateCache method allows for forcing the list to be refetched (for example, if the original source of the underlying values is changed, then you would want to refetch the list on the next call)</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
