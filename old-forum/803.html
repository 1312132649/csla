<html><header><title>Where to I validate that an Invoice has InvoiceItems?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Where to I validate that an Invoice has InvoiceItems?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/803.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>cmay posted on Thursday, August 03, 2006</h2><P>A pretty common example of what I am trying to do is an invoice with invoice items.</P>
<P>Invoice aggregates a collection of InvoiceItem objects.</P>
<P>If I understand, if I were to add a ValidationRule&nbsp;it would be on the property InvoiceItems, but this property is readonly obviously so PropertyChanged is never going to be called on this property.</P>
<P>Obviously I can just put a check in the UI code when the person clicks the save button, but I am betting there is another way to tap into the validation checking or the IsValid method on the business objects to make sure that a InvoiceItem collection of length 0 is invalid.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>vargasbo replied on Thursday, August 03, 2006</h2>If your invoiceItems is readonly, what changes would you have made to validate them? Now, you could have rules in your business object which states that only 4 invoice items can be in an invoice, in either case, those V.R. should be in parent object.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Mark replied on Thursday, August 03, 2006</h2><P>You can always have the root Invoice object listen for the ListChanged event of the InvoiceItem collection and re-raise a PropertyChanged event.</P>
<P>Something like...</P>
<P>InvoiceItems.ListChanged += new System.ComponentModel.ListChangedEventHandler(ItemsChanged);</P>
<P>private void ItemsChanged(object sender, System.ComponentModel.ListChangedEventArgs e)<BR>{<BR>&nbsp;&nbsp; PropertyHasChanged("InvoiceItems");<BR>}</P>
<P>private static bool InvoiceItemsRequired(object target, RuleArgs e)<BR>{<BR>&nbsp;&nbsp; Invoice obj = target as Invoice;<BR>&nbsp;&nbsp; e.Description = "At least one item must be on file!";<BR>&nbsp;&nbsp; return (obj.InvoiceItems.Count &gt; 0);<BR>}</P>
<P>As long as you setup the validation rule to fire on "InvoiceItems", everything should work well...</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Soumya replied on Tuesday, November 27, 2007</h2><P>Can you tell where you have to write this 2 methods in Invoice class or InvoiceItems class. </P>
<P>Can you provide them in VB.NET</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Soumya replied on Tuesday, November 27, 2007</h2><P>never mind. I got answer. </P>
<P>I defined my list member with events and handling ListChanged in parent</P>
<P>Thanks</P>
<P>Soumya</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
