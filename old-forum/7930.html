<html><header><title>CSLA.NET Reflexion and Lists.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA.NET Reflexion and Lists.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7930.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Eblanchette posted on Monday, November 02, 2009</h2>Hello everyone, <br /><br />I am having problems with this bit of code.  It seems that every element in my EditableRootList gets changed as soon as I add a new one in it.(all the elements take the value of the most recently added one).  I hope someone can help.<br /><br />                for (int i = 2; i                 {<br />                    DataRow[] arrRows;<br />                    arrRows = new DataRow[2];<br />                    arrRows[0] = dtFromTo.Rows<img src="/emoticons/emotion-55.gif" alt="Idea [I]" />;<br />                    arrRows[1] = dtFromTo.Rows[i + 1];<br />                    float division = (float)200.0 / (float)dtFromTo.Rows.Count;<br />                    float multiplication = division * i;<br />                    float division2 = multiplication / 2;<br />                    mainFrm.progressBar1.Value = ((int)division2 / 2);<br />                    DoEvents();                   <br />                    //CableEC newCable = null;<br />                    CableEC newCable = CableEC.NewCableEC();<br />                    object objToRef = (object)newCable;                    <br />                    objToRef = (CableEC)Utils.BOFiller.FillBusinessObject(ref objToRef, arrRows, true); //THIS LINE changes the value of everything in my list               <br />                    lstCables.Add((CableEC)objToRef);                 <br />                    <br />                }</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, November 02, 2009</h2><P>Not too put too fine a point on it, but that looks like some seriously overcomplicated code, probably designed by someone with a less than solid understanding of how object references work. (hopefully not you :) - and in any case I don't mean to be insulting)</P>
<P>If I were designing this FillBusinessObject() method, I'd make it work like this:</P>
<BLOCKQUOTE dir=ltr>
<P>CableEC newCable = CableEC.NewCableEC();<BR>Utils.BOFiller.FillBusinessObject(newCable, arrRows, true);<BR>lstCables.add(newCable);</P></BLOCKQUOTE>
<P>When using an object reference (and newCable is an object reference) you don't need the ref keyword. And why have FillBusinessObject() return an object? It seems like it should clearly be filling the object I passed into it (newCable). Finally, .NET will automatically cast anything to type object, you shouldn't have to manually do a cast like that - certainly not for a scenario as simple as this.</P>
<P>Of course none of that explains why your whole list is getting changed by FillBusinessObject(), but my first assumption is that your FillBusinessObject() method is somehow doing a bad thing.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
