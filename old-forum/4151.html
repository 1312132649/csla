<html><header><title>Should NVL objects for dropdowns be inside Business Objects?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Should NVL objects for dropdowns be inside Business Objects?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4151.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>NightOwl888 posted on Thursday, January 10, 2008</h2><P>I realize this might be a question that "depends on your situation", but I am just trying to get my head around the best way to approach this scenario.&nbsp; Basically, I like the way Rocky designed this framework to get all of the database data in one shot. That is - unless you are also including the dropdown lists on the UI, then it seems like you need to make another round trip for each one.</P>
<P>I realized this when designing a project that I made a&nbsp;couple years ago and ended up putting the NVL objects <EM>inside</EM> the business objects.&nbsp; While this seems to solve the round-trip problem, it also means that I will always pull up the NVL data whether I am binding to a UI or not.</P>
<P>An example would be having a Product object that belongs to a specific Category.&nbsp; The Product object technically only needs to know the assigned CategoryID.&nbsp; However, for the user to select it on the UI, they will need a dropdown list filled with all of the CategoryIDs and Category Names. So, is it generally acceptable to pull up the list of CategoryIDs and Names every time we get an instance of a Product, whether it is used by the UI or not? Technically speaking, the Category NVL&nbsp;doesn't <EM>belong</EM> to the Product, it is only required to select the value that <EM>does</EM> belong.</P>
<P>I am just curious if anyone uses this approach and if there are any known drawbacks to it other than the extra overhead involved.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>robert_m replied on Friday, January 11, 2008</h2><P>As I see it, CategoryList should be a separate class. If you are worried about extra trips to the server side to load it with data, then you might perhaps consider some caching techniques ? In practice, data in many lookup tables&nbsp;is quite static which&nbsp;makes them&nbsp;good candidates for caching. </P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Thursday, February 21, 2008</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>robert_m:</strong></div><div>
<P>As I see it, CategoryList should be a separate class. If you are worried about extra trips to the server side to load it with data, then you might perhaps consider some caching techniques ? In practice, data in many lookup tables&nbsp;is quite static which&nbsp;makes them&nbsp;good candidates for caching. </P>
<P></div></BLOCKQUOTE></P>
<P>Yes, we basically use "lazing loading" for these where they are loaded only on the first request for the factory method (GetList() in our case), and then from then on they stay around for the duration of the application. Subsequent calls just immediately return the one already fetched. </P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, February 21, 2008</h2>






 





<div class=Section1>

<p class=MsoNormal><span>Here&#8217;s some pseudo-code that shows the basic concept.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>public class Record<o:p></o:p></span></p>

<p class=MsoNormal><span>{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; [NonSerialized]<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; private OfficeList _officeList;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; [Browsable(false)]<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; public int OfficeList<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_officeList ==
null)<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
_officeList = OfficeList.GetList(this.Company);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return _officeList;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; [NonSerialized]<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; private DepartmentList _departmentList;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; [Browsable(false)]<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; public int DepartmentList<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_departmentList
== null)<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
_departmentList = DepartmentList.GetList(this.Office);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;return
_departmentList;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; private static PropertyInfo&lt;int&gt;
CompanyProperty = RegisterProperty&lt;int&gt;(typeof(ProjectResource), new
PropertyInfo&lt;int&gt;(&quot;Company&quot;));<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; public int Company<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return
GetProperty&lt;int&gt;(CompanyProperty); }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set { SetProperty&lt;int&gt;(CompanyProperty,
value); }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; private static PropertyInfo&lt;int&gt;
OfficeProperty = RegisterProperty&lt;int&gt;(typeof(ProjectResource), new
PropertyInfo&lt;int&gt;(&quot;Office&quot;));<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; public int Office<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get &nbsp;{ return
GetProperty&lt;int&gt;(OfficeProperty); }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set { SetProperty&lt;int&gt;(OfficeProperty,
value); }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; private static PropertyInfo&lt;int&gt;
DepartmentProperty = RegisterProperty&lt;int&gt;(typeof(ProjectResource), new
PropertyInfo&lt;int&gt;(&quot;Department&quot;));<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; public int Department<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return
GetProperty&lt;int&gt;(DepartmentProperty); }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set { SetProperty&lt;int&gt;(DepartmentProperty,
value); }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; protected override void AddBusinessRules()<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ValidationRules.AddRule&lt;Record&gt;(InvalidateOfficeList&lt;Record&gt;,
CompanyProperty);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ValidationRules.AddRule&lt;Record&gt;(InvalidateDepartmentList&lt;Record&gt;,
OfficeProperty);<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ValidationRules.AddDependentProperty(CompanyProperty, OfficeProperty);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ValidationRules.AddDependentProperty(CompanyProperty, DepartmentProperty);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ValidationRules.AddDependentProperty(OfficeProperty, DepartmentProperty);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; private static bool
InvalidateOfficeList&lt;T&gt;(T target, RuleArgs e) where T: Record<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; target._officeList = null;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; private static bool
InvalidateDepartmentList&lt;T&gt;(T target, RuleArgs e) where T: Record<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; target._departmentList = null;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

</div>



</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jfreeman replied on Thursday, April 10, 2008</h2>







 

 
  
 


<DIV>
<DIV>

<div class=Section1>

<p class=MsoNormal><span>I&#8217;ve used the logic you sent below to build the object built
when I try to use this object in </span><span>BusinessListBase</span><span> (I
want to show all the Record values in a list) I cannot get it to change Office values.&nbsp;
For instance, the 1<sup>st</sup> five records have the same Company and
Office.&nbsp; The 6<sup>th</sup> value has the same Company but the office is
different.&nbsp; I cannot get it to select the correct value in the Office on
the change.&nbsp; Does that make sense?&nbsp; Thanks for your help.<o:p></o:p></span></p>

<div>

<p class=MsoNormal><b><u><span>_________________________________________________</span></u></b><span> <br>
</span><b><span>Jonathan Freeman</span></b><span>| LBMC Technologies, LLC</span><span> <br>
</span><span>5250 Virginia Way| 3<sup>rd</sup> Floor | Brentwood, TN 37027</span><span> <br>
</span><span>p: 615.309.2447 | f: 615.309.2747 | jfreeman@lbmc.com</span><span> <o:p></o:p></span></p>

</div>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<div>

<div>

<p class=MsoNormal><b><span>From:</span></b><span> Rockford Lhotka
[mailto:cslanet@lhotka.net] <br>
<b>Sent:</b> Thursday, February 21, 2008 11:39 AM<br>
<b>To:</b> Jonathan Freeman<br>
<b>Subject:</b> RE: [CSLA .NET] Should NVL objects for dropdowns be inside
Business Objects?<o:p></o:p></span></p>

</div>

</div>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal><span>Here&#8217;s some pseudo-code that shows the basic concept.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>public class Record<o:p></o:p></span></p>

<p class=MsoNormal><span>{<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; [NonSerialized]<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; private OfficeList _officeList;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; [Browsable(false)]<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; public int OfficeList<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_officeList ==
null)<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
_officeList = OfficeList.GetList(this.Company);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return _officeList;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; [NonSerialized]<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; private DepartmentList _departmentList;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; [Browsable(false)]<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; public int DepartmentList<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_departmentList
== null)<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
_departmentList = DepartmentList.GetList(this.Office);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;return
_departmentList;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; private static PropertyInfo&lt;int&gt;
CompanyProperty = RegisterProperty&lt;int&gt;(typeof(ProjectResource), new
PropertyInfo&lt;int&gt;(&quot;Company&quot;));<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; public int Company<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return
GetProperty&lt;int&gt;(CompanyProperty); }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set {
SetProperty&lt;int&gt;(CompanyProperty, value); }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; private static PropertyInfo&lt;int&gt;
OfficeProperty = RegisterProperty&lt;int&gt;(typeof(ProjectResource), new
PropertyInfo&lt;int&gt;(&quot;Office&quot;));<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; public int Office<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get &nbsp;{ return GetProperty&lt;int&gt;(OfficeProperty);
}<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set {
SetProperty&lt;int&gt;(OfficeProperty, value); }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; private static PropertyInfo&lt;int&gt;
DepartmentProperty = RegisterProperty&lt;int&gt;(typeof(ProjectResource), new
PropertyInfo&lt;int&gt;(&quot;Department&quot;));<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; public int Department<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return
GetProperty&lt;int&gt;(DepartmentProperty); }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set {
SetProperty&lt;int&gt;(DepartmentProperty, value); }<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; protected override void AddBusinessRules()<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ValidationRules.AddRule&lt;Record&gt;(InvalidateOfficeList&lt;Record&gt;,
CompanyProperty);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ValidationRules.AddRule&lt;Record&gt;(InvalidateDepartmentList&lt;Record&gt;,
OfficeProperty);<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ValidationRules.AddDependentProperty(CompanyProperty, OfficeProperty);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ValidationRules.AddDependentProperty(CompanyProperty, DepartmentProperty);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ValidationRules.AddDependentProperty(OfficeProperty, DepartmentProperty);<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; private static bool
InvalidateOfficeList&lt;T&gt;(T target, RuleArgs e) where T: Record<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; target._officeList = null;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; private static bool
InvalidateDepartmentList&lt;T&gt;(T target, RuleArgs e) where T: Record<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; {<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; target._departmentList = null;<o:p></o:p></span></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp; }<o:p></o:p></span></p>

<p class=MsoNormal><span>}<o:p></o:p></span></p>

<p class=MsoNormal><br>
<br>
<o:p></o:p></p>

</div>

 </DIV>
<DIV>&nbsp;</DIV>
<DIV ALIGN="center"><STRONG></STRONG>&nbsp;</DIV>
<DIV ALIGN="center"><STRONG>Privacy Notice</STRONG></DIV>
<DIV>
<DIV ALIGN="center"><BR>"The information contained in this message may be privileged and confidential and protected from disclosure.&nbsp;If the reader of this message is not the intended recipient, or an employee or agent responsible for delivering this message to the intended recipient, you are hereby notified that any dissemination, distribution or copying of this communication is strictly prohibited.&nbsp; If you have received this communication in error, please notify us immediately by replying to this message and deleting it from your computer."</DIV>&nbsp;</DIV>
<DIV>Thank you.&nbsp;</DIV>
<DIV>The LBMC Family of Companies<BR></DIV>
</DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jgamba replied on Friday, November 14, 2008</h2>I am implementing the solution proposed by Rocky, but I've had issues.<br><br>Using the same example, I have three lists (CompanyList, OfficeList and
DepartamentList) filled with their respective properties (Company,
Office and Department) assigned.<br><br>1. If I change the selected company in the combobox, the InvalidateOfficeList rule is thrown
so _officeList is null, however, the OfficeList property
is never consulted and therefore does not change the content of the combobox office.<br><br>2. Each of my lists have one instance DefaultValue property, which is assigned each time GetList() is called and according to the
provided parameter (this.Company, this.Office). as its name indicates,
DefaultValue must determine which item is selected initially, so if the
user changes the company selected, the Record business object must
automatically and cascading gets the remaining lists (OfficeList
and DepartamentList) and assign the properties and Office Department.<br><br>Which is the most appropriate way to deal with these issues?<br><br>Thanks in advance<br><br>Jorge Gamba<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, November 14, 2008</h2>It looks like you have the "combo B has different elements depending on what element in combo A is selected," and you're on WinForms, correct?<br><br>That seems to be a huge PITA.. I've found that while the BO is correct, the combo box B doesn't like to "blank" itself even though the value is now empty; I've handled this by having an event handler for combo A which sets SelectedIndex to -1.&nbsp;&nbsp; That seems to work... unless I have the problem misunderstood. <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jgamba replied on Friday, November 14, 2008</h2>Thank you very much for your response <br><br> Yes, I am using WinForms <br><br> Best describe my use case with the following example, this time using a hierarchy composed as follows:<br><br>Countries<br>&nbsp;&nbsp;&nbsp; Regions<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Cities<br><br>I have a root object 'Localization' which has the properties RegionList
and CityList similarly as Rocky suggested earlier in this post.<br><ul><li>Localization object assigns "initial" default values for Country, Region and City in DataPortal_Create.</li><li>The data entry form bind the Localization object to Comboboxes, so that all combos are filled.</li><li>The user changes the selected country in the first Combobox<br></li><li>The second combobox (Regions) should now contain regions that belong to
the selected country and must have selected the default item that
corresponds to the property DefaultValue of
RegionList</li><li><div id="result_box">Immediately
afterwards, once the Localization Object has selected the region by
default, similarly to the regions will load the list of cities and select the default</div></li></ul>Of course, the user could choose not to change the country but from region to begin the process, or just change the city.<br><br><blockquote><blockquote><br><br></blockquote></blockquote><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>simon_may replied on Tuesday, November 18, 2008</h2><P>Excuse me tagging on to this thread. My BOs expose some&nbsp;namevalue lists as&nbsp; properties that i bind a comboBox dartasource property to, However the act of binding the datasource alters the SelectedValue property which is not desirable. Having traced the databinding process I can see the SelectedValue binding then the DataSource binding which alters the SelectedValue. </P>
<P>Anyone have any ideas as to how I should be doing this properly</P>
<P>Regards</P>
<P>Simon</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, November 19, 2008</h2>I'm not sure I follow; that sounds like what the combobox is supposed to be doing.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>simon_may replied on Wednesday, November 19, 2008</h2>I started a new thread <A HREF="/forums/thread/20326.aspx">http://forums.lhotka.net/forums/thread/20326.aspx</A>&nbsp;has more explanation</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>alef replied on Monday, December 01, 2008</h2><P>example of City, Country and Region of how I implemented it:</P>
<P>Most of the code is generated with codesmith templates.</P>
<P>Maybe what is interesting is the code in bold: I added to the City class a property Country in a lazy way loading.</P>
<P>So it is possible for the person who is using the business layer to write something like Employee.City.Country.</P>
<P>But in the code the way I implemented everytime the database will be hit. Does somebody have an idea how to avoid that?</P>
<P>Another question what is the relationship between city, country and region. I've treated them&nbsp;as seperated root objects. Is that correct?</P>
<P>&nbsp;</P>
<P>using System;</P>
<P>namespace Fim.HR.JL.Bus.Components<BR>{ <BR>&nbsp;[Serializable()] <BR>&nbsp;public partial class City : Csla.ReadOnlyBase&lt;City&gt;<BR>&nbsp;{<BR>&nbsp;&nbsp;public int CityId { get; private set; }<BR>&nbsp;&nbsp;public string CountryId { get; private set; }<BR>&nbsp;&nbsp;public string Name { get; private set; }<BR>&nbsp;&nbsp;public string Description { get; private set; }<BR>&nbsp;&nbsp;public string CreatedBy { get; private set; }<BR>&nbsp;&nbsp;public DateTime Created { get; private set; }<BR>&nbsp;&nbsp;public string ModifiedBy { get; private set; }<BR>&nbsp;&nbsp;public DateTime? Modified { get; private set; }</P>
<P>&nbsp;&nbsp;internal static City GetCity(Fim.HR.JL.Dat.Components.City data)<BR>&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;City item = new City();<BR>&nbsp;&nbsp;&nbsp;item.Fetch(data);<BR>&nbsp;&nbsp;&nbsp;return item;<BR>&nbsp;&nbsp;}</P>
<P>&nbsp;&nbsp;private City()<BR>&nbsp;&nbsp;{ /* require use of factory method */ }</P>
<P>&nbsp;&nbsp;#region Data Access<BR>&nbsp;&nbsp;private void Fetch(Fim.HR.JL.Dat.Components.City data)<BR>&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;bool cancel = false;<BR>&nbsp;&nbsp;&nbsp;OnFetching(ref cancel);<BR>&nbsp;&nbsp;&nbsp;if (cancel) return;</P>
<P>&nbsp;&nbsp;&nbsp;CityId = data.numCityId;<BR>&nbsp;&nbsp;&nbsp;CountryId = data.strCountryId;<BR>&nbsp;&nbsp;&nbsp;Name = data.strName;<BR>&nbsp;&nbsp;&nbsp;Description = data.strDescription;<BR>&nbsp;&nbsp;&nbsp;CreatedBy = data.strCreatedBy;<BR>&nbsp;&nbsp;&nbsp;Created = data.datCreated;<BR>&nbsp;&nbsp;&nbsp;ModifiedBy = data.strModifiedBy;<BR>&nbsp;&nbsp;&nbsp;Modified = data.datModified;</P>
<P>&nbsp;&nbsp;&nbsp;OnFetched();<BR>&nbsp;&nbsp;}</P>
<P>&nbsp;&nbsp;partial void OnFetching(ref bool cancel);<BR>&nbsp;&nbsp;partial void OnFetched();<BR>&nbsp;&nbsp;#endregion //Data Access<BR>&nbsp;}<BR>}<BR></P>
<P>&nbsp;</P>
<P>using System.Linq;<BR>using Csla;<BR>using Csla.Data;<BR>using Csla.Security;<BR>using Csla.Validation;<BR>using Fim.HR.JL.Dat.Components;</P>
<P>namespace Fim.HR.JL.Bus.Components<BR>{ <BR>&nbsp;public partial class City : Csla.ReadOnlyBase&lt;City&gt;<BR>&nbsp;{<BR>&nbsp;&nbsp;&nbsp; public static City GetCity(int? id)<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (id == null)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return null;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return DataPortal.Fetch&lt;City&gt;(new SingleCriteria&lt;City, int?&gt;(id));<BR>&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;&nbsp;&nbsp; private void DataPortal_Fetch(SingleCriteria&lt;City, int?&gt; criteria)<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (criteria.Value != null)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using (var mgr = ContextManager&lt;Fim.HR.JL.Dat.Components.HRJLDataContext&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .GetManager(Database.HRJL, false))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var data = (from r in mgr.DataContext.Cities<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; where r.numCityId == criteria.Value<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; select r).SingleOrDefault();</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (data != null)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Fetch(data);</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }//using<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }</P>
<P><STRONG>&nbsp;&nbsp;&nbsp; public Country Country<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return Country.GetCountry(CountryId);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }</STRONG></P>
<P>&nbsp;}<BR>}<BR>-----------------------------------------COUNTRY-------------------------------------</P>
<P>using System;</P>
<P>namespace Fim.HR.JL.Bus.Components<BR>{ <BR>&nbsp;[Serializable()] <BR>&nbsp;public partial class Country : Csla.ReadOnlyBase&lt;Country&gt;<BR>&nbsp;{<BR>&nbsp;&nbsp;public string CountryId { get; private set; }<BR>&nbsp;&nbsp;public string RegionId { get; private set; }<BR>&nbsp;&nbsp;public string Name { get; private set; }<BR>&nbsp;&nbsp;public string Description { get; private set; }<BR>&nbsp;&nbsp;public string CreatedBy { get; private set; }<BR>&nbsp;&nbsp;public DateTime Created { get; private set; }<BR>&nbsp;&nbsp;public string ModifiedBy { get; private set; }<BR>&nbsp;&nbsp;public DateTime? Modified { get; private set; }</P>
<P>&nbsp;&nbsp;internal static Country GetCountry(Fim.HR.JL.Dat.Components.Country data)<BR>&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;Country item = new Country();<BR>&nbsp;&nbsp;&nbsp;item.Fetch(data);<BR>&nbsp;&nbsp;&nbsp;return item;<BR>&nbsp;&nbsp;}</P>
<P>&nbsp;&nbsp;private Country()<BR>&nbsp;&nbsp;{ /* require use of factory method */ }</P>
<P>&nbsp;&nbsp;#region Data Access<BR>&nbsp;&nbsp;private void Fetch(Fim.HR.JL.Dat.Components.Country data)<BR>&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;bool cancel = false;<BR>&nbsp;&nbsp;&nbsp;OnFetching(ref cancel);<BR>&nbsp;&nbsp;&nbsp;if (cancel) return;</P>
<P>&nbsp;&nbsp;&nbsp;CountryId = data.strCountryId;<BR>&nbsp;&nbsp;&nbsp;RegionId = data.strRegionId;<BR>&nbsp;&nbsp;&nbsp;Name = data.strName;<BR>&nbsp;&nbsp;&nbsp;Description = data.strDescription;<BR>&nbsp;&nbsp;&nbsp;CreatedBy = data.strCreatedBy;<BR>&nbsp;&nbsp;&nbsp;Created = data.datCreated;<BR>&nbsp;&nbsp;&nbsp;ModifiedBy = data.strModifiedBy;<BR>&nbsp;&nbsp;&nbsp;Modified = data.datModified;</P>
<P>&nbsp;&nbsp;&nbsp;OnFetched();<BR>&nbsp;&nbsp;}</P>
<P>&nbsp;&nbsp;partial void OnFetching(ref bool cancel);<BR>&nbsp;&nbsp;partial void OnFetched();<BR>&nbsp;&nbsp;#endregion //Data Access<BR>&nbsp;}<BR>}<BR></P>
<P>using System.Linq;<BR>using Csla;<BR>using Csla.Data;<BR>using Csla.Security;<BR>using Csla.Validation;<BR>using Fim.HR.JL.Dat.Components;</P>
<P>namespace Fim.HR.JL.Bus.Components<BR>{ <BR>&nbsp;public partial class Country : Csla.ReadOnlyBase&lt;Country&gt;<BR>&nbsp;{<BR>&nbsp;&nbsp;&nbsp; public static Country GetCountry(string id)<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return DataPortal.Fetch&lt;Country&gt;(new SingleCriteria&lt;Country, string&gt;(id));<BR>&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;&nbsp;&nbsp; private void DataPortal_Fetch(SingleCriteria&lt;Country, string&gt; criteria)<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!string.IsNullOrEmpty( criteria.Value) )<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using (var mgr = ContextManager&lt;Fim.HR.JL.Dat.Components.HRJLDataContext&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .GetManager(Database.HRJL, false))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var data = (from r in mgr.DataContext.Countries<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; where r.strCountryId == criteria.Value<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; select r).Single();</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CountryId = data.strCountryId;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RegionId = data.strRegionId;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Name = data.strName;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Description = data.strDescription;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CreatedBy = data.strCreatedBy;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Created = data.datCreated;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ModifiedBy = data.strModifiedBy;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Modified = data.datModified;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }//using<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;}<BR>}<BR></P>
<P>---------------------------------REGION-----------------------------------------</P>
<P>using System;</P>
<P>namespace Fim.HR.JL.Bus.Components<BR>{ <BR>&nbsp;[Serializable()] <BR>&nbsp;public partial class Region : Csla.ReadOnlyBase&lt;Region&gt;<BR>&nbsp;{<BR>&nbsp;&nbsp;public string RegionId { get; private set; }<BR>&nbsp;&nbsp;public string Name { get; private set; }<BR>&nbsp;&nbsp;public string Description { get; private set; }<BR>&nbsp;&nbsp;public string CreatedBy { get; private set; }<BR>&nbsp;&nbsp;public DateTime Created { get; private set; }<BR>&nbsp;&nbsp;public string ModifiedBy { get; private set; }<BR>&nbsp;&nbsp;public DateTime? Modified { get; private set; }</P>
<P>&nbsp;&nbsp;internal static Region GetRegion(Fim.HR.JL.Dat.Components.Region data)<BR>&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;Region item = new Region();<BR>&nbsp;&nbsp;&nbsp;item.Fetch(data);<BR>&nbsp;&nbsp;&nbsp;return item;<BR>&nbsp;&nbsp;}</P>
<P>&nbsp;&nbsp;private Region()<BR>&nbsp;&nbsp;{ /* require use of factory method */ }</P>
<P>&nbsp;&nbsp;#region Data Access<BR>&nbsp;&nbsp;private void Fetch(Fim.HR.JL.Dat.Components.Region data)<BR>&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;bool cancel = false;<BR>&nbsp;&nbsp;&nbsp;OnFetching(ref cancel);<BR>&nbsp;&nbsp;&nbsp;if (cancel) return;</P>
<P>&nbsp;&nbsp;&nbsp;RegionId = data.strRegionId;<BR>&nbsp;&nbsp;&nbsp;Name = data.strName;<BR>&nbsp;&nbsp;&nbsp;Description = data.strDescription;<BR>&nbsp;&nbsp;&nbsp;CreatedBy = data.strCreatedBy;<BR>&nbsp;&nbsp;&nbsp;Created = data.datCreated;<BR>&nbsp;&nbsp;&nbsp;ModifiedBy = data.strModifiedBy;<BR>&nbsp;&nbsp;&nbsp;Modified = data.datModified;</P>
<P>&nbsp;&nbsp;&nbsp;OnFetched();<BR>&nbsp;&nbsp;}</P>
<P>&nbsp;&nbsp;partial void OnFetching(ref bool cancel);<BR>&nbsp;&nbsp;partial void OnFetched();<BR>&nbsp;&nbsp;#endregion //Data Access<BR>&nbsp;}<BR>}<BR></P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>alef replied on Monday, December 08, 2008</h2><P>To avoid loading the Country several times I implemented the following in the City class :</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Country</FONT></FONT><FONT size=2> Country</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;get</P></FONT></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;{</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if</FONT></FONT><FONT size=2> (!countryLoaded)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;country = </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Country</FONT></FONT><FONT size=2>.GetCountry(CountryId);</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;countryLoaded = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>true</FONT></FONT><FONT size=2>;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return</FONT></FONT><FONT size=2> country;</P>
<P>&nbsp;&nbsp;&nbsp;}</P>
<P>}</P>
<P>&nbsp;</P>
<P><STRONG>Or can I use the fieldmanager for that?</STRONG> But pay attention&nbsp;City inherits from Csla.ReadOnlyBase.</P>
<P>City is a child of CityList :</P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>using</FONT></FONT><FONT size=2> System;</P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>using</FONT></FONT><FONT size=2> System.Linq;</P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>using</FONT></FONT><FONT size=2> Csla;</P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>using</FONT></FONT><FONT size=2> Csla.Data;</P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>using</FONT></FONT><FONT size=2> Fim.HR.JL.Dat.Components;</P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>namespace</FONT></FONT><FONT size=2> Fim.HR.JL.Bus.Components</P>
<P>{ </P>
<P>[</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Serializable</FONT></FONT><FONT size=2>()] </P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>partial</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>class</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>CityList</FONT></FONT><FONT size=2> : Csla.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ReadOnlyListBase</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>CityList</FONT></FONT><FONT size=2>, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>City</FONT></FONT><FONT size=2>&gt;</P>
<P>{</P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>#region</FONT></FONT><FONT size=2> Factory Methods</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>private</FONT></FONT><FONT size=2> CityList()</P>
<P>{ </FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>/* require use of factory method */</FONT></FONT><FONT size=2> }</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>static</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>CityList</FONT></FONT><FONT size=2> GetCityList()</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>return</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>DataPortal</FONT></FONT><FONT size=2>.Fetch&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>CityList</FONT></FONT><FONT size=2>&gt;();</P>
<P>}</P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>#endregion</FONT></FONT><FONT size=2> </FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>//Factory Methods</P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>#region</FONT></FONT><FONT size=2> Data Access</P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>#region</FONT></FONT><FONT size=2> Data Access - Fetch</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>private</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>void</FONT></FONT><FONT size=2> DataPortal_Fetch()</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>bool</FONT></FONT><FONT size=2> cancel = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>false</FONT></FONT><FONT size=2>;</P>
<P>OnFetching(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ref</FONT></FONT><FONT size=2> cancel);</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>if</FONT></FONT><FONT size=2> (cancel) </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>return</FONT></FONT><FONT size=2>;</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>using</FONT></FONT><FONT size=2> (</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>var</FONT></FONT><FONT size=2> mgr = </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ContextManager</FONT></FONT><FONT size=2>&lt;Fim.HR.JL.Dat.Components.HRJLDataContext&gt;</P>
<P>.GetManager(</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Database</FONT></FONT><FONT size=2>.HRJL,</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>false</FONT></FONT><FONT size=2>))</P>
<P>{</P>
<P>RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>false</FONT></FONT><FONT size=2>;</P>
<P>IsReadOnly = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>false</FONT></FONT><FONT size=2>;</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT><FONT size=2>.AddRange(</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>from</FONT></FONT><FONT size=2> row </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>in</FONT></FONT><FONT size=2> mgr.DataContext.Cities</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>select</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>City</FONT></FONT><FONT size=2>.GetCity(row)</P>
<P>);</P>
<P>IsReadOnly = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>true</FONT></FONT><FONT size=2>;</P>
<P>RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>true</FONT></FONT><FONT size=2>;</P>
<P>}</FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>//using</P>
<P>&nbsp;</P></FONT></FONT><FONT size=2>
<P>OnFetched();</P>
<P>}</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>partial</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>void</FONT></FONT><FONT size=2> OnFetching(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ref</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>bool</FONT></FONT><FONT size=2> cancel);</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>partial</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>void</FONT></FONT><FONT size=2> OnFetched();</P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>#endregion</FONT></FONT><FONT size=2> </FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>//Data Access - Fetch</P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>#endregion</FONT></FONT><FONT size=2> </FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>//Data Access</P></FONT></FONT><FONT size=2>
<P>}</P>
<P>}</P></FONT>
<P>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ben replied on Friday, January 11, 2008</h2><P>Hi,</P>
<P>I absolutly agree with robert_m</P>
<P>Ben</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>richardb replied on Friday, January 11, 2008</h2><P>I believe it's good for encapsualtion and the lists are cached anyway so a round trip to the database only occurs the first time a list needs to be used, or when the list changes (if using the latest CSLA).</P>
<P>&nbsp;</P>
<P>Yes...I mean that the NVL class will be seperate but you'd still have properties in the BO to access it as per the other posts here.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, January 11, 2008</h2><P>I tend to create a Use Case Controller object to handle the requirements. This is simply a normal Root BO which contains the Product BO as well as the NVLs for the use case. When I create a New instance of the controller object it fetches the Product and NVLs. I can add rules to the controller BO if it needs to verify data across more than one contained object. When I save the controller it doesn't usually save any data itself, it orchestrates the saving of the data in the contained BOs.</P>
<P>This keeps your Product object clean. Then it can be re-used in any other Use Case or UI without fear that it will contain a bunch of NVLs which are not needed in the other cases.</P>
<P>I would create a 2nd controller BO to contain a Product object if it required different NVLs (or other BOs) than the first Use Case.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ben replied on Friday, January 11, 2008</h2><P class=MsoNormal><SPAN>A simpler solution may be using the Factory pattern combined with the Singleton pattern:<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Public</SPAN><SPAN> <SPAN>Class</SPAN> ProvidersNVL<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Inherits</SPAN> NameValueListBase(<SPAN>Of</SPAN> System.String, System.String)<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>#<SPAN>Region</SPAN> <SPAN>" Singleton Pattern "<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Protected</SPAN> <SPAN>Shared</SPAN> mList <SPAN>As</SPAN> ProvidersNVL<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Public</SPAN> <SPAN>Shared</SPAN> <SPAN>Function</SPAN> GetList() <SPAN>As</SPAN> ProvidersNVL<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>If</SPAN> mList <SPAN>Is</SPAN> <SPAN>Nothing</SPAN> <SPAN>Then<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>mList = ActiveObjects.DataPortal.Fetch(<SPAN>Of</SPAN> ProvidersNVL)<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>End</SPAN> <SPAN>If<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Return</SPAN> mList<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>End</SPAN> <SPAN>Function<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Public</SPAN> <SPAN>Shared</SPAN> <SPAN>Sub</SPAN> InvalidateCache()<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>mList = <SPAN>Nothing<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>End</SPAN> <SPAN>Sub<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>#<SPAN>End</SPAN> <SPAN>Region</SPAN> <SPAN>' Singleton Pattern<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>...<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>End</SPAN><SPAN> <SPAN>Class<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>With this example the business layer and the UI layer can do the following every time the list is needed. By this way all objects can share the same information: <o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Dim</SPAN><SPAN> list <SPAN>As</SPAN> ProvidersNVL<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>list = ProvidersNVL.GetList<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>In our application we have many business objects sharing many NameValueLists (for instances CountriesNVL, ProvidersNVL, CustomersNVL, …) and all of them are loaded on demand and cached. You may have an Invoice BO that may need the CustomersNVL to validate its CustomerID property and you may have a DataForm with a ComboBox that uses the same CustomersNVL. But you may have many scenarios where both objects (the Invoice and its DataForm) are used and no one of them needs the CustomersNVL so you can avoid loading every NameValueList that may be used in any one of them. We always try to follow the lazy loading philosophy.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Ben<o:p></o:p></SPAN></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>NightOwl888 replied on Friday, January 11, 2008</h2><P>Joe,</P>
<P>I think you came up with an interesting solution to this issue.&nbsp; You are seperating even more business logic from the UI by having your Use Case BO decide which NVLs and BOs to load and save.&nbsp; This makes things simple on the UI because only one object reference is required.</P>
<P>However, it doesn't seem like you are accomplishing this any different than if it were in the UI directly. Namely, you are still making round trips to the database for each NVL. Correct me if I am wrong.</P>
<P>It still seems like this pattern could be used to handle even more complexity than just loading NVLs.&nbsp; Let's test this.&nbsp;Let's say instead of having a simple NVL to run the dropdown, we have a Read-Only collection with&nbsp;4 other values we are interested in saving with the main BO.</P>
<P>Going back to our product object, let's say we have a "Size" dropdown and each size changes the SKU of the product to something else. Furthermore, each size adds or subtracts an amount to the price.&nbsp; So in this example if the user selects the size they want from the dropdown, we will need to save the SizeID (primary key), the size description (for use on the invoice), the SKU Fragment (what part of the SKU will change to - this will require additional business logic), and a price adjustment field.</P>
<P>It seems like in this example, you could have your Use Case BO handle all of the logic of changing the SKU and the price as well as pulling the other two fields from the ReadOnlyList to populate in ShoppingCart object.&nbsp; Or do you think in this (more complex)&nbsp;case it would make more sense to encapsulate all of this business logic inside of the Product object by including the ReadOnlyList inside of the Product?</P>
<P>&nbsp;</P>
<P>My problem is even more complex than this is, but I am just trying to see if this solution can be used to simplify some of the complexity.</P>
<P>-NightOwl888</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Saturday, January 12, 2008</h2><P>"However, it doesn't seem like you are accomplishing this any different than if it were in the UI directly. Namely, you are still making round trips to the database for each NVL. Correct me if I am wrong."</P>
<P>The above statement is correct. The major differece is that the UI is "dumb" in one case and "too smart" in the other. I think we want a "dumb" UI so that when it comes time to build a new one we don't have to transfer a lot of logic from the old UI to the new one.</P>
<P>&nbsp;</P>
<P>As far as round trips to the DB - I tend to want to get the values from the DB without caching. (They change a lot.)&nbsp;But there is nothing preventing you from caching these NVLs and then have the controller BO fetch them from the cache. It is a preference.</P>
<P>===================================================================</P>
<P>"...would make more sense to encapsulate all of this business logic inside of the Product object by including the ReadOnlyList inside of the Product?"</P>
<P>No. It would only make sense&nbsp;if the Product object *always* needs the ROC in every Use Case. You might re-use the same controller object because you have some use cases which overlap.</P>
<P>===================================================================</P>
<P>"It still seems like this pattern could be used to handle even more complexity than just loading NVLs."</P>
<P>It is. &lt;g&gt; <BR>I load root BOs with complex hierarchies, ROCs, NVLs, etc. All the different BOs which are required to satisfy the use case.</P>
<P>===================================================================</P>
<P>When you have an NVL inside a Use Case Controller BO, you fetch it and bind the values to the screen. But you *unbind* the selected value into one of your other BOs (the FK.)</P>
<P>===================================================================</P>
<P>You sample with the ROC is more complex than an NVL. But the same ideas could apply. In this case you should decide if you really need an ROC at all or whether the Use Controller will fetch those 4 values instead. The controller BO could then bind them to the UI and let the user change all the values and then decide what to do with them later. Whereas if you just have an ROC the user can't really modify the values.</P>
<P>If you only want the user to select an ID from the dropdown and then you look up that row in the ROC and "transfer" all the data to your other BO&nbsp;&nbsp; - that seems reasonable to me.</P>
<P>The bottom line is that the Controller BO can centralize all the activity for this Use Case.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Saturday, January 12, 2008</h2><P>I use the following guideline:</P>
<P>If the NVL is the same regardless of context or business object data, then I implement a factory directly on the NVL.</P>
<P>If the NVL is different depending on the context or business object data, then I implement a property on the context/business object to return the appropriate NVL.</P>
<P>&nbsp;</P>
<P>Consider a list of country codes. In many cases such a list will be the same at all times, and so should be globally and directly available.</P>
<P>list = CountryCodes.GetList()</P>
<P>But then consider a list of country codes where a product can be sold. Some products might have restrictions on export/import/etc. This is very dependent on the OrderLineItem object (as an example), and so the list should come from that object:</P>
<P>list = _order.LineItems[42].ValidCountryCodes</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jfreeman replied on Wednesday, February 20, 2008</h2>I have a scenario where I could potentially have 3 NVLs.&nbsp; When the user creates a record they have to choose Company, Office &amp; Department.&nbsp; Company is easy.&nbsp; The list is always the same.&nbsp; Office is filtered by which Company they choose.&nbsp; Department is filtered by which Company &amp; Office they choose.&nbsp; What is the best way to handle this type logic?&nbsp; Thanks.<br><br>Jonathan<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, February 20, 2008</h2><P>As per the earlier content of the thread, your Company object can be a root object.</P>
<P>But your Office and Department objects should exist within some other root object. You say the user is creating a "record", so let's call that a Record object.</P>
<P>The Record object should expose OfficeList and DepartmentList&nbsp;properties, which return appropriately filtered lists.</P>
<P>The Record object also has Company, Office and Department properties - presumably getting and setting the key values from the three NVL objects. When the Company property is set that would trigger reloading the OfficeList and DepartmentList NVL properties, and revalidation of the Office and Department properties (because they might no longer be valid at all now).</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tna55 replied on Thursday, February 21, 2008</h2><P>Rocky,</P>
<P>The way I have done this in my project is to have three NVL classes, CompanyNVL, CompanyOfficeNVL and OfficeDepartmentNVL. I get these NVL with factory methods e.g.</P>
<P>Dim mCompanyList As CompanyNVL = CompanyNVL.Load()</P>
<P>Dim mOfficeList As CompanyOfficeNVL = CompanyOfficeNVL.Load(CompanyID)</P>
<P>Dim mDepartmentList As OfficeDepartmentNVL = OfficeDepartmentNVL.Load(OfficeID)</P>
<P>Is this correct by design?</P>
<P>Tahir</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, February 21, 2008</h2>






 

 
  
 




<div class=Section1>

<p class=MsoNormal><span>Yes, that&#8217;s exactly what I do.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>But the &#8220;Record&#8221; object in the example needs to
validate the Office and Department properties, so it needs access to the
properly filtered lists, so it must already have a containment relationship with
those objects, so it is reasonable for it to provide navigation to those
pre-filtered objects as well.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>So I tend to make those particular factories Friend/internal,
thus forcing the UI developer to go through my &#8220;Record&#8221; object &#8211;
ensuring they get the correct filtering for each specific Record.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>Rocky<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<div>

<p class=MsoNormal><b><span>From:</span></b><span> tna55
[mailto:cslanet@lhotka.net] <br>
<b>Sent:</b> Thursday, February 21, 2008 7:13 AM<br>
<b>To:</b> rocky@lhotka.net<br>
<b>Subject:</b> Re: [CSLA .NET] Should NVL objects for dropdowns be inside
Business Objects?<o:p></o:p></span></p>

</div>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p>Rocky,<o:p></o:p></p>

<p>The way I have done this in my project is to have three NVL classes,
CompanyNVL, CompanyOfficeNVL and OfficeDepartmentNVL. I get these NVL with
factory methods e.g.<o:p></o:p></p>

<p>Dim mCompanyList As CompanyNVL = CompanyNVL.Load()<o:p></o:p></p>

<p>Dim mOfficeList As CompanyOfficeNVL = CompanyOfficeNVL.Load(CompanyID)<o:p></o:p></p>

<p>Dim mDepartmentList As OfficeDepartmentNVL =
OfficeDepartmentNVL.Load(OfficeID)<o:p></o:p></p>

<p>Is this correct by design?<o:p></o:p></p>

<p>Tahir<o:p></o:p></p>

<p class=MsoNormal><br>
<br>
<o:p></o:p></p>

</div>



</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jfreeman replied on Thursday, February 21, 2008</h2>Rocky,<br><br>What you describe makes sense but being fairly new to CSLA I'm not sure how to code that in the object.&nbsp; Are there any code examples that would help clarify how to implement this logic?&nbsp; Thanks.<br><br>Jonathan<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jfreeman replied on Thursday, February 21, 2008</h2>When you say the Company should be a root object, do you mean it should a Business Base or NVL?&nbsp; Where should the logic be that gets triggered to reload OfficeList and DeptartmentList?&nbsp; If it is in the Record object, what would that logic look like?&nbsp; Thanks.<br><br>Jonathan<br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
