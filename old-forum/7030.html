<html><header><title>CSLA Light - FileInfo</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA Light - FileInfo</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7030.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>CampbellCM posted on Monday, June 01, 2009</h2>Can anyone think of a way to get a FileInfo object from the SL client to the WCF server via CSLA?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>sergeyb replied on Monday, June 01, 2009</h2>Not quite sure what you are asking.  OpenDialog in SL returns a stream that you can save in byte[] property of your object and send it that way to the server.   The only caution would be the size.  For larger files you would be better off using WCF streaming.<br /><br />Sergey Barskiy<br />Principal Consultant<br />office: 678.405.0687 | mobile:&#160;404.388.1899<br /><br />Microsoft Worldwide Partner of the Year | Custom Development Solutions, Technical Innovation<br /><br />-----Original Message-----<br />From: CampbellCM [mailto:cslanet@lhotka.net] <br />Sent: Monday, June 01, 2009 5:32 PM<br />To: Sergey Barskiy<br />Subject: [CSLA .NET] CSLA Light - FileInfo<br /><br />Can anyone think of a way to get a FileInfo object from the SL client to the WCF server via CSLA?<br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>CampbellCM replied on Tuesday, June 02, 2009</h2><P>Yeah, my problem is that the files are large, multi-MB.&nbsp; I tried passing the contents as a string (it's a text file) but the serializer choked big time (yes, I'm using compression).&nbsp; The easiest thing would be to pass the file name from the FileInfo object from the client to the server but that kind of information is off limits in the SL runtime.&nbsp; The next easiest thing would be to pass the entire FileInfo object because&nbsp;the file name and such would be accessible once the object got to the server.&nbsp; That's not possible either because the FileInfo class is not serializable.&nbsp; So then I tried serializing the file contents via the CSLA serializer and some part thereof or below choked on it.&nbsp; I spent the rest of today trying to get WCF streaming to work and had no luck there either.&nbsp; It seems like anything worth serializing is not serializable.</P>
<P>Sergey, I don't suppose you recall seeing an example of WCF Streaming...</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, June 02, 2009</h2>A quick bing search on uploading files from Silverlight reveals many answers, including a pre-built solution on codeplex: <A href="http://www.codeplex.com/SilverlightFileUpld">http://www.codeplex.com/SilverlightFileUpld</A></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>CampbellCM replied on Thursday, June 04, 2009</h2>Thanks Rocky, but uploading a file is not quite what I'm after.  I need to be able to send the contents of a file from the client to the server so that said contents can be processed on the server.  I am using a CommandBase derived class to do that.<br /><br />In any case, I have discovered what the problem was...why getting the data from the client to the server was failing.  It turned out to be a missing configuration setting in my Web.config file:<br /><br />[system.web]<br />  [httpRuntime maxRequestLength="2097151"/]<br />[/system.web]<br /><br />The maxRequestLength parameter tells the web service how large a request from the client can be and without it requests are limited to somewhere between 10KB and 20KB.  As soon as I added that parameter/value it just started to work, no problems.<br /><br />For the sake of others that may read this I would like to add that I am using compression as recommended and I am also including the relevent contents of my server-side Web.config file and my client-side ServiceReferences.ClientConfig file.<br /><br />Web.config:<br /><br />[system.serviceModel]<br />  [behaviors]<br />    [serviceBehaviors]<br />      [behavior name="WcfPortalBehavior"]<br />        [serviceMetadata httpGetEnabled="true"/]<br />        [serviceDebug includeExceptionDetailInFaults="false"/]<br />      [/behavior]<br />    [/serviceBehaviors]<br />  [/behaviors]<br />  [services]<br />    [service behaviorConfiguration="WcfPortalBehavior" name="Fidelity.Management.Compression.CompressedHost"]<br />      [endpoint address="" binding="basicHttpBinding" contract="Csla.Server.Hosts.Silverlight.IWcfPortal" bindingConfiguration="BasicHttpBinding_IWcfPortal"/]<br />    [/service]<br />  [/services]<br />  [bindings]<br />    [basicHttpBinding]<br />      [binding name="BasicHttpBinding_IWcfPortal" maxBufferSize="2147483647" maxReceivedMessageSize="2147483647" maxBufferPoolSize="2147483647"<br />               receiveTimeout="00:10:00" sendTimeout="00:10:00" openTimeout="00:10:00" closeTimeout="00:10:00"]<br />        [readerQuotas maxBytesPerRead="2147483647" maxArrayLength="2147483647" maxStringContentLength="2147483647" maxDepth="2147483647" maxNameTableCharCount="2147483647"/]<br />      [/binding]<br />    [/basicHttpBinding]<br />  [/bindings]<br />[/system.serviceModel]<br /><br />ServiceReferences.ClientConfig:<br /><br />[configuration]<br />  [system.serviceModel]<br />    [bindings]<br />      [basicHttpBinding]<br />        [binding name="BasicHttpBinding_IWcfPortal" maxBufferSize="2147483647" maxReceivedMessageSize="2147483647"<br />                 receiveTimeout="00:10:00" sendTimeout="00:10:00" openTimeout="00:10:00" closeTimeout="00:10:00"/]<br />      [/basicHttpBinding]<br />    [/bindings]<br />    [client]<br />      [endpoint address="http://localhost:2978/CompressedWcfPortal.svc" binding="basicHttpBinding"<br />                bindingConfiguration="BasicHttpBinding_IWcfPortal" contract="Csla.WcfPortal.IWcfPortal" name="BasicHttpBinding_IWcfPortal"/]<br />    [/client]<br />  [/system.serviceModel]<br />[/configuration]<br /><br />In order to post this information I had to replace all of the less than and greater than characters with left and right square bracket characters.<br /><br />I would also like to emphasize the importance of accuracy in these files.  If things are not working as expected it may just be because of a typo in either or both files (I should know!).<br /><br />Perhaps some of this information could be added to the CSLA Light FAQ.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
