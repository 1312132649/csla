<html><header><title>MSDTC on server 'XXXXXX' is unavailable.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>MSDTC on server 'XXXXXX' is unavailable.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1833.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>tseveryn posted on Sunday, November 26, 2006</h2><P class=MsoNormal><SPAN><STRONG>Hi,</STRONG></SPAN></P>
<P class=MsoNormal><SPAN><STRONG></STRONG></SPAN>&nbsp;</P>
<P class=MsoNormal><SPAN><STRONG>I've gotten rid of the GUID as the ProjectID in PTracker, and replaced it with datatype INTEGER.</STRONG></SPAN></P>
<P class=MsoNormal><SPAN><STRONG></STRONG></SPAN>&nbsp;</P>
<P class=MsoNormal><SPAN><STRONG>Made corresponding changes to the database. [Running everything locally.]</STRONG></SPAN></P>
<P class=MsoNormal><SPAN><STRONG></STRONG></SPAN>&nbsp;</P>
<P class=MsoNormal><SPAN><STRONG>Modified PROJECT class and its child collection the same way it is done for RESOURCE.</STRONG></SPAN></P>
<P class=MsoNormal><SPAN><STRONG></STRONG></SPAN>&nbsp;</P>
<P class=MsoNormal><SPAN><STRONG>Can successfuly create new project(s) without children, however when trying to assign resources to it - i'm getting the following error:</STRONG></SPAN></P>
<P class=MsoNormal><SPAN></SPAN>&nbsp;</P><SPAN>
<P class=MsoNormal><SPAN>---------------------------<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>Error saving<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>---------------------------<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>System.Data.SqlClient.SqlException: MSDTC on server 'XXXXXXX' is unavailable.<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection)<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj)<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj)<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at System.Data.SqlClient.SqlDataReader.ConsumeMetaData()<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at System.Data.SqlClient.SqlDataReader.get_MetaData()<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at System.Data.SqlClient.TdsParser.TdsExecuteTransactionManagerRequest(Byte[] buffer, TransactionManagerRequestType request, String transactionName, TransactionManagerIsolationLevel isoLevel, Int32 timeout, SqlInternalTransaction transaction, TdsParserStateObject stateObj)<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at System.Data.SqlClient.TdsParser.GetDTCAddress(Int32 timeout, TdsParserStateObject stateObj)<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at System.Data.SqlClient.SqlInternalConnectionTds.GetDTCAddress()<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at System.Data.SqlClient.SqlInternalConnection.EnlistNonNull(Transaction tx)<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at System.Data.SqlClient.SqlInternalConnection.Enlist(Transaction tx)<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at System.Data.SqlClient.SqlInternalConnectionTds.Activate(Transaction transaction)<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at System.Data.ProviderBase.DbConnectionInternal.ActivateConnection(Transaction transaction)<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at System.Data.ProviderBase.DbConnectionPool.GetConnection(DbConnection owningObject)<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection)<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory)<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at System.Data.SqlClient.SqlConnection.Open()<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at PROJECTTRACKER.Library.ProjectResource.Insert(Project Project) in C:\WorkSpace\PROJECTTRACKER\PROJECTTRACKER.Library\ProjectResource.vb:line 183<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at PROJECTTRACKER.Library.ProjectResources.Update(Project Project) in C:\WorkSpace\PROJECTTRACKER\PROJECTTRACKER.Library\ProjectResources.vb:line 143<SPAN>&nbsp;&nbsp;&nbsp; </SPAN>at PROJECTTRACKER.Library.Project.DataPortal_Update() in C:\WorkSpace\PROJECTTRACKER\PROJECTTRACKER.Library\Project.vb:line 403<o:p></o:p></SPAN></P>
<P class=MsoNormal>
<P class=MsoNormal><SPAN><o:p></o:p></SPAN>&nbsp;</P></P>
<P class=MsoNormal><SPAN><o:p></o:p></SPAN>&nbsp;</P>
<P class=MsoNormal><SPAN><o:p><STRONG>Something is still there since it tries to invoke MSDTC (Microsoft Distributed Transaction Coordinator)..</STRONG></o:p></SPAN></P>
<P class=MsoNormal>
<P class=MsoNormal><SPAN><o:p><STRONG></STRONG></o:p></SPAN>&nbsp;</P>
<P class=MsoNormal><SPAN><o:p><STRONG>Any help would be greatly appreciated.</STRONG></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p></o:p></SPAN>&nbsp;</P>
<P class=MsoNormal><SPAN><o:p></o:p></SPAN>&nbsp;</P>
<P class=MsoNormal><SPAN><o:p>Thank you very much,</o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>Teresa Severyn</o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p></o:p></SPAN>&nbsp;</P></SPAN></P>
<P><SPAN></SPAN>&nbsp;</P>
<P><SPAN></SPAN>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, November 27, 2006</h2>Sounds like your using transaction scope transactions, and are opening more than one database connection within the scope.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Kahn replied on Thursday, November 30, 2006</h2>Which version of windows are you running? But default the install of VS on Windows XP MSDTC is automatically installed and you would never see this error. <br><br>To check if MSDTC is installed (highly unlikely since your getting this error)<br><br>Go to start--&gt;Control panel---&gt;Administrative Tools--&gt;Services---&gt;You should see an entry there for distributed transaction server service turn it on if it's off.<br><br>Give me some more info and I can assist as I have had several problems with MSDTC.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, December 01, 2006</h2>MSDTC as far as I know is part of the OS, you can't uninstall it.<br><br>I wouldn't recommend using the DTC unless you really have a need for it, because its quite a bit of overhead.&nbsp; Instead, it would be better if we knew how he was attempting transactions.&nbsp; <br><br>Most people with this error are using TransactionScope, and opening more than one connection within the scope.&nbsp; Changing your code to use only one connection would correct this error and is a better solution, because you avoid the DTC.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Kahn replied on Thursday, December 21, 2006</h2>Well msdtc is apart of some OSes in Windows Media Edition it's not apart of the OS.<br><br>Personally I havent find any adverse effects of using MSDTC. However I haven't done any major msdtc work.<br><br>Well whatever solution you try hope it works. :)<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DansDreams replied on Thursday, December 21, 2006</h2>MSDTC is required for TransactionScope on SQL versions prior to SQL 2005.&nbsp; It is a resource hog.&nbsp; I think the recommendation is avoid TransactionScope or upgrade to SQL 2005.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MRDPrince replied on Monday, April 18, 2011</h2><p>Set the connection string property &quot;Enlist=False&quot; to avoid using MSDTC.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
