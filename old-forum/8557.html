<html><header><title>multiple csla:InvokeMethods on a control</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>multiple csla:InvokeMethods on a control</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8557.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Martino posted on Friday, February 19, 2010</h2><p>This might be more of a WPF question, but is it possible to set multiple csla:InvokeMethods on one control?</p>
<p>for example a csla:InvokeMethod.TriggerEvent&nbsp;for&nbsp; the click event and one for the MouseEnter event of a button?</p>
<p>This obviously won&#39;t work</p>
<p>&lt;Button</p>
<p>csla:InvokeMethod.TriggerEvent=&quot;Click&quot;</p>
<p>csla:InvokeMethod.MethodName = &quot;OnClickHandler&quot;</p>
<p>csla:invokeMethod.TriggerEvent=&quot;MouseEnter&quot;</p>
<p>csla:InvokeMethod.MethodName = &quot;OnMouseEnterHandler&quot;/&gt;</p>
<p>&nbsp;</p>
<p>
<p>I&#39;ve also seen some refernces made to a MVVM example, is this the MVVMExperiment project? If not where do i find the MVVM example?</p>
<p>&nbsp;</p>
<p>btw. Love the new modelview&nbsp;stuff in 3.8.0</p>
</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Martino replied on Tuesday, February 23, 2010</h2><p>Any ideas? </p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>triplea replied on Tuesday, February 23, 2010</h2><p>I remember a similar post but even though I searched for it I could not find it.</p>
<p>I think the only way to achieve this you will need to use the trigger method:</p>
<p>&lt;Button Content=&quot;Click Me&quot;&gt; <br />&nbsp; &lt;i:Interaction.Triggers&gt; <br />&nbsp;&nbsp;&nbsp; &lt;i:EventTrigger EventName=&quot;Click&quot;&gt; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;csla:Execute MethodName=&quot;LoadData&quot; /&gt; <br />&nbsp;&nbsp;&nbsp; &lt;/i:EventTrigger&gt;&nbsp;<br />&nbsp;&nbsp;&nbsp; &lt;i:EventTrigger EventName=&quot;MouseOver&quot;&gt; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;csla:Execute MethodName=&quot;AnimateMe&quot; /&gt; <br />&nbsp;&nbsp;&nbsp; &lt;/i:EventTrigger&gt;&nbsp;<br />&nbsp;&nbsp; ...<br />&nbsp; &lt;/i:Interaction.Triggers&gt; <br />&lt;/Button&gt; </p>
<p>I know this is not exactly what you are looking for but thought I&#39;d let you know anyway.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Martino replied on Tuesday, February 23, 2010</h2><p>This would work in most cases. </p>
<p>In my case I need to databind to the (non-bindable) SelectedItems for both triggers. For that i&#39;d like to use Rockys work around:</p>
<p>csla<span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">:</span></span><span style="color:#ff0000;font-size:x-small;"><span style="color:#ff0000;font-size:x-small;">InvokeMethod.MethodParameter</span></span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">=&quot;{</span></span><span style="color:#a31515;font-size:x-small;"><span style="color:#a31515;font-size:x-small;">Binding</span></span><span style="color:#ff0000;font-size:x-small;"><span style="color:#ff0000;font-size:x-small;"> ElementName</span></span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">=myGrid,</span></span><span style="color:#ff0000;font-size:x-small;"><span style="color:#ff0000;font-size:x-small;"> Path</span></span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">=SelectedItems}&quot; </span></span></p>
<p>with a dependency property &#39;SelectedItems&#39; in the ViewModel</p>
<p>I&#39;ve looked at using multibinding, but i&#39;m kinda stuck there too.</p>
<p>
<p>&nbsp;</p>
</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>Martino replied on Thursday, February 25, 2010</h2><p><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;">Just in case somebody ran into the same issue. Here is Rockys response:</span></p>
<p><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;">Unfortunately InvokeMethod is an attached property (actually a set of related attached properties), so there&rsquo;s no real way to have more than one of them attached to a control &ndash; at least not that I know of.</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;">&nbsp;</span><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;">Execute is a trigger action based on the event trigger concepts defined by Blend 3 in their SDK. They don&rsquo;t expose as much information to a trigger action as I can get as an attached property, which restricts what Execute can do to solve this problem. In short, Execute can&rsquo;t do the &ldquo;live binding&rdquo; that InvokeMethod does, because trigger actions just don&rsquo;t have enough information to do that.</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;">&nbsp;</span><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;">In CSLA 4 I&rsquo;ve implemented yet another solution, called TriggerAction. This is a standalone control, which is required to work with the Visual Studio 2010 designer.</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;"><a href="http://www.lhotka.net/weblog/ApplyingMVVMInTheVS10XAMLDesigner.aspx" title="blocked::http://www.lhotka.net/weblog/ApplyingMVVMInTheVS10XAMLDesigner.aspx"><span style="color:#800080;">http://www.lhotka.net/weblog/ApplyingMVVMInTheVS10XAMLDesigner.aspx</span></a></span></p>
<p class="MsoNormal"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;">&nbsp;</span><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;">Right now it doesn&rsquo;t do the &ldquo;live binding&rdquo; that InvokeMethod does either. But I suppose it probably should include that functionality.</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;">&nbsp;</span><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;">The advantage of TriggerAction, is that you can have as many of them as you&rsquo;d like, all attached to different (or even the same) events of a given UI control. So the flexibility is substantially greater than with InvokeMethod.</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;">&nbsp;</span><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;">You can see the code here</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;"><a href="http://www.lhotka.net/cslacvs/viewvc.cgi/core/branches/V4-0-0-RC/Source/Csla.Xaml/TriggerAction.cs?view=markup" title="blocked::http://www.lhotka.net/cslacvs/viewvc.cgi/core/branches/V4-0-0-RC/Source/Csla.Xaml/TriggerAction.cs?view=markup"><span style="color:#800080;">http://www.lhotka.net/cslacvs/viewvc.cgi/core/branches/V4-0-0-RC/Source/Csla.Xaml/TriggerAction.cs?view=markup</span></a></span></p>
<p class="MsoNormal"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;">&nbsp;</span><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;">But as I said, the MethodParameter functionality from InvokeMethod needs to be merged into this control for it to fully address your scenario.</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Calibri&#39;,&#39;sans-serif&#39;;color:#1f497d;font-size:11pt;">Rocky</span></p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
