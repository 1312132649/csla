<html><header><title>Additional properties on AppIdentity class in Silverlight3</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Additional properties on AppIdentity class in Silverlight3</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8080.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Russ posted on Wednesday, December 02, 2009</h2>Has anyone been able to add custom properties to the AppIdentity class in Silverlight3?<br /><br />I tried the following:<br /><br />namespace Business<br />{<br />  [Serializable]<br />  public partial class AppIdentity : Csla.Security.CslaIdentity<br />  {<br />    public AppIdentity()<br />    { }<br /><br />		public int UserPK { get { return (String.IsNullOrEmpty(Name) ? 0 : int.Parse(Name)); } }<br />		public string FirstName { get; private set; }<br />		public string LastName { get; private set; }<br />		public string FullNameFL { get { return FirstName + " " + LastName; } }<br /><br />  }<br />}<br /><br />But the custom fields were always null in the client. I reasoned that I required managed backing fields however I was unable to add them because the base class was CslaIdentity.<br /><br />Another thought I have is that Rocky designed this on purpose to keep the AppIdentity class as small as possible because it is the most frequently tranferred object throught the data portal. Should I instead be creating a CurrentUser readonly class that get populated at login and is cached?<br /><br />Any "Best Practices" info would be greatly appreciated.<br /><br />Thanks<br />Russ.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, December 03, 2009</h2><P>You do need to use managed backing fields, or override OnGetState/OnSetState to serialize your private backing fields by hand.</P>
<P>The trick with CslaIdentity (like CommandBase) is that the type isn't generic, so you need to use the long form of RegisterProperty() where the first parameter is the type of the containing object (in your case AppIdentity).</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Russ replied on Thursday, December 03, 2009</h2>Thanks Rocky,<br /><br />That was exactly what I was missing. I had tried the newer RegisterProperty syntax using the lambda expression and it had failed.<br /><br />For the benefit of others who find this thread, here is the working AppIdentity class.<br /><br />namespace Business<br />{<br />  [Serializable]<br />  public partial class AppIdentity : Csla.Security.CslaIdentity<br />  {<br />    public AppIdentity()<br />    { }<br /><br />		private static PropertyInfo FirstNameProperty =<br />			RegisterProperty(typeof(AppIdentity), new PropertyInfo("FirstName", "First Name"));<br />		public string FirstName<br />		{<br />			get { return GetProperty(FirstNameProperty); }<br />		}<br /><br />		private static PropertyInfo LastNameProperty =<br />			RegisterProperty(typeof(AppIdentity), new PropertyInfo("LastName", "Last Name"));<br />		public string LastName<br />		{<br />			get { return GetProperty(LastNameProperty); }<br />		}<br /><br />		public int UserPK { get { return (String.IsNullOrEmpty(Name) ? 0 : int.Parse(Name)); } }<br />	<br />		public string FullNameFL { get { return FirstName + " " + LastName; } }<br />  }<br />}<br /><br />Regards<br />Russ<br /></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
