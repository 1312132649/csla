<html><header><title>How do you remove a Validation Rule?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How do you remove a Validation Rule?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2047.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 posted on Friday, December 29, 2006</h2><P>I use split classes and Codegen as much of my Base class as possible. Whenever I have a Status field I add a rule like this: (for Active and De-active values.)</P>
<P><FONT color=#008000 size=2>ValidationRules.AddRule(AddressOf ContainsValidValue, New ValidValuesRuleArgs("Status", "A", "D"))</P></FONT><FONT size=2>
<P></P></FONT>
<P>But in a recnet case, it turns out that both A and D are not part of the list of status values. </P>
<P>so in my developer level class I would like to call </P><FONT size=2></FONT><FONT color=#0000ff size=2><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> AddBusinessRules()<BR>&nbsp; </FONT><FONT color=#0000ff size=2>MyBase</FONT><FONT size=2>.AddBusinessRules()</FONT></P>
<P><FONT size=2>&nbsp; 'Here is where I want to remove the rule above and add a new one below.<BR>&nbsp; 'But I do not see a ValidationRules.RemoveRule method.</FONT></P>
<P><FONT color=#008000 size=2>&nbsp; 'Status<BR></FONT><FONT size=2>&nbsp; ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> StatusContainsValidValue, </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> PNIRuleArgs(</FONT><FONT color=#ff00ff size=2>"Status"</FONT><FONT size=2>))</P></FONT></FONT><FONT size=2></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT></P>
<P>I do not see a way to remove the rule.</P>
<P>Any tips?</P>
<P>Rocky - does it make sense to have such a method?</P>
<P>Short term - I can always codegen things differently. But I would like a longer term solution.</P>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, December 29, 2006</h2><P>I suppose it would be possible to remove a rule - though you'd need to know its full name. In 2.1 now, that is possible, because of the new rule://method/property?arg1=val1 scheme for naming rules. That URI is the rule's unique name, and would allow removal of a specific rule.</P>
<P>I'm not sure that would help you necessarily though, as you'd have to be able to create that full URI to identify the specific rule to be removed. Unless I supported a wildcard scheme by which you could remove rule://method/property?* or something like that.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Friday, December 29, 2006</h2>Here's what <i>I</i> think, not everybody will agree of course...<br><br>Rules are part of the object, or now that we have type rules, they apply to a type any instance of a class.<br>In a way similar as to people have "rules" incorporated and know when to apply them or not, it's in the rule where you decide whether it's valid or not. Part of that "is valid or not" is knowing whether the rule applies to the object or not, and we do that based on the data contained within the object.<br>There are many situations where the rule does not apply if certain property contains the value "x", and in those scenarios it would be painful to have the rules removed and added back if that property gets a value &lt;&gt; "x".<br><br>So, as a general rule, I do this:<br><br>Private Shared Function ValidateSomething(target as MyClass, e as RuleArgs) As Boolean<br>&nbsp;&nbsp;&nbsp; If target.CertainProperty = "x" Then<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;  Return True<br>&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp; If target.SomeOtherProperty = 2 Then<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;  e.Description = "Value cannot be 2"<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;  Return False<br>&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp; Return True<br>End Function<br><br><br>Another important thing to keep in mind here is that if you use type rules, removing a rule will apply to ALL your live objects, not just the current one... So if that's the way you want to go, you MUST use instance rules.<br><br>My 2 cents.<br><br>Andrés</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Saturday, December 30, 2006</h2><P>Andres,</P>
<P>I am using Type rules. The real problem is that I codegen the rule for Status (and assumed that A and D would be in&nbsp; the list of valid values)&nbsp;and now I have to either:</P>
<P>1. Comment out the rule in my Gen level class (which will work for now but if the class is ever re-generated then it is posisble that the rule would not be commented out in the future.)</P>
<P>2. Remove the rule in my developer level class and add a new rule for the Status field which uses the correct values.</P>
<P>So I do not need Instance rules - the rule I Generated is "bad code" and now I need to remove it for the Type and add back a new rule.</P>
<P>As I said, modifying the code gen process to not create the rule in the first place is a better idea - but I am looking for a different solution right now. I want to be able to use RemoveRule as easily as AddRule.</P>
<P>Thanks.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Saturday, December 30, 2006</h2>And you don't have a "codegen file" you can alter so that you can change the rule in there and regenerate the code?<br>What are you using to generate code?<br><br>Andrés<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Saturday, December 30, 2006</h2><P>Yes - I do have Codesmith templates which I may have to alter.</P>
<P>But, that is not the point of the question.</P>
<P>I would appreciate suggestions/comments about the the need/ability to remove rules if applied in a codegen class and you need/want to assign a different rule in the developer level class. </P>
<P>Assuming the need to do so is valid - what is required in the framework to create a method called RemoveRule? What would it have to know and be able to do?</P>
<P>Thanks.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Saturday, December 30, 2006</h2>Well, considering my position on rules which, again, not everybody will agree with, I think what you're trying to do is a workaround to a code generation issue.<br>If it's just a workaround you're trying to do, you may as well comment out the generated function and create one with the same name in your partial class. That way if you ever regenerate, you'll get a compile time error, which you can easily fix. Still, not as good as removing the rule or making your code generator output what you want, but it doesn't rely on a framework change that _might_ never happen....<br><br>Andrés<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DansDreams replied on Saturday, December 30, 2006</h2>Joe, I'd have to agree with Andres here.&nbsp; I don't understand why you're looking for a band-aid when you've already identified the problem is you're generating "bad" code.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RRorije replied on Tuesday, January 02, 2007</h2>Just my 2 cents,<br><br>You could also alter your templates to add the particular rule in a seperate function that can be overriden. By default the rule will be added, but in particular cases, you could replace the rule with something else, by inheriting this function in your custom (not generated) class.<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Tuesday, January 02, 2007</h2><P>I like the idea of being able to Override a separate function. The default behavior of the function would be to call the Shared rule. But if I Override it then I can write anything I need.</P>
<P>Thanks - I will try to implement it.</P>
<P>I tried it out for the Rule but since Shared methods are not Overridable it did not work. Then I moved everything to Instance Rules which are not Shared and I could override it. But I didn't like that.</P>
<P>So I left the original rule in place but coded an overridable&nbsp;function to get the list of valid values.<BR>That works nicely and I will add that to my template. Thanks for the idea.</P><FONT size=2>
<P>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> ContainsValidValue, </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> ValidValuesRuleArgs(</FONT><FONT color=#ff00ff size=2>"Status"</FONT><FONT size=2>, GetValidValues))</P></FONT>
<P>etc.</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetValidValues() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>()<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>() {</FONT><FONT color=#ff00ff size=2>"A"</FONT><FONT size=2>, </FONT><FONT color=#ff00ff size=2>"D"</FONT><FONT size=2>}<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT></P>
<P>In the Developer level class I use:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetValidValues() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>()<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>() {</FONT><FONT color=#ff00ff size=2>"A"</FONT><FONT size=2>, </FONT><FONT color=#ff00ff size=2>"X"</FONT><FONT size=2>, </FONT><FONT color=#ff00ff size=2>"H"</FONT><FONT size=2>, </FONT><FONT color=#ff00ff size=2>"V"</FONT><FONT size=2>, </FONT><FONT color=#ff00ff size=2>"N"</FONT><FONT size=2>, </FONT><FONT color=#ff00ff size=2>"I"</FONT><FONT size=2>, </FONT><FONT color=#ff00ff size=2>"R"</FONT><FONT size=2>, </FONT><FONT color=#ff00ff size=2>"L"</FONT><FONT size=2>, </FONT><FONT color=#ff00ff size=2>"O"</FONT><FONT size=2>, </FONT><FONT color=#ff00ff size=2>"P"</FONT><FONT size=2>}<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT>
<P>Joe</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
