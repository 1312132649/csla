<html><header><title>Read-only list and data access with an ObjectFactory</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Read-only list and data access with an ObjectFactory</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7579.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Dane posted on Sunday, September 06, 2009</h2>I just starting experimenting with the Csln .net framework in an attempt to prototype an idea for an application I have.&nbsp;&nbsp;The application I have in mind would be n-tier and would have the busniess object assembly&nbsp;isolated from all data access. &nbsp;As a first test I decided to implement a simple read-only list (inherits from ReadOnlyListBase).&nbsp; I put the business object (TestList) in a Library assembly and created an ObjectFactory (TestListFactory) in a DataAccess assembly.&nbsp; I decorated TestList with the ObjectFactory attribute and implemented the Fetch method on the TestListFactory object.&nbsp; I created a small boot-strap application to spin up the list and when I do the factory object's Fetch method is called, data is accessed but then I get the exception "Insert is an invalid operation".&nbsp; I figured out this is because the ReadOnly property is never set on the list for load.&nbsp; The question is how do you set that property when your data access is occuring in an different class (and different assembly)?&nbsp; It appears at first glace like the ReadOnlyListBase simply isn't a usable class if&nbsp;you want to use ObjectFactory and encapsulate your data access in an assembly outside the primary business object assembly.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Sunday, September 06, 2009</h2>Hi, <br><br>Your factory class must/should inherit from Csla.Server.ObjectFactory. <br><br>The ReadOnlyList is exactly what the name says - Readonly - so you must use the inherited function SetIsReadOnly(mylist, false) <b>before </b>you add items into the list and reset list to readonly before you leave the Fetch method.<br><br>You may want t look at the ProjectTrackercs in Samples for Csla 3.6.3 for Net 2 - this project uses ObjectFactory for Data Access. <a href="http://www.lhotka.net/cslacvs/viewvc.cgi/branches/V3-6-x-N2/">http://www.lhotka.net/cslacvs/viewvc.cgi/branches/V3-6-x-N2/</a><br><br>ObjectFactory also exposes other methods that is very helpful for creating a data layer! <br><br>It is also recommended to create your own base classes for use in your app to create logging ansd extend the framework when you need to. A starting point for baseclasses can be found at <a href="http://cslacontrib.codeplex.com%20">CslaContrib</a> - in the MyCsla project. <br><br>And I strongly recommend the <i>Expert C# 2008 Business Objects </i>book from Rocky to learn the framework and how to use it. <br><br>/jonnybee<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Dane replied on Tuesday, September 08, 2009</h2><P>Thanks.&nbsp; The SetIsReadOnly method is what I was looking for.&nbsp; I do understand the meaning of "read-only" and, in fact, in my post I stated I knew why the exception was occurring&nbsp;but didn't know a way around it.&nbsp; I had implemented my own version of a method to set read-only on the list class itself but I wasn't happy with that because it seemed like framework probably had a way to do it already.&nbsp; I own and have read Expert C# 2008 Business Objects but the ReadOnlyList examples in the book and in the version of the cslatest solution I have currently are pretty limited and&nbsp;do not implement the Object Factory pattern for the read-only list.&nbsp; In fact the discussion of how to implement the Object Factory (pg. 553) doesn't really cover what I'm trying to accomplish other than saying itâ€™s possible.&nbsp; It states "The factory object may be in the business assembly, in its own assembly or in the data access assembly." then it goes on to illustrate the case that the factory object is implemented in the business assembly.&nbsp; I'm trying to maintain complete separation of the business objects so that clients would need to receive only the business object assembly (and of course the csla assembly) and have no knowledge of the factory object or data access assemblies.</P>
<P>I'll look through the version of the test projects you linked to.&nbsp; It sounds like it contains the ProjectTracker project implemented with a different pattern?</P>
<P>Thanks again for the info.&nbsp; I guarantee I'll be posting more questions down the line (I already have another in mind).</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
