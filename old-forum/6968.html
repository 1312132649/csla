<html><header><title>TrasactionScope.....SqlServer 2000</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>TrasactionScope.....SqlServer 2000</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6968.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>MikeB posted on Tuesday, May 19, 2009</h2><P>I cannot use TransactionScope because my database is on SqlServer 2000 which does not support promotable transactions. It requires the <FONT face=Tahoma size=2>MSDTC and I don't want to install/enable this on the server.... Any suggestions? </FONT></P>
<P><FONT face=Tahoma size=2>Mike B</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, May 19, 2009</h2><P>As far as I know you have the following options</P>
<P>With DTC:</P>
<OL>
<LI>TransactionScope</LI>
<LI>Enterprise Services</LI></OL>
<P>Without DTC:</P>
<OL>
<LI>Manual transactions at the ADO.NET level</LI>
<LI>Manual transactions at the stored procedure level</LI>
<LI>Upgrade to a more recent version of SQL Server so you can use TransactionScope</LI></OL>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>triplea replied on Friday, May 22, 2009</h2>I had to do this some time ago. I digged up some code which I used from an example online (couldn't find the bookmark so sorry can't give any credit&nbsp; )</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>triplea replied on Friday, May 22, 2009</h2><P>I had to do this some time ago. I digged up some code which I used from an example online (couldn't find the bookmark so sorry can't give any credit&nbsp;... )</P>
<P>Add the attached file to your solution and then to use it in your DataPortal do the following:</P><B><FONT color=#eaeaac size=2><FONT color=#eaeaac size=2>
<P><FONT color=#0000ff>using</FONT></B></FONT></FONT><FONT color=#0000ff><FONT size=2><FONT size=2> (</FONT></FONT><FONT size=2><FONT size=2>SqlConnection</FONT></FONT><FONT size=2><FONT size=2> </FONT></FONT><FONT size=2><FONT size=2>sqlConnection</FONT></FONT><FONT size=2><FONT size=2> = </FONT></FONT><B><FONT size=2><FONT size=2>new</B></FONT></FONT></FONT><FONT color=#0000ff><FONT size=2><FONT size=2> </FONT></FONT><FONT size=2><FONT size=2>SqlConnection</FONT></FONT><FONT size=2><FONT size=2>(</FONT></FONT><FONT size=2><FONT size=2>"your database"</FONT></FONT></FONT><FONT color=#0000ff><FONT size=2><FONT size=2>))<BR>{<BR>&nbsp;&nbsp;&nbsp;</FONT></FONT><B><FONT size=2><FONT size=2>using</B></FONT></FONT></FONT><FONT color=#0000ff><FONT size=2><FONT size=2> (</FONT></FONT><FONT size=2><FONT size=2>TransactionScope</FONT></FONT><FONT size=2><FONT size=2> </FONT></FONT><FONT size=2><FONT size=2>ts</FONT></FONT><FONT size=2><FONT size=2> = </FONT></FONT><B><FONT size=2><FONT size=2>new</B></FONT></FONT></FONT><FONT color=#0000ff><FONT size=2><FONT size=2> </FONT></FONT><FONT size=2><FONT size=2>TransactionScope</FONT></FONT></FONT><FONT color=#0000ff><FONT size=2><FONT size=2>())<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT></FONT><FONT size=2><FONT size=2>DatabaseTransactionAdapter</FONT></FONT><FONT size=2><FONT size=2> </FONT></FONT><FONT size=2><FONT size=2>dbAdapter</FONT></FONT><FONT size=2><FONT size=2> = </FONT></FONT><B><FONT size=2><FONT size=2>new</B></FONT></FONT></FONT><FONT color=#0000ff><FONT size=2><FONT size=2> </FONT></FONT><FONT size=2><FONT size=2>DatabaseTransactionAdapter</FONT></FONT><FONT size=2><FONT size=2>(</FONT></FONT><FONT size=2><FONT size=2>sqlConnection</FONT></FONT></FONT><FONT color=#0000ff><FONT size=2><FONT size=2>);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT></FONT><FONT size=2><FONT size=2>sqlConnection</FONT></FONT><FONT size=2><FONT size=2>.</FONT></FONT><FONT size=2><FONT size=2>Open</FONT></FONT></FONT><FONT color=#0000ff><FONT size=2><FONT size=2>();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT></FONT><FONT size=2><FONT size=2>dbAdapter</FONT></FONT><FONT size=2><FONT size=2>.</FONT></FONT><FONT size=2><FONT size=2>Begin</FONT></FONT><FONT size=2><FONT size=2>();</FONT></FONT></FONT></P>
<P><FONT size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...<BR>&nbsp;&nbsp;&nbsp;}<BR>}</FONT></FONT><FONT size=2><FONT size=2></P></FONT></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
