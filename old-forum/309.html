<html><header><title>DB-side paging &amp; sorting datasource?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>DB-side paging &amp; sorting datasource?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/309.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ridge posted on Wednesday, June 07, 2006</h2>Has anyone implemented a DB-side paging &amp; sorting data source and read-only list base yet?&nbsp; I'm needing to provide a bindable data source for my web developers to slap onto a gridview. On the DB side I'll likely use the handy new ROW_NUMBER function through procs in MS SQL 2k5...&nbsp; If not can anyone think of any sticky issues?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, June 07, 2006</h2><P>I don't think you'd need a special object for this purpose would you? You'd just have a read-only root collection with a factory method like:</P>
<P>Public Shared Function GetList(startRow As Integer, pageSize As Integer) As MyCoolList</P>
<P>Or whatever values are needed for your DB algorithm to identify the start row and number of rows to retrieve. Given the stateless nature of the web you'd almost certainly have to keep at least the startRow (or lastRow or whatever) in the page itself so it is available on each postback.</P>
<P>The page size value should be available through the data source or grid controls.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ridge replied on Wednesday, June 07, 2006</h2>Thanks, I guess I was over-complicating it, I figured it'd be a mess.&nbsp; I don't generally diddle on the web server... I'll give it a whirl tomorrow.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ridge replied on Thursday, June 08, 2006</h2>So I spent a while this morning trying this out.&nbsp; Implementing the paged calls out to the DB is not the issue.&nbsp; The problem I'm running into is that data source view's ExecuteSelect is calculating the total row count as the number of entries in the list.&nbsp; Assuming you're populating a paged list, the list size is a subset of the total row count, as such the gridview isn't able to calculate the number of pages.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brent replied on Thursday, June 08, 2006</h2>Take a look at&nbsp;the SelectCountMethod on the datasource to specify a count method to return the total row count that you are paging.&nbsp;</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ridge replied on Thursday, June 08, 2006</h2>That's my point, ObjectDataSource provides a SelectCountMethod, the CslaDataSource does not.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>y0mbo replied on Thursday, June 08, 2006</h2>We created an abstract class called PagedCollectionBase which has CurrentPage, RecordsPerPage and TotalRecords.<br><br>The TotalRecords is retrieved in the DataPortal_Fetch as a second result set.&nbsp; CurrentPage and RecordsPerPage are specified in the Factory method call to get the collection.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, June 09, 2006</h2>




<DIV align=left><SPAN class=221344421-09062006><FONT face=Arial color=#0000ff size=2>I see. Based on this, and your other email, I wonder if a 
general solution isn't to add an IReportTotalRows interface to CSLA. The 
CslaDataSource could then give preference to that interface to return the total 
rows, falling back to the current behavior. In that way, any object that is a 
data source could opt to "override" the way the total row count is provided to 
CslaDataSource?</FONT></SPAN></DIV>
<DIV align=left><SPAN class=221344421-09062006><FONT face=Arial color=#0000ff size=2></FONT></SPAN>&nbsp;</DIV>
<DIV align=left><SPAN class=221344421-09062006><FONT face=Arial color=#0000ff size=2>That still doesn't address the need to have the CanPage 
property return true though. Ideally it would only return true if the object 
actually does do paging. So perhaps your IPage interface is a better idea - and 
could incorporate (or inherit from) IReportTotalRows.</FONT></SPAN></DIV>
<DIV align=left><SPAN class=221344421-09062006><FONT face=Arial color=#0000ff size=2></FONT></SPAN>&nbsp;</DIV>
<DIV align=left><SPAN class=221344421-09062006><FONT face=Arial color=#0000ff size=2>Rocky</FONT></SPAN></DIV><BR>
<BLOCKQUOTE>
  <DIV class=OutlookMessageHeader align=left>
  <HR>
  <FONT face=Tahoma size=2><B>From:</B> Ridge [mailto:cslanet@lhotka.net] 
  <BR><B>Sent:</B> Friday, June 09, 2006 4:40 PM<BR><B>To:</B> 
  rocky@lhotka.net<BR><B>Subject:</B> Re: [CSLA .NET] DB-side paging &amp; 
  sorting datasource?<BR></FONT><BR></DIV>
  <DIV></DIV>So I spent a while this morning trying this out.&nbsp; Implementing 
  the paged calls out to the DB is not the issue.&nbsp; The problem I'm running 
  into is that data source view's ExecuteSelect is calculating the total row 
  count as the number of entries in the list.&nbsp; Assuming you're populating a 
  paged list, the list size is a subset of the total row count, as such the 
  gridview isn't able to calculate the number of pages.<BR><BR><BR><BR></BLOCKQUOTE></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ridge replied on Friday, June 09, 2006</h2>To explain for folks following along, but who weren't privy to my email here's what I've done so far in my modified CSLA codebase:<br><br>public interface IPage { int TotalRowCount { get; } } }<br><br>Currently, the interface has only TotalRowCount, which would be better served as your IReportTotalRows, but after some usage I think it might be valuable to add PageIndex and PageSize to the interface and leave it as IPage, or implement those two in IPage and the TotalRowCount in IReportTotalRows...&nbsp; This note would affect the following:<br>
<br>[Serializable]<br>public abstract class ReadOnlyPagingListBase&lt;T, C&gt; : ReadOnlyListBase&lt;T, C&gt;, IPage where T : ReadOnlyPagingListBase&lt;T, C&gt; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private int totalRowCount;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int TotalRowCount {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return this.totalRowCount; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected set { this.totalRowCount = value; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br>}<br><br>The changes to CslaDataSourceView are:<br><br>public override bool CanPage { get { return true; } }&nbsp; // Rather than return false, see note below<br><br>protected override IEnumerable ExecuteSelect(DataSourceSelectArguments arguments) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SelectObjectEventArgs args = new SelectObjectEventArgs();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.dataSource.OnSelectObject(args);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object result = args.BusinessObject;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(arguments.RetrieveTotalRowCount) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int rowCount;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(result == null) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rowCount = 0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if(result is IPage) {&nbsp;&nbsp; // **** The important bit<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rowCount = ((IPage) result).TotalRowCount;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if(result is IList) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rowCount = ((IList) result).Count;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if(result is IEnumerable) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IEnumerable temp = (IEnumerable) result;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int count = 0;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach(object item in temp) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; count++;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rowCount = count;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rowCount = 1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; arguments.TotalRowCount = rowCount;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(!(result is IEnumerable)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ArrayList list = new ArrayList();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; list.Add(result);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = list;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return (IEnumerable) result;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>This seems to all work ok, but again, there may be value with the PageSize and PageIndex as mentioned before.<br><br>What I think should be done is to set up an allowpaging attribute for the data source asp tag to control CanPage on the datasource, similar to how ObjectDataSourceView works rather than hardcoding it one way or the other.&nbsp; I suspect CanSort should work in a similar fashion.&nbsp; In fact, when using ROW_NUMBER sorting and paging are somewhat tied together... :/<br><br>Currently, I'm setting up a criteria for a ReadOnlyPagingList that takes pageIndex, pageSize, and sortExpression, though this seems somewhat klunky to do per paged object...<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ridge replied on Friday, June 09, 2006</h2>To explain for folks following along, but who weren't privy to my email here's what I've done so far in my modified CSLA codebase:<br><br>public interface IPage { int TotalRowCount { get; } } }<br><br>Currently, the interface has only TotalRowCount, which would be better served as your IReportTotalRows, but after some usage I think it might be valuable to add PageIndex and PageSize to the interface and leave it as IPage, or implement those two in IPage and the TotalRowCount in IReportTotalRows...&nbsp; This note would affect the following:<br>
<br>[Serializable]<br>public abstract class ReadOnlyPagingListBase&lt;T, C&gt; : ReadOnlyListBase&lt;T, C&gt;, IPage where T : ReadOnlyPagingListBase&lt;T, C&gt; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private int totalRowCount;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int TotalRowCount {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return this.totalRowCount; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected set { this.totalRowCount = value; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br>}<br><br>The changes to CslaDataSourceView are:<br><br>public override bool CanPage { get { return true; } }&nbsp; // Rather than return false, see note below<br><br>protected override IEnumerable ExecuteSelect(DataSourceSelectArguments arguments) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SelectObjectEventArgs args = new SelectObjectEventArgs();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.dataSource.OnSelectObject(args);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object result = args.BusinessObject;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(arguments.RetrieveTotalRowCount) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int rowCount;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(result == null) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rowCount = 0;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if(result is IPage) {&nbsp;&nbsp; // **** The important bit<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rowCount = ((IPage) result).TotalRowCount;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if(result is IList) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rowCount = ((IList) result).Count;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else if(result is IEnumerable) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IEnumerable temp = (IEnumerable) result;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int count = 0;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach(object item in temp) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; count++;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rowCount = count;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rowCount = 1;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; arguments.TotalRowCount = rowCount;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(!(result is IEnumerable)) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ArrayList list = new ArrayList();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; list.Add(result);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = list;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return (IEnumerable) result;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>This seems to all work ok, but again, there may be value with the PageSize and PageIndex as mentioned before.<br><br>What I think should be done is to set up an allowpaging attribute for the data source asp tag to control CanPage on the datasource, similar to how ObjectDataSourceView works rather than hardcoding it one way or the other.&nbsp; I suspect CanSort should work in a similar fashion.&nbsp; In fact, when using ROW_NUMBER sorting and paging are somewhat tied together... :/<br><br>Currently, I'm setting up a criteria for a ReadOnlyPagingList that takes pageIndex, pageSize, and sortExpression, though this seems somewhat klunky to do per paged object...<br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
