<html><header><title>Data Binding Text Boxes</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Data Binding Text Boxes</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1386.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brownpa1 posted on Wednesday, October 04, 2006</h2><P>I have a HardwareBindingSource that I set&nbsp;all my textboxes on my form&nbsp;to under&nbsp;the&nbsp; DataBindings Text property.</P>
<P>I cannot get my text boxes on my windows form to update after I make a change in a text box and apply that change to update all the other textboxes which&nbsp; I am making changes to inside my Hardware object for example when I do an update I automatically update the LastUpdated property to the current date and the LastUpdatedUserID to the current logged on user.&nbsp; However, my form is not reflecting this change.&nbsp;</P>
<P>I am rebinding my Datasource to reflect the changes and I also added the BindingSourceRefresh Control onto my form as suggested in the Expert VB 2005 Business Objects book, however my databind is still not working.&nbsp; When I step through my Hardware object, it appears that all my changes are being made, however when my form pops back up the update does not reflect these changes.&nbsp; However, if I close my form and reopen it to that hardware object the changes are reflected.</P>
<P>Does anybody have any ideas on what I am missing here?&nbsp; Thank you in advance for your help.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Wednesday, October 04, 2006</h2>Could you show us the code to one of your properties that you are updating?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brownpa1 replied on Wednesday, October 04, 2006</h2><FONT size=2>
<P>I think I have it working, however I'm new to vb.net 2005 and csla 2.0 and not sure if this is going to cause other problems.&nbsp; I moved&nbsp;the code below that is hightlighted in yellow from under the Temp.ApplyEdit into the Finally in my try/catch after the RaiseListChangedEvents = True&nbsp; and it now seems to be rebinding my text boxes with the new data.&nbsp;&nbsp;&nbsp;Can you tell me if this is the correct way to be doing this?&nbsp;&nbsp; My user hit the Apply button on the form and the below code runs.</P>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> SaveHardware(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> blnRebind </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean</FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.Cursor = Cursors.WaitCursor<BR></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.HardwareBindingSource.RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2>False</FONT></P>
<P><FONT color=#008000 size=2>'do the save<BR></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> temp </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> COLibrary.Hardware = m_Hardware.Clone<BR>temp.ApplyEdit()</P>
<P></FONT><FONT color=#0000ff size=2>Try<BR></FONT><FONT size=2>&nbsp;&nbsp;&nbsp;m_Hardware = temp.Save<BR>&nbsp;&nbsp;&nbsp;m_Hardware.BeginEdit()<BR></FONT><FONT color=#0000ff size=2>Catch</FONT><FONT size=2> ex </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Csla.DataPortalException<BR>&nbsp;&nbsp;&nbsp;MessageBox.Show(ex.BusinessException.ToString, </FONT><FONT color=#800000 size=2>"Error saving"</FONT><FONT size=2>, _<BR>&nbsp;&nbsp;&nbsp;MessageBoxButtons.OK, MessageBoxIcon.Exclamation)<BR></FONT><FONT color=#0000ff size=2>Catch</FONT><FONT size=2> ex </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Exception<BR>&nbsp;&nbsp;&nbsp;MessageBox.Show(ex.ToString, </FONT><FONT color=#800000 size=2>"Error saving"</FONT><FONT size=2>, _<BR>&nbsp;&nbsp;&nbsp;MessageBoxButtons.OK, MessageBoxIcon.Exclamation)<BR></FONT><FONT color=#0000ff size=2>Finally</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.HardwareBindingSource.RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2>True</P></FONT><FONT size=2>
<P></FONT><FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> blnRebind </FONT></FONT><FONT color=#0000ff size=2>Then<BR></FONT><FONT color=#008000 size=2>&nbsp;&nbsp;&nbsp;'rebind the UI<BR></FONT><FONT><FONT color=#008000 size=2>&nbsp;&nbsp;&nbsp;'Me.HardwareBindingSource.DataSource = Nothing<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;Me</FONT></FONT><FONT><FONT size=2>.HardwareBindingSource.DataSource = m_Hardware<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Try</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Wednesday, October 04, 2006</h2><font size="2"></font><font size="2">
</font><p><font color="#0000ff" size="2"><font color="#000000">I think that possibly your method should look more like this.</font><br></font></p><p><font color="#0000ff" size="2">Private</font><font size="2"> </font><font color="#0000ff" size="2">Sub</font><font size="2"> SaveHardware(</font><font color="#0000ff" size="2">ByVal</font><font size="2"> blnRebind </font><font color="#0000ff" size="2">As</font><font size="2"> </font><font color="#0000ff" size="2">Boolean</font><font color="#0000ff" size="2">)<br>&nbsp;&nbsp;&nbsp; Try<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Me</font><font size="2">.Cursor = Cursors.WaitCursor<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </font><font size="2">HardwareBindingSource.EndEdit()<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; m_Hardware = m_Hardware.Clone().Save()<br></font><font><font color="#0000ff" size="2">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; If</font><font size="2"> blnRebind </font></font><font color="#0000ff" size="2">Then </font><font><font size="2">HardwareBindingSource.DataSource = m_Hardware</font></font><br><font color="#0000ff" size="2">&nbsp;&nbsp;&nbsp; Catch</font><font size="2"> ex </font><font color="#0000ff" size="2">As</font><font size="2"> Csla.DataPortalException<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; MessageBox.Show(ex.BusinessException.ToString, </font><font color="#800000" size="2">"Error saving"</font><font size="2">, MessageBoxButtons.OK, MessageBoxIcon.Exclamation)<br></font><font color="#0000ff" size="2">&nbsp;&nbsp;&nbsp; Catch</font><font size="2"> ex </font><font color="#0000ff" size="2">As</font><font size="2"> Exception<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; MessageBox.Show(ex.ToString, </font><font color="#800000" size="2">"Error saving"</font><font color="#0000ff" size="2">, MessageBoxButtons.OK, MessageBoxIcon.Exclamation)<br>&nbsp;&nbsp;&nbsp; End</font><font size="2"> </font><font color="#0000ff" size="2">Try<br>End</font><font size="2"> </font><font color="#0000ff" size="2">Sub</font></p><p><font color="#0000ff" size="2"><font color="#000000">Do you want your updated date and user updated after a property change or after a save?</font></font></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brownpa1 replied on Thursday, October 05, 2006</h2>I want the updated date and user updated after a save.&nbsp; The above code seems to works great.&nbsp; I'm still in learning mode so I'm somewhat confused on what some of this code actually does.&nbsp; Thank you for your time.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Thursday, October 05, 2006</h2><p><font color="#0000ff" size="2">Private</font><font size="2"> </font><font color="#0000ff" size="2">Sub</font><font size="2"> SaveHardware(</font><font color="#0000ff" size="2">ByVal</font><font size="2"> blnRebind </font><font color="#0000ff" size="2">As</font><font size="2"> </font><font color="#0000ff" size="2">Boolean</font><font color="#0000ff" size="2">)<br>&nbsp;&nbsp;&nbsp; Try<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Me</font><font size="2">.Cursor = Cursors.WaitCursor<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </font><font size="2">HardwareBindingSource.EndEdit()&nbsp;&nbsp;  <font color="#008000">'&nbsp; Forces binding to push any last changes into the object and accepts the changes</font><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; m_Hardware = m_Hardware.Clone().Save()&nbsp;&nbsp;  <font color="#008000">' Clones the object and attempts to save the clone overwriting the reference if successful</font><br></font><font><font color="#0000ff" size="2">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; If</font><font size="2"> blnRebind </font></font><font color="#0000ff" size="2">Then </font><font><font size="2">HardwareBindingSource.DataSource = m_Hardware&nbsp;&nbsp;  <font color="#008000">'&nbsp; Updates the data binding (probably should always be done)</font></font></font><br><font color="#0000ff" size="2">&nbsp;&nbsp;&nbsp; Catch</font><font size="2"> ex </font><font color="#0000ff" size="2">As</font><font size="2"> Csla.DataPortalException<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; MessageBox.Show(ex.BusinessException.ToString, </font><font color="#800000" size="2">"Error saving"</font><font size="2">, MessageBoxButtons.OK, MessageBoxIcon.Exclamation)<br></font><font color="#0000ff" size="2">&nbsp;&nbsp;&nbsp; Catch</font><font size="2"> ex </font><font color="#0000ff" size="2">As</font><font size="2"> Exception<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; MessageBox.Show(ex.ToString, </font><font color="#800000" size="2">"Error saving"</font><font color="#0000ff" size="2">, MessageBoxButtons.OK, MessageBoxIcon.Exclamation)<br>&nbsp;&nbsp;&nbsp; End</font><font size="2"> </font><font color="#0000ff" size="2">Try<br>End</font><font size="2"> </font><font color="#0000ff" size="2">Sub</font></p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
