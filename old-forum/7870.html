<html><header><title>How to reference the current user in the business layer</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How to reference the current user in the business layer</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7870.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>shrage posted on Sunday, October 25, 2009</h2>I'm using the asp.net membership system, and in my business objects i want to keep track which UserID has updated the data, so i have a UserID column. in asp.net i can run code like this: Membership.Getuser().providerUserkey which will return the userID, but in csla i can only get the user using ApplicationContext.User.Identity.Name which means i will have to run an extra request to the database to get the user's id from its name, how can i avoid this?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Sunday, October 25, 2009</h2>Hi, <br><br>The ApplicationContext.User.Identity.Name is usually the UserID. For a Windows authenticated user it is domain\userid. Don't get confused abot the Name property - it is actually supposed to be the UserID. <br><br>If you need to you can create your own custom principal/identity objects and add your own properties.<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>shrage replied on Sunday, October 25, 2009</h2>I have tried it out and it returns the user name not the id (which for the membership provider is a guid)</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Monday, October 26, 2009</h2><P>I have custom Principal and Identity classes and have simply added some extra fields to carry around critical data about the logged in user. So I can cast the Principal object retrieved from AppContext to my custom Principal and simply read the extra value(s).</P>
<P>Joe</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
