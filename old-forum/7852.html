<html><header><title>ErrorWarnInfoProvider or any other ways to use RuleSeverity</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ErrorWarnInfoProvider or any other ways to use RuleSeverity</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7852.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>nlz242 posted on Thursday, October 22, 2009</h2>Hi,<br /><br />Im currently trying to implement the "RuleSeverity" concept in my application. The validations are working properly and returning "Warning" for some cases. However, im having a hard time getting it to display in any convinient/pleasant way in my UI.<br /><br />My application currently uses ErrorProviders extensively and i am happy about it's behavior.<br /><br />Now, im trying to get the same behavior for "Warnings" and "Informations" but i'm not having much success.<br />I have tried playing with "ErrorWarnInfoProvider" (2 or 3 versions on the contrib and in threads), however, the way my data are bound is not what ErrorWarnInfoProvider is expecting. <br /><br />For exemple, i'm using Infragistic's ultragrid, the binding is done by setting the DataSource of the grid to a BindingSource object.<br />When ErrorWarnInfoProvider tries to build it's "control cache", it's only looking in the control's DataBindings collection and finds nothing.<br /><br />I see, however, my Warning and Info list being populated by the GetWarnInfoList() method and it has everything i'm expecting (meaning my validations are working properly and they are even "found" by ErrorWarnInfoProvider.<br /><br />After much messing around, ive decided to skip the part that searches in BindingSources and to simply look for my grid (Control is UltraGrid).<br />So now my "control cache" is filled. Good.<br />After that, "ProcessControl" looks in the "DataBindings" of my control (my UltraGrid) and finds nothing, therefor it does not call the provider's SetError.<br /><br />Wanting to get this working as well as the ErrorProvider that is included in the framework, i went ahead and launched Reflector to see what's inside ErrorProvider. I found the way the "control finding" is done to be much more complex and i haven't had time to dig in and try to figure a way to implement it myself in ErrorWarnInfoProvider.<br /><br />So right now im pretty much stuck... Either i try to copy Microsoft's code (which would be tedious and probably legally doubtful) or i find another way to display RuleSeverity...<br /><br />Surely there is a simple way to do what im trying to do, and i missed it ? I mean... having a proper ErrorProvider implementation shouldn't be that hard, im surely missing something...<br /><br />Any hints ? Tips ?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, October 22, 2009</h2><P>Sadly it really is that hard.</P>
<P>It isn't terribly hard to create an ErrorProvider replacement. But it can be very hard to alter the way datagrid controls work.</P>
<P>Windows Forms data binding comes in two flavors: simple and complex.</P>
<P>Simple binding is where a control binds a single property to the property of an object. So TextBox is an example.</P>
<P>Complex binding is where a control binds to the object as a whole. It is entirely up to the control how and what it does with the object, and usually the control's implementation is a black box. DataGrid, ListBox and other list-oriented controls work this way.</P>
<P>As you are aware, ErrorProvider only works with simple bound controls. Some datagrid controls replicate something like the ErrorProvider inside themselves - but it is really unique to each datagrid control.</P>
<P>If your datagrid control allows you to create custom column types (something that's common in WPF and Silverlight for example), then you can probably create a custom column type that displays a TextBox with an ErrorWarnInfoProvider in the cell. But I don't think most WinForms datagrid controls work that way?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Friday, October 23, 2009</h2>Hi, <br><br>The standard Microsoft DataGridView for Windows allows custom columns that are "unbound" when bound to a BindingSource - also called "Mixed Mode". This allows you to place a custom image and tooltip into a column to replicate and ErrorWarnInfoProvider.&nbsp; I know C1 FlexGrid also allows the same and presumably the Infragistics grid. <br><br>For those interested in implementing this in the standard DatagridView I would recommend reading the <a href="http://windowsclient.net/downloads/folders/applications/entry1304.aspx">DatagridView FAQ</a> and accompanied samples.<br><br>The ErrorWarnInfoProvider is only designed for "Simple Binding" and will not work with grids. <br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
