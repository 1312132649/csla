<html><header><title>Can t use GetProperty, error:  Index was outside the bounds of the array.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Can t use GetProperty, error:  Index was outside the bounds of the array.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7680.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>tutus posted on Thursday, September 24, 2009</h2><P>Hi,</P>
<P>I try to use the code bellow:</P>
<P><FONT color=#0000ff>Public Shared ReadOnly NBR_DOORSProperty As PropertyInfo(Of Integer) = RegisterProperty(GetType(Integer), New PropertyInfo(Of Integer)("NBR_DOORS", "NBR_DOORS", -1))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Public Property NBR_DOORS() As Nullable(Of Integer)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return GetProperty(NBR_DOORSProperty)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As Nullable(Of Integer))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetProperty(NBR_DOORSProperty, value, -1)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Property</FONT></P>
<P>But in runtime I get the error: Index was outside the bounds of the array. in the line of code:</P>
<P>Return GetProperty(NBR_DOORSProperty)<BR></P>
<P>Any idea pls, I m using CSLA 3.5 and VS2008</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fintanv replied on Thursday, September 24, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>tutus:</strong></div><div>
<P>Hi,</P>
<P>I try to use the code bellow:</P>
<P><FONT color=#0000ff>Public Shared ReadOnly NBR_DOORSProperty As PropertyInfo(Of Integer) = RegisterProperty(GetType(Integer), New PropertyInfo(Of Integer)("NBR_DOORS", "NBR_DOORS", -1))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Public Property NBR_DOORS() As Nullable(Of Integer)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return GetProperty(NBR_DOORSProperty)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As Nullable(Of Integer))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetProperty(NBR_DOORSProperty, value, -1)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Property</FONT></P>
<P>But in runtime I get the error: Index was outside the bounds of the array. in the line of code:</P>
<P>Return GetProperty(NBR_DOORSProperty)<BR></P>
<P>Any idea pls, I m using CSLA 3.5 and VS2008</P>
<P>&nbsp;</P>
<P></div></BLOCKQUOTE></P>
<P>&nbsp;</P>
<P>&lt;Disclaimer&gt;I am not a vb.net guru. &lt;/Disclaimer&gt;</P>
<P>However shouldn't your property declaration be something like:</P>
<P><FONT color=#0000ff>Private Shared NBR_DOORSProperty As PropertyInfo(Of Integer) = RegisterProperty(Of Integer)(GetType(<STRONG><FONT color=#000000>YOUR CLASS NAME</FONT></STRONG>), New PropertyInfo(Of Integer)("NBR_DOORS", "NBR_DOORS", -1))</FONT> <BR></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, September 24, 2009</h2>You're correct.  He's registering the property, saying it belongs to the type Int32, which clearly isn't correct.<br /><br />The normal use of RegisterProperty, you shouldn't be specifying the type argument at all... let Csla figure it out for you.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tutus replied on Friday, September 25, 2009</h2><P>'The normal use of RegisterProperty, you shouldn't be specifying the type argument at all... let Csla figure it out for you. "</P>
<P>&nbsp;</P>
<P>It's weird, buit it would not let me use the overload with only New PropertyInfo(0 ... It tells me there is no overload that takes only thoses arguements. it seems that the CSLA version I m using (3.5) expects too arguements at least for the method: RegisterProperty&nbsp; . I m not sure what I m doing wrong :(</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, September 25, 2009</h2>Are you inheriting Csla.BusinessBase[T]?  Might be worthwhile to upgrade to 3.7.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tutus replied on Friday, October 02, 2009</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>Are you inheriting Csla.BusinessBase[T]? Might be worthwhile to upgrade to 3.7.</div></BLOCKQUOTE></P>
<P>I appologize for the delay. I inherit from BusinessBase. We are using 3.5.0.0 version of CSLA. I don t think it s an option to upgrade the dll at this stage of the project just for this bug. We re pretty much in deployement phase, and this is a huge project :)</P>
<P>Thanks a lot for any clues about my issue :)</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, October 02, 2009</h2>Well, there are two classes called BusinessBase, one is generic one is not.  They are:<br /><br />Csla.BusinessBase( Of T ) and<br />Csla.Core.BusinessBase<br /><br />So my earlier question was are you inheriting from the first one?  It doesn't sound like you are, because that's the one that has all the overloads of RegisterProperty which don't need a type parameter.  So if you're not, you should be in 99% of all cases.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
