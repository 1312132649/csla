<html><header><title>Editable DataGridView behaviour</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Editable DataGridView behaviour</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7388.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael posted on Sunday, August 02, 2009</h2><font size="2" face="Arial">Hi everyone<br><br>I have a BLB of BB's. The BB's simply have an Id and a required Name property. I want to add and edit the BB's in a grid, so I create a BindingSource, set AllowNew = true, create a grid, and set EnableAdding = true and EnableEditing = true. The grid now shows an asterisk on the new row. The screen's Apply button is enabled only when the BLB IsValid and IsDirty.<br><br>This arrangement allows easy adding (type type type, Enter, type type, Enter etc). The thing is, when the last value is typed, and Enter is hit, the new row is highlighted which adds a new row to the collection, and because it does not have a Name value, the collection is not valid and not saveable, and the Apply button is grayed out. I have found this confuses my clients, as they can't work out how to Save, especially when there is no default value for Name. It's not obvious that you have to select a different row to discard the new row, and make the BLB valid again. I have experimented with a default value, and found it even more confusing. When the new row is highlighted there's no error icon to show that Name is required. But, calling bindingSource.AddNew() does show the error icon straight away.<br><br>Using a default value for Name will make the collection valid, but what makes it confusing is that even though the collection count goes up with the new row selected, it is not saved unless it has been edited.<br><br>Has anyone else tried this? I'm just looking for something that is intuitive to use, without any quirky behaviour.<br><br>Regards<br>Michael</font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Monday, August 03, 2009</h2>Hi Michael,<br><br>I never  use the DataGridViews add new or delete functions. Instead I use the BindingSourceNavigator to allow users to Add/Delete rows explicitly in the BindingSource. <br><br>To me -&nbsp; that is more intuitive for the user for just the same reasons as you have experienced. <br><br>/jonnybee<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tiago replied on Monday, August 03, 2009</h2><P>This is a problem but it can be solved. Have a look at the sample <A href="http://www.codeproject.com/KB/cs/CslaERLB1.aspx">http://www.codeproject.com/KB/cs/CslaERLB1.aspx</A></P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
