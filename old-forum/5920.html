<html><header><title>Not Calling Rules On Save</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Not Calling Rules On Save</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5920.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>BuckeyeJeff posted on Tuesday, December 02, 2008</h2><P>I am using CSLA, latest version.&nbsp; I have created some basic business rules and I am trying to update the object with changes in UI and then set values to object and then call save.&nbsp; I would think on the save, rules would be checked and an exception would be thrown. I am having to call &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ValidationRules.CheckRules(); on _Update to get rules to run.</P>
<P>Current way I am having to do it:</P>
<P>obj = BLL.GLEventInfo.GetGLEvent(Me.GLEventList.SelectedEvent.GLEventID)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Csla.Data.DataMapper.Map(Me.GLEventList.SelectedEvent, obj, New String() {"IsEstimatedYesNo"})<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.PopulateBOFromControls(obj)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; obj.Save()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If obj.BrokenRulesCollection.Count &gt; 0 Then</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<BR></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Tuesday, December 02, 2008</h2><P>It's largely&nbsp;up to you how you want to implement this. </P>
<P>A common pattern is to call ValidationRules.CheckRules() when the object is *created*, and so the process of setting properties can fix any broken rules if the proper values are supplied. This&nbsp;should avoid the need to call CheckRules() again when the object is saved.</P>
<P>It's also possible to associate rules with a "pseudo" property (e.g.&nbsp;CSLA doesn't care if the&nbsp;property name associated with a rule is actually a real property or not)&nbsp;to&nbsp;defer processing of those rules until save time. Then you can&nbsp;call ValidationRules.CheckRules("pseudopropertyname") in your Save method to fire only these special server side rules. </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MarkD replied on Friday, February 27, 2009</h2>I do call CheckRules on DP_Create, but is it acceptable to call it on DP_Fetch for when an existing system has new rules added after records have already been saved.<br><br>It does seem unnecessary to call CheckRules on fetch 99% of the time, but what are your thoughts on how to implement new rules on a system?<br><br>Thanks,<br>MarkD<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, February 27, 2009</h2>Yes, this is a valid thing to do whenever you can't be sure data in the database meets the current rules.&nbsp; I wouldn't worry about the call; if it's possible rules won't be met on an object because they are new, you really don't have any other option.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
