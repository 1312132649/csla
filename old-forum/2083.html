<html><header><title>CSLA-beginner DataBinding, EditCancel, DataGridView trouble. </title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA-beginner DataBinding, EditCancel, DataGridView trouble. </h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2083.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>zap posted on Friday, January 05, 2007</h2>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;  <br>&nbsp;&nbsp; &nbsp;Please Help, somebody!<br>&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;Preq:<br>&nbsp;&nbsp; &nbsp;CSLA 2.1.1<br>&nbsp;&nbsp; &nbsp;WinForm<br>&nbsp;&nbsp; &nbsp;Simple Parent Child (Order, OrderLines)<br>&nbsp;&nbsp; &nbsp;OrderLines in DataGridView<br>&nbsp;&nbsp; &nbsp;AllowAdd = true<br>&nbsp;&nbsp; &nbsp;Using only DataBinding Undo (I don't impl Order.BeginEdit();)<br>&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;ProblemScenario:<br>&nbsp;&nbsp; &nbsp;Adding frist row in grid (cre OrderLindes wh default values)<br>&nbsp;&nbsp; &nbsp;Pressing ESC. Intending to remove the row.<br>&nbsp;&nbsp; &nbsp;BusinessListBase.InsertItem is throwing an Error. Se ERROR below<br>&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;NoProblemScenarion:<br>&nbsp;&nbsp; &nbsp;Adding first row completly<br>&nbsp;&nbsp; &nbsp;Adding second row<br>&nbsp;&nbsp; &nbsp;Pressing ESC. Intending to remove the second row.<br>&nbsp;&nbsp; &nbsp;The Row is removed as expected.<br>&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;ERROR:<br>&nbsp;&nbsp; &nbsp;When I Debug the code the dataBinding infrastructure try to create two new<br>&nbsp;&nbsp; &nbsp;OrderLine objects<br>&nbsp;&nbsp; &nbsp;And when the second is created the BusinessListBase.InsertItem throwing this error.<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;BusinessListBase:<br>&nbsp;&nbsp; &nbsp;protected override void InsertItem(int index, C item)<br>&nbsp;&nbsp; &nbsp;{<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;// when an object is inserted we assume it is<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;// a new object and so the edit level when it was<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;// added must be set<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;item.EditLevelAdded = _editLevel;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;item.SetParent(this);<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;base.InsertItem(index, item); &lt;-- Err is thrown<br>&nbsp;&nbsp; &nbsp;}<br>&nbsp;&nbsp; &nbsp;<br>&nbsp;&nbsp; &nbsp;StackTrace:<br>&nbsp;&nbsp; &nbsp;System.InvalidOperationException was unhandled<br>&nbsp; Message="Operation is not valid due to the current state of the object."<br>&nbsp; Source="System.Windows.Forms"<br>&nbsp; StackTrace:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.DataGridView.DataGridViewDataConnection.ProcessListChanged(ListChangedEventArgs e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.DataGridView.DataGridViewDataConnection.currencyManager_ListChanged(Object sender, ListChangedEventArgs e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.CurrencyManager.OnListChanged(ListChangedEventArgs e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.CurrencyManager.List_ListChanged(Object sender, ListChangedEventArgs e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.BindingSource.OnListChanged(ListChangedEventArgs e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.BindingSource.InnerList_ListChanged(Object sender, ListChangedEventArgs e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ComponentModel.BindingList`1.OnListChanged(ListChangedEventArgs e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ComponentModel.BindingList`1.InsertItem(Int32 index, T item)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Csla.BusinessListBase`2.InsertItem(Int32 index, C item) in C:\Documents and Settings\Klas-Erik Bjuhr\Mina dokument\Visual Studio 2005\Projects\csla20cs\csla20cs\Csla\BusinessListBase.cs:line 369<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Collections.ObjectModel.Collection`1.Add(T item)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Servex.Library.ServiceOrderLines.AddNewCore() in C:\Documents and Settings\Klas-Erik Bjuhr\Mina dokument\Visual Studio 2005\Projects\CslaTestProj\Servex\Servex.Library\ServiceOrderLines.cs:line 114<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.ComponentModel.BindingList`1.System.ComponentModel.IBindingList.AddNew()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.BindingSource.AddNew()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.CurrencyManager.AddNew()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.DataGridView.DataGridViewDataConnection.AddNew()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.DataGridView.DataGridViewDataConnection.OnNewRowNeeded()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.DataGridView.OnRowEnter(DataGridViewCell&amp; dataGridViewCell, Int32 columnIndex, Int32 rowIndex, Boolean canCreateNewRow, Boolean validationFailureOccurred)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.DataGridView.SetCurrentCellAddressCore(Int32 columnIndex, Int32 rowIndex, Boolean setAnchorCellAddress, Boolean validateCurrentCell, Boolean throughMouseClick)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.DataGridView.SetAndSelectCurrentCellAddress(Int32 columnIndex, Int32 rowIndex, Boolean setAnchorCellAddress, Boolean validateCurrentCell, Boolean throughMouseClick, Boolean clearSelection, Boolean forceCurrentCellSelection)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.DataGridView.CancelEdit(Boolean endEdit)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.DataGridView.ProcessEscapeKey(Keys keyData)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.DataGridView.ProcessDataGridViewKey(KeyEventArgs e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.DataGridView.OnKeyDown(KeyEventArgs e)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.ProcessKeyEventArgs(Message&amp; m)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.DataGridView.ProcessKeyEventArgs(Message&amp; m)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.ProcessKeyMessage(Message&amp; m)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.WmKeyChar(Message&amp; m)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.WndProc(Message&amp; m)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.DataGridView.WndProc(Message&amp; m)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG&amp; msg)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(Int32 dwComponentID, Int32 reason, Int32 pvLoopData)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 reason, ApplicationContext context)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 reason, ApplicationContext context)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Windows.Forms.Application.Run(Form mainForm)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Servex.Program.Main() in C:\Documents and Settings\Klas-Erik Bjuhr\Mina dokument\Visual Studio 2005\Projects\CslaTestProj\Servex\Servex\Program.cs:line 17<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.AppDomain.nExecuteAssembly(Assembly assembly, String[] args)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ThreadHelper.ThreadStart_Context(Object state)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Threading.ThreadHelper.ThreadStart()<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>zap replied on Saturday, January 06, 2007</h2>Just discover that when I put focus on the first row, thus create it, and after that,put focus on another ctrl, the row is removed, as expected. The problem only arise when I use the ESC-button to do the same thing (on the first row).<br><br>Can't be the only one with problem like this or? <br><br>What am I doing wrong?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>zap replied on Saturday, January 06, 2007</h2>... and if I don't rise the OnUnknownPropertyChanged() <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected override void OnUnknownPropertyChanged()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //base.OnUnknownPropertyChanged();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>the Error disappear and the first row stays ( even if I press ESC) until I remove the focus.<br><br>When I use an DataTable as DataSource, the Grid behaves in the same way. So I suppose my problem has to do with the UnknownPropertyChanged event in some way..<br><br><br><br><br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, January 08, 2007</h2>What grid are you using?<br><br>Also, how are you adding rows? Are you leaving it purely to the grid?&nbsp; Are you calling Apply or Cancel edit on anything other than a BindingSource object?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>zap replied on Monday, January 08, 2007</h2>Thank's for your interest
ajj !!!!<br><br>
					What grid are you using?/ <b>MS DataGridView</b><br>...Are you leaving it purely to the grid? / <b>Yes</b><br>Are you calling Apply or Cancel edit on anything other than a BindingSource object? /<b>No</b><br><br>I have tried both to use "BindingSource" apporach and "the old" way i.e set the grid.DataSource = parentObj.childObects, with the same result.<br><br>/zap<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JZuerlein replied on Wednesday, February 28, 2007</h2><P>Zap....Did you find a solution to this problem?</P>
<P>I've got the same exact one.&nbsp; It only occurs when you try to cancel adding a new row, and it's the first one in the collection.&nbsp; When you do that, it calls AddNewCore twice.</P>
<P>Jeff</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JZuerlein replied on Wednesday, February 28, 2007</h2><P>I'm pretty sure this is a bug in the DataGridView control as referenced by....</P>
<P><A href="https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=197067">https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=197067</A></P>
<P>Has anyone found a work around to the problem?</P>
<P>Jeff</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>zap replied on Thursday, March 01, 2007</h2>Hi Jeff! I have  kind of leave this problem behind me ;)<br /><br /><br />But Yes, it looks like a bug in the DataGridView... to me to..<br /><br />I have find no real work around, but if you don't call <br />base.OnUnknownPropertyChanged()<br />the problem "dissapere".<br /><br />        protected override void OnUnknownPropertyChanged()<br />        {<br />            // Just don't call it since there is trouble with it when <br />ESC and first row<br />            // in grid.<br />            // base.OnUnknownPropertyChanged();<br /><br />        }<br /><br />I have also elaborate with things like below:<br />       <br />private void serviceOrderLinesDataGridView_KeyDown(object sender, <br />KeyEventArgs e)<br />        {<br />            //if (e.KeyCode == Keys.Escape)<br />            //{<br />            //    <br />_serviceOrder.ServiceOrderLines.CancelNew(serviceOrderLinesBindingSource.Count-1);<br />            //    e.SuppressKeyPress = true;<br />            //    e.Handled = true;<br /><br />            //}<br /><br />        }<br /><br />I can do some testing with the Infragistics grid an see how i behaves..<br /><br /><br /><br /><br /><br />JZuerlein skrev:<br />><br />> I'm pretty sure this is a bug in the DataGridView control as <br />> referenced by....<br />><br />> https://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=197067<br />><br />> Has anyone found a work around to the problem?<br />><br />> Jeff<br />><br />><br />><br />> </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>zap replied on Friday, March 02, 2007</h2>FYI <br><br>The Infragistics Grid 2006 Vol3 works as expected! <br><br>/zap<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JZuerlein replied on Thursday, March 08, 2007</h2><P>Thanks Zap.</P>
<P>I've confirmed with MS that this bug is the one I mentioned earlier.&nbsp; There is no work around, and the hotfix has not been released to the public.&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, March 09, 2007</h2>Can those experiencing this problem request the hotfix?&nbsp; If so, how?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>stephen.fung replied on Wednesday, June 27, 2007</h2>Although this thread is fairly old, I thought I would add my findings in case they help anyone later:<br><br>- Pressing escape on a new row without any edits would throw that exception<br>- On a new row, making an edit causes another "NewRow" to show up beneath, which makes IsNewRow return false, but pressing escape will still cancel the addition of this row and remove it (causing that exception if it's the first row)<br>- If it's not a new row, then pressing escape will cancel the edit in the last cell you changed.<br><br>Some approaches posted here, the one posted by Mustafa Kamil helped but didn't address the problem when the new row had been partially edited.<br>http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=301807&amp;SiteID=1<br><br>The following code (in a subclass of DataGridView) seems to fix these problems for me while preserving the Escape key's expected semantics:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected override bool ProcessCmdKey(ref Message msg, Keys keyData)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (keyData == Keys.Escape)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //See if the Escape key cancelled a "new row" (this doesn't seem to work with<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //checking IsNewRow)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //If not, then process the escape key as normal<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ICancelAddNew bl2 = DataSource as ICancelAddNew;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IBindingList bl = DataSource as IBindingList;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //If we don't have a bindable/cancellable DataSource, then just process the escape key as normal<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (bl != null &amp;&amp; bl2 != null)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Try to cancel adding the new row<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int oldCount = bl.Count;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bl2.CancelNew(CurrentCell.RowIndex);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (bl.Count != oldCount)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //If it was a new row and was cancelled, then we're done,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //bypass the bug.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //If it wasn't a new row, then process as usual.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return base.ProcessCmdKey(ref msg, keyData);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br><br>Tested on Windows Vista.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
