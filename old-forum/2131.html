<html><header><title>DataPortal_Create error</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>DataPortal_Create error</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2131.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>TerryHolland posted on Friday, January 12, 2007</h2><P>Im getting the following error when I try to create a new EditableRoot object</P>
<P>DataPortal.Create failed (System.NotSupportedException: Invalid operation - create not allowed<BR>&nbsp;&nbsp; at Csla.Core.BusinessBase.DataPortal_Create())</P>
<P>The code I have is straight from the template and all other sections seem to work.</P>
<P>When stepping through the code I put&nbsp;a break point on the line</P><FONT size=2>
<BLOCKQUOTE dir=ltr>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overloads</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> DataPortal_Create(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> objCriteria </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>)</FONT></P></BLOCKQUOTE>
<P><FONT size=2><FONT size=3>but execution never gets to here.</FONT></FONT></P>
<P><FONT size=2><FONT size=3>Im getting around at the minute by changing my New factory method to </FONT></FONT></P>
<BLOCKQUOTE dir=ltr>
<P><FONT size=2><FONT size=3>&nbsp;&nbsp; Public Shared Function NewItem() As clsItem<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not CanAddObject() Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Throw New System.Security.SecurityException("User not authorized to add a Item")<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return New clsItem</FONT></FONT></P>
<P><FONT size=2><FONT size=3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'todo: broken - awaiting support<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Return DataPortal.Create(Of clsItem)()<BR>&nbsp;&nbsp;&nbsp; End Function</FONT></FONT></P></BLOCKQUOTE>
<P dir=ltr><FONT size=2><FONT size=3>Any ideas?</FONT></P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, January 12, 2007</h2>You want <br><blockquote dir="ltr">
<p><font color="#0000ff" size="3">Protected</font><font size="3"> </font><font color="#0000ff" size="3">Over<i><b>ride</b></i>s</font><font size="3"> </font><font color="#0000ff" size="3">Sub</font><font size="3"> DataPortal_Create(</font><font color="#0000ff" size="3"></font><font size="3">)</font></p></blockquote><p><font size="2"><font size="3">Not Over<i>load</i>s.&nbsp; You also dont' want to specify any criteria, becausey ou are calling DP.C(Of T) without parameters.</font><br></font></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TerryHolland replied on Friday, January 12, 2007</h2><P>Are you sure? </P>
<P>The project tracker project has it exactly as I have imported from codesmith templates.&nbsp; And all of my DataPortal_XYZ &nbsp;functions are similarly declared</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, January 12, 2007</h2>Positive.&nbsp; I don't think the example has been updated to keep pace with changes to the most recent code.&nbsp; You're on 2.1.1 correct?&nbsp; <br><br>Because you're calling DP.C without parameters, the default DP_C method (with no parameters) is being called, and its default implementation is to throw the exception you're seeing.&nbsp; Check out Csla.Core.BusinessBase, and you'll find a Protected Overridable DataPortal_Create() method.<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TerryHolland replied on Friday, January 12, 2007</h2><P>I get a compile error when I replace Overloads with Overrides</P>
<P>Error&nbsp;4&nbsp;sub 'DataPortal_Create' cannot be declared 'Overrides' because it does not override a sub in a base class.&nbsp;D:\_Development\Contest\v03\Dev\Contest\Contest.Library\CSLA Root Child Test\clsItem.vb&nbsp;531&nbsp;29&nbsp;Contest.Library<BR></P>
<P>Im not sure what version Im on - how do I tell?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, January 12, 2007</h2>Did you also remove the parameter list on your method?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TerryHolland replied on Friday, January 12, 2007</h2><P>Whoops.&nbsp; Works OK now.&nbsp; So should the other DataPortal_ methods be declared overrides instead of Overloads?</P>
<P>In fact, it works fine with Overloads as long as the parameter is removed</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, January 12, 2007</h2>Hmm... that must be a VB thing.&nbsp; In C#, you'd get a compile warning because have a new member (the Overloadd one) conflicting with the inhertied member.<br><br>Fetch has been changed too; see the changelog for details.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TerryHolland replied on Friday, January 12, 2007</h2><P>OK.</P>
<P>Thanks for your help</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, January 12, 2007</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>Hmm... that must be a VB thing.&nbsp; In C#, you'd get a compile warning because have a new member (the Overloadd one) conflicting with the inhertied member.<BR><BR>Fetch has been changed too; see the changelog for details.<BR></div></BLOCKQUOTE></P>
<P>No, the warning should appear in VB too - something about the method being in conflict and behind automatically shadowed by the subclass. But it is just a warning, not an error, so if you don't have the switch set to treat warnings like errors you might not notice it right away.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TerryHolland replied on Friday, January 12, 2007</h2>My version is 2.1.0.0</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, January 12, 2007</h2>See the <a href="http://www.lhotka.net/Article.aspx?area=4&amp;id=f12cc951-0452-42d1-96a6-cfa7656863b1">changelog</a>; the changes which are causing you grief happened on 2.1.0.&nbsp; The first two items in that list are what differs from the example.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
