<html><header><title>BusinessListBase vs BusinessBindingListBase</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>BusinessListBase vs BusinessBindingListBase</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9008.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>tiago posted on Sunday, May 30, 2010</h2><p>Hi all.</p>
<p>Sharing some experiences and raisising a point.</p>
<p>As you might have noticed, under CSLA.NET 4 <strong>BusinessListBase</strong> changed - when the collection changes, instead of raising the <strong>ListChanged</strong> event as it used to, it raises the <strong>CollectionChanged</strong> event.</p>
<p>This is old news and is all on the release notes. If you want to migrate your Windows Forms projects to CSLA.NET 4 all you have to do is to use <strong>BusinessBindingListBase</strong>.</p>
<p>I have this Windows Forms project and after porting (almost) everything from CSLA.NET 3.0.5 to CSLA.NEt 4.0.0 I got very weird problems using a DataGridView, like the list pointing to the wrong item, deleted rows didn&#39;t go away, etc. That was weird because there were a lot of errors and not that easy to reproduce.</p>
<p>I went to my library classes and just replaced <strong>BusinessListBase</strong> with <strong>BusinessBindingListBase</strong>&nbsp;and Bingo! All of a sudden the project was all right!.</p>
<p>Besides sharing the experience, I think&nbsp;this also&nbsp;raises a point. If we must use&nbsp;<strong>BusinessBindingListBase</strong>&nbsp;for Windows Forms and&nbsp;<strong>BusinessListBase</strong>&nbsp;for WPF/Silverlight, suppose my application has both clients. I need to have duplicated Business*ListBase classes?</p>
<p>Not to mention the WPF/Silverlight issue. I can see that the sample projects (PTracker) use conditional compiler directives&nbsp;to keep different implementations on the same source.</p>
<p>Of course we can use the same trick for the WindowsForms / WPF issue:<span style="font-size:x-small;color:#0000ff;font-family:Consolas;"> </span></p>
<p><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">#if WPF<br /></span></span><span style="font-size:x-small;color:#808080;font-family:Consolas;"><span style="font-size:x-small;color:#808080;font-family:Consolas;"><span style="font-size:x-small;color:#808080;font-family:Consolas;">&nbsp;&nbsp;&nbsp; public partial class Folders : BusinessListBase&lt;Folders, Folder&gt;<br /></span></span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">#else<br /></span></span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">&nbsp;&nbsp;&nbsp; public</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> </span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">partial</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> </span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">class</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> </span></span><span style="font-size:x-small;color:#00008b;font-family:Consolas;"><span style="font-size:x-small;color:#00008b;font-family:Consolas;"><span style="font-size:x-small;color:#00008b;font-family:Consolas;">Folders</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> : </span></span><span style="font-size:x-small;color:#00008b;font-family:Consolas;"><span style="font-size:x-small;color:#00008b;font-family:Consolas;"><span style="font-size:x-small;color:#00008b;font-family:Consolas;">BusinessBindingListBase</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">&lt;</span></span><span style="font-size:x-small;color:#00008b;font-family:Consolas;"><span style="font-size:x-small;color:#00008b;font-family:Consolas;"><span style="font-size:x-small;color:#00008b;font-family:Consolas;">Folders</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">, </span></span><span style="font-size:x-small;color:#00008b;font-family:Consolas;"><span style="font-size:x-small;color:#00008b;font-family:Consolas;"><span style="font-size:x-small;color:#00008b;font-family:Consolas;">Folder</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">&gt;<br /></span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">#endif</span></span></span></p>
<p>We can have conditional compiler directives for 3 UI environments and I&#39;m afraid that soon enough programs risk to get unreadable. One has to find its way&nbsp;through the conditional compiler directives&nbsp;instead of browsing code. I mean&nbsp;we will be debuging conditional compiler directives instead of debuging code.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Sunday, May 30, 2010</h2><p><div style='padding-left: 50px;background-color:silver'><b>tiago<br></b></p>
<p>Besides sharing the experience, I think&nbsp;this also&nbsp;raises a point. If we must use&nbsp;<b>BusinessBindingListBase</b>&nbsp;for Windows Forms and&nbsp;<b>BusinessListBase</b>&nbsp;for WPF/Silverlight, suppose my application has both clients. I need to have duplicated Business*ListBase classes?</p>
<p>Not to mention the WPF/Silverlight issue. I can see that the sample projects (PTracker) use conditional compiler directives&nbsp;to keep different implementations on the same source.</p>
<p></div></p>
<p>Several months ago, perhaps even a year ago, I started a thread to discuss what CSLA 4 should do about the Windows Forms vs WPF/SL app problem. There is no good answer. None.</p>
<p>My first instinct was to drop Windows Forms entirely. That was rejected (with good reasons) by many people on the forum. The approach taken by CSLA 4 is (imo) the only meaningful alternative - provide a set of collection types for Windows Forms, and update the primary collection types to work with everything else.</p>
<p>I have absolutely no idea how to make one list work for both Windows Forms and XAML. I do not believe it is possible, not in any realistic sense.</p>
<p>When it comes to ProjectTracker - that is VERY far from being complete for CSLA 4. I have just started the process of making it work for Silverlight, which is where the compiler directives come in. That&#39;s pretty typical for any SL app - your objects will have some minor differences between SL and .NET that must be addressed. We&#39;ve worked very hard to minimize those differences, but some things just can&#39;t be hidden (you can&#39;t have data access or synchronous factory code in your SL code - that just isn&#39;t possible).</p>
<p>ProjectTracker does work for ASP.NET MVC, as that&#39;s been my focus with that particular project so far. That&#39;s not done either, but the functionality that is there does work. Next I&#39;ll be working on the Silverlight client, then WPF. The Windows Forms client will probably go away in ProjectTracker - or will move to a completely separate version of the sample - specifically because the collection types can&#39;t be shared between Windows Forms and the rest of the UI technologies...</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>frankhoffy replied on Thursday, February 17, 2011</h2><p>I must say, this makes me pretty nervous about upgrading. &nbsp;We&#39;re in CSLA 3.8.3 and have libraries that are used across WPF, Windows Forms, and the Web. &nbsp;BusinessListBase is used everywhere.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, February 17, 2011</h2><p>If your objects are working now, then just switch your base classes to the &quot;BindingListBase&quot; versions and you&#39;ll get the same behavior as 3.8. Literally, because those are the original types from 3.8, just renamed :)</p>
<p>Nothing forces you to use the &quot;ListBase&quot; versions. I just view them as the default from CSLA 4 and higer, because I suspect people will migrate away from Windows Forms and onto the modern UI technologies as time goes on.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tiago replied on Thursday, February 17, 2011</h2><p><div style='padding-left: 50px;background-color:silver'><b>RockfordLhotka<br></b> (...) I suspect people will migrate away from Windows Forms and onto the modern UI technologies as time goes on.</div></p>
<p>You&#39;re right. WPF is so much easier than windows forms...</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>frankhoffy replied on Thursday, February 17, 2011</h2><p>Thanks for the reply Rocky. &nbsp;I see it now in the release notes. &nbsp;I&#39;m going to push for a CSLA 4.x upgrade for us this year.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Miroslav Galajda replied on Thursday, May 19, 2011</h2><p>I&#39;m starting with CSLA 4.1 and I am very sad that I must first make a decision for what UI will be the business object used.<br /><br />Rocky, you didn&#39;t asnwer what to do in a such situations when one wants to use business object both in Windows Forms and WPF.<br /><br />This is insane that when designing business object I need to take in the consideration in what UI it will be used.<br /><br />What do you propose?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, May 19, 2011</h2><p>If you need to support WinForms, you&#39;re stuck with BindingListBase subclasses.&nbsp; Things should mostly work in Wpf.&nbsp; Keep in mind, this isn&#39;t Rocky&#39;s doing; MS invented ObservableCollection for Wpf, and then didn&#39;t make Wpf fully&nbsp;honor BindingList, nor WinForms work at all with OC.</p>
<p>Personally, I wouldn&#39;t support two different rich client UI technologies; make your app in one or the other and code your BOs accordingly.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, May 19, 2011</h2><p><div style='padding-left: 50px;background-color:silver'><b>Miroslav Galajda<br></b>
<p>I&#39;m starting with CSLA 4.1 and I am very sad that I must first make a decision for what UI will be the business object used.</p>
<div style="CLEAR:both;"></div>
</div></p>
<p>I am sad too. As I&#39;ve said numerous times, Microsoft really created a no-win situation for anyone trying to migrate from Windows Forms to WPF, and that&#39;s very unfortunate.</p>
<p>Andy is correct, the ideal solution is to not support both at once. Of course that&#39;s not realistic if you have an existing CSLA .NET Windows Forms app and need to migrate to WPF over time. In that case you are really left with migrating groups of related functionality as a unit, so you can convert the business objects from BBLB to BLB as you recreate the UI in WPF.</p>
<p>On the other hand, the problem is (almost) entirely restricted to Windows Forms. The CSLA 4 BLB and ROLB types work fine in all other technologies other than Windows Forms. Given the efffective legacy status of Windows Forms, the issue really only impacts people who do need to migrate existing CSLA .NET Windows Forms apps forward.</p>
<p>The one exception I&#39;m aware of, is that some third party WPF datagrid controls apparently don&#39;t work correctly with ObservableCollection types, and therefore also require the use of BBLB and ROBLB. My recommendation is to either contact that vendor to see if they do also support ObservableCollection, or choose another third party component vendor that does support ObservableCollection in WPF.</p>
<p>Are any of these solutions ideal? No. Is there an easy answer? No (barring Microsoft fixing the mess they made - and that&#39;s unlikely at this point).</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Miroslav Galajda replied on Friday, May 20, 2011</h2><p>Thank you for your explanation.<br /><br />In 3.8.4 there was one type of collection to support all UI technologies. And it worked, right? What has changed that you made two separate collections in 4.x versions? It was change in .NET 4.0 version or what?<br /><br />I need to make serious decision and I&#39;m looking what will not work if I use the latest 3.8.x version instead of 4.x for both WinForms and WPF and the others.<br /><br />That was the strongest point of CSLA that one can create only one business layer on top of CSLA and this business layer can be used in all of UI worlds.<br /><br />Thank you.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Friday, May 20, 2011</h2><p>The 3.8.4 BusinessListBase and 4.x BusinessBindingListBase is essentially the same classes (just renamed in 4.x).</p>
<p>The problem here is (as described by previous posters) that WPF collection databinding does not fully support IBindingList. WPF prefers IObservableCollection and it is not possible to create one&nbsp; list class that implements both interfaces. </p>
<p>This has nothing to with .NET4 - the same problem goes for .NET 3.5. </p>
<p>CSLA tried to keep the IBindingList based classes but too many issues with databinding, grids, sorting and more forced the move to 2 separate list classes.</p>
<p>So - the &quot;new&quot; 4.x BusinessListBase /ReadOnlyListBase is the recommended approach for all UI technologies except for WindowsForms that requires BusinessBindingListBase / ReadOnlyBindingListBase. </p>
<p>But yes, if you need the same BO assembly to be used for both WindowsForms and WPF then using the old classes will work but you will run into issues in the WPF client that simply does not work as expected and must make workaround and manually code your fix.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Miroslav Galajda replied on Friday, May 20, 2011</h2><p>Are those issues somewhere documented?<br />You should understand my concerns.<br />This should be standard approach. If someone has made an effort to overcome those issues it would be very useful to list them and make other one to consider them.<br /><br />This is crucial for everyone who is migrating form 3.8.x version to 4.x version and even more for those who still maintain development on windows forms but are planning to support at the same time one of the other UI platforms.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Friday, May 20, 2011</h2><p>I am not ware of anyone that has documented all those issues. <b>If anyone has then please let us know! </b></p>
<p>Remember - these issues are not likely to be CSLA specific. </p>
<p>They are mainly caused by WPF introducing new collection classes and partial support for IBindingList list classes used in Windows Forms. </p>
<p>And another bulk of issues comes from third party grid controls in how good they support both interfaces.</p>
<p>I know sorting and filtering has been asked multiple times when using IBindingList classes in WPF with the MS DataGridView.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, May 20, 2011</h2><p><div style='padding-left: 50px;background-color:silver'><b>Miroslav Galajda<br></b>
<p>In 3.8.4 there was one type of collection to support all UI technologies. And it worked, right? What has changed that you made two separate collections in 4.x versions? It was change in .NET 4.0 version or what?<br /><br /></div></p>
<p>That statement is not correct.</p>
<p>In 3.x there was one type of collection, and it worked well with everything <em>except WPF</em>. CSLA 3.x collections only partially worked with WPF, because WPF only partially supports IBindingList (BindingList&lt;T&gt;).</p>
<p>I spent years <em>not fully supporting WPF</em>, because it wasn&#39;t used widely enough (in my observation) to make it worth the pain.</p>
<p>Starting with Visual Studio 2010 there&#39;s a working deisgner for WPF, and Magenic started to see a major increase in the use of WPF. I thought it was time to accept the pain, and provide a collection type that supports WPF.</p>
<p>Because a collection that works with WPF also works with everything <em>except Windows Forms</em>, and because I view WinForms as legacy technology, I made the &quot;default&quot; BusinessListBase and ReadOnlyListBase support WPF. I just renamed the old classes to BusinessBindingListBase and ReadOnlyBindingListBase and kept them for support of Windows Forms apps.</p>
</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Miroslav Galajda replied on Friday, May 20, 2011</h2><p>Two questions:</p>
<p>1) What UIs are fully compatible with &quot;BindingList&quot; collections? If I use BusinessBindingListBase in what UIs will it fully work? As you said it will not fully work with WPF (probable Silverligth is the same). I&#39;m not sure but I&#39;ve read somewhere that ASP.NET should be OK, isn&#39;t it?</p>
<p>2) What do you propose to do, if I want to use CSLA for WinForms in WPF (maybe Silverlight) and also in ASP.NET (for sure). How should I design my business objects? I know it&#39;s probably hard question, but you should have the best experience to answer this.</p>
<p>Thank you.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Friday, May 20, 2011</h2><p>This is covered quite thoroughly in the <em>Using CSLA 4: Creating Business Objects</em> ebook starting on page 78. </p>
<p>For example, Table 16 lists every interface technology, and the base collection types (ObservableCollection or BindingList) that work with that interface technology.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Miroslav Galajda replied on Tuesday, May 24, 2011</h2><p>Hi, after reading that chapter, I don&#39;t know if I&#39;m smart enough.<br /><br />After all, it seems to me that the only way to go is to use conditionals, similar to what you have used for SILVERLIGHT, e.g.<br /><br />#if WINFORMS<br /><br />// use BusinessBindingListBase<br /><br />#else<br /><br />// for everything other than windows forms use BusinessListBase<br /><br />#endif<br /><br />And to have two build versions of the same business classes (when targeting WinForms and the others). <br />But if I see how targeting the silverlight version is recommeded it seems that for the silverlight (or WP7) I must have another build.<br />But here I&#39;m in doubts. To have same name for assemblies and organize them in subfolders or to distinguish them by name and keep in the one folder for all dependencies?<br /><br />I haven&#39;t read the whole ebook series yet. But I want to quickly ask what should I do at first? Do you recommend to create own CSLA derivate for base classes, which will be directly used in my business layers? <br />But things get little bit complicated. That derivate should have the same number of CSLA derivate builds as the original one, shouldn&#39;t it? And finally my business layers should have also have also so many builds as needed by the target UI platforms.<br /><br />Please, I need clarification.<br />Thanks</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, May 25, 2011</h2><p>That is an interesting and unusual perspective.</p>
<p>I have been posting in this thread under the assumption that you have existing WinForms code, and need to migrate to WPF over time. That is the common scenario. Although a little challenging, by supporting OC and BL collections, CSLA 4 makes it possible to do this migration.</p>
<p>It sounds like you are intentionally going to write a new WinForms app? And a WPF app over the same business layer?</p>
<p>Why would you ever do such a thing? It is hard to imagine how you could cost-justify creating two apps that both target Windows and (presumably) provide the same functionality?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Miroslav Galajda replied on Wednesday, May 25, 2011</h2><p>No, you didn&#39;t understand me well.</p>
<p>I&#39;m going to build new business layer which must be used in an existing WinForms application, because this is what we have and we can provide almost instantly to customer.</p>
<p>But in parallel with legacy WinForm application we want to build new applications based on WPF/Silverlight or ASP.NET or combination ASP.NET with Silverlight.</p>
<p>And somewhere in the future to be cut off from the WinForms UI.</p>
<p>I&#39;m just thinking about the way how to do the both and not to fight with technologies.</p>
<p>That&#39;s why I&#39;m asking in such way.</p>
<p>Thanks</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Wednesday, May 25, 2011</h2><p>Thank you for the clarification.</p>
<p>In that case, where the business layer will be used by WinForms or WPF, but never at the same time (by a hybrid app), I think your idea of using a compiler directive is probably good.</p>
<p>As much as possible, we made BusinessListBase code-compatible with the&nbsp;old version (now called BusinessBindingListBase). For example, BLB supports the AddNewCore overload concepts from BindingList, even though that has no meaning in the OC world. Because other parts of CSLA use it, there&#39;s still value in implementing it - but more importantly, we enabled the same code to work, with just the base type being changed.</p>
<p>That isn&#39;t always the case. For example, if you manually raise changed events, BLB uses OnCollectionChanged and BBLB uses OnListChanged - and there&#39;s not a lot we can do about that, because the events aren&#39;t the same.</p>
<p>But most business code doesn&#39;t do fancy stuff, and so most business collection classes can switch between the BLB and BBLB base classes with very little code difference. That means the compiler directive approach should be fine.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Miroslav Galajda replied on Thursday, May 26, 2011</h2><p>Hi, I&#39;ve just tested if I could bind BusinessListBase to WinForms DataGridView and some other 3rd party GridControl.</p>
<p>At first sight binding just works. Also I can wrap it with SortedBindingList to provide sorting in grid.</p>
<p>Also I&#39;ve tried BusinessBindingListBase, and found no different behavior between the two lists.</p>
<p>I&#39;m using CSLA 4.1.</p>
<p>Another interesting point is that ReadOnlyListBase is able to accept adding items into it without clearing IsReadOnly flag but ReadOnlyBindingListBase doesn&#39;t.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, May 26, 2011</h2><p><div style='padding-left: 50px;background-color:silver'><b>Miroslav Galajda<br></b>
<p>Another interesting point is that ReadOnlyListBase is able to accept adding items into it without clearing IsReadOnly flag but ReadOnlyBindingListBase doesn&#39;t.</p>
<p>&nbsp;</div></p>
<p>This is a perfect example that demonstrates how several features of BindingList don&#39;t exist in ObservableCollection. The whole concept of allowing edit/remove/add to a list is a BindingList feature. Because OC doesn&#39;t implement this feature, WinForms treats the collection as though all the options are true - except for add.</p>
<p>In the case of add, BindingList has AddNew and OC does not. So auto-adding of an item in an OC requires that the child type have a public default constructor, and you can&#39;t override the use of that constructor (no use of data portal Create to initialize the child).</p>
</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Miroslav Galajda replied on Thursday, May 26, 2011</h2><p>This is what I&#39;m looking for. What all features will not work if I bind BLB to WinForm or what features do I need to add manually.</p>
<p>Because the first try I made is just working fine.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, May 26, 2011</h2><p>I have not worked with WinForms for several years, and I don&#39;t remember the full list of missing features. You will have to experiment to see what doesn&#39;t work.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, May 26, 2011</h2><p>I would expect a number of issues lurking in the shadows. </p>
<p>SortedBindingList and FilteredBindingList support adding/deleting/editing rows in the underlying list. I would expect these to fail at updating the UI or&nbsp; DatagridViews properly as the event they attach to is the ListChangedEvent from BindingList. </p>
<p>Ex: </p>
<p>&nbsp;&nbsp;&nbsp; public FilteredBindingList(IList&lt;T&gt; list)<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _list = list;<br /><b><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_list is IBindingList)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _supportsBinding = true;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _bindingList = (IBindingList)_list;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _bindingList.ListChanged += <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new ListChangedEventHandler(SourceChanged);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</b><br />&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; public SortedBindingList(IList&lt;T&gt; list)<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _list = list;<br /><br /><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_list is IBindingList)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _supportsBinding = true;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _bindingList = (IBindingList)_list;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _bindingList.ListChanged +=<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new ListChangedEventHandler(SourceChanged);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</b><br />&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, May 26, 2011</h2><p>Starting in .NET 2.0, Microsoft worked to make some common scenarios work against non-BindingList collections. You might be able to search MSDN or blogs to find some article that describes what they did to support collections that don&#39;t actively participate in binding.</p>
<p>Probably searching for &quot;binding a collection to windows forms&quot; will return some useful results.</p>
<p>Think about it this way: Windows Forms is designed to work with BindingList collections. They did what they could to support &quot;dumber&quot; collection types. ObservableCollection is a &quot;dumber&quot; collection type (from a Windows Forms perspective), so any limits discussed in blogs and articles from 2005 apply today as well.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Miroslav Galajda replied on Thursday, May 26, 2011</h2><p>OK, thank you. I will try to fight against them. :-)</p>
<p>One thing I&#39;m scared about is too complicated model of multiple builds of libraries.</p>
<p>Do you recommend to create own layer (derived CSLA base classes) bon top of CSLA and use that layer as base &quot;CSLA&quot; layer, don&#39;t you?</p>
<p>This will result into following model of libraries, won&#39;t it?</p>
<p>Client\CSLADerived.dll</p>
<p>Silverlight\CSLADerived.dll</p>
<p>Server\CSLADerived.dll</p>
<p>...?</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, May 27, 2011</h2><p><div style='padding-left: 50px;background-color:silver'><b>Tiago Freitas Leal<br></b>
<p>Besides sharing the experience, I think&nbsp;this also&nbsp;raises a point. If we must use&nbsp;<strong>BusinessBindingListBase</strong>&nbsp;for Windows Forms and&nbsp;<strong>BusinessListBase</strong>&nbsp;for WPF/Silverlight, suppose my application has both clients. I need to have duplicated Business*ListBase classes?</p>
<div style="CLEAR:both;"></div>
</div></p>
<p>Yes, if you have one business DLL that is used by Windows Forms and WPF UI elements in the same app, then you probably have to create duplicated collection classes.</p>
<p>In my observation, this normally happens when an org has a Windows Forms app, and they migrate to WPF over a period of months or years. So the same app is running some WinForms and some WPF, often using Microsoft&#39;s interop capabilities.</p>
<p>My recommendation is to port logical units of functionality from WinForms to WPF, one unit at a time. This way you can port a number of forms to WPF, and can port the related business types as well.</p>
<p>This won&#39;t eliminate the need for some duplicate collection types, but it can help reduce the number of duplicates.</p>
<p>The real key is to minimize the number of duplicated <em>editable list types</em>. Read-only lists that subclass ReadOnlyListBase usually work fine in WinForms, because none of the &quot;missing&quot; features are used against a read-only list. Only editable lists are problematic.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
