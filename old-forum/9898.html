<html><header><title>Child NVL combobox control not generated from DataSources in VS2010</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Child NVL combobox control not generated from DataSources in VS2010</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9898.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Mr X posted on Thursday, December 23, 2010</h2><p>Hi all,</p>
<p>I am experiencing behaviours which I hope you will be able to explain to me. This should be very simple but I can&#39;t get it to work properly.&nbsp; What am I missing? I am using VS2010, CLSA 4.0.1, Silverlight 4 and bxf.&nbsp; </p>
<p>I created a root user object which contains a child NameValueList property.&nbsp; </p>
<p>&nbsp;</p>
<p>private static PropertyInfo&lt;NVLSecurityProfile&gt; RoleListProperty = RegisterProperty&lt;NVLSecurityProfile&gt;(c =&gt; c.RoleList);</p>
<p><br />public NVLSecurityProfile RoleList</p>
<p>{<br />get { return GetProperty(RoleListProperty); }<br />private set { LoadProperty(RoleListProperty, value); }</p>
<p>&nbsp;}</p>
<p>&nbsp;This property is loaded on the Fetch method of the root user object.&nbsp; This was implemented based on the UoW examples from the CSLA 3.8 core video series.</p>
<p>//Load NVL</p>
<p>LoadProperty(RoleListProperty, Business.NVLSecurityProfile.GetNVLSecurityProfile(criteria.Language));</p>
<p>&nbsp;</p>
<p>So far so good.&nbsp; I put break points and I know the list is loaded with values. At this point, my objects are working fine (I think).&nbsp; Then, I created a ViewModel class for my root object (user).</p>
<p>&nbsp;</p>
<p>namespace ViewModels</p>
<p>{</p>
<p>public class UserViewModel : ViewModel&lt;Business.EditUser&gt;</p>
<p>{</p>
<p>#region &quot;Constructors&quot;</p>
<p><br />public UserViewModel()<br />{<br />Shell.Instance.ShowStatus(new Status { Text = &quot;Creating User&quot;, IsBusy = true });<br />BeginRefresh(&quot;NewEditUser&quot;, App.Language);</p>
<p>}</p>
<p>#endregion</p>
<p><br />&nbsp;(omitted to post the standard Verb and Event Handlers sections)</p>
<p>&nbsp;Again, so far so good.&nbsp; I then went ahead through VS2010 and added a new Object Datasource from my view models.&nbsp; So I ended up with a object structure that looks like this. (See attachment)</p>
<p><a href="http://forums.lhotka.net/cfs-file.ashx/__key/CommunityServer.Components.UserFiles/00.00.00.65.48/untitled.JPG"><img border="0" src="http://forums.lhotka.net/resized-image.ashx/__size/550x0/__key/CommunityServer.Components.UserFiles/00.00.00.65.48/untitled.JPG" alt="" /></a></p>
<p>&nbsp;I obtain the complete object graph:&nbsp; ViewModel Properties, the Model and its properties (including the child RoleList NVL).&nbsp; When I drag the Model on the view, two things happen (or I better say do NOT happen):</p>
<p>1 . The control for the Rolelist is not added to the view when dragging and dropping the Model from the Data Sources pane.&nbsp; Only the controls for the properties such as UserName, LastUpdated... are automatically generated on the view.</p>
<p>2. I expected the VS2010 to automatically create 2 CollectionViewSources: One for the ViewModel and one for the Model (referencing the ViewModelviewSource) .&nbsp; I only obtain the CollectionViewSource for the ViewModel.</p>
<p>&nbsp;<span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><font size="2" color="#0000ff" face="Consolas"><font size="2" color="#0000ff" face="Consolas"><font size="2" color="#0000ff" face="Consolas">
<p>&lt;</p>
</font></font></font></span><font size="2" color="#0000ff" face="Consolas"><font size="2" color="#0000ff" face="Consolas">
<p>&nbsp;</p>
</font></font></span><font size="2" color="#0000ff" face="Consolas">
<p>&nbsp;</p>
</font></span></p>
<p><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;">UserControl.Resources</span></span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">&gt;</span></span></span></p>
<p>&nbsp;<span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">&lt;</span></span></span><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;">my2</span></span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">:</span></span></span><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;">NotConverter</span></span></span><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"> x</span></span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">:</span></span></span><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;">Key</span></span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">=&quot;NotConverter&quot; /&gt;</span></span></span><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;"> <font size="2" color="#a31515" face="Consolas"><font size="2" color="#a31515" face="Consolas"><font size="2" color="#a31515" face="Consolas">
<p>
<p>&nbsp;</p>
</p>
</font></font></font></span><font size="2" color="#a31515" face="Consolas"><font size="2" color="#a31515" face="Consolas">
<p>
<p>&nbsp;</p>
</p>
</font></font></span><font size="2" color="#a31515" face="Consolas">
<p>
<p>&nbsp;</p>
</p>
</font></span></p>
<p>
<p>&nbsp;</p>
<span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">&lt;</span></span></span><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;">my3</span></span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">:</span></span></span><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;">VisibilityConverter</span></span></span><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"> x</span></span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">:</span></span></span><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;">Key</span></span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">=&quot;VisibilityConverter&quot; /&gt;</span></span></span><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;"> <font size="2" color="#a31515" face="Consolas"><font size="2" color="#a31515" face="Consolas"><font size="2" color="#a31515" face="Consolas">
<p>&nbsp;</p>
</font></font></font></span><font size="2" color="#a31515" face="Consolas"><font size="2" color="#a31515" face="Consolas">
<p>&nbsp;</p>
</font></font></span><font size="2" color="#a31515" face="Consolas">
<p>&nbsp;</p>
</font></span>
<p>&nbsp;</p>
<span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">&lt;</span></span></span><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;">CollectionViewSource</span></span></span><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"> x</span></span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">:</span></span></span><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;">Key</span></span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">=&quot;userViewModelViewSource&quot;</span></span></span><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"> d</span></span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">:</span></span></span><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;">DesignSource</span></span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">=&quot;{</span></span></span><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;">d</span></span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">:</span></span></span><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;">DesignInstance</span></span></span><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"> my</span></span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">:</span></span></span><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;">UserViewModel</span></span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">,</span></span></span><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"><span style="font-size:x-small;color:#ff0000;font-family:Consolas;"> CreateList</span></span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">=True}&quot; /&gt;</span></span></span><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;"> <font size="2" color="#a31515" face="Consolas"><font size="2" color="#a31515" face="Consolas"><font size="2" color="#a31515" face="Consolas">
<p>&nbsp;</p>
</font></font></font></span><font size="2" color="#a31515" face="Consolas"><font size="2" color="#a31515" face="Consolas">
<p>&nbsp;</p>
</font></font></span><font size="2" color="#a31515" face="Consolas">
<p>&nbsp;</p>
</font></span>
<p>&nbsp;</p>
<span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">&lt;/</span></span></span><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;"><span style="font-size:x-small;color:#a31515;font-family:Consolas;">UserControl.Resources</span></span></span><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;"><span style="font-size:x-small;color:#0000ff;font-family:Consolas;">&gt;</span></span></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>I have been trying to solve this for the last couple of days.&nbsp;I do not think this is an issue with VS2010 because this feature has been around for a while. I suspect the problem comes from&nbsp;having&nbsp;child list in my Model.&nbsp;&nbsp;Any help would be greatly appreciated.&nbsp; </p>
<p>thanks,</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Thursday, December 23, 2010</h2><p>I know there are some bugs in the VS10 WPF designer where it doesn&#39;t consistently create CVS objects or set up the correct datacontext. Hopefully these will be fixed in VS10 SP1 - the early list of SP1 fixes does list at least one dealing with the WPF designer.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Mr X replied on Thursday, December 23, 2010</h2><p>Thank you Rocky,</p>
<p>&nbsp;I was worried that my objects&nbsp;implementation was the problem. So I suppose it is only a question of setting the databinding manually on my view.&nbsp; Since I am not getting the ViewModelModelViewSource in the CollectionViewSource, do you believe I can simply write my own?&nbsp; How do people work around this issue?&nbsp; </p>
<p>Again, thanks for the extremely quick (and useful)&nbsp;reply.&nbsp; <img src="http://forums.lhotka.net/emoticons/emotion-1.gif" alt="Smile" /></p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, December 23, 2010</h2><p>Jason Zander has put together a nice overview&nbsp; of the fixes in VS2010 SP1</p>
<p><a href="http://blogs.msdn.com/b/jasonz/archive/2010/12/20/visual-studio-2010-service-pack-1-beta-feedback.aspx">http://blogs.msdn.com/b/jasonz/archive/2010/12/20/visual-studio-2010-service-pack-1-beta-feedback.aspx</a></p>
<p>Several items is related to XAML Designer.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, December 23, 2010</h2><p>Yes, you can write your own XAML - there&#39;s absolutely nothing special about the XAML created by the designer.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Mr X replied on Tuesday, January 18, 2011</h2><p>Hi Rocky,</p>
<p>Thought you might be interested in this error message for future reference.&nbsp; I have a root object that contains a child NVL.&nbsp; When I drag my datasource onto the Silverlight grid, I get an indication that my datasource is not working properly.&nbsp; I removed my NVL from the root object and was then&nbsp;able to drag and drop the root&#39;s object&nbsp;MODEL&nbsp;from my DataSource object (of course, I am also using MVVM).&nbsp; </p>
<p>Using CSLA 4.0.1, Silverlight 4, MVVM and VS2010</p>
<p>This is the error on my xaml page:</p>
<p><span style="FONT-SIZE:10pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;">&lt;</span><span style="FONT-SIZE:10pt;COLOR:#a31515;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;">CollectionViewSource</span><span style="FONT-SIZE:10pt;COLOR:red;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;"> x</span><span style="FONT-SIZE:10pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;">:</span><span style="FONT-SIZE:10pt;COLOR:red;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;">Key</span><span style="FONT-SIZE:10pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;">=&quot;EditUserViewModelViewSource&quot;</span><span style="FONT-SIZE:10pt;COLOR:red;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;"> <span style="text-decoration:underline;">d</span></span><span style="text-decoration:underline;"><span style="FONT-SIZE:10pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;">:</span></span><span style="text-decoration:underline;"><span style="FONT-SIZE:10pt;COLOR:red;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;">DesignSource</span></span><span style="text-decoration:underline;"><span style="FONT-SIZE:10pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;">=&quot;{</span></span><span style="text-decoration:underline;"><span style="FONT-SIZE:10pt;COLOR:#a31515;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;">d</span></span><span style="text-decoration:underline;"><span style="FONT-SIZE:10pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;">:</span></span><span style="text-decoration:underline;"><span style="FONT-SIZE:10pt;COLOR:#a31515;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;">DesignInstance</span></span><span style="text-decoration:underline;"><span style="FONT-SIZE:10pt;COLOR:red;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;"> my</span></span><span style="text-decoration:underline;"><span style="FONT-SIZE:10pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;">:</span></span><span style="text-decoration:underline;"><span style="FONT-SIZE:10pt;COLOR:red;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;">EditUserViewModel</span></span><span style="text-decoration:underline;"><span style="FONT-SIZE:10pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;">,</span></span><span style="text-decoration:underline;"><span style="FONT-SIZE:10pt;COLOR:red;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;"> CreateList</span></span><span style="text-decoration:underline;"><span style="FONT-SIZE:10pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;">=True</span></span><span style="FONT-SIZE:10pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;">}&quot; /&gt;</span><span style="FONT-SIZE:9pt;COLOR:black;FONT-FAMILY:Arial;"></span></p>
<p><span style="FONT-SIZE:9pt;COLOR:black;FONT-FAMILY:Arial;">&nbsp;The warning I get is the following:</span></p>
<p><span style="FONT-SIZE:10pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Arial;">The given key was not present in the dictionary. (Csla.NameValueListBase`2+NameValuePair[[System.Int32, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089],[System.String, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089]])&nbsp;C:\CSLA\CSLA Projects\CSLA 4.0.1 Projects\ARDAppMaintenance\ARDAppMaintenance.SL\Views\EditUser.xaml&nbsp;18&nbsp;83&nbsp;ARDAppMaintenance.SL</span></p>
<p>&nbsp;</p>
<p>My NVL object is divided into the client/server portions as such:</p>
<p><span style="text-decoration:underline;">NVLMission.cs</span> --&gt;&nbsp;</p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"> System;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"> System.Collections.Generic;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"> System.Linq;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"> System.Text;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"> Csla;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"> Csla.Serialization;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">namespace</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"> Business</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">{</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>[<span style="COLOR:#2b91af;">Serializable</span>]</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="COLOR:blue;">public</span> <span style="COLOR:blue;">partial</span> <span style="COLOR:blue;">class</span> <span style="COLOR:#2b91af;">NVLMission</span> : <span style="COLOR:#2b91af;">NameValueListBase</span>&lt;<span style="COLOR:blue;">int</span>, <span style="COLOR:blue;">string</span>&gt;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">}</span></p>
<p>&nbsp;<span style="text-decoration:underline;">NVLMission.Client.cs</span> --&gt;</p>
<p>&nbsp;</p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;color:blue;font-family:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"> System;</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;color:blue;font-family:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"> System.Collections.Generic;</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;color:blue;font-family:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"> System.Linq;</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;color:blue;font-family:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"> System.Text;</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;color:blue;font-family:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"> Csla;</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;color:blue;font-family:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"> Csla.Serialization;</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;color:blue;font-family:Consolas;mso-bidi-font-family:Consolas;">namespace</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"> Business</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;">{</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">public</span> <span style="color:blue;">partial</span> <span style="color:blue;">class</span> <span style="color:#2b91af;">NVLMission</span></span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;color:blue;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>#region</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"> Factory Methods</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">private</span> <span style="color:blue;">static</span> <span style="color:#2b91af;">NVLMission</span> _list;</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">public</span> <span style="color:blue;">static</span> <span style="color:blue;">void</span> InvalidateCache()</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_list = <span style="color:blue;">null</span>;</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="margin:0in 0in 0pt 0.5in;text-indent:6pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;color:blue;font-family:Consolas;mso-bidi-font-family:Consolas;">public</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"> <span style="color:blue;">static</span> <span style="color:blue;">void</span> GetNVLMission(<span style="color:blue;">int</span> pLanguage, <span style="color:#2b91af;">EventHandler</span>&lt;<span style="color:#2b91af;">DataPortalResult</span>&lt;<span style="color:#2b91af;">NVLMission</span>&gt;&gt; callback)</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (_list == <span style="color:blue;">null</span>)</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>{</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">var</span> dp = <span style="color:blue;">new</span> <span style="color:#2b91af;">DataPortal</span>&lt;<span style="color:#2b91af;">NVLMission</span>&gt;();</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dp.FetchCompleted += (o, e) =&gt;</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (e.Error == <span style="color:blue;">null</span>)</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:green;">//Do work here if necessary when fetch is complete</span></span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>callback(o, e);</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>};</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dp.BeginFetch(<span style="color:blue;">new</span> <span style="color:#2b91af;">SingleCriteria</span>&lt;<span style="color:#2b91af;">NVLMission</span>, <span style="color:blue;">int</span>&gt;(pLanguage));</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">else</span></span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="margin:0in 0in 0pt 1in;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;">callback(<span style="color:blue;">null</span>, <span style="color:blue;">new</span> <span style="color:#2b91af;">DataPortalResult</span>&lt;<span style="color:#2b91af;">NVLMission</span>&gt;(_list, <span style="color:blue;">null</span>, <span style="color:blue;">null</span>));</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;color:blue;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>#endregion</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"></span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;color:blue;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>#region</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"> Data Access</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;color:blue;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>#endregion</span><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"></span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;">}</span></p>
<p style="margin:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="font-size:9.5pt;font-family:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="margin:0in 0in 0pt;" class="MsoNormal"><span style="font-size:small;font-family:Times New Roman;">&nbsp;</span></p>
<p>
<p>&nbsp;<span style="text-decoration:underline;">NVLMission.Server.cs</span> --&gt;</p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"> System;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"> System.Collections.Generic;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"> System.Security;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"> System.Text;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"> System.Data.SqlClient;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"> Csla.Data;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"> Csla;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">namespace</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"> Business</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">{</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="COLOR:blue;">public</span> <span style="COLOR:blue;">partial</span> <span style="COLOR:blue;">class</span> <span style="COLOR:#2b91af;">NVLMission</span></span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>#region</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"> Factory Methods</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR:blue;">private</span> <span style="COLOR:blue;">static</span> <span style="COLOR:#2b91af;">NVLMission</span> _list;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR:blue;">public</span> <span style="COLOR:blue;">static</span> <span style="COLOR:#2b91af;">NVLMission</span> GetNVLMission(<span style="COLOR:blue;">int</span> pLanguage)</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR:blue;">if</span> (_list == <span style="COLOR:blue;">null</span>)</span></p>
<p style="MARGIN:0in 0in 0pt 1.5in;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">_list = <span style="COLOR:#2b91af;">DataPortal</span>.Fetch&lt;<span style="COLOR:#2b91af;">NVLMission</span>&gt;(<span style="COLOR:blue;">new</span> <span style="COLOR:#2b91af;">SingleCriteria</span>&lt;<span style="COLOR:#2b91af;">NVLMission</span>, <span style="COLOR:blue;">int</span>&gt;(pLanguage));</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR:blue;">return</span> _list;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR:blue;">public</span> <span style="COLOR:blue;">static</span> <span style="COLOR:blue;">void</span> InvalidateCache()</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>_list = <span style="COLOR:blue;">null</span>;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>#endregion</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"></span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp; </span><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>#region</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"> Data Access</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR:blue;">private</span> <span style="COLOR:blue;">void</span> DataPortal_Fetch(<span style="COLOR:#2b91af;">SingleCriteria</span>&lt;<span style="COLOR:#2b91af;">NVLMission</span>, <span style="COLOR:blue;">int</span>&gt; criteria)</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RaiseListChangedEvents = <span style="COLOR:blue;">false</span>;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IsReadOnly = <span style="COLOR:blue;">false</span>;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR:green;">//// TODO: load values</span></span></p>
<p style="MARGIN:0in 0in 0pt 1in;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">using</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"> (<span style="COLOR:blue;">var</span> ctx = <span style="COLOR:#2b91af;">ConnectionManager</span>&lt;<span style="COLOR:#2b91af;">SqlConnection</span>&gt;.GetManager(<span style="COLOR:#a31515;">&quot;MyConnection&quot;</span>))</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR:blue;">using</span> (<span style="COLOR:blue;">var</span> cm = ctx.Connection.CreateCommand())</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cm.CommandType = System.Data.<span style="COLOR:#2b91af;">CommandType</span>.StoredProcedure;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cm.CommandText = <span style="COLOR:#a31515;">&quot;MyStoredProcedure_Fetch&quot;</span>;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cm.Parameters.AddWithValue(<span style="COLOR:#a31515;">&quot;@ListName&quot;</span>, <span style="COLOR:#a31515;">&quot;LISTNAME&quot;</span>);</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>cm.Parameters.AddWithValue(<span style="COLOR:#a31515;">&quot;@Language&quot;</span>, criteria.Value);</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR:blue;">using</span> (<span style="COLOR:blue;">var</span> dr = <span style="COLOR:blue;">new</span> <span style="COLOR:#2b91af;">SafeDataReader</span>(cm.ExecuteReader()))</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="COLOR:blue;">while</span> (dr.Read())</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt 2in;TEXT-INDENT:3pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">Add(<span style="COLOR:blue;">new</span> <span style="COLOR:#2b91af;">NameValueListBase</span>&lt;<span style="COLOR:blue;">int</span>, <span style="COLOR:blue;">string</span>&gt;.<span style="COLOR:#2b91af;">NameValuePair</span>(dr.GetInt32(<span style="COLOR:#a31515;">&quot;Key&quot;</span>), dr.GetString(<span style="COLOR:#a31515;">&quot;Value&quot;</span>)));</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp; </span><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>}</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IsReadOnly = <span style="COLOR:blue;">true</span>;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RaiseListChangedEvents = <span style="COLOR:blue;">true</span>;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;COLOR:blue;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>#endregion</span><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"></span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">}</span></p>
<p style="MARGIN:0in 0in 0pt;mso-layout-grid-align:none;" class="MsoNormal"><span style="FONT-SIZE:9.5pt;FONT-FAMILY:Consolas;mso-bidi-font-family:Consolas;">&nbsp;</span></p>
<p style="MARGIN:0in 0in 0pt;" class="MsoNormal"><span style="font-size:small;font-family:Times New Roman;">&nbsp;</span></p>
<p>&nbsp;</p>
</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
