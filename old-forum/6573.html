<html><header><title>RegisterProperty feature of CSLA 3.6.2</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>RegisterProperty feature of CSLA 3.6.2</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6573.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Luzius posted on Saturday, March 07, 2009</h2><P>Hi Rocky,</P>
<P>I really like the new feature in 3.6.2 that allows to use a Lambda Expression to register a Property instead of using a string Literal.</P>
<P>Unfortunately it's currently not possible to use this feature with subclasses of CslaIdentity, because of the missing type parameter. </P>
<P>On rare occations, I still use OnPropertyChanged. I added the following code to my own base classes:</P><FONT color=#0000ff><FONT color=#0000ff>
<P><FONT face="Courier New" size=2>protected</FONT></FONT></FONT><FONT face="Courier New" size=2> <FONT color=#0000ff><FONT color=#0000ff>void</FONT></FONT> OnPropertyChanged(<FONT color=#2b91af><FONT color=#2b91af>Expression</FONT></FONT>&lt;<FONT color=#2b91af><FONT color=#2b91af>Func</FONT></FONT>&lt;T, <FONT color=#0000ff><FONT color=#0000ff>object</FONT></FONT>&gt;&gt; propertyLambdaExpression)</FONT></P>
<P><FONT face="Courier New" size=2>{</FONT></P>
<P><FONT size=2><FONT face="Courier New"><FONT color=#2b91af><FONT color=#2b91af>PropertyInfo</FONT></FONT> reflectedPropertyInfo = <FONT color=#2b91af><FONT color=#2b91af>Reflect</FONT></FONT>&lt;T&gt;.GetProperty(propertyLambdaExpression);</FONT></FONT></P>
<P><FONT face="Courier New" size=2>OnPropertyChanged(reflectedPropertyInfo.Name);</FONT></P>
<P><FONT face="Courier New" size=2>}</FONT></P>
<P>This allows me to use the feature also with OnPropertyChanged. </P>
<P><FONT size=2><FONT size=3>It would be very cool if this could be included in the Framework itself.</FONT></P>
<P><FONT size=3></FONT>&nbsp;</P>
<P><FONT size=3>Regards Luzius</FONT></P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Saturday, March 07, 2009</h2><P>Did we miss that one?</P>
<P>You should be able to do RegisterProperty&lt;MyIdentityType, string&gt;(c =&gt; c.Name)</P>
<P>That is necessary in subclasses of CriteriaBase, CommandBase and (I think) CslaIdentity because the CSLA base classes are not generic and so RegisterProperty() needs <EM>you</EM> to provide the type of the actual business class.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Luzius replied on Sunday, March 08, 2009</h2><P>Somehow I can't get that to work. When I specify the type of my&nbsp;CslsIdentity sub class&nbsp;I still only have access to the properties of CslaIdentity.</P>
<P>I tried to simply add a new RegisterProperty-Method to my class and it compiles perfectly but then I get the following runtime exception:</P>
<P>'Can not register property&nbsp;FullName after containing type (CslaIdentity) has been instantiated'</P>
<P>&nbsp;</P>
<P>Luzius</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Sunday, March 08, 2009</h2>I'll add it to the bug list so it gets checked out.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dbrillon replied on Wednesday, March 11, 2009</h2><P>I have the same problem.&nbsp; What can I do to to subclass CslaIdentity?&nbsp; Is there a quick fix or an alternate solution?</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, March 11, 2009</h2><P>Just don't use the lambda expression syntax:</P>
<P>private static PropertyInfo&lt;string&gt; NameProperty =<BR>&nbsp; RegisterProperty&lt;string&gt;(typeof(MyCustomIdentity), "Name");</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, March 11, 2009</h2>To be clear - RegisterProperty() in CslaIdentity will NEVER be the same as BusinessBase, because CslaIdentity isn't a generic type - so you will always have to explicitly provide the type name for your particular subclass.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dbrillon replied on Wednesday, March 11, 2009</h2><P>Thanks, it works perfectly!</P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>private</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>static</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>readonly</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>PropertyInfo</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Guid</FONT></FONT><FONT size=2>&gt; UserIdProperty = RegisterProperty&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Guid</FONT></FONT><FONT size=2>&gt;(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>typeof</FONT></FONT><FONT size=2>(</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>FMIdentity</FONT></FONT><FONT size=2>), </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>PropertyInfo</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Guid</FONT></FONT><FONT size=2>&gt;(</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"UserId"</FONT></FONT><FONT size=2>));</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius replied on Tuesday, November 03, 2009</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>Rocky:</strong></div><div></P>
<P>To be clear - RegisterProperty() in CslaIdentity will NEVER be the same as BusinessBase, because CslaIdentity isn't a generic type - so you will always have to explicitly provide the type name for your particular subclass. </P>
<P></div></BLOCKQUOTE></P>
<P>Just curious, what design decisions are being considered that is preventing the CslaIdentity from adding a generic type?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, November 03, 2009</h2><P>I may make it generic in 4.0. Making it generic now is clearly a breaking change, so the design consideration is that I try to avoid breaking changes, especially at the business class level, in point releases of the framework.</P>
<P>Generally I was only making base classes generic when there was a pressing need for them to be generic. There didn't used to be a need for CriteriaBase, CslaIdentity or CommandBase to be generic, so making them generic seemed pointless - silly really.</P>
<P>When we added the generic overload for RegisterProperty() the value of having a generic base class materialized - but that level of change seemed (to me) to be too disruptive.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
