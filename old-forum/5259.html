<html><header><title>Validation Rules - Value  for Required non-string values</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Validation Rules - Value  for Required non-string values</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5259.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Joffies posted on Monday, August 18, 2008</h2><P>Hi</P>
<P>I have a class which containts properties that represent foreign keys within database. These fields are all integers but they are all mandatory fields and the class should force the user to specify/select values for each of these fields. StringRequired doesnt seem to be providing the correct&nbsp; messaging when fields are mandatory. </P>
<P>What would be the best way/workaround to handle a case where a non-string value is required. I would prefer not to extend the CSLA if possible</P>
<P><FONT size=2>&nbsp;Thanks</FONT><FONT size=2></P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>IanK replied on Monday, August 18, 2008</h2><P>Why not use</P><FONT size=2>
<P>ValidationRules.AddRule( _</P>
<P></FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> Validation.CommonRules.IntegerMinValue, _</P>
<P></FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> Validation.CommonRules.IntegerMinValueRuleArgs(</FONT><FONT color=#a31515 size=2>"PropertyName"</FONT><FONT size=2>, 1))</FONT></P>
<P><FONT size=2>Adding FriendlyName argument if required. Your FK probably all default to zero. If you don't like default message you can use something like</FONT></P>
<P><FONT size=2></FONT>&nbsp;</P><FONT size=2><FONT size=2>
<P>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> ValidateTownID(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2>&nbsp; &lt;YourObject&gt;), </FONT><FONT color=#a31515 size=2>"TownID"</FONT><FONT size=2>)</FONT></P>
<P><FONT size=2>and implement&nbsp;the &nbsp;Rule as below:</P></FONT></FONT><FONT size=2><FONT color=#0000ff size=2>
<P>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> ValidateTownID(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> &lt;YoutObject&gt;)(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> target </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Validation.RuleArgs) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> target.TownID = 0 </FONT><FONT color=#0000ff size=2>Then</FONT></P>
<P><FONT size=2>e.Description = </FONT><FONT color=#a31515 size=2>"Please choose a Town"</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>False</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>True</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>vdhant replied on Tuesday, August 19, 2008</h2>Hi guys<br>Not sure if this is what you are after but I came up with this a while ago...<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static bool NotDefaultValue&lt;T&gt;(object target, RuleArgs e) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T value = e.ReadField&lt;T&gt;(target, e.PropertyName);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (object.Equals(value, default(T)) || String.IsNullOrEmpty(value.ToString()))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.Description = string.Format(Resources.ValueRequired, RuleArgs.GetPropertyName(e));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>You don't need to modify CSLA to use this as it is just a static method that you can reference from your own rules 
<span>repository</span>. <br>Anthony<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
