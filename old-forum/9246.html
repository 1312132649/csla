<html><header><title>Problem with WPF IsEnabled updating on property changed.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Problem with WPF IsEnabled updating on property changed.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9246.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Curelom posted on Wednesday, July 21, 2010</h2><p style="FONT-FAMILY:consolas;"><span style="COLOR:#a31515;">I&nbsp;have a BusinessObject &quot;SoxControl&quot;</span></p>
<p style="FONT-FAMILY:consolas;"><span style="COLOR:#a31515;"></span><span style="COLOR:#a31515;">This control has owner which can signoff the control, or clear the signoff.</span></p>
<p style="FONT-FAMILY:consolas;"><span style="COLOR:#a31515;">An admin can also signoff or clear a signoff of a control as well as change the owner </span><span style="COLOR:#a31515;">of the control.</span></p>
<p style="FONT-FAMILY:consolas;"><span style="COLOR:#a31515;">I have&nbsp;2 buttons which signoff or clear the signoff and&nbsp;are to enable/disable approriate with whether the user has rights and the state of the signoff.</span></p>
<p style="FONT-FAMILY:consolas;"><span style="COLOR:#a31515;">The problem is that WPF doesn&#39;t seem to be updating the IsEnabled property on a change, even though I have walked through the code and watched it call the PropertyHasChanged on the approriate properties.&nbsp; Any ideas on where I go from here, or is there a completely different way to handle this that makes more sense?&nbsp; - Using CSLA 4 RC0</span></p>
<p style="FONT-FAMILY:consolas;"><span style="COLOR:#a31515;">Thanks</span></p>
<p style="FONT-FAMILY:consolas;"><span style="COLOR:#a31515;">&nbsp;<span style="COLOR:blue;">&lt;</span><span style="COLOR:#a31515;">Button</span><span style="COLOR:red;">&nbsp;Name</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">&quot;btnSignoff&quot;</span><span style="COLOR:red;">&nbsp;Content</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">&quot;Signoff&quot;</span><span style="COLOR:red;">&nbsp;Margin</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">&quot;0,0,5,0&quot;</span><br /><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR:red;">&nbsp;IsEnabled</span><span style="COLOR:blue;">=&quot;{</span><span style="COLOR:#a31515;">Binding</span><span style="COLOR:red;">&nbsp;Path</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">CanOwnerSignoff</span><span style="COLOR:blue;">,</span><span style="COLOR:red;">&nbsp;</span></span></p>
<p style="FONT-FAMILY:consolas;"><span style="COLOR:#a31515;"><span style="COLOR:red;"></span><span style="COLOR:red;">&nbsp;&nbsp; ValidatesOnExceptions</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">true</span><span style="COLOR:blue;">,</span><span style="COLOR:red;">&nbsp;NotifyOnValidationError</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">true</span><span style="COLOR:blue;">,</span><span style="COLOR:red;">&nbsp;</span></span></p>
<p style="FONT-FAMILY:consolas;"><span style="COLOR:#a31515;"><span style="COLOR:red;">&nbsp;&nbsp; UpdateSourceTrigger</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">PropertyChanged</span><span style="COLOR:blue;">}</span><span style="COLOR:blue;">&quot;</span><span style="COLOR:blue;">&nbsp;/&gt;</span><br /><span style="COLOR:blue;">&lt;</span><span style="COLOR:#a31515;">csla</span><span style="COLOR:blue;">:</span><span style="COLOR:#a31515;">TriggerAction</span><span style="COLOR:red;">&nbsp;x</span><span style="COLOR:blue;">:</span><span style="COLOR:red;">Name</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">&quot;trgSignoff&quot;</span><span style="COLOR:red;">&nbsp;</span></span></p>
<p style="FONT-FAMILY:consolas;"><span style="COLOR:#a31515;"><span style="COLOR:red;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TargetControl</span><span style="COLOR:blue;">=&quot;{</span><span style="COLOR:#a31515;">Binding</span><span style="COLOR:red;">&nbsp;ElementName</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">btnSignoff</span><span style="COLOR:blue;">}</span><span style="COLOR:blue;">&quot;</span><span style="COLOR:red;">&nbsp;Height</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">&quot;0&quot;</span><span style="COLOR:red;">&nbsp;Width</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">&quot;0&quot;</span><br /><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR:red;">&nbsp;TriggerEvent</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">&quot;Click&quot;</span><span style="COLOR:red;">&nbsp;DataContext</span><span style="COLOR:blue;">=&quot;{</span><span style="COLOR:#a31515;">Binding</span><span style="COLOR:red;">&nbsp;Path</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">CurrentItem</span><span style="COLOR:blue;">,</span><span style="COLOR:red;">&nbsp;Source</span><span style="COLOR:blue;">={</span><span style="COLOR:#a31515;">StaticResource</span><span style="COLOR:red;">&nbsp;soxControlListViewModelViewSource</span><span style="COLOR:blue;">}}</span><span style="COLOR:blue;">&quot;</span><span style="color:#000000;">&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR:red;">&nbsp;MethodName</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">&quot;OwnerSignoff&quot;</span><span style="COLOR:blue;">/&gt;</span><br /><span style="COLOR:#a31515;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br /><span style="COLOR:blue;">&lt;</span><span style="COLOR:#a31515;">Button</span><span style="COLOR:red;">&nbsp;Name</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">&quot;btnClearSignoff&quot;</span><span style="COLOR:red;">&nbsp;Content</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">&quot;Clear&quot;</span><span style="color:#000000;">&nbsp;<br />&nbsp;</span><span style="COLOR:red;">&nbsp;IsEnabled</span><span style="COLOR:blue;">=&quot;{</span><span style="COLOR:#a31515;">Binding</span><span style="COLOR:red;">&nbsp;Path</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">CanClearOwnerSignoff</span><span style="COLOR:blue;">,</span><span style="COLOR:red;">&nbsp;</span><span style="COLOR:red;">ValidatesOnExceptions</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">true</span><span style="COLOR:blue;">,</span><span style="COLOR:red;">&nbsp;</span></span></p>
<p style="FONT-FAMILY:consolas;"><span style="COLOR:#a31515;"><span style="COLOR:red;">&nbsp; </span></span><span style="COLOR:#a31515;"><span style="COLOR:red;">NotifyOnValidationError</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">true</span><span style="COLOR:blue;">,</span></span></p>
<p style="FONT-FAMILY:consolas;"><span style="COLOR:#a31515;"><span style="COLOR:blue;">&nbsp; </span><span style="COLOR:red;">UpdateSourceTrigger</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">PropertyChanged</span><span style="COLOR:blue;">}</span><span style="COLOR:blue;">&quot;</span><span style="COLOR:blue;">/&gt;</span><br /><span style="color:#000000;"><br /></span><span style="COLOR:blue;">&lt;</span><span style="COLOR:#a31515;">csla</span><span style="COLOR:blue;">:</span><span style="COLOR:#a31515;">TriggerAction</span><span style="COLOR:red;">&nbsp;x</span><span style="COLOR:blue;">:</span><span style="COLOR:red;">Name</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">&quot;trgClearSignoff&quot;</span><span style="COLOR:red;">&nbsp;</span></span></p>
<p style="FONT-FAMILY:consolas;"><span style="COLOR:#a31515;"><span style="COLOR:red;">TargetControl</span><span style="COLOR:blue;">=&quot;{</span><span style="COLOR:#a31515;">Binding</span><span style="COLOR:red;">&nbsp;ElementName</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">btnClearSignoff</span><span style="COLOR:blue;">}</span><span style="COLOR:blue;">&quot;</span><span style="COLOR:red;">&nbsp;Height</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">&quot;0&quot;</span><span style="COLOR:red;">&nbsp;Width</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">&quot;0&quot;</span><br /><span style="color:#000000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR:red;">&nbsp;TriggerEvent</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">&quot;Click&quot;</span><span style="color:#000000;">&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR:red;">&nbsp;DataContext</span><span style="COLOR:blue;">=&quot;{</span><span style="COLOR:#a31515;">Binding</span><span style="COLOR:red;">&nbsp;Path</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">CurrentItem</span><span style="COLOR:blue;">,</span><span style="COLOR:red;">&nbsp;</span></span></p>
<p style="FONT-FAMILY:consolas;"><span style="COLOR:#a31515;"><span style="COLOR:red;">Source</span><span style="COLOR:blue;">={</span><span style="COLOR:#a31515;">StaticResource</span><span style="COLOR:red;">&nbsp;soxControlListViewModelViewSource</span><span style="COLOR:blue;">}}</span><span style="COLOR:blue;">&quot;</span><span style="color:#000000;">&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="COLOR:red;">&nbsp;MethodName</span><span style="COLOR:blue;">=</span><span style="COLOR:blue;">&quot;ClearOwnerSignoff&quot;</span><span style="COLOR:blue;">/&gt;</span><br /></span>
<p style="FONT-FAMILY:consolas;"><span style="COLOR:#a31515;"></span></p>
<pre style="FONT-FAMILY:consolas;"><span style="COLOR:#a31515;"><pre style="FONT-FAMILY:consolas;"><span style="COLOR:blue;">private</span>&nbsp;<span style="COLOR:blue;">bool</span>&nbsp;UserOwnerSignoff&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:blue;">get</span>&nbsp;{&nbsp;</pre>
<pre style="FONT-FAMILY:consolas;"><span style="COLOR:blue;">         return</span>&nbsp;!<span style="COLOR:#2b91af;">String</span>.IsNullOrEmpty(GetProperty&lt;<span style="COLOR:blue;">string</span>&gt;(ControlOwnerSignoffProperty));&nbsp;}<br />&nbsp;   }</pre>
<pre style="FONT-FAMILY:consolas;">}</pre>
</span></pre>
<pre style="FONT-FAMILY:consolas;"><span style="COLOR:#a31515;"><pre style="FONT-FAMILY:consolas;">&nbsp;<span style="COLOR:blue;">public</span>&nbsp;<span style="COLOR:blue;">static</span>&nbsp;<span style="COLOR:#2b91af;">PropertyInfo</span>&lt;<span style="COLOR:blue;">bool</span>&gt;&nbsp;CanOwnerSignoffProperty&nbsp;=&nbsp;RegisterProperty&lt;<span style="COLOR:blue;">bool</span>&gt;(c&nbsp;=&gt;&nbsp;c.CanOwnerSignoff);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:gray;">///</span><span style="COLOR:green;">&nbsp;</span><span style="COLOR:gray;">&lt;summary&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:gray;">///</span><span style="COLOR:green;">&nbsp;Determines&nbsp;if&nbsp;OwnerSignoff&nbsp;can&nbsp;be&nbsp;completed.</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:gray;">///</span><span style="COLOR:green;">&nbsp;If&nbsp;user&nbsp;is&nbsp;an&nbsp;Admin,&nbsp;or&nbsp;the&nbsp;control&nbsp;owner&nbsp;and&nbsp;control&nbsp;is&nbsp;not&nbsp;already&nbsp;signed&nbsp;off&nbsp;then&nbsp;true</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:gray;">///</span><span style="COLOR:green;">&nbsp;</span><span style="COLOR:gray;">&lt;/summary&gt;</span><span style="COLOR:green;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:blue;">public</span>&nbsp;<span style="COLOR:blue;">bool</span>&nbsp;CanOwnerSignoff&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:blue;">get</span>&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:#2b91af;">SoxIdentity</span>&nbsp;currentUserIdentity&nbsp;=&nbsp;<span style="COLOR:#2b91af;">ApplicationContext</span>.User.Identity&nbsp;<span style="COLOR:blue;">as</span>&nbsp;<span style="COLOR:#2b91af;">SoxIdentity</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:blue;">if</span>&nbsp;((currentUserIdentity.IsInRole(<span style="COLOR:#a31515;">&quot;ADMIN&quot;</span>)&nbsp;</pre>
<pre style="FONT-FAMILY:consolas;">               ||&nbsp;currentUserIdentity.Name&nbsp;==&nbsp;GetProperty&lt;<span style="COLOR:blue;">string</span>&gt;(ControlOwnerProperty))&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;UserOwnerSignoff)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:blue;">return</span>&nbsp;<span style="COLOR:blue;">true</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:blue;">else</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:blue;">return</span>&nbsp;<span style="COLOR:blue;">false</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:blue;">public</span>&nbsp;<span style="COLOR:blue;">static</span>&nbsp;<span style="COLOR:#2b91af;">PropertyInfo</span>&lt;<span style="COLOR:blue;">bool</span>&gt;&nbsp;CanClearOwnerSignoffProperty&nbsp;=&nbsp;RegisterProperty&lt;<span style="COLOR:blue;">bool</span>&gt;(c&nbsp;=&gt;&nbsp;c.CanClearOwnerSignoff);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:gray;">///</span><span style="COLOR:green;">&nbsp;</span><span style="COLOR:gray;">&lt;summary&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:gray;">///</span><span style="COLOR:green;">&nbsp;Determines&nbsp;if&nbsp;OwnerSignoff&nbsp;can&nbsp;be&nbsp;cleared.</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:gray;">///</span><span style="COLOR:green;">&nbsp;If&nbsp;user&nbsp;is&nbsp;an&nbsp;Admin,&nbsp;or&nbsp;the&nbsp;control&nbsp;owner&nbsp;and&nbsp;control&nbsp;is&nbsp;already&nbsp;signed&nbsp;off&nbsp;then&nbsp;true</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:gray;">///</span><span style="COLOR:green;">&nbsp;</span><span style="COLOR:gray;">&lt;/summary&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:blue;">public</span>&nbsp;<span style="COLOR:blue;">bool</span>&nbsp;CanClearOwnerSignoff&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:blue;">get</span>&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:#2b91af;">SoxIdentity</span>&nbsp;currentUserIdentity&nbsp;=&nbsp;<span style="COLOR:#2b91af;">ApplicationContext</span>.User.Identity&nbsp;<span style="COLOR:blue;">as</span>&nbsp;<span style="COLOR:#2b91af;">SoxIdentity</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:blue;">if</span>&nbsp;((currentUserIdentity.IsInRole(<span style="COLOR:#a31515;">&quot;ADMIN&quot;</span>)&nbsp;</pre>
<pre style="FONT-FAMILY:consolas;">               ||&nbsp;currentUserIdentity.Name&nbsp;==&nbsp;GetProperty&lt;<span style="COLOR:blue;">string</span>&gt;(ControlOwnerProperty))&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;!UserOwnerSignoff)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:blue;">return</span>&nbsp;<span style="COLOR:blue;">true</span>;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:blue;">else</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:blue;">return</span>&nbsp;<span style="COLOR:blue;">false</span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /><span style="COLOR:blue;">		#endregion</span>&nbsp;<span style="COLOR:green;">//&nbsp;Properties</span><br /> <br /><span style="COLOR:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#region</span>&nbsp;Methods<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:gray;">///</span><span style="COLOR:green;">&nbsp;</span><span style="COLOR:gray;">&lt;summary&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:gray;">///</span><span style="COLOR:green;">&nbsp;Signoff&nbsp;the&nbsp;control</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:gray;">///</span><span style="COLOR:green;">&nbsp;</span><span style="COLOR:gray;">&lt;/summary&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:blue;">public</span>&nbsp;<span style="COLOR:blue;">void</span>&nbsp;OwnerSignoff()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:blue;">string</span>&nbsp;ownerSignoff&nbsp;=&nbsp;GetProperty&lt;<span style="COLOR:blue;">string</span>&gt;(ControlOwnerSignoffProperty);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:#2b91af;">SoxIdentity</span>&nbsp;currentUserIdentity&nbsp;=&nbsp;<span style="COLOR:#2b91af;">ApplicationContext</span>.User.Identity&nbsp;<span style="COLOR:blue;">as</span>&nbsp;<span style="COLOR:#2b91af;">SoxIdentity</span>;<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:blue;">if</span>&nbsp;(currentUserIdentity.IsInRole(<span style="COLOR:#a31515;">&quot;ADMIN&quot;</span>)&nbsp;</pre>
<pre style="FONT-FAMILY:consolas;">               ||&nbsp;currentUserIdentity.Name&nbsp;==&nbsp;GetProperty&lt;<span style="COLOR:blue;">string</span>&gt;(ControlOwnerProperty))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetProperty&lt;<span style="COLOR:blue;">string</span>&gt;(ControlOwnerSignoffProperty,&nbsp;currentUserIdentity.UserId);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetProperty&lt;System.<span style="COLOR:#2b91af;">DateTime</span>?&gt;(DateCertifiedProperty,&nbsp;<span style="COLOR:blue;">new</span>&nbsp;<span style="COLOR:#2b91af;">DateTime</span>?(<span style="COLOR:#2b91af;">DateTime</span>.Today));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PropertyHasChanged(CanOwnerSignoffProperty);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PropertyHasChanged(CanClearOwnerSignoffProperty);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:gray;">///</span><span style="COLOR:green;">&nbsp;</span><span style="COLOR:gray;">&lt;summary&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:gray;">///</span><span style="COLOR:green;">&nbsp;Clear&nbsp;the&nbsp;certification&nbsp;signoff</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:gray;">///</span><span style="COLOR:green;">&nbsp;</span><span style="COLOR:gray;">&lt;/summary&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:blue;">public</span>&nbsp;<span style="COLOR:blue;">void</span>&nbsp;ClearOwnerSignoff()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="COLOR:blue;">string</span>&nbsp;ownerSignoff&nbsp;=&nbsp;GetProperty&lt;<span style="COLOR:blue;">string</span>&gt;(ControlOwnerSignoffProperty);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetProperty&lt;<span style="COLOR:blue;">string</span>&gt;(ControlOwnerSignoffProperty,&nbsp;<span style="COLOR:blue;">null</span>);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SetProperty&lt;System.<span style="COLOR:#2b91af;">DateTime</span>?&gt;(DateCertifiedProperty,&nbsp;<span style="COLOR:blue;">new</span>&nbsp;<span style="COLOR:#2b91af;">DateTime</span>?());<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PropertyHasChanged(CanOwnerSignoffProperty);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PropertyHasChanged(CanClearOwnerSignoffProperty);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><span style="COLOR:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#endregion</span><br /></pre>
</span></pre>
<pre style="FONT-FAMILY:consolas;"><br /></pre>
</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>Curelom replied on Wednesday, July 21, 2010</h2><p>Nevermind, it just started working.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
