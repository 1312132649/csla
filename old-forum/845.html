<html><header><title>Reflection Question?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Reflection Question?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/845.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>RangerGuy posted on Tuesday, August 08, 2006</h2><P><FONT face=Tahoma>Hi Everyone,</FONT></P>
<P><FONT face=Tahoma>I'm trying to use reflection against one of our BO's which inherits from ReadOnlyRoot. I get the following error </FONT></P>
<P><FONT face=Tahoma>An unhandled exception of type 'System.MissingMethodException' occurred in mscorlib.dllAdditional information: No parameterless constructor defined for this object.</FONT></P>
<P><FONT face=Tahoma>When it reaches the following code in bold. I'm confused with this error because all Csla BO's are defined with a parameterless constructor.</FONT></P>
<P><FONT color=#000000 size=2><FONT face=Tahoma>foreach (ModuleMoin myModules) <BR>{ <BR>&nbsp;if (Mo.Name == ModuleName) <BR>&nbsp;{ <BR>&nbsp;Type[] myTypes = Mo.GetTypes(); <BR>&nbsp;foreach (Type Ty in myTypes) <BR>&nbsp;{ <BR>&nbsp;&nbsp;if (Ty.Name == TypeName) <BR>&nbsp;&nbsp;{ <BR>&nbsp;&nbsp;&nbsp;MethodInfo[] myMethodInfo = Ty.GetMethods(flags); <BR>&nbsp;&nbsp;&nbsp;foreach (MethodInfo Mi in myMethodInfo) <BR>&nbsp;&nbsp;&nbsp;{ <BR>&nbsp;&nbsp;&nbsp;&nbsp;if (Mi.Name == MethodName) <BR>&nbsp;&nbsp;&nbsp;&nbsp;{ <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT face=Tahoma><STRONG>Object obj = Activator.CreateInstance(Ty); <BR></STRONG>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Object response = Mi.Invoke(obj, null); <BR>&nbsp;&nbsp;&nbsp;&nbsp;} <BR>&nbsp;&nbsp;&nbsp;} <BR>&nbsp;&nbsp;} <BR>&nbsp;} <BR>&nbsp;} <BR>}</FONT></FONT><FONT size=2></FONT></P>
<P>PS (I borrowed this code from another website to try and understand how to work with reflection)</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, August 08, 2006</h2>Oh, I am so disappointed!!! Another web site??&nbsp; <img src="/emoticons/emotion-5.gif" alt="Wink [;)]" /><br><br>The answers you seek are in Chapter 4 in the server-side data portal - in SimpleDataPortal to be exact. There's an overload that allows you to tell .NET to use the default ctor even if it is non-public. You do still need a default ctor, but it can be something other than public.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RangerGuy replied on Wednesday, August 09, 2006</h2><P>my bad! Sorry Rocky LOL! </P>
<P>Thanks again Sir your a live saver! I'll check that out today. I'm going to re-read chapter 4 :)</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RangerGuy replied on Wednesday, August 09, 2006</h2><P>Just wanted thank you for pointing me in the right direction. I just re-read chapter 4 :) and found the answer!</P>
<P>Incase anybody is interested. If your going to use reflection to create an instance of an object with a private constructor like we do with Csla.net. Then you need to use the System.Activator class like the following:</P>
<P>obj = Activator.CreateInstance(objectType, true); </P>
<P>This tells .NET to create the instance even if the constructor is not public :)</P>
<P>&nbsp;</P>
<P>Thank you again Rocky!</P>
<P>U ROCK! (no pun intended LOL!)</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
