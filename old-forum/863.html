<html><header><title>SortedBindingList.Find</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>SortedBindingList.Find</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/863.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>mking posted on Wednesday, August 09, 2006</h2><P><A HREF="/forums/thread/544.aspx">http://forums.lhotka.net/forums/thread/544.aspx</A></P>
<P>Hi,</P>
<P>I implemented sorting using the GridView control and the SortedBindingList as described in the above thread.&nbsp; It works great.&nbsp; </P>
<P>Now I need to bind a DetailsView control to a specific object in the collection when the user clicks "Edit" on a particular row.&nbsp; My code looks like this:</P>
<P><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; protected void CslaDataSource2_SelectObject(object sender, Csla.Web.SelectObjectArgs e)<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //get the business object for the DetailsView<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.BusinessObject = GetSelectedEvent();<BR>&nbsp;&nbsp;&nbsp; }<BR></FONT><FONT face="Courier New" size=2><BR>&nbsp;&nbsp;&nbsp; private Event GetSelectedEvent()<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SortedBindingList&lt;Event&gt; evts = GetEvents(false);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (grdEvents.SelectedValue != null)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR><STRONG>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int index = evts.Find("EvtID", (int)grdEvents.SelectedValue);<BR></STRONG>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return evts[index];<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return null;<BR>&nbsp;&nbsp;&nbsp; }<BR></FONT></P>
<P><FONT>I get a <STRONG>Specified method is not supported</STRONG> error inside SortedBindingList.cs.&nbsp; The line of code where the error happens is:</FONT></P>
<P><FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return _bindingList.Find(property, key);<BR></FONT></FONT></P>
<P><FONT><FONT face="Courier New"><FONT face="Times New Roman">Do I need to code a Find method in my EditableRootList class?</FONT></FONT></FONT></P>
<P><FONT><FONT face="Courier New"><FONT face="Times New Roman">Thanks,</FONT></FONT></FONT></P>
<P><FONT><FONT face="Courier New"><FONT face="Times New Roman">Mike</FONT></FONT></FONT></P>
<P><FONT><FONT face="Courier New"><FONT face="Times New Roman"></FONT>&nbsp;</P></FONT></FONT><FONT size=2></FONT>
<P><FONT size=2>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mking replied on Wednesday, August 09, 2006</h2><P>More info:</P>
<P>I was able to get the above error to stop happening by adding a FindCore procedure to my BusinessList class.&nbsp; Then I quickly realized that it was returning the index to&nbsp;my BusinessList, not the SortedBindingList.&nbsp; Which caused the wrong record to appear in the DetailsView.</P>
<P>So, to try an fix my problems, I'm now using a Session["currentSortObject"] and a Session["currentObject"].&nbsp; One contains the SortedBindingList and the other contains the associated BusinessList.&nbsp; It's working properly from the user's perspective but it seems like a hack.</P>
<P>Has anyone posted example code&nbsp;of a fully functional, bound GridView/DetailView that's sortable and editable?&nbsp; I have the PTWeb example project but it's pretty basic.</P>
<P>Thanks,</P>
<P>Mike</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pvanroos replied on Friday, August 18, 2006</h2><P>Hi Mike,</P>
<P>I'm looking to sort the DetailsView at runtime but haven't found a way to do it.&nbsp; Did you ever find a solution to this problem?</P>
<P>Thanks,</P>
<P>Paul</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Saturday, August 19, 2006</h2>The search/find functionality isn't implemented in either BindingList&lt;T&gt; or Csla.SortedBindingList&lt;T&gt;. There is a known bug in SortedBindingList where IndexOf() returns the unsorted value rather than the sorted value - that is being fixed in version 2.1.<br><br>It may be that the fix to IndexOf will solve your problem if you are using a feature of List&lt;T&gt;. If you are using a feature of IBindingList (BindingList&lt;T&gt;) then this won't help, because you'd need a list class that implements the search/find behaviors. You could implement such a list as a wrapper much like I did with SortedBindingList and the new FilteredBindingList - making this new list composable with the others.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fmahieux replied on Tuesday, March 13, 2007</h2><P>Actually, I would like to implement the Find method into my business objects but think it will seat better&nbsp; into the CSLA Framework with help of generics like :</P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>public</SPAN></FONT> <FONT color=#2b91af><SPAN>GroupInfo</SPAN></FONT> Find(<FONT color=blue><SPAN>string</SPAN></FONT>[] propertyNames, <FONT color=blue><SPAN>object</SPAN></FONT>[] values)<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>if</SPAN></FONT> (propertyNames == <FONT color=blue><SPAN>null</SPAN></FONT>)<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>throw</SPAN></FONT> <FONT color=blue><SPAN>new</SPAN></FONT> <FONT color=#2b91af><SPAN>Exception</SPAN></FONT>(<FONT color=#a31515><SPAN>"No property name is defined."</SPAN></FONT>);<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>if</SPAN></FONT> (values == <FONT color=blue><SPAN>null</SPAN></FONT>)<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>throw</SPAN></FONT> <FONT color=blue><SPAN>new</SPAN></FONT> <FONT color=#2b91af><SPAN>Exception</SPAN></FONT>(<FONT color=#a31515><SPAN>"No values are defined."</SPAN></FONT>);<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>if</SPAN></FONT> (propertyNames.Length != values.Length)<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>throw</SPAN></FONT> <FONT color=blue><SPAN>new</SPAN></FONT> <FONT color=#2b91af><SPAN>Exception</SPAN></FONT>(<FONT color=#a31515><SPAN>"Number of values does not match count of property names."</SPAN></FONT>);<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN><o:p>&nbsp;</o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>int</SPAN></FONT> propertyIndex= 0;<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>string</SPAN></FONT> propertyName = <FONT color=#2b91af><SPAN>String</SPAN></FONT>.Empty;<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#2b91af><SPAN>List</SPAN></FONT>&lt;<FONT color=#2b91af><SPAN>PropertyDescriptor</SPAN></FONT>&gt; properties = <FONT color=blue><SPAN>new</SPAN></FONT> <FONT color=#2b91af><SPAN>List</SPAN></FONT>&lt;<FONT color=#2b91af><SPAN>PropertyDescriptor</SPAN></FONT>&gt;(); <o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN><o:p>&nbsp;</o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#2b91af><SPAN>PropertyDescriptorCollection</SPAN></FONT> propertyDescriptorCollection = <FONT color=#2b91af><SPAN>TypeDescriptor</SPAN></FONT>.GetProperties(<FONT color=blue><SPAN>typeof</SPAN></FONT>(<FONT color=#2b91af><SPAN>GroupInfo</SPAN></FONT>));<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN><o:p>&nbsp;</o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>for</SPAN></FONT> (propertyIndex = 0; propertyIndex &lt; propertyNames.Length; propertyIndex++)<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; propertyName = propertyNames[propertyIndex];<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>if</SPAN></FONT>(<FONT color=#2b91af><SPAN>String</SPAN></FONT>.IsNullOrEmpty(propertyName))<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>throw</SPAN></FONT> <FONT color=blue><SPAN>new</SPAN></FONT> <FONT color=#2b91af><SPAN>Exception</SPAN></FONT>(<FONT color=#a31515><SPAN>"An empty or null string was provided as property name."</SPAN></FONT>);<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>try</SPAN></FONT> { properties.Add(propertyDescriptorCollection[propertyName]); }<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT color=blue><SPAN>catch</SPAN></FONT> { <FONT color=blue><SPAN>throw</SPAN></FONT> <FONT color=blue><SPAN>new</SPAN></FONT> <FONT color=#2b91af><SPAN>Exception</SPAN></FONT>(<FONT color=#2b91af><SPAN>String</SPAN></FONT>.Format(<FONT color=#a31515><SPAN>"Property [{0}] does not exist in the object."</SPAN></FONT>, propertyName)); }<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN><o:p>&nbsp;</o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>for</SPAN></FONT> (<FONT color=blue><SPAN>int</SPAN></FONT> itemIndex = 0; itemIndex &lt; <FONT color=blue><SPAN>this</SPAN></FONT>.Count; itemIndex++)<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>bool</SPAN></FONT> itemMatch&nbsp; = <FONT color=blue><SPAN>true</SPAN></FONT>;<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>for</SPAN></FONT> (propertyIndex = 0; propertyIndex &lt; properties.Count; propertyIndex++)<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#2b91af><SPAN>PropertyDescriptor</SPAN></FONT> propertyDescriptor = properties[propertyIndex];<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>object</SPAN></FONT> value = values[propertyIndex];<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN><o:p>&nbsp;</o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; itemMatch = propertyDescriptor.GetValue(<FONT color=blue><SPAN>this</SPAN></FONT>[itemIndex]).Equals(value);<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>if</SPAN></FONT> (!itemMatch)<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>break</SPAN></FONT>;<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN><o:p>&nbsp;</o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>if</SPAN></FONT> (itemMatch)<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>return</SPAN></FONT> <FONT color=blue><SPAN>this</SPAN></FONT>[itemIndex];<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN><o:p>&nbsp;</o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=blue><SPAN>return</SPAN></FONT> <FONT color=blue><SPAN>null</SPAN></FONT>;<o:p></o:p></SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><FONT face="Courier New" size=2><SPAN>}</SPAN></FONT></P>
<P class=MsoNormal><FONT face="Courier New" size=2><SPAN>Regards<o:p></o:p></SPAN></FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, March 13, 2007</h2>






 

 
  
 




<div class=Section1>

<p class=MsoNormal><span>You could also view a find operation as a special case of a
filter operation. Then you could use FilteredBindingList to simply create a
view of your collection that only shows the matching items.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>The problem with doing arbitrary Find operations (especially ones
that return n items) in a CSLA setting is that the objects you get back <i>belong
to a collection</i>. They are child objects, and thus aren&#8217;t designed to
stand alone out of context.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>In some cases a Find makes sense, but in many cases you run the
risk of doing things to those objects that are illegal.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>The FilteredBindingList approach avoids that issue, because the
objects are left in context. FilteredBindingList is merely a view over the original
list (just like SortedBindingList), and so you are automatically prevented from
doing illegal things to the objects, because they are still &#8220;in context&#8221;
within their parent collection.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>Rocky<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<div>

<div>

<div>

<p class=MsoNormal><b><span>From:</span></b><span> fmahieux
[mailto:cslanet@lhotka.net] <br>
<b>Sent:</b> Tuesday, March 13, 2007 7:38 AM<br>
<b>To:</b> rocky@lhotka.net<br>
<b>Subject:</b> Re: [CSLA .NET] SortedBindingList.Find<o:p></o:p></span></p>

</div>

</div>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p>Actually, I would like to implement the Find method into my business objects
but think it will seat better&nbsp; into the CSLA Framework with help of
generics like :<o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>public</span> <span>GroupInfo</span>
Find(<span>string</span>[] propertyNames, <span>object</span>[] values)</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>if</span> (propertyNames == <span>null</span>)</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>throw</span> <span>new</span> <span>Exception</span>(<span>&quot;No
property name is defined.&quot;</span>);</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>if</span> (values == <span>null</span>)</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>throw</span> <span>new</span> <span>Exception</span>(<span>&quot;No
values are defined.&quot;</span>);</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>if</span> (propertyNames.Length != values.Length)</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>throw</span> <span>new</span> <span>Exception</span>(<span>&quot;Number
of values does not match count of property names.&quot;</span>);</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>int</span> propertyIndex= 0;</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>string</span> propertyName = <span>String</span>.Empty;</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>List</span>&lt;<span>PropertyDescriptor</span>&gt;
properties = <span>new</span> <span>List</span>&lt;<span>PropertyDescriptor</span>&gt;(); </span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>PropertyDescriptorCollection</span>
propertyDescriptorCollection = <span>TypeDescriptor</span>.GetProperties(<span>typeof</span>(<span>GroupInfo</span>));</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>for</span> (propertyIndex = 0; propertyIndex &lt;
propertyNames.Length; propertyIndex++)</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
propertyName = propertyNames[propertyIndex];</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>if</span>(<span>String</span>.IsNullOrEmpty(propertyName))</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>throw</span> <span>new</span> <span>Exception</span>(<span>&quot;An
empty or null string was provided as property name.&quot;</span>);</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>try</span> { properties.Add(propertyDescriptorCollection[propertyName]);
}</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>catch</span> { <span>throw</span> <span>new</span> <span>Exception</span>(<span>String</span>.Format(<span>&quot;Property [{0}] does not exist in the object.&quot;</span>,
propertyName)); }</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>for</span> (<span>int</span>
itemIndex = 0; itemIndex &lt; <span>this</span>.Count;
itemIndex++)</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>bool</span> itemMatch&nbsp; = <span>true</span>;</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>for</span> (propertyIndex = 0; propertyIndex &lt;
properties.Count; propertyIndex++)</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>PropertyDescriptor</span> propertyDescriptor =
properties[propertyIndex];</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>object</span> value = values[propertyIndex];</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
itemMatch = propertyDescriptor.GetValue(<span>this</span>[itemIndex]).Equals(value);</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>if</span> (!itemMatch)</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>break</span>;</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>if</span> (itemMatch)</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>return</span> <span>this</span>[itemIndex];</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span>return</span> <span>null</span>;</span><o:p></o:p></p>

<p class=MsoNormal><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
}</span><o:p></o:p></p>

<p class=MsoNormal><span>Regards</span><o:p></o:p></p>

<p class=MsoNormal><br>
<br>
<o:p></o:p></p>

</div>

</div>



</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dg78 replied on Tuesday, January 19, 2010</h2><P class=MsoNormal><SPAN>Hi,<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>I reactivate this thread because I am in the same situation with the error described in the first post.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>I use the VB version CSLA 3.52 with VB 2008.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>The error :<SPAN>&nbsp;&nbsp; </SPAN>Specified method is not supported.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>occurs in SortedBindingList <o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN><SPAN>''' </SPAN><SPAN>&lt;summary&gt;<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN><SPAN>''' Implemented by IList source object.<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN><SPAN>''' </SPAN><SPAN>&lt;/summary&gt;<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN><SPAN>''' </SPAN><SPAN>&lt;param name="key"&gt;</SPAN><SPAN>Key value for which to search.</SPAN><SPAN>&lt;/param&gt;<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN><SPAN>''' </SPAN><SPAN>&lt;param name="property"&gt;</SPAN><SPAN>Property to search for the key<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN><SPAN>''' value.</SPAN><SPAN>&lt;/param&gt;<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN><SPAN>Public</SPAN> <SPAN>Function</SPAN> Find(<SPAN>ByVal</SPAN> [property] <SPAN>As</SPAN> System.ComponentModel.PropertyDescriptor, <SPAN>ByVal</SPAN> key <SPAN>As</SPAN> <SPAN>Object</SPAN>) <SPAN>As</SPAN> <SPAN>Integer</SPAN> <SPAN>Implements</SPAN> System.ComponentModel.IBindingList.Find<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN><SPAN>If</SPAN> _supportsBinding <SPAN>Then<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Return</SPAN> SortedIndex(_bindingList.Find([property], key))<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Else<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Return</SPAN> -1<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN><SPAN>End</SPAN> <SPAN>If<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN><SPAN>End</SPAN> <SPAN>Function<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>in <SPAN>&nbsp;</SPAN>the line<SPAN>&nbsp;&nbsp;&nbsp; </SPAN></SPAN><SPAN>Return</SPAN><SPAN> SortedIndex(_bindingList.Find([property], key))<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>What can I do to solve that issue ?<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Another question about SortedBindingList :<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>A SortedBindingList <SPAN>&nbsp;</SPAN>is a view of an original list. <o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>Is it possible to have directly only a list that we can sorted and bound to a datagridview without to have an original list ?<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Thanks<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Dominique<o:p></o:p></SPAN></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dg78 replied on Tuesday, January 19, 2010</h2><P class=MsoNormal><SPAN>I found a solution with some searchs in Google at <o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><A href="http://www.eggheadcafe.com/software/aspnet/31881441/sorting-bindinglist-based.aspx"><FONT color=#800080>http://www.eggheadcafe.com/software/aspnet/31881441/sorting-bindinglist-based.aspx</FONT></A> <o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>My original list was a BindingList :<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN><SPAN>Public</SPAN> <SPAN>Shared</SPAN> listRubSyst <SPAN>As</SPAN> <SPAN>New</SPAN> BindingList(<SPAN>Of</SPAN> htRubriExtension)<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>I create a subclass for BindingList :<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Public</SPAN><SPAN> <SPAN>Class</SPAN> BindingList2(<SPAN>Of</SPAN> T)<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN><SPAN>Inherits</SPAN> BindingList(<SPAN>Of</SPAN> T)<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN><SPAN>Protected</SPAN> <SPAN>Overloads</SPAN> <SPAN>Overrides</SPAN> <SPAN>ReadOnly</SPAN> <SPAN>Property</SPAN> SupportsSearchingCore() <SPAN>As</SPAN> <SPAN>Boolean<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Get<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Return</SPAN> <SPAN>True<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN><SPAN>End</SPAN> <SPAN>Get<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN><SPAN>End</SPAN> <SPAN>Property<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN><SPAN>Protected</SPAN> <SPAN>Overloads</SPAN> <SPAN>Overrides</SPAN> <SPAN>Function</SPAN> FindCore(<SPAN>ByVal</SPAN> prop <SPAN>As</SPAN> PropertyDescriptor, _<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>ByVal</SPAN> key <SPAN>As</SPAN> <SPAN>Object</SPAN>) <SPAN>As</SPAN> <SPAN>Integer<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN><SPAN>If</SPAN> prop <SPAN>Is</SPAN> <SPAN>Nothing</SPAN> <SPAN>Then<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Throw</SPAN> <SPAN>New</SPAN> ArgumentNullException(<SPAN>"prop"</SPAN>)<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN><SPAN>End</SPAN> <SPAN>If<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN><SPAN>For</SPAN> i <SPAN>As</SPAN> <SPAN>Integer</SPAN> = 0 <SPAN>To</SPAN> Count - 1<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Dim</SPAN> item <SPAN>As</SPAN> <SPAN>Object</SPAN> = <SPAN>Me</SPAN>(i)<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>If</SPAN> item <SPAN>IsNot</SPAN> <SPAN>Nothing</SPAN> <SPAN>AndAlso</SPAN> <SPAN>Object</SPAN>.Equals(key, prop.GetValue(item)) <SPAN>Then<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Return</SPAN> i<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>End</SPAN> <SPAN>If<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Next<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp; </SPAN><SPAN>Return</SPAN> -1<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN></SPAN><SPAN>End</SPAN><SPAN> <SPAN>Function<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>End</SPAN><SPAN> <SPAN>Class</SPAN></SPAN><SPAN><o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>And now the original list is :<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN><SPAN>Public</SPAN> <SPAN>Shared</SPAN> listRubSyst <SPAN>As</SPAN> <SPAN>New</SPAN> BindingList2(<SPAN>Of</SPAN> htRubriExtension)<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Now it is good. The error was in the BindingList.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>I don't understand why Microsoft doesn't correct such errors since so many times.<o:p></o:p></SPAN></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, January 19, 2010</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>dg78:</strong></div><div>
<P class=MsoNormal>
<P class=MsoNormal><SPAN><o:p></o:p></SPAN></P><SPAN>Now it is good. The error was in the BindingList.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>I don't understand why Microsoft doesn't correct such errors since so many times.<o:p></o:p></SPAN></P>
<P></div></BLOCKQUOTE></P>
<P>At this point in time I suspect this is very low priority for Microsoft. BindingList is only used by Windows Forms, and Windows Forms is a legacy technology. So it gets minimum maintenance, and no one should expect any changes beyond keeping it working as-is on new versions of .NET and Windows.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
