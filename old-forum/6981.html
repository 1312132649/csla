<html><header><title>WPF DataGrid Binding DataGridComboBoxColumn</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>WPF DataGrid Binding DataGridComboBoxColumn</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6981.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>MikeB posted on Wednesday, May 20, 2009</h2><P>I have a combo box with DepartmentList, each DepartmentBO object contains a list of activities. In the datagrid I have a DataGridComboBoxColumn that I need to be populated with the activities for the selected department. Any tips on how this can be accomplished?</P>
<P>Mike B</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MikeB replied on Thursday, May 21, 2009</h2><P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Alright, so trying to use the PTracker and the c#2008 book&nbsp;as a guide I have come up with the code below. The list of activities shows up in the DataGridCombo but this lists all activities. I need to show only those activitites contained in the currently selected department. Also, I don't know what to put in for Value or SelectedItem binding.&nbsp; Any help would be appreciated.</FONT></FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>UserControl.Resources</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&gt;</P></FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>csla</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>CslaDataProvider</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> x</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>Key</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="ActivityList"</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>ObjectType</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="{</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>x</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>Type</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> Inform</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>TimesheetActivityList</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>}"</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>IsAsynchronous</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="True"</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>FactoryMethod</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="GetAllActivities"</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>ManageObjectLifetime</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="True"&gt;</P></FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;/</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>csla</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>CslaDataProvider</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&gt;</P></FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>csla</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>ObjectStatus</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> x</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>Key</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="ActivityListStatus"</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>DataContext</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="{</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>StaticResource</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> ActivityList</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>}"/&gt;</P></FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;/</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>UserControl.Resources</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&gt;</FONT></FONT></P>
<P><FONT color=#000000 size=2>Here is the DataGridComboBoxColumn definition:</FONT></P><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>&lt;</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>dg</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>DataGridComboBoxColumn</FONT></FONT><FONT size=2><FONT color=#000000> </FONT></P>
<P></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>x</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>Name</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="ActivitiesCombo"</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>Header</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="Activity"</FONT></FONT><FONT size=2> </P>
<P></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>Width</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="*"</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>ItemsSource</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="{</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>Binding</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> Source</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>= {</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>StaticResource</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> ActivityList</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>}}"</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>SelectedItemBinding</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="{</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>Binding</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> Path</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>=TimesheetActivity}"</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>DisplayMemberPath</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="Name"/&gt;</FONT></FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#000000>Don't know if this is the correct way to do this, but in WF the workaround is to catch the EditControlShowing event and set the items source there. I did this using the PrepareCellForEdit event. </FONT></FONT></FONT></P><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>private</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>void</FONT></FONT><FONT size=2> PreparingCellForEdit(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2> sender, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>DataGridPreparingCellForEditEventArgs</FONT></FONT><FONT size=2> e)</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>if</FONT></FONT><FONT size=2> (e.Column </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>is</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>DataGridComboBoxColumn</FONT></FONT><FONT size=2>)</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT><FONT size=2>.ActivitiesCombo.ItemsSource =</P>
<P>(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT><FONT size=2>.cbDepartment.SelectedItem </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>as</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>DepartmentBO</FONT></FONT><FONT size=2>).TimesheetActivities;</P>
<P>}</P>
<P>}</P>
<P><FONT color=#000000>My only outstanding issue is that the current value is not displayed in the cells...... How do I bind the value to the cells? As you can see from the xaml above, I do set the path for the SelectedItemBinding.... Any help is appreciated!</FONT></P>
<P>Mike B</P></FONT></FONT></FONT></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fintanv replied on Thursday, May 21, 2009</h2><P>I use the Infragistics controls so my code is a little different, but it may point you in the right direction.&nbsp; The Field is the infragistics equiv of a column.&nbsp; The dataitem is the actual business object that is bound to the row.&nbsp; The business object contains a list of the available product families which is used to populate the combo for the field.</P><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>igDP</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>Field</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> Name</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="ProductFamilyName"</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> Label</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="{</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>x</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>Static</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> local</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>ModuleStrings</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>.ProductFamilyName}"&gt;</P></FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>igDP</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>Field.Settings</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&gt;</P></FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>igDP</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>FieldSettings</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> EditorType</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="{</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>x</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>Type</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> igEditors</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>XamComboEditor</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>}"&gt;</P></FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>igDP</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>FieldSettings.EditorStyle</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&gt;</P></FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>Style</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> TargetType</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="{</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>x</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>Type</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> igEditors</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>XamComboEditor</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>}"&gt;</P></FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>Setter</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> Property</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="ItemsSource"</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> Value</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="{</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>Binding</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> Path</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>=DataItem.ProductFamilies}" /&gt;</P></FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>Setter</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> Property</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="DisplayMemberPath"</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> Value</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="ProductFamilyName" /&gt;</P></FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>Setter</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> Property</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="ValuePath"</FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2> Value</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>="ProductFamilyName" /&gt;</P></FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;/</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>Style</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&gt;</P></FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;/</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>igDP</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>FieldSettings.EditorStyle</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&gt;</P></FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;/</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>igDP</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>FieldSettings</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&gt;</P></FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;/</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>igDP</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>Field.Settings</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&gt;</P></FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>
<P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;/</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>igDP</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>:</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>Field</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&gt;</P></FONT></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
