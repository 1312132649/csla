<html><header><title>PropertyDescriptor &amp; PropertyInfo</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>PropertyDescriptor &amp; PropertyInfo</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5455.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Justinraff posted on Wednesday, September 24, 2008</h2>Hello, <br /><br />This post is a bit of a sanity check before I begin tinkering with the CSLA framework. My ultimate goal is this: To programatically define PropertyDescriptor attributes for each property exposed by a CSLA class.<br /><br />Now, with the addition of the PropertyInfo class in the CSLA framework we have a PropertyInfo.FriendlyName property which is great. But unfortunately this isn't exposed through the PropertyDescriptor.DisplayName attribute - which would be perfection! I see another unanswered post on the forum asking about this from back in May (http://forums.lhotka.net/forums/thread/22599.aspx).<br /><br />My idea is then to extend the PropertyInfo class to include Category and Description, as well as the existing properties - and then to expose these as PropertyDescriptor attributes. <br /><br />Is this a reasonable or feasible suggestion?<br /><br />Regards, <br />Justin Rafferty.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, September 24, 2008</h2><P>Yes, though you don't need to change CSLA to do this. You can create a subclass of PropertyInfo&lt;T&gt; and just use your subclass instead of the CSLA class in all your RegisterProperty() calls:</P>
<P>private static MyPropertyInfo&lt;string&gt; = <BR>&nbsp; RegisterProperty(new MyPropertyInfo&lt;string&gt;(...));</P>
<P>This is an intentional extensibility technique, allowing you to attach extra metadata to properties.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Justinraff replied on Wednesday, September 24, 2008</h2>Wow, amazingly fast reply - thanks Rocky. So that's the best way to extend the PropertyInfo class explained.. very simple.<br /><br />Now, I would have thought that exposing the attribute might have been as easy as:<br /><br />[DisplayName(EmployeeIDProperty.FriendlyName)]<br />public int EmployeeID<br />        {<br />            get { return GetProperty(EmployeeIDProperty); }<br />            set { SetProperty(EmployeeIDProperty, value); }<br />        }<br /><br />But that doesn't seem to work. Sorry if this is a dumb .NET question opposed to something CSLA related.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, September 24, 2008</h2><P>I don't think .NET allows you to specify attribute parameters like that.</P>
<P>But it occurs to me that maybe you could go the other way, which would tie into this thread too<BR><A HREF="/forums/thread/22599.aspx">http://forums.lhotka.net/forums/thread/22599.aspx</A></P>
<P>Just thinking off the top of my head, but:</P>
<P>[DisplayName("Employee id")]<BR>public int EmployeeId<BR>...</P>
<P>Then have your subclass of PropertyInfo&lt;T&gt;, in its constructor, go get the display name using the PropertyDescriptor, and set the FriendlyName value using the display name.</P>
<P>This would incur the reflection overhead of using PropertyDescriptor when the PropertyInfo&lt;T&gt; object is created - but that happens just once per appdomain, so it shouldn't be that big a deal.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Justinraff replied on Wednesday, September 24, 2008</h2>The problem with going in that direction is that attributes cannot be set at runtime whereas PropertyInfo lends itself to that very well.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
