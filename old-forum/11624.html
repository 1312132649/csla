<html><header><title>CSLA 4.2 to CSLA 4.5 upgrade experience</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA 4.2 to CSLA 4.5 upgrade experience</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11624.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 posted on Thursday, October 04, 2012</h2><p>We have a pretty big Silverlight application.&nbsp; I just wanted to share our upgrade experience.&nbsp; It took me a couple of days overall.</p>
<p>Things I needed to refactor included -</p>
<p>CompressedProxy - some changes in that WcfProxy no longer is generic, and that the namespace changed - definitely recommend doing a little search on Hosts.Silverlight as it is now Hosts.Mobile.</p>
<p>There were places where we would override Save() to add a little &quot;pre-save&quot; logic (checking if anything like lock status of the record has changed or what have you).&nbsp; Save is no longer virtual, but SaveAsync is.&nbsp; </p>
<p>Any asynchronous behavior on the Silverlight side within the dataportal ended up needing to now be refactored to the async / await logic, as there is no longer callback handlers to basically inject your code before calling the callback.&nbsp; We used a lot of DP_Create(Csla.DataPortal.LocalProxy&lt;objecttype&gt;.CompletedHandler handler), but more of those were easy - just dropping the parameter and putting the [RunLocal] on the DP_Create.</p>
<p>The Security exception- Csla.Security.SecurityException - created a good amount of need to just qualify the namespace (especially within unit and integration tests).</p>
<p>OnChildChanged was a bit of a suprise that we needed to handle - sometimes we&#39;d do logic on &quot;hey, if any child changes, do stuff&quot;.&nbsp; If &quot;do stuff&quot; was meaningful, it was getting called 7 times for every child property change due to the meta proprties (IsValid, IsDirty, etc).&nbsp; How we end up working around this in our application is still in debate but for now we just added an &quot;IsStateProperty(propertyName)&quot; to our business object layer to be able to suppress OnChildChanged behavior when we wanted to.</p>
<p>At this point, we are able to run our application and have all 10,000+ tests running successfully.&nbsp; Looks like the upgrade went fine, though there is more testing yet to do.&nbsp; We haven&#39;t introduced the latest DP changes that have just been checked in but not part of an official beta yet.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, October 04, 2012</h2><p>That is a nice summary, thank you!</p>
<p>Here are some of my notes from upgrading various apps: </p>
<ul style="margin-top:0in;unicode-bidi:embed;direction:ltr;margin-bottom:0in;margin-left:0.375in;">
<li style="margin-top:0px;margin-bottom:0px;vertical-align:middle;"><span style="font-family:Calibri;font-size:11pt;">Silverlight ProxyModes is now gone, use RunLocal attribute instead</span></li>
<li style="margin-top:0px;margin-bottom:0px;vertical-align:middle;"><span style="font-family:Calibri;font-size:11pt;">Silverlight LocalProxy is no longer generic</span></li>
<li style="margin-top:0px;margin-bottom:0px;vertical-align:middle;"><span style="font-family:Calibri;font-size:11pt;">Silverlight DataPortal_XYZ methods no longer accept the callback handler parameter</span></li>
<li style="margin-top:0px;margin-bottom:0px;vertical-align:middle;"><span style="font-family:Calibri;font-size:11pt;">Silverlight DataPortal_XYZ methods can now be non-public</span></li>
<li style="margin-top:0px;margin-bottom:0px;vertical-align:middle;"><span style="font-family:Calibri;font-size:11pt;">Web.config &quot;.Silverlight&quot; data portal types must be changed to &quot;.Mobile&quot;</span></li>
<li style="margin-top:0px;margin-bottom:0px;vertical-align:middle;"><span style="font-family:Calibri;font-size:11pt;">.svc<span style="mso-spacerun:yes;">&nbsp; </span>&quot;.Silverlight&quot; data portal types must be changed to &quot;.Mobile&quot;</span></li>
<li style="margin-top:0px;margin-bottom:0px;vertical-align:middle;"><span style="font-family:Calibri;font-size:11pt;">Overrides of various &#39;Save&#39; methods are no longer available - only SaveAsync can be overridden</span></li>
</ul></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
