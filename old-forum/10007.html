<html><header><title>Undoing Undo</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Undoing Undo</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10007.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Mark Sulkowski posted on Monday, January 31, 2011</h2><p>I&#39;m reviewing CSLA, and I have concerns that CSLA might not&nbsp;scale&nbsp;well&nbsp;for large object graphs, since the N-Level Undo feature takes snapshots of property values, which may consume&nbsp;an&nbsp;inconvenient amount of&nbsp;time and memory.</p>
<p>I notice that the IUndoableObject interface is implemented by BusinessListBase, and the methods are simply declared as private.&nbsp; This suggests that it may be difficult to &quot;undo Undo&quot;.</p>
<p>Are there ways around using the Undo feature without tinkering with the CSLA code?&nbsp; Is there an easy way to deactivate or ignore the feature?</p>
<p>Also, what approaches have users successfully taken to write alternative Undo features of their own?&nbsp; For instance, has anyone written code to remember changes and undo only those, instead of relying on snapshots?&nbsp; Or perhaps taking a partial undo approach by only restoring deleted rows?</p>
<p>&nbsp;</p>
<p>Mark Sulkowski</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Monday, January 31, 2011</h2><p>You can &quot;turn off&quot; the BeginEdit, CancelEdit and ApplyEdit from IEditableObject by setting the flag</p>
<pre style="font-family:consolas;">DisableIEditableObject = true;<br /></pre>
<p>in your editable BOs construcor.</p>
<p>The CustomFieldData project from Jason Bock (also available at http://cslcontrib.codeplex.com) may be further enhanced to provide an alternate undo mechanism. It will keep the &quot;old&quot; values for comparison to determin if object is actually changed. </p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Mark Sulkowski replied on Monday, January 31, 2011</h2><p>Thanks.</p>
<p>Rockford Lhotka writes in <strong>Expert C# 2008 Business Objects</strong> that:</p>
<p>&quot;I don&#39;t recommend disabling the interface.&nbsp; If you disable it, data binding will not be able to interact with your object as it expects, and you may have to write extra UI code to compensate.&quot;</p>
<p>In what way would data binding go wrong?&nbsp; What would this extra UI code have to do in order&nbsp;to compensate?</p>
<p>&nbsp;</p>
<p>Mark Sulkowski</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Monday, January 31, 2011</h2><p><i>&quot;System.ComponentModel.IEditableObject Provides functionality to commit or rollback changes to an object that is used as a data source.<br />This interface is typically used to capture the <span><a href="http://msdn.microsoft.com/en-us/library/system.componentmodel.ieditableobject.beginedit.aspx">BeginEdit</a></span>, <span><a href="http://msdn.microsoft.com/en-us/library/system.componentmodel.ieditableobject.endedit.aspx">EndEdit</a></span>, and <span><a href="http://msdn.microsoft.com/en-us/library/system.componentmodel.ieditableobject.canceledit.aspx">CancelEdit</a></span> semantics&quot;</i></p>
<p>So this is one of the interfaces used by DataBinding<i>, </i>read mora about it in <a href="http://forums.lhotka.net/forums/AddPost.aspx/This%20interface%20is%20typically%20used%20to%20capture%20the%20BeginEdit,%20EndEdit,%20and%20CancelEdit%20semantics">DataBinding FAQ</a><i></i></p>
<p>Using DataBinding<i><b>:<br />* </b></i>before you enter the field calls BeginEdit<br />* if you pres ESC to cancel edit, calls CancelEdit<br />* If you press TAB and enters a new fiield that has CausesValidation = True , calls EndEdit before entering the new field<i> </i>( and a new DataBinding, repeat steps)<i></i></p>
<p>These calls happends &quot;behind the curtain&quot; as part of DataBinding. <i><br /></i></p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>ajj3085 replied on Tuesday, February 01, 2011</h2><p>Usually you end up with large object graphs because you&#39;re modeling you objects based on data and no use case.&nbsp; Will a user ever modify a property on 400 objects in a single graph?&nbsp; I really doubt it.&nbsp; Even once you got your model&#39;s properly matching your use case, there are times where you think all child objects must be part of the root, but they really don&#39;t.&nbsp; In Csla, you save the root, and it&#39;s children can never be saved independently; they&#39;re always saved within the context of the root.&nbsp; For example, I once had a Contact object with a ContactNotes collection.&nbsp; The notes always were part of the contact.&nbsp; I realized in time that this was an arbirtrary, notes didn&#39;t need to only be saved with a contact, each note could be created, edited and deleted completely indepedently.</p>
<p>I did it because a note was always <em>related</em> to a contact (ie. thinking in database terms), but my users don&#39;t care if a note&#39;s lifecycle is outside the contact&#39;s or not (in fact, they didn&#39;t use them nearly as often as changing the contact addresses and other information).</p>
<p>So before you think large graphs will be a problem, really think through.. do you even need such large graphs for any individual use case?&nbsp; Probably not.&nbsp; Uses only work with small sets of discrete information at a time typically.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
