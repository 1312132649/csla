<html><header><title>Model design</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Model design</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4070.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>meierk posted on Thursday, December 20, 2007</h2>I am a Delphi developer who is just learning .NET and I have a lot of confusion that I am trying to work out one piece at a time.&nbsp; I read the CSLA book about a year ago so I have some knowledge of the framework and concepts, but no practical experience with it.&nbsp; Hopefully you don't mind me vetting my class design with you.<br><br>I am working with an existing database that I cannot change and I will be working with the following tables and implyed relationships<br><br>Bend (a single Bend has only 1 or 2 BendDetails)<br>&nbsp;&nbsp; BendDetails (a single BendDetail has 1 to 9 Bend Readings and 0 to 9 Inspection Readings)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BendReadings<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BendInspReadings<br><br>From my tables I was going to create the following classes using CodeSmith:<br><ul><li><b>BendList</b> (ReadOnlyListBase/ReadOnlyRootList) - The main form in my application opens to a ReadOnly list of Bends that the user can filter and ultimately use to select a single Bend for editing.<br></li><li><b>Bend</b> (BusinessBase/EditableRoot) - would contain a collection of BendDetails</li><li><b>BendDetail</b> (BusinessBase/EditableChild) - would contain a collection of BendReadings and BendInsepction Readings.</li><li><b>BendDetails</b> (BusinessListBase/EditableChildList)</li><li><b>BendReading</b> (BusinessBase/EditableChild)</li><li><b>BendReadings</b> (BusinessListBase/EditableChildList)</li><li><b>BendInspectionReading</b> (BusinessBase/EditableChild)</li><li><b>BendInspectionReadings</b> (BusinessListBase/EditableChildList)</li></ul>My Winform application will have the following two forms for editing:<br><ol><li>The Bender form opens after the use selects a Bend to edit from the ReadOnly Bend list on the main form.&nbsp; It will have controls bound to the Bend class and two DataGridView controls bound to the BendDetails and BendReadings collections.&nbsp; The BendReadings is dependant on the BendDetails collection, meaning that it will change as the user selects a BendDetail in a grid.<br></li><li>The Quality Control form is similar to the Bender form, with the difference being that it uses the BendInspectionReadings collection instead of the BendReadings collection.<br></li></ol>Does the list of classes seem reasonable to you given the limited detail I have provided?<br><br>Kevin<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, December 20, 2007</h2><P>Kevin,</P>
<P>It looks exactly right to me. It should work well. Good luck with the project.</P>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>meierk replied on Friday, December 21, 2007</h2>Thanks for the reply Joe.&nbsp; One thing I haven't figured out yet is the data loading so hopefully you have some tips or insight for me.&nbsp; The code that the CodeSmith templates generate use Stored Procs to load the data.<br><br>Would you advise that the I use one stored proc that returns multiple result sets and have the parent pass the datareader to each collection or should I have a SP for each class and have them responsible for loading there own data?&nbsp; In my case, I will only load 29 rows max between Bend, BendDetails, BendReading and BendInspectionReadings.<br><br>Kevin<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, December 21, 2007</h2><P>Kevin,</P>
<P>I do not use SPs. I use dynamic SQL statements instead. But the concepts are the same. When their is a graph 2 levels deep (parent / child relationship) it is "obvious" that the parent should fetch itself and then pass the dr to the child to fetch it. </P>
<P>It gets a bit trickier when the graph is 3 or more levels deep. Just search for "grandchild" in this forum and you should see many hits. Rocky also has a "deep data" sample which handles this type of thing. So you can investigate that if the other options are not appealing to you.</P>
<P>1. I think some people retrieve a dataset that handles all the various relationshis and then they populate thier objects from that.</P>
<P>2. I use the method in the 1st paragraph for the first 2 levels. But when each child needs to fetch its grandchild I open a 2nd connection and create a new datareader and pass it in. This technique is acceptable to me. I have not had any performance issues related to it. Some may object to the chattiness - but it is not flatteing the hierarchy and bringing back "too much data" either. So there are trade offs in both approaches.</P>
<P>Joe</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
