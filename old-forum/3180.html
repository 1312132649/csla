<html><header><title>Business Object Best Practices</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Business Object Best Practices</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3180.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dantruj posted on Thursday, July 12, 2007</h2><P>I apologize if this is not the correct forum (csla) to discuss basic business objects, but I have searched the web to find some answers to my question and have not been able to.&nbsp; That said, here is my question.</P>
<P>The UI has a list box that should display persons who's records are active = true.&nbsp; As the business developer I have provided a businesslist object which returns a list of persons filtered by Active = true.&nbsp; In the UI the record is saved with the person (who is currently active)&nbsp;selected from the list box.&nbsp; The problem arises when in the UI through some administration screen the Person is made inactive (left the company lets say).&nbsp; Now through the UI we go back to the screen where the list box and where the person (who is now inactive) was set.&nbsp; Since the list box only shows active persons, and the list.SelectedValue is set to the inactive person an error will be thrown.&nbsp; </P>
<P>Here is my question:</P>
<P>The UI people say that I should provide from the business layer a PV that returns a list of active persons and the inactive person item.&nbsp; They want&nbsp; a method which accepts a parameter to pass in the inactive person's ID so that I can append to the list.&nbsp; I disagree with this approach, I believe the business object should not change anything and return the list of active persons.&nbsp; It is up to the UI to know that this record is inactive and append to the listbox items list.&nbsp; The only thing that I feel the Business layer should do is throw an error if the record is being saved with a person who is no longer active.&nbsp; </P>
<P>What do you all think?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, July 12, 2007</h2><P>This is a common issue, and is relatively difficult to solve in a distributed setting (at least if you value scalability and reliability).</P>
<P>Technically, of course, it is virtually <EM>impossible</EM> to solve due to a concurrency issue. In other words, the potential for an exception is <EM>always there</EM>. Consider the case where user A is editing the person, while user B makes them inactive. This is <EM>after</EM> user A is past selecting the person from your filtered list...</P>
<P>On a single machine it is pretty easy to have the list know it is invalid when the admin screen is used, because you can use a simple observer pattern with an event for notification. This sounds like what you are being asked to do, and it really isn't that hard (though it should be done through events, not through a hard-coded method call).</P>
<P>Across a network, however, it is quite difficult to do event notifications in a way that scales and is reliable... Some people do tackle this problem, but most people find it too expensive to solve and choose to live with the occasional exception.</P>
<P>In the end, it <EM>is</EM> a solvable problem, but it is a business decision as to whether the short and long term costs of solving it can be justified by the business value of having a better user experience.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, July 12, 2007</h2><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>dantruj:</strong></div><div>The UI people say that I should provide from the business layer a PV that returns a list of active persons and the inactive person item.&nbsp; They want&nbsp; a method which accepts a parameter to pass in the inactive person's ID so that I can append to the list.&nbsp; I disagree with this approach, I believe the business object should not change anything and return the list of active persons.&nbsp; It is up to the UI to know that this record is inactive and append to the listbox items list.&nbsp; The only thing that I feel the Business layer should do is throw an error if the record is being saved with a person who is no longer active. </div></BLOCKQUOTE><br><br>I this is a UI issue.&nbsp; The UI should build the merged list, and the business layer should provide a means to do so.&nbsp; So you may have a Person list, with an inactive flag.&nbsp; The BO should ONLY be valid if the person selected has its Active flag set to true.&nbsp; You'll need a way to get an inactive person though, likely via the person's id.<br><br>Your BO must also do as Rocky says, and check just before updating the record that the person refernce is still an active person.&nbsp; I believe if you start a transaction, select the person's most current data and check it, that you will lock the person record until your transaction completes.&nbsp; <br><br>HTH<br>Andy<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
