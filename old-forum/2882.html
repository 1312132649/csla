<html><header><title>Returning a record count after Delete of Businessobject</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Returning a record count after Delete of Businessobject</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2882.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Mahmud posted on Wednesday, May 16, 2007</h2><P>In our business class we want the following functionality - </P>
<P>In the DELETE button click event, we first delete the oject by calling</P>
<P>WorkorderBusinessClass.DeleteWorkorder(int id)</P>
<P>Immediately after the method returns we want to check whether the delete was successful. But, as the method is&nbsp;static - we cannot return any value. We have&nbsp;set one property in &nbsp;the class 'boolen RecordsAffected' which can hold how many records were affected by the last query. But as the Delete method is static, we cannot set the value.</P>
<P>We need this, because - based on succss of the operation- we will set some visual cues in the form, and also delete&nbsp;a tree node corresonding the object.</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, May 16, 2007</h2><P>If the call returns without an exception then you know it succeeded so you can proceed from there.</P>
<P>Use a Try Catch block and call Delete.If there is no exception, set your visual cues and delete the tree node.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Mahmud replied on Thursday, May 17, 2007</h2><P>This is not true in all scenario. If you send a DELETE SQL to any database, and if no record is deleted due to any reason (say, criteria mismatch) - then its not an error. So, just after the delete command inside the database - you have to return ROWCOUNT (in case of Oracle). Then out from the stored procedure - you have to check how many records were affected by the last query. </P>
<P>So, I do have the need to return a record count to front end - somehow. Anyone have any other idea?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Thursday, May 17, 2007</h2>You can either raise an error from the sproc or read the count in your DataPortal_Delete and if it's 0, then throw an exception.<br><br>Andr√©s<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
