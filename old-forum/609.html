<html><header><title>Csla Reflection Code</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Csla Reflection Code</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/609.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai posted on Wednesday, July 12, 2006</h2><P>Hi guys.</P>
<P>I'm trying to call a static method dynamically and found this code in the Csla MethodCaller class.</P>
<P>&nbsp;&nbsp;&nbsp; public static object CallMethod(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object obj, MethodInfo info, params object[] parameters)<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // call a private method on the object<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object result;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = info.Invoke(obj, parameters);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception e)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw new Csla.Server.CallMethodException(<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; info.Name + " " + Resources.MethodCallFailed, e.InnerException);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return result;<BR>&nbsp;&nbsp;&nbsp; }</P>
<P>What caught my attention is the parms object[] part as I had not seen it before.&nbsp; The method I am trying to invoke is actually a Csla Factory method on one of my business objects.&nbsp; I have all the parameters in a criteria object and so I wrote a method, using the example above, like this:-</P>
<P>public object CallMethod(MethodInfo info, params object[] parameters)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return info.Invoke(null, parameters);<BR>}</P>
<P>The static method I am trying to invoke takes one parameter, a Guid.&nbsp; If I step into this code I can see I have a valid MethodInfo for the method, and the parameters parameter is correctly identified as MyObject.Criteria.&nbsp; I can drill down into that and see that the array is one dimension deep and contains a Guid.&nbsp; However, the code spits out an error that it cannot convert an object of type&nbsp;MyObject.Criteria to a Guid.&nbsp; The Csla code works great, and everything I can find on this way of calling a method seems to indicate that what I have done should work.&nbsp; So anyone out there know why it blows up?</P>
<P>TIA.</P>
<P>Final thought:&nbsp; I just made a quick Test rig to Test this outside my project and get the same result.&nbsp; Please see attached code.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dean replied on Thursday, July 13, 2006</h2>I don't see any attached code. I want to see how you construct you info object.<br><br>Dean<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai replied on Friday, July 14, 2006</h2>Weird!&nbsp; I definitely attached it but it seems it has gone.&nbsp; Anyway, I figured out that I wasn't thinking straight.&nbsp; The Factory method I was trying to invoke doesn't take a criteria object but a parameter of type Guid.&nbsp; Therefore I was never going to invoke it by passing it a Criteria object containing a Guid.&nbsp; The Csla invokes DataPortal methods within the Business Objects by using this technique, but that works because they expect a Criteria object.&nbsp; The Csla does not invoke the static methods this way, it is the static methods that end up invoking the DataPortal methods!&nbsp; Thanks for showing an interest though!</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
