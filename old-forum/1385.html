<html><header><title>Suggestion for a change to CslaDatasource</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Suggestion for a change to CslaDatasource</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1385.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>mtavares posted on Wednesday, October 04, 2006</h2>Hi Rocky,<br><br>Yesterday, I posted an issue with passing an empty BO to a Detailsview so that the detailsview would know the BO is empty and act accordingly.&nbsp; You can view that post here:&nbsp; <br><br><a HREF="/forums/thread/7120.aspx">http://forums.lhotka.net/forums/thread/7120.aspx</a><br><br>After some digging I think I have come up with a possible solution, in regards to changing some code in the ExecuteSelect method of the CslaDatasource.<br><br>&nbsp;The original code had the following:<br><br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ' if the result isn't IEnumerable then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ' wrap it in a collection<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not TypeOf result Is IEnumerable Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim list As New ArrayList<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; list.Add(result)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = list<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br><br><br>Now
with the original code if result (the BO) is nothing, then when the
control is bound to the detailsview an error occurs.&nbsp; But if I change
it to:<br><br>&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ' if the result isn't IEnumerable then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ' wrap it in a collection<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not TypeOf result Is IEnumerable Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim list As New ArrayList<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If result IsNot Nothing Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; list.Add(result)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = list<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br><br>Then
I get the results I was looking for.&nbsp; the Details view will return the
Empty Data Row because it is looking at an empty ArrayList instead of
an arraylist with one item set to nothing.&nbsp; I decided to test this same
thing out with a collection based BO with a gridview, and the results
were still good where the Empty Data Row for the gridview was
displayed.&nbsp; I also tried a bound dropdownlist and it was still ok.<br><br>So
that being said, do you see any
repercussions with only adding the result to the list if it is not
nothing?&nbsp; My tests seemed to be fine, but I may not be accounting for
something.<br><br>Thanks,<br>Mike<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, October 04, 2006</h2>That makes good sense, and I think you have hit on the correct answer here - thanks! I'll change this for the next version (probably 2.1.1).</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Skafa replied on Wednesday, October 04, 2006</h2>Cool hack. thank you, I'm bookmarking this...<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
