<html><header><title>inheritance, design question</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>inheritance, design question</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5306.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>pillesoft posted on Wednesday, August 27, 2008</h2>Dear All,<br><br>in my application i'm using a ReadOnlyList with a ReadOnlyBase inherited business object<br>this is normally displayed in a grid<br><br>and there is another class implementation inherited from BusinessBase, which means the same object, but this is not readonly<br><br>when a user select a row in a grid to modify, or wants to add a new object a dialog form is opened to display the fields, and here the BusinessBase inherited object is bounded.<br>the user saves the modification, the dialog form is closed, and the grid is refreshed, now containing the new, or modified record<br><br>this is how i planned to use<br><br>actually for a special case there are some methods which should have the same code, (like Fetch).<br>how can i design my classes?<br><br>i need a base class, which contains the common methods, then one class should inherit from ReadOnlyBase, other is from BusinessBase.<br><br>thank you<br>Ivan<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>richardb replied on Wednesday, August 27, 2008</h2>If you have some objects that need to implement the same methods and/or properties, from what you describe sounds to me like you could use Interfaces.&nbsp;Create an interface that defines the common stuff and&nbsp;then your two business objects can just&nbsp;implement that interace.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pillesoft replied on Wednesday, August 27, 2008</h2>yes, but as i know interface only defines methods<br>i mean the common methods needs to coded physically twice<br>&nbsp;<br>one of the advantage would be less code, and better source handling <br><br>Ivan<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, August 27, 2008</h2>What methods are coding twice?&nbsp;&nbsp; If you're talking about loading an instance, create an internal third class that can load the common parts of both objects.&nbsp; Your read only and edit objects can implement a common, internal interface.&nbsp; <br><br>But remember, re-use isn't a goal, because re-use is another word for coupling, and that is something you should usually try to avoid.&nbsp; Coupling can lead to less maintainable code, meaning more problems later.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pfeds replied on Wednesday, August 27, 2008</h2><P>What methods does your read-only object class need to implement?&nbsp; In most cases a read-only class will read in data and display it, without any real need to implement&nbsp;that many&nbsp;methods. Still, this isn't always the case and there are a number of ways you could go about it.&nbsp; What you don't want is to duplicate logic.</P>
<P>Food for thought:</P>
<P>1) A Person class could have a method CombHair();&nbsp; Just say you have a PersonInfo class, you could provide a method on it to delegate to the full fat Person class:</P>
<P><FONT face="Courier New" size=2>public void CombHair()</FONT></P>
<P><FONT face="Courier New" size=2>{</FONT></P>
<P>&nbsp;&nbsp;&nbsp;<FONT face="Courier New" size=2>Person person = Person.GetPerson(this.id);</FONT></P>
<P>&nbsp;&nbsp;&nbsp;<FONT face="Courier New" size=2>person.CombHair();</FONT></P>
<P><FONT face="Courier New" size=2>}</FONT></P>
<P>You need to think whether that is necessary.&nbsp; A button on your UI grid of Person objects could just as easily do the same.</P>
<P>2) If necessary you can expose the CombHair method as a static method on Person, and then call it from PersonInfo.</P>
<P>3) You could create another class to house the common methods.</P>
<P>4) ...etc</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pillesoft replied on Thursday, August 28, 2008</h2>Dear All,<br><br>thanks for the replies<br>for the complete reference i attach the two classes.<br>as you can see the data access (read from db) is the same for both.<br><br>but as i'm new to c# and clsa any comments are welcome.<br><br>Ivan<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pfeds replied on Thursday, August 28, 2008</h2><P>It looks fine to me. Personally I would leave the Fetch methods as they are.&nbsp; You're not really duplicating a lot of code, and with this kind of object modelling you do get some overlap.</P>
<P>You could create an internal method on the Section class to handle the fetch, and then call it from the read-only object BUT what if somebody modifies that code specifically for Section - that could break your SectionRO.</P>
<P>Potentially the stored procedure for Section will be expanded to read in multiple result sets (infact it looks like it may already do so?).&nbsp; With your read-only object you don't really want this additional overhead, especially if you're reading a large amount of SectionRO objects into a list. With that in mind it's likely you could want two different stored procedures, therfore making the two fetch methods different <img src="/emoticons/emotion-5.gif" alt="Wink [;)]" /></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pfeds replied on Thursday, August 28, 2008</h2><P>It looks fine to me. Personally I would leave the Fetch methods as they are.&nbsp; You're not really duplicating a lot of code, and with this kind of object modelling you do get some overlap.</P>
<P>You could create an internal method on the Section class to handle the fetch, and then call it from the read-only object BUT what if somebody modifies that code specifically for Section - that could break your SectionRO.</P>
<P>Potentially the stored procedure for Section will be expanded to read in multiple result sets (infact it looks like it may already do so?).&nbsp; With your read-only object you don't really want this additional overhead, especially if you're reading a large amount of SectionRO objects into a list. With that in mind it's likely you could want two different stored procedures, therfore making the two fetch methods different <img src="/emoticons/emotion-5.gif" alt="Wink [;)]" /></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pillesoft replied on Thursday, August 28, 2008</h2>thank you for your opinion of this kind of solution.<br><br>after making some stress test i might change the two objects Fetch method, but as i see today there cannot be a large number of sections in a workpack.<br><br>anyway thanks again<br>Ivan<br><br><br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
