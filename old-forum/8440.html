<html><header><title>Expected Transaction Behavior (SQL Server 2000)?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Expected Transaction Behavior (SQL Server 2000)?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8440.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>cmay posted on Saturday, January 30, 2010</h2>I used code generation to create a large number of business objects.  In the "Save" of these business objects, the procedure is wrapped in a TransactionalTypes.TransactionScope attribute.<br /><br />I use the ConnectionManager and do all my save work inside the using block.<br /><br />All was well.<br /><br />Then today we deployed an app that at times talks to a SQL Server 2000 machine (in develoment, these databases are all run on 2008) and the transactions started failing all over the place.<br /><br />Transactions are failing becaues MSDTC trans are being created and MSDTC doens't work in this environment.<br /><br />So my question is 2 fold:<br />1) Should a connection to a SQL Server 2000 database, from inside a method with the TransactionalTypes.TransactionScope attribute, automatically create attempt an MSDTC transaction, even if it is the first connection to the DB?<br /><br />2) Is there anyway to change the TransactionalTypes.TransactionScope value from within code?  What I mean is lets say you have a method with that attribute which calls another method, and before the DB connection is opened, you run some line of code that basically cancels out the attribute so that no transaction is created.  Is there anything like that?<br />Thanks!<br />Chris</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Saturday, January 30, 2010</h2><P>I don't think System.Transactions fully supports SQL 2000.</P>
<P>Please remember that CSLA doesn't implement any transactional behavior - it is simply tapping into the existing .NET transactional models (TransactionScope or Enterprise Services). So whatever you can or can't do with System.Transactions.TransactionScope is what you can do in CSLA when using that technology.</P>
<P>If you want runtime control over your transactional model, you need to tell CSLA you want Manual transactions, and then implement the transactional behavior in your code.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tetranz replied on Saturday, January 30, 2010</h2><P>For what it's worth, I'm successfully using System.Transaction with SQL 2000 using the technique describe&nbsp;here.&nbsp;<A href="http://blogs.msdn.com/florinlazar/archive/2005/09/29/475546.aspx">http://blogs.msdn.com/florinlazar/archive/2005/09/29/475546.aspx</A></P>
<P>Some helpful person pointed me there a few years ago <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /></P>
<P><A href="http://www.lhotka.net/Article.aspx?id=39c79955-ddc9-42c7-a657-d5c2ed49975e">http://www.lhotka.net/Article.aspx?id=39c79955-ddc9-42c7-a657-d5c2ed49975e</A></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Saturday, January 30, 2010</h2><P>OK, so I'm getting old, don't remind me! <img src="/emoticons/emotion-10.gif" alt="Embarrassed [:$]" /></P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
