<html><header><title>How to catch a newly added Item to a list.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How to catch a newly added Item to a list.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9860.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>pgroenenstein posted on Saturday, December 11, 2010</h2><p>Hi </p>
<p>Background: Developing a Silverlight App with CSLA 3.8.4</p>
<p>I have an &quot;<b>Order</b>&quot; object (Inherits from BusinessBase) , which contains a List Object named &quot;<b>OrderItems</b>&quot; (Inherits from BusinessListBase)&nbsp; with it&#39;s childs named &quot;<b>OrderItem</b>&quot; (Inherits from BusinessBase).</p>
<p>What I need to know is how would one &quot;Catch&quot; a newly added child (&quot;<b>OrderItem) </b>to the list object (&quot;<b>OrderItems&quot;)&nbsp;</b> in the Parent object&nbsp; (&quot;<b>Order</b>&quot;) as well as how to catch that in the UI (an SL 3 App)?</p>
<p>Another part of the problem is, how does one see in the &quot;parent&quot; (&quot;<b>Order</b>&quot;) object that a child(&quot;<b>OrderItem</b>&quot;) was removed in the list (&quot;<b>OrderItems</b>&quot;) object&nbsp; I need to know in the parent when the deleting of a child was completed successful, in order to do sum stuff in the parent object.</p>
<p>Thanks</p>
<p>Phillip</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Saturday, December 11, 2010</h2><p>The OrderItems list has an event called ListChanged and the Event parameter gives you the reason (added/removed/changed) and the index of the item in the list. You can hook in here to get a newly added item.&nbsp; </p>
<p>The Order object also has a ChildChanged event that you should look into. I&#39;d place the sum stuff into this event. I can&#39;t remember right now if this event will also give you the objecttype/property and reason but look into it and keep us updated.</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pgroenenstein replied on Saturday, December 11, 2010</h2><p>Thanks Jonny for your help.</p>
<p>Here is my solution for others that might want to know the same thing.</p>
<p>This code resides in my root object Named &quot;Order&quot;, because the ChangeEvents cascades all the way up to the Root object (I<span>As long as your
child objects are in a collection, or are referenced through a managed backing
field )</span></p>
<p>The <b>important </b>thing to remember here is that the code in your Client Business Object&nbsp; would need to be different between a Silverlight App and a&nbsp; &quot;normal&quot; dotNet Appt, hence the <b>Complier Directive</b> for Silverlight. (Of course if you make use of partial classes you won&#39;t need the directive, I personally prefer compiler directives.)</p>
<p>The &quot;first&quot; part of the sub can be the same for both Silverlight and the .Net Client.The difference is in the &quot;second&quot; part since the Silverlight Client do not have access to the &quot;<span> ListChangedEventArgs&quot; but rather the &quot;</span><span>CollectionChangedEventArgs&quot;</span></p>
<p><span>The difference is how the Case Block (right under the comment </span><span>&quot;Handle List Object changes here.&quot;)</span><span> is structured in the second part,<br /></span></p>
<p><i><b>#If SILVERLIGHT Then</b><br />&nbsp;&nbsp;&nbsp; <b>&#39; Silverlight only.</b><br />&nbsp;&nbsp;&nbsp; <b>Protected Overrides Sub OnChildChanged(ByVal e As ChildChangedEventArgs)</b><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39; Re-Raise to UI<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyBase.OnChildChanged(e)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If e.PropertyChangedArgs IsNot Nothing Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39; a Poperty has changed<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Select Case e.PropertyChangedArgs.PropertyName<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case &quot;LineTotal&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39; a Propery named &quot;LineTotal&quot; on a Child of the List Object has changed, if need be do some stuff here on the Root Object.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RecalcTotals()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Select</i></p>
<p><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else</i></p>
<p><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39;<b> Handle List Object changes here.</b><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If e.ChildObject.ToString() = &quot;SmtSelfOrder.Business.BusinessClasses.OrderItems&quot; Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39;Check Type of Action on list<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Select Case e.ListChangedArgs.Action<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case Collections.Specialized.NotifyCollectionChangedAction.Add<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39; Do stuff here you want to do when Adding a Child to the List object.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RecalcTotals()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case Collections.Specialized.NotifyCollectionChangedAction.Remove<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39; Do stuff here you want to do when Deleting a Child from the List object.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RecalcTotals()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Select<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br /><br />&nbsp;&nbsp;&nbsp; <b>End Sub</b><br /><br /><b>#Else<br />&nbsp;&nbsp;&nbsp; &#39; .Net Only<br /></b>&nbsp;&nbsp;&nbsp; <b>Protected Overrides Sub OnChildChanged(ByVal e As ChildChangedEventArgs)</b><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39; Re-Raise to UI<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyBase.OnChildChanged(e)<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If e.PropertyChangedArgs IsNot Nothing Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39; a Poperty has changed<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Select Case e.PropertyChangedArgs.PropertyName<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case &quot;LineTotal&quot;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39; a Propery named &quot;LineTotal&quot; on a Child of the List Object has changed, if need be do some stuff here on the Root Object.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RecalcTotals()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Select</i></p>
<p><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else</i></p>
<p><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39;<b> Handle List Object changes here.</b><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If e.ChildObject.ToString() = &quot;SmtSelfOrder.Business.BusinessClasses.OrderItems&quot; Then<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39;Check Type of Action on list<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Select Case e.ListChangedArgs.ListChangedType<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case ListChangedType.ItemAdded<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39; Do stuff here you want to do when on Adding a Child to the List object.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RecalcTotals()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Case ListChangedType.ItemDeleted<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39; Do stuff here you want to do when Deleting a Child from the List object.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RecalcTotals()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Select<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br /><br />&nbsp;&nbsp;&nbsp; <b>End Sub</b><br /><br /><b>#End If</b><br /></i></p>
<p>&nbsp;</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
