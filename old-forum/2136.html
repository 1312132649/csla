<html><header><title>PTIdentity and my own properties (MemberID)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>PTIdentity and my own properties (MemberID)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2136.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ballistic posted on Friday, January 12, 2007</h2>Hello,<BR><BR>I woud like to add a memberID to PTIdentity since I will be looking up members based on their ID, and not their username.<BR><BR>There is an "IIdentity" region in the PTIdentity.vb file, which is where I think I need to add my memberID property.&nbsp; However, I do not know if I'm suppose to match it up to the IIdentity interface.&nbsp; Rocky's 3 properties AuthType, IsAuth, and Name() all implement the interface:<BR><FONT color=#0000ff size=2>
<P>Implements</FONT><FONT size=2> System.Security.Principal.IIdentity.XXXX</P></FONT>So first off, I am not sure if I can add my own property.&nbsp; <BR><BR>Second, if I do, am I suppose to match it to a property in the interface.&nbsp; <BR><BR>And finally, how would I access this custom property from my library?<BR><BR>Thank you,<BR><BR>- Andy</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, January 12, 2007</h2><P>You can't alter IIdentity - that's a .NET interface. However, you can add your own public properties to your custom identity class - that's no problem.</P>
<P>The slight wrinkle to this, is that all the .NET API's return IIdentity, so you need to always cast the identity object to your custom identity type to get at your property, like:</P>
<P>x = CType(Csla.ApplicationContext.User.Identity, MyCustomIdentity).CustomProperty</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fsjohn replied on Monday, February 23, 2009</h2>Hi,<br><br>I am getting the following error:<br><br>Unable to cast object of type 'CSLA.Security.BusinessIdentity' to type 'MyCustomIdentity'.<br><br>Thanks<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fsjohn replied on Thursday, March 05, 2009</h2>Hi,<br><br>I am getting the following error:<br><br>Unable to cast object of type 'CSLA.Security.BusinessIdentity' to type 'MyCustomIdentity'.<br><br>Thanks</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong replied on Thursday, March 05, 2009</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>fsjohn:</strong></div><div>Hi,<BR><BR>I am getting the following error:<BR><BR>Unable to cast object of type 'CSLA.Security.BusinessIdentity' to type 'MyCustomIdentity'.<BR><BR>Thanks</div></BLOCKQUOTE></P>
<P>John,</P>
<P>U&nbsp;should post a new thread on this forum and in that thread&nbsp;explain exactly what goes wrong while debugging. Include a call stack and even better the code of your class.</P>
<P>Greetings,<BR>Raymond de Jong</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fsjohn replied on Tuesday, March 10, 2009</h2>Hi Raymond,<br>thanks for getting back. <br><br>The  Call Stack does not show anything, just the current call.<br>I noticed that even if I use the original class (PTIdentity) without adding any custom property, I am still unable to cast CSLA.Security.BusinessIdentity to type PTIdentity.<br><br>Cheers,<br>Omar<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fsjohn replied on Tuesday, March 10, 2009</h2>Hi,<br><br>ProjectTracker20vb Solution:<br>PTWin project:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Debug.Print(CType(Csla.ApplicationContext.User.Identity, Security.PTIdentity).Nick)<br><br>(While debugging Csla.ApplicationContext.User.Identity = {ProjectTracker.Library.Security.PTIdentity} before Casting)<br><br>Casting OK!!!<br>
<br><br><br>MySolution:<br>MyUserControl Project:<br><br>Debug.Print(CType(Csla.ApplicationContext.User.Identity,MyCompany.Security.MyIdentity).Name)<br><br>(While debugging Csla.ApplicationContext.User.Identity = {CSLA.Security.BusinessIdentity} before Casting)<br>
<br>Casting NO WORKING!!!<br><br>Do you know why I am getting Csla.ApplicationContext.User.Identity = {CSLA.Security.BusinessIdentity} instead of Csla.ApplicationContext.User.Identity = {MyCompany.Security.MyIdentity}<br><br>The Login is working properly:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim principal As New MyPrincipal(identity)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Csla.ApplicationContext.User = principal<br><br>At this point Csla.ApplicationContext.User.Identity = {MyCompany.Security.MyIdentity}<br>It seems Csla.ApplicationContext.User has changed somewhere.<br><br>Thanks,<br>Omar<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fsjohn replied on Tuesday, March 10, 2009</h2>I found the issue!!!<br><br>I am using CSLA1 and CSLA2 so when the user login I do both authentication, CSLA2 first and the CSLA1. <br>So my "last" CSLA.ApplicationContext.User was based on CSLA1.<br><br>Cheers...<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong replied on Tuesday, March 10, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>fsjohn:</strong></div><div>I found the issue!!!<br><br>I am using CSLA1 and CSLA2 so when the user login I do both authentication, CSLA2 first and the CSLA1. <br>So my "last" CSLA.ApplicationContext.User was based on CSLA1.<br><br>Cheers...<br><br></div></BLOCKQUOTE><br /><br />Great ;)</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
