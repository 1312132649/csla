<html><header><title>XML Schema used by CSLAXML.cst</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>XML Schema used by CSLAXML.cst</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1052.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Frenchie posted on Monday, August 28, 2006</h2><P>Hi Guys,</P>
<P>I might be missing something pretty obvious, but can somebody point me to the schema used when passing an xml file to the CslaXML.cst template. I looked at the sample xml file given (MySample.xml) but would like to see every possible element.</P>
<P>Thanks!</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rasupit replied on Wednesday, August 30, 2006</h2><P>Frenchie,</P>
<P>Currently, there is no schema to support xml data source.&nbsp; I have been&nbsp;trying to create one by using xml spy (I have an old version 4.4) but have not be able to complete it.&nbsp; I have not done schema by hand so I have a little bit of learning cure here.&nbsp; </P>
<P>Hopefully i can get that soon. In the meantime, you may need to look inside the code under LoadFromXml method.</P>
<P>Ricky</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>bbakermai replied on Thursday, September 21, 2006</h2><P><FONT face=Verdana size=2>First of all, thanks so much for all your hard work on the 2.0 CS templates. They are awesome!</FONT></P>
<P><FONT face=Verdana size=2>In this thread, are you essentially saying that you generated the provided sample, MySample.xml by hand? I've been looking at EMS Data Export, XML Spy, and other tools&nbsp;to try to automatically (i.e., using a tool) get base SQL Server 2005 table metadata into an XML file. Than I could hand edit and macro edit that file with UltraEdit into an acceptable input source for the CSLAXML.cst template. I feel like I'm missing something stupid, like not entering the right keywords into a Google search &lt;g&gt;.</FONT></P>
<P><FONT face=Verdana size=2>Again, thanks to you and all of the contributors for the templates.</FONT></P>
<P><FONT face=Verdana size=2>Bob Baker</FONT></P>
<P><FONT face=Verdana size=2>P.S. Here's my take based on something I found on the net:</FONT></P><FONT face=Verdana size=2><FONT color=#008000 size=2>
<P><FONT color=#000000>/* </FONT></P>
<P><FONT color=#000000>Purpose: T-SQL to create Data Dictionary <BR>Created by: Joel Reinford <BR>Date Created: Mar-4-2006 <BR>Modified by: Bob Baker for CSLA XML first-cut generation<BR>Date Modified: Sep-22-2006<BR>Note: Some of this information can be obtained from the INFORMATION_SCHEMA views <BR>Select c.* from INFORMATION_SCHEMA.COLUMNS c <BR>Select t.* from INFORMATION_SCHEMA.TABLES t </FONT></P>
<P><FONT color=#000000>*/ </FONT></P>
<P><FONT color=#000000>DECLARE @DataDictionary table( <BR>RowID [int] identity(1,1) primary key <BR>,TableName [varchar](200) <BR>, ColumnName [varchar](200) <BR>, OrdinalPosition int <BR>, ColumnDefault [varchar](200) <BR>, IsNullable [bit] <BR>, DataType [varchar](20) <BR>, CharacterMaximumLength int <BR>, IsIdentity [varchar](5) --[bit] <BR>, IsPrimaryKey [bit] <BR>, IsForeignKey [bit] <BR>, ReferencedTableName [varchar](200) <BR>, ReferencedColumnName [varchar](200) <BR>, ObjectDescription [varchar](500) <BR>) </FONT></P><FONT color=#000000>
<P><BR>DECLARE @TableList table( <BR>RowID [int] identity(1,1) primary key <BR>,TableCatalog [varchar](200) <BR>,TableSchema [varchar](200) <BR>,TableName [varchar](200) <BR>,TableType [varchar](20) <BR>,ObjectDescription [varchar](500) <BR>) </P>
<P>DECLARE <BR>@RowNumber int <BR>, @RowCount int <BR>, @TableName varchar(255) <BR>, @ObjectDescription varchar(500) </P>
<P><BR>--create a temp table to hold the primary keys <BR>--can't do INSERT EXEC with a table variable <BR>IF object_id('tempdb..#PkColumns') is not null <BR>BEGIN <BR>DROP TABLE #PkColumns <BR>END </P>
<P>CREATE TABLE #PkColumns ( <BR>RowID [int] identity(1,1) primary key <BR>,table_Qualifier varchar(255) NOT NULL <BR>, owner_name varchar(255) NOT NULL <BR>, table_name varchar(255) NOT NULL <BR>, column_name varchar(255) NOT NULL <BR>, key_seq varchar(255) NOT NULL <BR>, Pk_Name varchar(255) NOT NULL <BR>) </P>
<P><BR>--load the table list <BR>INSERT @TableList <BR>( <BR>TableCatalog <BR>,TableSchema <BR>,TableName <BR>,TableType <BR>,ObjectDescription <BR>) </P>
<P>SELECT <BR>t.Table_Catalog <BR>,t.Table_Schema <BR>,t.Table_Name <BR>,t.Table_Type <BR>, CAST(IsNULL(e.value,'') as varchar(500)) </P>
<P>FROM <BR>INFORMATION_SCHEMA.TABLES t <BR>LEFT JOIN ::FN_LISTEXTENDEDPROPERTY <BR>( <BR>'MS_Description' --standard description property <BR>,'user' <BR>,'dbo' <BR>,'table' --parent object type <BR>, @TableName -- parent object name <BR>, NULL --child object type <BR>, NULL --child object name from above <BR>) e <BR>ON t.Table_Name = e.objname </P>
<P>WHERE <BR>t.Table_Type = 'BASE TABLE' </P>
<P>SELECT @RowCount = Count(*) from @TableList </P>
<P><BR>--loop through the tables <BR>SET @RowNumber = 1 <BR>WHILE @RowNumber &lt;= @RowCount <BR>BEGIN </P>
<P>SELECT <BR>@TableName = TableName <BR>,@ObjectDescription = ObjectDescription <BR>FROM <BR>@TableList <BR>WHERE <BR>RowID = @RowNumber </P>
<P><BR>--clear primary keys table <BR>DELETE #PkColumns </P>
<P>--insert the primary key records retrieved by the system stored procedure <BR>INSERT #PkColumns <BR>EXEC sp_pkeys @table_name= @TableName </P>
<P><BR>--insert the table name and description for header purposes <BR>INSERT @DataDictionary <BR>( <BR>TableName <BR>, ColumnName <BR>, OrdinalPosition <BR>, ColumnDefault <BR>, IsNullable <BR>, DataType <BR>, CharacterMaximumLength <BR>, IsIdentity <BR>, IsPrimaryKey <BR>, IsForeignKey <BR>, ReferencedTableName <BR>, ReferencedColumnName <BR>, ObjectDescription <BR>) </P>
<P>VALUES <BR>( <BR>@TableName --TableName <BR>, '' --ColumnName <BR>, 0 --OrdinalPosition <BR>, '' --ColumnDefault <BR>, 0 --IsNullable <BR>, '' --DataType <BR>, 0 --CharacterMaximumLength <BR>, 0 --IsIdentity <BR>, 0 --IsPrimaryKey <BR>, 0 --IsForeignKey <BR>, '' --ReferencedTableName <BR>, '' --ReferencedColumnName <BR>, @ObjectDescription --ObjectDescription <BR>) </P>
<P>--insert the column schema information <BR>INSERT @DataDictionary <BR>( <BR>TableName <BR>, ColumnName <BR>, OrdinalPosition <BR>, ColumnDefault <BR>, IsNullable <BR>, DataType <BR>, CharacterMaximumLength <BR>, IsIdentity <BR>, IsPrimaryKey <BR>, IsForeignKey <BR>, ReferencedTableName <BR>, ReferencedColumnName <BR>, ObjectDescription <BR>) </P>
<P>SELECT <BR>t.table_name <BR>, c.column_name <BR>, c.ordinal_position <BR>, IsNULL(c.column_default, '') <BR>, CASE WHEN c.is_nullable = 'Yes' THEN 1 ELSE 0 END <BR>, c.data_type <BR>, IsNULL(c.character_maximum_length, '') <BR>, (SELECT COLUMNPROPERTY <BR>&nbsp;( <BR>&nbsp;OBJECT_ID(t.table_name) <BR>&nbsp;,c.Column_Name,'IsIdentity' <BR>&nbsp;) <BR>&nbsp;) AS IsIdentity <BR>, CASE WHEN pk.column_name IS NULL THEN 0 <BR>&nbsp;ELSE 1 <BR>&nbsp;END AS IsPrimaryKey <BR>, CASE WHEN Fkey.REFERENCED_TABLE_NAME IS NULL THEN 0 <BR>&nbsp;ELSE 1 <BR>&nbsp;END AS IsForeignKey <BR>, IsNULL(Fkey.REFERENCED_TABLE_NAME, '') <BR>, IsNULL(Fkey.Referenced_Column_Name, '') <BR>, CAST(IsNULL(e.value,'') as varchar(500)) as 'ColumnDescription' <BR>FROM <BR>information_schema.tables t <BR>INNER JOIN information_schema.columns C <BR>ON t.table_name = c.table_name <BR>LEFT OUTER JOIN [#PkColumns] Pk <BR>ON PK.column_Name = c.column_Name <BR>LEFT OUTER JOIN <BR>&nbsp;( <BR>&nbsp;SELECT <BR>&nbsp;CASE WHEN OBJECTPROPERTY(CONSTID, 'CNSTISDISABLED') = 0 <BR>&nbsp;THEN 'Enabled' <BR>&nbsp;ELSE 'Disabled' END <BR>&nbsp;AS Status <BR>&nbsp;, OBJECT_NAME(CONSTID) AS Constraint_Name <BR>&nbsp;, OBJECT_NAME(FKEYID) AS Table_Name <BR>&nbsp;, COL_NAME(FKEYID, FKEY) AS Column_Name <BR>&nbsp;, OBJECT_NAME(RKEYID) AS Referenced_Table_Name <BR>&nbsp;, COL_NAME(RKEYID, RKEY) AS Referenced_Column_Name <BR>&nbsp;FROM <BR>&nbsp;SYSFOREIGNKEYS <BR>&nbsp;) As Fkey <BR>ON c.table_name = Fkey.table_name <BR>AND c.column_Name = Fkey.Column_Name </P>
<P>LEFT JOIN ::FN_LISTEXTENDEDPROPERTY <BR>&nbsp;( <BR>&nbsp;'MS_Description' --standard description property <BR>&nbsp;,'user' <BR>&nbsp;,'dbo' <BR>&nbsp;,'table' --parent object type <BR>&nbsp;, @TableName -- parent object name from above <BR>&nbsp;, 'column' -- child object type <BR>&nbsp;, NULL -- child object name from above <BR>&nbsp;) e <BR>ON c.Column_Name = e.objname <BR>WHERE <BR>t.table_name = @TableName <BR>ORDER BY <BR>c.ordinal_position </P>
<P>SET @RowNumber = @RowNumber + 1 <BR>END --end table loop </P>
<P>--drop the temp table <BR>DROP TABLE #PkColumns </P>
<P>SELECT <BR>&nbsp; TableName as N'object',<BR>&nbsp;&nbsp; ColumnName as N'name',<BR>&nbsp;&nbsp; DataType as N'type',<BR>&nbsp;&nbsp; case isIdentity <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; when 0 then 'false'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; when 1 then 'true' <BR>&nbsp;&nbsp; end as N'isIdentity',<BR>&nbsp;&nbsp; case isPrimaryKey <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; when 0 then 'false'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; when 1 then 'true' <BR>&nbsp;&nbsp; end as N'isPrimaryKey',<BR>&nbsp;&nbsp; case isNullable <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; when 0 then 'true'<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; when 1 then 'false' <BR>&nbsp;&nbsp; end as N'isRequired',<BR>&nbsp;&nbsp; ColumnName as N'dbColumnName'<BR>FROM <BR>@DataDictionary d<BR>where OrdinalPosition &gt; 0<BR>ORDER BY <BR>d.TableName <BR>, d.OrdinalPosition <BR>FOR XML raw, type<BR></FONT></P>
<P><FONT color=#000000></FONT>&nbsp;</P></FONT></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
