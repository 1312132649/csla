<html><header><title>Working with child BO - Windows Form</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Working with child BO - Windows Form</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11192.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>fredg posted on Friday, February 24, 2012</h2><p>Hi, we&#39;re working on windows form project. There is parent-child relationship for our BOs. Parent WinPart is dealing with only Parent BO without problem. </p>
<p>Our child WinPart&nbsp;ONLY deals with child BO, too. My question is:</p>
<p>&nbsp;Do we need to pass parent BO instance to child WinPart and get child BO from parent BO, or pass both parent/child BOs, or&nbsp;just pass child BO? </p>
<p>&nbsp; More specific, do we need to set databinding to parent BO/child BO or just set child databinding?</p>
<p>&nbsp;&nbsp;In RebindUI() method, parent.Save()/parent.ApplyEdit()/.. &nbsp;or child.Save()/child.ApplyEdit()/..&nbsp; should be called?</p>
<p>Thanks in advance.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Friday, February 24, 2012</h2><p>No, you do not need to send the parent object to the child win part but you must follow the guidelines for bind/unbind in Windows Forms. </p>
<p>Read more here: <a href="http://jonnybekkum.wordpress.com/2009/10/20/forms-databinding-the-magic-sequence-of-binduiunbindui/">http://jonnybekkum.wordpress.com/2009/10/20/forms-databinding-the-magic-sequence-of-binduiunbindui/</a></p>
<p>And also important to understand <a href="http://www.google.no/url?sa=t&amp;rct=j&amp;q=databainding%20faq&amp;source=web&amp;cd=1&amp;ved=0CCcQFjAA&amp;url=http%3A%2F%2Fwindowsclient.net%2FSamples%2FGo%2520To%2520Market%2FData%2520Binding%2FDataBinding%2520FAQ.doc&amp;ei=3qtHT9qGNMSk4gSKl_28Dg&amp;usg=AFQjCNFgLYEdBCpDqPLv4wVAJO35KV5l_Q&amp;cad=rja">DataBindingFAQ </a>available at WindowsClient.Net.</p>
<p>So:</p>
<p>1. You can set child databinding only in child winpart</p>
<p>2. Always unbind in correct sequence from all BindingSources.</p>
<p>3. Before you can call save on the &quot;root&quot; object</p>
<p>4. the rebind object to BindingSources.</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fredg replied on Friday, February 24, 2012</h2><p>Thanks for your answer. So in this case, we only need to call child.Save()/child.ApplyEdit()/... in RebindUI() method? And there is nothing do to with root object in the child WinPart?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Friday, February 24, 2012</h2><p>You cannot call save on a child object !!!!!</p>
<p>You must always have a root object and can only call Save on the &quot;root&quot; object - not on any child object!!</p>
<p>If you call Save on a child object the DataPortal will throw an Exception. </p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Pavel replied on Friday, February 24, 2012</h2><p>Wrong thread...sorry</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fredg replied on Friday, February 24, 2012</h2><p>Ok. In child WinPart, should we use child.IsDirty or root.IsDirty? </p>
<p>Sorry, i found the problem.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Pavel replied on Friday, February 24, 2012</h2><p>Child(or children) should be a property of Parent and when you create a Child mark it as a Child.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fredg replied on Tuesday, February 28, 2012</h2><p>Another question: If in child winpart, we only pass child BO and databind to child BO, when calling UnbindingSource(childBindingSource, isRoot), what value should we pass for isRoot, true or false? <span style="font-family:TheSansMonoConSemiLight;font-size:xx-small;"><span style="font-family:TheSansMonoConSemiLight;font-size:xx-small;"></span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, February 28, 2012</h2><p>You should pass in true whenever an object is directly bound to the BindingSource</p>
<p>ie: use false when BindingSource has another BindingSource as DataSource and a property on that source as DataMember.<br />&nbsp;&nbsp;&nbsp;&nbsp; use true BindingSource has a &lt;bo&gt; as DataSource.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fredg replied on Tuesday, February 28, 2012</h2><p>Then should we call root.ApplyEdit()/root.BeginEdit()&nbsp;or child.ApplyEdit()/child.BeginEdit()&nbsp;?</p>
<p>My problem is:&nbsp;when calling root.BeginEdit() in RebindUI(), an error of Edit Level mismatch in CopyState happens.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, February 28, 2012</h2><p>Do you use the BindingSourceExtensions from CslaContrib.Windows?</p>
<p>Do you call BeginEdit in your own code in RebindUI? </p>
<p>If so I would only call BeginEdit() on the Root object - and that must before any BindingSource is connected to any &lt;bo&gt; in the object structure.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fredg replied on Tuesday, February 28, 2012</h2><p>No, i don&#39;t use the BindingSourceExtensions. I call BeginEdit in my own code in RebindUI. I this case, do you have suggestion?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fredg replied on Wednesday, February 29, 2012</h2><p>Hi,&nbsp;for a&nbsp;windows form project, I&#39;m working on a grand child winpart. The winpart only diaplays a datagridview which is bound to grandchild collection. </p>
<p>When there is only 1 grandchild, saving is ok. But when there are 2 grand children, saving throws &quot;Edit level mismatch on CopyState()&quot; in root.BeginEdit() method. </p>
<p>root.BeginEdit()&nbsp; is called from RebindUI() and i&#39;m not using BindingSourceExtensions. </p>
<p>Any thought on this? Thanks in advance.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Wednesday, February 29, 2012</h2><p>Can you post the code in Unbind / Rebind?</p>
<p>I do recommend to use the BindingHelperExtensions. Some hard learned lessons in there regarding the problems that you have here. </p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fredg replied on Wednesday, February 29, 2012</h2><p>My code is following. (((ApplicationForm)this.ParentForm).CurrentDeal is referencing to root. </p>
<p>Deal is root. Property is child. Rentroll is grand child in my case. I&#39;m currently working on grand child winpart. </p>
<p>------------------------------------------------------------------------------------ </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void RebindUI(bool saveObject, bool rebind)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.propertyBindingSource.RaiseListChangedEvents = false;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.propertyRentRollsBindingSource.RaiseListChangedEvents = false;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UnbindBindingSource(this.propertyRentRollsBindingSource, saveObject, false);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UnbindBindingSource(this.propertyBindingSource, saveObject, true);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.propertyRentRollsBindingSource.DataSource = this.propertyBindingSource;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // save or cancel changes<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (saveObject)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ((ApplicationForm)this.ParentForm).CurrentDeal.ApplyEdit();</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ((ApplicationForm)this.ParentForm).CurrentDeal = ((ApplicationForm)this.ParentForm).CurrentDeal.Save() as IDeal;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _property = ((ApplicationForm)this.ParentForm).CurrentDeal.DealProperties[_property.RowGuid];</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Csla.DataPortalException ex)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _dictionary[&quot;StackTrace&quot;] = ex.StackTrace;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _dictionary[&quot;StackTrace&quot;] = ex.StackTrace;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ((ApplicationForm)this.ParentForm).CurrentDeal.CancelEdit();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; finally<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // rebind UI if requested<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (rebind)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ((ApplicationForm)this.ParentForm).CurrentDeal.BeginEdit();</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BindUI();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // restore events&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.propertyBindingSource.RaiseListChangedEvents = true;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.propertyRentRollsBindingSource.RaiseListChangedEvents = true;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (rebind)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // refresh the UI if rebinding&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.propertyBindingSource.ResetBindings(false);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.propertyRentRollsBindingSource.ResetBindings(false);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void BindUI()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.propertyBindingSource.DataSource = _property;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fredg replied on Wednesday, February 29, 2012</h2><p>There seems be another helper class- ActionExtender. Waht&#39;s that for? What situation should the two&nbsp;be used?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Wednesday, February 29, 2012</h2><p>Look at the ActionExtender sample in the samples download. </p>
<p>Beware tho&#39; that there is a few bugs reported that haven&#39;t been prioritized for CSLA 4.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fredg replied on Wednesday, February 29, 2012</h2><p>Do you have any thought on my code above?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Wednesday, February 29, 2012</h2><p>Do you call Save in your root object from the child win part? </p>
<p>I&#39;d rather have a SaveDeal procedure in the &quot;Parent&quot; form and make sure the ALL winparts/bindingsources are Unbound from the entire object structure before you call Save an the Rebind afterwards. </p>
<p>And you should NEVER call BeginEdit/CancelEdit/ApplyEdit manually for as long as DataBinding is active. <br />DataBinding will call these methods very often and assume they have total control of these methods. </p>
<p>My preference is to only call BeginEdit on the &quot;root&quot; object unless some very special need says otherwise before databinding.&nbsp; </p>
<p>Plus - you did not include the code for UnbindBindingSource method.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fredg replied on Wednesday, February 29, 2012</h2><p>All my call to Save()/BeginEdit/CancelEdit/ApplyEdit&nbsp; are on root object.</p>
<p>The code for UnbindBindingSource:</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected void UnbindBindingSource(BindingSource source, bool apply, bool isRoot)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.ComponentModel.IEditableObject current =<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; source.Current as System.ComponentModel.IEditableObject;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (isRoot)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; source.DataSource = null;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (current != null)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (apply)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; current.EndEdit();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; current.CancelEdit();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fredg replied on Thursday, March 01, 2012</h2><p>Forget to metion: i also used multiple combox to bind to other bindingSources in the datagridview. Do I need to do sth for those bindingsources in my RebindUI()? Is it possible those bindingsouces cause the &quot;Edit Level mismatch in CopyState&quot; error? But in ProjectTracker project, this kind of bindingsources for combox(e.g.RoleListBindingsource) is not dealt inside RebindUI().</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, March 01, 2012</h2><p>Yes, that could be the source of your problem.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fredg replied on Thursday, March 01, 2012</h2><p>Stiil no luck after dealing with them.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>fredg replied on Friday, March 02, 2012</h2><p>If we&#39;re not caring about the un-do provided by CSLA.net(e.g. when canclling editing, just retrieving BO from database and rebind UI.), can we disable the edit level of the BO?How can we do that?</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
