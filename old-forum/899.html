<html><header><title>authorization rules on Binding navigator and filteredbindinglist</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>authorization rules on Binding navigator and filteredbindinglist</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/899.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dean posted on Monday, August 14, 2006</h2>I have a form bound to a filteredbindinglist (with a binding navigator). The ReadWriteAuthorization form control does not seem to be working in this situation. <br><br>I could be totally wrong in this analysis but it seems that:<br>The applyauthorizationrules(control as control) sub in ReadWriteAuthorization.vb checks to see if the datasource is either a businessbase or a iReadonly object.&nbsp;&nbsp;  In this case the datasource is the filtered binding list so it fails to identify anything to apply the rules to. Unfortunately my understanding of generics prevents me from figuring out what we do want to check for here.<br><br>Can anyone comment on this? Has anyone successfully used the readwriteauthorization when the form is bound to a collection?<br><br>Dean<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dean replied on Friday, August 18, 2006</h2>I have altered this method from the ReadWriteAuthorization control. It seems to be working now.<br><br>Basically I checked for a ibindinglist datasource and if it is use the bindingsource.current property to retreive the businessbase object.<br><br>Warning: I have not extensively tested this. But it is working in the situation outlined above and in the situtation where a bus base object is the datasource.<br><br>Comments?<br><br>&nbsp;Private Sub ApplyAuthorizationRules(ByVal control As Control)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For Each binding As Binding In Control.DataBindings<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' get the BindingSource if appropriate<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If TypeOf binding.DataSource Is BindingSource Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim bs As BindingSource = CType(binding.DataSource, BindingSource)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' get the BusinessObject if appropriate<br><br>'-----<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' My change - check if ibindinglist and if current object is businessbase<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If TypeOf bs.DataSource Is IBindingList AndAlso TypeOf bs.Current Is Csla2.Core.BusinessBase Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim ds As Csla2.Core.BusinessBase = _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CType(bs.Current, Csla2.Core.BusinessBase)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' get the object property name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim propertyName As String = _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; binding.BindingMemberInfo.BindingField<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ApplyReadRules(control, binding, propertyName, _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ds.CanReadProperty(propertyName))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ApplyWriteRules(control, binding, propertyName, _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ds.CanWriteProperty(propertyName))<br><br>'-----<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ElseIf TypeOf bs.DataSource Is Csla2.Core.BusinessBase Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim ds As Csla2.Core.BusinessBase = _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CType(bs.DataSource, Csla2.Core.BusinessBase)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' get the object property name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim propertyName As String = _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; binding.BindingMemberInfo.BindingField<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ApplyReadRules(control, binding, propertyName, _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ds.CanReadProperty(propertyName))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ApplyWriteRules(control, binding, propertyName, _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ds.CanWriteProperty(propertyName))<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ElseIf TypeOf bs.DataSource Is Csla2.Core.IReadOnlyObject Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim ds As Csla2.Core.IReadOnlyObject = _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CType(bs.DataSource, Csla2.Core.IReadOnlyObject)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ' get the object property name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim propertyName As String = _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; binding.BindingMemberInfo.BindingField<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ApplyReadRules(control, binding, propertyName, _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ds.CanReadProperty(propertyName))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Sub</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, August 21, 2006</h2>This seems like a good enhancement to the control. I think a complete solution would need to take into account that you could have a collection of readonly objects too - so the overall structure needs to be slightly different to accomodate all four scenarios.<br><br>I'll add this to the list of things to fix in 2.1.1 (I'm really not doing more changes to 2.1!!)<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Curelom replied on Tuesday, October 24, 2006</h2><P>I've made a modification that seems to also work&nbsp; c# version</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (binding.DataSource </FONT><FONT color=#0000ff size=2>is</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>BindingSource</FONT><FONT size=2>)</P>
<P>{</P>
<P></FONT><FONT color=#2b91af size=2>BindingSource</FONT><FONT size=2> bs =</P>
<P>(</FONT><FONT color=#2b91af size=2>BindingSource</FONT><FONT size=2>)binding.DataSource;</P>
<P></FONT><FONT color=#008000 size=2>// get the BusinessObject if appropriate</P>
<P>//////////////////////////////////////////////////////</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>//modification to allow for binding to lists </P></FONT><FONT size=2>
<P>Csla.Security.</FONT><FONT color=#2b91af size=2>IAuthorizeReadWrite</FONT><FONT size=2> ds;</P>
<P></FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (bs.DataSource </FONT><FONT color=#0000ff size=2>is</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>IBindingList</FONT><FONT size=2> &amp;&amp; bs.Current </FONT><FONT color=#0000ff size=2>is</FONT><FONT size=2> Security.</FONT><FONT color=#2b91af size=2>IAuthorizeReadWrite</FONT><FONT size=2>)</P>
<P>&nbsp;&nbsp;&nbsp;ds = bs.Current </FONT><FONT color=#0000ff size=2>as</FONT><FONT size=2> Csla.Security.</FONT><FONT color=#2b91af size=2>IAuthorizeReadWrite</FONT><FONT size=2>;</P>
<P></FONT><FONT color=#0000ff size=2>else</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;ds = bs.DataSource </FONT><FONT color=#0000ff size=2>as</FONT><FONT size=2> Csla.Security.</FONT><FONT color=#2b91af size=2>IAuthorizeReadWrite</FONT><FONT size=2>;</P></FONT><FONT color=#008000 size=2>
<P>////////////////////////////////////////////////////// </P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (ds != </FONT><FONT color=#0000ff size=2>null</FONT><FONT size=2>)</P>
<P>{</P>
<P></FONT><FONT color=#008000 size=2>// get the object property name</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> propertyName =</P>
<P>binding.BindingMemberInfo.BindingField;</P>
<P>ApplyReadRules(</P>
<P>control, binding,</P>
<P>ds.CanReadProperty(propertyName));</P>
<P>ApplyWriteRules(</P>
<P>control, binding,</P>
<P>ds.CanWriteProperty(propertyName));</P>
<P>}</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>gdk9am replied on Thursday, November 30, 2006</h2><P>Hi</P>
<P>I have tried to use ReadWriteauthorization rules on Binding navigator and filteredbindinglist and they still don't work on 2.1.1.&nbsp;Did this change not make it into the 2.1.1 release ?</P>
<P>Has anyone implemented the complete fix as recommended by Rocky ?</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, January 17, 2007</h2>I have changed ReadWriteAuthorization for 2.1.2, so collections should work starting there. The change is in <A href="http://www.lhotka.net/cslacvs">cvs </A>now if you want to pull it earlier.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
