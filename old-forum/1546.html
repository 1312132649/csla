<html><header><title>NameValueListBase Databinding problem</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>NameValueListBase Databinding problem</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1546.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jeroen Sneyers posted on Friday, October 20, 2006</h2><P><FONT face=Arial size=2>Hi all, I started off with CSLA a couple months ago and I must say, it's awesome. It thought me a lot and still does, so here's a small question.<BR>I have a class 'SalesManList' which inherits from NameValueListBase and contains a static list of Ids and names of salesmen. It's based on the class 'RoleList' from the ProjectTracker example.<BR>In a windows form, I have 2 comboboxes which are bound to this static list.</FONT></P>
<P><FONT face=Arial size=2>cmbPartsResponsible.DataSource = SalesManList.GetList();<BR>cmbWorkShopResponsible.DataSource = SalesManList.GetList();<BR>(ValueMember = "Key", DisplayMember = "Value")</FONT></P>
<P><FONT face=Arial size=2>My problem is, that when I change the value of one combobox, the other also gets the same value.<BR>E.g. I set combobox cmbPartsResponsible to "John Smith", then the value of cmbWorkShopResponsible also&nbsp;changes "John Smith". This is probably due to the static list in the class 'SalesManList'.<BR>Could anyone tell me what I'm doing wrong here&nbsp;or how I could resolve this issue?</FONT></P>
<P><FONT face=Arial size=2>Many thanks, J.</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, October 20, 2006</h2>Not sure I understand... is the SalesManList keeping track of the selected value?&nbsp; It shouldn't be.. another BO should have PartsResponsibleId and WorkshopResponsibleId.. <br><br>If you do have such a BO, you probably bound the combox boxes to the same property.<br><br>HTH<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Friday, October 20, 2006</h2>I think he has two ComboBoxes bound to the same list.&nbsp; If you select an
item from one list, the same item will be selected in the other list.<br><br>&nbsp;
I think in this case you will need to set up two separate BindingSource objects, but you may be able to set them to the same instance of the list.&nbsp; Otherwise, try to separate instances of the list.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jeroen Sneyers replied on Friday, October 20, 2006</h2><P>Indeed Brian, I had to set up two separate BindingSource objects. Thx a lot.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jeroen Sneyers replied on Friday, October 20, 2006</h2><P>Thanx for the response.</P>
<P>The SalesManList does not keep track of the SelectedValues.&nbsp;There's a root&nbsp;BO 'Client' which contains the properties PartsResponsibleId and WorkshopResponsibleId, so they keep track of the selectedValue.</P>
<P>In design view I bind&nbsp;clientBindingSource.PartsResponibleId to the SelectedValue of&nbsp;cmbPartsResponsibleId and clientBindingSource.WorkshopResponsibleId to the SelectedValue of cmbWorkshopResponsibleId. In the OnLoad method of the windows form, I populate the comboboxes as following:</P>
<P>cmbPartsResponsibleId.DataSource = SalesManList.GetList();<BR>cmbWorkshopResponsibleId.DataSource = SalesManList.GetList();</P>
<P>J.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
