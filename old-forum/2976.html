<html><header><title>Database.VB</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Database.VB</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2976.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>SimpleCSLA posted on Friday, June 01, 2007</h2>In Project Tracker, could someone please explain why the code never stops on the line:<br><br>Return ConnectionStrings("Security").ConnectionString<br><br>yet I still get an error that says:<br><i>An error has occurred while establishing a connection to the server. &nbsp;When 
connecting to SQL Server 2005, this failure may be caused by the fact that under 
the default settings SQL Server does not allow remote connections.<br><br></i>If CSLA isn't trying to get the connection string, why am i getting a message that appears as though it has hit and failed to retrieve data from SQL Server?<br><br>I'm using Remoting, so this might be over most people's heads.&nbsp; It's sure way over mine.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, June 01, 2007</h2><P>I'm not sure where exactly that line of code is within the example, but I would guess its because VS is attached to the ptracker.exe process but not the relevent remoting server process (one of the IIS processes).</P>
<P>Does your web.config have the proper connection information?&nbsp; Does the server have access to the Sql Server instance?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SimpleCSLA replied on Thursday, June 07, 2007</h2>It took a while, but I finally figured out the problem, my IIS Directory Security setting was checked for "Allow IIS to Control Password".&nbsp; After unchecking the box 'voila' Remoting worked perfectly.<br><br>My code never stopped on Database.VB because it never got there.&nbsp; CSLA first said use remoting and never could open the channel, so I only got a generic 401 unauthorized error.&nbsp; <br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
