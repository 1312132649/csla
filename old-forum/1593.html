<html><header><title>OO with CSLA: 1 Object = 1respoinsibilties and many Behaviours?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>OO with CSLA: 1 Object = 1respoinsibilties and many Behaviours?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1593.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ianinspain posted on Wednesday, October 25, 2006</h2>Hi there,<br><br>I was reading a thread lately ( http://forums.lhotka.net/forums/1/1658/ShowThread.aspx )... and still I am a little confused so i thought i would outlay what i think i have learnt and i was hoping somebody could step in and help with my rights and wrongs..<br><br>I have been reading that an object (a class) should have one responsibility.... ermm ok ... I accept this but how do we clarify reponsibility..<br><br>Take for example an invoice object (yep a typical example :-) ) .... so where is the responsibility... Is this infact the INVOICE .... so hence a CUSTOMER, SUPPLIER, etc are all different responsibilities ??<br><br>Or is it a case of an "INVOICE can PRINT", an "INVOICE can EDIT" ?? In this is the case, does this mean i would potentially need in this example 2 objects, 1 that handle the PRINT and one that handles the EDIT?<br><br>Ok... so taking this further, from what i have learnt (so i believe anyway :-) )... that an object can have many behaviours .... fine .. accept this also... but what do we classify a Behaviour??<br><br>If we assume that an object called "INVOICE" can PRINT,EDIT,DELETE,CLONE etc .. then assuming that INVOICE is only 1 object.. then i presume the behaviours are PRINT,EDIT,DELETE and CLONE.<br><br>ermm Ok... sounds good, but thats where i am confused because lets assume that this is wrong (which it may be) and an INVOICE must have separate objects to PRINT, EDIT, DELETE etc then what would the behaviours be here?<br><br>i.e. Object "INVOICE - PRINT" - then behaviours would be PRINT_BOLD, PRINT_DRAFT, PRINT_QUALITY, etc<br><br>Well this is basically what i have so far, but i have a fine line between each statement thats just confusing me...<br><br>I hope somebody can help on this... I think i am nearly there, am i not? Or possible could be on a different planet :-)<br><br>Look forward to any input<br><br>Thanks in advance<br><br>Ian<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ChristianPena replied on Wednesday, October 25, 2006</h2><P>I am fairly new to this myself so I might be off on this as well but I see it as you described.</P>
<P>The Invoice class has one responsibility: To maintain invoice state and data. The behaviors are as you described; to Edit, Delete, Clone, etc.</P>
<P>I'd love to hear from others.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, October 25, 2006</h2>You're close.&nbsp; Its not the invoices responsibilty to display itself, that is the responsibility of the UI.&nbsp; An Invoice object would likely be for modifying invoice data.&nbsp; To actually print you'd probably not use the edtiable Invoice object, since you dont need any of its editing capabilities.&nbsp; You'd probably create an InvoiceInfo object, which is meant only to display invoice data.&nbsp; It has no other purpose.&nbsp; Edit, delete, and cloning are all functions which must obey business rules so that the object cannot be saved in an invalid state (one in which one or more of its rules are broken).&nbsp; <br><br>Business objects in general are only meant for one thing; to enforce business rules.&nbsp; The data layer's job is to store data, the business layer's job is to intererpate and change the data, and the UI's job is just to display data.<br><br>HTH<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ianinspain replied on Wednesday, October 25, 2006</h2>Hey thanks...<br><br>I think i am understanding it a little better now.....<br><br>So continuing on the invoice object....<br><br>So editing, creating, delete an invoice object would be ONE object<br><br>but to display it only that would be ANOTHER object<br><br>... I think i am nearly there, so taking the invoice object/s to the extreme .... in what other scenerios would there be more "different" types of invoice objects..<br><br>And... with the InvoiceInfo object, then i presume the behavior would be "GetFormattedOutputForPrint" or similar?<br><br>In this scenerio whatelse would the InvoiceInfo be good for?<br><br>In the ACTUAL Invoice Object, the behaviours here would be Edit, Delete etc .. because there are all related to changing the object ?<br><br>Thanks once again for your time<br><br>Ian<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Wednesday, October 25, 2006</h2>Hey there,<br><br>I think you are too deep into your definition study. Let's take a step back and consider your software from a broader viewpoint.<br><br>Why do you apply OO anyways? <br>Or more to the core of your question: <i>when </i>do you apply OO techniques?<br><br>About the why:<br>- this could open up a huge discussion, let's not fall into that trap and stay generic:<br>- I postulate that you will not (at least <i>should </i>not) apply OO for its own sake ...<br>- basically, this translates to: you apply OO for a purpose beyond the OO design pattern itself<br><br>So, about the when, how do you recognize when there is a purpose for OO techniques (which is basically your question):<br>- that is anytime when you encounter (or envision) that <b>variability</b> of one part of your application software is required.<br><br><br>I will not provide formal proof, but let me give a number of examples based on CSLA instead:<br><br>- any BusinessBase object needs to support some or all CRUD operations (insert/update/remove, etc), so there is no variability in there, hence we put all of these IN the object. If you like to call these behaviors or something else does not really matter, what matters is the presence or absence of the variability requirement;<br><br>- CSLA does intend to support different tier-setups: local database, remote database, etc. So this is a variable, hence you see that this aspect is factored out of the BusinessBase and got it's own design (the dataportals)<br><br>- your invoice needs to be persistable (insert/update/save), so the CRUD operations, no question about variability so there is no need to externalize these (behaviors) to new objects<br><br>- your invoice may also need to be printable, if 'printing' has a single interpretation (e.g. printing to paper) then you could put it inside the invoice class and be done with it.<br>- if you find that you are repeating printing-related code over and over in all your classes, then start scratching your head:<br>&nbsp;&nbsp;&nbsp; - either move printing code to a base class so that all your printable classes inherit this single set of code (just like BusinessBase implements a lot of default behavior)<br>&nbsp;&nbsp;&nbsp; - or change viewpoint: take the 'printing logic' as your anchor point and note the variability in objects that can be printed. This would validate a design where all printing logic goes into its own class.<br>- another case is when you have different kinds (flavours) of printing, e.g.: printing to printer and printing to a Word document and printing to a PDF file. Then the printing logic is variable and again you have a case to externalize this logic in its own class hierarchy.<br><br>Maybe you have some experience with relational databases. If that is the case, then OO could be seen a 'normalizing business objects and logic'.<br><br>Hope this helps.<br><br>Bayu<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pelinville replied on Wednesday, October 25, 2006</h2><DIV><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>To actually print you'd probably not use the edtiable Invoice object, since you dont need any of its editing capabilities.&nbsp; You'd probably create an InvoiceInfo object, which is meant only to display invoice data.&nbsp; It has no other purpose.&nbsp;</div></BLOCKQUOTE></DIV>
<DIV>&nbsp;</DIV>
<DIV>But the InvoiceInfo object would probably use an Invoice object and then format the data from the Invoice&nbsp; BO.&nbsp; Correct?</DIV>
<DIV>&nbsp;</DIV>
<DIV>This allows the InvoiceInfo to change without affecting the Invoice object.&nbsp; For example the InvoiceInfo might have to display the Customer Information also.&nbsp; To accomplish this the InvoiceInfo object now uses the Invoice obj and a CustomerInfo object to produce the desired output.</DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp;</DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, October 25, 2006</h2>No, the invoiceinfo object wouldn't use the invoice object at all.&nbsp; The invoiceinfo would 'know' how to get its own data.&nbsp; A change to invoice should not require invoiceinfo to change at all (although changes to the concept of an invoice may).<br><br>That said, both of those classes might use a third, internal (to the assembly) class which gets the data from the database.. since both are reading from the same table.&nbsp; But that depends on how similar the fetching is for both of those classes.<br><br>The invoiceinfo object would likely query the customer table, to get information on the customer (where as the invoice just needs to know the name and address, for example).<br><br>Check out the project tracker sample that comes with Csla, and consider purchasing the book.<br><br>HTH<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pelinville replied on Wednesday, October 25, 2006</h2><DIV><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>No, the invoiceinfo object wouldn't use the invoice object at all.&nbsp; The invoiceinfo would 'know' how to get its own data.&nbsp; A change to invoice should not require invoiceinfo to change at all (although changes to the concept of an invoice may).<BR><BR>That said, both of those classes might use a third, internal (to the assembly) class which gets the data from the database.. since both are reading from the same table.&nbsp; But that depends on how similar the fetching is for both of those classes.<BR><BR>The invoiceinfo object would likely query the customer table, to get information on the customer (where as the invoice just needs to know the name and address, for example).<BR><BR>Check out the project tracker sample that comes with Csla, and consider purchasing the book.<BR><BR>HTH<BR>Andy<BR></div></BLOCKQUOTE></DIV>
<DIV>&nbsp;</DIV>
<DIV>So to display the InvoiceInfo stuff you would have to save the invoice object then retrieve the InvoiceInfo data?</DIV>
<DIV>&nbsp;</DIV>
<DIV>That doesn't make any sense.&nbsp; What if the current invoice was dirty?&nbsp; How do you print (or whatever) without saving it.&nbsp; How do you do this if the application is running disconnected?</DIV>
<DIV>&nbsp;</DIV>
<DIV>oops... Premature post.</DIV>
<DIV>&nbsp;</DIV>
<DIV>Anway.&nbsp; You are probably right.&nbsp; I just don't see the need for that complexity.&nbsp; Of course this is a pretty basic example so it probably isn't needed here.</DIV>
<DIV>&nbsp;</DIV>
<DIV>I just don't see why you couldn't just "use" the objects already layin around.&nbsp; Seems like alot of extra work and resource usage&nbsp;for no reason.</DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp;</DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, October 25, 2006</h2>Typically yes, that's what you would do.&nbsp; Printing the invoice being edited would likely make use of the edtiable business object, although you have to think about things like 'can the user print an invoice not in a valid state?'&nbsp; Eitehr way though, the UI uses the business object (editable or not) to create the report, but the invoice object doesn't know (or care) about what is done with it.&nbsp; It is only concerned that its state is valid and providing a way to query about its state.<br><br>What you do in a scenario depends on your exact use case however.&nbsp; You build classes to satsify the requirements of a use case.&nbsp; If your next use case can reuse those objects (meaning that the use case has some behaviors in common) then you can do it.&nbsp; If not, you may have to build another object which operations on the same data but does something different with it.<br><br>Disconnected is a whole other issue, that doesn't have much to do with Csla.&nbsp; For example, how do you save an invoice if you aren't connected to the database?&nbsp; Those are seperate issues from Csla.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pirithoos replied on Thursday, October 26, 2006</h2>Hi Andy, Hi All!<br><br>I do follow up a lot of threats about OOD with CSLA.<br><br>Having my roots in very data-centric programming (MS Access) I do face each day the old problem to think first about data instead of&nbsp; behaviour.&nbsp; Rockys newer 2005 book was of great help. The new chapter in which Rocky lead us from the use cases to the class design of his PTracker application shows the right approach to design an application. <br><br>Anyway myself&nbsp; and (seeing from this and other threats)&nbsp; a lot of others let themselves seduce again and again trying to creat one super-power BO that can do anything. And mostly (at least in my case) it is due to the fact that one is trying to put all data in a class that might be usefull in other use cases as well, but we do miss out to focus on the current single use case we want to map to e.g. a class diagram. and to narrow the data to the minimum required herefore.<br><br>Maybe the mistake is to think CSLA is a frame-work with base classes <u>which must be subclassed in any case</u> for&nbsp; any&nbsp; class&nbsp; required by an application.&nbsp; IMO this&nbsp; is&nbsp; a problem&nbsp; quite some people may have. (at least those like me&nbsp; who are not a native developers/software architects or programmers).<br><br>One thing is for sure: If the use case is to write <u>validated </u>data into or edit existing data in a DB via some UI by users a CSLA.Businesbase is the right and pretty obvious choice. How easy this can be made by using CSLA is clearly shown by the PTracker application.<br><br>I assume, and this is also in my particular case the challenge, finding the right way to implement the other behaviours required by an application into classes. Or how to find out if it makes sense to subclass a CSLA base class or not. This is of course a issue that not mainly has to do with CSLA and therefore not a typical threat for this forum, but still I act under the impression quite some people here looking for advise.<br><br>For example I currently try to sort out the following:<br><br>Use Case: <br>Ship a consignment from A to B. The shipment could be effected by&nbsp; road, sea, air.<br><br>The ConsignmentBO is pretty simple. Data is: CosignmentID, Productname,&nbsp; net-weight, goss-weight, maessurements, Flag if consignment is already shipped or not and ShippedBy containing data about the shipment mode (by road, by sea, by air)<br><br>(There is another use case where the consignment can be created) Very easy approach, inherit Consignment from BusinessBase, writting a UI to create, edit and save it to the DB. This leads to the point where I am aware of the fact that a ConsignmentBO already exits in my design. And again I would think - well for the other use case (Ship a consignment from a to b) I already have one involved object ready designed....<br><br>...back to the 'ship out consignment' use case:<br><br>I could design an abstract class Shipment and sublass concrete classes&nbsp; for ShipByRoad ShipBySea, ShipByAir.<br><br>Then I could pass a Consignment to a ShipmentBy... class which sets the flag if shipped and<br>according to the type of shipments set the Consignments.ShippedBy field to either road, sea, or air.<br>when finished the ShipmentByBO invokes the Save method of Consignment. Neither the abstract nor the concrete implementations like ShipByRoad, ShipBySea need to inherit from any CSAL base class.<br><br>Sounds reasonable to me, but...<br><br>another approach would be not to pass the CosignmentBO to a ShipBy class but implement the ShipBy classes in another way where they e.g. get an CosignmentID in there constructor and<br>load just the required data from the consigmnents DB table which must be modified due to a shipment effected. (In this case the required data is just IsShipped and ShippedBy). The abstract shipment class would know how to save this data into the DB again., the subclases would take care of other things like notifiying other classes to generate the freight-papers required for a sea shipment, curier-shipment or road-shipment.)&nbsp; But in this case the ShipBy classe(s) must again inherit from CSLA (to assure a clear common way how to write data into the DB)<br><br>I could argue for the first choice as the Cosignment is still edited, validated and somehow returned to the DB and that was the reason for its creation in the other use case.<br><br>On the other hand I have somehow the feeling the second approach is more correct in respect to <br>OOD/OOP.<br><br>What is the best / or at least the most common approach ?<br><br>Best Regards<br><br>Frank<br><br>P.S.: If some other people know good comunities for OOD topics not necessarily related to CSLA your imput is much appreciated.<br>&nbsp;<br><br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Thursday, October 26, 2006</h2><P>Wow, quite a bit going on here...</P>
<P>Let me back-up to the original topic and address the question over 1 object - 1 behavior.&nbsp; In the scenerio Ian originally described, you would have an Invoice object and yes, in some regards to semantics, one could say that this class is "defined" by its data.&nbsp; However, a better way to think about it is that you have a shell of an object with properties and methods that support a specific behavior.&nbsp; Then, you may or may not couple that object with "predefined" values obtained from a data store.</P>
<P>I word it this way because one of the keys to a good, stable and extensible design is to have our BO's data-agnostic - meaning that the BO doesn't care where the data comes from (e.g. SQL Server, Oracle, MySql, Access, XML file, config file, etc.).&nbsp; To wrap my head around this, I always approach my design without a data store.&nbsp; In other words, I always assume (at first) that my objects will be created and populated in code.&nbsp; Then, once I have my "shell", I can provide the "hooks" for data access - as provided by the data portal features in CSLA.&nbsp; I'll spare you an explanation on how data-agnosticity is achieved...</P>
<P>So, given this design, all that the data from our data store does is "describe" the actual instance of our object.&nbsp; It does not "define" our object because that is done in code.&nbsp; For example, what is a person?&nbsp; A person is someone who has a name, eye color, etc. and, let's say breathes.&nbsp; A person is our object and is defined as just that: an object with a name, eye color and that breathes.&nbsp; To describe a specific person, we need to populate those properties with data.&nbsp; So, we go to our data store and pull out the name and eye color of a specific person.&nbsp; While this identifies that person it does not define WHAT a person IS.&nbsp; Does that help?</P>
<P>Second, to implement a behavior-based model for your scenario, as Andy and others have described, you need to think about the core behavior that your Invoice object possesses.&nbsp; It is there to allow you to edit the data that is contained in the Invoice.&nbsp; Operations such as printing, e-mailing, etc. only use the data contained in the invoice and represent different behaviors.&nbsp; As pointed out earlier, this is really no different than having a different object (or objects) to represent the invoice in the UI.&nbsp; Printing is the easiest parallel as all you are doing is creating another presentation of the invoice data with the printer beign the target rather than a Windows or Web form.</P>
<P>In my experience, you would want to create an InvoicePrinter object that is responsible for printing.&nbsp; A Print method, for instance, would accept the instance of your Invoice object or InvoiceInfo object (more on that in a second) as a parameter and do the rest of the work.&nbsp; Why do this versus having a Print method on your Invoice class?&nbsp; A couple of reasons.</P>
<P>First, while it seems to makes sense from an encapsulation perspective to have the Invoice "own" its Print method, you've added an additional responsibility onto that object.</P>
<P>Second, by encapsulating the Print method into the object, you've tied the object to a single way of printing.</P>
<P>Third, by using a separate class whose responsibility is printing, you can interchange that object with others to achieve different behaviors.&nbsp; For instance, you can have a BlackAndWhiteInvoicePrinter, ColorInvoicePrinter, PostScriptInvoicePrinter, PdfInvoicePrinter - what ever (I'm just pulling names out of the air).</P>
<P>So you see, by decoupling the object from this second behavior, you actually give your app more flexibility and a more extensible and scalable object model to work with.&nbsp; That is part of the rationale behind the&nbsp;1 object, 1 behavior approach.</P>
<P>As for the InvoiceInfo object, remind yourself that the purpose of the Invoice object is manipulation (editing) of your invoice data.&nbsp; As pointed out earlier, when printing, you don't need this behavior - all you need is a read-only copy of the data.&nbsp; In addition, for reporting purposes, you don't necessarily need a complex heirarchy of objects as may be the case with your Invoice object which may have a BillToAddress property of Address type, etc.&nbsp; When printing (a type of reporting), you will want all of this in a flat record rather than heirarchically.&nbsp; So, the InvoiceInfo object gives you that different "view" of the same data so that it can be used in a different way (different behavior).&nbsp; The InvoiceInfo object is still a BO and still possesses the requisite knowledge to acquire its data but exposes the data differently and provides different behavior.&nbsp; In addition, this approach allows you to further extend your object model by creating multiple version of this type of class as well, such as SimpleInvoiceInfo and DetailedInvoiceInfo, that can be used to implement&nbsp;different use cases.&nbsp; And, in the future, should you need to implement a new use case, you have the ability to just extend this one more time, for say a ConsolidatedInvoiceInfo object.</P>
<P>I hope that this makes sense and helps to clarify what I agree to be a confusing transition to make.&nbsp; I came from the world of data-centric programming driven by relational databases and had to struggle through the same logic changes that you are going through.&nbsp; So, hopefully this will help you wrap your head around the concepts a little better.</P>
<P>Good luck.</P>
<P><img src="/emoticons/emotion-11.gif" alt="Cool [H]" /></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pirithoos replied on Thursday, October 26, 2006</h2>

<p class="MsoNormal"><span>Hi,<br>
<br>
thanks for your prompt reply and sorry if I came up with another use case in
this threat. Anyway I would appreciate a recommendation for my use case.<br>
<o:p></o:p></span></p>

<p class="MsoNormal"><span>It might
clarify also other questions.<o:p></o:p></span></p>

<p class="MsoNormal"><span><br>
I will map the use case from my previous post to the world of&nbsp; Invoices:<o:p></o:p></span></p>

<p class="MsoNormal"><span><br>
In real world the somebody from the bookkeeping puts a date-stamp on an invoice
once it is paid.<br>
<br>
<o:p></o:p></span></p>

<p class="MsoNormal"><span>Back in <span>&nbsp;</span>Objectville I could…<o:p></o:p></span></p>

<p class="MsoNormal"><span><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal"><span>Spend my
InvoiceBO a new field InvoicePaidDate<o:p></o:p></span></p>

<p class="MsoNormal"><span><br>
Doing so I could pass an InvoiceBO to a Bookkeeping Object which <br>
stamps it (edit the new PaymentReceivedDate field of the InvoiceBO and invokes
Invoice.Save).<o:p></o:p></span></p>

<p class="MsoNormal"><span>[very seductive,
but it really seems again to be a data-centric approach as the InvoiceBO is treated
only as a piece of data; well, smart data, but anyway just data]<o:p></o:p></span></p>

<p class="MsoNormal"><span><br>
or <o:p></o:p></span></p>

<p class="MsoNormal"><span><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal"><span>I could create
a PaidInvoiceStamperBO having the only responsibility to set the<o:p></o:p></span></p>

<p class="MsoNormal"><span>InvoicePaidDate
for a certain Invoice in the invoice table from the DB to e.g. Today. <o:p></o:p></span></p>

<p class="MsoNormal"><span><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal"><span>This
PaidInvoiceStamperBO would load the relevant invoice data (in this case only
the InvoicePaidDate field from the DB by the InvoiceID passed into it via the
constructor,<o:p></o:p></span></p>

<p class="MsoNormal"><span>Set the
InvoicePaidDate to Today and write it back into the DB.<o:p></o:p></span></p>

<p class="MsoNormal"><span><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal"><span><o:p>&nbsp;</o:p></span></p>

<p class="MsoNormal"><span><br>
Frank<o:p></o:p></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Thursday, October 26, 2006</h2><P>I would use a command object to handle the update.&nbsp; All you would need is to identify which invoice was paid and execute the command object which would trigger the appropriate stored procedure in your database to update the record.</P>
<P>Depending on your interface is how you could do this.&nbsp; If you have an instance of the Invoice object (because you are using it to data-bind the UI form), you could have a PaymentReceived method that would trigger the command object.&nbsp; Or, (a better way, imo) have a static PaymentReceived method on the Invoice class that accepts the Invoice object&nbsp;and overloaded to accept the invoice's ID&nbsp;that triggers the command object.&nbsp; This way you don't have to have an instance of the Invoice object, just its ID value (from a NameValueList used with a drop-down list, for instance).</P>
<P>However, having such a method in the Invoice class does&nbsp;raise the 1 object, 1 responsibility issue again as this behavior would be directly coupled with the Invoice object and tightly implemented with the single command object.&nbsp; Doesn't leave much room for flexibility.</P>
<P>This is an area (command objects) that I have struggled with a bit.&nbsp; This is the approach Rocky uses&nbsp;in the book for the&nbsp;ExistsCommand implementation, but I can see an argument about it&nbsp;so I'll leave it to someone else to explain the preferred way to implement this to satisfy the 1 object, 1 responsibility rule.</P>
<P>Hope that helps.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dean replied on Thursday, October 26, 2006</h2>May not understand but:<br><br>Isn't the datestamp on the invoice really a relationship between the invoice and the payment? (Don't remember whether we are talking about payables or receivalbes but) Doesn't the payment get applied to the invoice (ar) or generated based on the invoice (ap)? During that process wouldn't the datestamp be generated/updated or is the datestamp just a reflection of the either payment object creation date or the check object creation date?<br><br>Dean</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Thursday, October 26, 2006</h2><P>That very well may be.&nbsp; But, the use case we were presented with didn't say anything about other activity.&nbsp; If the application is posting the payment information, then it would certainly be reasonable to extend this to include a relationship between the invoice and the payment received against that invoice.&nbsp; But, it may also be the case that the goal is to simply reconcile the invoice and no further information or action is required.</P>
<P>Based on the simple use case presented, I'd go with the simple solution and use a command object.&nbsp; If the use case was expanded to include other objects and actions, then I'd have to reconsider and you are correct that we would most likely introduce another business object into the mix to represent the payment and handle its responsibilities.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Wal972 replied on Friday, October 27, 2006</h2><P>Hi,</P>
<P>This whole scenerio could be changed with a different perspective. The stamping of the invoice once it's paid, is really part of the Paying the Invoice use case and would form part of this BO rather than be part of the Invoice BO or being passed between the Bookkeeper BO and Invoice.</P>
<P>Its a step the process of paying the invoice. Not a part of an isolated BO</P>
<P>Hope this helps</P>
<P>Ellie</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Friday, October 27, 2006</h2>Agreed.&nbsp; And depending on the scale of the "Pay" BO, it may simply be a command object or it may require additional data and logic to satisfy the use case.&nbsp; All depends on the actual use case.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ianinspain replied on Friday, October 27, 2006</h2>Hi SonOfPirate! thanks for the help.... its really been helpful.. I have a couple of clarifications... if thats ok<br><br>InvoiceObject is the editable BO<br><br>and InvoiceInfo is the ReadOnly BO .... so the CRUD methods would not be shared, they would implement there own Data classes - correcT?<br><br>You say: "Third, by using a separate class whose responsibility is printing, you
can interchange that object with others to achieve different
behaviors.&nbsp; For instance, you can have a BlackAndWhiteInvoicePrinter,
ColorInvoicePrinter, PostScriptInvoicePrinter, PdfInvoicePrinter - what
ever (I'm just pulling names out of the air)."<br><br>So basically basically BlackAndWhiteInvoiePrinter and COlourInvoicePrinter would inherit from InvoicePrinter which would be an abstract BASE class?<br><br><br>You say "A Print method, for instance, would accept the instance of your Invoice
object or InvoiceInfo object (more on that in a second) as a parameter
and do the rest of the work. "<br><br>I would pass this into the method from my UI. right?<br><br>Thanks once again, things are quite a bit clearer now....<br><br>Ian<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, October 27, 2006</h2>The invoiceobject and invoiceinfo could share fetch code, if you can load an invoiceinfo directly; that is, it is a root object (has public factory methods).<br><br>The InvoicePrinter interface and implementing classes would belong in the UI layer.&nbsp; The reason is that they are of no use unless you're building a Forms application.&nbsp; For a webapplication, they are pretty much useless.&nbsp; Their concern is displaying (printing) a report, which is a pure UI artifact.<br><br>HTH<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ianinspain replied on Friday, October 27, 2006</h2>wow that has thrown me :-)<br><br>So the InvoicePrinter BO belongs in the UI classes..... but i presume it still inherits from CSLA??<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>malloc1024 replied on Friday, October 27, 2006</h2>Yes the InvoicePrinter class belongs in the UI; however, it does not inherit from any CSLA classes.&nbsp; It doesn't need too.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>malloc1024 replied on Friday, October 27, 2006</h2>

<p class="MsoNormal">Why would the InvoiceInfo object get its own data from the
database?<span>&nbsp; </span>It seems to make more sense
for it to accept an Invoice object and perhaps other objects to display an
invoice.<span>&nbsp; </span>The InvoiceInfo objects job is
to display the invoice in a proper format. <span>&nbsp;</span>It shouldn’t need access to the database.<span>&nbsp;&nbsp; </span>Think of the InvoiceInfo object as a read-only
form in the presentation layer.<span>&nbsp; </span>Does the
read-only form get its own data so it can display it or do you pass an object
to it so it can display the objects data?<span>&nbsp;
</span>Based on the logic that two objects shouldn’t interact if based purely
on data, the read-only form should get its own data from the database.<span>&nbsp; </span>However, passing an object to the read-only
form is preferable.<span>&nbsp; </span>Therefore, it seems
acceptable to pass an Invoice object to an InvoiceInfo class.<span>&nbsp; </span>Just because the InvoiceInfo class only needs
data from the Invoice class, doesn’t mean you shouldn’t pass an Invoice object
to an InvoiveInfo object.<span>&nbsp; </span>Does the
mantra, “objects are defined by behavior, not data” really mean that two object
can’t interact with each other if it is based purely on data?<span>&nbsp; </span>I am not sure that it does.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, October 27, 2006</h2><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>malloc1024:</strong></div><div>Why would the InvoiceInfo object get its own data from the
database?<span>&nbsp; </span>It seems to make more sense
for it to accept an Invoice object and perhaps other objects to display an
invoice.<span> </div></BLOCKQUOTE><br><br>Why force the user to load an invoice on the edit screen just to print it?&nbsp; It really depends on the use case.&nbsp; However...<br><br>While it might be valid to load InvoiceInfo from Invoice, I would argue against it.&nbsp;&nbsp; The reason is that you've now coupled your InvoiceInfo class to your invoice class.&nbsp; You may make a change to Invoice that requires a change to InvoiceInfo, which is something you want to avoid.&nbsp; <br><br>You don't want to put yourself into a situation where your changes in your classes cause changes to other classes, if possible.&nbsp; <br><br>A better solution would be to have the invoiceprinter accept either an invoice or invoiceinfo object.&nbsp; Ideally you'd have a factory because you should probably have an InvoiceInfoPrinter object and an InvoicePrinterObject..&nbsp; <br><br>Of course that's my opinion, you can decide for yourself if you agree.&nbsp; one of the goals in OO though is to keep things as loosely coupled as possible, so that changes to one class don't ripple through to your other classes.<br></span></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>malloc1024 replied on Friday, October 27, 2006</h2>

<p class="MsoNormal">I agree that you want to keep things as loosely coupled as
possible.<span>&nbsp; </span>To provide loose coupling
between InvoiveInfo and the Invoice classes, you would use interfaces.<span>&nbsp; </span>Allowing the InvoiceInfo class to retrieve
its own data does require the class to know about persistence logic.<span>&nbsp; </span>There are always a trade-offs.<span> &nbsp; </span><span></span>Like
you said, it does depend on the use-case. <span>&nbsp;</span>Both solutions can be acceptable depending on
the use-case.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pelinville replied on Friday, October 27, 2006</h2><P>&nbsp; <BR><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>malloc1024:</strong></div><div>Why would the InvoiceInfo object get its own data from the database?</P>
<P>It seems to make more sense for it to accept an Invoice object and perhaps other objects to display an invoice. </div></BLOCKQUOTE></P>
<P>Why force the user to load an invoice on the edit screen just to print it?&nbsp; It really depends on the use case.&nbsp; However...</P>
<P>While it might be valid to load InvoiceInfo from Invoice, I would argue against it.&nbsp;&nbsp; The reason is that you've now coupled your InvoiceInfo class to your invoice class.&nbsp; You may make a change to Invoice that requires a change to InvoiceInfo, which is something you want to avoid.&nbsp; </P>
<P>You don't want to put yourself into a situation where your changes in your classes cause changes to other classes, if possible.&nbsp; </P>
<P>A better solution would be to have the invoiceprinter accept either an invoice or invoiceinfo object.&nbsp; Ideally you'd have a factory because you should probably have an InvoiceInfoPrinter object and an InvoicePrinterObject..&nbsp; </P>
<P>Of course that's my opinion, you can decide for yourself if you agree.&nbsp; one of the goals in OO though is to keep things as loosely coupled as possible, so that changes to one class don't ripple through to your other classes.</P>
<P></div></BLOCKQUOTE></P>
<P><BR>I was trying to explain this earlier.&nbsp; </P>
<P>While loosely coupled is a design goal for the system it is not really a consideration for the object design itself.&nbsp; In fact encapsulation is one of the primary concerns of object design. Objects do not care if they are loosely coupled, only the system does.</P>
<P>This is what I was trying to explain before. Data stores, no matter they be xml files, RDBMS's or whatever, really do defeat one of the primary and most basic of object thinking. Encapsulation.</P>
<P>Ideally the data of the Invoice is only controlled by the Invoice. No other object has access to that data unless the Invoice object gives it permission.&nbsp; Having the IvoiceInfo object (or whatever) get it's data from the data store bypasses the whole concept of encapsulation. </P>
<P>Here is one of the problems I am dealing with in the world of object databases.</P>
<P>First, you have to forget that their is a pool of data out there you can create your objects from.</P>
<P>So in the original data driven design I had three Objects; Address, AddressCol and AddressDirectory.</P>
<P>Address was a simple little thing I am sure we all have created and worked with.</P>
<P>AddressDirectory was a list (collection) of all the addresses in a particular format listed with who could be reached at it.</P>
<P>There was also an AddressCol that was a collection of Address.</P>
<P>Now in the DB world when I wanted to create the AddressDirectory I went to the address table and joined it with the person, company and organization tables then loaded them into a collection of strings.</P>
<P>But In the pure object world there is no database. I can't just get all the addresses because that would mean creating an address object for each address that existed.&nbsp; Not only that but because the AddressDirectory also needs to know who (company, person, organization) the address is for, and Address objects have no idea who they belong to,&nbsp;&nbsp; So in reality I would have to load all the Company, Person and Organization objects then get their AddressCol objects to create the AddressDirectory.</P>
<P>In the DB world I simply do a few joins and tada! all the info is available.</P>
<P>So what I have ended up doing is creating a AdressRegistrator object. When a Company etc. adds or changes an address it adds its information to the AddressDirectory. (It really is just a list of strings.)</P>
<P>Now the database is kinda out of wack.&nbsp; The DB guy hates the idea of having a table that contains this "Address Directory" data because the two can go out of sync. It is just asking for abuse. So what I am doing is having a table with a single row and I am serializing the AddressDirectory to a blob. Ugly but I don't think those using the DB will try and use a big ol blob to extract data from.</P>
<P>What I am trying to say is that if you use a DB you do let data define your objects even if you don't realize it.&nbsp; Looking back it was always stupid of me to just pull the address and people names in a join to populate the AddressDirectory. Stupid from an OO perspective anyway.</P>
<P>So going back to the InvoiceInfo object.&nbsp; Having it load it's data from a data store is not good oo practice. It works fine until you have to do something like I am doing. </P>
<P>As malloc stated there are ways to keep things loosy goosy. Though in this example I don't think it is really necessary. What kind of change in an invoice object would mean the InvoicePrinter/Info object would need to change? Again invoces are a bad example because they are so common and really quite static.</P>
<P>And I don't see what advantage their is in creating an InvoiceInfo object over creating a Invoice object and using it in the InvoiceInfo object. Even in the most complex of editable business objects it's creation can't be more than a couple of cpu cycles more than creating a InvoiceInfo object.</P>
<P>Plus the InvoiceInfo object is much more complex now.&nbsp; It has all it's own crud/dataportal code.&nbsp; If it just uses the Invoice object that dataportal stuff is kept down. If the schema of the Invoice data changes then only one object would have to change.&nbsp; Which is the point of encapsulation.</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Monday, October 30, 2006</h2><P>A couple of key points.&nbsp; First, you provide a good explanation of exactly how something such as an InvoiceInfo class is intended to work.&nbsp; And, second, you provide a good example of how confusing the data-driven versus behavior-driven model can be to developers.</P>
<P>Using the example you provided, I agree that you would have three classes defined in your object model: Address, AddressCollection and AddressDirectory.&nbsp; However, to completely implement, you would also need a fourth class: AddressInfo.&nbsp; In addition, there would be no AddressDirectory table in your database as this is unnecessary (and any DBA would have fits with it).&nbsp;&nbsp;There is no one-to-one relationship between the structure of your data (in the database) and the structure of your classes (in your object model).&nbsp; Just because you want an AddressDirectory object does not mean that you need a corresponding table in your DB.&nbsp; Let me explain (and hopefully you'll see how this parallels the Invoice scenario we were discussing earlier):</P>
<P>Your AddressCollection class will be a read-write collection of Address objects which provide read-write access to the Address data and encapsulates the behavior of an Address.&nbsp; As you stated, the Address has no idea who they belong to or&nbsp;what kind of address it is (e.g. billing, shipping, etc.).&nbsp; Presumably you'll have a Customer object that has an Address property of type Address and that's how it all fits together at that level.</P>
<P>But you want a list of addresses with all of the related information for searching and listing - I assume.&nbsp; This is your AddressDirectory class - as you've stated.&nbsp; Where things deviate is that this class is actually another collection class (read-only) containing the new AddressInfo objects.&nbsp; AddressInfo is a read-only class that contains the results of the joins you mentioned.&nbsp; So, the Company, Person or Organization (as you listed) would be part of the AddressInfo class.&nbsp; It is the responsibility of this class to present the data for each directory entry.&nbsp; It is the responsibility of the AddressDirectory class to present the contents of the directory - the collection of directory entries.&nbsp; Both of these would be read-only and the contents generated based on the query you mentioned in your database that performs all of the requisite joins, etc. to generate the appropriate resultset.&nbsp; I tend to use Views for this type of thing, but that's a preference.</P>
<P>So, as you can see, there is not a one-to-one relationship between the AddressDirectory class and your database,so your assertion that the data leads itself to the object model is not entirely accurate in a behavior-driven model.</P>
<P>The case of the InvoiceInfo class will be along similar lines.&nbsp; Instead of having a heirarchical structure where the Invoice class holds a reference to the Customer object, the InvoiceInfo class may have a Customer property with the customer's name returned as a string value.</P>
<P>This leads to the question about data access and who has it, etc.&nbsp; Because the Invoice and InvoiceInfo classes (and likewise the Address and AddressInfo) classes are using data differently, they will need different data access procedures.&nbsp; Again, the Invoice object may get a reference to the customer via the foreign key held in the Invoice table whereas the InvoiceInfo gets the string name of the customer because a join was performed in the database to flatten the data model.&nbsp; Because of this, you can't have shared data access.</P>
<P>Oh, one more thing.&nbsp; The statement that you have an AddressRegistrator object whose responsibility it is to add addresses to the directory should have raised a red flag to you as this is an overlapping responsibility and causes redundant data, etc.&nbsp; Using the model described above, you can have normalized data in your database and a complete object model for your code.&nbsp; Your AddressDirectory remains robust and in sync because it is generated right from the source data - the same data that is being managed by your Address and AddressCollection classes.</P>
<P>This is a terrific example to work through because it does highlight the struggle many of us have gone through trying to rationalize how to approach things from a behavioral basis rather than being data-centric in our designs.&nbsp; I, for one, struggled with this for a while and fought with the notions of encapsulation and inheritance versus what Rocky was evangelizing until I was able to alter my perspective to understand that encapsulation and inheritance still have their place within this approach.&nbsp; I just needed to better understand and define these terms and when they are and aren't appropriate.</P>
<P>Hope all of that helps.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pelinville replied on Monday, October 30, 2006</h2><DIV><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>SonOfPirate:</strong></div><div> <BR>A couple of key points.&nbsp; First, you provide a good explanation of exactly how something such as an InvoiceInfo class is intended to work.&nbsp; And, second, you provide a good example of how confusing the data-driven versus behavior-driven model can be to developers.<BR>Using the example you provided, I agree that you would have three classes defined in your object model: Address, AddressCollection and AddressDirectory.&nbsp; However, to completely implement, you would also need a fourth class: AddressInfo.&nbsp; In addition, there would be no AddressDirectory table in your database as this is unnecessary (and any DBA would have fits with it).&nbsp; There is no one-to-one relationship between the structure of your data (in the database) and the structure of your classes (in your object model).&nbsp; Just because you want an AddressDirectory object does not mean that you need a corresponding table in your DB.&nbsp; Let me explain (and hopefully you'll see how this parallels the Invoice scenario we were discussing earlier):<BR>Your AddressCollection class will be a read-write collection of Address objects which provide read-write access to the Address data and encapsulates the behavior of an Address.&nbsp; As you stated, the Address has no idea who they belong to or what kind of address it is (e.g. billing, shipping, etc.).&nbsp; Presumably you'll have a Customer object that has an Address property of type Address and that's how it all fits together at that level.<BR>But you want a list of addresses with all of the related information for searching and listing - I assume.&nbsp; This is your AddressDirectory class - as you've stated.&nbsp; Where things deviate is that this class is actually another collection class (read-only) containing the new AddressInfo objects.&nbsp; AddressInfo is a read-only class that contains the results of the joins you mentioned.&nbsp; So, the Company, Person or Organization (as you listed) would be part of the AddressInfo class.&nbsp; It is the responsibility of this class to present the data for each directory entry.&nbsp; It is the responsibility of the AddressDirectory class to present the contents of the directory - the collection of directory entries.&nbsp; Both of these would be read-only and the contents generated based on the query you mentioned in your database that performs all of the requisite joins, etc. to generate the appropriate resultset.&nbsp; I tend to use Views for this type of thing, but that's a preference.<BR>So, as you can see, there is not a one-to-one relationship between the AddressDirectory class and your database,so your assertion that the data leads itself to the object model is not entirely accurate in a behavior-driven model.<BR>The case of the InvoiceInfo class will be along similar lines.&nbsp; Instead of having a heirarchical structure where the Invoice class holds a reference to the Customer object, the InvoiceInfo class may have a Customer property with the customer's name returned as a string value.<BR>This leads to the question about data access and who has it, etc.&nbsp; Because the Invoice and InvoiceInfo classes (and likewise the Address and AddressInfo) classes are using data differently, they will need different data access procedures.&nbsp; Again, the Invoice object may get a reference to the customer via the foreign key held in the Invoice table whereas the InvoiceInfo gets the string name of the customer because a join was performed in the database to flatten the data model.&nbsp; Because of this, you can't have shared data access.<BR>Oh, one more thing.&nbsp; The statement that you have an AddressRegistrator object whose responsibility it is to add addresses to the directory should have raised a red flag to you as this is an overlapping responsibility and causes redundant data, etc.&nbsp; Using the model described above, you can have normalized data in your database and a complete object model for your code.&nbsp; Your AddressDirectory remains robust and in sync because it is generated right from the source data - the same data that is being managed by your Address and AddressCollection classes.<BR>This is a terrific example to work through because it does highlight the struggle many of us have gone through trying to rationalize how to approach things from a behavioral basis rather than being data-centric in our designs.&nbsp; I, for one, struggled with this for a while and fought with the notions of encapsulation and inheritance versus what Rocky was evangelizing until I was able to alter my perspective to understand that encapsulation and inheritance still have their place within this approach.&nbsp; I just needed to better understand and define these terms and when they are and aren't appropriate.<BR>Hope all of that helps.<BR></div></BLOCKQUOTE></DIV>
<DIV>&nbsp;</DIV>
<DIV>It does help but I think you are missing a something.</DIV>
<DIV>&nbsp;</DIV>
<DIV>I want to assume there is no data source. None, not even a flat text file exists.</DIV>
<DIV>&nbsp;</DIV>
<DIV>(I do have to store the info encapsulated by the objects in a database at some point. This is a separate issue handled by a separate logical tier. (And btw, I am the data guy also. Yes, I do argue with myself alot.)<BR>&nbsp;CSLA does not care in the least that their is no datasource. </DIV>
<DIV>&nbsp;</DIV>
<DIV>This goes to what I said earlier.&nbsp; That just knowing there is a data source does alter the thought process and design of my objects.* <BR>&nbsp;<BR>As to the AddressRegistrator/AddressDirectory classes.<BR>&nbsp; <BR>First it really isn’t redundant data.&nbsp; The AddressDirectory is not a “List of Address Objects and their related objects”. It is a list of information provided by People, Companies and Organizations that is published to the world. The class might be misnamed. But it is misnamed because I knew I could get the data from a place outside the objects. It is supposed to be like a phone book.</DIV>
<DIV>&nbsp;</DIV>
<DIV>Even before my change all I did was join the Address table with the other tables to produce a collection of strings. The collection can sort the strings and find a string for a given criteria but that is all it does and that is all the use case called for. It is not the AddressDirectory responsibility to be up to date and or accurate. It did assume this responsiblity, poorly, when I violated encapsulation and retrieved the address data indirectly from the objects. So I created another class, AddressRegistrator, to take that responsiblity over.</DIV>
<DIV>&nbsp;</DIV>
<DIV>The problem arises when there is no longer that data store to get this information from (and to a lesser extent store it to).</DIV>
<DIV>&nbsp;</DIV>
<DIV>Now what do you do?</DIV>
<DIV>&nbsp;</DIV>
<DIV>You said use an AddressInfo object. That would mean I would have to load every Customer, Person and Organization. Then load every address for each of those. Remember there is no data source, only objects are available. </DIV>
<DIV>&nbsp;</DIV>
<DIV>This is the subtle but important (at least I think so) point.&nbsp; The solution you suggested to me assumes that there is a place I can get the data (breaking encapsulation btw) and create the objects needed for the AddressDirectory class to function. But there is no data source for my current situation.&nbsp; Realizing this forced me to admit that I was breaking some very basic OO principles to begin with.</DIV>
<DIV>&nbsp;</DIV>
<DIV>Don’t get me wrong, I don’t have all the answers. I don’t even know all the questions at this point.</DIV>
<DIV>&nbsp;</DIV>
<DIV>*In the end this has to be done if a data store of some type is used. I want to stress I am no purist. I am a Mort through and through. And I have no problem with using the powerful functionality of a database to make things both easier and more efficient.&nbsp; And if I have to bend (or even break) the rules of OOD/OOP to get something to work, I will with only a bit of hesitation. In fact I am admittedly still confused about some of the OO principles and rules put forth by the intelligentsia. But I get paid when I quickly produce something useful for our customers and they could care less whether I conformed to good object design. So be it.</DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp;</DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Monday, October 30, 2006</h2><P>I agree with you on one point but at the same time disagree with you. - that being the data-centric approach behind CSLA limiting you to database back-ends.&nbsp; I agree that&nbsp;the BO's created using CSLA are designed to make use of a back-end data store. However, I referred to it as a "data store" on purpose because there is nothing that says it has to be a database, for one, and as Rocky does point out in the book, you can bypass the data access portions by simply not using them.</P>
<P>I don't like the latter approach, but it is there.&nbsp; And, I should preface this by saying that we use our own framework which is based heavily on CSLA but not exactly Rocky's implementation.</P>
<P>For us, data agnosticity (?) was critical.&nbsp; This is evident by an application we released just this past Friday which is driven exclusively by XML files - no database.&nbsp; But our framework allows our BO's to exist in EXACTLY the same form and fashion as if the data was coming from a database.&nbsp; Why?&nbsp; Because we didn't care about the data store when we designed the objects.&nbsp; Should the customer decide six months from now that their explicit requirements to have the data maintainable in a simple-to-edit file format that doesn't require a DBA, all we have to do is flip a switch in the config file and the application will start running on top of a database.</P>
<P>So, this is where I continue to disagree with you.&nbsp; The data model does not have to affect the object model.&nbsp; I agree that in many cases it does.&nbsp; But, that's because the developer allows it to happen.&nbsp; The whole point of abstraction is to separate the two and if you find yourself altering your object model to suit your back-end data store, then there's a red flag that something's not kosher.&nbsp; Approach your design as if all of your objects are being created and populated via code. This will ensure that whatever providers you implement to create and populate your objects will be able to do so whether they are database providers like SqlClient, serializers or some other adapter such as what you will have to develop to transform the data contained in your heirchical object model into your flat AddressDirectory class.&nbsp; Point is that AddressDirectory shouldn't care where the data came from, only what to do with it - it's responsability.</P>
<P>That was the point behind Rocky's very lengthy discussion in the book of where to put the data access code.&nbsp; Yes, one can say that managing an object's data interface is a responsibility and should be handled by a separate object and there is quite a bit on that in the book.&nbsp; Rocky made the choice, and I agree with it, that this is a secondary responsibility and to achieve mobil objects, we would rather have the benefit of encapsulation that worry about splitting this out.&nbsp; Although, you will find several design patterns suggesting this is a bad approach.</P>
<P>But, even with this, in reality, we are delegating the actual responsibility of managing the data interface to objects like the DataReader.&nbsp; All our BO's are doing is telling them how to do their job.&nbsp; The BO doesn't really know how to do it, and, with a totally agnostic design, it doesn't even really know "who" is doing it.</P>
<P>I know I am drifting away from your particular case, but I think it would be worthwhile for you to keep the possibility that you could be database driven in the future in your mind when approaching your design.&nbsp; Make your AddressDirectory class&nbsp; a "shell" so to speak that makes use of other objects to populate it with data from whatever source you are using.&nbsp; If that is the role your AddressRegistrator class is intended to serve, then you are probably on the right track.&nbsp; As long as the AddressDirectory class doesn't have any knowledge of or require the AddressRegistrator class to do its job.</P>
<P>Hope that helps.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, October 30, 2006</h2><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong><strong>pelinville</strong>:</strong></div><div>While loosely coupled is a design goal for the system it is not really
a consideration for the object design itself.&nbsp; In fact encapsulation is
one of the primary concerns of object design. Objects do not care if
they are loosely coupled, only the system does.</div></BLOCKQUOTE><br><br>I know I'm nitpicking here, but I don't think this is correct.&nbsp; The system doesn't care at all about being loosely coupled either.&nbsp; The idea behind OO is to build maintainable systems.&nbsp; Decoupling allows us to build those maintainable systems.&nbsp; So if we don't have to maintain an application, then couple all you want, it doesn't matter how you put it together at all, as long as it works.<br><br>But to build the maintainable system, each class must be decoupled as much as is feasible for the implementation.&nbsp; The decoupling is what makes the whole thing more maintainable.&nbsp; We can safely change a class and know it won't have a ripple effect on other classes.<br><br><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong><strong>pelinville</strong>:</strong></div><div>This is what I was trying to explain before. Data stores, no matter
they be xml files, RDBMS's or whatever, really do defeat one of the
primary and most basic of object thinking. Encapsulation.</div></BLOCKQUOTE><br><br>This is true.&nbsp; But we don't really have a better way to store data.&nbsp; In OO, if one object of a class changes state, other objects of that class likely don't change.&nbsp;&nbsp;&nbsp; This is a problem though if that change does need to be carried around to all instances which had similar state.. for example, changing the name of a country... it really should be 'picked up' by all other instances which have that same country name.&nbsp; <br><br>Rocky acknowledges that we're breaking encapsulation... which is why using the DP is a good idea.&nbsp; At least we know the data access code is in one well despot.&nbsp; Its not scattered throughout the app.<br>&nbsp; This is the best option we have now... realistically, we need some way for the object to trigger an event that will cause it to be persisted after the application shuts down.&nbsp; Even if you moved all the data access somewhere else, at some point something somewhere is going to have to persisit the state, correct?<br><br><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong><strong>pelinville</strong>:</strong></div><div>Ideally the data of the Invoice is only controlled by the Invoice. No
other object has access to that data unless the Invoice object gives it
permission.&nbsp; Having the IvoiceInfo object (or whatever) get it's data
from the data store bypasses the whole concept of encapsulation.</div></BLOCKQUOTE><br><br>Not so.&nbsp; Imagine a company where one department generates invoices.&nbsp; Its not that departments responsibility to mark invoices as paid, as that's the accounts receivables department's job.&nbsp; If the AR department changes how it deals with marking invoices paid (or doing whatever they do with invoices), we don't want to change the code at all for the invoicing department.&nbsp; That code is tested already, we know it works.&nbsp; Having one class means not only do we have to test the code the AR department relies on, we have to test the code invoicing relies on.&nbsp; Which means we have more chances to introduce bugs into the system.&nbsp; Again, we're trying to build maintainable systems that can adapt to change.&nbsp; Which do you think is more maintainable?&nbsp; One super class that knows every behavior an invoice must perform, or several smaller classes which do one thing and one thing well?&nbsp; <br><br><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong><strong>pelinville</strong>:</strong></div><div>But In the pure object world there is no database.</div></BLOCKQUOTE><br><br>Says who?&nbsp; Why can't we have objects and databases?&nbsp; Because they don't map one to one?&nbsp; Why not just have an object that ONLY knows how to map between the db and objects?<br><br><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong><strong>pelinville</strong>:</strong></div><div>I can't just get all the addresses because that would mean creating an address object for each address that existed.</div></BLOCKQUOTE><br><br>So what?&nbsp; If your really need all your addresses in one shot, you have to store the data somehow, right?&nbsp; <br><br><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong><strong>pelinville</strong>:</strong></div><div>Not only that but because the AddressDirectory also needs to know who
(company, person, organization) the address is for, and Address objects
have no idea who they belong to,&nbsp;&nbsp; So in reality I would have to load
all the Company, Person and Organization objects then get their
AddressCol objects to create the AddressDirectory.</div></BLOCKQUOTE><br><br>Sounds more to me like you have some bad design somewhere.&nbsp; What exactly are you trying to acomplish?&nbsp; Do you really need all the addresses at once?&nbsp; Does sound likely to me..<br><br><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong><strong>pelinville</strong>:</strong></div><div>So what I have ended up doing is creating a AdressRegistrator
object. When a Company etc. adds or changes an address it adds its
information to the AddressDirectory. (It really is just a list of
strings.)
<p>Now the database is kinda out of wack.&nbsp; The DB guy hates the idea of
having a table that contains this "Address Directory" data because the
two can go out of sync. It is just asking for abuse. So what I am doing
is having a table with a single row and I am serializing the
AddressDirectory to a blob. Ugly but I don't think those using the DB
will try and use a big ol blob to extract data from.</div></BLOCKQUOTE></p>Again, sounds like bad design.&nbsp; In the database world (where you are not worried about objects), you don't store the same data twice... and this out of sync problem is exactly one good reason as to why you don't do that.<br><br><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong><strong>pelinville</strong>:</strong></div><div>What I am trying to say is that if you use a DB you do let data define
your objects even if you don't realize it.&nbsp; Looking back it was always
stupid of me to just pull the address and people names in a join to
populate the AddressDirectory. Stupid from an OO perspective anyway.</div></BLOCKQUOTE><br><br>It can be hard to avoid that trap, yes.&nbsp; But if you're doing a good OO design you won't.&nbsp; The object will need to do something.&nbsp; It will only have the data elements it needs to carry out that function.&nbsp; If there's more data (such as address info or invioce info) that it could get, but doesn't need, then it won't show up in your object design.<br><br>I have a contact object that makes three tables (not counting a bunch of lookup tables) appear as one object.&nbsp; Why?&nbsp; From the business case, it is just one object.&nbsp; On the DB side though, its most efficient to store it in different tables.<br><br><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong><strong>pelinville</strong>:</strong></div><div>So going back to the InvoiceInfo object.&nbsp; Having it load it's data from
a data store is not good oo practice. It works fine until you have to
do something like I am doing.</div></BLOCKQUOTE><br><br>If you want a maintanable system, it works well.&nbsp; As I said though, if the loading of InvoiceInfo and Invoice is idential, than there should be an InvoiceData object which knows how to fetch the data.&nbsp;&nbsp; What exactly are you doing that the InvoiceInfo abosolutely cannot load its own data?&nbsp; This thread has given you several ways to have an InvoiceInfo load from other places besides the db (including the InvoiceData class).<br><br><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong><strong>pelinville</strong>:</strong></div><div>And I don't see what advantage their is in creating an InvoiceInfo
object over creating a Invoice object and using it in the InvoiceInfo
object. Even in the most complex of editable business objects it's
creation can't be more than a couple of cpu cycles more than creating a
InvoiceInfo object.</div></BLOCKQUOTE><br><br>No one here can tell you the answer for sure, because it really does depend on your use case.&nbsp;&nbsp;&nbsp; <br><br><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong><strong>pelinville</strong>:</strong></div><div>Plus the InvoiceInfo object is much more complex now.&nbsp; It has all it's
own crud/dataportal code.&nbsp; If it just uses the Invoice object that
dataportal stuff is kept down. If the schema of the Invoice data
changes then only one object would have to change.&nbsp; Which is the point
of encapsulation.</div></BLOCKQUOTE><br><br>That's the thing; your breaking encapsulation in another spot.&nbsp; Encapsulation means that InvoiceInfo shouldn't know anything about the internals of Invoice and visa versa.&nbsp; What you are trying to achieve is code reuse, which is better acomplished by creating an InvoiceData class which BOTH InvoiceInfo and Invoice can use.&nbsp; Having an Invoice directly create and populate InvoiceInfo may break encapsulation.<br><br>Again though, your exact solution depends on your use cases.&nbsp;&nbsp; If you need InvoiceInfo without being able to first create an invoice, you'll be in trouble.&nbsp; If not, you're fine.&nbsp; If you just need to print an invoice which isn't saved, then your InvoicePrinter class should know how to print an Invoice object; why waste resources creating InvoiceInfo just to give to the InvoicePrinter class?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pelinville replied on Monday, October 30, 2006</h2><P class=MsoNormal><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong><STRONG>pelinville</STRONG>:</strong></div><div>While loosely coupled is a design goal for the system it is not really a consideration for the object design itself.&nbsp; In fact encapsulation is one of the primary concerns of object design. Objects do not care if they are loosely coupled, only the system does.</div></BLOCKQUOTE><BR><BR>I know I'm nitpicking here, but I don't think this is correct.&nbsp; The system doesn't care at all about being loosely coupled either.&nbsp; The idea behind OO is to build maintainable systems.&nbsp; Decoupling allows us to build those maintainable systems.&nbsp; So if we don't have to maintain an application, then couple all you want, it doesn't matter how you put it together at all, as long as it works. <BR><BR>But to build the maintainable system, each class must be decoupled as much as is feasible for the implementation.&nbsp; The decoupling is what makes the whole thing more maintainable.&nbsp; We can safely change a class and know it won't have a ripple effect on other classes. </div></BLOCKQUOTE></P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>No, you are right.<BR><BR><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div> <BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong><STRONG>pelinville</STRONG>:</strong></div><div>This is what I was trying to explain before. Data stores, no matter they be xml files, RDBMS's or whatever, really do defeat one of the primary and most basic of object thinking. Encapsulation.</div></BLOCKQUOTE><BR><BR>This is true.&nbsp; But we don't really have a better way to store data.&nbsp; In OO, if one object of a class changes state, other objects of that class likely don't change.&nbsp;&nbsp;&nbsp; This is a problem though if that change does need to be carried around to all instances which had similar state.. for example, changing the name of a country... it really should be 'picked up' by all other instances which have that same country name.&nbsp; <BR><BR>Rocky acknowledges that we're breaking encapsulation... which is why using the DP is a good idea.&nbsp; At least we know the data access code is in one well despot.&nbsp; Its not scattered throughout the app.<BR>&nbsp; This is the best option we have now... realistically, we need some way for the object to trigger an event that will cause it to be persisted after the application shuts down.&nbsp; Even if you moved all the data access somewhere else, at some point something somewhere is going to have to persisit the state, correct? </div></BLOCKQUOTE></P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal><SPAN>For this case, shouldn’t there only be one instance of “Country” that has that particular value?<SPAN>&nbsp; </SPAN>That way if Country.Name is changed then all things that use Country would automagically get the change.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>Now whether a Country object or a string field CountryName is used is an important question. A question that isn’t always easy to answer.<SPAN>&nbsp; </SPAN>(Country is a bad example but I am sure everybody gets the idea.)<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal><SPAN>I agree with what you are saying in that there isn’t a better way to store data if the goal is to have that data shared among many users. But there are alternatives.<SPAN>&nbsp; </SPAN>(One coming up would be the transactional file system of Avalon and simply saving objects as files.) </SPAN></P>
<P class=MsoNormal><BR><BR><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div> <BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong><STRONG>pelinville</STRONG>:</strong></div><div>Ideally the data of the Invoice is only controlled by the Invoice. No other object has access to that data unless the Invoice object gives it permission.&nbsp; Having the IvoiceInfo object (or whatever) get it's data from the data store bypasses the whole concept of encapsulation.</div></BLOCKQUOTE><BR><BR>Not so.&nbsp; Imagine a company where one department generates invoices.&nbsp; Its not that departments responsibility to mark invoices as paid, as that's the accounts receivables department's job.&nbsp; If the AR department changes how it deals with marking invoices paid (or doing whatever they do with invoices), we don't want to change the code at all for the invoicing department.&nbsp; That code is tested already, we know it works.&nbsp; Having one class means not only do we have to test the code the AR department relies on, we have to test the code invoicing relies on.&nbsp; Which means we have more chances to introduce bugs into the system.&nbsp; Again, we're trying to build maintainable systems that can adapt to change.&nbsp; Which do you think is more maintainable?&nbsp; One super class that knows every behavior an invoice must perform, or several smaller classes which do one thing and one thing well?&nbsp;</div></BLOCKQUOTE> </P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>Not if there is an InvoicePayment object. InvoicePayment MAY not be apart of the Invoice at all. InvoicePayment would probably use Invoice to do whatever it needed to do. I can’t see why invoice would need to ever know if it had been paid or not. And still Invoice is the only one that has direct access to its data.<BR><BR><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div> <BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong><STRONG>pelinville</STRONG>:</strong></div><div>But In the pure object world there is no database.</div></BLOCKQUOTE><BR><BR>Says who?&nbsp; Why can't we have objects and databases?&nbsp; Because they don't map one to one?&nbsp; Why not just have an object that ONLY knows how to map between the db and objects? </div></BLOCKQUOTE></P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>I never said we couldn’t have objects and databases. I said in the “pure object world” (which admittedly is a fantasy for most applications) there are no databases. Pure being the key word.<BR><BR><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div> <BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong><STRONG>pelinville</STRONG>:</strong></div><div>I can't just get all the addresses because that would mean creating an address object for each address that existed.</div></BLOCKQUOTE><BR><BR>So what?&nbsp; If your really need all your addresses in one shot, you have to store the data somehow, right?&nbsp;<BR><BR><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong><STRONG>pelinville</STRONG>:</strong></div><div>Not only that but because the AddressDirectory also needs to know who (company, person, organization) the address is for, and Address objects have no idea who they belong to,&nbsp;&nbsp; So in reality I would have to load all the Company, Person and Organization objects then get their AddressCol objects to create the AddressDirectory.</div></BLOCKQUOTE><BR><BR>Sounds more to me like you have some bad design somewhere.&nbsp; What exactly are you trying to acomplish?&nbsp; Do you really need all the addresses at once?&nbsp; Does sound likely to me. </P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong><STRONG>pelinville</STRONG>:</strong></div><div>So what I have ended up doing is creating a AdressRegistrator object. When a Company etc. adds or changes an address it adds its information to the AddressDirectory. (It really is just a list of strings.) </P>
<P>Now the database is kinda out of wack.&nbsp; The DB guy hates the idea of having a table that contains this "Address Directory" data because the two can go out of sync. It is just asking for abuse. So what I am doing is having a table with a single row and I am serializing the AddressDirectory to a blob. Ugly but I don't think those using the DB will try and use a big ol blob to extract data from.</div></BLOCKQUOTE></P>
<P class=MsoNormal>Again, sounds like bad design.&nbsp; In the database world (where you are not worried about objects), you don't store the same data twice... and this out of sync problem is exactly one good reason as to why you don't do that. </div></BLOCKQUOTE></P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>You are correct that is was bad design.<SPAN>&nbsp; </SPAN>The first thing that should have tipped me off was that I was violating encapsulation. The AddressDirectory object was directly accessing the Address, Customer, Person and Organization objects data without asking their opinion about the matter.</P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>But because the AddressDirectory needed the Customer and the Address data, I couldn’t just load a bunch of address objects (Which is trivial to get from the OO db, btw.) and then populate the data structure.</P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>So a compromise has to be made some place (I am the DB guy). <SPAN>&nbsp;</SPAN>At this point I am compromising the Database design instead of the object design.<BR><BR><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div> <BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong><STRONG>pelinville</STRONG>:</strong></div><div>What I am trying to say is that if you use a DB you do let data define your objects even if you don't realize it.&nbsp; Looking back it was always stupid of me to just pull the address and people names in a join to populate the AddressDirectory. Stupid from an OO perspective anyway.</div></BLOCKQUOTE><BR><BR>It can be hard to avoid that trap, yes.&nbsp; But if you're doing a good OO design you won't.&nbsp; The object will need to do something.&nbsp; It will only have the data elements it needs to carry out that function.&nbsp; If there's more data (such as address info or invioce info) that it could get, but doesn't need, then it won't show up in your object design.<BR><BR>I have a contact object that makes three tables (not counting a bunch of lookup tables) appear as one object.&nbsp; Why?&nbsp; From the business case, it is just one object.&nbsp; On the DB side though, its most efficient to store it in different tables. </div></BLOCKQUOTE></P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>I should have said “You might be letting the data side define your objects”. </P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>Another example.<SPAN>&nbsp; </SPAN>I have a Section that has a CourseNumber. (Section is a class like “8<SUP>th</SUP> grade math”.<SPAN>&nbsp; </SPAN>The CourseNumber is a simple string like “4001”).<SPAN>&nbsp; </SPAN>But really the section doesn’t have a CourseNumber, it contains a Course object that has the CourseNumber field.</P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>In the first place I don’t think the Section.CourseNumber should really even exist.<SPAN>&nbsp; </SPAN>I only put it there to make data binding easier. Even worse I set the CourseNumber during the DataPortal_Fetch by using a join between the Section and Course tables.</P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>I think the most I should do is have a field called CoursesUID and return Course.CourseNumber.</P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>At one time I thought about having a SectionListing object that joined the various tables (Session, Course, Instructor etc) but rejected it.<SPAN>&nbsp; </SPAN>Instead I created a SectionListing and use the Session, Course and Instructor to make the SectionListing class.</P>
<P class=MsoNormal><BR><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div> <BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong><STRONG>pelinville</STRONG>:</strong></div><div>So going back to the InvoiceInfo object.&nbsp; Having it load it's data from a data store is not good oo practice. It works fine until you have to do something like I am doing.</div></BLOCKQUOTE><BR><BR>If you want a maintanable system, it works well.&nbsp; As I said though, if the loading of InvoiceInfo and Invoice is idential, than there should be an InvoiceData object which knows how to fetch the data.&nbsp;&nbsp; What exactly are you doing that the InvoiceInfo abosolutely cannot load its own data?&nbsp; This thread has given you several ways to have an InvoiceInfo load from other places besides the db (including the InvoiceData class). </div></BLOCKQUOTE></P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>I am developing a click-once application that can run both connected and disconnected from the database.<SPAN>&nbsp; </SPAN>I cannot install any software on the client outside the framework itself.<SPAN>&nbsp; </SPAN>It must work with the current classes with minimal modifications. </P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>We don’t want to put copies of tables (e.g. pure xml or saved datasets) on the client for various reasons but we do want to synchronize the changes when the user does connect to the database.</P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>What looks to be my best bet so far is an object oriented database.<SPAN>&nbsp; </SPAN>The only problems I am running into are like the ones described in this thread where I have violated encapsulation. </P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>So far they are all easy to fix and the fixes have turned out to be better anyway. I am still not completely sold on this approach but it does look promising.<BR><BR><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div> <BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong><STRONG>pelinville</STRONG>:</strong></div><div>And I don't see what advantage their is in creating an InvoiceInfo object over creating a Invoice object and using it in the InvoiceInfo object. Even in the most complex of editable business objects it's creation can't be more than a couple of cpu cycles more than creating a InvoiceInfo object.</div></BLOCKQUOTE><BR><BR>No one here can tell you the answer for sure, because it really does depend on your use case.&nbsp;</div></BLOCKQUOTE>&nbsp;&nbsp; <BR><BR><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div> <BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong><STRONG>pelinville</STRONG>:</strong></div><div>Plus the InvoiceInfo object is much more complex now.&nbsp; It has all it's own crud/dataportal code.&nbsp; If it just uses the Invoice object that dataportal stuff is kept down. If the schema of the Invoice data changes then only one object would have to change.&nbsp; Which is the point of encapsulation.</div></BLOCKQUOTE><BR><BR>That's the thing; your breaking encapsulation in another spot.&nbsp; Encapsulation means that InvoiceInfo shouldn't know anything about the internals of Invoice and visa versa.&nbsp; What you are trying to achieve is code reuse, which is better acomplished by creating an InvoiceData class which BOTH InvoiceInfo and Invoice can use.&nbsp; Having an Invoice directly create and populate InvoiceInfo may break encapsulation.<BR><BR>Again though, your exact solution depends on your use cases.&nbsp;&nbsp; If you need InvoiceInfo without being able to first create an invoice, you'll be in trouble.&nbsp; If not, you're fine.&nbsp; If you just need to print an invoice which isn't saved, then your InvoicePrinter class should know how to print an Invoice object; why waste resources creating InvoiceInfo just to give to the InvoicePrinter class?<BR></div></BLOCKQUOTE></P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>InvoiceInfo is not created by Invoice.<SPAN>&nbsp; </SPAN>It is a class that takes an Invoice, Customer, Address etc. and flattens out the data for printing.<SPAN>&nbsp; </SPAN>This still maintains encapsulation.<SPAN>&nbsp; </SPAN>At no time does InvoiceInfo need to know how Invoice, Customer or Address work. I admit that if the fields exposed by any of the used classes are removed you have a problem. But that would cause problems in many other parts of the application anyway.</P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>I still have a problem and that is the business logic.<SPAN>&nbsp; </SPAN>Example: At my old job Invoices had a rule that if the total was between 4.95 and -4.95 then the total returned was zero. If an InvoiceInfo object is created from the database that logic has to be maintained in two places.</P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>You have an interesting idea in having a bunch of XXXData objects. That is basically how ORM works, right? <I><SPAN>&nbsp;</SPAN></I>I have also thought about each object having a collection of name value entries to represent its data. One problem I have with either of these is it seems I would have to give up the luxury of data binding. Also with business logic. Should it reside in the XXXData object?</P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>At any rate thank you for the input. It has helped me see what I need to do and forced me to further develop my early ideas.</P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>malloc1024 replied on Monday, October 30, 2006</h2>

<p class="MsoNormal">I believe the traditional way to approach the invoice formatting
problem is to use the strategy pattern inside an Invoice class to format an
invoice. <span>&nbsp;</span>This allows you to format an
invoice in many different ways without having to change any code inside the
Invoice class.<span>&nbsp; </span>The strategy pattern
might not be appropriate for all invoice formatting problems, but it can help in
many.<span>&nbsp; </span>The two sites listed below also suggest
using the strategy pattern to format an invoice.<span>&nbsp; </span></p>


<p class="MsoNormal"><o:p>&nbsp;</o:p></p>


<p class="MsoNormal"><a href="http://www.csis.gvsu.edu/%7Etao/CS621/Proj4%20-%20Inovice%20Management.htm">http://www.csis.gvsu.edu/~tao/CS621/Proj4%20-%20Inovice%20Management.htm</a></p>


<p class="MsoNormal"><a href="http://cse.yeditepe.edu.tr/%7Etaytekin/cse349-2005-Fall/slides/Ch5/Ch5.html">http://cse.yeditepe.edu.tr/~taytekin/cse349-2005-Fall/slides/Ch5/Ch5.html</a></p>


<p class="MsoNormal"><o:p>&nbsp;</o:p></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, October 30, 2006</h2>Right, that is likely a valid method also, although I would think the actual formatters should live in the UI layer... How something is formatted is irrelevent to the business logic.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>malloc1024 replied on Wednesday, October 25, 2006</h2>

<p class="MsoNormal">A responsibility is a reason to change.<span>&nbsp; </span>If the class has more than one reason to
change it has more than one responsibly.<span>&nbsp;
</span>The single-responsibility principle is a fundamental principle that
states that a class should only have one reason to change.<span>&nbsp; </span>An example that violates this principle is
placing your persistence logic in your business classes.<span>&nbsp; </span>Doing so gives your class two reasons to
change and thus violates the principle.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pelinville replied on Wednesday, October 25, 2006</h2>&nbsp;<BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>Typically yes, that's what you would do.&nbsp; Printing the invoice being edited would likely make use of the edtiable business object, although you have to think about things like 'can the user print an invoice not in a valid state?'&nbsp; Eitehr way though, the UI uses the business object (editable or not) to create the report, but the invoice object doesn't know (or care) about what is done with it.&nbsp; It is only concerned that its state is valid and providing a way to query about its state. 
<P>What you do in a scenario depends on your exact use case however.&nbsp; You build classes to satsify the requirements of a use case.&nbsp; If your next use case can reuse those objects (meaning that the use case has some behaviors in common) then you can do it.&nbsp; If not, you may have to build another object which operations on the same data but does something different with it.</P>
<P>Disconnected is a whole other issue, that doesn't have much to do with Csla.&nbsp; For example, how do you save an invoice if you aren't connected to the database?&nbsp; Those are seperate issues from Csla.</P>
<P></div></BLOCKQUOTE></P>
<P>I understand what you are saying but I don't understand.... something.</P>
<P>I am asking this because our first release is now stable and I now have time to clean up some crappy code I wrote during the "crunch time" (AKA re-factoring time!!!)</P>
<P>Add to that I am finally really looking deep into object databases.&nbsp; (I am using it to allow the application to work off-line.)</P>
<P>Two things I keep hearing over and over just don't ring true to me.</P>
<P>&nbsp;</P>
<P>1. Objects are defined by their behavior, not data. </P>
<P>&nbsp;</P>
<P>This is easy to say when the data is easy to get from just about any where. But after using an object database for a bit you quickly see that objects are, in part, defined by their data.</P>
<P>Think about it.&nbsp; Think about your application with no traditional database.&nbsp; Think about having an application that is always "ON".&nbsp; If there is no "database", no place where the raw data is stored, then what object has what data becomes very important. (And what class&nbsp;holds what type of data is also.)&nbsp;If you can't just go to some mythical place and load phonenumber with id xxxx then how do you get the phone number?</P>
<P>It isn't really that surprising when you stop and think about it.&nbsp; But due to the power of relational databases we never stop and think about it.</P>
<P>Which brings me to..</P>
<P>&nbsp;</P>
<P>2. Objects are defined by their behavior, not their data.</P>
<P>&nbsp;</P>
<P>From a different perspective I don't think people are really doing this.&nbsp; Take the example that was mentioned above. </P>
<P>"InvoiceInfo object would know how to get it's data".<SPAN>&nbsp; </SPAN>And where exactly does the data live?<SPAN>&nbsp; </SPAN>In the Invoice, of course!<SPAN>&nbsp; </SPAN>But that is not what that sentence meant.<SPAN>&nbsp; </SPAN>It meant that the data is not apart of the application at all.<SPAN>&nbsp; </SPAN>That the data is someplace else and not apart of any object.<SPAN>&nbsp; </SPAN></P>
<P>&nbsp;</P>
<P>What this leads to is that the database is an integral part of the application. With business lines of application the database becomes 50% or more of the application.</P>
<P>&nbsp;</P>
<P>I don't think I am saying this correctly. It sounds like I am criticizing something.<SPAN>&nbsp; </SPAN>I am not. </P>
<P>&nbsp;</P>
<P>Hmmm</P>
<P>&nbsp;</P>
<P>I think what I am trying to say is that when you say "objects are defined by behavior not data" you are making an assumption that something else is taking care of the data.</P>
<P>&nbsp;</P>
<P>When you can not assume that, your view points changes, radically.</P>
<P>&nbsp;</P>
<P>I am starting to see ever more clearly what David West was talking about. Kinda. Now I have to read that book, yet again.</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dean replied on Thursday, October 26, 2006</h2>pelinville,<br><br>I had to clean up my own code and upgrade to 2.1 recently. This is a project that originated in VB6, then went net 1.0, net 1.5, and now 21. When doing so I looked hard at my biggest classes (lots of properties) and the ones that I new were kinda hacked to get certain functionality. By hacked I meant anytime I was getting away from the basic CSLA/Project tracker type structure.<br><br>In some instances I couldn't/didtn't want to change the code but usually I found that refactoring into other classes and encapulsating them into my "big" classes cleaned things up. In some instances upon reflection I saw that I was intertwining UI and BO responsibilities and that moving the code out of the bo and into the UI it would simplify. I would occasionally create a UI class to manipulate the bus objects to make presentation easier.<br><br>When going thru this process I would keep the rules in mind: one object, one responsibility, keep UI code out of BO, double check use cases for accuracy. These would tend to push me towards more objects, but better organized and simpler objects. <br><br>My two cents...<br><br>Dean<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
