<html><header><title>Winpart from a winpart</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Winpart from a winpart</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2773.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>CSLABound posted on Wednesday, April 25, 2007</h2><P>Using the Project Tracker example from the book, is there way to add and show a winpart to the main form (adding it to the document listing)&nbsp;through a different loaded winpart (instead of from the main form)?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, April 25, 2007</h2><P>No, the main form has to show it so it can track the document history, etc.</P>
<P>But you could add a Shared/static method to the main form to allow other code to request such navigation:</P><PRE><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> mMainForm </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> MainForm</P>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> DisplayWinPart(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> part </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> WinPart)</P>
<P>&nbsp; mMainForm.ShowWinPart(part)</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT></PRE>
<P>Then in Form_Load or the form's constructor just make sure to set mMainForm to Me so that reference is available and all should be well.</P>
<P>With this addition, any child form can create a WinPart and can request that it be displayed by calling MainForm.DisplayWinPart().</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>CSLABound replied on Wednesday, April 25, 2007</h2><P>Thank you so much.&nbsp;&nbsp; I will be trying this out now.</P>
<P>&nbsp;</P>
<P>Brian</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>CSLABound replied on Wednesday, May 23, 2007</h2><P>I realize it's been a little while since I posted against this.... the code above I believe is VB, how would a person do this in C#?</P>
<P>Thanks again,</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, May 23, 2007</h2><P>Exactly the same way</P>
<P>private static MainForm _mainForm;</P>
<P>public static void DisplayWinPart(WinPart part)<BR>{<BR>&nbsp; _mainForm.ShowWinPart(part);<BR>}</P>
<P>If you find translating code from language to language difficult, I recommend Instant C# and Instant VB from Tangible. I've been using their product to convert C#-&gt;VB and VB-&gt;C# for months now, and it has made maintaining CSLA in both languages at least tolerable.</P>
<P>Given the number of excellent code examples floating in one language or the other, I <EM>strongly</EM> recommend that everyone at least learn to read both languages (it isn't like they are very different to start with). Failing that, something like Instant C# is an excellent alternative.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
