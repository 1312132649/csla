<html><header><title>Questions about SafeDataReader, Null columns</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Questions about SafeDataReader, Null columns</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8750.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav posted on Thursday, April 01, 2010</h2><p>I have many bit columns which (rightfully) can be true, false or null.&nbsp; When I read them into Properties declared as bool? using the SafeDataReader, I find that the values of each&nbsp;Property are faithfully set as true, false or null - and I am happy because my Three-State Checkboxes work just fine.</p>
<p>But then I am listening to the SL Video on DataAccess and Rocky says, &quot;if you are using null columns,&nbsp;then do not use SafeDataReader&quot;.&nbsp; &nbsp;&quot;Woh&quot;, I say, is that a fluke that everything is working fine?&quot;&nbsp; So, I decided that I better ask.&nbsp; I think, SafeDataReader ought to work as it is working right now since SqlServer allows three states for a bit column, a&nbsp;CheckBox allows for three states, SafeDataReader allows for true, false or null values for a&nbsp;bool? property, and life is good.</p>
<p>Jav</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>ajj3085 replied on Thursday, April 01, 2010</h2><p>Well, the whole point of SafeDataReader is that it frees you from worrying about null values, which you usually don&#39;t care about. </p>
<p>If you don&#39;t want that behavior for bool or any other datatype, don&#39;t use the SafeDataReader.</p>
<p>That said, something is up, because looking at the code GetBoolean should in fact be returning false when it encounters a null from the database.&nbsp; So I suggest you double check your code, but you shouldn&#39;t be seeing what you&#39;re seeing.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Thursday, April 01, 2010</h2><p>Hi Andy,</p>
<p>I do not use GetBoolean - that indeed was only returning true or false.&nbsp; I use GetValue() and that returns true, false or null.&nbsp; I expect that that is by design.</p>
<p>Jav</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Thursday, April 01, 2010</h2><p>Also, I would hate not to be able to use SafeDataReader.&nbsp; Just to be able to use Column names, instead of [0], [1] etc, is worth every penny.</p>
<p>Jav</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>Jav replied on Thursday, April 01, 2010</h2><p>Okay, I have looked it up now - should have done that in the first place.&nbsp; GetValue does return null if DataReader returns null, whereas GetBoolean changes nulls to false.&nbsp; </p>
<p>Then perhaps we should say that we can still use SafeDataReader but use GetValue() instead of the more specific GetWhatever() for those columns where we do want to use nulls.&nbsp; I have at least one, often more than one, SmartDate field in every Table - so switching to SqlDataReader wouldn&#39;t work for me.&nbsp; Have never used it - that&#39;s why I didn&#39;t know that GetOrdinal is a method in IDataReader, not an add on in SafeDataReader. Learning!</p>
<p>Jav</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pinchers1jm replied on Thursday, April 01, 2010</h2><p>I subclassed the the SafeDataReader class to create the attached NullableDataReader class which is able to handle both nullable and non nullable columns.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Thursday, April 01, 2010</h2><p><div style='padding-left: 50px;background-color:silver'><b>pinchers1jm<br></b> </p>
<p>I subclassed the the SafeDataReader class to create the attached NullableDataReader class which is able to handle both nullable and non nullable columns.</p>
<div style="CLEAR:both;"></div>
<p></div><br />But you don&#39;t need to do all that work.&nbsp; For any DataColumn where you need to have your nullable column&#39;s null value placed in your Property, simply use:</p>
<p>dr.GetValue(&quot;MyNullableColumnName&quot;), instead of</p>
<p>dr.GetString(&quot;MyNullableColumnName&quot;) or dr.GetWhatever(&quot;&quot;).</p>
<p>The GetValue() code in Csla first checks to see if the DataReader has returned a null.&nbsp; If so it will hand that null to you.</p>
<p>Jav</p>
<p>&nbsp;</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
