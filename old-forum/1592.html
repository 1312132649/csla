<html><header><title>Newbie - validation version 1.53</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Newbie - validation version 1.53</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1592.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>griff posted on Wednesday, October 25, 2006</h2>How do I implement validation......like this....<br><font size="2"><br><span>in the save button </span><br><br><span>If mJobDate.BrokenRulesCollection.Count = 0 Then</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mJobDate.ApplyEdit()</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mJobDate = DirectCast(mJobDate.Save, TranslationLib.cJobDate)</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BindFields()</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Cursor.Current = Cursors.Default</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return True</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim Message As CSLA.BrokenRules.Rule</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For Each Message In mJobDate.BrokenRulesCollection</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBox.Show("Cannot Save because.." &amp; vbNewLine &amp; Message.Description, "Error: " &amp; Message.Property, MessageBoxButtons.OK, MessageBoxIcon.Error)</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return False</span><br><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br><br>For a new object how to I implement validation as the property may not be updated causing the broken rules bit to be actioned ??<br><br><br></span></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fintanv replied on Wednesday, October 25, 2006</h2>Just curious, but is there a reason why you are not binding the enabled property of your save button, to the IsSavable property of the business object?&nbsp; In this case the user would be unable to save while the bo is in an unchanged or invalid state.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>griff replied on Wednesday, October 25, 2006</h2>I could do this now you mention it but how would you report back to the user which fields are invalid.<br>Also (I may be doing something wrong) but when I create the new BO I notice IsValid is set to true.<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fintanv replied on Wednesday, October 25, 2006</h2><P>There are several options including:</P>
<P>1. displaying the broken rules in a tree object.</P>
<P>2. use the error provider component.</P>
<P>For the second part of your question; are you checking the rules as part of the process for creating your object via Create or Fetch?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>griff replied on Thursday, October 26, 2006</h2>I don't want to use the tree.&nbsp; <br><br>How do you implement the error provider with csla?&nbsp; There does not seem to be any examples in the project tracker sample.<br><br>For the second part of your question......I assume that I add in the rules when I create the object<br><br>e.g. BrokenRules.Assert("NameLen", "Name too long", Len(Value) &gt; 50)<br><br>Thanks<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, October 26, 2006</h2>Just add the errorprovider component to your form.&nbsp;&nbsp; Point it to the bindingsource to which your object will be bound.&nbsp; Enjoy blinking error icons.<br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
