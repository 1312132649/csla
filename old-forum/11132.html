<html><header><title>ValidationRules That Modify Property Data (Csla 3.8.3)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ValidationRules That Modify Property Data (Csla 3.8.3)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11132.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>comp1mp posted on Monday, February 06, 2012</h2><p>Hi,</p>
<p>I was hoping to create a common validation rule which would modify the data of a property. </p>
<p>If the phone number provided is only 7 digits, automatically append a default area code.</p>
<p>If i create the rule for each class that has a phone number, this is not an issue, as I can access LoadProperty to set the new value.</p>
<p>Trying to create a common rule, it appears that the only way to modify the data is by calling the property setter using reflection. </p>
<p>Is there a mechanism for invoking LoadProperty within a Common rule? </p>
<p>I noticed that CallType.Get results in a call to SetProperty internally. CallType.Let appears to do nothing at all...</p>
<p>&nbsp;</p>
<p>Thanks,</p>
<p>Matthew</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Monday, February 06, 2012</h2><p>I don&#39;t think there was a <em>supported</em> way to call LoadProperty like that in 3.8, no.</p>
<p>But you could create a type that inherits from ObjectFactory, and have that type expose a LoadProperty method, and then call that method from your rule. I did that at one point as a workaround for something, and it worked fine :)</p>
<p>fwiw, CallType.Let does nothing because that really hasn&#39;t had meaning since VB6. It exists to support the Let keyword in VB, and that keyword fundamentally changed from VB6 to VB.NET - in a way that rendered it largely useless I&#39;m afraid... Because CSLA .NET had no use for the Let concept there was no reason to implement anything for that value.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>comp1mp replied on Tuesday, February 07, 2012</h2><p>Thanks for the quick reply Rocky.</p>
<p>My initial concern was calling property setter would result in a recursive call&nbsp; to the rule. As long as the developer is mindful of this, using the property setter through reflection is an acceptable solution.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, February 07, 2012</h2><p>Calling the property setter WILL result in a recursive call.</p>
<p>I was suggesting a workaround so you can call LoadProperty in a 3.8 rule like we support in a 4.0 rule.</p>
<p>Alternately you can use BypassPropertyChecks and call the setter - that&#39;d have the same result.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>comp1mp replied on Tuesday, February 07, 2012</h2><p>I&#39;m sorry, I was unclear. I realize that it results in a recursive call, and was just saying it is incumbent on the developer to be mindful of that when implementing the rule.<br /><br />I think there may be some confusion about the OP. I am referring to a common validation rule. One that is not in a business object class definition where I would have access to the protected LoadProperty method (or BypassPropertyChecks).</p>
<p>How would I refer to BypassPropertyChecks in a common rule? </p>
<p>public static bool ValidatePhoneNumber&lt;T&gt;(T target, RuleArgs e) where T : OrionCsla.BusinessBase&lt;T&gt;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, February 07, 2012</h2><p>Sorry, I keep forgetting what isn&#39;t in 3.8...</p>
<p>The same technique I described about creating a subclass of Csla.Server.ObjectFactory to expose a LoadProperty method could also be used to expose a BypassPropertyChecks method.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>comp1mp replied on Tuesday, February 07, 2012</h2><p>No problem:). Your help is much appreciated!</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
