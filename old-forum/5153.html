<html><header><title>Binding to deleted data.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Binding to deleted data.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5153.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>sholder posted on Thursday, July 24, 2008</h2><P><FONT face=Tahoma>I'm looking for a reasonable way to deal with binding a property to a list of elements where the value in the property longer exist in the list.</FONT></P>
<P><FONT face=Tahoma>Rocky posted in February </FONT><A HREF="/forums/permalink/22663/21504/ShowThread.aspx#21504"><FONT face=Tahoma>some pseudo code </FONT></A><FONT face=Tahoma>where a Record class had a Company, Office and Department.&nbsp; For arguments sake let's say that an office was closed and for data integrity the system uses a deleted flag rather than actually removing the record from the system.</FONT></P>
<P><FONT face=Tahoma>My question is if the current record has a reference to an office which has been closed, logically the call to OfficeList.GetList(this.Company); would return only offices which are still open.&nbsp; In this case the binding of the OfficeID property would fail.</FONT></P>
<P><FONT face=Tahoma>I was curious as to what solutions others may have come up with.</FONT></P>
<P><FONT face=Tahoma>Shane Holder</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Lalit replied on Friday, July 25, 2008</h2><P>Hi,</P>
<P>For such issues the practise we follows is while fetching the child data, we adds a join in querry to relate the child data with master record and checks if it is deleted. To fetch deleted data as well an overload of Get method is used which ommits the check for deleted flag. This is in response of what i understood from your querry. If it is something else please revert back, i would be pleased to help you if i am capable of. :)</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>sholder replied on Friday, July 25, 2008</h2><P class=MsoNormal><SPAN><FONT face="Courier New"><FONT face=Tahoma size=2>I guess what I am thinking is something along the lines of adding another overload to GetList which would take&nbsp; this.Company as a parameter and an OfficeListId.&nbsp; So that GetList would know that it would need to fetch the current OfficeList entry for Record, then it would need to make sure the entry was not duplicated in the list.</FONT></FONT></SPAN></P>
<P class=MsoNormal><SPAN><FONT face="Courier New"><FONT size=2>public class Record<BR></FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>{<BR></FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>&nbsp;&nbsp;&nbsp; [NonSerialized]<BR></FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>&nbsp;&nbsp;&nbsp; private OfficeList _officeList;<BR></FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>&nbsp;&nbsp;&nbsp; [Browsable(false)]<BR></FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>&nbsp;&nbsp;&nbsp; public&nbsp;OfficeList OfficeList<BR></FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>&nbsp;&nbsp;&nbsp; {<BR></FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get<BR></FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR></FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_officeList == null)<BR></FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _officeList = OfficeList.GetList(this.Company, this.OfficeListId);<BR></FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return _officeList;<BR></FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR></FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>&nbsp;&nbsp;&nbsp; }</FONT></FONT></SPAN></P>
<P class=MsoNormal><SPAN><FONT face="Courier New"><FONT size=2><O:P>&nbsp;&nbsp;&nbsp;public&nbsp;int _OfficeListId;<BR></O:P></FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2><O:P>&nbsp;&nbsp;&nbsp;<SPAN><FONT face="Courier New"><FONT size=2>&nbsp;public&nbsp;int OfficeListId<BR></FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>&nbsp;&nbsp;&nbsp; {<BR></FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get </FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>{</FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>&nbsp;</FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>return _OfficeListId;</FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>}<BR><SPAN><FONT face="Courier New"><FONT size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set </FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>{</FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>&nbsp;</FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>_OfficeListId = value;</FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2>}<BR></FONT></FONT></SPAN></FONT></FONT></SPAN></O:P></FONT></FONT></SPAN><SPAN><FONT face="Courier New"><FONT size=2><O:P><SPAN><FONT face="Courier New"><FONT size=2>&nbsp;&nbsp;&nbsp; }</FONT></FONT></SPAN></O:P></FONT></FONT></SPAN></P>
<P class=MsoNormal><SPAN><O:P><FONT face="Courier New" size=2>[Rest of code removed for brevity]</FONT></O:P></SPAN></P>
<P class=MsoNormal><SPAN><O:P><FONT face="Courier New" size=2>}</FONT></O:P></SPAN></P>
<P class=MsoNormal><SPAN><O:P><FONT face="Courier New" size=2>Shane Holder</FONT></O:P></SPAN></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, July 25, 2008</h2><P>I have run into this issue extensively.</P>
<P>Basically, I add the deleted value to the list of values and allow it to bind correclty. Then I have rules which say that if the user changes the value it must be to any realy value but if they keep it to the exact same value (which was deleted), then&nbsp;the record&nbsp;will be allowed to be re-saved with other changes. </P>
<P>For example, say we are talking about account codes.</P>
<P>An existing transaction record has account code 123.</P>
<P>Later an Admin de-activates (not deletes) the master record for 123 (flips Status from A to D).</P>
<P>When a user edits the transaction record 123 is added to the list of valid accounts (even though it is de-activated).</P>
<P>The user can change other values in the record and leave&nbsp;account code as&nbsp;123 and the rules take this into consideration - the original de-activated value is the only value which can be saved to the DB that has Status D. If they change the value to any acitve account, no issue at all. They just can't change it to a different de-activated account.</P>
<P>Hope that makes sense.</P>
<P>Joe</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
