<html><header><title>Help with validation</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Help with validation</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4300.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>griff posted on Tuesday, February 05, 2008</h2><P>Hi</P>
<P>I have done this so far:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> AddBusinessRules()</P>
<P>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> Q1)(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> ValueNotZero(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> Q1), </FONT><FONT color=#a31515 size=2>"InWork"</FONT><FONT size=2>)</P>
<P>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> Q1)(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> ValueNotZero1(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> Q1), </FONT><FONT color=#a31515 size=2>"OtherHouseholderWorking"</FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> ValueNotZero(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Q1)( </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> target </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> T, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Validation.RuleArgs) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Bo</FONT><FONT color=#0000ff size=2>olean</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> target.m_inWork = 0 </FONT><FONT color=#0000ff size=2>Then</P></FONT><FONT size=2>
<P>e.Description = </FONT><FONT color=#a31515 size=2>"1) Please answer this question - In/out Work?"</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>False</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Else</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>True</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>False</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> ValueNotZero1(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Q1)( </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> target </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> T, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Validation.RuleArgs) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean</P>
<P></FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> target.m_otherHouseholderWorking = 0 </FONT><FONT color=#0000ff size=2>Then</P></FONT><FONT size=2>
<P>e.Description = </FONT><FONT color=#a31515 size=2>"8a) Please answer this question"</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>False</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Else</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>True</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT>
<P>But I have serveral more fields that require the same validation i.e. &gt; 0. I didn't want to repeat ValueNotZero2,3,4,5....... and so on</P>
<P>How can I combine into one ValueNotZero function and implement.&nbsp; My guess I'm being somewhat thick here.</P>
<P>Thanks</P>
<P>Richard</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Tuesday, February 05, 2008</h2><P>Richard,</P>
<P>You can do this by moving the rule into a class like Rocky's Common Rules. I basically copied his rules into my own class and namespace and then continued to add my own.</P>
<P>So you might have a rule like this:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> KeyNotZero(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> target </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> RuleArgs) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> ruleArg </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> myRuleArgs = </FONT><FONT color=#0000ff size=2>DirectCast</FONT><FONT size=2>(e, myRuleArgs)<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> propertyName </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = ruleArg.PropertyName<BR>&nbsp;&nbsp;</FONT><FONT size=2><BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> value </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2>= </FONT><FONT color=#0000ff size=2>CInt</FONT><FONT size=2>(CallByName(target, propertyName, CallType.Get))<BR><BR>&nbsp; </FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> value = 0 </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>e.Description =&nbsp;propertyName &amp; </FONT><FONT color=#ff00ff size=2>" cannot be 0."<BR>&nbsp;&nbsp; &nbsp;</FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>False<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Else<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>True<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT>
<P>This rule can call other functions to determine e.Description if you need to vary it.</P>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>griff replied on Wednesday, February 06, 2008</h2><P>Thanks for the reply.</P>
<P>I have copied in common rules and added in your function -&nbsp;but I'm having difficulty calling the validation</P><FONT size=2>
<P>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> CustomValidation.KeyNotZero(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> Q1), </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> CustomValidation.RuleArgs(</FONT><FONT color=#a31515 size=2>"InWork"</FONT><FONT size=2>, </FONT><FONT color=#a31515 size=2>"1. Are you in work"</FONT><FONT size=2>), </FONT><FONT color=#a31515 size=2>"InWork"</FONT><FONT size=2>)</FONT></P>
<P><FONT size=2>How would you call?</FONT></P>
<P><FONT size=2>Thanks</FONT></P>
<P><FONT size=2>Richard</FONT></P>
<P><FONT size=2></FONT>&nbsp;</P>
<P><FONT size=2></FONT>&nbsp;</P>
<P><FONT size=2>&nbsp;</P></FONT>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, February 06, 2008</h2><FONT size=2>
<P></FONT><FONT size=3>You can remove the (OfQ1) as it is not required for general rules.</FONT></P>
<P>I call it like this:</P>
<P>ValidationRules.AddRule(<FONT color=#0000ff>AddressOf</FONT> KeyNotZero, <FONT color=#0000ff>New</FONT> MyRuleArgs(<FONT color=#ff00ff>"AKeyPropertyName"</FONT>))</P>
<P>If you have extra parameters in your rule args you might call it like this:</P>
<P>ValidationRules.AddRule(<FONT color=#0000ff>AddressOf</FONT> KeyNotZero, <FONT color=#0000ff>New</FONT> MyRuleArgs(<FONT color=#ff00ff>"InWork", "1. Are you in work"</FONT>))</P>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>griff replied on Wednesday, February 06, 2008</h2><P>Hi</P>
<P>thank Joe, I have done this but get compile error</P>
<P>Error&nbsp;1&nbsp;Overload resolution failed because no accessible 'AddRule' can be called with these arguments:<BR>&nbsp;&nbsp;&nbsp; 'Public Sub AddRule(Of T, R As Csla.Validation.RuleArgs)(handler As Csla.Validation.RuleHandler(Of T, R), args As R)': Type parameter 'T' for 'Public Sub AddRule(Of T, R As Csla.Validation.RuleArgs)(handler As Csla.Validation.RuleHandler(Of T, R), args As R)' cannot be inferred.<BR>&nbsp;&nbsp;&nbsp; 'Public Sub AddRule(handler As Csla.Validation.RuleHandler, args As Csla.Validation.RuleArgs)': Method 'Public Function KeyNotZero(target As Object, e As InsiteLib.CustomValidation.RuleArgs) As Boolean' does not have the same signature as delegate 'Delegate Function RuleHandler(target As Object, e As Csla.Validation.RuleArgs) As Boolean'.<BR>&nbsp;&nbsp;&nbsp; 'Public Sub AddRule(handler As Csla.Validation.RuleHandler, args As Csla.Validation.RuleArgs)': Value of type 'InsiteLib.CustomValidation.KeyNotZeroRuleArgs' cannot be converted to 'Csla.Validation.RuleArgs'.<BR>&nbsp;&nbsp;&nbsp; 'Public Sub AddRule(Of T)(handler As Csla.Validation.RuleHandler(Of T, Csla.Validation.RuleArgs), propertyName As String)': Type parameter 'T' for 'Public Sub AddRule(Of T)(handler As Csla.Validation.RuleHandler(Of T, Csla.Validation.RuleArgs), propertyName As String)' cannot be inferred.<BR>&nbsp;&nbsp;&nbsp; 'Public Sub AddRule(handler As Csla.Validation.RuleHandler, propertyName As String)': Method 'Public Function KeyNotZero(target As Object, e As InsiteLib.CustomValidation.RuleArgs) As Boolean' does not have the same signature as delegate 'Delegate Function RuleHandler(target As Object, e As Csla.Validation.RuleArgs) As Boolean'.<BR>&nbsp;&nbsp;&nbsp; 'Public Sub AddRule(handler As Csla.Validation.RuleHandler, propertyName As String)': Value of type 'InsiteLib.CustomValidation.KeyNotZeroRuleArgs' cannot be converted to 'String'.&nbsp;C:\Inetpub\wwwroot\Insite\InsiteLib\InsiteLib\Q1.designer.vb&nbsp;1908&nbsp;9&nbsp;InsiteLib<BR></P>
<P>I call using:</P><FONT size=2>
<P>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> CustomValidation.KeyNotZero, </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> CustomValidation.KeyNotZeroRuleArgs(</FONT><FONT color=#a31515 size=2>"InWork"</FONT><FONT size=2>, 0))</P></FONT>
<P>Must be doing something wrong</P>
<P>Richard</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
