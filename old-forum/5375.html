<html><header><title>CSLA.NET 3.5: Indexed properties</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA.NET 3.5: Indexed properties</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5375.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Patrick posted on Tuesday, September 09, 2008</h2>Hi,<br><br>is there any way to get to an indexed property in a business list without using Linq?<br><br>class Customer{<br>[Indexed]<br>public string Id;<br>}<br><br>class BusinessList&lt;Customer&gt; {<br>&nbsp;&nbsp; public Customer GetCustomerById(string id){<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // How to get the Customer using the index without using Linq<br>&nbsp;&nbsp; }<br>}<br><br>Thanks a lot,<br>Patrick<br><br>PS: The reason that I'm asking that I call a similar method ~ 5000 times in a recursive loop and LINQ has quite&nbsp; an overhead due to compiling the query (which looks for a different value every time).<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, September 10, 2008</h2>You'll probably have to keep a hashtable in your BLB for this.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Wednesday, September 10, 2008</h2><P>Sounds to me like you have a specific use case that would require a specific business object to satisfy.&nbsp; Rather than performing 'x' number of GetCustomerById calls, you should have a business object designed specifically for the function you are performing.</P>
<P>For example, if you load your data into a&nbsp;Dictionary&lt;string, Customer&gt; keyed on the id value, then the lookups can be performed much quicker using the built-in capabilities of the dictionary.</P>
<P>HTH</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Patrick replied on Wednesday, September 10, 2008</h2>In CSLA.NET 3.5 BusinessListBase has a member<br><br>&nbsp;&nbsp;&nbsp; private Linq.IIndexSet&lt;C&gt; _indexSet;<br><br>so when you add the [Indexable] attribute to a property it's indexed automatically.<br><br>You can search the index via this interface which BusinessListBase implements:<br>&nbsp; internal interface IIndexSearchable&lt;T&gt;<br>&nbsp; {<br>&nbsp;&nbsp;&nbsp; IEnumerable&lt;T&gt; SearchByExpression(Expression&lt;Func&lt;T, bool&gt;&gt; expr);<br>&nbsp; }<br><br>I was just wondering if I could access the index directly without going via the SearchByExpression method. The reason for this is that the expression has to be compiled each time which introduces an overhead in itself.<br><br>Thanks,<br>Patrick<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AaronErickson replied on Thursday, September 11, 2008</h2>That is a very interesting question.<br><br>I would probably use the IndexingProvider property, and write a class that supports IIndexSet that works in a manner closer to what you describe.<br><br>Alternatively, I could see if Rocky wants to open up the _index to be a protected field and perhaps make the IndexSet concrete class not internal anymore.&nbsp; But frankly, to keep things simple, you probably want to provide your own similar, but slightly different indexing implementation.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Patrick replied on Thursday, September 11, 2008</h2><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>AaronErickson:</strong></div><div><br>Alternatively, I could see if Rocky wants to open up the _index to be a protected field and perhaps make the IndexSet concrete class not internal anymore.&nbsp; <br></div></BLOCKQUOTE><br>I'm quite happy to do this in my version of CSLA.NET <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /><br><br>Would you have a sample of how I could access an item in the list directly if I were to do the above?<br><br>Thanks,<br>Patrick<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AaronErickson replied on Friday, September 12, 2008</h2>In SearchByExpression, which has the general case, we do this:<br /><br />foreach (C item in _indexSet.Search(expr, property))<br />   yield return item;<br /><br />Basically, call the search method with the exact property you want to search on.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
