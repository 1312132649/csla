<html><header><title>SetProperty() problems with SmartDate - winForms Databinding / BusinessBase</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>SetProperty() problems with SmartDate - winForms Databinding / BusinessBase</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7793.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Reto posted on Thursday, October 15, 2009</h2>Dear Rocky<br /><br />It seems that SetProperty does not work correct with SmartDate.<br /><br />1) any (default) values set by the databinding are not reflectet on the control <br />2) BusinessRules (StringRequired etc.) do not have the new value set by the SetProperty.<br /><br />I have in my BusinessBase class the following code:<br /><br />   Private mSomeDate As New SmartDate(False)<br />...<br /> Private Shared SomeDateProperty As PropertyInfo(Of String) = RegisterProperty(New PropertyInfo(Of String)("SomeDate"))<br />    Public Property SomeDate() As String<br />        Get<br />        Return GetProperty(Of String)(SomeDateProperty, mSomeDate.Text)<br />        End Get<br />        Set(ByVal Value As String)<br />            SetProperty(Of String)(SomeDateProperty, mSomeDate.Text, Value)<br />        End Set<br />    End Property<br /><br />regards reto</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, October 15, 2009</h2><P>You need to use SetPropertyConvert() and GetPropertyConvert() when the type of the property does not match the type of the backing value.</P>
<P>In your example the type of the property is string and the type of the backing value is datetime, so you need to convert between the two types.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
