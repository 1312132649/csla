<html><header><title>Decendents..</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Decendents..</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3667.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rb157 posted on Monday, October 08, 2007</h2><P>Forgive my lack of experience, I am completely self taught in c# and have recently picked up the CSLA to extend my knowledge. I think that I am coming to grips with it, but have reached a problem with descendents beyond children. I know that this has been discussed elsewhere, including in an old forum which I cannot find. </P>
<P>I am creating an application where I shall provide a list of Albums. Each Album has a list of songs and each song has a list of artists. Now lets assume that I have a large collection of albums, how&nbsp;do I use CSLA to populate all of the albums with songs and those songs with artists?</P>
<P>I have seen around these forums various suggsestions for solving this problem, along with a article by Rocky which may be found here:</P>
<P><A href="http://www.lhotka.net/Article.aspx?id=8354fb43-f676-48dc-b6a8-692f7ba27bb0">http://www.lhotka.net/Article.aspx?id=8354fb43-f676-48dc-b6a8-692f7ba27bb0</A></P>
<P>Firstly this seems to guide against including a superset of records including album, song and artist info in each record. Whilst I fundamentally agree with this I wondered about the reasoning behind this, Rocky does state that the information will be replicated on each row, and therefore would be impractical. However in my case I only have the attributes album name, song name, artist name, therefore the amount of duplicated data would be pretty small therefore to me it would appear to be a reasonable approach, to avoid overloading my db with thousands of calls to return my list. </P>
<P>This however got me thinking: </P>
<P>If the duplicated data is low then this may be a reasonable approach. Lets say I have lots of other info in my list: the albums have album cover images and dates and a review. Then I am starting to get lots of data. Well surely then I can split into many results sets in one stored procedure but with each result having reference to its parent id. I.E. </P>
<P><FONT face="Courier New">select id, name, image from album;</FONT></P>
<P><FONT face="Courier New">select albumid, id, name from song;</FONT></P>
<P><FONT face="Courier New">select albumid, songid, id from artist;</FONT></P>
<P>I can then work my way through the three results sets to populate the business objects. This is however where things get complicated so I started to think about how to do this. I was thinking along the lines in the following post: </P>
<P><A HREF="/forums/permalink/3702/3721/ShowThread.aspx#3721">http://forums.lhotka.net/forums/permalink/3702/3721/ShowThread.aspx#3721</A></P>
<P>But I had a concern about the use of this[cageId] within the following code: </P>
<P><FONT face="Courier New">internal void GetCageAnimals(SafeDataReader dr)<BR>{<BR>&nbsp;&nbsp;&nbsp; while (dr.Read())<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Guid cageId = dr.GetGuid("CageId");<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Cage cage = this[cageId];<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; if (cage != null)<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; cage.Animals.GetAnimal(dr);<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; }<BR>}</FONT><BR></P>
<P>Apologies for the long post, but does this work? My understanding is that Cages is a BusinessListBase&lt;Cages,Cage&gt; or ReadOnlyList&lt;Cages,Cage&gt; class which both inherit indirectly from Collection&lt;T&gt;. Within which the&nbsp;only index is the standard array int index. Therefore the cageId would need to be the int index in the cages object which could not be retrieved from the database. This would however work if BusinessListBase/ReadOnlyList (or an alternative)&nbsp;inherited from&nbsp;Dictionary&lt;TKey,TValue&gt; and TKey was always the database primary key id.</P>
<P>Does this make sense, i.e. &nbsp;is the approach sound? If so should would the framework need to change to support this approach?</P>
<P>I am not sure how a dictionary works internally to provide the key/value link, however I suppose a foreach loop could be used to find the parent object to add a child to, or a dictionary could be maintained seperately in the Cages object. Would both of these lead to poor performance compared to cages being a dictionary?</P>
<P>Many Thanks,</P>
<P>Richard<FONT color=#2b91af size=2></P>
<P></FONT><FONT size=2>&nbsp;</P></FONT>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rb157 replied on Tuesday, October 09, 2007</h2><P>Just found and watched Rocky's <A href="http://www.dnrtv.com/default.aspx?showID=60">DNRTV video on this subject</A>. This seems to describe an approach similar to that thaqt I and <A HREF="/forums/permalink/3702/3721/ShowThread.aspx#3721">Tom Cooly </A>and I have&nbsp;described. However I have an issue regarding the method of finding the objects to add new children and grandchildren to. I am sure that the method within Tom's example will not work, and in Rocky's this is described in the FindById methods of the list objects by looping through the list to find the required object. </P>
<P>I tend to use Dictionary&lt;TKey, TValue&gt; objects wherever I am going to need to find a specific object in the collection for optimum performance as I am always concerned that looping through a collection will not perform sufficiently as the collection increases in size.</P>
<P>I may be wrong about performance of collection looping verses Dictionary access, but would appreciate comment on whether it would be worth considering implementation of Dictionary inherited&nbsp;object&nbsp;to replace or in addition to the Collection inheritance of the current ReadOnlyList objects currently within the framework.</P>
<P>&nbsp;</P>
<P>Richard</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
