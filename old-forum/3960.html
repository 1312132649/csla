<html><header><title>How to create a CSLA template/base object?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How to create a CSLA template/base object?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3960.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>HerbertLehner posted on Thursday, November 29, 2007</h2><P>Hi,</P>
<P>I created an approval system which consists of several workflow types with questionnaires and with attached approval process. The resulting CSLA objects are largely identical (workflow start/end date etc. [approx. 40 identical properties and 10 identical methods). My idea was to create a template object from which the specialized workflow objects can inherit. I started like this:</P>
<P>&lt;Serializable()&gt; _<BR>Public Class WF_Base<BR>&nbsp; Inherits BusinessBase(Of WF_Base)</P>
<P>... base properties and methods</P>
<P>end class</P>
<P>Then I created a specialized CSLA workflow object which inherits from the template:</P>
<P>&lt;Serializable()&gt; _<BR>Public Class WF_Type1<BR>&nbsp; Inherits WF_Base</P>
<P>... special properties and methods</P>
<P>&nbsp; Public Overrides Function Save() As WF_Type1<BR>&nbsp;&nbsp;&nbsp; ... do something here<BR>&nbsp;&nbsp;&nbsp; Return MyBase.Save()<BR>&nbsp; End Function</P>
<P><BR>end class</P>
<P><BR>The problem is, that the Save-method of WF_Base returns type WF_Base and the overriden Save-method of WF_Type1 returns WF_Type1 which is not allowed.</P>
<P>Does anyone know how to solve the problem?</P>
<P>Thanks,</P>
<P>Herbert</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, November 29, 2007</h2><P>Try something like this:</P><FONT color=#008000 size=2><FONT color=#0000ff size=2><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> Save() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> WF_Type1<BR>&nbsp; </FONT><FONT color=#008000 size=2>'Return MyBase.Save</FONT></P>
<P><FONT color=#008000 size=2>' ... do something here</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp; If</FONT><FONT size=2> IsDirty </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>DirectCast</FONT><FONT size=2>(DataPortal.Update(</FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>), WF_Type1)<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Else<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>DirectCast</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>, WF_Type1)<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT></FONT></FONT>
<P>&nbsp;</P>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>HerbertLehner replied on Friday, November 30, 2007</h2><P>Thanks for the tip, but it solves only one half of the problem: </P>
<P>Public<FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> Save() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> WF_Type1</FONT></P>
<P><FONT size=2>is still defined to return WF_Type1 an causes a compiler error.</FONT></P>
<P><FONT size=2>Herbert</P>
<P><BR></P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>triplea replied on Friday, November 30, 2007</h2><P>What if you try the following (I'm not too good in VB so will give the example in C# and a poor attempt in VB):</P>
<P>C#:<BR>public abstract class WF_Base&lt;T&gt; : BusinessBase&lt;T&gt; where T : WF_Base&lt;T&gt; { ... }<BR>VB:<BR>Public Class WF_Base&lt;T&gt;&nbsp;Inherits BusinessBase(Of WF_Base) Where T : WF_Base&lt;T&gt;</P>
<P>Then&nbsp;define your concrete classes as follows:</P>
<P>C#:<BR>public class WF_Type1: WF_Base&lt;WF_Type1&gt;<BR>{<BR>&nbsp;&nbsp;&nbsp;public override WF_Type1 Save() { ...&nbsp; return base.Save();&nbsp;}<BR>}<BR>VB:<BR>Public Class WF_Type1 Inherits WF_Base&lt;Of WF_Type1)<BR>&nbsp;&nbsp;&nbsp;Public Overrides Function Save()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return MyBase.Save()&nbsp;&nbsp;&nbsp;'This should now be of type WF_Type1<BR>&nbsp;&nbsp;&nbsp;End Function<BR>End Class</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, November 30, 2007</h2><P>I am not sure why you are getting a compile error.</P>
<P>I use that trick a lot.</P>
<P>Is there some reason you even have a Save method in Base?</P>
<P>If you are overriding it anyway then try removing it.</P>
<P>Joe</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
