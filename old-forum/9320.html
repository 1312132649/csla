<html><header><title>Suggestion needed on CSLA route given Framework version limitations</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Suggestion needed on CSLA route given Framework version limitations</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9320.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>TSF posted on Wednesday, August 04, 2010</h2><p>A few of my co-workers and I&nbsp;have been reading about (and experimenting with) CSLA over the past year, and have recently been given the opportunity by mgmt to officially go the CSLA route for future projects.&nbsp; Among a number of questions we now face, one stands out which we&#39;re not sure how to address: which version of CSLA do we target when building our business objects?&nbsp; Here&#39;s our scenario:</p>
<p>Our company has a considerable number of WinXP SP1 &amp; SP2 machines (40% or so)&nbsp;with the remaining being WinXP SP3 and&nbsp;a few new Win 7 machines.&nbsp; Per Micrsoft, the .NET 4.0 framework only&nbsp;runs on WinXP SP3 or higher, while the 3.0/3.5 framework runs on SP2 or higher.</p>
<p>I have concern about which version of&nbsp;CSLA we&#39;ll target when building our business objects, particularly from a binding support standpoint in WPF.</p>
<p>While we may need to fallback to WinForms 2.0 for apps that go to everyone in the company (in order to support SP1 machines), we&#39;ll also have projects that will target a subset of users that are guaranteed to have WinXP SP3 or Win 7, which means we&#39;d like to use the .NET 4.0 Framework for those cases.</p>
<p>Are there any recommendations in this scenario regarding how we should go about building our objects?&nbsp; Is it reasonable to assume that if we build out, say, a vendor object, that we could maintain two versions without too many coding differences between them?&nbsp; In other words, one to support .NET 2.0 clients, another to support .NET 3.5 or 4.0 clients?&nbsp;Would an object built against CSLA 3.0.5 be consumable in a WPF (3.5 or 4.0 framework) app?</p>
<p>Thanks.</p>
<p>TF</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dlambert replied on Wednesday, August 04, 2010</h2><p>Is a web client a possibility? &nbsp;This might let you run .Net 4.0 on the web server, at least.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TSF replied on Wednesday, August 04, 2010</h2><p>In a few cases it could be, but we&#39;ve got a lot of existing WinForms apps that we&#39;ll be migrating to using CSLA.&nbsp; In addition, we&#39;ve got a lot of VB6 apps that we&#39;ll be migrating to .NET via the Interop Forms Toolkit, and their requirements dictate a WinForms (or WPF, eventually) scenario.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>tmg4340 replied on Wednesday, August 04, 2010</h2><p>Unfortunately, I don&#39;t think that maintaining multiple versions of your BO within a single codebase&nbsp;will be particularly effective or easy.&nbsp; If you have to slide all the way back to .NET 2.0, you&#39;re going to be going back several versions of CSLA.&nbsp; There have been major changes in property management, business-rule/authorization implementation, and other areas that aren&#39;t really backwards compatible - either because they use non-2.0-supported functionality, or because they were never back-ported into prior versions.&nbsp; Some backwards compatibility is maintained, but likely not enough for you to be able to maintain the same BO code and link/re-compile against different .NET targets/CSLA versions.</p>
<p>Additionally, there are significant differences in the data-binding infrastructure between WinForms and WPF, and different collection base classes that have to be used to get all the functionality.&nbsp; WinForms works off a BindlingList, while WPF works best off an ObservableCollection.&nbsp; WPF partially supports BindingList, but not completely - which is why you see two sets of collection base classes in CSLA 4.&nbsp; Rocky has essentially deprecated WinForms in CSLA 4.</p>
<p>If you want to use the &quot;lowest common denominator&quot; approach (find the version of CSLA that is supported in every environment), you&#39;ll have to go to the download page and find the latest 2.0 version.&nbsp; I know there&#39;s been some work by the community to back-port some features of more-current versions, but you still won&#39;t get everything.&nbsp; Otherwise, you&#39;re likely looking at multiple codebases to maintain.</p>
<p>HTH</p>
<p>- Scott</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Wednesday, August 04, 2010</h2><p>If you need to use .NET 2.0, you should consider using the N2 version of CSLA. That&#39;s basically CSLA 3.7 that can run on .NET 2 (with some helper components that provide some .NET 3.5 features to .NET 2).</p>
<p>Otherwise you&#39;d have to use CSLA 3.0.5, which pre-dates the new property declaration syntax. And that&#39;s a pretty big deal, since moving from 3.0 to 3.8 or 4 would require a lot of work (at least if you want to use the newer features). That property declaration syntax was a big, and important, change.</p>
<p>On the other hand, if you can at least target .NET 3.5 SP1, then you can use CSLA 3.8, which is pretty good. It is true that CSLA 4 replaces the business/authorization rules mechanism, but for the most part 3.8 code is quite similar to CSLA 4 code outside the rules area.</p>
<p>For validation rules, at least, if you can use DataAnnotations attributes, those carry forward from 3.8 to 4 - so that can help minimize the upgrade effort to some degree.</p>
<p>All that said - it is also the case that the &quot;old style&quot; 3.0 code (for the most part) still works without change in 3.8. You can&#39;t use all the 3.8 features, but the older style code generally continues to function. But to get to CSLA 4 you really do need to start at least using RegisterProperty - which means reworking the old style property declarations.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TSF replied on Wednesday, August 04, 2010</h2><p>Thanks to both of you for your answers...I&#39;lll have to think through those things with the other developers.&nbsp; Until then, can I ask if anyone has any experience running a .NET 3.5sp1/4.0 app on an WinXP SP1 or SP2 machine?&nbsp; I know MS doesn&#39;t support it, but I have been able to install the .NET 4.0 famework on an SP2 machine.&nbsp; I just don&#39;t know what kind of issues I might run into if I used .NET 4.0 / CSLA 4 on an SP1 or SP2 machine.</p>
<p>Thanks.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>asinc replied on Friday, August 06, 2010</h2><p>Given all of the complexity in your environment perhaps you should seriously evaluate moving this to Silverlight? Then you can go 4.0 for everything and get all of the other related benefits of SL?</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
