<html><header><title>Business object based on security</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Business object based on security</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6380.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dbrillon posted on Monday, February 09, 2009</h2><P>Hi,</P>
<P>I would like to know how to extract my business objects based on the current user. Let me explain&nbsp;what I need to do.&nbsp; Let say that I have business objects representing a fleet of vehicles.&nbsp; Each fleet&nbsp;can have many&nbsp;garages and each garage&nbsp;has many vehicles.&nbsp;&nbsp;The users are not allowed to see all the vehicles but only the ones in the garages they are assigned.&nbsp;&nbsp;How could I implement this&nbsp;with CSLA.net.&nbsp;&nbsp;Is there a way to filter the data retreived by the Fetch method of the DataPortal based on the security principal of the current user? </P>
<P>Thanks,</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, February 10, 2009</h2><P>I would think you'd do that sort of filtering directly in your SQL statements. So your data access code would do the filter based on information you have about the user.</P>
<P>User information is typically contained in the .NET identity object. You can create a custom identity object that contains information about the user, such as the garage to which they are assigned. To do this, create a serializable object that implements IIdentity, or that inherits from Csla.Security.CslaIdentity (that's easier) and just add your extra properties.</P>
<P>There are some sample apps in the Samples folder that show how to do this, and there are unit tests for CslaIdentity that also show some techniques.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dbrillon replied on Tuesday, February 10, 2009</h2><P>Thanks a lot.&nbsp; I will take a look at the sample.</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Tuesday, February 10, 2009</h2><P>In our case, we prefer to separate security concerns from what we consider to be profile information, such as the garage to which the user is assigned.&nbsp; We use the Name property of the IIdentity object to retrieve the UserInfo for the current user.&nbsp; The UserInfo object would have a Garage property (or a PropertyBag) containing the value for the setting.</P>
<P>While you can have the property on your custom IIdentity or IPrincipal object(s), we opt not to so that these objects are kept small.&nbsp; If we did use these objects for profile information, then we would have to retrieve all of the profile values each time we authenticated, serialize/deserialize 'em and hold them in memory, etc.&nbsp;even if we had no use for the information.&nbsp; In other words, by separating the identity and profile information, we only have to load the profile settings (which in our case can be large) when we need them.</P>
<P>Something to think about, anyway.&nbsp; Hope that helps.</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
