<html><header><title>MVVM UoW Binding and OnModelChanged</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>MVVM UoW Binding and OnModelChanged</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10508.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Russ posted on Friday, July 08, 2011</h2><p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I have been using the MVVM videos to create an application in Silverlight 4 using CSLA 4.1, MVVM and bxf. This application has a very common search page that has 3 combo boxes, a search button and a search results list.</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I have created a Search (Editable Root) object with one property for each of the 3 combo box selected values and one property for the search results (Read Only) list. I have created a SearchUoW object with 4 properties, one for each combo box list and one for the Search (Editable Root) object. I have created my ViewModel&lt;SearchUoW&gt; and use BeginRefresh(&ldquo;GetSearchUoW&rdquo;) to load the properties when the user control is created. I have also implemented a collection of ViewModels for the search result line items since each will have an Edit hyperlink.</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I have created a search button on the view and a triggeraction to call a search method on the VM. This method calls a method on the Search object (property of SearchUoW) telling it to load the search results with the filter criteria specified in the other search properties.</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">The problem is the OnModelChanged event doesn&rsquo;t fire when the SearchResults property of the Search property changes. This means the UI is never notified and never updates.</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Is there a way to do this or have I structured my solution incorrectly?</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Thanks</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Russ.</span></span></p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Saturday, July 09, 2011</h2><p>I usually use a separate viewmodel to manage each object.</p>
<p>The ViewModel&lt;T&gt; type is a DependencyObject, and the Model property is a dependency property, so it is bindable. In other words, you can have a &quot;root&quot; viewmodel to hold the UOW, and then bind &quot;child&quot; viewmodel resources to each object retrieved by the UOW by binding the Model property to the root viewmodel.</p>
<p>This way your UI can bind to the viewmodel that manages a specific object - and if that object changes, then those UI elements will automatically rebind.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Russ replied on Sunday, July 10, 2011</h2><p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Thanks for the reply Rocky. I&rsquo;m obviously still missing something because I&rsquo;m still having difficulty getting the UI to display the search results since I added the UOW.</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I have now created 3 viewmodels:</span></span></p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-list:l0 level1 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">1)</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">SearchPageViewModel : ViewModel&lt;Library.SearchUOW&gt;</span></span></p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-list:l0 level1 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">2)</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">SearchPageSearchViewModel : DependencyObject</span></span></p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-list:l0 level1 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">3)</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">SearchItemViewModel : DependencyObject</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<h1 style="margin:24pt 0in 0pt;"><span style="color:#365f91;"><span style="font-family:Cambria;">SearchPageViewModel</span></span></h1>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">This is the UOW VM that has a property for each of the 3 combobox item sources and a forth property containing the editable root object. The constructor calls the model get factory method.</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">class</span> <span style="color:#2b91af;">SearchPageViewModel</span> : <span style="color:#2b91af;">BaseViewModel</span>&lt;Library.<span style="color:#2b91af;">SearchUOW</span>&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> SearchPageViewModel()</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="mso-tab-count:1;">&nbsp; </span><span style="color:#2b91af;">Shell</span>.Instance.ShowStatus(<span style="color:blue;">new</span> <span style="color:#2b91af;">Status</span> { Text = <span style="color:#a31515;">&quot;Loading...&quot;</span>, IsBusy = <span style="color:blue;">true</span> });</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="mso-tab-count:1;">&nbsp; </span>BeginRefresh(<span style="color:#a31515;">&quot;GetSearchUOW&quot;</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in;"><span style="font-family:Consolas;color:green;font-size:8pt;mso-bidi-font-size:9.5pt;">// buttons</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> <span style="color:blue;">void</span> Search()</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:green;">//Shell.Instance.ShowStatus(new Status { Text = &quot;Loading...&quot;, IsBusy = true });</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>Model.Search.GetSearchResults();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<h1 style="margin:24pt 0in 0pt;"><span style="color:#365f91;"><span style="font-family:Cambria;">SearchPageSearchViewModel</span></span></h1>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">This is the VM I created as a result of your last reply. I based it on DependencyObject and the Model is of type Library.Search. It contains the observable collection for SearchItemViewModels. This code worked before I started using the UOW and was basing this class on ViewModel&lt;Library.Search&gt; but now that the class is based on DependencyObject the OnModelChanged event is not found.</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">class</span> <span style="color:#2b91af;">SearchPageSearchViewModel</span> : <span style="color:#2b91af;">DependencyObject</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> <span style="color:blue;">static</span> <span style="color:blue;">readonly</span> <span style="color:#2b91af;">DependencyProperty</span> ModelProperty </span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>= <span style="color:#2b91af;">DependencyProperty</span>.Register(<span style="color:#a31515;">&quot;Model&quot;</span>, <span style="color:blue;">typeof</span>(Library.<span style="color:#2b91af;">Search</span>), <span style="color:blue;">typeof</span>(<span style="color:#2b91af;">SearchPageSearchViewModel</span>), <span style="color:blue;">null</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> Library.<span style="color:#2b91af;">Search</span> Model</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">get</span> { <span style="color:blue;">return</span> (Library.<span style="color:#2b91af;">Search</span>)GetValue(ModelProperty); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">set</span> { SetValue(ModelProperty, <span style="color:blue;">value</span>); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> <span style="color:#2b91af;">ObservableCollection</span>&lt;<span style="color:#2b91af;">SearchItemViewModel</span>&gt; SearchList</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">get</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">var</span> result = <span style="color:blue;">new</span> <span style="color:#2b91af;">ObservableCollection</span>&lt;<span style="color:#2b91af;">SearchItemViewModel</span>&gt;();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (Model != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">foreach</span> (<span style="color:blue;">var</span> item <span style="color:blue;">in</span> Model.LineItems)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>result.Add(<span style="color:blue;">new</span> <span style="color:#2b91af;">SearchItemViewModel</span> { Model = item });</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">return</span> result;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">protected</span> <span style="color:blue;">override</span> <span style="color:blue;">void</span> OnModelChanged(Library.<span style="color:#2b91af;">Search</span> oldValue, Library.<span style="color:#2b91af;">Search</span> newValue)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">base</span>.OnModelChanged(oldValue, newValue);<span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp; </span>//ERROR HERE</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (oldValue != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>oldValue.LineItems.CollectionChanged -= <span style="color:blue;">new</span> System.Collections.Specialized.<span style="color:#2b91af;">NotifyCollectionChangedEventHandler</span>(Model_CollectionChanged);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (newValue != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>newValue.LineItems.CollectionChanged += <span style="color:blue;">new</span> System.Collections.Specialized.<span style="color:#2b91af;">NotifyCollectionChangedEventHandler</span>(Model_CollectionChanged);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>OnPropertyChanged(<span style="color:#a31515;">&quot;SearchList&quot;</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">private</span> <span style="color:blue;">void</span> Model_CollectionChanged(<span style="color:blue;">object</span> sender, System.Collections.Specialized.<span style="color:#2b91af;">NotifyCollectionChangedEventArgs</span> e)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>OnPropertyChanged(<span style="color:#a31515;">&quot;SearchList&quot;</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<h1 style="margin:24pt 0in 0pt;"><span style="color:#365f91;"><span style="font-family:Cambria;">SearchItemViewModel</span></span></h1>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">This class is unchanged since the introduction of the UOW.</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">class</span> <span style="color:#2b91af;">SearchItemViewModel</span> : <span style="color:#2b91af;">DependencyObject</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> <span style="color:blue;">static</span> <span style="color:blue;">readonly</span> <span style="color:#2b91af;">DependencyProperty</span> ModelProperty =<span style="color:#2b91af;">DependencyProperty</span>.Register(<span style="color:#a31515;">&quot;Model&quot;</span>, <span style="color:blue;">typeof</span>(Library.<span style="color:#2b91af;">SearchLineItem</span>), <span style="color:blue;">typeof</span>(<span style="color:#2b91af;">SearchItemViewModel</span>), <span style="color:blue;">null</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> Library.<span style="color:#2b91af;">SearchLineItem</span> Model</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">get</span> { <span style="color:blue;">return</span> (Library.<span style="color:#2b91af;">SearchLineItem</span>)GetValue(ModelProperty); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">set</span> { SetValue(ModelProperty, <span style="color:blue;">value</span>); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> <span style="color:blue;">void</span> Edit()</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">MessageBox</span>.Show(<span style="color:#a31515;">&quot;Edit pressed on SearchLineItem &quot;</span>+ Model.ContractPK.ToString());</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">My SearchPage view has the following CVSs:</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">&lt;</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">UserControl.Resources</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">&gt;</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in;"><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp; </span></span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">&lt;</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">CollectionViewSource</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> x</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">:</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;">Key</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=&quot;searchPageViewModelViewSource&quot;</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> d</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">:</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;">DesignSource</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=&quot;{</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">d</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">:</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">DesignInstance</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> my</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">:</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;">SearchPageViewModel</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">,</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> CreateList</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=True}&quot; /&gt;</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in;"><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span></span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">&lt;</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">CollectionViewSource</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> x</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">:</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;">Key</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=&quot;searchPageSearchViewModelViewSource&quot;</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> Source</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=&quot;{</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">Binding</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> Path</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=Search,</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> Source</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">={</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">StaticResource</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> searchPageViewModelViewSource</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">}}&quot; /&gt;</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in;"><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span></span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">&lt;</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">CollectionViewSource</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> x</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">:</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;">Key</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=&quot;searchPageSearchViewModelSearchListViewSource&quot;</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> Source</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=&quot;{</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">Binding</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> Path</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=SearchList,</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> Source</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">={</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">StaticResource</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> searchPageSearchViewModelViewSource</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">}}&quot; /&gt;</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">&lt;/</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">UserControl.Resources</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">&gt;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I have a feeling that I&rsquo;m really close but I just can&rsquo;t seem to get it to work!</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I have bound the combo boxes and they work. I have bound textboxes to the Search properties for the search criteria and they are correctly being set. I have bound a textbox to Search.LineItems.Count and I have implemented a search button that calls the search method on the SearchPageViewModel. When the button is pressed the count correctly changes from zero to the search results count.</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">The major remaining issue is binding the datagrid to the search results so they will display.</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">The minor remaining issue is figuring out how to have the GetSearchResults method on the Search object be able to tell the VM when it has completed so I can clear the &ldquo;Loading...&rdquo; status message.</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Thanks for the help</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Russ.</span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, August 04, 2011</h2><p>Typically with a UOW scenario the Model property of the root viewmodel changes exactly one time - when the UOW comes back from the server.</p>
<p>When that happens, in your root viewmodel&#39;s OnRefreshed overload you will probably set the properties to make the various objects in the UOW available through the child viewmodels.</p>
<p>Your SearchItemViewModel manages an editable root object though right? So it should subclass ViewModel&lt;T&gt; too - thus allowing your Save and Cancel buttons to bind to the Save and Cancel methods of that particular viewmodel.</p>
<p>The SearchPageSearchViewModel is managing the read-only list right? So it should have a method (verb) that is triggered when the selection is changed by the user in the UI. So the datagrid&#39;s SelectedItemChanged (or similar) event should be bound to that method - and that method will create a new SearchItemViewModel.</p>
<p>The SearchPageSearchViewModel is the viewmodel that should have a property to expose the SearchItemViewModel object.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Russ replied on Friday, August 05, 2011</h2><p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">Hi Rocky,</span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">I have modeled my objects as follows:</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">SearchUOW</span></span></p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-list:l0 level1 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-ascii-font-family:Calibri;mso-fareast-font-family:Calibri;mso-hansi-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">-</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">List Property1 &ndash; bound to combobox1</span></span></p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-list:l0 level1 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-ascii-font-family:Calibri;mso-fareast-font-family:Calibri;mso-hansi-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">-</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">List Property2 &ndash; bound to combobox2</span></span></p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-list:l0 level1 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-ascii-font-family:Calibri;mso-fareast-font-family:Calibri;mso-hansi-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">-</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">List Property3 &ndash; bound to combobox3</span></span></p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-list:l0 level1 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-ascii-font-family:Calibri;mso-fareast-font-family:Calibri;mso-hansi-font-family:Calibri;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">-</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">Search Editable Root Property</span></span></p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 1in;mso-list:l0 level2 lfo1;"><span style="font-family:&#39;Courier New&#39;;mso-fareast-font-family:&#39;Courier New&#39;;"><span style="mso-list:Ignore;"><span style="font-size:small;">o</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">Property1 &ndash; bound to selected value of combobox1</span></span></p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 1in;mso-list:l0 level2 lfo1;"><span style="font-family:&#39;Courier New&#39;;mso-fareast-font-family:&#39;Courier New&#39;;"><span style="mso-list:Ignore;"><span style="font-size:small;">o</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">Property2 &ndash; bound to selected value of combobox2</span></span></p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 1in;mso-list:l0 level2 lfo1;"><span style="font-family:&#39;Courier New&#39;;mso-fareast-font-family:&#39;Courier New&#39;;"><span style="mso-list:Ignore;"><span style="font-size:small;">o</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">Property3 &ndash; bound to selected value of combobox3</span></span></p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 1in;mso-list:l0 level2 lfo1;"><span style="font-family:&#39;Courier New&#39;;mso-fareast-font-family:&#39;Courier New&#39;;"><span style="mso-list:Ignore;"><span style="font-size:small;">o</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">Property4 &ndash; bound to selected value of datapicker</span></span></p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 1in;mso-list:l0 level2 lfo1;"><span style="font-family:&#39;Courier New&#39;;mso-fareast-font-family:&#39;Courier New&#39;;"><span style="mso-list:Ignore;"><span style="font-size:small;">o</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">ListItems Property (collection of search results)</span></span></p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 1in;mso-list:l0 level2 lfo1;"><span style="font-family:&#39;Courier New&#39;;mso-fareast-font-family:&#39;Courier New&#39;;"><span style="mso-list:Ignore;"><span style="font-size:small;">o</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">GetSearchResults() method</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<h2 style="margin:10pt 0in 0pt;"><span style="font-size:medium;"><span style="color:#4f81bd;"><span style="font-family:Cambria;">SearchUOW</span></span></span></h2>
<h2 style="margin:10pt 0in 0pt;"><span style="line-height:115%;font-family:Consolas;color:blue;font-size:8pt;font-weight:normal;mso-bidi-font-family:Arial;mso-bidi-font-size:10.0pt;mso-bidi-font-weight:bold;">public class</span><span style="line-height:115%;font-family:Consolas;color:black;font-size:8pt;font-weight:normal;mso-bidi-font-family:Arial;mso-bidi-font-size:10.0pt;mso-bidi-font-weight:bold;"> </span><span style="line-height:115%;font-family:Consolas;color:#2b91af;font-size:8pt;font-weight:normal;mso-bidi-font-family:Arial;mso-bidi-font-size:10.0pt;mso-bidi-font-weight:bold;">SearchUOW</span><span style="line-height:115%;font-family:Consolas;color:black;font-size:8pt;font-weight:normal;mso-bidi-font-family:Arial;mso-bidi-font-size:10.0pt;mso-bidi-font-weight:bold;"> : </span><span style="line-height:115%;font-family:Consolas;color:#2b91af;font-size:8pt;font-weight:normal;mso-bidi-font-family:Arial;mso-bidi-font-size:10.0pt;mso-bidi-font-weight:bold;">ReadOnlyBase</span><span style="line-height:115%;font-family:Consolas;color:black;font-size:8pt;font-weight:normal;mso-bidi-font-family:Arial;mso-bidi-font-size:10.0pt;mso-bidi-font-weight:bold;">&lt;</span><span style="line-height:115%;font-family:Consolas;color:#2b91af;font-size:8pt;font-weight:normal;mso-bidi-font-family:Arial;mso-bidi-font-size:10.0pt;mso-bidi-font-weight:bold;">SearchUOW</span><span style="line-height:115%;font-family:Consolas;color:black;font-size:8pt;font-weight:normal;mso-bidi-font-family:Arial;mso-bidi-font-size:10.0pt;mso-bidi-font-weight:bold;">&gt;</span><span style="line-height:115%;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:7pt;font-weight:normal;mso-bidi-font-size:9.0pt;mso-bidi-font-weight:bold;"></span></h2>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">Which contains a Search property and a number of collection properties used to populate the combo boxes.</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">static</span> <span style="color:blue;">readonly</span> <span style="color:#2b91af;">PropertyInfo</span>&lt;<span style="color:#2b91af;">Search</span>&gt; SearchProperty = RegisterProperty&lt;<span style="color:#2b91af;">Search</span>&gt;(c =&gt; c.Search);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:#2b91af;">Search</span> Search</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">get</span> { <span style="color:blue;">return</span> GetProperty(SearchProperty); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">private</span> <span style="color:blue;">set</span> { LoadProperty(SearchProperty, <span style="color:blue;">value</span>); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">static</span> <span style="color:blue;">readonly</span> <span style="color:#2b91af;">PropertyInfo</span>&lt;<span style="color:#2b91af;">TypeList</span>&gt; TypeListProperty = RegisterProperty&lt;<span style="color:#2b91af;">TypeList</span>&gt;(c =&gt; c. TypeList);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:#2b91af;">TypeList</span> TypeList</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">get</span> { <span style="color:blue;">return</span> GetProperty(TypeListProperty); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">private</span> <span style="color:blue;">set</span> { LoadProperty(TypeListProperty, <span style="color:blue;">value</span>); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">static</span> <span style="color:blue;">readonly</span> <span style="color:#2b91af;">PropertyInfo</span>&lt;<span style="color:#2b91af;">ClientCodeList</span>&gt; ClientCodeListProperty = RegisterProperty&lt;<span style="color:#2b91af;">ClientCodeList</span>&gt;(c =&gt; c.ClientCodeList);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:#2b91af;">ClientCodeList</span> ClientCodeList</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">get</span> { <span style="color:blue;">return</span> GetProperty(ClientCodeListProperty); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">private</span> <span style="color:blue;">set</span> { LoadProperty(ClientCodeListProperty, <span style="color:blue;">value</span>); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">static</span> <span style="color:blue;">readonly</span> <span style="color:#2b91af;">PropertyInfo</span>&lt;<span style="color:#2b91af;">AccountManagers</span>&gt; AccountManagerListProperty = RegisterProperty&lt;<span style="color:#2b91af;">AccountManagers</span>&gt;(c =&gt; c.AccountManagerList);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:#2b91af;">AccountManagers</span> AccountManagerList</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">get</span> { <span style="color:blue;">return</span> GetProperty(AccountManagerListProperty); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">private</span> <span style="color:blue;">set</span> { LoadProperty(AccountManagerListProperty, <span style="color:blue;">value</span>); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:9.5pt;">Etc.</span></p>
<h2 style="margin:10pt 0in 0pt;"><span style="font-size:medium;"><span style="color:#4f81bd;"><span style="font-family:Cambria;">Search</span></span></span></h2>
<h2 style="margin:10pt 0in 0pt;"><span style="line-height:115%;font-family:Consolas;color:blue;font-size:8pt;font-weight:normal;mso-bidi-font-size:9.5pt;mso-bidi-font-weight:bold;">public</span><span style="line-height:115%;font-family:Consolas;font-size:8pt;font-weight:normal;mso-bidi-font-size:9.5pt;mso-bidi-font-weight:bold;"><span style="color:#4f81bd;"> </span></span><span style="line-height:115%;font-family:Consolas;color:blue;font-size:8pt;font-weight:normal;mso-bidi-font-size:9.5pt;mso-bidi-font-weight:bold;">class</span><span style="line-height:115%;font-family:Consolas;font-size:8pt;font-weight:normal;mso-bidi-font-size:9.5pt;mso-bidi-font-weight:bold;"><span style="color:#4f81bd;"> </span></span><span style="line-height:115%;font-family:Consolas;color:#2b91af;font-size:8pt;font-weight:normal;mso-bidi-font-size:9.5pt;mso-bidi-font-weight:bold;">Search</span><span style="line-height:115%;font-family:Consolas;font-size:8pt;font-weight:normal;mso-bidi-font-size:9.5pt;mso-bidi-font-weight:bold;"><span style="color:#4f81bd;"> : </span></span><span style="line-height:115%;font-family:Consolas;color:#2b91af;font-size:8pt;font-weight:normal;mso-bidi-font-size:9.5pt;mso-bidi-font-weight:bold;">BusinessBase</span><span style="line-height:115%;font-family:Consolas;font-size:8pt;font-weight:normal;mso-bidi-font-size:9.5pt;mso-bidi-font-weight:bold;"><span style="color:#4f81bd;">&lt;</span></span><span style="line-height:115%;font-family:Consolas;color:#2b91af;font-size:8pt;font-weight:normal;mso-bidi-font-size:9.5pt;mso-bidi-font-weight:bold;">Search</span><span style="line-height:115%;font-family:Consolas;font-size:8pt;font-weight:normal;mso-bidi-font-size:9.5pt;mso-bidi-font-weight:bold;"><span style="color:#4f81bd;">&gt;</span></span></h2>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">This Editable Root object has a property for each combo box selected item and one for the search results (ListItems).</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">static</span> <span style="color:blue;">readonly</span> <span style="color:#2b91af;">PropertyInfo</span>&lt;<span style="color:blue;">int</span>?&gt; AccountManagerFKProperty = RegisterProperty&lt;<span style="color:blue;">int</span>?&gt;(c =&gt; c.AccountManagerFK);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">int</span>? AccountManagerFK</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">get</span> { <span style="color:blue;">return</span> GetProperty(AccountManagerFKProperty); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">set</span> { SetProperty(AccountManagerFKProperty, <span style="color:blue;">value</span>); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">static</span> <span style="color:blue;">readonly</span> <span style="color:#2b91af;">PropertyInfo</span>&lt;<span style="color:blue;">string</span>&gt; TypeProperty = RegisterProperty&lt;<span style="color:blue;">string</span>&gt;(c =&gt; c. Type);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">string</span> Type</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">get</span> { <span style="color:blue;">return</span> GetProperty(TypeProperty); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">set</span> { SetProperty(TypeProperty, <span style="color:blue;">value</span>); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">static</span> <span style="color:blue;">readonly</span> <span style="color:#2b91af;">PropertyInfo</span>&lt;<span style="color:#2b91af;">String</span>&gt; ClientCodeProperty = RegisterProperty&lt;<span style="color:#2b91af;">String</span>&gt;(c =&gt; c.ClientCode);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:#2b91af;">String</span> ClientCode</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">get</span> { <span style="color:blue;">return</span> GetProperty(ClientCodeProperty); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">set</span> { SetProperty(ClientCodeProperty, <span style="color:blue;">value</span>); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">static</span> <span style="color:blue;">readonly</span> <span style="color:#2b91af;">PropertyInfo</span>&lt;<span style="color:#2b91af;">DateTime</span>?&gt; DateProperty = RegisterProperty&lt;<span style="color:#2b91af;">DateTime</span>?&gt;(c =&gt; c.Date);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:#2b91af;">DateTime</span>? Date</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">get</span> { <span style="color:blue;">return</span> GetProperty(DateProperty); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">set</span> { SetProperty(DateProperty, <span style="color:blue;">value</span>); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">static</span> <span style="color:blue;">readonly</span> <span style="color:#2b91af;">PropertyInfo</span>&lt;<span style="color:#2b91af;">SearchLineItems</span>&gt; LineItemsProperty = RegisterProperty&lt;<span style="color:#2b91af;">SearchLineItems</span>&gt;(c =&gt; c.LineItems);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:#2b91af;">SearchLineItems</span> LineItems</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">get</span> { <span style="color:blue;">return</span> GetProperty(LineItemsProperty); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">private</span> <span style="color:blue;">set</span> { SetProperty(LineItemsProperty, <span style="color:blue;">value</span>); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I also added an asynchronous method to get the search results based on the values in the other properties.</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">void</span> GetSearchResults(<span style="color:#2b91af;">EventHandler</span>&lt;<span style="color:#2b91af;">DataPortalResult</span>&lt;<span style="color:#2b91af;">Search</span>&gt;&gt; callback)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:green;">// load the lineitems property for the current criteria</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;color:#2b91af;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>SearchLineItems</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">.GetSearchLineItems(AccountManagerFK, Type, ClientCode, Date, (o, e) =&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">if</span> (e.Error == <span style="color:blue;">null</span> &amp;&amp; e.Object != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:green;">// process result</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>LineItems = (<span style="color:#2b91af;">SearchLineItems</span>)e.Object;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>callback(<span style="color:blue;">null</span>, <span style="color:blue;">null</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>});</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<h2 style="margin:10pt 0in 0pt;"><span style="font-size:medium;"><span style="color:#4f81bd;"><span style="font-family:Cambria;">SearchLineItems</span></span></span></h2>
<h2 style="margin:10pt 0in 0pt;"><span style="line-height:115%;font-family:Consolas;color:blue;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;">public</span><span style="line-height:115%;font-family:Consolas;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;"><span style="color:#4f81bd;"> </span></span><span style="line-height:115%;font-family:Consolas;color:blue;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;">class</span><span style="line-height:115%;font-family:Consolas;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;"><span style="color:#4f81bd;"> </span></span><span style="line-height:115%;font-family:Consolas;color:#2b91af;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;">SearchLineItems</span><span style="line-height:115%;font-family:Consolas;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;"><span style="color:#4f81bd;"> : </span></span><span style="line-height:115%;font-family:Consolas;color:#2b91af;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;">ReadOnlyListBase</span><span style="line-height:115%;font-family:Consolas;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;"><span style="color:#4f81bd;">&lt;</span></span><span style="line-height:115%;font-family:Consolas;color:#2b91af;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;">SearchLineItems</span><span style="line-height:115%;font-family:Consolas;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;"><span style="color:#4f81bd;">, </span></span><span style="line-height:115%;font-family:Consolas;color:#2b91af;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;">SearchLineItem</span><span style="color:#4f81bd;"><span style="line-height:115%;font-family:Consolas;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;">&gt;</span><span style="font-weight:normal;mso-bidi-font-weight:bold;"></span></span></h2>
<h2 style="margin:10pt 0in 0pt;"><span style="font-size:medium;"><span style="color:#4f81bd;"><span style="font-family:Cambria;">SearchLineItem</span></span></span></h2>
<h2 style="margin:10pt 0in 0pt;"><span style="line-height:115%;font-family:Consolas;color:blue;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;">public</span><span style="line-height:115%;font-family:Consolas;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;"><span style="color:#4f81bd;"> </span></span><span style="line-height:115%;font-family:Consolas;color:blue;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;">class</span><span style="line-height:115%;font-family:Consolas;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;"><span style="color:#4f81bd;"> </span></span><span style="line-height:115%;font-family:Consolas;color:#2b91af;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;">SearchLineItem</span><span style="line-height:115%;font-family:Consolas;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;"><span style="color:#4f81bd;"> : </span></span><span style="line-height:115%;font-family:Consolas;color:#2b91af;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;">ReadOnlyBase</span><span style="line-height:115%;font-family:Consolas;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;"><span style="color:#4f81bd;">&lt;</span></span><span style="line-height:115%;font-family:Consolas;color:#2b91af;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;">SearchLineItem</span><span style="line-height:115%;font-family:Consolas;font-size:9.5pt;font-weight:normal;mso-bidi-font-weight:bold;"><span style="color:#4f81bd;">&gt;</span></span></h2>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I figured the LineItems and LineItem classes should be ReadOnlyList and ReadOnlyChild respectively because they display a subset of the actual record and the VM for the search results line item would have a method to handle navigating to a page to edit the selected line item.</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">There are a few things I do not understand in your last reply:</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 10pt;background:#dddddd;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;"><span lang="EN" style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;font-size:10pt;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-ansi-language:EN;">When that happens, in your root viewmodel&#39;s OnRefreshed overload you will probably set the properties to make the various objects in the UOW available through the child viewmodels.</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Should I be using the OnRefreshed overload? I simply let the SearchUOW fetch load the properties and the binding does the rest. Is this incorrect?</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">private</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">void</span> DataPortal_Fetch()</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>Search = <span style="color:#2b91af;">Search</span>.NewSearch();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>TypeList = <span style="color:#2b91af;">TypeList</span>.GetTypes();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>ClientCodeList = <span style="color:#2b91af;">ClientCodeList</span>.GetClientCodes();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>AccountManagerList = <span style="color:#2b91af;">AccountManagers</span>.GetAccountManagers();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 10pt;background:#dddddd;mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;"><span lang="EN" style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;font-size:10pt;mso-fareast-font-family:&#39;Times New Roman&#39;;mso-ansi-language:EN;">The SearchPageSearchViewModel is managing the read-only list right? So it should have a method (verb) that is triggered when the selection is changed by the user in the UI. So the datagrid&#39;s SelectedItemChanged (or similar) event should be bound to that method - and that method will create a new SearchItemViewModel.</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">My page allows the user enter search criteria into 3 combo boxes and one date picker. They can then press the Search button to display the search results. Finally, they can click on a hyperlink on the search results line item to navigate to a new page to edit the selected record.</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">The SearchPageSearchViewModel is managing the Search EditableRoot object.</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">class</span> <span style="color:#2b91af;">SearchPageViewModel</span> : <span style="color:#2b91af;">BaseViewModel</span>&lt;Library.<span style="color:#2b91af;">SearchUOW</span>&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> SearchPageViewModel()</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">Shell</span>.Instance.ShowStatus(<span style="color:blue;">new</span> <span style="color:#2b91af;">Status</span> { Text = <span style="color:#a31515;">&quot;Loading...&quot;</span>, IsBusy = <span style="color:blue;">true</span> });</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>BeginRefresh(<span style="color:#a31515;">&quot;GetSearchUOW&quot;</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> <span style="color:blue;">static</span> <span style="color:blue;">readonly</span> <span style="color:#2b91af;">DependencyProperty</span> SearchPageSearchViewModelProperty =</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">DependencyProperty</span>.Register(<span style="color:#a31515;">&quot;SearchPageSearchViewModel&quot;</span>, <span style="color:blue;">typeof</span>(<span style="color:#2b91af;">SearchPageSearchViewModel</span>), <span style="color:blue;">typeof</span>(<span style="color:#2b91af;">SearchPageViewModel</span>), <span style="color:blue;">null</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> <span style="color:#2b91af;">SearchPageSearchViewModel</span> SearchPageSearch</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">get</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">var</span> result = <span style="color:blue;">new</span> <span style="color:#2b91af;">SearchPageSearchViewModel</span>();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (Model != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>result = <span style="color:blue;">new</span> <span style="color:#2b91af;">SearchPageSearchViewModel</span> { Model = Model.Search };</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">return</span> result;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">protected</span> <span style="color:blue;">override</span> <span style="color:blue;">void</span> OnModelChanged(Library.<span style="color:#2b91af;">SearchUOW</span> oldValue, Library.<span style="color:#2b91af;">SearchUOW</span> newValue)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">base</span>.OnModelChanged(oldValue, newValue);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (oldValue != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>oldValue.Search.PropertyChanged -= <span style="color:blue;">new</span> System.ComponentModel.<span style="color:#2b91af;">PropertyChangedEventHandler</span>(Search_PropertyChanged);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (newValue != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>newValue.Search.PropertyChanged += <span style="color:blue;">new</span> System.ComponentModel.<span style="color:#2b91af;">PropertyChangedEventHandler</span>(Search_PropertyChanged);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>OnPropertyChanged(<span style="color:#a31515;">&quot;SearchPageSearch&quot;</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">void</span> Search_PropertyChanged(<span style="color:blue;">object</span> sender, System.ComponentModel.<span style="color:#2b91af;">PropertyChangedEventArgs</span> e)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>OnPropertyChanged(<span style="color:#a31515;">&quot;SearchPageSearch&quot;</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:green;">// buttons</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> <span style="color:blue;">void</span> GetSearchResults()</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">Shell</span>.Instance.ShowStatus(<span style="color:blue;">new</span> <span style="color:#2b91af;">Status</span> { Text = <span style="color:#a31515;">&quot;Searching...&quot;</span>, IsBusy = <span style="color:blue;">true</span> });</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (Model != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Model.Search.GetSearchResults((o, e) =&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">Shell</span>.Instance.ShowStatus(<span style="color:blue;">new</span> <span style="color:#2b91af;">Status</span>());</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>});</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Is this an appropriate use of the business objects?</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Thanks</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Russ.</span></span></p>
<p><span style="font-family:Consolas;font-size:x-small;"><span style="font-family:Consolas;font-size:x-small;"></span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>simon replied on Sunday, August 07, 2011</h2><p><strong>View:</strong></p>
<p>&nbsp;</p>
<p>&nbsp;&lt;ad:DocumentContent.Resources &gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;CollectionViewSource x:Key=&quot;MaterialsUowViewModelSource&quot; /&gt;</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &lt;/ad:DocumentContent.Resources&gt;</p>
<p>&nbsp; &nbsp; &lt;Grid Name=&quot;LayoutRoot&quot; DataContext=&quot;{Binding Path=MaterialsViewModel, Source={StaticResource MaterialsUowViewModelSource}}&quot;&gt;</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;Grid&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Grid.RowDefinitions&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;RowDefinition Height=&quot;Auto&quot;/&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;RowDefinition/&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;RowDefinition Height=&quot;Auto&quot;/&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/Grid.RowDefinitions&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;ToolBar Height=&quot;28&quot; VerticalAlignment=&quot;Top&quot; &gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Button Name=&quot;AddButton&quot; Content=&quot;新建&quot; &nbsp;/&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;csla:TriggerAction Height=&quot;0&quot; Name=&quot;AddItemTrigger&quot; Width=&quot;0&quot; TargetControl=&quot;{Binding ElementName=AddButton}&quot; MethodName=&quot;AddNew&quot; /&gt;</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Button Content=&quot;保存&quot; Name=&quot;SaveButton&quot; IsEnabled=&quot;{Binding Path=CanSave}&quot; /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;csla:TriggerAction Height=&quot;20&quot; Name=&quot;SaveTrigger&quot; Width=&quot;20&quot; TargetControl=&quot;{Binding ElementName=SaveButton}&quot; MethodName=&quot;Save&quot; /&gt;</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Button Content=&quot;删除&quot; Name=&quot;RemoveButton&quot;/&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;csla:TriggerAction Height=&quot;0&quot; Name=&quot;RemoveTrigger&quot; Width=&quot;0&quot; MethodName=&quot;Remove&quot; TargetControl=&quot;{Binding ElementName=RemoveButton}&quot; MethodParameter=&quot;{Binding Path=Model.CurrentItem}&quot; /&gt;</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Button Content=&quot;刷新&quot; Name=&quot;RefreshButton&quot;/&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;csla:TriggerAction Height=&quot;0&quot; Name=&quot;RemoveTrigger&quot; Width=&quot;0&quot; MethodName=&quot;Remove&quot; TargetControl=&quot;{Binding ElementName=RemoveButton}&quot; MethodParameter=&quot;{Binding Path=Model}&quot; /&gt;</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/ToolBar&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;TabControl Grid.Row=&quot;1&quot; &nbsp;Name=&quot;tabControl1&quot; &nbsp;&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;TabItem Header=&quot;概览&quot; Name=&quot;tabItem1&quot;&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;local:MaterialListView DataContext=&quot;{Binding Path=Model}&quot;/&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/TabItem&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;TabItem Header=&quot;基本&quot; DataContext=&quot;{Binding Path=Model.CurrentItem}&quot; &gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Grid &nbsp;&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Grid.RowDefinitions&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;RowDefinition Height=&quot;Auto&quot; /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;RowDefinition Height=&quot;Auto&quot; /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;RowDefinition Height=&quot;Auto&quot; /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;RowDefinition Height=&quot;215*&quot; /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/Grid.RowDefinitions&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Grid.ColumnDefinitions&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;ColumnDefinition Width=&quot;70&quot; /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;ColumnDefinition Width=&quot;Auto&quot; /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;ColumnDefinition Width=&quot;Auto&quot; /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;ColumnDefinition Width=&quot;165&quot; /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;ColumnDefinition Width=&quot;36&quot; /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;ColumnDefinition Width=&quot;23&quot; /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/Grid.ColumnDefinitions&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Label Content=&quot;ID:&quot; &nbsp;HorizontalAlignment=&quot;Left&quot; Name=&quot;label1&quot; VerticalAlignment=&quot;Top&quot; Margin=&quot;0&quot; /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;TextBox Grid.Row=&quot;0&quot; &nbsp;Grid.Column=&quot;1&quot; Margin=&quot;3&quot; Height=&quot;23&quot; Width=&quot;120&quot; &nbsp;Text=&quot;{Binding Path=Id,Mode=OneWay }&quot; IsReadOnly=&quot;True&quot; /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Label Content=&quot;物料编号:&quot; HorizontalAlignment=&quot;Left&quot; Name=&quot;label2&quot; VerticalAlignment=&quot;Top&quot; Margin=&quot;0&quot; Grid.Row=&quot;1&quot;/&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;TextBox Grid.Row=&quot;1&quot; &nbsp;Grid.Column=&quot;1&quot; Margin=&quot;3&quot; Height=&quot;23&quot; Text=&quot;{Binding Path=No,UpdateSourceTrigger=PropertyChanged}&quot; inf:MaskBehavior.Mask=&quot;{Binding Path=MaskList[MaterialNo], Source={StaticResource MaterialsUowViewModelSource}}&quot; /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;Label Content=&quot;物料名称:&quot; HorizontalAlignment=&quot;Left&quot; Margin=&quot;0&quot; Name=&quot;label3&quot; VerticalAlignment=&quot;Top&quot; Grid.Row=&quot;2&quot; /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;TextBox Grid.Row=&quot;2&quot; Grid.Column=&quot;1&quot; Margin=&quot;3,3,-160,3&quot; Height=&quot;23&quot; Text=&quot;{Binding Path=Name,UpdateSourceTrigger=PropertyChanged}&quot; Grid.ColumnSpan=&quot;2&quot; Width=&quot;313&quot; /&gt;</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;csla:PropertyStatus Grid.Column=&quot;2&quot; Grid.Row=&quot;0&quot; Margin=&quot;5&quot; Name=&quot;propertyStatus1&quot; Width=&quot;20&quot; Height=&quot;20&quot; Property=&quot;{Binding Path=Id}&quot; /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;csla:PropertyStatus Grid.Column=&quot;2&quot; Grid.Row=&quot;1&quot; Margin=&quot;5&quot; Name=&quot;propertyStatus2&quot; Width=&quot;20&quot; Height=&quot;20&quot; Property=&quot;{Binding Path=No}&quot; /&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;csla:PropertyStatus Grid.Column=&quot;4&quot; Grid.Row=&quot;2&quot; Margin=&quot;5&quot; Name=&quot;propertyStatus3&quot; Width=&quot;20&quot; Height=&quot;20&quot; Property=&quot;{Binding Path=Name}&quot; /&gt;</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/Grid&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/TabItem&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/TabControl&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;/Grid&gt;</p>
<p>&nbsp; &nbsp; &lt;/Grid&gt;</p>
<p>&nbsp;</p>
<p><strong>ViewModel:</strong></p>
<p>&nbsp;</p>
<p>namespace MES.Presentation.WPF.Client.MM.Views.MaterialViews</p>
<p>{</p>
<p>&nbsp; &nbsp; [Export(typeof(MaterialCompositeViewModel))]</p>
<p>&nbsp; &nbsp; [PartCreationPolicy(CreationPolicy.NonShared)]</p>
<p>&nbsp; &nbsp; public class MaterialCompositeViewModel:ViewModel&lt;MaterialsUow&gt;</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; #region Property</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; public static readonly DependencyProperty MaterailsViewModelProperty = DependencyProperty.Register(&quot;MaterailsViewModel&quot;, typeof(MaterialsViewModel), typeof(MaterialsUow), null);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; public MaterialsViewModel MaterialsViewModel</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; get { return (MaterialsViewModel)GetValue(MaterailsViewModelProperty); }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; set { SetValue(MaterailsViewModelProperty, value);}</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; public Dictionary&lt;string,string&gt; MaskList</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; get;set;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; #endregion</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; #region Private members</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; private readonly IRegionManager regionManager;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; private readonly IEventAggregator eventAggregator;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; #endregion</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; #region Commandes</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; public ICommand NavItemDoubleClickCommand { get; private set; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; #endregion</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; #region Constructor</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; [ImportingConstructor]</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; public MaterialCompositeViewModel(IRegionManager regionManager, IEventAggregator eventAggregator)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.InitializeCommands();</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.regionManager = regionManager;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; this.eventAggregator = eventAggregator;</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; InitData();</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; #endregion</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; #region InitializeCommands Method</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;summary&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; /// Initiliazes the commands</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; /// &lt;/summary&gt;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; public void InitializeCommands()</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //this.LoginCommand = new DelegateCommand(this.OnLogin,() =&gt; !string.IsNullOrEmpty(this.UserName) &amp;&amp; !string.IsNullOrEmpty(this.Password));</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //this.LoginCommand = new DelegateCommand(this.OnLogin);</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; //this.LogoutCommand = new DelegateCommand(OnLogout);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; #endregion</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; private void InitData()</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BeginRefresh(&quot;GetMaterials&quot;,&quot;MaterialCompositeView&quot;);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; protected override void OnPropertyChanged(string propertyName)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; base.OnPropertyChanged(propertyName);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (propertyName == &quot;IsBusy&quot;)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;eventAggregator.GetEvent&lt;BusyIndicatorEvent&gt;().Publish(new BusyIndicatorEvent(IsBusy, &quot;正在加载数据...&quot;));</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; protected override void OnModelChanged(MaterialsUow oldValue, MaterialsUow newValue)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;base.OnModelChanged(oldValue, newValue);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;MaterialsViewModel = new MaterialsViewModel(newValue.Materials);</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;OnPropertyChanged(&quot;MaterialsViewModel&quot;);</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;if (MaskList == null)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;{</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;var list = new Dictionary&lt;string, string&gt;();</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;foreach (var item in newValue.MaskList)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;list.Add(item.Key, item.Value);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;this.MaskList = list;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;OnPropertyChanged(&quot;MaskList&quot;);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; private void Model_CollectionChanged(object sender, System.Collections.Specialized.NotifyCollectionChangedEventArgs e)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; OnPropertyChanged(&quot;MaterialsViewModel&quot;);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; protected override void OnError(System.Exception error)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; throw (error);</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; }</p>
<p>}</p>
<p>&nbsp;</p>
<p><strong>child ViewModel:</strong></p>
<p>&nbsp;</p>
<p>&nbsp;public class MaterialsViewModel:ViewModel&lt;Materials&gt;</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; public MaterialsViewModel(Materials materials)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Model = materials;</p>
<p>&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</p>
<p>&nbsp; &nbsp; }</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong>Model:</strong></p>
<p>
<p>&nbsp;[Serializable]</p>
<p>&nbsp; &nbsp; public class MaterialsUow:ReadOnlyBase &lt;MaterialsUow&gt;</p>
<p>&nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; public static readonly PropertyInfo&lt;Materials &gt; MaterialsProperty = RegisterProperty&lt;Materials &gt;(c =&gt; c.Materials);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; public Materials &nbsp;Materials</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; get { return GetProperty(MaterialsProperty); }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; private set { LoadProperty(MaterialsProperty, value); }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; public MaskList MaskList { get; private set; }</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; #region Factory Methods</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; public static void GetMaterials(string viewName, EventHandler&lt;DataPortalResult&lt;MaterialsUow&gt;&gt; callback)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DataPortal.BeginFetch&lt;MaterialsUow&gt;(viewName,callback);</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; #endregion</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; #region Data Access</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; private void DataPortal_Fetch(string viewName)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; {</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Materials = Materials.GetMaterials();</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MaskList = MaskList.GetList(viewName);</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; }</p>
<p>&nbsp; &nbsp; &nbsp; #endregion</p>
<p>&nbsp; &nbsp; }</p>
</p>
<p>&nbsp;</p>
<p>These code work well. but there a problem that is the NVL can&#39;t directly used in xaml as below:</p>
<p>Binding Path=MaskList.Key(&quot;ViewName&quot;)</p>
<p>so i changed to use dictionary&lt;string,string&gt;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Russ replied on Monday, July 11, 2011</h2><p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I have it working now!</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"></span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I have learned the following lessons:</span></span></p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-list:l0 level1 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">1)</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">Only the root ViewModel is derived from ViewModel&lt;T&gt;. All other child ViewModels are derived from DependecyObject.</span></span></p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-list:l0 level1 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">2)</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">All business object properties that have associated VMs have either a DependencyProperty or an ObservableCollection&lt;T&gt; property.</span></span></p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-list:l0 level1 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">3)</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">Extreme care must be taken to ensure all XAML bindings are made to the child VM properties and NOT to the model properties.</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">[Rocky, please let me know if any of these three statements are incorrect.]</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Thanks again for the help Rocky.</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Russ.</span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>stefan replied on Tuesday, July 12, 2011</h2><p>Hi Russ,</p>
<p>could you please be more specific, and tell us what were the missing pieces concerning your previous post?</p>
<p>Thanks.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Russ replied on Tuesday, July 12, 2011</h2><p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Here&rsquo;s how the working code ended up.</span></span></p>
<h2 style="margin:10pt 0in 0pt;"><span style="font-size:medium;"><span style="color:#4f81bd;"><span style="font-family:Cambria;">SearchPageViewModel</span></span></span></h2>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">class</span> <span style="color:#2b91af;">SearchPageViewModel</span> : <span style="color:#2b91af;">BaseViewModel</span>&lt;Library.<span style="color:#2b91af;">SearchUOW</span>&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> SearchPageViewModel()</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">Shell</span>.Instance.ShowStatus(<span style="color:blue;">new</span> <span style="color:#2b91af;">Status</span> { Text = <span style="color:#a31515;">&quot;Loading...&quot;</span>, IsBusy = <span style="color:blue;">true</span> });</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>BeginRefresh(<span style="color:#a31515;">&quot;GetSearchUOW&quot;</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> <span style="color:blue;">static</span> <span style="color:blue;">readonly</span> <span style="color:#2b91af;">DependencyProperty</span> SearchPageSearchViewModelProperty =</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">DependencyProperty</span>.Register(<span style="color:#a31515;">&quot;SearchPageSearchViewModel&quot;</span>, <span style="color:blue;">typeof</span>(<span style="color:#2b91af;">SearchPageSearchViewModel</span>), <span style="color:blue;">typeof</span>(<span style="color:#2b91af;">SearchPageViewModel</span>), <span style="color:blue;">null</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> <span style="color:#2b91af;">SearchPageSearchViewModel</span> SearchPageSearch</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">get</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">var</span> result = <span style="color:blue;">new</span> <span style="color:#2b91af;">SearchPageSearchViewModel</span>();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (Model != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>result = <span style="color:blue;">new</span> <span style="color:#2b91af;">SearchPageSearchViewModel</span> { Model = Model.Search };</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">return</span> result;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">protected</span> <span style="color:blue;">override</span> <span style="color:blue;">void</span> OnModelChanged(Library.<span style="color:#2b91af;">SearchUOW</span> oldValue, Library.<span style="color:#2b91af;">SearchUOW</span> newValue)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">base</span>.OnModelChanged(oldValue, newValue);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (oldValue != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>oldValue.Search.PropertyChanged -= <span style="color:blue;">new</span> System.ComponentModel.<span style="color:#2b91af;">PropertyChangedEventHandler</span>(Search_PropertyChanged);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (newValue != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>newValue.Search.PropertyChanged += <span style="color:blue;">new</span> System.ComponentModel.<span style="color:#2b91af;">PropertyChangedEventHandler</span>(Search_PropertyChanged);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>OnPropertyChanged(<span style="color:#a31515;">&quot;SearchPageSearch&quot;</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">void</span> Search_PropertyChanged(<span style="color:blue;">object</span> sender, System.ComponentModel.<span style="color:#2b91af;">PropertyChangedEventArgs</span> e)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>OnPropertyChanged(<span style="color:#a31515;">&quot;SearchPageSearch&quot;</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:green;">// buttons</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> <span style="color:blue;">void</span> GetSearchResults()</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:green;">//Shell.Instance.ShowStatus(new Status { Text = &quot;Searching...&quot;, IsBusy = true });</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (Model != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Model.Search.GetSearchResults();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<h2 style="margin:10pt 0in 0pt;"><span style="font-size:medium;"><span style="color:#4f81bd;"><span style="font-family:Cambria;">SearchPageSearchViewModel</span></span></span></h2>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">class</span> <span style="color:#2b91af;">SearchPageSearchViewModel</span> : <span style="color:#2b91af;">DependencyObject</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> <span style="color:blue;">static</span> <span style="color:blue;">readonly</span> <span style="color:#2b91af;">DependencyProperty</span> ModelProperty </span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>= <span style="color:#2b91af;">DependencyProperty</span>.Register(<span style="color:#a31515;">&quot;Model&quot;</span>, <span style="color:blue;">typeof</span>(Library.<span style="color:#2b91af;">Search</span>), <span style="color:blue;">typeof</span>(<span style="color:#2b91af;">SearchPageSearchViewModel</span>), <span style="color:blue;">null</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> Library.<span style="color:#2b91af;">Search</span> Model</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">get</span> { <span style="color:blue;">return</span> (Library.<span style="color:#2b91af;">Search</span>)GetValue(ModelProperty); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">set</span> { SetValue(ModelProperty, <span style="color:blue;">value</span>); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> <span style="color:#2b91af;">ObservableCollection</span>&lt;<span style="color:#2b91af;">SearchItemViewModel</span>&gt; SearchList</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">get</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">var</span> result = <span style="color:blue;">new</span> <span style="color:#2b91af;">ObservableCollection</span>&lt;<span style="color:#2b91af;">SearchItemViewModel</span>&gt;();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (Model != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:4;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">foreach</span> (<span style="color:blue;">var</span> item <span style="color:blue;">in</span> Model.LineItems)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:5;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>result.Add(<span style="color:blue;">new</span> <span style="color:#2b91af;">SearchItemViewModel</span> { Model = item });</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">return</span> result;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<h2 style="margin:10pt 0in 0pt;"><span style="font-size:medium;"><span style="color:#4f81bd;"><span style="font-family:Cambria;">SearchItemViewModel</span></span></span></h2>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">class</span> <span style="color:#2b91af;">SearchItemViewModel</span> : <span style="color:#2b91af;">DependencyObject</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> <span style="color:blue;">static</span> <span style="color:blue;">readonly</span> <span style="color:#2b91af;">DependencyProperty</span> ModelProperty =<span style="color:#2b91af;">DependencyProperty</span>.Register(<span style="color:#a31515;">&quot;Model&quot;</span>, <span style="color:blue;">typeof</span>(Library.<span style="color:#2b91af;">SearchLineItem</span>), <span style="color:blue;">typeof</span>(<span style="color:#2b91af;">SearchItemViewModel</span>), <span style="color:blue;">null</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> Library.<span style="color:#2b91af;">SearchLineItem</span> Model</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">get</span> { <span style="color:blue;">return</span> (Library.<span style="color:#2b91af;">SearchLineItem</span>)GetValue(ModelProperty); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">set</span> { SetValue(ModelProperty, <span style="color:blue;">value</span>); }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> <span style="color:blue;">void</span> Edit()</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">MessageBox</span>.Show(<span style="color:#a31515;">&quot;Edit pressed on SearchLineItem &quot;</span>+ Model.ContractPK.ToString());</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<h2 style="margin:10pt 0in 0pt;"><span style="font-size:medium;"><span style="color:#4f81bd;"><span style="font-family:Cambria;">SearchPage.xaml</span></span></span></h2>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">&lt;</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">UserControl.Resources</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">&gt;</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>&lt;</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">CollectionViewSource</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> x</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">:</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;">Key</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=&quot;searchPageViewModelViewSource&quot;</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> d</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">:</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;">DesignSource</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=&quot;{</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">d</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">:</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">DesignInstance</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> my</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">:</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;">SearchPageViewModel</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">,</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> CreateList</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=True}&quot; /&gt;</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>&lt;</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">CollectionViewSource</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> x</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">:</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;">Key</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=&quot;searchPageSearchViewModelSearchListViewSource&quot;</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> Source</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=&quot;{</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">Binding</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> Path</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">=SearchPageSearch.SearchList,</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> Source</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">={</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">StaticResource</span><span style="font-family:Consolas;color:red;font-size:8pt;mso-bidi-font-size:9.5pt;"> searchPageViewModelViewSource</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">}}&quot; /&gt;</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">&lt;/</span><span style="font-family:Consolas;color:#a31515;font-size:8pt;mso-bidi-font-size:9.5pt;">UserControl.Resources</span><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">&gt;</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"></span></p>
<h2 style="margin:10pt 0in 0pt;"><span style="font-size:medium;"><span style="color:#4f81bd;"><span style="font-family:Cambria;">Search : BusinessBase&lt;Search&gt;</span></span></span></h2>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">void</span> GetSearchResults()</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:green;">// load the lineitems property for the current criteria</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:#2b91af;">SearchLineItems</span>.GetSearchLineItems(ManagerID, Type, ClientCode, Date, (o, e) =&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (e.Error == <span style="color:blue;">null</span> &amp;&amp; e.Object != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:green;">// process result</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:3;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>LineItems = (<span style="color:#2b91af;">SearchLineItems</span>)e.Object;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>});</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;tab-stops:9.0pt .25in 27.0pt .5in;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">The only remaining issue is the GetSearchResults() method. I need to pass it a callback handler so I can properly update the status message when it has completed.</span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>simon replied on Thursday, August 04, 2011</h2><p><span>Hi Russ,</span></p>
<p>Have you implemented the save method? &nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Russ replied on Thursday, August 04, 2011</h2><p>Hi Simon,</p>
<p>This is a search page.&nbsp; There is no save method.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Russ replied on Thursday, August 11, 2011</h2><p><div style='padding-left: 50px;background-color:silver'><b>Russ<br></b> </p>
<p class="MsoNoSpacing">
<p><span style="font-size:small;"><span style="FONT-FAMILY:Calibri;">
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I have learned the following lessons:</span></span></p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-list:l0 level1 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">1)</span><span style="font:7pt &#39;Times New Roman&#39;;"> </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">Only the root ViewModel is derived from ViewModel&lt;T&gt;. All other child ViewModels are derived from DependecyObject.</span></span></p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-list:l0 level1 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">2)</span><span style="font:7pt &#39;Times New Roman&#39;;"> </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">All business object properties that have associated VMs have either a DependencyProperty or an ObservableCollection&lt;T&gt; property.</span></span></p>
<p class="MsoNoSpacing" style="text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-list:l0 level1 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">3)</span><span style="font:7pt &#39;Times New Roman&#39;;"> </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">Extreme care must be taken to ensure all XAML bindings are made to the child VM properties and NOT to the model properties.</span></span></p>
<p class="MsoNoSpacing">&nbsp;</p>
</div></span></span></p>
<p>I have worked with this some more and have read as many posts as I could find and have now realized that Item #1 in my previous post was wrong.&nbsp; Child ViewModels can be devired from DependencyObject or ViewModel&lt;T&gt; depending on the functionality you require.&nbsp; I am basing them on DependencyObject when the underlying Model is ReadOnly and I simply need a VM to handle a click event. I am basing them on ViewModel&lt;T&gt; when the underlying Model is Editable and I required the properties that the ViewModel&lt;T&gt; provides.</p>
<p>I hope this helps anyone who was as confounded as I have been for the last month.</p>
<p>Russ</p>
<p>&nbsp;</p>
</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
