<html><header><title>Modelling Nested Aggregation</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Modelling Nested Aggregation</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2892.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>josh.kodroff posted on Wednesday, May 16, 2007</h2>Hey all.&nbsp; I have a case of nested aggregation: We have studies.&nbsp; Sites participate in studies, and raters participate at sites for a study.&nbsp; That gives us a database table structure of (only the relevant columns are shown):<br><br>Study: study_id<br>Site: site_id<br>Study_Site: study_site_id, study_id, site_id<br>Rater_Study_Site: rater_study_site_id, rater_id, site_id<br><br>(No suggestions on changing the database structure, please.&nbsp; It's non-negotiable.)<br><br>The study object already has a bunch of children (4 different kinds), so I can't really load up a study just to add sites to it.&nbsp; In addition, in our business model, editing the study is something only a project manager should really do.&nbsp; Lower level employees can add sites to the study and raters to the sites for the study.&nbsp; Both actions are virtually never done at the same time.<br><br>Therefore, the form that adds sites and raters to a study will be its own distinct form.<br><br>Here's what I'm thinking for my object model:<br><ul><li>Create a root, read-only study object.&nbsp; I already have a StudyInfo class for when I need to list Studies in a DGV for non-editing purposes.&nbsp; I could probably reuse it and add an additional factory method something like GetStudyInfoWithSites().</li><li>Create a StudySite/List object that is a child of StudyInfo.&nbsp; I already have a SiteInfo class similar to the StudyInfo class.&nbsp; I could have a private SiteInfo inside my StudySite class in addition to a studyId field.</li><li>Create a StudySiteRater/List object that is a child of StudySite.&nbsp; I already have a Rater class that has no children (therefore, no need for a RaterInfo class) which I would probably make a private member and expose its properties as read-only.&nbsp; My StudySiteRater will also have a private studySiteId field.</li><li>For performance reasons (a Study may have over 100 Sites), I may have to break encapsulation and grab all of the StudySiteRaters in one fell swoop.&nbsp; This may not be such a big deal since these classes may not even need to be public, and even if they do, they will only be used on one form, and it's a small project - 3 developers.<br></li></ul>What do you guys think of my design?<br><br>Thanks for any help you can provide.<br>JK<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
