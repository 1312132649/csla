<html><header><title>Override IsDirty = True after Delete</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Override IsDirty = True after Delete</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7152.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>xAvailx posted on Tuesday, June 23, 2009</h2>CSLA 3.6.1<br /><br />When I mark an object for deletion, the object status changes to "IsDeleted=true, IsDirty=true". After saving (and updating my local variable reference), the status is "IsDeleted=false, IsDirty=true". I believe this is due to a call to MarkNew inside the dataportal. I would like to override this behavior on this specific object, so IsDirty is set to false after delete/save. What is the best way to approach this? <br /><br />Thanks for any help.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, June 23, 2009</h2><P>You can override Save() and reset the value after the operation is complete. Something like this:</P>
<P>public override CustomerEdit Save()<BR>{<BR>&nbsp; var tmp = base.Save();<BR>&nbsp; tmp.MarkOld();<BR>&nbsp; return tmp;<BR>}</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xAvailx replied on Tuesday, June 23, 2009</h2>Works like a charm, thx!</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Wbmstrmjb replied on Wednesday, July 29, 2009</h2>On this note, what is the point of MarkNew in the Delete?  After the object is deleted, what good is IsNew and IsDirty?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, July 29, 2009</h2><P>This is discussed in the book. If you use deferred deletion on a root object, or a single (non-list) child of a root, it is quite realistic for the UI to end up with a valid reference to the resulting object after the delete.</P>
<P>Obviously that object no longer matches data in the database, and so it meets the definition of being new. And its data no longer matches data in the database, so it meets the definition of being dirty.</P>
<P>If the object isn't marked accordingly, the UI would have a reference to an object that is known to be in an invalid state, which would almost certainly lead to unexpected bad behaviors.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Wbmstrmjb replied on Thursday, July 30, 2009</h2>Ah ha!  There it is.  I had missed it.  Thanks for the added explanation.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
