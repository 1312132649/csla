<html><header><title>Sorting a ReadOnlyListBase collection of objects In-Place : possible?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Sorting a ReadOnlyListBase collection of objects In-Place : possible?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5301.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>awbacker posted on Tuesday, August 26, 2008</h2><P>I am trying to sort a list of child objects in-place, but can't figure out how.&nbsp; </P>
<P>I have a regular root object, and a <FONT face="Courier New" color=#a52a2a size=2>ReadOnlyListBase()</FONT>&nbsp;collection of <FONT face="Courier New" color=#a52a2a size=2>ReadOnlyBase</FONT> objects as a child.&nbsp; I am trying to sort this in the <FONT face="Courier New" color=#a52a2a size=2>FetchPost</FONT> event of the Root object.</P>
<P>When I want to sort, I am&nbsp;using the <FONT color=#a52a2a><FONT face="Courier New" size=2>ArrayList.Adapter(<FONT color=#000080>Me</FONT>).Sort( ... </FONT>)</FONT> method, which works if I force the <FONT face="Courier New" color=#a52a2a size=2>IsReadOnly</FONT> property for the list to false.&nbsp; When I don't do that, I get a &nbsp;<FONT color=#000080>"Changing an element is an invalid operation"</FONT> exception.&nbsp; </P>
<P>I would like to just have a editable collection of readonly objects (?) so I can sort, but not modify the results of what I got, but that doesn't work (BusinessListBase doesn't let me do that).</P>
<P>Is there any way that I can do a sort on this list?&nbsp; I need to do it after the objects have been created, which is taken care of, but I need to be able to do it after that to _ensure_ the proper order.&nbsp; </P>
<P>I have considered going the route of making a new property, and creating a new List(Of T) that is returned when that property is accessed, but it would be really nice to just fix what I already have.</P>
<P>Any ideas?&nbsp; All of the List(of T) sorting is actually <EM>implemented</EM> in the list, not as part of IList, so nothing else supports it directly..&nbsp; </P>
<P>// Andrew</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>awbacker replied on Tuesday, August 26, 2008</h2><P>There is a workaround, simpler than I thought.&nbsp; I can set IsReadOnly=true inside&nbsp;this method on the list class, and then do the sorting, resting the flag afterwards.&nbsp; Since the Set is protected, this is the only place it will work without reflection.</P>
<P>I was trying to move the sort call out of the list, where this wouldn't have worked, but I am now keeping it there and calling it through a custom function on the list.&nbsp; </P>
<P>Here is the code I used, if anyone is interested:</P>
<P><FONT face="Courier New"><FONT size=1><FONT color=#0000ff>Public</FONT> <FONT color=#0000ff>Class</FONT> </FONT></FONT><FONT face="Courier New" color=#010001 size=1>MyDetailList<BR></FONT><FONT color=#0000ff><BR><FONT face="Courier New" size=1>&nbsp;&nbsp;&nbsp; Public</FONT></FONT><FONT face="Courier New" size=1> <FONT color=#0000ff>Sub</FONT> <FONT color=#010001>SortByCountDescending</FONT>()<BR></FONT><FONT face="Courier New"><FONT size=1><FONT color=#008000>&nbsp;&nbsp;&nbsp; '-- sort, but we need to set readonly to 'false' first so it doesn't <BR>&nbsp;&nbsp;&nbsp; '-- throw an exception (you can't sort a RO list).&nbsp; .Adapter&nbsp;doest work with Generic&nbsp;comparers<BR></FONT><FONT color=#010001>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsReadOnly</FONT> = </FONT></FONT><FONT face="Courier New"><FONT size=1><FONT color=#0000ff>False<BR></FONT><FONT color=#010001>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ArrayList</FONT>.<FONT color=#010001>Adapter</FONT>(<FONT color=#0000ff>Me</FONT>).<FONT color=#010001>Sort</FONT>(<FONT color=#0000ff>New</FONT> <FONT color=#010001>DescendingSortComparer</FONT>)<BR><FONT color=#010001>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsReadOnly</FONT> = </FONT></FONT><FONT face="Courier New"><FONT size=1><FONT color=#0000ff>True<BR></FONT><FONT color=#0000ff><FONT color=#010001>&nbsp;&nbsp;&nbsp; </FONT>End</FONT> <FONT color=#0000ff>Sub</P></FONT></FONT></FONT>
<P><FONT face="Courier New"><FONT size=1><FONT color=#008000><FONT color=#010001>&nbsp;&nbsp;&nbsp; </FONT>''' </FONT><FONT color=#808080>&lt;summary&gt;</FONT><FONT color=#008000>Do a normal compare, but reverse the compairson results for desc ordering</FONT></FONT></FONT><FONT face="Courier New"><FONT size=1><FONT color=#808080>&lt;/summary&gt;<BR></FONT><FONT color=#0000ff><FONT color=#010001>&nbsp;&nbsp;&nbsp; </FONT>Private</FONT> <FONT color=#0000ff>Class</FONT> <FONT color=#010001>DescendingSortComparer</FONT> : <FONT color=#0000ff>Implements</FONT> </FONT></FONT><FONT face="Courier New"><FONT size=1><FONT color=#010001>IComparer<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff>Public</FONT> <FONT color=#0000ff>Function</FONT> <FONT color=#010001>Compare</FONT>(<FONT color=#0000ff>ByVal</FONT> <FONT color=#010001>x</FONT> <FONT color=#0000ff>As</FONT> <FONT color=#0000ff>Object</FONT>, <FONT color=#0000ff>ByVal</FONT> <FONT color=#010001>y</FONT> <FONT color=#0000ff>As</FONT> <FONT color=#0000ff>Object</FONT>) <FONT color=#0000ff>As</FONT> <FONT color=#0000ff>Integer</FONT> <FONT color=#0000ff>Implements</FONT> <FONT color=#010001>IComparer</FONT>.</FONT></FONT><FONT face="Courier New"><FONT size=1><FONT color=#010001>Compare<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff>Return</FONT> <FONT color=#0000ff>DirectCast</FONT>(<FONT color=#010001>y</FONT>, My<FONT color=#010001>Detail</FONT>).<FONT color=#010001>Count</FONT>.<FONT color=#010001>CompareTo</FONT>(&nbsp;<FONT color=#0000ff>CType</FONT>(<FONT color=#010001>x</FONT>,My<FONT color=#010001>rDetail</FONT>).<FONT color=#010001>PriorsCount</FONT>&nbsp; )<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;<FONT color=#010001>&nbsp;&nbsp;&nbsp; </FONT>End</FONT> </FONT></FONT><FONT face="Courier New"><FONT size=1><FONT color=#0000ff>Function<BR></FONT><FONT color=#0000ff><FONT color=#010001>&nbsp;&nbsp;&nbsp; </FONT>End</FONT> </FONT></FONT><FONT color=#0000ff><FONT face="Courier New" size=1>Class<BR></FONT><FONT face="Courier New" color=#010001 size=1>&nbsp;&nbsp;&nbsp; ....<BR>&nbsp;&nbsp;&nbsp; ...</FONT></FONT><FONT color=#0000ff><BR><FONT face="Courier New" size=1>End Class</FONT></P></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
