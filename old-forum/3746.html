<html><header><title>creating 1000s of objects in web app - looking for best practices</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>creating 1000s of objects in web app - looking for best practices</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3746.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rbellow posted on Friday, October 19, 2007</h2><P>I have a need in my current web application to have users upload .csv files of contacts. I want to create each contact through my business objects to enforce all the business rules. Obviously if I have thousands of contacts that need to be uploaded I am going to run into timeout issues. Plus I dont want to have the user just sitting there waiting. So I am looking at using ajax and the persistent communications pattern. Does anyone have a better recommendation?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tmg4340 replied on Saturday, October 20, 2007</h2><P><FONT face=Tahoma size=2>Well - I'm not really an expert on all this, but I wouldn't recommend trying to leave this in a web page at all.&nbsp; You'll kill your web-server performance,&nbsp;because the&nbsp;solution just doesn't scale at all.&nbsp; That is, of course, assuming you actually have thousands of contacts to import - have you confirmed that you actually have to support that level of data?&nbsp; I ask from experience - I've designed solutions in the past to handle volumes of data that were never even considered by my customers... <img src="/emoticons/emotion-10.gif" alt="Embarrassed [:$]" /></FONT></P>
<P><FONT face=Tahoma size=2>Setting aside the concept of creating thousands of business objects - a plan I wouldn't necessarily recommend, regardless of the solution implemented - this is not the kind of process that does well in a web app.&nbsp; What I would recommend is that you use your web app to upload the file and kick off some external process to actually process it.&nbsp; If it doesn't have to be real-time, your web app could simply upload the file, and some scheduled nightly process could process the file.&nbsp; If it does have to be real-time, then there are a few different opportunities - an SSIS job, a separate Windows service, etc.</FONT></P>
<P><FONT face=Tahoma size=2>Ultimately, if it were me, I would not use the business objects as part of this import at all.&nbsp; I understand that's potentially a duplication of code effort, but the business objects CSLA creates - especially if they are editable, which I am assuming they are - are just too heavy for a process like this.&nbsp; That also makes it conceptually easier to separate the import process from the rest of the application.&nbsp; If it's possible to centralize the business rules and access them both from your BO's and your import process, then do it - you'll thank yourself later.&nbsp; But I think trying to re-use your business objects here, given the scope of data, will just end up causing you headaches.</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Sunday, October 21, 2007</h2><P>I agreed with tmg4340 up to the point where he said you may not want to use your BOs for the import. I would want to use them. Especially for their Validation Rules.</P>
<P>I would read each contact row and then build the BO from the data, validate it and and save it.</P>
<P>I would write out exceptions to a log file and then continue processing.</P>
<P>This might take a little longer - but if it is an offline job then so what?</P>
<P>Joe</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tmg4340 replied on Monday, October 22, 2007</h2><P><FONT face=Tahoma size=2>I agree that&nbsp;speed is less of a concern in an offline job - but I'm not only concerning myself with speed.&nbsp; Creating thousands of BO's simply to use the validation rules seems like overkill.&nbsp; Plus, consider the database traffic involved, since each BO would&nbsp;essentially be its own transaction.&nbsp; I realize the BO's are lighter than a DataTable, but there is still a cost to creating them, and that offline job will suck memory like a Hoover (or maybe a Dyson)&nbsp;if it has to create that many BO's.&nbsp; Rocky has said before that CSLA's objects are designed more towards an OLTP type of situation.</FONT></P>
<P><FONT face=Tahoma size=2>That's also why I suggested that they should investigate whether the validation logic can be centralized into a separate component.&nbsp; If so, then it could be used by both the BO's and the import process, and then you really don't need the BO's.&nbsp; If they can't - well, then you have to make a decision.&nbsp; There's nothing wrong with using the BO's - but I'd look for another way to do it first.</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, October 22, 2007</h2>Perhaps what you need is some business objects that take the data to import and apply validation to them.&nbsp; So, not reuse your existing BOs, but create new ones.<br><br>The trick is to centralize your business logic; you can do this by offloading the rules to another internal object.&nbsp; Maybe your normal BOs and your import BOs could inherit this class, if they are not too different.&nbsp; <br><br>Just a quick thought; you don't want your import requirments to affect your normal BO's use case, nor do you want your normal use case to hinder what you're trying to do through the import.&nbsp; <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Thursday, October 25, 2007</h2><P>Is this a one-time upload of data to convert/catch up?&nbsp; And then the number of objects will be much smaller?</P>
<P>Or are you talking about thousands of them a day?</P>
<P>It's a big difference!</P>
<P>Does one csv file have lots of contracts or is it one contract per csv?</P>
<P>That makes a big difference because you have to decide how to handle the 99 good ones in the same file as 1 bad one.&nbsp; Can you go ahead and accept the 99 good ones, or will you have to reject 100 contracts because of one mistake.&nbsp; The wrong technical solution here will kill the app!</P>
<P>Second, whenever you have to accept data from someone else's system, you have to plan for the <STRONG><EM><U>fact</U></EM></STRONG> that a certain percentage of the data will be garbage.&nbsp; If you are receiving hand-entered csv files, I would be amazed if you don't have a high error rate.</P>
<P>You have to plan for where/how you want incorrect data to be corrected?&nbsp; Does it have to be corrected in the csv file, or in a temporary holding object or table, or in the permanent object or table?&nbsp; </P>
<P>How will you handle/weed out amended resubmissions and/or duplicates?</P>
<P>Anyway, food for thought! :)</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DavidDilworth replied on Friday, October 26, 2007</h2><P>Importing "unclean" data from any other source always has the possiblity of "bad" data.&nbsp; So using some kind of editable BO to validate (i.e. "clean") and persist your imported data seems like a good idea to me.&nbsp; Whether that's the same editable BO as the one you use to put data into your system via the application is your call.&nbsp; It may be a slightly different one as suggested above.</P>
<P>What you do with the "bad" data is a good question that you must consider.</P>
<P>Whatever you do though, you probably don't want this happening inside&nbsp;the request/response model of a web page.&nbsp; It should be done as an offline/background process.</P>
<P>Yes, you may allow the data to be uploaded via a web page, but don't put the processing of the data into the same request as well.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, October 26, 2007</h2><P>David,</P>
<P>It appears you said exactly what I said. But you said it a little clearer. &lt;g&gt;</P>
<P>Joe</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
