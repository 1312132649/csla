<html><header><title>Mysterious errors with authentication and Reporting Services</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Mysterious errors with authentication and Reporting Services</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3912.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>bgilbert posted on Monday, November 19, 2007</h2>I'm trying to embed a ReportingServices server report in a Winforms ReportViewer control. This is a simple matter and works well when run in a small test application. However, for some reason, when run within an app that uses the authentication model from Chapter 5, it fails. The exception I get is:<br><br><b>System.TypeLoadException: Failed to load the proxy script runtime environment from the Microsoft.JScript assembly.</b><br><br>The inner exception is:<br><b>{"That assembly does not allow partially trusted callers."}<br><br></b>I have the application set to full trust and I'm not trying to call any assemblies from the report.<br><br>Try Googling the outer exception, and it looks like I'm the first person in history to get it. It's very clear that with authentication it fails and without it doesn't. I'm not very well versed in the ins and outs of authentication, so this is very frustrating and difficult to debug. <br><br>I should mention that I'm running XP locally, connecting to SQL Server 2005 on a 2003 server across a Novell network.<br><br>Any help would be greatly appreciated.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, November 20, 2007</h2><P>Is it possible that your .NET assembly(ies) are being loaded from a network shared drive? Or a URL?</P>
<P>Either way, they'd be running in a partial trust environment by default, because they'd be coming from the Intranet or Internet zones.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>bgilbert replied on Tuesday, November 20, 2007</h2>Rocky,<br><br>Thanks for your reply. <br><br>No. The whole app is currently being run entirely from my local drive and it's set to full trust. The reportViewer control has methods to pass credentials to the server, but these seem to be very buggy. I've had to give up on this and just embed the reports in a web browser control. I'll try it again in VS2008 soon.<br><br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
