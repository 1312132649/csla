<html><header><title>DataGridView shows the hidden column during runtime</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>DataGridView shows the hidden column during runtime</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5422.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>netdeveloper posted on Thursday, September 18, 2008</h2><P>Hi,</P>
<P>While&nbsp;using the&nbsp;DataGridView with BindingSource object I faced problem that&nbsp;during runtime the grid was showing the column for which I set the visible property False&nbsp;during designtime. I spent enough time to find out the reason of this unexpected behaviour. Ultimately, I observed that if I set the&nbsp;DataSource property of the BindingSource&nbsp;of the grid&nbsp;in the Form Load event, this problem occurs, but when I do this in the Form's constructor, it works fine and the hidden column remains hidden.</P>
<P>Anyone faced this problem??</P>
<P>What is the difference in setting the Binding Source of the DataGridView in Form Load and Form Constructor events??</P>
<P>Regards</P>
<P>NetDeveloper</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>stefan replied on Thursday, September 18, 2008</h2>Are you displaying the DataGridView inside a TabControl?<br>As far as I understood it, it is a <b>feature</b> of the TabControl to somehow 'lazyload' its tabs...<br>What I experienced was that the columndefinitions as defined at designtime, are not loaded <br>correctly when the control is bound to a source before it is displayed the first time.<br><br>After many hours of investigation I ended up doing the following:<br>- Never bind anything in the constructor, only InitializeComponents + setting up form event handlers<br>- In the Form_Load handler, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; first make sure all DataGridViews are 'painted' once, <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; then set up the BindingSource<br><br>In the case of a TabControl I do the following (in Form_Load..):<br>&nbsp;&nbsp;&nbsp; ' hiding invisible columns workaround<br>&nbsp;&nbsp;&nbsp; Me.TabContainingGridView1.Show()<br>&nbsp;&nbsp;&nbsp; Me.TabContainingGridView1.Hide()<br>&nbsp;&nbsp;&nbsp; Me.TabContainingGridView2.Show()<br>&nbsp;&nbsp;&nbsp; Me.TabContainingGridView2.Hide()<br>&nbsp;&nbsp;&nbsp; Me.TabContainingGridView3.Show()<br>&nbsp;&nbsp;&nbsp; Me.TabContainingGridView3.Hide()<br>&nbsp;&nbsp;&nbsp; ...<br><br>This is not needed for the topmost Tab (displayed automatically).<br><br>This is the only solution I found on the web.<br>If anyone has a better idea, come on and show!<br>I really want to get rid of the above code snippet <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /><br><br>Stefan<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>netdeveloper replied on Saturday, September 20, 2008</h2><P>You are right....Yes I am displaying the DataGridView inside a TabControl (3rd and 4th Tab).</P>
<P>For test purpose I moved a grid out of the TabControl, it worked as expected (the hidden columns remain hidden).</P>
<P>In your feedback you suggested to set the BindingSource in Form_Load, but my observation for the DataGridView is that if it is inside the TabControl and BindingSource is set in the Form_Load, it shows the hidden column. But if BindingSource is set in the Form's Constructor, it does not show the hidden columns.</P>
<P>Regards</P>
<P>NetDeveloper</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>simon_may replied on Saturday, September 20, 2008</h2>I likewise have had the same problem with datagridviews displayed on tabcontrol. Interesting finding about when the BindingSource is set. My approach had been to handoe the DataBindingComplete event and set the column visible property to false, Not elegant I know.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael Hildner replied on Saturday, September 20, 2008</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>netdeveloper:</strong></div><div>during runtime the grid was showing the column for which I set the visible property False&nbsp;during designtime</div></BLOCKQUOTE></P>
<P>I've seen this too. Not sure if it applies in your case, but when I've seen it, it was always the first column in the grid (usually my PK) that I hide. I just rearrange the columns so the first column is a visible one.</P>
<P>Been a while, but I remember reading something about the grid automatically selects cell 0, 0, and in doing so, makes that column visible.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
