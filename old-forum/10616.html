<html><header><title>Stackoverflow exception in csla.dll</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Stackoverflow exception in csla.dll</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10616.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius posted on Tuesday, August 16, 2011</h2><p>I&#39;m experiencing a stack overflow exception coming from inside csla.dll. Under certain conditions, when setting any property on an object in a BusinessListBase causes an infinite recursive call to OnChildChanged. I think it might have something to do with my Child object property here, but I&#39;m really confused and can&#39;t seem to figure this out. Below is the snapshotted stacktrace after several of the infinite calls, followed by object source:</p>
<p style="padding-left:30px;">&nbsp;&nbsp; at System.Environment.GetStackTrace(Exception e, Boolean needFileInfo)<br />&nbsp;&nbsp; at System.Environment.get_StackTrace()<br />&nbsp;&nbsp; at Csla.Core.ChildChangedEventArgs..ctor(Object childObject, PropertyChangedEventArgs propertyArgs) in C:\csla\Csla4.1.0\Source\Csla\Core\ChildChangedEventArgs.cs:line 77<br />&nbsp;&nbsp; at Csla.Core.ChildChangedEventArgs..ctor(Object childObject, PropertyChangedEventArgs propertyArgs, NotifyCollectionChangedEventArgs listArgs) in C:\csla\Csla4.1.0\Source\Csla\Core\ChildChangedEventArgs.cs:line 93<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.RaiseChildChanged(Object childObject, PropertyChangedEventArgs propertyArgs, NotifyCollectionChangedEventArgs listArgs) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 433<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 457<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at System.EventHandler`1.Invoke(Object sender, TEventArgs e)<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 424<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.RaiseChildChanged(Object childObject, PropertyChangedEventArgs propertyArgs, NotifyCollectionChangedEventArgs listArgs) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 434<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 457<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at System.EventHandler`1.Invoke(Object sender, TEventArgs e)<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 424<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.RaiseChildChanged(Object childObject, PropertyChangedEventArgs propertyArgs, NotifyCollectionChangedEventArgs listArgs) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 434<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 457<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at System.EventHandler`1.Invoke(Object sender, TEventArgs e)<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 424<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.RaiseChildChanged(Object childObject, PropertyChangedEventArgs propertyArgs, NotifyCollectionChangedEventArgs listArgs) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 434<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 457<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at System.EventHandler`1.Invoke(Object sender, TEventArgs e)<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 424<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.RaiseChildChanged(Object childObject, PropertyChangedEventArgs propertyArgs, NotifyCollectionChangedEventArgs listArgs) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 434<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 457<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at System.EventHandler`1.Invoke(Object sender, TEventArgs e)<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 424<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.RaiseChildChanged(Object childObject, PropertyChangedEventArgs propertyArgs, NotifyCollectionChangedEventArgs listArgs) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 434<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 457<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at System.EventHandler`1.Invoke(Object sender, TEventArgs e)<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 424<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.RaiseChildChanged(Object childObject, PropertyChangedEventArgs propertyArgs, NotifyCollectionChangedEventArgs listArgs) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 434<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 457<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at System.EventHandler`1.Invoke(Object sender, TEventArgs e)<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 424<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.RaiseChildChanged(Object childObject, PropertyChangedEventArgs propertyArgs, NotifyCollectionChangedEventArgs listArgs) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 434<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 457<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at System.EventHandler`1.Invoke(Object sender, TEventArgs e)<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 424<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.RaiseChildChanged(Object childObject, PropertyChangedEventArgs propertyArgs, NotifyCollectionChangedEventArgs listArgs) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 434<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 457<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at System.EventHandler`1.Invoke(Object sender, TEventArgs e)<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 424<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.RaiseChildChanged(Object childObject, PropertyChangedEventArgs propertyArgs, NotifyCollectionChangedEventArgs listArgs) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 434<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 457<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at System.EventHandler`1.Invoke(Object sender, TEventArgs e)<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 424<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.RaiseChildChanged(Object childObject, PropertyChangedEventArgs propertyArgs, NotifyCollectionChangedEventArgs listArgs) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 434<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 457<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at System.EventHandler`1.Invoke(Object sender, TEventArgs e)<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 424<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.RaiseChildChanged(Object childObject, PropertyChangedEventArgs propertyArgs, NotifyCollectionChangedEventArgs listArgs) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 434<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 457<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at System.EventHandler`1.Invoke(Object sender, TEventArgs e)<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 424<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.RaiseChildChanged(Object childObject, PropertyChangedEventArgs propertyArgs, NotifyCollectionChangedEventArgs listArgs) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 434<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 457<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at System.EventHandler`1.Invoke(Object sender, TEventArgs e)<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 424<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.RaiseChildChanged(Object childObject, PropertyChangedEventArgs propertyArgs, NotifyCollectionChangedEventArgs listArgs) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 434<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 457<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2869<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_Changed(Object sender, ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2944<br />&nbsp;&nbsp; at System.EventHandler`1.Invoke(Object sender, TEventArgs e)<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.OnChildChanged(ChildChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2861<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.RaiseChildChanged(Object childObject, PropertyChangedEventArgs propertyArgs) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2879<br />&nbsp;&nbsp; at Csla.Core.BusinessBase.Child_PropertyChanged(Object sender, PropertyChangedEventArgs e) in C:\csla\Csla4.1.0\Source\Csla\Core\BusinessBase.cs:line 2911<br />&nbsp;&nbsp; at System.Collections.ObjectModel.ObservableCollection`1.OnPropertyChanged(PropertyChangedEventArgs e)<br />&nbsp;&nbsp; at System.Collections.ObjectModel.ObservableCollection`1.InsertItem(Int32 index, T item)<br />&nbsp;&nbsp; at Csla.Core.ObservableBindingList`1.InsertItem(Int32 index, T item) in C:\csla\Csla4.1.0\Source\Csla\Core\ObservableBindingList.cs:line 294<br />&nbsp;&nbsp; at Csla.BusinessListBase`2.InsertItem(Int32 index, C item) in C:\csla\Csla4.1.0\Source\Csla\BusinessListBase.cs:line 323<br />&nbsp;&nbsp; at System.Collections.ObjectModel.Collection`1.Add(T item)<br />&nbsp;&nbsp; at Aps.SaasHr.Library.M3Migration.CcLeafs.NewLeaf(String name, CcLeaf parent) in C:\Documents and Settings\markb\My Documents\Visual Studio 2010\Projects\Aps.SaasHr\Aps.Saas.Library\M3Migration\CcLeafs.cs:line 16<br />&nbsp;&nbsp; at Aps.SaasHr.M3Migration.Wpf.ViewModel.MigrantVm.DoCcDrop(CcLeaf dropTo, Object dropped) in C:\Documents and Settings\markb\My Documents\Visual Studio 2010\Projects\Aps.SaasHr\Aps.SaasHr.M3Migration.Wpf\ViewModel\MigrantVm.cs:line 196<br />&nbsp;&nbsp; at Aps.SaasHr.M3Migration.Wpf.ViewModel.MigrantVm.&lt;.cctor&gt;b__41(Object[] x) in C:\Documents and Settings\markb\My Documents\Visual Studio 2010\Projects\Aps.SaasHr\Aps.SaasHr.M3Migration.Wpf\ViewModel\MigrantVm.cs:line 156<br />&nbsp;&nbsp; at GalaSoft.MvvmLight.Command.RelayCommand`1.Execute(Object parameter)<br />&nbsp;&nbsp; at Aps.SaasHr.M3Migration.Wpf.ViewModel.MigrantVm.&lt;&gt;c__DisplayClass4.&lt;SetCcDrop&gt;b__3(Object sender, DragEventArgs args) in C:\Documents and Settings\markb\My Documents\Visual Studio 2010\Projects\Aps.SaasHr\Aps.SaasHr.M3Migration.Wpf\ViewModel\MigrantVm.cs:line 136<br />&nbsp;&nbsp; at System.Windows.DragEventArgs.InvokeEventHandler(Delegate genericHandler, Object genericTarget)<br />&nbsp;&nbsp; at System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object target)<br />&nbsp;&nbsp; at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs)<br />&nbsp;&nbsp; at System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)<br />&nbsp;&nbsp; at System.Windows.UIElement.RaiseEventImpl(DependencyObject sender, RoutedEventArgs args)<br />&nbsp;&nbsp; at System.Windows.UIElement.RaiseEvent(RoutedEventArgs e)<br />&nbsp;&nbsp; at System.Windows.OleDropTarget.RaiseDragEvent(RoutedEvent dragEvent, Int32 dragDropKeyStates, Int32&amp; effects, DependencyObject target, Point targetPoint)<br />&nbsp;&nbsp; at System.Windows.OleDropTarget.MS.Win32.UnsafeNativeMethods.IOleDropTarget.OleDrop(Object data, Int32 dragDropKeyStates, Int64 point, Int32&amp; effects)<br />&nbsp;&nbsp; at MS.Win32.UnsafeNativeMethods.DoDragDrop(IDataObject dataObject, IOleDropSource dropSource, Int32 allowedEffects, Int32[] finalEffect)<br />&nbsp;&nbsp; at System.Windows.OleServicesContext.OleDoDragDrop(IDataObject dataObject, IOleDropSource dropSource, Int32 allowedEffects, Int32[] finalEffect)<br />&nbsp;&nbsp; at System.Windows.DragDrop.OleDoDragDrop(DependencyObject dragSource, DataObject dataObject, DragDropEffects allowedEffects)<br />&nbsp;&nbsp; at System.Windows.DragDrop.DoDragDrop(DependencyObject dragSource, Object data, DragDropEffects allowedEffects)<br />&nbsp;&nbsp; at Aps.SaasHr.M3Migration.Wpf.ViewModel.MigrantVm.&lt;&gt;c__DisplayClass1.&lt;SetCcDrag&gt;b__0(Object sender, MouseEventArgs args) in C:\Documents and Settings\markb\My Documents\Visual Studio 2010\Projects\Aps.SaasHr\Aps.SaasHr.M3Migration.Wpf\ViewModel\MigrantVm.cs:line 71<br />&nbsp;&nbsp; at System.Windows.Input.MouseEventArgs.InvokeEventHandler(Delegate genericHandler, Object genericTarget)<br />&nbsp;&nbsp; at System.Windows.RoutedEventArgs.InvokeHandler(Delegate handler, Object target)<br />&nbsp;&nbsp; at System.Windows.RoutedEventHandlerInfo.InvokeHandler(Object target, RoutedEventArgs routedEventArgs)<br />&nbsp;&nbsp; at System.Windows.EventRoute.InvokeHandlersImpl(Object source, RoutedEventArgs args, Boolean reRaised)<br />&nbsp;&nbsp; at System.Windows.UIElement.RaiseEventImpl(DependencyObject sender, RoutedEventArgs args)<br />&nbsp;&nbsp; at System.Windows.UIElement.RaiseTrustedEvent(RoutedEventArgs args)<br />&nbsp;&nbsp; at System.Windows.UIElement.RaiseEvent(RoutedEventArgs args, Boolean trusted)<br />&nbsp;&nbsp; at System.Windows.Input.InputManager.ProcessStagingArea()<br />&nbsp;&nbsp; at System.Windows.Input.InputManager.ProcessInput(InputEventArgs input)<br />&nbsp;&nbsp; at System.Windows.Input.MouseDevice.Synchronize()<br />&nbsp;&nbsp; at System.Windows.Input.MouseDevice.PostProcessInput(Object sender, ProcessInputEventArgs e)<br />&nbsp;&nbsp; at System.Windows.Input.InputManager.RaiseProcessInputEventHandlers(ProcessInputEventHandler postProcessInput, ProcessInputEventArgs processInputEventArgs)<br />&nbsp;&nbsp; at System.Windows.Input.InputManager.ProcessStagingArea()<br />&nbsp;&nbsp; at System.Windows.Input.InputManager.ProcessInput(InputEventArgs input)<br />&nbsp;&nbsp; at System.Windows.Input.InputProviderSite.ReportInput(InputReport inputReport)<br />&nbsp;&nbsp; at System.Windows.Interop.HwndMouseInputProvider.ReportInput(IntPtr hwnd, InputMode mode, Int32 timestamp, RawMouseActions actions, Int32 x, Int32 y, Int32 wheel)<br />&nbsp;&nbsp; at System.Windows.Interop.HwndMouseInputProvider.FilterMessage(IntPtr hwnd, WindowMessage msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br />&nbsp;&nbsp; at System.Windows.Interop.HwndSource.InputFilterMessage(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br />&nbsp;&nbsp; at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean&amp; handled)<br />&nbsp;&nbsp; at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)<br />&nbsp;&nbsp; at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)<br />&nbsp;&nbsp; at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler)<br />&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Int32 numArgs)<br />&nbsp;&nbsp; at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)<br />&nbsp;&nbsp; at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG&amp; msg)<br />&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)<br />&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)<br />&nbsp;&nbsp; at System.Windows.Threading.Dispatcher.Run()<br />&nbsp;&nbsp; at System.Windows.Application.RunDispatcher(Object ignore)<br />&nbsp;&nbsp; at System.Windows.Application.RunInternal(Window window)<br />&nbsp;&nbsp; at System.Windows.Application.Run(Window window)<br />&nbsp;&nbsp; at System.Windows.Application.Run()<br />&nbsp;&nbsp; at Aps.SaasHr.M3Migration.Wpf.App.Main() in C:\Documents and Settings\markb\My Documents\Visual Studio 2010\Projects\Aps.SaasHr\Aps.SaasHr.M3Migration.Wpf\obj\Debug\App.g.cs:line 0<br />&nbsp;&nbsp; at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)<br />&nbsp;&nbsp; at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)<br />&nbsp;&nbsp; at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()<br />&nbsp;&nbsp; at System.Threading.ThreadHelper.ThreadStart_Context(Object state)<br />&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)<br />&nbsp;&nbsp; at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)<br />&nbsp;&nbsp; at System.Threading.ThreadHelper.ThreadStart()</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Here is the class. Note the child property of the same type as the owner here. I&#39;m guessing this has something to do with my problem. Oddly enough, setting this property isn&#39;t what throws the exception. Even odder, it seems to only happen under certain conditions. Very puzzling.</p>
<p>&nbsp;</p>
<p>using System;<br />using System.Collections.Generic;<br />using System.Linq;<br />using System.Text;<br />using Csla;<br /><br />namespace Aps.SaasHr.Library.M3Migration<br />{<br />&nbsp;&nbsp;&nbsp; public class CcLeaf : Csla.BusinessBase&lt;CcLeaf&gt;<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static readonly PropertyInfo&lt;string&gt; NameProperty = RegisterProperty&lt;string&gt;(c =&gt; c.Name);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public string Name<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; get { return GetProperty(NameProperty); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; set { SetProperty(NameProperty, value); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static readonly PropertyInfo&lt;int&gt; M3LevelProperty = RegisterProperty&lt;int&gt;(c =&gt; c.M3Level);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public int M3Level<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; get { return GetProperty(M3LevelProperty); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; set { SetProperty(M3LevelProperty, value); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static readonly PropertyInfo&lt;string&gt; ExternIdProperty = RegisterProperty&lt;string&gt;(c =&gt; c.ExternId);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public string ExternId<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; get { return GetProperty(ExternIdProperty); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; set { SetProperty(ExternIdProperty, value); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static readonly PropertyInfo&lt;CcLeaf&gt; LeafParentProperty = RegisterProperty&lt;CcLeaf&gt;(c =&gt; c.LeafParent);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public CcLeaf LeafParent<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; get { return GetProperty(LeafParentProperty); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; set { SetProperty(LeafParentProperty, value); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br /><br /><b>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static readonly PropertyInfo&lt;CcLeafs&gt; LeafChildrenProperty = RegisterProperty&lt;CcLeafs&gt;(c =&gt; c.LeafChildren, &quot;Cost Center Tree Leafs&quot;, null, RelationshipTypes.Child);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public CcLeafs LeafChildren<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; get { return GetProperty(LeafChildrenProperty); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; private set { SetProperty(LeafChildrenProperty, value); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }</b><br /><br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static readonly PropertyInfo&lt;string&gt; Cust1Property = RegisterProperty&lt;string&gt;(c =&gt; c.Cust1);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public string Cust1<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; get { return GetProperty(Cust1Property); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; set { SetProperty(Cust1Property, value); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static readonly PropertyInfo&lt;string&gt; Cust2Property = RegisterProperty&lt;string&gt;(c =&gt; c.Cust2);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public string Cust2<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; get { return GetProperty(Cust2Property); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; set { SetProperty(Cust2Property, value); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static readonly PropertyInfo&lt;string&gt; Cust3Property = RegisterProperty&lt;string&gt;(c =&gt; c.Cust3);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public string Cust3<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; get { return GetProperty(Cust3Property); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; set { SetProperty(Cust3Property, value); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static readonly PropertyInfo&lt;string&gt; Cust4Property = RegisterProperty&lt;string&gt;(c =&gt; c.Cust4);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public string Cust4<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; get { return GetProperty(Cust4Property); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; set { SetProperty(Cust4Property, value); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static readonly PropertyInfo&lt;string&gt; Cust5Property = RegisterProperty&lt;string&gt;(c =&gt; c.Cust5);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public string Cust5<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; get { return GetProperty(Cust5Property); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; set { SetProperty(Cust5Property, value); }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public string GetPath()<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; string result = Name;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CcLeaf parent = LeafParent;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; while (parent != null)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; result = string.Format(&quot;{0}/{1}&quot;, parent.Name, result);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; parent = parent.LeafParent;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return result;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; internal static CcLeaf Create(CcLeaf parent, string name)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return Csla.DataPortal.CreateChild&lt;CcLeaf&gt;(new object[] {parent, name});<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; private void Child_Create(CcLeaf parent, string name)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; LoadProperty(LeafParentProperty, parent);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; LoadProperty(NameProperty, name);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; LoadProperty(LeafChildrenProperty, CcLeafs.Create());<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; BusinessRules.CheckRules();<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; }<br />}<br /></p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Tuesday, August 16, 2011</h2><p>Just a wild guess but could it possibly be that your app creates circular ownerships? </p>
<p>&nbsp;</p>
<p>Parent</p>
<p>- Leafs</p>
<p>&nbsp;&nbsp;&nbsp; - Leaf 1</p>
<p>&nbsp;&nbsp;&nbsp; - Leaf 2</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Leafs</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Leaf 4</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Leafs</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - Leaf 2</b></p>
<p><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - x<br /></b></p>
<p>That would account for creating a circular reference and Child_Changed events would go on forever until Stack Overflow exception is thrown.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius replied on Wednesday, August 17, 2011</h2><p>It would appear that&#39;s somehow happening, I just can&#39;t understand why. I have 5 treeviews that&#39;s binding to my view model here. I have a drag drop operation that drops to the first treeview fine, then when dropping to the second (bound to a completely different instance of CcLeafs) is where I experience the problem.So it&#39;s acting like even though it&#39;s bound to an entirely DIFFERENT instance of CcLeaf, it&#39;s somehow adding to the LeafChildren property of the FIRST instance. I&#39;m wondering if CSLA is somehow returning the reflected property improperly from the cache or something, because that&#39;s what it&#39;s acting like....</p>
<p>I don&#39;t think the M3Dept class is really important here, so I left that out...</p>
<p><b>Here&#39;s my view model:</b></p>
<p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; #region Drop Commands and Attached Properties<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; #region CcDrag Attached Property<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// The CcDrag attached property&#39;s name.<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public const string CcDragPropertyName = &quot;CcDrag&quot;;<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// Gets the value of the CcDrag attached property <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// for a given dependency object.<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;obj&quot;&gt;The object for which the property value<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// is read.&lt;/param&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;returns&gt;The value of the CcDrag property of the specified object.&lt;/returns&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static string GetCcDrag(System.Windows.Controls.TextBlock obj)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return (string)obj.GetValue(CcDragProperty);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// Sets the value of the CcDrag attached property<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// for a given dependency object. <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;obj&quot;&gt;The object to which the property value<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// is written.&lt;/param&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;value&quot;&gt;Sets the CcDrag value of the specified object.&lt;/param&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static void SetCcDrag(System.Windows.Controls.TextBlock obj, string value)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; obj.SetValue(CcDragProperty, value);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; obj.MouseMove += (sender, args) =&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; DragDrop.DoDragDrop(obj, obj.Tag, DragDropEffects.All);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; };<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// Identifies the CcDrag attached property.<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static readonly DependencyProperty CcDragProperty = DependencyProperty.RegisterAttached(<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CcDragPropertyName,<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; typeof(string),<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; typeof(System.Windows.Controls.TextBlock),<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; new UIPropertyMetadata(null));<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; #endregion<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; #region CcDrop Attached Property<br /><br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// The CcDrop attached property&#39;s name.<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public const string CcDropPropertyName = &quot;CcDrop&quot;;<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// Gets the value of the CcDrop attached property <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// for a given dependency object.<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;obj&quot;&gt;The object for which the property value<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// is read.&lt;/param&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;returns&gt;The value of the CcDrop property of the specified object.&lt;/returns&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static string GetCcDrop(System.Windows.Controls.TextBlock obj)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return (string)obj.GetValue(CcDropProperty);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// Sets the value of the CcDrop attached property<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// for a given dependency object. <br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;obj&quot;&gt;The object to which the property value<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// is written.&lt;/param&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;param name=&quot;value&quot;&gt;Sets the CcDrop value of the specified object.&lt;/param&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static void SetCcDrop(System.Windows.Controls.TextBlock obj, string value)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; obj.SetValue(CcDropProperty, value);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; obj.Drop += (sender, args) =&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; M3Cc m3Cc = (M3Cc)args.Data.GetData(typeof(M3Cc));<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (m3Cc != null)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CcDrop.Execute(new[] { obj.Tag, m3Cc });<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CcLeaf leaf = (CcLeaf)args.Data.GetData(typeof(CcLeaf));<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (leaf != null)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CcDrop.Execute(new[] { obj.Tag, leaf });<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; M3Dept dept = (M3Dept)args.Data.GetData(typeof(M3Dept));<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (dept != null)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CcDrop.Execute(new[] { obj.Tag, dept });<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; };<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// Identifies the CcDrop attached property.<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static readonly DependencyProperty CcDropProperty = DependencyProperty.RegisterAttached(<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CcDropPropertyName,<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; typeof(string),<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; typeof(System.Windows.Controls.TextBlock),<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; new PropertyMetadata(string.Empty));<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; #endregion</p>
<p style="padding-left:30px;">#endregion</p>
<p style="padding-left:30px;">&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>#region CcDrop Command<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static RelayCommand&lt;object[]&gt; CcDrop = new RelayCommand&lt;object[]&gt;(x =&gt; DoCcDrop((CcLeaf)x[0], x[1]));<br /><br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static void DoCcDrop(CcLeaf dropTo, object dropped)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (dropTo == null) throw new ArgumentNullException(&quot;dropTo&quot;, &quot;Parameter dropTo cannot be null.&quot;);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (dropped == null) throw new ArgumentNullException(&quot;dropped&quot;, &quot;Parameter dropped cannot be null.&quot;);<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (dropTo.Equals(dropped)) return;<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (dropped is CcLeaf)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CcLeaf parent = dropTo.LeafParent;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; while (parent != null)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // don&#39;t allow dropping into self&#39;s hierarchy<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (parent.Equals(dropped)) return;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; parent =parent.LeafParent;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; parent = ((CcLeaf)dropped).LeafParent;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (parent != null)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // the leaf was moved from elsewhere, so first remove it from the old parent<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; parent.LeafChildren.Remove((CcLeaf)dropped);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; // add the leaf to the new location in the tree<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; dropTo.LeafChildren.Add((CcLeaf)dropped);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else if (dropped is M3Cc)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var leaf = dropTo.LeafChildren.AddNew();<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; leaf.Name = ((M3Cc)dropped).Name;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; leaf.M3Level = ((M3Cc)dropped).Level;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else if (dropped is M3Dept)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; var dept = (M3Dept)dropped;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; dropTo.Name = dept.Name;<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; foreach (var c in dept.Ccs)<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; dropTo.LeafChildren.NewLeaf(c.Name, dropTo);<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br /><br />&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; #endregion</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><b>And here&#39;s the view code:</b></p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;!--Display items that can be dragged onto CcLeafs here... --&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;StackPanel Grid.Row=&quot;1&quot; Grid.Column=&quot;0&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;StackPanel.Resources&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;HierarchicalDataTemplate x:Key=&quot;DeptTemplate&quot; ItemsSource=&quot;{Binding Ccs}&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;!--Display the Department name--&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TextBlock Text=&quot;{Binding Path=Name}&quot; vm:MigrantVm.CcDrag=&quot;&quot; Tag=&quot;{Binding}&quot;&gt;&lt;/TextBlock&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;HierarchicalDataTemplate.ItemTemplate&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;DataTemplate&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;!--Display the cost center--&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TextBlock Text=&quot;{Binding Path=Name}&quot; Tag=&quot;{Binding}&quot; vm:MigrantVm.CcDrag=&quot;&quot;&gt;&lt;/TextBlock&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/DataTemplate&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/HierarchicalDataTemplate.ItemTemplate&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/HierarchicalDataTemplate&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/StackPanel.Resources&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TreeView ItemTemplate=&quot;{StaticResource DeptTemplate}&quot; ItemsSource=&quot;{Binding M3Depts}&quot;&gt;&lt;/TreeView&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/StackPanel&gt;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;&lt;!--Display CcLeafs that items can be dragged to here...--&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;StackPanel Grid.Row=&quot;1&quot; Grid.Column=&quot;1&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;StackPanel.Resources&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Style x:Key=&quot;CcTextBlockStyle&quot; TargetType=&quot;TextBlock&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Setter Property=&quot;Text&quot; Value=&quot;{Binding Path=Name}&quot;&gt;&lt;/Setter&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Setter Property=&quot;AllowDrop&quot; Value=&quot;True&quot;&gt;&lt;/Setter&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Setter Property=&quot;Tag&quot; Value=&quot;{Binding}&quot;&gt;&lt;/Setter&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Setter Property=&quot;HorizontalAlignment&quot; Value=&quot;Stretch&quot;&gt;&lt;/Setter&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/Style&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;HierarchicalDataTemplate x:Key=&quot;CcTreeItemTemplate&quot; ItemsSource=&quot;{Binding Path=LeafChildren}&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;!--Display the root leaf name--&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TextBlock Style=&quot;{StaticResource CcTextBlockStyle}&quot; vm:MigrantVm.CcDrop=&quot;&quot; vm:MigrantVm.CcDrag=&quot;&quot;&gt;&lt;/TextBlock&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;HierarchicalDataTemplate.ItemTemplate&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;HierarchicalDataTemplate ItemsSource=&quot;{Binding LeafChildren, Converter={StaticResource Debug}}&quot;&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;!--Display the next leaf--&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TextBlock Style=&quot;{StaticResource CcTextBlockStyle}&quot; vm:MigrantVm.CcDrop=&quot;&quot; vm:MigrantVm.CcDrag=&quot;&quot;&gt;&lt;/TextBlock&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;HierarchicalDataTemplate.ItemTemplate&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;DataTemplate&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;!--Display the next leaf--&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TextBlock Style=&quot;{StaticResource CcTextBlockStyle}&quot; vm:MigrantVm.CcDrop=&quot;&quot; vm:MigrantVm.CcDrag=&quot;&quot;&gt;&lt;/TextBlock&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/DataTemplate&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/HierarchicalDataTemplate.ItemTemplate&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/HierarchicalDataTemplate&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/HierarchicalDataTemplate.ItemTemplate&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/HierarchicalDataTemplate&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/StackPanel.Resources&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TreeView ItemsSource=&quot;{Binding Migrant.CcTree1}&quot; ItemTemplate=&quot;{StaticResource CcTreeItemTemplate}&quot;&nbsp; &gt;&lt;/TreeView&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TreeView ItemsSource=&quot;{Binding Migrant.CcTree2}&quot; ItemTemplate=&quot;{StaticResource CcTreeItemTemplate}&quot;&nbsp; &gt;&lt;/TreeView&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TreeView ItemsSource=&quot;{Binding Migrant.CcTree3}&quot; ItemTemplate=&quot;{StaticResource CcTreeItemTemplate}&quot;&nbsp; &gt;&lt;/TreeView&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TreeView ItemsSource=&quot;{Binding Migrant.CcTree4}&quot; ItemTemplate=&quot;{StaticResource CcTreeItemTemplate}&quot;&nbsp; &gt;&lt;/TreeView&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;TreeView ItemsSource=&quot;{Binding Migrant.CcTree5}&quot; ItemTemplate=&quot;{StaticResource CcTreeItemTemplate}&quot;&nbsp; &gt;&lt;/TreeView&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/StackPanel&gt;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius replied on Wednesday, August 17, 2011</h2><p>Stepping through the code, the propertyArgs.PropertyName during the RaiseChildChanged event is always &quot;Count&quot; and the childObject is always the same.... interesting. Still don&#39;t get how this is happening though. :(</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
