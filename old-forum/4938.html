<html><header><title>LINQ to Objects - ReadOnlyListBase / ReadOnlyBase</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>LINQ to Objects - ReadOnlyListBase / ReadOnlyBase</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4938.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>barbamodder posted on Thursday, June 05, 2008</h2>Hi group,<br><br>In my VS2008 3.5 WinForm app I have 2 classes:<br>'Person' which is a ReadOnlyBase<br>'PersonList' which is a ReadOnlyListBase<br><br>I also have a form that displays all Person(s) in the PersonList.<br><br>I want to use LINQ to query and filter the Person(s) in the PersonList.<br><br>Question: Is this possible and if so HOW?<br><br>So I want something like this:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string LastNameFilter = TextboxLastName.Text;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var query = (from person in PersonList where person.LastName == LastNameFilter<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; select pers);<br><br><br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Philip replied on Thursday, June 05, 2008</h2><P><FONT face=Verdana>Here is an example for the Resource class in ProjectTracker application (generated by Code Complete) </FONT></P>
<P><FONT face=Verdana>//ReadOnlyListBase</FONT></P><FONT size=2></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>namespace</FONT><FONT size=2><FONT color=#000000> ProjectTrackerDemoWin</FONT></P>
<P>{</P>
<P>&nbsp;</P>
<P>[</FONT><FONT color=#2b91af size=2>Serializable</FONT><FONT size=2>()]</P>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>partial</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>class</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>BLResourceInfoList</FONT><FONT size=2> : </FONT><FONT color=#2b91af size=2>ReadOnlyListBase</FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2>BLResourceInfoList</FONT><FONT size=2>, </FONT><FONT color=#2b91af size=2>BLResourceInfo</FONT><FONT size=2>&gt;</P>
<P>{</P></FONT><FONT color=#0000ff size=2>
<P>#region</FONT><FONT size=2><FONT color=#000000> "Factory Methods"</FONT></P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>static</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>BLResourceInfoList</FONT><FONT size=2> GetBLResourceInfoList(System.</FONT><FONT color=#2b91af size=2>String</FONT><FONT size=2> LastName)</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>DataPortal</FONT><FONT size=2>.Fetch&lt;</FONT><FONT color=#2b91af size=2>BLResourceInfoList</FONT><FONT size=2>&gt;</P>
<P>(</FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>FilteredCriteria</FONT><FONT size=2>(LastName));</P>
<P>}</P>
<P></FONT>
<P><FONT color=#808080 size=2></P></FONT><FONT size=2></FONT><FONT color=#0000ff size=2>private</FONT><FONT size=2> BLResourceInfoList()</P>
<P>{ </FONT><FONT size=2>}</P>
<P></FONT><FONT color=#0000ff size=2>#endregion</P>
<P>#region</FONT><FONT size=2><FONT color=#000000> "Data Access"</FONT></P>
<P>[</FONT><FONT color=#2b91af size=2>Serializable</FONT><FONT size=2>()]</P>
<P></FONT><FONT color=#0000ff size=2>private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>class</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>FilteredCriteria</P></FONT><FONT size=2>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>private</FONT><FONT size=2> System.</FONT><FONT color=#2b91af size=2>String</FONT><FONT size=2> _LastName = </FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2>.Empty;</P>
<P>&nbsp;</P>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> System.</FONT><FONT color=#2b91af size=2>String</FONT><FONT size=2> LastName</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>get</P></FONT><FONT size=2>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> _LastName;</P>
<P>}</P>
<P>}</P>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> FilteredCriteria(System.</FONT><FONT color=#2b91af size=2>String</FONT><FONT size=2> LastName)</P>
<P>{</P>
<P>_LastName = LastName;</P>
<P>}</P>
<P>}</P>
<P></FONT><FONT color=#0000ff size=2>private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> DataPortal_Fetch(</FONT><FONT color=#2b91af size=2>FilteredCriteria</FONT><FONT size=2> criteria)</P>
<P>{</P>
<P>Fetch(criteria.LastName);</P>
<P>}</P></FONT><FONT size=2><FONT size=2>
<P></FONT><FONT color=#008000 size=2>//Search by last name using LIKE type operator</P></FONT></FONT><FONT color=#0000ff size=2></FONT>
<P><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> Fetch(System.</FONT><FONT color=#2b91af size=2>String</FONT><FONT size=2> LastName)</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>try</P></FONT><FONT size=2>
<P>{</P>
<P>RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2>false</FONT><FONT size=2>;</P>
<P></FONT><FONT color=#0000ff size=2>using</FONT><FONT size=2> (</FONT><FONT color=#0000ff size=2>var</FONT><FONT size=2> ctx = </FONT><FONT color=#2b91af size=2>ContextManager</FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2>ProjectTrackerSQLDataContext</FONT><FONT size=2>&gt;.GetManager(</FONT><FONT color=#a31515 size=2>"ProjectTrackerSQL"</FONT><FONT size=2>))</P>
<P>{</P>
<P></FONT><FONT color=#2b91af size=2>IEnumerable</FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2>Resource</FONT><FONT size=2>&gt; Resources = (</FONT><FONT color=#0000ff size=2>from</FONT><FONT size=2> record </FONT><FONT color=#0000ff size=2>in</FONT><FONT size=2> ctx.DataContext.Resources </FONT><FONT color=#0000ff size=2>where</FONT><FONT size=2> record.LastName.StartsWith(LastName) </FONT><FONT color=#0000ff size=2>select</FONT><FONT size=2> record);</P>
<P>IsReadOnly = </FONT><FONT color=#0000ff size=2>false</FONT><FONT size=2>;</P>
<P></FONT><FONT color=#0000ff size=2>foreach</FONT><FONT size=2> (</FONT><FONT color=#2b91af size=2>Resource</FONT><FONT size=2> item </FONT><FONT color=#0000ff size=2>in</FONT><FONT size=2> Resources)</P>
<P>{</P>
<P></FONT><FONT color=#2b91af size=2>BLResourceInfo</FONT><FONT size=2> info = </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>BLResourceInfo</FONT><FONT size=2>(item.Id,</P>
<P>item.LastName,</P>
<P>item.FirstName);</P>
<P></FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.Add(info);</P>
<P>}</P>
<P>IsReadOnly = </FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>;</P>
<P>}</P>
<P>&nbsp;</P>
<P>RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>;</P>
<P>}</P>
<P></FONT><FONT color=#0000ff size=2>catch</FONT><FONT size=2> (</FONT><FONT color=#2b91af size=2>Exception</FONT><FONT size=2> ex)</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>throw</FONT><FONT size=2> ex;</P>
<P>}</P>
<P>}</P>
<P></FONT><FONT color=#0000ff size=2>#endregion</P></FONT><FONT size=2>
<P>}</P>
<P>}</P>
<P>//ReadOnlyClass</P><FONT color=#0000ff size=2>
<P>namespace</FONT><FONT size=2><FONT color=#000000> ProjectTrackerDemoWin</FONT></P>
<P>{</P>
<P>&nbsp;</P>
<P>[</FONT><FONT color=#2b91af size=2>Serializable</FONT><FONT size=2>()]</P>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>partial</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>class</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>BLResourceInfo</FONT><FONT size=2> : </FONT><FONT color=#2b91af size=2>ReadOnlyBase</FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2>BLResourceInfo</FONT><FONT size=2>&gt;</P>
<P>{</P></FONT><FONT color=#0000ff size=2>
<P>#region</FONT><FONT size=2><FONT color=#000000> "Private Variables"</FONT></P>
<P></FONT><FONT color=#0000ff size=2>private</FONT><FONT size=2> System.</FONT><FONT color=#2b91af size=2>Int32</FONT><FONT size=2> _Id;</P>
<P></FONT><FONT color=#0000ff size=2>private</FONT><FONT size=2> System.</FONT><FONT color=#2b91af size=2>String</FONT><FONT size=2> _LastName = </FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2>.Empty;</P>
<P>&nbsp;</P>
<P></FONT><FONT color=#0000ff size=2>private</FONT><FONT size=2> System.</FONT><FONT color=#2b91af size=2>String</FONT><FONT size=2> _FirstName = </FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2>.Empty;</P>
<P>&nbsp;</P></FONT><FONT color=#0000ff size=2>
<P>#endregion</P>
<P>#region</FONT><FONT size=2><FONT color=#000000> "Public Properties"</FONT></P>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> System.</FONT><FONT color=#2b91af size=2>Int32</FONT><FONT size=2> Id</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>get</P></FONT><FONT size=2>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> _Id;</P>
<P>}</P>
<P>}</P>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> System.</FONT><FONT color=#2b91af size=2>String</FONT><FONT size=2> LastName</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>get</P></FONT><FONT size=2>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> _LastName;</P>
<P>}</P>
<P>}</P>
<P></P>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> System.</FONT><FONT color=#2b91af size=2>String</FONT><FONT size=2> FirstName</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>get</P></FONT><FONT size=2>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> _FirstName;</P>
<P>}</P>
<P>}</P>
<P></P>
<P></FONT><FONT color=#0000ff size=2>protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>override</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>object</FONT><FONT size=2> GetIdValue()</P>
<P>{</P>
<P></FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> _Id;</P>
<P>}</P>
<P></P></FONT><FONT color=#0000ff size=2>
<P>#endregion</P>
<P>#region</FONT><FONT size=2><FONT color=#000000> "Constructors"</FONT></P>
<P><FONT color=#000000></FONT></P>
<P></FONT><FONT color=#0000ff size=2>private</FONT><FONT size=2> BLResourceInfo()</P>
<P>{ }</P>
<P></P>
<P></FONT><FONT color=#0000ff size=2>internal</FONT><FONT size=2> BLResourceInfo(System.</FONT><FONT color=#2b91af size=2>Int32</FONT><FONT size=2> Id,</P>
<P>System.</FONT><FONT color=#2b91af size=2>String</FONT><FONT size=2> LastName,</P>
<P>System.</FONT><FONT color=#2b91af size=2>String</FONT><FONT size=2> FirstName)</P>
<P>{</P>
<P>_Id = Id;</P>
<P>_LastName = LastName;</P>
<P>_FirstName = FirstName;</P>
<P>}</P>
<P></P></FONT><FONT color=#0000ff size=2>
<P>#endregion</P></FONT><FONT size=2>
<P>}</P>
<P>}</P>
<P>&nbsp;</P>
<P>Philip</P></FONT></FONT></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
