<html><header><title>Fetchng BO's composed of two or more child BO's</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Fetchng BO's composed of two or more child BO's</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/606.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>marioe2000 posted on Wednesday, July 12, 2006</h2><P>I've been researching for a solution to this issue on both the new and old forums but have not come to a solution to this or a similar situation, if someone has please point me in the right direction. This situation is as follows:</P>
<P>I have an editable root BO composed of a couple of standard private fields (int's, strings, etc.). Two or more of it's private fields are child BO's of the same type:</P>
<P>public class Driver<BR>inherits BusinessBase<BR><BR>&nbsp;&nbsp;&nbsp;private mDriverName as string<BR>&nbsp;&nbsp;&nbsp;private mDriverNumber as integer<BR>&nbsp;&nbsp;&nbsp;private mDriverPrivateAddressZip as ZipCode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'ZipCode is a child&nbsp;BO<BR>&nbsp;&nbsp;&nbsp;private mDriverWorkAddressZip as ZipCode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </P>
<P>.....<BR><BR>end class<BR><BR>public class ZipCode<BR>inherits BusinessBase<BR><BR>&nbsp;&nbsp;&nbsp;private mZipName as string<BR>&nbsp;&nbsp;&nbsp;private mZipCity as City&nbsp;&nbsp;&nbsp; 'City is a also child BO<BR><BR>.....<BR>end class</P>
<P>I'm trying to fetch the driver's record and the zip&nbsp;and city date from the DB in a single shot and call GetZipCodeChild(dr) passing the data reader I got with the driver's details as well as it's childs data. The problem is that I'm getting two childs of the same type on the same datareader and cannot pass one of the childs a datareader as expected by it.</P>
<P>We worked-around the problem by fetching the child's data on separate recordsets from the stored proc and do a dr.nextresult to get to their corresponding data before calling each child's fetch method; but that only works for a single driver and not when we try to get a collection of drivers using a single select statement. For that we resorted to fetching the drivers and feeding the results directly to a grid, but I'd like a more OO approach.</P>
<P>We've verified that we in fact need the zip code class data for both childs, i.e. our use cases do dictate that we have both zip codes on the driver. Do we need to revise our use cases and/or our design of the driver or zipcode classes? The application we are building is very dependant on places (i.e. zip codes, cities, counties, states, etc.), they're not just strings in our problem domain.</P>
<P>Any ideas? </P>
<P>Regards,</P>
<P>Mario Estrella</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jwooley replied on Wednesday, July 12, 2006</h2><P>A possible consideration is to change your GetZipCodeChild() method to take the two properties passed by the dataportal_Fetch of the buisness class. This is what I do with a generic Address class which handles the business logic and structure. The actual persistance is handled by the parent business class in this case. Thus you could define your shared method call as follows:</P>
<P>Public Shared Function GetZipCodeChild(zipName as string, zipCity as string) as ZipCode<BR>&nbsp;&nbsp;&nbsp; return New ZipCode(zipName, zipCity)<BR>end Function</P>
<P>Private Sub New(zipName as string, zipCity as string) <BR>&nbsp; mybase.New()<BR>&nbsp;&nbsp; mZipName=zipName<BR>&nbsp;&nbsp; mZipCity=zipCity<BR>&nbsp;&nbsp; MarkOld()<BR>End Sub</P>
<P>Naturally, placing the object value initialization in the overloaded constructor could be moved up the chain to the shared function, but placing it in the constructor seems more inline with other similar implementations I've seen.</P>
<P>Jim Wooley<BR><A href="http://devauthority.com/blogs/jwooley/default.aspx">http://devauthority.com/blogs/jwooley/default.aspx</A></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>marioe2000 replied on Monday, July 24, 2006</h2><P>Ahh!!&nbsp; .... Right !!!! .... </P>
<P>Thanks Jim</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
