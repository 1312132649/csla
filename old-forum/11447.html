<html><header><title>Child in RootList is saved when it is unchanged.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Child in RootList is saved when it is unchanged.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11447.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>TF Zheng posted on Monday, July 02, 2012</h2><p class="MsoNormal" style="margin:0in 0in 0pt;background:#cedefd;"><span lang="EN" style="color:#333333;mso-ansi-language:EN;"><span style="font-family:Times New Roman;"><span style="font-size:small;">We have model below for 10 buildings:</span></span></span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;background:#cedefd;"><span style="font-size:small;"><span style="font-family:Times New Roman;"><span lang="EN" style="color:#333333;mso-ansi-language:EN;">&nbsp;&nbsp;&nbsp;&nbsp; Buildings (</span><b><i><span lang="EN" style="color:#7030a0;mso-ansi-language:EN;">EditableRootList</span></i></b><span lang="EN" style="color:#333333;mso-ansi-language:EN;">) ---</span></span><span lang="EN" style="font-family:Wingdings;color:#333333;mso-ansi-language:EN;">&agrave;</span><span style="font-family:Times New Roman;"><span lang="EN" style="color:#333333;mso-ansi-language:EN;">Floors(</span><b><i><span lang="EN" style="color:#7030a0;mso-ansi-language:EN;">EditableChildList</span></i></b><span lang="EN" style="color:#333333;mso-ansi-language:EN;">) -----</span></span><span lang="EN" style="font-family:Wingdings;color:#333333;mso-ansi-language:EN;">&agrave;</span><span style="font-family:Times New Roman;"><span lang="EN" style="color:#333333;mso-ansi-language:EN;"> Rooms(</span><b><i><span lang="EN" style="color:#7030a0;mso-ansi-language:EN;">EditableChildList</span></i></b><span lang="EN" style="color:#333333;mso-ansi-language:EN;">) </span></span></span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;background:#cedefd;"><span lang="EN" style="color:#333333;mso-ansi-language:EN;"><span style="font-family:Times New Roman;font-size:small;"></span></span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;background:#cedefd;"><span lang="EN" style="color:#333333;mso-ansi-language:EN;"><span style="font-size:small;"><span style="font-family:Times New Roman;">But, each time of Save() in folowing code, it creates a new record for the previous saved-records.</span></span></span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;background:#cedefd;"><span lang="EN" style="color:#333333;mso-ansi-language:EN;"><span style="font-size:small;"><span style="font-family:Times New Roman;">Anything I did wrong or I missed? (I did use CSLA extension&nbsp;for code&nbsp;generation)</span></span></span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;background:#cedefd;"><span lang="EN" style="color:#333333;mso-ansi-language:EN;"></span></p>
<p><span lang="EN" style="color:#333333;mso-ansi-language:EN;">
<p>
<p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="color:#000000;"></span></span></p>
</p>
<span style="font-family:Consolas;font-size:9.5pt;"><span style="color:#000000;">
<p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9.5pt;">buildingList = <span style="color:#2b91af;">BuildingList</span>.New();</span></p>
</span></span>
<p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="color:blue;">for</span><span style="color:#000000;"> (</span><span style="color:blue;">int</span><span style="color:#000000;"> i = 0; i &lt; 10; i++)</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="color:#000000;">{</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="color:#000000;">&nbsp;&nbsp;</span><span style="color:#2b91af;">Building</span><span style="color:#000000;"> building = buildingList.AddNew();&nbsp;&nbsp; </span><span style="color:green;">//Add a new Building.&nbsp; </span></span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="color:#000000;"></span></span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="color:#000000;">&nbsp;&nbsp;InitializeBuilding(building);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:green;">//Initialize the newly added Building.</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="color:#000000;"></span></span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="color:#000000;">&nbsp;&nbsp;buildingList.Save();&nbsp;&nbsp;</span><span style="color:green;">//</span></span><span style="font-family:Consolas;color:red;font-size:11pt;">Suppose only Save the newly added to DB. But NOT.</span><span style="font-family:Consolas;font-size:9.5pt;"><span style="color:#000000;">&nbsp;&nbsp;&nbsp;</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="color:#000000;">}</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="color:#000000;"></span></span></p>
</span></p>
<p><span lang="EN" style="font-family:&#39;Times New Roman&#39;,&#39;serif&#39;;color:#333333;font-size:12pt;mso-ansi-language:EN;mso-fareast-font-family:Calibri;mso-fareast-theme-font:minor-latin;mso-fareast-language:EN-US;mso-bidi-language:AR-SA;">
<p class="MsoNormal" style="margin:0in 0in 0pt;background:#cedefd;"><span lang="EN" style="color:#333333;mso-ansi-language:EN;">Thanks for any suggestions&hellip;</span></p>
</span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, July 03, 2012</h2><p>HI, </p>
<p>#1: Make sure to set the proper state of yuor child objects. Default is IsNew. You must call MarkOld (or use the DataPortal to call DataPortal_XYZ methods) to mark the object as Existing.</p>
<p>#2: Finally - your code in Insert/Update method must decide whether or not to save the item based on the state (IsSelfDirty, IsNew, IsDeleted). F.ex: maybe you need to recalculate something based on a parent property even if the child itself did not change.</p>
<p>What is the code inside InitializeBuiding method?</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
