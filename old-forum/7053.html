<html><header><title>To &lt;type&gt; or not to &lt;type&gt; (properties)?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>To &lt;type&gt; or not to &lt;type&gt; (properties)?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7053.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>esaulsberry posted on Friday, June 05, 2009</h2><P>I've noticed there are a number of ways to declare and initialize properties and I'm wondering about why to choose one over another.&nbsp; For example, you can declare the property info object for a string property Foo as</P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>static</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>PropertyInfo</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2>&gt; FooProperty = RegisterProperty(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>typeof</FONT></FONT><FONT size=2>(</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>MyBusOb</FONT></FONT><FONT size=2>), </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>PropertyInfo</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2>&gt;(</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"Foo"</FONT></FONT><FONT size=2>));<BR>or<BR></FONT><FONT size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>static</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>PropertyInfo</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2>&gt; FooProperty = RegisterProperty&lt;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2>&gt;(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>typeof</FONT></FONT><FONT size=2>(</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>MyBusOb</FONT></FONT><FONT size=2>), </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>PropertyInfo</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2>&gt;(</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"Foo"</FONT></FONT><FONT size=2>));<BR>or<BR></FONT></FONT><FONT size=2><FONT size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>static</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>PropertyInfo</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2>&gt; FooProperty = RegisterProperty&lt;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2>&gt;(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>PropertyInfo</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2>&gt;(</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"Foo"</FONT></FONT><FONT size=2>));</FONT></P>
<P><FONT size=2>Like wise the GetProperty method could be:</FONT></P><FONT size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>get</FONT></FONT><FONT size=2> { </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>return</FONT></FONT><FONT size=2> GetProperty(FooProperty); }<BR></FONT><FONT size=2>or<BR></FONT><FONT size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2>get</FONT></FONT><FONT size=2> { </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>return</FONT></FONT><FONT size=2> GetProperty&lt;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2>&gt;(FooProperty); }</FONT></P>
<P><FONT size=2>Any particular reason to choose one style over another?</P></FONT></FONT></FONT></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>sergeyb replied on Friday, June 05, 2009</h2>









 

 
  
 




<div class=Section1>

<p class=MsoNormal><span>Inside
a business object I use the simplest syntax:<o:p></o:p></span></p>

<p class=MsoNormal><span>public</span><span> <span>static</span> <span>PropertyInfo</span>&lt;<span>string</span>&gt;
FooProperty = RegisterProperty(<span>new</span> <span>PropertyInfo</span>&lt;<span>string</span>&gt;(<span>&quot;Foo&quot;</span>));</span><span><o:p></o:p></span></p>

<p class=MsoNormal><span>get</span><span> { <span>return</span>
GetProperty(FooProperty); }<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>If
you are using a non-generic class such as CommandBase, then you need to use
type of syntax<o:p></o:p></span></p>

<p class=MsoNormal><span>public</span><span> <span>static</span> <span>PropertyInfo</span>&lt;<span>string</span>&gt;
FooProperty = RegisterProperty(<span>typeof</span>(<span>MyBusOb</span>), <span>new</span> <span>PropertyInfo</span>&lt;<span>string</span>&gt;(<span>&quot;Foo&quot;</span>));</span><span><o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><b><span>Sergey Barskiy<o:p></o:p></span></b></p>

<p class=MsoNormal><b><i><span>Principal Consultant<o:p></o:p></span></i></b></p>

<p class=MsoNormal><span>office: 678.405.0687 |
mobile:&nbsp;404.388.1899</span><span><o:p></o:p></span></p>

<p class=MsoNormal><span><img width=119 height=26 id="Picture_x0020_1" alt="cid:_2_0648EA840648E85C001BBCB886257279"><br>
</span><b><span>Microsoft Worldwide Partner of the Year |</span></b><span> </span><b><span>Custom
Development Solutions, Technical Innovation</span></b><span><o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<div>

<p class=MsoNormal><b><span>From:</span></b><span> esaulsberry
[mailto:cslanet@lhotka.net] <br>
<b>Sent:</b> Friday, June 05, 2009 2:05 PM<br>
<b>To:</b> Sergey Barskiy<br>
<b>Subject:</b> [CSLA .NET] To &lt;type&gt; or not to &lt;type&gt;
(properties)?<o:p></o:p></span></p>

</div>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p>I've noticed there are a number of ways to declare and initialize properties
and I'm wondering about why to choose one over another.&nbsp; For example, you
can declare the property info object for a string property Foo as<o:p></o:p></p>

<p><span>public</span><span> <span>static</span> <span>PropertyInfo</span>&lt;<span>string</span>&gt;
FooProperty = RegisterProperty(<span>typeof</span>(<span>MyBusOb</span>), <span>new</span> <span>PropertyInfo</span>&lt;<span>string</span>&gt;(<span>&quot;Foo&quot;</span>));<br>
or<br>
<span>public</span> <span>static</span> <span>PropertyInfo</span>&lt;<span>string</span>&gt;
FooProperty = RegisterProperty&lt;<span>string</span>&gt;(<span>typeof</span>(<span>MyBusOb</span>), <span>new</span> <span>PropertyInfo</span>&lt;<span>string</span>&gt;(<span>&quot;Foo&quot;</span>));<br>
or<br>
<span>public</span> <span>static</span> <span>PropertyInfo</span>&lt;<span>string</span>&gt;
FooProperty = RegisterProperty&lt;<span>string</span>&gt;(<span>new</span> <span>PropertyInfo</span>&lt;<span>string</span>&gt;(<span>&quot;Foo&quot;</span>));<o:p></o:p></span></p>

<p><span>Like wise the GetProperty method could be:<o:p></o:p></span></p>

<p><span>get</span><span> { <span>return</span> GetProperty(FooProperty); }<br>
or<br>
<span>get</span> { <span>return</span>
GetProperty&lt;<span>string</span>&gt;(FooProperty); }<o:p></o:p></span></p>

<p><span>Any particular reason to choose one style
over another?<o:p></o:p></span></p>

<p class=MsoNormal><br>
<br>
<o:p></o:p></p>

</div>



</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius replied on Tuesday, June 09, 2009</h2><P>What was the purpose of Csla 3.6 RegisterProperty methods?&nbsp; At first I thought, "Cool, this will condense code."&nbsp; But after looking at it, I've actually had to write more code and learn a new technique just to implement these new methods.&nbsp; </P>
<P>So, I'm just curious, what was the reason behind this?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Tuesday, June 09, 2009</h2>It has a number of uses.<br />1. It does condense code. By 60% or so.<br />2. It eliminates bugs from new devs who forget to make the various calls in the Property Set.<br />3. It allows Managed Properties to exist for Child objects. This eliminates an entire class of bugs where devs mess up the edit levels, etc.<br />4. Managed properties allow you to use restricted environments (like Silverlight) with no code changes! Since reflection is not allowed in those sandboxes, managed propeties allowed Rocky to develop the IMobileObject interface and its serializer/deserializer.<br /><br />Joe<br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius replied on Wednesday, June 10, 2009</h2><P>Fantastic response.&nbsp; I suppose I'll learn to get used to it and accept it then.&nbsp; #4 is a great&nbsp;point that is definitely not immediately obvious.&nbsp; I was just overwhelmed at the added complexity to simply initialize a member variable!&nbsp; </P>
<P>one thing I was bothered with though, is that I usually put a lot of business logic in my getters and&nbsp;setters.&nbsp; Is it appropriate to just do things like this?</P>
<P><FONT size=2>public string&nbsp;SomeString<BR>&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;get { </FONT></P>
<BLOCKQUOTE dir=ltr>
<P><FONT size=2>string tmp = GetProperty(SomeStringProperty); </FONT></P>
<P><FONT size=2>if(tmp == "something") return tmp;</FONT></P>
<P><FONT size=2>else return string.Empty&nbsp;</FONT></P>
<P dir=ltr><FONT size=2>}</FONT></P></BLOCKQUOTE>
<P><FONT size=2>}</FONT><BR>Other suggestions/opinions most welcome.&nbsp; What are other people doing?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, June 10, 2009</h2><P>The idea with the CSLA property syntax is that you would not put any extra logic in the get/set blocks.</P>
<P>If you have business or validation rules around your property values, they should be implemented using the business rule subsystem in CSLA - override AddBusinessRules() and add your rule methods to your properties.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, June 10, 2009</h2>Rocky is right (as per usual.)<br />But what he is not stating here (and it is quite subtle) is that the CheckRules code does not always have to be used for validation! You can also attach it to a Property and use it as place to run custom logic (just always return True so the validation subsystem never knows you were really doing something else.)<br /><br />Joe</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tetranz replied on Wednesday, June 10, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>JoeFallon1:</strong></div><div>Rocky is right (as per usual.)
But what he is not stating here (and it is quite subtle) is that the CheckRules code does not always have to be used for validation! You can also attach it to a Property and use it as place to run custom logic (just always return True so the validation subsystem never knows you were really doing something else.)

Joe</div></BLOCKQUOTE><br><br>So are you saying that if I want an update of PropertyA to cause a change in PropertyB or do a calculation or whatever then doing it in a rule is a better place than overriding OnPropertyChanged?&nbsp; I'm not necessarily disagreeing but I just wonder why you wouldn't use PropertyChanged.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, June 10, 2009</h2><P>Rules run at times other than when the property changes. For example, rules often run when an object is created, sometimes before it is saved, etc.</P>
<P>In a web environment, you might consider disabling property notification (BypassPropertyChecks) when loading an object with postback data, then calling CheckRules() at the end. This can provide better performance characteristics in some cases.</P>
<P>And in such cases, relying on PropertyChanged to trigger business processing would be a problem, because that event may be suppressed, while CheckRules() does get called.</P>
<P>Also, I think it is more consistent and less obscure to implement all business/validation rules using the same technique, so I favor use of rule methods for this purpose.</P>
<P>I'm not saying OnPropertyChanged() is particularly bad, but there are some usage scenarios where it isn't ideal, and it doesn't provide overall consistency.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, June 10, 2009</h2><P>I should say too, that I understand the confusion.</P>
<P>If I had it to do over again, I'd name the ValidationRules property BusinessRules, so instead of ValidationRules.CheckRules() you'd call BusinessRules.ExecuteRules() or something like that.</P>
<P>But changing that member name would break everyone, and so isn't very realistic.</P>
<P>The unfortunate side-effect, though, is that there's a very natural assumption that ValidationRules is all about validation rules. When the <EM>reality</EM> is that it is about both business and validation rules...</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius replied on Thursday, June 11, 2009</h2><P>Whoa. Revelation.&nbsp; I've been writing CSLA stuff for about a year now and that just blew my mind lol.&nbsp; This will take some getting used to but it makes a lot of sense. It's almost like I just learned I've been putting my pants on backwards all these years...</P>
<P>Still some situations come up that I don't understand how you'd handle.&nbsp; SmartDates for example, a lot of times, I'll want a specific string for IsEmpty values.&nbsp; which amounts to a simple:</P>
<P>get{</P>
<P>if(_date.IsEmpty) return "This date is empty";</P>
<P>else return _date.Text;</P>
<P>}</P>
<P>How should this be done using AddBusinessRules()? </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>boo replied on Thursday, June 11, 2009</h2>I have similar scenario's that I was wondering about too...looking forward to recommendations there...<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, June 12, 2009</h2>I almost think that's something that the UI layer should handle.  The value of the property isn't "This date is empty" it's SmartDate.IsEmpty. </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius replied on Friday, June 12, 2009</h2><P>Yes, on a architectual level, I would agree.&nbsp; But on a practical level, when we databind to most of the controls we use, the control accesses these public properties of the business objects.&nbsp; </P>
<P>Sure, a lot of situations like these can be handled by databindng&nbsp;format options on the controls, but in cases like this, where you return an empty value, there's no way to tell the binding to display a specific text for empty values (though sometimes there is for NULL values, but not empty strings from what I've encountered).&nbsp; </P>
<P>Easy solution, just modify the get accessor.&nbsp; But now I'm told that's unconventional.&nbsp; What to do? </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>boo replied on Friday, June 12, 2009</h2>And I'd agree with you; if you use this object on multiple forms you don't want to create the same GUI code in multiple places.&nbsp;&nbsp; And what if the business object is part of report as in my case?&nbsp;&nbsp; Well now I got to get our report generator to start throwing additional logic into it which isn't always easy; modifying the getter is the pragmatic approach we've used in the past and now again, we're in the situation you are.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
