<html><header><title>Gridview sorting w/CSLADataSource</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Gridview sorting w/CSLADataSource</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/318.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>tfsmag posted on Thursday, June 08, 2006</h2>Here is my select event for my CSLADataSource<br><br>&nbsp;&nbsp;&nbsp; Protected Sub dsGVResults_SelectObject(ByVal sender As Object, ByVal e As CCMSI.Framework.Web.SelectObjectArgs) Handles dsGVResults.SelectObject<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If ddlMemberResults.SelectedValue &lt;&gt; "" Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim GetValues() As String = ddlMemberResults.SelectedValue.Split(",")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim location As String = GetValues(0)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim member_number As String = GetValues(1)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim TestID As Integer = Convert.ToInt32(GetValues(2))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim assoc As String = GetValues(3)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim Results As LossControl_ListTestResults = LossControl_ListTestResults.Fetch(TestID, assoc, member_number, location)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.BusinessObject = Results<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>My Gridview is named gvResults, I can bind the gridview and display the data fine. My problem comes when I have sorting enabled, and I click the headers on top of the gridview, nothing happens. I know how to sort from a SQLDataSource but can't seem to figure it out with the CSLADataSource. I should probably add that I'm not an architect and I inherited this framework from previous developers. I'm sure I'll have to use the gvResults_Sorting() event somehow, but haven't been able to do it thus far.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>glenntoy replied on Thursday, June 08, 2006</h2><P>Please refer to this thread <A HREF="/forums/thread/538.aspx">http://forums.lhotka.net/forums/thread/538.aspx</A></P>
<P>Set the GridView.AllowSorting = True</P>
<P>In the CSLADatasource_SelectObject, use GridView.SortExpression and GridView.SortDirection to retrieved the column to sort.</P>
<P>Cheers,</P>
<P>Glenn</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
