<html><header><title>CSLA 4.0 with CSLA 3.8</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA 4.0 with CSLA 3.8</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9893.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>sg11 posted on Monday, December 20, 2010</h2><p>I was wondering if any one has experience using CSLA 4 with CSLA 3.8. The issue we have can be summarized as follows:</p>
<p>1) Library 1, is built using CSLA 3.8, and is responsible for authentication, etc.</p>
<p>2) The main application using Library 1 has been upgraded to CSLA 4. It may be a while before Library 1 is updated to CSLA 4.</p>
<p>The issue we face is with the ApplicationContext. COEPrincipal (BusinessPrincipalBase)&nbsp;in the code&nbsp;below is part of Library 1 (csla 3.8). So we have a mismatch, and was wondering what you would recommend for an interim&nbsp;workaround.</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (COEPrincipal.Login(criteria.Username, criteria.Password))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.IsAuthenticated = true;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; COEPrincipal coep = (COEPrincipal)Csla.ApplicationContext.User;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; COEIdentity coeid = (COEIdentity)coep.Identity;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Csla.ApplicationContext.GlobalContext[&quot;Ticket&quot;] = coeid.IdentityToken;</p>
<p>Thanks.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Monday, December 20, 2010</h2><p>I&#39;d be really surprised if you could get this to work properly. Csla 4 is compiled for .NET 4 and Csla 3.8 compiles for .NET 3.5 and you would run into InvalidCastException and MissingMethodExceptions being thrown. </p>
<p>This article may provide a better description of the problem: <a href="http://msdn.microsoft.com/en-us/library/dd153782.aspx">Best practices for Assembly Loading</a></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, December 20, 2010</h2><p>This might be possible if you can get 3.8 compiled (and working) for .NET 4.</p>
<p>In that case, you could rename the Csla base namespace in 3.8 to Csla38 or something, and thereby avoid ambiguous type issues.</p>
<p>Then you&#39;d change your existing code to use Csla38.???, thus switching all existing code to work with the existing framework.</p>
<p>As you move code to CSLA 4, you&#39;d write that code to use Csla.???, thus using CSLA 4.</p>
<p>People did this when moving from CSLA .NET 1.x to 2.1 and it was quite effective.</p>
<p>However, I know there are some parts of 3.8 that don&#39;t work in .NET 4, at the UI level in XAML anyway. But if all you are trying to do is get business object code working, this might be a technique you can try.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>sg11 replied on Monday, December 20, 2010</h2><p>Thanks, I&#39;ll give it a shot.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>sg11 replied on Tuesday, December 21, 2010</h2><p>I forgot to mention one more issue. Library 1 above still targets .NET 3.5, so&nbsp;targeting CSLA 3.8 to .NET 4 may be a non-starter. Library 1 is maintained by a different team, and I am trying to get them to upgrade sooner than later.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, December 21, 2010</h2><p>Well that&#39;s the core issue, not CSLA but .NET.</p>
<p>You can&#39;t run more than one version of .NET in an AppDomain, so one application can&#39;t use more than one version of .NET.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
