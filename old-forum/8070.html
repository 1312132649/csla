<html><header><title>MVC Contribute Branch For MVC 2 Beta</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>MVC Contribute Branch For MVC 2 Beta</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8070.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>xAvailx posted on Tuesday, December 01, 2009</h2>Hi,<br /><br />Any plans on maybe creating a branch for MVC 2 Beta for the MVC Contribute project? I am converting some of the code at the moment, but running into ModelBinding problems. I can't get this test to pass:<br /><br />BindCallsCorrectMethodOnFactoryMethodWithArgument<br /><br />The problem i have with binding is when using a ViewModel class. If I use BO directly it works fine.<br /><br />Edit:<br /><br />The unit test error I receive is:<br /><br />Error	1	TestCase 'CslaContrib.Mvc.Test.CslaBindModelBinderTest.BindCallsCorrectMethodOnFactoryMethodWithArgument'<br />failed: System.ArgumentNullException: Value cannot be null.<br />Parameter name: context<br />   at System.Web.Mvc.AssociatedValidatorProvider.GetValidators(ModelMetadata metadata, ControllerContext context)<br />   at System.Web.Mvc.ModelValidatorProviderCollection.<>c__DisplayClass1.b__0(ModelValidatorProvider provider)<br />   at System.Linq.Enumerable.d__14`2.MoveNext()<br />   at System.Web.Mvc.DefaultModelBinder.OnPropertyValidated(ControllerContext controllerContext, ModelBindingContext bindingContext, PropertyDescriptor propertyDescriptor, Object value)<br />   at System.Web.Mvc.DefaultModelBinder.BindProperty(ControllerContext controllerContext, ModelBindingContext bindingContext, PropertyDescriptor propertyDescriptor)<br />   at CslaContrib.Mvc.DefaultCslaModelBinder.BindProperties(ControllerContext controllerContext, ModelBindingContext bindingContext) in D:\Projects\CslaContrib.Mvc\CslaContrib.Mvc\DefaultCslaModelBinder.cs:line 67<br />   at CslaContrib.Mvc.DefaultCslaModelBinder.BindCslaModel(ControllerContext controllerContext, ModelBindingContext bindingContext) in D:\Projects\CslaContrib.Mvc\CslaContrib.Mvc\DefaultCslaModelBinder.cs:line 58<br />   at CslaContrib.Mvc.CslaBindModelBinder.BindCslaModel(ControllerContext controllerContext, ModelBindingContext bindingContext) in D:\Projects\CslaContrib.Mvc\CslaContrib.Mvc\CslaBindModelBinder.cs:line 27<br />   at CslaContrib.Mvc.DefaultCslaModelBinder.BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext) in D:\Projects\CslaContrib.Mvc\CslaContrib.Mvc\DefaultCslaModelBinder.cs:line 24<br />   at CslaContrib.Mvc.Test.CslaBindModelBinderTest.BindCallsCorrectMethodOnFactoryMethodWithArgument() in D:\Projects\CslaContrib.Mvc\CslaContrib.Mvc.Test\CslaBindModelBinderTest.cs:line 71	D:\Projects\CslaContrib.Mvc\CslaContrib.Mvc\DefaultCslaModelBinder.cs	67	<br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rasupit replied on Wednesday, December 02, 2009</h2>I don't think the model binder in contrib site will work with MVC 2, the make changes to model binder to support data annotation.<br><br>I'm planning to wait a little longer until MVC 2 make several releases before making any upgrade to the mvc contrib project.&nbsp; From experience with MVC 1, they still make a lot of internal implementation changes up to RC release.<br><br>Ricky<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xAvailx replied on Wednesday, December 02, 2009</h2>Thanks Ricky.<br /><br />I had to make some changes to the source because of breaking changes. But I've gotten all the other tests to work, just the one I mentioned above is failing. I will branch out and then can send you a patch if you want. Most of the changes are due to ModelType, and Model properties are now deprecated because of ModelMetaData. </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rasupit replied on Wednesday, December 02, 2009</h2>Yes, please do.<br><br>I took a cursory look at it and saw the change to ModelMetaData.&nbsp; Although I'm not sure if that will hold, they may change again later to ModelDescriptor or something and wrap the metadata info in there ;)<br><br>There is also the double validation error in modelstate that Rocky have found when you're csla bo uses data annotation attribute.<br><br>Ricky<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, December 03, 2009</h2>I hope that a future version of the contrib work would take advantage of the CslaModelBinder in Csla.Web.Mvc. In other words, I'd rather have people use the "official" binder in CSLA .NET and tell me if it is insufficient (so I can fix it) than create their own for their projects.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rasupit replied on Thursday, December 03, 2009</h2>Rocky, The initial contrib work was created as experimental only.&nbsp; That time, I was not aware about your plan on adding anything to support asp.net mvc.&nbsp; <br><br>I do hope you would add the functionality implemented in the contrib project which were showcased on the <a href="http://cslacontrib.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=32351">project tracker sample</a> <br><br>I have described some of the issues when binding csla object using the default binder <a HREF="/forums/permalink/38639/38661/ShowThread.aspx#38661">here</a>.&nbsp; There is also an issue on having csla object in an action method argument.&nbsp; This is due to the way csla object being instantiate through factory method.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, December 03, 2009</h2>






 





<div class=Section1>

<p class=MsoNormal><span>For 4.0 I do plan to expand the basic CslaModelBinder from 3.8
to address the object creation issue &#8211; I have a plan for that. I wasn&#8217;t aware
of the collection issue, so I&#8217;ll have to look into that more closely.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>Do you want to help with the 4.0 implementation? I believe you
already have a signed contributor agreement on file.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span>And I&#8217;ve also created a Controller base class in 4.0 that
provides some protected methods that make it a little easier to work with CSLA
model objects in a stateless model. Specifically I noticed that insert/update
operations require the same 6-8 lines of code every time (to get exception
handling, etc), so I encapsulated that behavior in the base class.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

</div>



</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rasupit replied on Thursday, December 03, 2009</h2>I would love to help out with 4.0, let me know how the detail. I believe you have my email.&nbsp; I haven't get a chance to play around with VS2010 though;&nbsp; Still struggle with upgrading my laptop to win7, since I have to clean install it.&nbsp; <br><br>Yes, I have signed contributor agreement when helping out to improve performance on reflection calls.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xAvailx replied on Friday, December 04, 2009</h2><BLOCKQUOTE><div><br /><br />And Iâ€™ve also created a Controller base class in 4.0 that provides some protected methods that make it a little easier to work with CSLA model objects in a stateless model. Specifically I noticed that insert/update operations require the same 6-8 lines of code every time (to get exception handling, etc), so I encapsulated that behavior in the base class.<br /><br /></div></BLOCKQUOTE><br /><br />Is that in SVN somewhere where I can take a peek?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, December 04, 2009</h2>Yes, the /core/trunk folder is 4.0 - very unstable (might not even build right now), but my first run at a Controller base class is in svn.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
