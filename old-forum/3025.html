<html><header><title>Combobox Column with different Lists</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Combobox Column with different Lists</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3025.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>josh.kodroff posted on Tuesday, June 12, 2007</h2>I have a list of objects I want to display in a DataGridView.&nbsp; Each list has a field called ComponentType (read-only, not displayed) and another called InitialStatus.&nbsp; The possible values for InitialStatus, held in a property called InitialStatusList depends on ComponentType.<br><br>Here's some examples to illustrate:<br>If ComponentType = 1, then the possible values are:<br>A<br>B<br>C<br><br>If ComponentType = 2, then the possible values are:<br>B<br>C<br>D<br><br>I'm going to list Components of various types in the same datagrid.&nbsp; How do I set the datasource for the combobox column where I set InitialStatus?&nbsp; Do I have to write code to handle the OnSelectionChanged event?<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dcleven replied on Tuesday, June 12, 2007</h2><P><FONT face=Arial>Hi,</FONT></P>
<P><FONT face=Arial>This is what I have found to work. </FONT></P>
<P><FONT face=Arial>Since the DataGridView column bindings affect all the rows, and all rows must have a valid lookup for the combobox that you are binding, you must initially have a bindingsource that is valid for all combinations. In other words in your form load event set the combobox.DataSource to a list that contains all possible InitalStatus values.</FONT></P>
<P><FONT face=Arial>Then on the combobox BeginEdit event you must set the DataSource for the Cell to a filtered view that contains only those values that match your ComponentType. Like this:</FONT></P>
<P><FONT face="Courier New">DataGridViewComboBoxCell dgcb = (DataGridViewComboBoxCell)myDataGridView.CurrentRow.Cells[this.InitialStatusColumn.Index];</FONT></P>
<P><FONT face="Courier New">dgcb.DataSource = filteredInitalStatus;</FONT></P>
<P><FONT face=Arial>--Doug</FONT></P>
<P><FONT face=Arial></FONT>&nbsp;</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
