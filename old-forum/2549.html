<html><header><title>Design Question</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Design Question</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2549.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>mr_lasseter posted on Monday, March 19, 2007</h2><P>I want to get some opinions on the best way to do things.&nbsp; I have circuit which is an (BusinessBase).&nbsp; It contains a list (BusinessListBase) of drop locations&nbsp;(BusinessBase).&nbsp; Depending on some of the&nbsp;values of the circuit,&nbsp;the validation rules for the&nbsp;drops&nbsp;can be different.&nbsp; Some configurations&nbsp;only allow&nbsp;1 drop&nbsp;and some allow 2 while other configurations can allow&nbsp;up to 10.&nbsp;&nbsp;Depending on these configurations some of the&nbsp;drops are required to be populated.&nbsp; My question is what is the best way to go about getting the number of drops allowed from the circuit?</P>
<P>&nbsp;</P>
<P>Thanks is advance.&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, March 19, 2007</h2><P>It somewhat depends on the user experience you are after.</P>
<P>You could allow the addition of n drops, and have CircuitEdit (your root) become invalid if there are too many.</P>
<P>Or you could disallow the addition of n+1 drops in DropLocations by throwing an exception when the max is exceeded - though that could get messy depending on your UI style.</P>
<P>Or you could add the n+1 item and have that item never become valid. But it is hard to see how you could do that without frustrating the user.</P>
<P>I'd think you'd want to go with the first option, plus have a way for the UI to know the max value so it could give the user visual cues that they can't add another.</P>
<P>So in CircuitEdit you could expose a read-only property: MaxDrops. This could be used by both CircuitEdit and the UI to know the max possible.</P>
<P>Then in CircuitEdit you'd have a read-only property: CurrentDrops. This property would have a validation rule associated with it to ensure it didn't exceed the value of MaxDrops. </P>
<P>You'd handle the ListChanged event from DropLocations and call CheckRules("CurrentDrops") when the collection is changed.</P>
<P>If you don't want to show CurrentDrops, you can put a Label control with size 0,0 on your form, and the ErrorProvider will still show the "!" icon at that location - giving you a way to easily show the user the nature of the issue.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
