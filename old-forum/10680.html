<html><header><title>Best Way to Update Multiple Root Business Obejcts under one transaction?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Best Way to Update Multiple Root Business Obejcts under one transaction?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10680.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>GPhillips posted on Tuesday, September 13, 2011</h2><p>I have a need to update (Save/Add/Delete) multiple business objects for a particular process.&nbsp; I would like all the database access to occur under a single transaction so that the if any part of it blows up the transaction will not be committed.&nbsp; I am using the ConnectionManager for my DB access.</p>
<p>My first thought was to do a DataPortal_Execute with a TransactionScope attribute and then do all the BusinessObject activity in that Execute procedure.&nbsp; That way whether it runs locally or on the server the Execute would wrap everything else.&nbsp; I&#39;m worried that it requires a lot of parameters and business objects to be passed into and out of the Execute and will have to pass the saved objects back to the client via the Criteria.</p>
<p>Is there a preferred way to do this?</p>
<p>For example, I am writing an AR application that has an CustomerAccount BusinessBase object.&nbsp; If data is changed in that object (sometimes) it needs to update the ledger which requires the creation of a batch (a BusinessBase object), addition of batch transactions (Child BusinessBase objects) and posting the batch (a CommandObject execute).&nbsp; If any part of this sequence fails, then whole sequence should be rolled back.&nbsp; I need the saves CustomerAccount object and the posted/saved batch back</p>
<p>Thoughts are greatly appreciated.</p>
<p>Gary</p>
<p>PS I am using CLSA 3.8 in a Windows Forms application, no LINQ.&nbsp; DB is SQL Server</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Wednesday, September 14, 2011</h2><p>Use a unit of work object as discussed in the FAQ (<a href="http://www.lhotka.net/cslanet/faq/CslaObjectFaq.ashx">http://www.lhotka.net/cslanet/faq/CslaObjectFaq.ashx</a>) and in the <em>Using CSLA 4</em> ebook series.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
