<html><header><title>CommonRules useless messages</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CommonRules useless messages</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2428.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>chrisb posted on Monday, February 26, 2007</h2><P>Surely you all have come across this:&nbsp; I have a property called LastName this is required.&nbsp; I do this:</P>
<P>ValidationRules.AddRule(CommonRules.StringRequired, "LastName");</P>
<P>The problem is user.BrokenRulesCollection[0].Description returns "LastName required".&nbsp; I can't display that to the user.&nbsp; I want to show "Last Name is required."</P>
<P>So, is CommonRules.StringRequired useless to me?&nbsp; Do I have to write a whole new custom validator just to display my custom message?</P>
<P>I can't believe anybody would really want to display "LastName required" to a user.</P>
<P>Chris</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, February 26, 2007</h2>You'll have to write your own rule handler that returns the description you want.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Monday, February 26, 2007</h2><P>This topic has been discussed before. Do a search. Rocky may modify CSLA in the future to accomodate this scenario.</P>
<P>In the meantime I wrote code like this in my BO layer:</P><FONT color=#0000ff size=2>
<P>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> MyRuleArgs<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Inherits</FONT><FONT size=2> RuleArgs</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Private</FONT><FONT size=2> mPropertyDescr </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</P></FONT><FONT size=2>
<P></P>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>ReadOnly</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</FONT><FONT size=2> PropertyDescr() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String<BR>&nbsp; &nbsp; </FONT><FONT color=#0000ff size=2>Get<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> mPropertyDescr<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Get<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> propertyName </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>Optional</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> propertyDescr </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#ff00ff size=2>""</FONT><FONT size=2>)<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>MyBase</FONT><FONT size=2>.New(propertyName)<BR>&nbsp;&nbsp;&nbsp; mPropertyDescr = propertyDescr<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> propertyName </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> severity </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> RuleSeverity, </FONT><FONT color=#0000ff size=2>Optional</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> propertyDescr </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#ff00ff size=2>""</FONT><FONT size=2>)<BR>&nbsp; &nbsp; </FONT><FONT color=#0000ff size=2>MyBase</FONT><FONT size=2>.New(propertyName)<BR>&nbsp;&nbsp;&nbsp; mPropertyDescr = propertyDescr<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.Severity = severity<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> propertyName </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> severity </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> RuleSeverity, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> stopProcessing </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>Optional</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> propertyDescr </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#ff00ff size=2>""</FONT><FONT size=2>)<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>MyBase</FONT><FONT size=2>.New(propertyName)<BR>&nbsp;&nbsp;&nbsp; mPropertyDescr = propertyDescr<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.Severity = severity<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.StopProcessing = stopProcessing<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</P></FONT>
<P>This allows me to use more constructors and to also pass in a value like "First Name" as the property description.</P>
<P>I actually have more code where I load a list of all field names and pull the corresponding description from the list so I do not have to code "First Name" at all in my BOs. But if I wanted to use a special value then whatever I pass in takes precedence over my list. e.g. "My Special First Name"</P>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, February 26, 2007</h2><P>I'll almost certainly add a friendly name property to RuleArgs in the next version of the framework, yes. And that'll impact CommonRules of course, but also will make it easier to standardize on the same approach for custom rules.</P>
<P>I'm also strongly considering creating a DecoratedRuleArgs that uses the decorator pattern to minimize the need to create custom RuleArgs subclasses. Rather than having to create a custom object for each rule method, you'd be able to use DecoratedRuleArgs and just pass arbitrary name/value pairs into the rule.</P>
<P>The downside, of course, is loss of compile-time checking and type safety. But the upside is a much simpler and more standardized way of passing in arguments to rule methods. </P>
<P>In particular, this technique would simplify code generation rather a lot. Right now a would-be code generator has to somehow determine the type of args object required, and the properties that need to be set on that object. Quite challenging really, especially if you are creating a designer or anything for it. That's made simpler if arbitrary name/value pairs can be passed into the rule.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jimbo replied on Saturday, March 03, 2007</h2>Another aspect that deters the use of CommonRules is that it does not
appear to provide for specifying the use of&nbsp; a Resource message
string.&nbsp; It seems to use hard coded literal message strings.&nbsp;
fxCop wont pick this oversiight up. <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Saturday, March 03, 2007</h2>Which rule? They should all be using resource strings.<br /><br />Rocky  <br /><br />-----Original Message-----<br />From: "Jimbo" <br />To: "rocky@lhotka.net" <br />Sent: 3/3/2007 6:38 PM<br />Subject: Re: [CSLA .NET] CommonRules useless messages<br /><br />Another aspect that deters the use of CommonRules is that it does not appear to provide for specifying the use of  a Resource message string.  It seems to use hard coded literal message strings.  fxCop wont pick this oversiight up. <br /><br /><br /></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
