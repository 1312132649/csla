<html><header><title>EditableChildList - Template for Update problem</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>EditableChildList - Template for Update problem</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3881.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Blarm posted on Sunday, November 11, 2007</h2><P>In my child object I have a DLLine property which is a line number that needs to be unique. In the database there is a UNIQUE index on the parent reference and DLLine.</P>
<P>During editing (including adding new lines, updating existing and deleting lines) and also re-numbering the lines I make sure that the DLLine is unique.</P>
<P>The Update template code includes:<BR>For Each item As EditableChild In Me<BR>&nbsp; If item.IsNew Then<BR>&nbsp;&nbsp;&nbsp; item.Insert(parent)<BR>&nbsp; Else<BR>&nbsp;&nbsp;&nbsp; item.Update(parent)<BR>&nbsp; End If<BR>Next</P>
<P>The problem is that Inserts and Updates are intermixed so that a line can be Inserted with a DLLine number that is currently in the database because that line had not yet been updated to its new DLLine number.</P>
<P>I think the Updates should all be done first, then the Inserts (i.e. 2 seperate loops), so the template code should be:<BR>For Each item As EditableChild In Me<BR>&nbsp; If Not item.IsNew Then<BR>&nbsp;&nbsp;&nbsp; item.Update(parent)<BR>&nbsp; End If<BR>Next</P>
<P>For Each item As EditableChild In Me<BR>&nbsp; If item.IsNew Then<BR>&nbsp;&nbsp;&nbsp; item.Insert(parent)<BR>&nbsp; End If<BR>Next</P>
<P>Bill</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, November 12, 2007</h2>Sounds fine to me.&nbsp; Do you have a concern over doing things that way?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Blarm replied on Tuesday, November 13, 2007</h2><P>I&nbsp;was just worried that there might have been a specific reason for the way the code was, although I couldn't think of one. </P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
