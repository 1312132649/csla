<html><header><title>System.Net.Mail, create a new object just for mailling? Encapsulation question</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>System.Net.Mail, create a new object just for mailling? Encapsulation question</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5284.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ltgrady posted on Thursday, August 21, 2008</h2><P>I have an alert system in my application where we save users messages to one another in our SQL database.&nbsp; Now our users would like us to start emailing notifications for those messages.&nbsp; </P>
<P>I have a Message object and MessageRecipient objects and a collection to hold them. These are CSLA objects that I use to create a new message, set subject, body, and other properties and then add recipients to the MessageRecipients child collection.&nbsp; All of our data is stored in sql database and then we have other methods that show these messages on our users Alert pages.</P>
<P>So now I need to have some kind of .SendEmailNotifications method that is going to use the System.Net.Mail to take these properties and recipients and send the emails.&nbsp; I'm trying to decide where to put this.&nbsp; Whether I should add a static method to the Message class, Message.SendEmailNotifications that checks the recipients properties to see if they recieve email alerts or not and then sends the emails.&nbsp; Or, should I create some kind of Mailer object that has properties Subject, Body, etc. and then has .AddEmailRecipient(userID) method to add email reciepients, then finally a .SendEmail method to send it all.</P>
<P>So should I keep it in my existing Message object or create a seperate Mailer object?&nbsp; What do you think?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>richardb replied on Friday, August 22, 2008</h2><P>I've previously created a seperate class library for this sort of thing so it can be re-used across many projects.</P>
<P>So I have my wrapper class around the System.Net.Mail and then&nbsp;versions of SendMessage methods that can take a simple string, or message object, etc.&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ltgrady replied on Monday, August 25, 2008</h2>That's where I was going but as I began writing the wrapper it just seemed like I was writing the same class but just renaming the methods.&nbsp; All it really did was store a few things like my smtp credentials.&nbsp; I suppose that may be enough to justify a new class, not having to deal with that.&nbsp; I'm still not sure.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>richardb replied on Tuesday, August 26, 2008</h2>That's true, but you never know how Microsoft might change things in the future and wrapping the functionality in your own class might help reduce the upgrade effort later.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
