<html><header><title>Intermediate base classes in VB</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Intermediate base classes in VB</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7718.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>nhwilly posted on Thursday, October 01, 2009</h2>I read in the forums about putting an intermediate layer in the inheritance hierarchy so that changes in CSLA don't break my code.  So I am going back to working code and trying to introduce this concept.  I see the CSLA is moving ahead nicely and I want to keep up.<br /><br />JoeF says to look on the forums for posts about this, but I can't find any VB examples.<br /><br />Can anyone tell me what the syntax is for an intermediate subclass of :<br /><br />BusinessListBase(of T, C)<br /><br />This is making me nuts.  Correction, more nuts.<br /><br />Thanks in advance.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, October 01, 2009</h2><P>I think it is like this:</P>
<P>Public MustInherit Class MyBusinessBase(Of T As MyBusinessBase(Of T))<BR>&nbsp; Inherits BusinessBase(Of T)</P>
<P>The trick is to remember to put the constraints on the generic type(s).</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>nhwilly replied on Thursday, October 01, 2009</h2>Thanks, Rocky.<br /><br />Am I to understand that there must be a unique intermediate class for each of my subclasses?<br /><br />Like this?<br /><br />Public MustInherit Class MerchantProfileBase(Of T As MerchantProfileBase(Of T))<br />    Inherits BusinessBase(Of T)<br />End Class<br /><br />Public Class MerchantProfile<br />    Inherits MerchantProfileBase(Of MerchantProfile)<br />End Class<br /><br />Public MustInherit Class MerchantProfileListBase(Of T As MerchantProfileListBase(Of T, C), C As MerchantProfileBase(Of C))<br />    Inherits BusinessListBase(Of MerchantProfileListBase(Of T, C), MerchantProfileBase(Of C))<br />End Class<br /><br />Public Class MerchantProfileList<br />    Inherits MerchantProfileListBase(Of MerchantProfileList, MerchantProfile)<br />End Class<br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, October 01, 2009</h2><FONT size=2>
<P>These are what my intermediate base classes look like: (minus my common code)</P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>-------------------------------------------------------------------------------------------------------------------------------------</FONT></FONT></P>
<P>&lt;Serializable()&gt; _<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>MustInherit</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</FONT></FONT><FONT size=2> MyBusinessBase(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> T </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> MyBusinessBase(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> T))<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; Inherits</FONT></FONT><FONT size=2> BusinessBase(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> T)<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</FONT></FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>-------------------------------------------------------------------------------------------------------------------------------------</FONT></FONT></P><FONT size=2>
<P>&lt;Serializable()&gt; _<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>MustInherit</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</FONT></FONT><FONT size=2> MyBusinessListBase(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> T </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> MyBusinessListBase(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> T, C), C </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> MyBusinessBase(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> C))<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; Inherits</FONT></FONT><FONT size=2> BusinessListBase(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> T, C)<BR></FONT><FONT color=#0000ff size=2>End<FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</FONT></FONT></FONT></P>
<P><FONT color=#0000ff size=2>-------------------------------------------------------------------------------------------------------------------------------------</FONT></P><FONT color=#0000ff size=2><FONT size=2>
<P></FONT>
<P><FONT size=2></P></FONT></FONT><FONT color=#0000ff size=2></FONT>
<P></P><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT size=2>
<P><FONT color=#000000>&lt;Serializable()&gt; _<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>MustInherit</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</FONT></FONT><FONT size=2> <FONT color=#000000>MyReadOnlyBase</FONT>(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> <FONT color=#000000>T</FONT> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> <FONT color=#000000>MyReadOnlyBase</FONT><FONT color=#000000>(</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> <FONT color=#000000>T</FONT><FONT color=#000000>))</FONT><BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; Inherits</FONT></FONT><FONT size=2> <FONT color=#000000>ReadOnlyBase</FONT><FONT color=#000000>(</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> <FONT color=#000000>T</FONT><FONT color=#000000>)</FONT><BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</FONT></FONT></P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P><FONT color=#0000ff size=2>-------------------------------------------------------------------------------------------------------------------------------------</FONT></P><FONT size=2>
<P><FONT color=#000000>&lt;Serializable()&gt; _<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>MustInherit</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</FONT></FONT><FONT size=2> <FONT color=#000000>MyReadOnlyListBase</FONT>(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> <FONT color=#000000>T</FONT> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> <FONT color=#000000>MyReadOnlyListBase</FONT><FONT color=#000000>(</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> <FONT color=#000000>T, C), C</FONT> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> <FONT color=#000000>Core.IReadOnlyObject</FONT><FONT color=#000000>)</FONT><BR>&nbsp; </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Inherits</FONT></FONT><FONT size=2> <FONT color=#000000>ReadOnlyListBase</FONT><FONT color=#000000>(</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> <FONT color=#000000>T, C)</FONT><BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End<FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2></P>
<P><FONT color=#0000ff size=2>-------------------------------------------------------------------------------------------------------------------------------------</FONT></P><FONT size=2>
<P><FONT color=#000000>&lt;Serializable()&gt; _</FONT><BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>MustInherit</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</FONT></FONT><FONT size=2> <FONT color=#000000>MyNameValueListBase</FONT><FONT color=#000000>(</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> <FONT color=#000000>K, V)</FONT><BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; Inherits</FONT></FONT><FONT size=2> <FONT color=#000000>NameValueListBase</FONT><FONT color=#000000>(</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> <FONT color=#000000>K, V)</FONT><BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</P></FONT></FONT>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>-------------------------------------------------------------------------------------------------------------------------------------</FONT></FONT></P><FONT color=#000000><FONT size=2>
<P>&lt;Serializable()&gt; _<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>MustInherit</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</FONT></FONT><FONT size=2> MyCommandBase<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; Inherits</FONT></FONT><FONT size=2> Csla.CommandBase<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</FONT></FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>-------------------------------------------------------------------------------------------------------------------------------------</FONT></FONT></P>
<P></FONT></FONT></FONT></FONT></FONT></FONT></FONT></FONT></FONT><FONT size=2>&lt;Serializable()&gt; _<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>MustInherit</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</FONT></FONT><FONT size=2> MyEditableRootListBase(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> T </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> {IEditableBusinessObject, ISavable})<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; Inherits</FONT></FONT><FONT size=2> Csla.EditableRootListBase(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> T)<BR><BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; Protected</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>New</FONT></FONT><FONT size=2>()<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; Me</FONT></FONT><FONT size=2>.AllowEdit = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>True<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; &nbsp; Me</FONT></FONT><FONT size=2>.AllowNew = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>True<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; Me</FONT></FONT><FONT size=2>.AllowRemove = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>True<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub<BR><BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</FONT></FONT></P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>-------------------------------------------------------------------------------------------------------------------------------------</FONT></FONT></P>
<P><FONT color=#000000>HTH<BR></FONT><FONT color=#000000>Joe</FONT></P>
<P>&nbsp;</P>
<P>&nbsp;</P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cmclernon replied on Tuesday, October 13, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>JoeFallon1:</strong></div><div><FONT size=2><br /><P>These are what my intermediate base classes look like: (minus my common code)</P><br /><P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>-------------------------------------------------------------------------------------------------------------------------------------</FONT></FONT></P><br /><FONT size=2><br /><P> _<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>MustInherit</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</FONT></FONT><FONT size=2> MyBusinessListBase(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> T </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> MyBusinessListBase(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> T, C), C </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> MyBusinessBase(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> C))<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&#160; Inherits</FONT></FONT><FONT size=2> BusinessListBase(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Of</FONT></FONT><FONT size=2> T, C)<BR></FONT><FONT color=#0000ff size=2>End<FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Class</FONT></FONT></FONT></P><br /><P><FONT color=#0000ff size=2>-------------------------------------------------------------------------------------------------------------------------------------</FONT></P><FONT color=#0000ff size=2><FONT size=2><br /><P></FONT><br /><P><FONT size=2></P></FONT></FONT><br /><P><FONT color=#000000>HTH<BR></FONT><FONT color=#000000>Joe</FONT></P><br /><P>&#160;</P><br /><P>&#160;</P></FONT></FONT></div></BLOCKQUOTE><br /><br />Hi Joe,<br />I have something like this too from your previous examples but I cannot seem to add in the IBusinessCollection interface for the broken rules.  Can you post up the syntax you used for this?  I have the following:<br /><br />[Serializable()]<br />    public abstract class MyBusinessListBase : BusinessListBase <br />        where T : MyBusinessListBase <br />        where C : MyBusinessBase,<br />        IBusinessCollection<br />    {}<br /><br />but in the "IBusinessCollection.Item(int index, bool useInterface)" implementation there is no base.Item definition...the full compiler error is:<br /><br />'Csla.BusinessListBase' does not contain a definition for 'Item'<br /><br />Hope this makes sense - any help would be greatly appreciated.<br /><br />Colm</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Tuesday, October 13, 2009</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>cmclernon:</strong></div><div><FONT size=2><BR></FONT>Hi Joe, I have something like this too from your previous examples but I cannot seem to add in the IBusinessCollection interface for the broken rules. Can you post up the syntax you used for this? I have the following: [Serializable()] public abstract class MyBusinessListBase : BusinessListBase where T : MyBusinessListBase where C : MyBusinessBase, IBusinessCollection {} but in the "IBusinessCollection.Item(int index, bool useInterface)" implementation there is no base.Item definition...the full compiler error is: 'Csla.BusinessListBase' does not contain a definition for 'Item' Hope this makes sense - any help would be greatly appreciated. Colm</div></BLOCKQUOTE></P>
<P>You are getting into my own specific code now. This is not something that is generally needed by everyone. I needed it over the years so I wrote it. If you really want to add then here it is:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Interface</FONT></FONT><FONT size=2> IBusinessCollection<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> Item(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> index </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Integer</FONT></FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> useInterface </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean</FONT></FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> IMyBusinessObject<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> IsDirty() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> IsValid() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> Count() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Integer<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> IsSelfValid() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Interface</FONT></FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#000000 size=3>The interface above is declared separately from the list base class.&nbsp;</FONT></FONT></FONT></P>
<P>In the list base class you implement the interface like this:</P><FONT size=2>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>'useInterface is a fake parameter and is only used to change the method signature so we can Overload the Item method.<BR></FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>'It does not use the Boolean value at all.<BR></FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>'This way the Base Item method can still return a strongly typed child BO.<BR></FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>'This Item method returns the Interface version of the child BO as IEditableBusinessObject.<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Overloads</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> Item(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> index </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Integer</FONT></FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> useInterface </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean</FONT></FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> IMyBusinessObject </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Implements</FONT></FONT><FONT size=2> IBusinessCollection.Item<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; Get<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; Return</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>MyBase</FONT></FONT><FONT size=2>.Item(index)<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Get<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Overloads</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> Count() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Integer</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Implements</FONT></FONT><FONT size=2> IBusinessCollection.Count<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; Get<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Return</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>MyBase</FONT></FONT><FONT size=2>.Count<BR>&nbsp; </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Get<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Overloads</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> IsDirty() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Implements</FONT></FONT><FONT size=2> IBusinessCollection.IsDirty<BR>&nbsp; </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Get<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Return</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>MyBase</FONT></FONT><FONT size=2>.IsDirty<BR>&nbsp; </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Get<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>'JF 9/14/2006 - override CSLA code to look like this - no short circuiting involved here.<BR></FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>'run through all the child objects and if any are invalid then the collection is invalid<BR></FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>'call IsValid on all children so that when we examine Broken Rules we get the right set of values.<BR></FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>'Rocky stopped looping after he found the first invalid child.<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Overrides</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> IsValid() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Implements</FONT></FONT><FONT size=2> IBusinessCollection.IsValid<BR>&nbsp; </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Get<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Dim</FONT></FONT><FONT size=2> result </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean</FONT></FONT><FONT size=2> = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>True<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>For</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Each</FONT></FONT><FONT size=2> child </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> C </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>In</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Not</FONT></FONT><FONT size=2> child.IsValid </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT size=2>result = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>False<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Next<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Return</FONT></FONT><FONT size=2> result<BR>&nbsp; </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Get<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> IsSelfValid() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Implements</FONT></FONT><FONT size=2> IBusinessCollection.IsSelfValid<BR>&nbsp; </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Get<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Dim</FONT></FONT><FONT size=2> result </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean</FONT></FONT><FONT size=2> = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>True<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>For</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Each</FONT></FONT><FONT size=2> child </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> C </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>In</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Not</FONT></FONT><FONT size=2> child.IsSelfValid </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT size=2>result = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>False<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Next<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Return</FONT></FONT><FONT size=2> result<BR>&nbsp; </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Get<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</P></FONT></FONT>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#000000 size=3>As I recall the main reason for writing this code and interface was so that I could treat every collection the same way for my reporting framework. I could cast it to the interface and then was guaranteed these properties existed.</FONT></FONT></FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#000000 size=3>Joe</FONT></FONT></FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#000000 size=3></FONT>&nbsp;</P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cmclernon replied on Tuesday, October 13, 2009</h2>Thanks for that Joe,<br /><br />I'm at home now so will try it again tomorrow.  My problem was the definition of MyBusinessListBase class.  From memory I'm now using the following syntax (C#) but am getting an error and was wondering if you could post your working VB syntax and I could try and translate it:<br /><br />[Serializable()] public abstract class MyBusinessListBase : BusinessListBase, IBusinessCollection where T : MyBusinessListBase where C : IMyBusinessObject<br />{<br />...<br />}<br /><br />Thanks,<br /><br />Colm</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cmclernon replied on Tuesday, October 13, 2009</h2>Don't know why but the post is removing the T, C definition where MyBusinessListBase is used.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, October 14, 2009</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>cmclernon:</strong></div><div>Thanks for that Joe, I'm at home now so will try it again tomorrow. My problem was the definition of MyBusinessListBase class. From memory I'm now using the following syntax (C#) but am getting an error and was wondering if you could post your working VB syntax and I could try and translate it: [Serializable()] public abstract class MyBusinessListBase : BusinessListBase, IBusinessCollection where T : MyBusinessListBase where C : IMyBusinessObject { ... } Thanks, Colm</div></BLOCKQUOTE></P>
<P>I posted all of my definitions at the top of this thread.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cmclernon replied on Wednesday, October 14, 2009</h2>Thanks Joe,<br /><br />There's no mention of the IBusinessCollection interface in the MyBusinessListBase definition - I couldn't get it to work as I expected it to in C#.  However, I have got around my problem and no longer need to implement the IBusinessCollection interface.<br /><br />Thanks for your help.<br /><br />Colm</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, October 01, 2009</h2>Not if your intent is just to have a common extension point, no. You should<br />have one base class per CSLA base class - so typically 6 of them:<br /><br />BusinessBase<br />BusinessListBase<br />ReadOnlyBase<br />ReadOnlyListBase<br />NameValueListBase<br />CommandBase<br /><br />And maybe<br /><br />CriteriaBase<br />ObjectFactory</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>nhwilly replied on Friday, October 02, 2009</h2>I just had a huge case of deja vu.<br /><br />I took a computer course in college (1972 thank you very much) and the professor had extended PL/1 into PL/C (the C was for the college name).<br /><br />His intent was to make the compiler correct the student's programming errors and attempt to compile and execute.  Ambitious to say the least.<br /><br />Most of the time the compiler got it wrong and took a severe left turn but went on to compile.  As a student you were left not only debugging your mistakes, but the compiler's attempt to recover from them.  It was the most confusing nonsense ever.<br /><br />Fast forward...<br /><br />I didn't really understand the class definition statement with respect to generics and Intellisense (which I absolutely think is great) cheerfully led me down the path of wrong (but compilable) definitions for the intermediate classes.<br /><br />I suppose this makes you guys the professors now.  <br /><br />Only this time, I actually did read the assigned pages (all 700+ of them).<br /><br />Thanks to you both.  I shudder to think what I'd be doing if I hadn't discovered CSLA and this community.<br /><br />I think "Professor Rocky" has a nice ring to it.  :D<br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>nhwilly replied on Friday, October 02, 2009</h2>P.S. Joe, thanks for the code.  It helped a lot.  I've already made the changes and it's working great.<br /></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
