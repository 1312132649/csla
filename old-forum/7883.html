<html><header><title>how to delete child object when delete parent object?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>how to delete child object when delete parent object?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7883.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>zhoujg posted on Tuesday, October 27, 2009</h2>First I write code in parent object's delete,but I don't want to modify these code on database changing.<br>Now I use database's cascade delete to delete child object when delete parent object on my opensource project[<a href="http://openexpressapp.codeplex.com/">OpenExpressApp</a>],but it cann't <span class="heighlight">handle</span> at some situation.<br>So I want to use an enetiy model to describe these relation,and delete objects by other framework.<br>I don't know whether <span class="en">anyone has do it?</span><br><br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, October 28, 2009</h2><P>You have already discussed the two most basic options for handling this. I am not sure why you are ruling them both out. They should both work pretty easily.</P>
<P>1. In code of parent object you use the parentID to delete the related child records first and then you can safely delete the parent. </P>
<P>2. Or you can omit that step by using the database cascade delete feature which essentially does the same thing for you.</P>
<P>In both cases the parentID is a foregin key in the related child record. Database changes should not affect the simple delete statement for the child records.</P>
<P>I guess you should explain why this straightforward relationship does not work for you. </P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>zhoujg replied on Wednesday, October 28, 2009</h2>1.1 The immediate approach directly deletes an object’s data from the database without first loading the object into memory:<br>if parent has child, and child has child,then it need to write code in parent object's delete to delete all child objects.I think each object should be <span class="word"><font>with responsibility 
for</font></span> delete <span class="heighlight">own </span>child.<br><br>1.2 The deferred approach requires that the object is loaded into memory:<br>If it can straightforward delete by parent-child relationship,this way&nbsp; reduce its <span class="heighlight">efficiency</span>.<br><br>2.1 sqlserver cann't allow you to define  cascade delete in self reference <br>2.2 a root object's a,a has child a1,a1 has child a11,other root object's b,b has child b1,b1 has child b11. b's lookup object's a, and b1's lookup object's b1. if relation aa1,bb1,ab and a1b1 all are cascade delete,sql server cause errors "may cause cycles or multiple cascade paths"<br><br>My English's very poor,so <span class="en"><span class="heighlight">I</span> do <span class="heighlight">not</span> 
<span class="heighlight">know</span> <span class="heighlight">if</span> <span class="heighlight">I</span> am made myself <span class="heighlight">clear ：）<br></span></span></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, October 29, 2009</h2><P>OK. You have explained the complex case well enough.</P>
<P>I have a root BO that takes 12 delete statements to remove all of its child and related records. I coded this in a separate command class which I can then call from any BO that needs to use it. It obviously starts at the lowest level and works backwards up the hierarchy until the root is finally deleted. It uses the key at each level to remove related records. This seems like the best way to handle a complex delete to me. The code is centralized and can be used by various parts of the app that allow the root BO to be deleted.</P>
<P>Joe</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
