<html><header><title>&quot;warningProvider&quot;</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>&quot;warningProvider&quot;</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7131.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>matt tag posted on Thursday, June 18, 2009</h2><font size="1" face="Verdana">I have always used the (nifty recursive) code below to show all errors on a form bound to CSLA object(s).&nbsp; As it should, this code skips rules that are set to RuleSeverity.Warning.&nbsp; Now I would like to show a yellow icon next to the controls that have warnings associated with them.&nbsp; Has anyone implemented this?<br><br><br>&nbsp; Public Shared Sub ShowErrors(ByVal oParent As Control, ByVal epErr As ErrorProvider)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For Each oCtl As Control In oParent.Controls<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For Each oBnd As Binding In oCtl.DataBindings<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim o As System.ComponentModel.IDataErrorInfo = _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CType(oBnd.DataSource, System.ComponentModel.IDataErrorInfo)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; epErr.SetError(oCtl, o.Item(oBnd.BindingMemberInfo.BindingField))<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ShowErrors(oCtl, epErr)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'recursion rules!<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Next<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>matt tag<br></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Friday, June 19, 2009</h2>Hi,<br><br>There is an ErrorWarnInfoProvider in the CSLA Contrib project on CodePlex (although in C#) that could be used. Basically what you need is 2 of 3 separate error providers (setup with different icons) and control which one of them shows a message. If you want to display both errors and warnings at the same time it gets a litle more tricky to add offset (right/left) on the icons so that the error providers will not diplay icons on top of each other. This is handled in the ErrorWarnInfoProvider so take a look at that one. <br><br>/jonnybee<br><br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
