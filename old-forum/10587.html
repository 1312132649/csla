<html><header><title>Need help shifting from Winforms to WPF/MVVM</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Need help shifting from Winforms to WPF/MVVM</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10587.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>reagan123 posted on Wednesday, August 03, 2011</h2><p>Hello,<br />I&#39;m trying to shift from using Winforms/CSLA 3.1.7 to WPF/MVVM using the current CSLA release.&nbsp; I&#39;m having issues on translating my winforms UI approach.</p>
<p>The old approach typically had a grid that was bound to a read only list of objects.&nbsp; Once the user selected an item, I would then fetch the editable object and bind it to the UI.&nbsp; The user could then edit/save the record.</p>
<p>I&#39;m tying to do a simple translation to MVVM and i&#39;m getting a bit lost.<br /><br />I have my CSLA objects:<br />Person<br />PersonInfo<br />PersonInfolist<br /><br />Can anyone help me identifiy what my view model should look like to expose these objects to my view?&nbsp; I know this is a big question, but I&#39;m a bit lost.<br /><br />Thank you.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Wednesday, August 03, 2011</h2><p>The way I tend to approach this, is to have a viewmodel that exposes properties - one property per object the view requires.</p>
<p>The ViewModelBase and ViewModel classes in Csla.Xaml help simplify the common case where the view binds to one primary model object. </p>
<p>If you have multiple model objects that aren&#39;t part of one object graph, then you need to either add properties to your viewmodel, or create a viewmodel from scratch. I typically add properties to my viewmodel, because I usually have one <em>primary</em> model object, and other secondary (usually read-only list) model objects.</p>
<p>A more complex view might have multiple viewmodel objects - for different logical parts of the view.</p>
<p>For example, if you display your PersonInfoList on the left side of the view, that side of the view would have a viewmodel - probably a ViewModel&lt;PersonInfoList&gt;. I&#39;d use a TriggerAction (or other technique) to bind the datagrid&#39;s SelectedItemChanged event to an EditPerson method on this viewmodel.</p>
<p>On the right side of the view, you might have the area to edit the selected person. So that would be bound to a different viewmodel - probably a ViewModel&lt;Person&gt;. The EditPerson method in the first viewmodel would create an instance of this ViewModel&lt;Person&gt;, and provide the resulting viewmodel to the view as its binding source.</p>
<p>None of that is hard really - except that it needs to be done so the viewmodels have no knowledge of the view :)</p>
<p>So with what I just described, my <em>primary</em> viewmodel would be the ViewModel&lt;PersonInfoList&gt;, and it would have a PersonViewModel property that exposes the ViewModel&lt;Person&gt;. This way, the right side of the view can just bind to the PersonViewModel property, and when that property is set by the EditPerson method everything just happens automatically through binding.</p>
<p>In short, I tend to have one <em>root</em> or <em>primary</em> viewmodel for a view, along with other <em>child</em> viewmodel objects as needed.</p>
<p>The <em>CSLA 4 MVVM</em> video series demonstrates this approach.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>reagan123 replied on Wednesday, August 03, 2011</h2><p>Rocky,<br />Thank you so much for the quick reply.&nbsp; I&#39;m going to try to absorb this a bit and then try to setup a test implementation.<br /><br />I really appreciate your help and time.<br /></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael replied on Tuesday, August 16, 2011</h2><p>Hi Rocky</p>
<p>We&#39;re still stuck with .NET 3.5 and CSLA 3.8.3 for now, with VS 2010. How much different is the MVVM approach for 3.8.3? Will the version 4 video series help me?</p>
<p>Kind regards<br />Michael</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jamie.clayton replied on Tuesday, August 16, 2011</h2><p>Michael,</p>
<p>I&#39;m in the CSLA 3.8.2 + VS 2010 boat and the MVVM video series did help me understand all the tasks required for applying ViewModels with XAML and how to use VS2010 more productively.&nbsp;I have&nbsp;wrapped my&nbsp;CSLA BO with the ViewModel(of T) and changed my&nbsp;XAML UI&nbsp;to bind to these Views, but&nbsp;the going is much slower that I thought.&nbsp;&nbsp;My code is much cleaner that the Windows&nbsp;Form code, but it&#39;s far from codeless behind the XAML windows/customControls. My applications are too large to convert everything at to ViewModel implementations, but I will end up converting all my existing XAML to bind to Csla.Xml.ViewModel.</p>
<p>After viewing the PDF documents for CSLA 4 and video series I quickly realised that the CSLA code doesn&#39;t provide a MVVM framework (BXF is probably too basic for LOB apps).&nbsp; MVVM also implied you would need and IOC framework as well. So the MVVM approach is solid in my books, but it&#39;s left me with lots more questions and planning before I dive any further. Essentially you really need to build a spike application with&nbsp;a framework before settling on one.</p>
<p>Rocky points out, that the main tenant of MVVM is unit testing the UI.&nbsp; If your a TDD/BDD shop,&nbsp;then that&#39;s the first thing I wanted to see with all the MVVM frameworks. And that&#39;s where I got very disappointed. Many of the MVVM discussions are around unit testing the ViewModel BO logic that we already have unit tests and business rules working (thanks to CSLA!), rather than how Views and iCommands/TriggerActions/ViewNavigation/ViewMessaging should be unit tested.&nbsp; I&#39;ve spent about 3 very full working days/nights researching MVVM frameworks and I&#39;ve got mixed opinions, but to save your time -</p>
<ul>
<li><a href="http://cinch.codeplex.com/">http://cinch.codeplex.com/</a>&nbsp;- Includes a very helpful unit test examlple on <a href="http://www.codeproject.com/KB/WPF/CinchV.aspx">Codeplex</a>.</li>
<li><a href="http://mvvmlight.codeplex.com/">http://mvvmlight.codeplex.com/</a>&nbsp;- Includes a number of video&#39;s and at the end of the <a href="http://channel9.msdn.com/Events/MIX/MIX11/OPN03">Mix 11</a> one it include a very quick example. The <a href="http://channel9.msdn.com/Series/The-Full-Stack/The-Full-Stack-Part-9-Windows-Phone-Development-with-TDD-and-MVVM">Full Stack Video 9</a>&nbsp;was interesting as well, because&nbsp;I learnt a lot of good VS features.</li>
<li><a href="http://code.msdn.microsoft.com/How-to-implement-MVVM-71a65441/sourcecode?fileId=24081&amp;pathId=1837996368">http://code.msdn.microsoft.com/How-to-implement-MVVM-71a65441/sourcecode?fileId=24081&amp;pathId=1837996368</a>&nbsp;- Code example is interesting.</li>
<li><a href="http://compositewpf.codeplex.com/">http://compositewpf.codeplex.com/</a>&nbsp;- Has the most complete documentation, but only touches on<a href="http://compositewpf.codeplex.com/releases/view/55580"> UI&nbsp;unit </a>testing briefly.&nbsp; </li>
</ul>
<ol>
<li>I like Cinches Mediator communication naming and the Command fail/success approach.</li>
<li>Chinch isn&#39;t available on Nuget.</li>
<li>I like Prims Region concept for managing views. </li>
<li>I like MVVMLights communication pub/subscribing flexibility.</li>
<li>MVVM light doesn&#39;t have any formal documentation, just videos and articles by people.</li>
<li>I&#39;m not sure why ICommand wasn&#39;t included in the CSLA MVVM video series as every MVVM includes an example.</li>
</ol>
<p>So in summary, I get the impression none of the existing MVVM frameworks fit perfectly with CSLA, mainly because they are all trying&nbsp;to implement copies of what CSLA does so well. Each framework implementation uses different terminology. It&#39;s going to be a personal choice and a fairly involved one from my perspective.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, August 16, 2011</h2><p><div style='padding-left: 50px;background-color:silver'><b>Michael<br></b>
<p>We&#39;re still stuck with .NET 3.5 and CSLA 3.8.3 for now, with VS 2010. How much different is the MVVM approach for 3.8.3? Will the version 4 video series help me?</p>
</div></p>
<p>It should help, yes. The video series includes content at the end, where I talk about the things that are different in VS 08 and CSLA .NET 3.8. Most of the differences have more to do with using .NET 3.5, SL 3, and Visual Studio 2008 than they do with using CSLA .NET 3.8.4.</p>
<p>You will probably need to switch to 3.8.4, or at least merge the current Csla.Wpf (or Csla.Silverlight) code into 3.8.3, to completely follow the videos. I back-ported some CSLA 4 features into 3.8.4 to get the necessary functionality working in 3.8.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
