<html><header><title>Trouble with ApplyFilter in FilteredBindingList</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Trouble with ApplyFilter in FilteredBindingList</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3790.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>c_shah posted on Saturday, October 27, 2007</h2><P><FONT face=Arial size=2>I have tried to implement filtered list as you have suggested in this post </FONT><A href="/forums/thread/18628.aspx"><FONT face=Arial size=2>http://forums.lhotka.net/forums/thread/18628.aspx</FONT></A><FONT face=Arial size=2> and described in the handbook for CSLA 2.1, filter does String contains (or sQL Like) when you use ApplyFilter ("property name", object as expression)</FONT></P>
<P><FONT face=Arial size=2>How can I achieve Equals instead of contains</FONT></P>
<P><BR><FONT face=Arial size=2>For e.g. <BR>I have read only collection, each object in the collection has following properties</FONT></P>
<P><FONT face=Arial size=2>SubCarrier_ID (int)<BR></FONT><FONT face=Arial size=2>SubCarrier_Name (String)<BR>Carrier_ID (int)</FONT></P>
<P><FONT face=Arial size=2>When I do applyfilter </FONT></P>
<P><FONT face=Arial size=2>Dim filtered as CSLA.FilteredBindingList(of SubCarrier)(SubCarrierList)<BR>Filtered.ApplyFilter("CARRIER_ID", 1) ' Where 1 is the id of the Carrier</FONT></P>
<P><FONT face=Arial size=2>filtered now contains all the subcarriers with carrier__id including Carrier_ID 1, 10 ,100 </FONT></P>
<P><FONT face=Arial size=2>I only want to filter objects with Carrier_ID = 1 (as you do in SQL WHERE Carrier_ID =&nbsp;1)</FONT></P>
<P><FONT face=Arial size=2>Read about custom filter provider but looks like i am making it complicated (I am a beginner of CSLA and in .NET you can use Filter with DataView where it does WHERE)</FONT></P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Sunday, October 28, 2007</h2><P>No, you do need to create a custom filter for anything that the default filter doesn't do. The default filter calls Contains() (you can look at the code&nbsp;- it isn't complex).</P>
<P>You can do equals by creating a different filter like:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> Filter(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> item </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> filterValue </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean<BR><BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> result </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean</FONT><FONT size=2> = </FONT><FONT color=#0000ff size=2>False<BR>&nbsp; </FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Not</FONT><FONT size=2> item </FONT><FONT color=#0000ff size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Nothing</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>AndAlso</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Not</FONT><FONT size=2> filterValue </FONT><FONT color=#0000ff size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Nothing</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Then<BR><STRONG>&nbsp;&nbsp;&nbsp; </STRONG></FONT><STRONG><FONT size=2>result = </FONT><FONT color=#0000ff size=2>CStr</FONT><FONT size=2>(item).Equals(</FONT><FONT color=#0000ff size=2>CStr</FONT></STRONG><FONT size=2><STRONG>(filterValue))<BR></STRONG>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> result</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Monday, October 29, 2007</h2><P>Here is some sample code that may help when using FBL:</P><FONT color=#0000ff size=2>
<P>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetDataSource(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> key </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> FilteredBindingList(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> MyBo)<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> filteredList </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> FilteredBindingList(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> MyBo)<BR>&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> filterValue </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object<BR><BR>&nbsp; </FONT><FONT size=2>filteredList = </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> FilteredBindingList(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> MyBo)(mMyBOECC)<BR><BR>&nbsp; </FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> filteredList </FONT><FONT color=#0000ff size=2>IsNot</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Nothing</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>filteredList.FilterProvider = </FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> MyBoFilter<BR>&nbsp;&nbsp;&nbsp; filterValue = key<BR>&nbsp;&nbsp;&nbsp; filteredList.ApplyFilter(</FONT><FONT color=#ff00ff size=2>""</FONT><FONT size=2>, filterValue)&nbsp; <FONT color=#008000>'Passing "" means you pass the whole BO not a Property.</FONT><BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Return</FONT><FONT size=2> filteredList<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>'The primary requirement is that the method signature conform to the FilterProvider delegate.<BR></FONT><FONT color=#008000 size=2>'The method must return True for items that should be included in the filtered view, and False for those that should not.<BR></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> MyBoFilter(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> item </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> filterValue </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean<BR></FONT><FONT color=#008000 size=2>'You need to implement code here to check the value of the item parameter based on your rules, <BR></FONT><FONT color=#008000 size=2>'along with any criteria provided through the filterValue parameter.<BR></FONT><FONT color=#008000 size=2>'Remember that the item parameter could be the value of a specific property, or it could be a reference to the actual business object. <BR></FONT><FONT color=#008000 size=2>'And keep in mind that the filterValue parameter is of type Object, and so it could be any value youâ€™d like, even a complex object.</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Dim</FONT><FONT size=2> result </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean</FONT><FONT size=2> = </FONT><FONT color=#0000ff size=2>False<BR><BR>&nbsp; </FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> item </FONT><FONT color=#0000ff size=2>IsNot</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Nothing</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>AndAlso</FONT><FONT size=2> filterValue </FONT><FONT color=#0000ff size=2>IsNot</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Nothing</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> objMyBo </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> MyBo= </FONT><FONT color=#0000ff size=2>DirectCast</FONT><FONT size=2>(item, MyBo)<BR>&nbsp;&nbsp;&nbsp; result = (objMyBo.Key = </FONT><FONT color=#0000ff size=2>CInt</FONT><FONT size=2>(filterValue))<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If<BR><BR>&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> result<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT>
<P>Joe</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
