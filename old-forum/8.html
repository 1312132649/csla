<html><header><title>PropertyHasChanged Combo</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>PropertyHasChanged Combo</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>glenntoy posted on Friday, May 05, 2006</h2><P>In CSLA 1.1, MarkDirty() is called when a property has changed its value. In CSLA 2.0, PropertyHasChanged() performs 3 actions: a.) it executes the validations rules if there are any b.) calls MarkDirty() and c.) call OnPropertyChanged.</P>
<P>I've watched the CSLA 2.0 Part 2 in DNRTV, it seems in the project trakker sample in the property it calls Validation.CheckRules("PropertyName") and followed by the PropertyHasChanged() method. Isn't it redudant to call CheckRules() in the property when it is already called inside the PropertyHasChanged()?</P>
<P>I dont know if this is a typo error, just want to know the correct way of doing it. Maybe Rocky has a reason why he&nbsp;called the CheckRules("") w/ PropertyHasChanged().&nbsp;</P>
<P>Thanks,</P>
<P>Glenn&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, May 05, 2006</h2>I found this too, and it did end up running the rules twice.&nbsp; I'd think it shouldn't be in the book, but maybe it was a last minute change?<br><br>At any rate, I don't put a call to check rules explictly in any property setting and just call the PropertyHasChanged method.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>glenntoy replied on Friday, May 05, 2006</h2><P>I think your right,&nbsp;I guess Rocky ported the project&nbsp;trakker from 1.1 to 2.0 and forget to make the necessary changes in the part. Anyways, its not&nbsp;that big deal&nbsp;but again just making sure what is the right way of&nbsp;doing it. </P>
<P>In my case, I only called PropertyHasChanged() if the&nbsp;validation&nbsp;rules&nbsp;aren't complex.&nbsp;I have a scenario here that the&nbsp;business rule of a property&nbsp;has a computation and it&nbsp;affects other properties.. I&nbsp;explicitly called&nbsp;CheckRules() and MarkDirty() and&nbsp;OnPropertyChanged()&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai replied on Friday, May 05, 2006</h2><P>Hi Glenn.</P>
<P>Can you be more specific?&nbsp; Not sure which Object or Property of Project Tracker you are referring to, so what I am about to type may be incorrect.&nbsp; If the property name in Validation.CheckRules("PropertyName")&nbsp;is the same as the property it is being called within then I agree that it is incorrect.&nbsp; However, if the property name is different then this is perfectly valid as it means that the property specified in Validation.CheckRules("PropertyName") has some validation rules that depend on the value of the property it is being called from. Hope that makes sense as it is hard to explain.&nbsp;&nbsp; Basically, PropertyHasChanged uses reflection to determine which property has changed and therefore only checks the rules for that property.&nbsp; So if we have one property that depends on another we have to force it to recheck the rules for the dependent property when the other changes.</P>
<P>HTH.</P>
<P>&nbsp;</P>
<P>John.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>glenntoy replied on Friday, May 05, 2006</h2><P>Ooops.. sorry guys.. the project trakker Project.vb is okay. I got blinded with Started() and Ended() Properties in Project.vb ..&nbsp;Your right razorkai. What I mean is the same property name. Apologize for not being specific.. ;-)&nbsp; </P>
<P>Thanks razorkai and aiij???? </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, May 05, 2006</h2><P>I think you misread what I was showing.</P>
<P>It is true that ProjectTracker has a couple properties where CheckRules() is called explicitly - but that is against a <EM>different property</EM> from the one being set. Specifically, the Started and Ended properties in Project do this.</P>
<P>The reason is that these two properties have a co-dependant validation rule (Started&lt;=Ended). In order to get the ErrorProvider to show both properties in error due to the same rule violation, Started must call CheckRules("Ended") and Ended must call CheckRules("Started"). The rules for a <EM>given property</EM> are not being run twice. Instead, the rules for <EM>two different</EM> properties are being checked when either one changes.</P>
<P>Rocky</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>glenntoy replied on Friday, May 05, 2006</h2><P>Thanks Rocky.. apologize for not paying attention in the show...grrhhhh <img src="/emoticons/emotion-2.gif" alt="Big Smile [:D]" /> </P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
