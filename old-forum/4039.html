<html><header><title>Suggested modification to Validation.ValidationRules.ValidateHandler</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Suggested modification to Validation.ValidationRules.ValidateHandler</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4039.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>uhlo posted on Friday, December 14, 2007</h2><P>Hi,</P>
<P>during conversion of a CSLA.NET 1.x project into CSLA.NET 3.0 we got some strange behavior due to not fully understanding the ValidationRule implementation.<BR>This has now been fixed but left a question regarding the requirements of static methods for shared (per-type) ValidationRules.</P>
<P>Within the Validation.ValidationRules class there is a method called ValidateHandler that is used to validate the given BusinessRule handler method before it is added for the object type.</P>
<P>The validation consists of a conditional statement where the given method must be static if declared by the target class. The specific code looks like the following:</P>
<BLOCKQUOTE><FONT face="Courier New" size=2>if (!method.IsStatic &amp;&amp; method.DeclaringType.Equals(_target.GetType()))</FONT></BLOCKQUOTE>
<P>I am not sure I fully understand the purpose of the second condition but should/could it not be expressed as</P>
<BLOCKQUOTE><FONT face="Courier New" size=2>if (!method.IsStatic &amp;&amp; method.DeclaringType.IsInstanceOfType(_target))</FONT></BLOCKQUOTE>
<P>instead?</P>
<P>I.e. why is it only required of a method to be static if it is declared in the target class and not if it is declared in any of the classes that the target class is derived from?</P>
<P>Regards,<BR>Henrik</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, December 14, 2007</h2><P>Interesting, this is a&nbsp;valid concern. I'll add this to the <A href="http://www.lhotka.net/cslanet/wishlist.aspx">wish list</A>.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
