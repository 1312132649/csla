<html><header><title>Capturing child saved events in Editable Root List</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Capturing child saved events in Editable Root List</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7522.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tom_W posted on Friday, August 28, 2009</h2>Hi All<br><br>Our current project is MDI Winforms and I'd like to display a '*' on a form's tab if the record is dirty and an '!' if the record is invalid.<br><br>I have written a bit of code as follows;<br><br>Public Class StockItemEditControl<br>&nbsp;&nbsp;&nbsp; Dim WithEvents _stockItemList As StockItemEditList<br><br>&nbsp;&nbsp;&nbsp; Public Sub New()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InitializeComponent()<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.FormCaption = "Stock Items"<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _stockItemList = StockItemEditList.GetStockItemEditList()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StockItemEditBindingSource.DataSource = _stockItemList<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'AddHandler _stockItemList.ChildChanged, AddressOf DirtyCaption<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Dim ieo As System.ComponentModel.INotifyPropertyChanged = DirectCast(_stockItemList, System.ComponentModel.INotifyPropertyChanged)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'AddHandler ieo.PropertyChanged, AddressOf DirtyCaption<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddHandler _stockItemList.AddingNew, AddressOf AddingNew_Handler<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddHandler _stockItemList.ChildChanged, AddressOf ChildChanged_Handler<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddHandler _stockItemList.ListChanged, AddressOf ListChanged_Handler<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddHandler _stockItemList.RemovingItem, AddressOf RemovingItem_Handler<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddHandler _stockItemList.Saved, AddressOf Saved_Handler<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>&nbsp;&nbsp;&nbsp; Public Sub ChildChanged_Handler(ByVal sender As Object, ByVal e As ChildChangedEventArgs)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ResetDirtyCaption()<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>&nbsp;&nbsp;&nbsp; Public Sub AddingNew_Handler(ByVal sender As Object, ByVal e As AddingNewEventArgs)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ResetDirtyCaption()<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>&nbsp;&nbsp;&nbsp; Public Sub ListChanged_Handler(ByVal sender As Object, ByVal e As ListChangedEventArgs)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ResetDirtyCaption()<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>&nbsp;&nbsp;&nbsp; Public Sub RemovingItem_Handler(ByVal sender As Object, ByVal e As RemovingItemEventArgs)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ResetDirtyCaption()<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>&nbsp;&nbsp;&nbsp; Public Sub Saved_Handler(ByVal sender As Object, ByVal e As SavedEventArgs)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ResetDirtyCaption()<br>&nbsp;&nbsp;&nbsp; End Sub<br><br><br>&nbsp;&nbsp;&nbsp; Public Sub ResetDirtyCaption()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If _stockItemList.IsDirty Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If _stockItemList.IsValid Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Object is dirty, but OK to save<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FormCaption = "Stock Items *"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Object is dirty and invalid<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FormCaption = "Stock Items !"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FormCaption = "Stock Items*"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp; End Sub<br><br><br>The above is all working great, except that BLB's Saved event doesn't always seem to fire.&nbsp; I'm guessing it isn't necessarily thrown if one of it's child objects is saved?<br><br>A possibly related point here is that my child object's insert and update methods do not take the parent object as a parameter, i.e. in the child StockItemEdit :<br><br>&nbsp;&nbsp;&nbsp; private void Child_Insert()<br>&nbsp;&nbsp;&nbsp; {<br><br>&nbsp;&nbsp;&nbsp; private void Child_Update()<br>&nbsp;&nbsp;&nbsp; {<br><br>Could that be the cause?&nbsp; I guess really my question is should BLB's Saved event fire every time one of it's children fires or is that not what its for?<br><br><br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
