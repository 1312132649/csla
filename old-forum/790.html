<html><header><title>WithEvents oddness CslaDataSource and VB.Net</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>WithEvents oddness CslaDataSource and VB.Net</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/790.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jas_nhs posted on Wednesday, August 02, 2006</h2>&nbsp;&nbsp;&nbsp; Whist an old hand at VB6 and more used to C#, I have an odd problem when using a number of CslaDataSources on a user contro, with the less-familiar VB.Netl. The "select" event handler is created in the predictable way:<br><br><font face="Courier New"><font color="#0000ff">&nbsp; Protected Sub CslaDSUserAdmin_SelectObject(ByVal sender As Object, ByVal e As Csla.Web.SelectObjectArgs) Handles CslaDSUserAdmin.SelectObject<br>&nbsp;&nbsp;&nbsp; e.BusinessObject = UserAccounts.GetUserAccounts()<br>&nbsp; End Sub</font><br></font><br>but, on my home PC this throws a build error:<br><br><font color="#0000ff" face="Courier New">Handles clause requires a WithEvents variable defined in the containing type or one of its base types.<br></font><br>The ascx code is simply:<br><font color="#0000ff" face="Courier New">&lt;cc1:CslaDataSource ID="CslaDSUserAdmin" runat="server" TypeAssemblyName="OSALib.SA.BusinessObjects"<br>&nbsp; TypeName="OSALib.SA.BusinessObjects.UserAccount"&gt;<br>&lt;/cc1:CslaDataSource&gt;<br></font><br>If I comment out the "handles..." bit, the above sub is not invoked (of course) and no records are read.<br>What to do???&nbsp; I am using V2.0.3 of csla.dll (ref Assembly Version, in the file properties)<br>I'm wondering if this msg might be vaguely relevant: http://forums.lhotka.net/forums/post/2099.aspx<br><br>Many thanks for any guidance,<br><br>James.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Wednesday, August 02, 2006</h2>I'm not that much into web, but in windows forms (or just in a simple class), you need to do this:<br><br>Private WithEvents mInstanceName as SomeType<br><br>If for some reason you can't do that, you can do it as you would in c# with an addhandler in a constructor or in a load event, like:<br>AddHandler mInstanceName.EventName, AddressOf methodName<br><br><br>That way, you don't need to use the "Handles". To remove the handler the sintax is exactly the same except you use RemoveHandler.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
