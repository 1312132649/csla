<html><header><title>Execute Business rule on child object When Parent property has change.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Execute Business rule on child object When Parent property has change.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11224.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>patelravij@gmail.com posted on Monday, March 12, 2012</h2><p>I have parent root(Mater) object as BusinessBase which has BusinessListBase(ChildList)&nbsp;object as a child.</p>
<p>Parent&nbsp;(BusinessBase)</p>
<p>&nbsp;&nbsp;&nbsp; - Child List&nbsp;(BusinessListBase)</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- Child (BusinessBase)</p>
<p>I have a custom business rule implemented in child object (BusinessBase of ChildList), which&nbsp;depends on&nbsp;parent root(Mater) property. Now when parent root(Mater) property is changed, how to notify child object?</p>
<p>There is override method OnChildChanged which fires when any child property changed. Is there any way to fires custom rules on child object and show property status when parent property has been changed?</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Monday, March 12, 2012</h2><p>You can override PropertyHasChanged in parent object and rerun rules for child objects when that specific property has changed. </p>
<p>PropertyHasChanged will only be called when property content has changed.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>patelravij@gmail.com replied on Monday, March 12, 2012</h2><p>Thanks JonnyBee for prompt reply</p>
<p><br />I have override PropertyHasChanged in parent object. But how can I check business rules for each child in ChildList?<br />I have tried below two methods for check business rules.<br />BusinessRules.CheckRules() and&nbsp; BusinessRules.CheckObjectRules(). But it does not fire business rules for child objects and does not update property status.</p>
<p><br />So can you please guide me how to rerun business rules for each child in Child List so than custom business rules execute and property status is updated?</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Monday, March 12, 2012</h2><p>you can extend the child object with a &quot;CheckAllRules&quot; that notify UI of changes like this:</p>
<pre style="font-family:Consolas;background:#333333;color:#dfdfbf;font-size:13px;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#efc986;">public </span><span style="color:#efc986;">void</span> CheckAllRules(<span style="color:#8c8cb4;"></span>)<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#efc986;">var</span>&nbsp;propertyNames&nbsp;=&nbsp;BusinessRules.CheckRules();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#efc986;">if</span>&nbsp;(<span style="color:#8acccf;">ApplicationContext</span>.PropertyChangedMode&nbsp;==&nbsp;<span style="color:#8acccf;">ApplicationContext</span>.<span style="color:#8acccf;">PropertyChangedModes</span>.Windows)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OnPropertyChanged(property);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#efc986;">else</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#efc986;">foreach</span>&nbsp;(<span style="color:#efc986;">var</span>&nbsp;name&nbsp;<span style="color:#efc986;">in</span>&nbsp;propertyNames)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OnPropertyChanged(name);<br />&nbsp;&nbsp;&nbsp;&nbsp;}</pre>
<p>&nbsp;And call this in from the PropertyHasChanged in the root object. </p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>patelravij@gmail.com replied on Wednesday, March 14, 2012</h2><p>I have tried your sugestion and&nbsp;Its worsk. Thanks a lot....</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>Michael Waihenya replied on Friday, March 30, 2012</h2><p>Shah,</p>
<p>I have an interface IGrandChildList that all lists implement to expose the Parent and override the SetParent method of the child object. I thenadd a handler OnParentChanged that will allow me to execute my rules.</p>
<p>Protected Overrides Sub SetParent(parent As Csla.Core.IParent)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AddHandler DirectCast(parent, IGrandChildList).GetParent.PropertyChanged, AddressOf OnParentChanged<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyBase.SetParent(parent)<br />End Sub<br />Protected Overridable Sub OnParentChanged(sender As Object, e As System.ComponentModel.PropertyChangedEventArgs)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#39; Check Rules here</p>
<p>End Sub</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
