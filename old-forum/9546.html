<html><header><title>BusinessListBase and MarkAsChild</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>BusinessListBase and MarkAsChild</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9546.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka posted on Friday, September 17, 2010</h2><p>In CSLA 4 an exception is thrown when you attempt to add an object to a BLB and that object isn&#39;t a child. That&#39;s good, in that it enforces an important rule.</p>
<p>However, it causes issues with the WPF datagrid control, which has no hook where you can create a new object when the user hits the last row. The *(#$@ datagrid insists on creating the new object and adding it to the underlying collection.</p>
<p>Of course that triggers this exception.</p>
<p>So I am considering a change to this behavior. Instead of throwing an exception, BLB could call MarkAsChild() on the new &quot;child&quot; object. Basically force the object to be a child.</p>
<p>The advantage to this is that it would fix this WPF datagrid problem.</p>
<p>The disadvantage to this is that it could basically hide a bug. You might construct an object as a root, and add it to a BLB, and it would become a child - possibly causing confusion.</p>
<p>However, I suspect that this advantage outweighs the disadvantage.</p>
<p>But I wanted to open it for discussion. What do you think?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tmg4340 replied on Friday, September 17, 2010</h2><p>I assume &quot;Get Microsoft to fix the *(#$@ WPF DataGrid&quot; isn&#39;t an option...</p>
<p><img src="http://forums.lhotka.net/emoticons/emotion-1.gif" alt="Smile" /></p>
<p>From my perspective, I don&#39;t see much other choice.&nbsp; As crappy as the WPF DataGrid is, not being able to use CSLA collections with it is a problem.&nbsp; While I understand the issue with hiding a potential programming bug, you could also look at it a different way.&nbsp; A CSLA collection requires that all its children are marked as such, so why make the consumer remember to do it?&nbsp; It&#39;s an ironclad convention, so maybe it&#39;s better to code that directly into the framework.</p>
<p>- Scott</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tiago replied on Friday, September 17, 2010</h2><p>Hi Rocky,</p>
<p>Since Pre-Release 4.0.0-100108, BusinessListBase inherits from ObservableCollection&lt;T&gt; and exists to integrate &quot;nicely&quot; with WPF.</p>
<p>My questions are:</p>
<p>1) Do we also need to use it (instead of BusinessBindingListBase)&nbsp;with Silverligh 4?</p>
<p>If the answer is yes, then comes the next question:</p>
<p>2) Does this problem also exists with Silverlight 4 Toolkit DataGrid?</p>
<p>If the answer is also yes, I&#39;d say go ahead with the change. Microsoft most probably will never fix this issue and it will became a feature we must live with.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, September 17, 2010</h2><p>You can use BLB or BBLB in WPF. In fact you have to choose the right base class to work with your UI controls, since apparently some third party datagrid controls don&#39;t work well with ObservableCollection (to my amazement!).</p>
<p>Silverlight does have a &quot;BBLB&quot; type, but it is actually just BLB. It exists purely for serialization compatibility, not to provide behavioral equivalence, since Silverlight isn&#39;t &quot;contaminated&quot; with all the old Windows Forms stuff.</p>
<p>The WPF datagrid from Microsoft does not behave the same as the SL datagrid. The SL datagrid is generally more mature. However, it doesn&#39;t have the ability to automatically add new rows, and so avoids this issue.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tiago replied on Sunday, September 19, 2010</h2><p>Hi Rocky,</p>
<p>Hiding a bug doesn&#39;t seem a good choice but having a useless application seems to be also a bad choice.</p>
<p>If we have the source for WPF DataGrid, a modified control can be made available in CslaContrib.</p>
<p>If we can&#39;t change the source and given the complexity you described, we might be better with both worlds.</p>
<ul>
<li>The&nbsp;default behaviour wouldn&#39;t hide the bug.</li>
<li>We could have a static method that changes the default behaviour to WPFDataGrid mode (something like AutoMarkAsChildEveryNewChild)&nbsp;</li>
</ul></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Sunday, September 19, 2010</h2><p>I think you could also argue that automatically making the object a child is a feature - that it isn&#39;t hiding a bug at all. Rather, that you shouldn&#39;t have to worry about details like setting the object as a child, and that CSLA should just make that work for you.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tiago replied on Saturday, January 22, 2011</h2><p>Hi Rocky,</p>
<p>Did you made a decision on this issue?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Saturday, January 22, 2011</h2><p>Sorry, this slipped through the cracks. I&#39;ve now added it to the wish list.</p>
<p><a href="http://www.lhotka.net/cslabugs/edit_bug.aspx?id=887">http://www.lhotka.net/cslabugs/edit_bug.aspx?id=887</a></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tiago replied on Sunday, January 23, 2011</h2><p>Can this be solved at the control level (like Jaans did with ComboBoxEx for Silverlight)?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Sunday, January 23, 2011</h2><p>You can certainly try. When I looked at the problem originally I did take a quick look at the events on the datagrid control and didn&#39;t see a way to override the default behavior. Most datagrid controls do have a way to override this behavior though, so perhaps I just missed it...</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
