<html><header><title>Base Classes &amp; Partial Classes</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Base Classes &amp; Partial Classes</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4963.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Pieter posted on Wednesday, June 11, 2008</h2>Hi All,<br><br>How do I implement a base class, that keeps all the properties and generated code, and then inherit from that class where I keep all the custom methods?<br>Also, how would you handle any child objects within that class e.g. Order with Order Details?<br><br>Thanks!<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, June 11, 2008</h2><P>Here is a sample root object which may help you get the idea:</P><FONT size=2>
<P></FONT><FONT size=2>&lt;Serializable()&gt; _<BR></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>MustInherit</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> CostcenterGen<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Inherits</FONT><FONT size=2> MyBusinessBase(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> Costcenter)</P></FONT><FONT color=#0000ff size=2>
<P>#Region</FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2>" Class Variable Declarations "</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> mCostcode </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#ff00ff size=2>""<BR></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> mCcname </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#ff00ff size=2>""<BR></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> mStatus </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#ff00ff size=2>""<BR></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> mUserid </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Long</FONT><FONT size=2> = 0<BR></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> mTstamp </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> Csla2.SmartDate<BR></FONT></P><FONT color=#0000ff size=2>
<P>#End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P>
<P>#Region</FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2>" Constructor "</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2>()<BR>&nbsp; </FONT><FONT color=#008000 size=2>'require use of factory methods <BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P>
<P>#End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P>
<P>#Region</FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2>" Business Properties and Methods "</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</FONT><FONT size=2> Costcode() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String<BR></FONT><FONT color=#0000ff size=2>Get<BR></FONT><FONT color=#0000ff size=2>&nbsp; Return</FONT><FONT size=2> mCostcode<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Get</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Set</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> Value </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2>&nbsp; If</FONT><FONT size=2> mCostcode &lt;&gt; Value </FONT><FONT color=#0000ff size=2>Then<BR></FONT><FONT size=2>&nbsp; &nbsp; mCostcode = Value<BR></FONT><FONT size=2>&nbsp;&nbsp;&nbsp; PropertyHasChanged(</FONT><FONT color=#ff00ff size=2>"Costcode"</FONT><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2>&nbsp; End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Set<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Property</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>etc.</FONT></P><FONT size=2>
<P></FONT>
<P><FONT color=#0000ff size=2></P>#Region</FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2>" Validation Rules " 
<P></P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> AddBusinessRules()</P>
<P></FONT><FONT color=#008000 size=2>'Costcode<BR></FONT><FONT size=2>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> StringRequired, </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> MyRuleArgs(</FONT><FONT color=#ff00ff size=2>"Costcode"</FONT><FONT size=2>))<BR>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> StringMaxLength, </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> MaxLengthRuleArgs(</FONT><FONT color=#ff00ff size=2>"Costcode"</FONT><FONT size=2>, 15))<BR>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> IsValidSyntax, </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> MyRuleArgs(</FONT><FONT color=#ff00ff size=2>"Costcode"</FONT><FONT size=2>))<BR>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> IsValidCodeSyntax, </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> MyRuleArgs(</FONT><FONT color=#ff00ff size=2>"Costcode"</FONT><FONT size=2>))<BR>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> RecordDoesNotExist, </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> RecordExistsRuleArgs(</FONT><FONT color=#ff00ff size=2>"Costcode"</FONT><FONT size=2>, </FONT><FONT color=#ff00ff size=2>"costcenter"</FONT><FONT size=2>, </FONT><FONT color=#ff00ff size=2>""</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>True</FONT><FONT size=2>), 1)</P>
<P></FONT><FONT color=#008000 size=2>'Ccname<BR></FONT><FONT size=2>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> StringMaxLength, </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> MaxLengthRuleArgs(</FONT><FONT color=#ff00ff size=2>"Ccname"</FONT><FONT size=2>, 60))<BR>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> IsValidSyntax, </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> MyRuleArgs(</FONT><FONT color=#ff00ff size=2>"Ccname"</FONT><FONT size=2>))</P>
<P></FONT><FONT color=#008000 size=2>'Status<BR></FONT><FONT size=2>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> StringMaxLength, </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> MaxLengthRuleArgs(</FONT><FONT color=#ff00ff size=2>"Status"</FONT><FONT size=2>, 1))<BR>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> ContainsValidValue, </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> ValidValuesRuleArgs(</FONT><FONT color=#ff00ff size=2>"Status"</FONT><FONT size=2>, GetValidStatusValues))<BR>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> IsValidSyntax, </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> MyRuleArgs(</FONT><FONT color=#ff00ff size=2>"Status"</FONT><FONT size=2>))</P>
<P></FONT><FONT color=#008000 size=2>'Tstamp<BR></FONT><FONT size=2>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> DateRequired, </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> MyRuleArgs(</FONT><FONT color=#ff00ff size=2>"Tstamp"</FONT><FONT size=2>))<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetValidStatusValues() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>()<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>() {</FONT><FONT color=#ff00ff size=2>"A"</FONT><FONT size=2>, </FONT><FONT color=#ff00ff size=2>"D"</FONT><FONT size=2>}<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P>
<P>#End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P></FONT><FONT color=#0000ff size=2>
<P>#Region</FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2>" Factory Methods "</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> NewCostcenter(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> costcode </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Costcenter<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> DataPortal.Create(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> Costcenter)(</FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> CriteriaCode(</FONT><FONT color=#0000ff size=2>GetType</FONT><FONT size=2>(Costcenter), </FONT><FONT color=#ff00ff size=2>"NewCostcenter"</FONT><FONT size=2>, costcode))</FONT><FONT color=#0000ff size=2><BR>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetCostcenter(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> costcode </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Costcenter<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> DataPortal.Fetch(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> Costcenter)(</FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> CriteriaCode(</FONT><FONT color=#0000ff size=2>GetType</FONT><FONT size=2>(Costcenter), </FONT><FONT color=#ff00ff size=2>"GetCostcenter"</FONT><FONT size=2>, costcode))<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> DeleteCostcenter(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> costcode </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>)<BR>&nbsp; </FONT><FONT size=2>DataPortal.Delete(</FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> CriteriaCode(</FONT><FONT color=#0000ff size=2>GetType</FONT><FONT size=2>(Costcenter), </FONT><FONT color=#ff00ff size=2>"DeleteCostcenter"</FONT><FONT size=2>, costcode))<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT color=#0000ff size=2>
<P>#End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P>
<P>#Region</FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2>" BusinessBase Overrides "</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetIdValue() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object<BR></FONT><FONT color=#0000ff size=2>&nbsp; Return</FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2>"costcenter."</FONT><FONT size=2> &amp; mCostcode.ToString<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT><FONT color=#0000ff size=2>
<P>#End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P>
<P>#Region</FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2>" Data Access "</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> SetDefaults()<BR>&nbsp; IsOwner = </FONT><FONT color=#0000ff size=2>False<BR>&nbsp; </FONT><FONT size=2>Table = </FONT><FONT color=#ff00ff size=2>"Cost Center"<BR>&nbsp; </FONT><FONT size=2>mTstamp.Date = </FONT><FONT color=#0000ff size=2>Date</FONT><FONT size=2>.Now<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P>
<P>#Region</FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2>"DataPortal_Create"</P></FONT><FONT size=2>
<P>&lt;RunLocal()&gt; _<BR></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overloads</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> DataPortal_Create(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> criteria </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>TypeOf</FONT><FONT size=2> criteria </FONT><FONT color=#0000ff size=2>Is</FONT><FONT size=2> CriteriaCode </FONT><FONT color=#0000ff size=2>Then<BR></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> crit </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> CriteriaCode = </FONT><FONT color=#0000ff size=2>DirectCast</FONT><FONT size=2>(criteria, CriteriaCode)<BR>mCostcode = crit.Code<BR></FONT><FONT color=#0000ff size=2>Else<BR></FONT><FONT color=#0000ff size=2>Throw</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> ApplicationException(</FONT><FONT color=#ff00ff size=2>"Invalid criteria passed to DataPortal_Create method."</FONT><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P>SetDefaults()<BR>MarkNew()<BR>ValidationRules.CheckRules()<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P>
<P>#End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P>
<P>#Region</FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2>" DataPortal_Fetch "<BR></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> DataPortal_Fetch(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> criteria </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>TypeOf</FONT><FONT size=2> criteria </FONT><FONT color=#0000ff size=2>Is</FONT><FONT size=2> CriteriaCode </FONT><FONT color=#0000ff size=2>Then<BR></FONT><FONT color=#0000ff size=2>&nbsp; Dim</FONT><FONT size=2> crit </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> CriteriaCode = </FONT><FONT color=#0000ff size=2>DirectCast</FONT><FONT size=2>(criteria, CriteriaCode)<BR></FONT><FONT color=#0000ff size=2>&nbsp; If</FONT><FONT size=2> CostcenterDAO.RecordDoesNotExist(crit.Code) </FONT><FONT color=#0000ff size=2>Then<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; Me</FONT><FONT size=2>.DataPortal_Create(criteria)<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;Else<BR></FONT><FONT size=2>&nbsp;&nbsp;&nbsp; DoFetch(criteria)<BR></FONT><FONT color=#0000ff size=2>&nbsp; End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If<BR></FONT><FONT color=#0000ff size=2>Else<BR></FONT><FONT color=#0000ff size=2>Throw</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> ApplicationException(</FONT><FONT color=#ff00ff size=2>"Invalid criteria passed to DataPortal_Fetch method."</FONT><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> DoFetch(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> criteria </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>)<BR>SetDefaults()<BR></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> cn </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IDbConnection = </FONT><FONT color=#0000ff size=2>Nothing<BR></FONT><FONT color=#0000ff size=2>Try<BR></FONT><FONT size=2>cn = DAL.CreateConnection<BR>cn.Open()<BR>FetchData(criteria, cn)<BR>PostFetchData(criteria, cn)<BR>FetchChildren(criteria, cn)<BR></FONT><FONT color=#0000ff size=2>Finally<BR></FONT><FONT size=2>cn.Close()<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Try</P></FONT><FONT size=2>
<P>MarkOld()<BR>ValidationRules.CheckRules()<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> FetchData(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> criteria </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> cn </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IDbConnection)<BR></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> dr </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> SafeDataReader<BR></FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>TypeOf</FONT><FONT size=2> criteria </FONT><FONT color=#0000ff size=2>Is</FONT><FONT size=2> CriteriaCode </FONT><FONT color=#0000ff size=2>Then<BR></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> crit </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> CriteriaCode = </FONT><FONT color=#0000ff size=2>DirectCast</FONT><FONT size=2>(criteria, CriteriaCode)<BR>dr = </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> SafeDataReader(DAL.ExecuteReader(cn, CommandType.Text, CostcenterDAO.Select(crit.Code)))<BR></FONT><FONT color=#0000ff size=2>Else<BR></FONT><FONT color=#0000ff size=2>Throw</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> ApplicationException(</FONT><FONT color=#ff00ff size=2>"Invalid criteria passed to FetchData method."</FONT><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Try<BR></FONT><FONT color=#0000ff size=2>With</FONT><FONT size=2> dr<BR></FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> .Read() </FONT><FONT color=#0000ff size=2>Then<BR></FONT><FONT size=2>mCostcode = Trim(.GetString(</FONT><FONT color=#ff00ff size=2>"costcode"</FONT><FONT size=2>))<BR>mCcname = Trim(.GetString(</FONT><FONT color=#ff00ff size=2>"ccname"</FONT><FONT size=2>))<BR>mStatus = Trim(.GetString(</FONT><FONT color=#ff00ff size=2>"status"</FONT><FONT size=2>))<BR>mUserid = </FONT><FONT color=#0000ff size=2>CLng</FONT><FONT size=2>(.GetValue(</FONT><FONT color=#ff00ff size=2>"userid"</FONT><FONT size=2>))<BR>mTstamp = .GetSmartDate(</FONT><FONT color=#ff00ff size=2>"tstamp"</FONT><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>With</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Finally<BR></FONT><FONT size=2>dr.Close()<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Try<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> PostFetchData(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> criteria </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> cn </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IDbConnection)</FONT><FONT size=2><BR><FONT color=#008000>'marker method that can be overridden in child class<BR></FONT></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> FetchChildren(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> criteria </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> cn </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IDbConnection)<BR></FONT><FONT color=#008000 size=2>'marker method that can be overridden in child class<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P>
<P>#End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P>
<P>#Region</FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2>" DataPortal_Insert "</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> DataPortal_Insert()<BR></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> tr </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IDbTransaction = </FONT><FONT color=#0000ff size=2>Nothing<BR></FONT><FONT color=#0000ff size=2>Try<BR></FONT><FONT size=2>tr = </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.BeginTransaction()<BR>DoInsert(tr)<BR></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.EndTransaction(tr)<BR></FONT><FONT color=#0000ff size=2>Catch</FONT><FONT size=2> ex </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Exception<BR></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.RollbackTransaction(tr)<BR></FONT><FONT color=#0000ff size=2>Throw<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Try<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> DoInsert(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> tr </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IDbTransaction)</P>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> user </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> MyUser<BR>user = </FONT><FONT color=#0000ff size=2>DirectCast</FONT><FONT size=2>(Thread.CurrentPrincipal, MyUser)<BR>InsertData(tr, user)<BR>PostInsertData(tr, user)<BR>UpdateChildren(tr)<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> InsertData(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> tr </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IDbTransaction, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> user </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> MyUser)<BR>DAL.ExecuteNonQuery(tr, CommandType.Text, CostcenterDAO.Insert(mCostcode</FONT><FONT size=2>, mCcname</FONT><FONT size=2>, mStatus</FONT><FONT size=2>, user.Userkey))<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> PostInsertData(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> tr </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IDbTransaction, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> user </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> MyUser)<BR></FONT><FONT color=#008000 size=2>'marker method that can be overridden in child class<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> UpdateChildren(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> tr </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IDbTransaction)<BR></FONT><FONT color=#008000 size=2>'marker method that can be overridden in child class<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P>
<P>#End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P>
<P>#Region</FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2>" DataPortal_Update "</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> DataPortal_Update()<BR></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> tr </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IDbTransaction = </FONT><FONT color=#0000ff size=2>Nothing<BR></FONT><FONT color=#0000ff size=2>Try<BR></FONT><FONT size=2>tr = </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.BeginTransaction()<BR>DoUpdate(tr)<BR></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.EndTransaction(tr)<BR></FONT><FONT color=#0000ff size=2>Catch</FONT><FONT size=2> ex </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Exception<BR></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.RollbackTransaction(tr)<BR></FONT><FONT color=#0000ff size=2>Throw<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Try<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> DoUpdate(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> tr </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IDbTransaction)</P>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> user </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> MyUser<BR>user = </FONT><FONT color=#0000ff size=2>DirectCast</FONT><FONT size=2>(Thread.CurrentPrincipal, MyUser)<BR>UpdateData(tr, user)<BR>PostUpdateData(tr, user)<BR>UpdateChildren(tr)<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> UpdateData(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> tr </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IDbTransaction, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> user </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> MyUser)<BR></FONT><FONT size=2>DAL.ExecuteNonQuery(tr, CommandType.Text, CostcenterDAO.Update(mCostcode</FONT><FONT size=2>, mCcname</FONT><FONT size=2>, mStatus</FONT><FONT size=2>, user.Userkey))<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> PostUpdateData(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> tr </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IDbTransaction, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> user </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> MyUser)<BR></FONT><FONT color=#008000 size=2>'marker method that can be overridden in child class<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P>
<P>#End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P>
<P>#Region</FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2>" DataPortal_Delete "</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> DataPortal_DeleteSelf()<BR>DataPortal_Delete(</FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> CriteriaCode(</FONT><FONT color=#0000ff size=2>GetType</FONT><FONT size=2>(Costcenter), </FONT><FONT color=#ff00ff size=2>"DataPortal_DeleteSelf"</FONT><FONT size=2>, mCostcode))<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> DataPortal_Delete(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> criteria </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> user </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> MyUser<BR>user = </FONT><FONT color=#0000ff size=2>DirectCast</FONT><FONT size=2>(Thread.CurrentPrincipal, MyUser)<BR></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> strSQL </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>TypeOf</FONT><FONT size=2> criteria </FONT><FONT color=#0000ff size=2>Is</FONT><FONT size=2> CriteriaCode </FONT><FONT color=#0000ff size=2>Then<BR></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> crit </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> CriteriaCode = </FONT><FONT color=#0000ff size=2>DirectCast</FONT><FONT size=2>(criteria, CriteriaCode)<BR>strSQL = CostcenterDAO.Delete(crit.Code)<BR></FONT><FONT color=#0000ff size=2>Else<BR></FONT><FONT color=#0000ff size=2>Throw</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> ApplicationException(</FONT><FONT color=#ff00ff size=2>"Invalid criteria passed to DataPortal_Delete method."</FONT><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> tr </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IDbTransaction = </FONT><FONT color=#0000ff size=2>Nothing</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Try<BR></FONT><FONT size=2>tr = </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.BeginTransaction()<BR></FONT><FONT color=#008000 size=2>'Delete child objects before deleting the parent. <BR></FONT><FONT size=2>DeleteChildren(tr, criteria)<BR></FONT><FONT color=#008000 size=2>'delete the parent<BR></FONT><FONT size=2>DAL.ExecuteNonQuery(tr, CommandType.Text, strSQL)<BR>PostDeleteData(tr, user)<BR></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.EndTransaction(tr)<BR></FONT><FONT color=#0000ff size=2>Catch</FONT><FONT size=2> ex </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Exception<BR></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.RollbackTransaction(tr)<BR></FONT><FONT color=#0000ff size=2>Throw<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Try<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> DeleteChildren(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> tr </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IDbTransaction, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> criteria </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>)<BR></FONT><FONT color=#008000 size=2>'marker method that can be overridden in child class<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> PostDeleteData(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> tr </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IDbTransaction, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> user </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> MyUser)<BR></FONT><FONT color=#008000 size=2>'marker method that can be overridden in child class<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P>
<P>#End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P>
<P>#End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</P>
<P></FONT>=================================================================</P>
<P>Rather than embed Criteria objects inside each BO, I put them in their own namepsace and then re-use them.</P>
<P>e.g. This is the criteria class used above:</P><FONT size=2>
<P>&lt;Serializable()&gt; _<BR></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> CriteriaCode<BR></FONT><FONT color=#0000ff size=2>&nbsp; Inherits</FONT><FONT size=2> Csla.CriteriaBase<BR><BR></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> MethodName </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#ff00ff size=2>""<BR></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> Code </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#ff00ff size=2>""</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> BOtype </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Type, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> methodName </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> code </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2>&nbsp; MyBase</FONT><FONT size=2>.New(BOtype)<BR></FONT><FONT color=#0000ff size=2>&nbsp; Me</FONT><FONT size=2>.MethodName = methodName<BR></FONT><FONT color=#0000ff size=2>&nbsp; Me</FONT><FONT size=2>.Code = code<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub<BR><BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</P></FONT>
<P>=================================================================</P>
<P>The custom code is then placed in a class which inherits the root class above. Notice how little code goes in the custom level. The idea is to code gen as much as needed.</P>
<P>Like this:</P><FONT size=2>
<P>&lt;Serializable()&gt; _<BR></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2>&nbsp;</FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> Costcenter<BR></FONT><FONT color=#0000ff size=2>&nbsp; Inherits</FONT><FONT size=2> CostcenterGen</FONT></P><FONT color=#0000ff size=2>
<P>#Region</FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2>" Validation Rules "</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> AddBusinessRules()<BR>&nbsp; </FONT><FONT color=#0000ff size=2>MyBase</FONT><FONT size=2>.AddBusinessRules()<BR></FONT><FONT size=2><FONT color=#008000 size=2><BR>'SomeCode<BR></FONT><FONT size=2>ValidationRules.AddRule(</FONT><FONT color=#0000ff size=2>AddressOf</FONT><FONT size=2> RecordExists, </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> RecordExistsRuleArgs(</FONT><FONT color=#ff00ff size=2>"SomeCode"</FONT><FONT size=2>, </FONT><FONT color=#ff00ff size=2>"xyz"</FONT><FONT size=2>, </FONT><FONT color=#ff00ff size=2>""</FONT><FONT size=2>), 1)<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub<BR></FONT></FONT><FONT size=2><BR></FONT><FONT size=2>#<FONT color=#0000ff size=2>End Region</FONT></P></FONT>
<P><FONT color=#0000ff size=2>#Region</FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2>" Data Access "</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> SetDefaults()<BR>&nbsp; </FONT><FONT color=#0000ff size=2>MyBase</FONT><FONT size=2>.SetDefaults()<BR>&nbsp; mStatus = </FONT><FONT color=#ff00ff size=2>"A"<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P>
<P>#End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Region</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</P></FONT>
<P>&nbsp;</P>
<P>HTH<BR>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Pieter replied on Wednesday, June 11, 2008</h2>Thanks for this Joe.<br><br>When generating the base class and partial class using the codesmith templates, both classes contain the Data access code. I'm not sure which one to remove?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, June 11, 2008</h2><P>Well, your original question does not match your original thread title.</P>
<P>There is a big difference between having a Base class which you inherit from and 2 partial classes where one is code gened and the other is hand written.</P>
<P>You asked about Base classes and inheritance which is the example I gave you.</P>
<P>I do not use partial classes. They have their own set of issues you need to resolve - like the inability to have the same method name twice. e.g. no overriding. There are ways around that issue but I am no expert on it.</P>
<P>I built my own codesmith templates (a long time ago) and can code gen a huge amount of my BOs and as you can see when I inherit from them there is almost no code in the derived class.</P>
<P>You are going to have to figure out which style you will use and then you can decide which pieces of code to "remove".</P>
<P>Joe</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
