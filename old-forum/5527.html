<html><header><title>error: 40 hell</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>error: 40 hell</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5527.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>eulerthegrape posted on Friday, October 03, 2008</h2>I have been working with two .mdf local database files for over a month.&nbsp; Today, when I tried to open the database in Visual Studio's Server Explorer, it balked at me and threw a error: 40 at me.&nbsp; The whole message says:<br><br>An error has occurred while establishing a connection to the server.&nbsp; When connection to SQL Server 2005, this failure may be cause by the fact that under the default settings SQL Sever does not allow remote connections. (provider: shared memory provider error: 40 - could not open a connection to SQL Sever)<br><br>Now this happened to me once before when I was moving files and, if I remember correctly it had something to do with a configuration file.<br><br>I have two app.config files in three projects one in a database project:<br>app.config<br>&lt;?xml version="1.0" encoding="utf-8" ?&gt;<br>&lt;configuration&gt;<br>&nbsp;&nbsp;&nbsp; &lt;configSections&gt;<br>&nbsp;&nbsp;&nbsp; &lt;/configSections&gt;<br>&nbsp;&nbsp;&nbsp; &lt;connectionStrings&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;add name="CasasDB.Properties.Settings.CasasConnectionString"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; connectionString="Data Source=.\SQLEXPRESS;AttachDbFilename='|DataDirectory|\Casas.mdf';Integrated Security=True;User Instance=True"<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; providerName="System.Data.SqlClient" /&gt;<br>&nbsp;&nbsp;&nbsp; &lt;/connectionStrings&gt;<br>&lt;/configuration&gt;<br><br>and the other a prject containing forms<br><br>&lt;?xml version="1.0" encoding="utf-8" ?&gt;<br>&lt;configuration&gt;<br>&nbsp; &lt;configSections&gt;<br>&nbsp;&nbsp;&nbsp; &lt;sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=14037268209d3bd5" &gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;section name="Csla.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=14037268209d3bd5" /&gt;<br>&nbsp;&nbsp;&nbsp; &lt;/sectionGroup&gt;<br>&nbsp; &lt;/configSections&gt;<br>&nbsp; &lt;appSettings&gt;<br>&nbsp;&nbsp;&nbsp; &lt;add key="CslaAuthentication" value="Csla"/&gt;<br>&nbsp; &lt;/appSettings&gt;<br>&nbsp; &lt;connectionStrings&gt;<br>&nbsp;&nbsp;&nbsp; &lt;add name="Casas" connectionString="Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\Casas.mdf;Integrated Security=True;User Instance=True" /&gt;<br>&nbsp;&nbsp;&nbsp; &lt;add name="Security" connectionString="Data Source=.\SQLEXPRESS;AttachDbFilename=|DataDirectory|\Security.mdf;Integrated Security=True;User Instance=True" /&gt;<br>&nbsp; &lt;/connectionStrings&gt;<br>&lt;/configuration&gt;<br><br>Currently I cannot create a new database let alone access the ones that already exist.<br><br>I think there is something else screwy with my work station because it's been acting wonky and there seems to be no rhyme or reason why, all of a sudden, I wouldn't be able to access these databases.<br><br>Any suggestions?&nbsp; Is the a problem with a setting in Visual Studio or a config problem or something I haven't mentioned perhaps?<br><br>Thank you,<br>euler<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>eulerthegrape replied on Friday, October 03, 2008</h2>Well, I started up the SQL Server (SQLEXPRESS) service in the SQL Server Configuration Manager and that allowed me to access the database from the server explorer.&nbsp; This is weird because I never had to start this process in the past.&nbsp; Unfortunately, I now see the following error:<br><br>DataPortal.Fetch failed (An attempt to attach an auto-named database for file [filepath]\Database.mdf failed. A database with the same name exists, or specified file cannot be opened, or it is located on UNC share.)<br><br>Thanks in advance for any help<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>eulerthegrape replied on Friday, October 03, 2008</h2>Ok.&nbsp; I changed the app.config file so that it is the explicit file path and this has solved the issue.&nbsp; Although, now I'm not using |DataDirectory|, which I would like to.&nbsp; It also doesn't answer why the SQL Express process needed to be started in the Configuration Manager.<br><br>Has anyone else seen these issues?<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
