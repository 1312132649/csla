<html><header><title>Silverlight paging</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Silverlight paging</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7392.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>James Thomas posted on Tuesday, August 04, 2009</h2>Hi,<br><br>Are there any examples of paging using CslaDataProviders that someone can point me to? I don't need anything particularly complex - and can handle the SQL of paging within the database, so am really interested in the business object - UI layers. I'm looking enviously at some of the solutions available using the DataPager and RIA, and wonder whether CSLA can do something similar. e.g.:<br><br>http://blogs.telerik.com/vladimirenchev/posts/09-04-16/full_support_for_domaindatasource_with_radgridview_for_silverlight_3.aspx<br><br>(Apparently the DataPager uses something called the IPagedViewCollection interface, but I can't see this documented anywhere.)<br><br>Thanks for any pointers.<br><br>James.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, August 05, 2009</h2><P>This isn't an area I've had time to explore yet.</P>
<P>However, keeping in mind that we're dealing with an n-tier world, the solution must be generally the same as what I did in ASP.NET.</P>
<P>In other words, the UI provides some set of information - at least the page number and page size - through some mechanism, perhaps the IPagedViewCollection interface.</P>
<P>When the UI wants another page it calls a method of some sort. That method must take the page number and page size and pass them to a static factory method on the object to get the next page. The page number and page size become criteria, and are often passed through the data portal to the server so the DAL can retrieve the right page.</P>
<P>Presumably the IPagedViewCollection concept is n-tier and async aware, since this operation will be async regardless of what technology is used - all server calls in SL are async.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mbblum replied on Wednesday, August 05, 2009</h2>Paged CSLA objects are not that difficult. In the past I built them using stored procs. Now you can probably use LINQ.<br /><br />Here is a summary of the steps I used with sproc in SQL Server.<br />For the sproc params, included the following:<br />	@PageNum INT = 1, <br />	@PerPage INT = 25,<br />	@CurrentPage INT OUT, <br />	@TotalPages INT OUT,<br />	@TotalRows INT OUT<br /><br />Within the sproc here are some key SQL:<br /><br />declare @RowsToRetrieve int<br /><br />	SELECT @TotalRows = count(*)<br />	 from table <br />	 where {same conditions as actual search}<br /><br />	set @TotalPages = @TotalRows/@PerPage<br /><br />	if @PageNum &amp;lt; 1<br />		set @PageNum = 1<br /><br />	if @TotalRows % @PerPage != 0<br />		set @TotalPages = @TotalPages + 1<br />	        <br />	set @RowsToRetrieve = @PerPage * @PageNum<br />	set @CurrentPage = @PageNum<br /><br />	WITH SearchResults AS<br />	(<br />		Select E.EventID<br />		{... other columns}<br />		, ROW_NUMBER() OVER(order by D.LastName, D.FirstName, D.MiddleName) 'RowNum'<br />		 from table <br />		 where {actual search}<br />	)<br />		Select SR.EventID<br />		{... other columns}<br />--		, SR.RowNum<br />		FROM SearchResults SR<br />		WHERE SR.RowNum > @RowsToRetrieve - @PerPage<br />		AND SR.RowNum &amp;lt;= @RowsToRetrieve<br /><br />As you should see, using WITH and ROW_NUMBER() is important in this approach.<br /><br />The paging information is in properties of the collection or list object, read the OUT parameters to get the values. Populate the business objects as usual for a collection. Including SR.RowNum in the results was useful during development to see what was happening, but did not need in my final output.<br /><br />This limits network traffic to specified number of rows. Trade off is for complex searches, it could put a significant load on the database server. <br /><br />This is one approach that works with CSLA, but certainly not the only one.<br /><br />Hope that is helpful.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>James Thomas replied on Wednesday, July 07, 2010</h2><p>Yes - very useful. And sorry for the slow answer!</p>
<p>Thanks, James.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, July 07, 2010</h2><p>There&#39;s also the PagedList sample in CslaLight\cs that shows how to do an async paged list - and while it is a SL sample, the same technique should work on WPF and WinForms too.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>James Thomas replied on Tuesday, July 20, 2010</h2><p>Hi Rocky,</p>
<p>Thanks for your answer. I can&#39;t see the PagedList sample though - is it called something else (or has been removed)?</p>
<p>Thanks, James.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, July 20, 2010</h2><p>I think I wrote it for CSLA 4 - it may not be in earlier versions - though the concepts should work in 3.8 as well.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>James Thomas replied on Thursday, July 22, 2010</h2><p>Thanks - got it now - useful to see a clean implementation like this.</p>
<p>Have you considered implementing IPagedCollectionView into a base list object? I&#39;m currently working on a poor implementation of this in order to take advantage of Silverlight controls such as the DataPager, so I&#39;m sure others will be needing similar functionality.</p>
<p>James.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, July 22, 2010</h2><p>I hesitate to add too much into core CSLA, since I am not confident that Microsoft won&#39;t come along with a solution or interface as part of .NET/SL. I&#39;d hate to take people down one road and then have Msft move in a different direction.</p>
<p>It was an easy choice to embed some support for Web Forms, because Msft did define a model in that space. But since there&#39;s no formal model elsewhere yet, it is better to keep the implementations out of core CSLA I think.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>James Thomas replied on Sunday, July 25, 2010</h2><p>Yes, I can see that makes sense (!). I guess I was assuming it came under the same category as implementing INotifyCollectionChanged (which we couldn&#39;t do without). I&#39;ve hacked a solution together (that works <img src="http://forums.lhotka.net/emoticons/emotion-1.gif" alt="Smile" />), but would have found things much simpler if IPagedCollectionView had also been part of CSLA. Something to keep an eye on maybe, if more 3rd party visual components emerge that assume these interfaces are implemented?</p>
<p>Best wishes, James.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, July 26, 2010</h2><p>The thing with IPagedCollectionView is that it is a view construct. It isn&#39;t the kind of interface BLB would implement, for example.</p>
<p>Which isn&#39;t to say it couldn&#39;t somehow be part of CSLA - perhaps kind of like the CSLA 4 LinqObservableCollection or something like that.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>James Thomas replied on Tuesday, July 27, 2010</h2><p>Makes sense. At least there&#39;s a thread on the subject now for other people searching for PagedCollectionView <img src="http://forums.lhotka.net/emoticons/emotion-1.gif" alt="Smile" /></p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
