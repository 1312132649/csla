<html><header><title>CSLA 4.5.2 beta and async DataPortal_Fetch with Silverlight5</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA 4.5.2 beta and async DataPortal_Fetch with Silverlight5</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11604.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Curelom posted on Thursday, September 27, 2012</h2><p>I&#39;m trying out the new beta and I&#39;m getting a DataPortal.Fetch not found.&nbsp; What could I be doing wrong?</p>
<p>I&#39;m calling my BL (BannerList) with </p>
<p>&nbsp;</p>
<p><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><font face="Consolas" size="2" color="#0000ff"><font face="Consolas" size="2" color="#0000ff"><font face="Consolas" size="2" color="#0000ff">
<p>var</p>
</font></font></font></span><font face="Consolas" size="2" color="#0000ff"><font face="Consolas" size="2" color="#0000ff">
<p>&nbsp;</p>
</font></font></span><font face="Consolas" size="2" color="#0000ff">
<p>&nbsp;</p>
</font></span></p>
<p><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> obj = </span></span><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;">await</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> </span></span><span style="font-size:x-small;font-family:Consolas;color:#2b91af;"><span style="font-size:x-small;font-family:Consolas;color:#2b91af;"><span style="font-size:x-small;font-family:Consolas;color:#2b91af;">BannerList</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">.GetAll();</span></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>In my BL&nbsp;I&#39;m calling below</p>
<p>&nbsp;<span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;">public</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> </span></span><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;">static</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> </span></span><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;">async</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> </span></span><span style="font-size:x-small;font-family:Consolas;color:#2b91af;"><span style="font-size:x-small;font-family:Consolas;color:#2b91af;"><span style="font-size:x-small;font-family:Consolas;color:#2b91af;">Task</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">&lt;</span></span><span style="font-size:x-small;font-family:Consolas;color:#2b91af;"><span style="font-size:x-small;font-family:Consolas;color:#2b91af;"><span style="font-size:x-small;font-family:Consolas;color:#2b91af;">BannerList</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">&gt; GetAll() {<font face="Consolas" size="2"><font face="Consolas" size="2">
<p>&nbsp;</p>
</font></font></span><font face="Consolas" size="2">
<p>&nbsp;</p>
</font></span></p>
<p>&nbsp;</p>
<p><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;">var</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> task = </span></span><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;">await</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> </span></span><span style="font-size:x-small;font-family:Consolas;color:#2b91af;"><span style="font-size:x-small;font-family:Consolas;color:#2b91af;"><span style="font-size:x-small;font-family:Consolas;color:#2b91af;">DataPortal</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">.FetchAsync&lt;</span></span><span style="font-size:x-small;font-family:Consolas;color:#2b91af;"><span style="font-size:x-small;font-family:Consolas;color:#2b91af;"><span style="font-size:x-small;font-family:Consolas;color:#2b91af;">BannerList</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">&gt;();<font face="Consolas" size="2"><font face="Consolas" size="2">
<p>&nbsp;</p>
</font></font></span><font face="Consolas" size="2">
<p>&nbsp;</p>
</font></span></p>
<p>&nbsp;</p>
<p><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;">return</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> task;</span></span></p>
<p>}</p>
<p>My DataPortal Fetch looks like this</p>
<p>&nbsp;</p>
<p><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;">protected</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> </span></span><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;">async</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> </span></span><span style="font-size:x-small;font-family:Consolas;color:#2b91af;"><span style="font-size:x-small;font-family:Consolas;color:#2b91af;"><span style="font-size:x-small;font-family:Consolas;color:#2b91af;">Task</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> DataPortal_Fetch(){<font face="Consolas" size="2"><font face="Consolas" size="2">
<p>&nbsp;</p>
</font></font></span><font face="Consolas" size="2">
<p>&nbsp;</p>
</font></span></p>
<p>&nbsp;</p>
<p><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;">&nbsp; using</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> (</span></span><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;">var</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> ctx = Csla.Data.</span></span><span style="font-size:x-small;font-family:Consolas;color:#2b91af;"><span style="font-size:x-small;font-family:Consolas;color:#2b91af;"><span style="font-size:x-small;font-family:Consolas;color:#2b91af;">ObjectContextManager</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">&lt;CmsLibrary.Data.</span></span><span style="font-size:x-small;font-family:Consolas;color:#2b91af;"><span style="font-size:x-small;font-family:Consolas;color:#2b91af;"><span style="font-size:x-small;font-family:Consolas;color:#2b91af;">CmsModelContainer</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">&gt;.GetManager(CmsModel.</span></span><span style="font-size:x-small;font-family:Consolas;color:#2b91af;"><span style="font-size:x-small;font-family:Consolas;color:#2b91af;"><span style="font-size:x-small;font-family:Consolas;color:#2b91af;">CmsModelContainerDatabase</span></span></span> <span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">.Name)) {<font face="Consolas" size="2"><font face="Consolas" size="2">
<p>&nbsp;</p>
</font></font></span><font face="Consolas" size="2">
<p>&nbsp;</p>
</font></span></p>
<p>&nbsp;</p>
<p><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;">&nbsp;&nbsp; var </span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">data = ctx.ObjectContext.Banners.AsEnumerable();</span></span></p>
<p><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">&nbsp;&nbsp; ReadData(data);</span></span></p>
<p><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">&nbsp; }</span></span></p>
<p><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">}</span></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, September 27, 2012</h2><p>Try returning Task&lt;BannerList&gt; from DataPortal_Fetch</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, September 27, 2012</h2><p>I don&#39;t see a problem with the code, other than you&#39;ll get a compile warning because you have an async method without using an await statement inside. Given your current code there is no reason for the DayaPortal_Fetch method to be async...</p>
<p>What are the client and server platforms?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, September 27, 2012</h2><p>A nitpick, but I thought I&#39;d point it out anyway. When you await FetchAsync you don&#39;t get back a task, you get back a T. In other words, you get back the business object you are requesting.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Curelom replied on Friday, September 28, 2012</h2><p>Please nitpick <img src="http://forums.lhotka.net/emoticons/emotion-5.gif" alt="Wink" />&nbsp; Get&#39;s me better code.</p>
<p>I&#39;ve found the one problem was me not setting ProxyTypeName.&nbsp; Now I get a different error.&nbsp; Object reference not set to an instance of an object.</p>
<p>I&#39;m digging through the Data Portal eBook to make sure I&#39;ve got all my configs right.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, September 28, 2012</h2><p>Well there is that...</p>
<p>The configuration settings are changed quite a lot for SL in 4.5.2. I talked about this somewhat in a recent blog post.</p>
<p>Most notably, all namespaces like Csla.Server.Hosts.Silverlight are now Csla.Server.Hosts.Mobile - replace &quot;Silverlight&quot; with &quot;Mobile&quot; on client and server types.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>bill.mybiz replied on Sunday, November 25, 2012</h2><p>Yooooooooooo Curelom, did you ever resolve this? I also am having the same problem. I&#39;ve migrated my SL 4/.Net 4.0 code to SL 5/.Net 4.5. I&#39;ve spent several days doing a ton of the async/await changes, including the one mentioned by Rocky with the namespace changes. Also, btw for anyone else out there, I had to take out the generic in WcfProxy definition used in the compressed proxy, so CompressedProxy/*&lt;T&gt;*/ : Csla.DataPortalClient.WcfProxy//&lt;T&gt;. </p>
<p>So anyway, I&#39;ve finally gotten my code to compile with the new awesomeness that is async/await combined with Csla&#39;s awesomeness!!! Awww yeah, that&#39;s a whole lotta awesome. And now, when I&#39;m sending the async login call with the new async stuff, however, it&#39;s not reaching the server. It&#39;s giving me the classic &quot;Object reference not set to an instance of an object.&quot; which I thought had to do with the config of the portal. Is there anything else you did to change the config in your migration?</p>
<p><br />Thanksssss!</p>
<p><br />Bill Raiford</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>bill.mybiz replied on Sunday, November 25, 2012</h2><p>Thought I&#39;d throw in the code that pertains to this as well. This code used to work with the callbacks. Perhaps it is an IIS configuration problem? (I&#39;ve moved also from Vista 32-bit to Win8 64-bit if that makes a difference.) I&#39;m still chugging away at it myself, but I thought if you got any headway, that you might help this mayn out. Thanks!</p>
<p>(all code at: https://github.com/bill-mybiz/LearnLanguages)</p>
<p>UserIdentity retIdentity = null;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var criteria = new UsernameCriteria(username, clearUnsaltedPassword);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; retIdentity = await DataPortal.FetchAsync&lt;UserIdentity&gt;(criteria);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Services.PublishMessageEvent(ex.Message, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Common.MessagePriority.High, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Common.MessageType.Error);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; retIdentity = null;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;</p>
<p>And here is the data portal code:</p>
<p>private void DataPortal_Fetch(UsernameCriteria criteria)<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AuthenticationType = DalResources.AuthenticationTypeString;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using (var dalManager = DataAccess.DalFactory.GetDalManager())<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var dal = dalManager.GetProvider&lt;IUserDal&gt;();<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var verifyResult = dal.VerifyUser(criteria.Username, criteria.Password);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!verifyResult.IsSuccess)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Exception error = verifyResult.GetExceptionFromInfo();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (error != null)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw error;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw new FetchFailedException(verifyResult.Msg);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bool? userIsVerified = verifyResult.Obj;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (userIsVerified == null)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; userIsVerified = false;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (userIsVerified == true)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LoadUserData(criteria.Username, dal);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; }</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>bill.mybiz replied on Sunday, November 25, 2012</h2><p>Just an update. I&#39;ve determined that I didn&#39;t update my web.config and SlPortal.svc files appropriately in the host project. Correcting that, using the 4.5 ProjectTracker&#39;s versions of these files as guidance, I&#39;ve gotten past the not set to an instance error message and now I&#39;m in it with a different one that has me stumbling as well. I&#39;m just posting for anyone else also migrating from 4 to 4.5 as well. </p>
<p><br />The current error I&#39;m getting is Csla.DataPortalException was caught<br />&nbsp; Message=Non-negative number required.<br />Parameter name: count<br />&nbsp; StackTrace:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccess(Task task)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd(Task task)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; at LearnLanguages.Business.Security.UserIdentity.&lt;GetUserIdentityAsync&gt;d__0.MoveNext()<br />&nbsp; InnerException:</p>
<p>That&#39;s all that copy exception detail to clipboard copies nowadays. I don&#39;t know why it doesn&#39;t include the inner exception anymore. Maybe a config setting somewhere that I couldn&#39;t find...hmmm <img src="http://forums.lhotka.net/emoticons/emotion-4.gif" alt="Stick out tongue" />. Anyyyyyyyway. Non-negative number required. Seems to be related to await. This still is not reaching the server side of things, so I&#39;m stinking it&#39;s still a configuration problem.</p>
<p>&nbsp;</p>
<p><br />PS: Here is some of the inner exception detail:</p>
<p>&nbsp;&nbsp; at System.IO.BinaryReader.ReadChars(Int32 count)<br />&nbsp;&nbsp; at Csla.Serialization.Mobile.CslaBinaryReader.ReadObject(BinaryReader reader) in c:\Users\Rockford\Documents\Visual Studio 2012\Projects\csla\trunk\Source\Csla\Serialization\Mobile\CslaBinaryReader.cs:line 123<br />&nbsp;&nbsp; at Csla.Serialization.Mobile.CslaBinaryReader.Read(Stream serializationStream) in c:\Users\Rockford\Documents\Visual Studio 2012\Projects\csla\trunk\Source\Csla\Serialization\Mobile\CslaBinaryReader.cs:line 46<br />&nbsp;&nbsp; at Csla.Serialization.Mobile.MobileFormatter.Deserialize(Stream serializationStream) in c:\Users\Rockford\Documents\Visual Studio 2012\Projects\csla\trunk\Source\Csla\Serialization\Mobile\MobileFormatter.cs:line 216<br />&nbsp;&nbsp; at Csla.Serialization.Mobile.MobileFormatter.Deserialize(Byte[] data) in c:\Users\Rockford\Documents\Visual Studio 2012\Projects\csla\trunk\Source\Csla\Serialization\Mobile\MobileFormatter.cs:line 375<br />&nbsp;&nbsp; at Csla.Server.Hosts.Mobile.WcfPortal.Fetch(CriteriaRequest request) in c:\Users\Rockford\Documents\Visual Studio 2012\Projects\csla\trunk\Source\Csla\Server\Hosts\Mobile\WcfPortal.cs:line 97</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>bill.mybiz replied on Monday, November 26, 2012</h2><p>One more piece of info: When I change between Local IIS Web server and Visual Studio Development Server, I get the same error: Non-negative number required. Parameter name count. So, maybe it isn&#39;t IIS. </p>
<p>I also tried removing all references to csla and async targeting via dlls, and instead using nuget manager in order to debug inside csla. It turns out it is actually being thrown in System.ServiceModel.Activation.HostedHttpTransportManager in the HttpContextReceived method at the line:</p>
<p>IAsyncResult httpContextReceivedResult = listener.BeginHttpContextReceived(hostedContext, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; null,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; onHttpContextReceived, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; state);</p>
<p>&nbsp;</p>
<p>I can&#39;t read what any of the values are, as they are being optimized out of scope of the debugger, but the error is occurring here, which again makes me think it&#39;s some kind of wcf config error. </p>
<p>Does anyone out there in the whole wide web of worlds have any clue what&#39;s up here? Curelom, did you find an answer for your problem? I&#39;m banging my head against the wall on this one. <img src="http://forums.lhotka.net/emoticons/emotion-9.gif" alt="Crying" /></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Curelom replied on Tuesday, November 27, 2012</h2><p>Sorry for the late reply.&nbsp; Wasn&#39;t able to log in to this site.&nbsp; I was finally able to get in by using Firefox instead of IE10.&nbsp; </p>
<p>All I did was change my configurations on the host and server down to the most basic configuration possible and it worked.&nbsp; Been working on other projects lately and haven&#39;t been able to look into this further.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>bill.mybiz replied on Tuesday, November 27, 2012</h2><p>Well, I renamed my WcfPortal.svc and SlPortal.svc files, as well as my web.config. I then copied those files from the ProjectTracker sample, only editing the Dal implementation values in the appSettings section. I have a mock Dal, so I didn&#39;t even change the connection string settings. I renamed (removed from the equation) my ServiceReferences.ClientConfig, which I had from what I remember because of something to do with Wcf failing for security reasons (though I don&#39;t remember offhand what those were, maybe something to do with allowing cross-site scripting). Anyway, I took that out at the SL side, and I ran the program again. Same error at the same call as mentioned previously.</p>
<p><br />At this point, I&#39;m going to start a new project, and see if I can get the simplest Csla app going from scratch. I&#39;m avoiding upgrading from anything vs 2010/net 4.0/sl 4 project, as I already have my own barebones simple app at my github site (for an example for anyone wanting to mix csla and caliburn). So, I&#39;m going to do that again, only now with Windows 8, Csla 4.5, SL 5, .NET 4.5. If it works, I&#39;ll probably then throw Caliburn Micro 1.3.1 into the mix.</p>
<p>Any info about this error would be much appreciated in the meantime.</p>
<p>And thanks for your reply Curelom! I know it&#39;s tough working on lots of projects at once. I code in mostly Delphi at work, then I come home and work on my baby ;)</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, November 27, 2012</h2><p>Bill, I assume you are not still using the beta code, but are using the 4.5.10 release code?</p>
<p>There were a bunch of bugs in the beta code, so if you are still using that then there&#39;s little I can say but to upgrade to the release version.</p>
<p>I think your idea of starting with a simple app is smart. That should help eliminate environmental or basic configuration/install issues.</p>
<p>The SampleApp and SimpleNTier and ProjectTracker apps all have Silverlight clients calling app servers, so I&#39;m pretty confident that the data portal works. There are a couple known bugs that will be fixed in the next release, but they don&#39;t have the effects you are describing.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>bill.mybiz replied on Thursday, November 29, 2012</h2><p>Quick post before bed: </p>
<p><br />In app startup (MefBootstrapper for myself, using Caliburn), I had to add the following line:</p>
<p>Csla.ApplicationContext.DataPortalProxy = <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; typeof(Csla.DataPortalClient.WcfProxy).AssemblyQualifiedName;</p>
<p>Without this line, it gives me the horrific Non-Negative Number of Voodoo Required. I didn&#39;t used to have this line in there, and I don&#39;t really know what it does. I&#39;m really tired (as I am a lot of time working on this project hehe), so I&#39;m gonna look at this tomorrow some more. But for anyone else out there migrating up to the 4.5 async/await stuff with the aforementioned error of doom: try adding this and see if it helps.</p>
<p>Bill Raiford</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, November 27, 2012</h2><p>(the latest IE10 update does appear to have stopped working with the forum site - sadly there&#39;s not a lot I can do because the forum software is old and now unsupported - so I think in 2013 I&#39;ll have to look at migrating us all to some new forum software...)</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
