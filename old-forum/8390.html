<html><header><title>Dynamic list retrieve</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Dynamic list retrieve</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8390.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Calin posted on Thursday, January 21, 2010</h2>Hi,<br /><br /> Imagine a form with 3 comboboxes, each combo gets populated by a DataProvider. Now based on the selection on the first combo the elements in the next 2 might change.<br /><br /> As a specific example. The first combo is a list of institutions, the second combo is a list of available departments of a institution. When selecting a institution I need the second combo to bring only the departments specific to that institution.<br /><br /> Now the classic Instituion has a collection of deparments approach does not work because I have a bunch of institutions and many departments on each. What I need to do is when I select a institution the DataProvider of the deparments combo should go back and fetch the departments with the new institution id.<br /><br /> Is there a way to do this ?<br /><br />Regards,</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fintanv replied on Thursday, January 21, 2010</h2>I do this by having the lists (read only collections) exposed by a use case level root business object.  The root object also has the properties required for the retrieval of the main business object (which is exposed as a child property of the root business object).  The selection of a value from a combo will update the property in the business object.  This will trigger the (re-)selection of dependant lists bound to the other combos.  Since the changed list has changed, I get a property changed notification.  Since I am using WPF this works very nicely as I get a re-binding of the combo.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fele replied on Thursday, January 21, 2010</h2>I will refresh other combobox's each time user change selection:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CslaDataProvider factoriesProvider = this.Resources["Cbo1Data"] as CslaDataProvider;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; factoriesProvider.FactoryParameters.Clear();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;&lt;specify FactoryParamters&gt;&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; factoriesProvider.FactoryMethod = "GetDataForCbo1";<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; factoriesProvider.Refresh();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CslaDataProvider factoriesProvider = this.Resources["Cbo2Data"] as CslaDataProvider;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; factoriesProvider.FactoryParameters.Clear();<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;&lt;specify FactoryParamters&gt;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; factoriesProvider.FactoryMethod = "GetDataForCbo2";<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; factoriesProvider.Refresh();<br><br>Fele<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Calin replied on Thursday, January 21, 2010</h2>Thanks for the reply Fele,<br /><br /> By looks of it this code sits in a event on the view, unfortunately I don't like this approach to much I am using wpf and MVVM and this does not really fall in this pattern.<br /><br /> It will really help if I could bind the FactoryParameters.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fele replied on Thursday, January 21, 2010</h2>Calin,<br>If you figure it out let me know. I have exactly the same issue in Silverlight.<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>marthac replied on Monday, September 13, 2010</h2><p>Did you ever figure out how to do this in Silverlight using the CslaDataProvider?</p>
<p>I have a CslaDataProvider defined for my grid data and a CslaDataProvider for each combo (NameValueLists)<br />For the first combo, I have a SelectionChanged event handler and in there I&#39;m calling the factory method to load a second combo data using the selected value from the first. <br />It loads the second combo values just fine, but the&nbsp;grid data value&nbsp;bound to the&nbsp;combo&nbsp;is not displayed in it. <br />I have tried calling Rebind on the grid CslaDataProvider and it does cause the selection to be shown in the second combo, but it clears the selection in the first combo.</p>
<p>Can anyone explain how to do this?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, September 13, 2010</h2><p>You might be hitting a timing issue, since all three data providers will do independent async server calls.</p>
<p>To avoid this, you might need to use the <i>unit of work</i> pattern and have one data provider make the server call. I don&#39;t remember if I enabled &quot;chaining&quot; of data providers, but I think I did - so you could have (basically) four providers:</p>
<ol>
<li>UOWProvider - gets all the data</li>
<li>BusinessObjectProvider - binds its Data property to UOWProvider.Data.BusinessObject</li>
<li>List1Provider - binds its Data property to UOWProvider.Data.List1</li>
<li>List2Provider - binds its Data property to UOWProvider.Data.List2</li>
</ol>
<p>I know this works with ViewModel&lt;T&gt;, and I <i>think</i> I made this scenario work with CslaDataProvider before I switched my attention to MVVM.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Calin replied on Thursday, January 21, 2010</h2>Thank you for your reply  Fintanv,<br /><br /> Indeed at the moment this is the approach I use, but the down fall of this is that when I change the selection in the first combo there is a small freeze time because the application goes back and gets the entities to populate the other combos.<br /><br /> I prefered CslaDataProvider for it's IsAsyncronus = true and DataErrorHandler. Further more the nice waiting from PropertyStatus is also rendered unusefull in this scenario.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
