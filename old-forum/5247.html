<html><header><title>List Objects</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>List Objects</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5247.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>whelzer posted on Friday, August 15, 2008</h2>Many thanks for help recived so far;<br><br>I've a recurring theme in my trading app which we're converting from VB6.....<br><br>I've a requirement to use a list of currencies mostly for populatig list and combo boxes.<br><br>No big deal (CcyInfo and CcyList), the issue is I've a huge number of types of Ccy Lists to get, <br><br>Eg&nbsp; All Ccys<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Ccys by trade type<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Ccys used in last xxx days<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Active Ccys<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Ccys traded by client in certain way etc, etc...<br><br>SPs are used throughout to get the data from DB<br><br>I think I've 2 choices:<br>&nbsp;&nbsp;&nbsp; 1) have a number of Ccy List objects ie CcyListAll, CcyListActive, CcyListByClient, etc<br>&nbsp;&nbsp;&nbsp; or<br>&nbsp;&nbsp;&nbsp; 2) have one CcyList object and overload factory method GetCcyList with an enum parameter and other criteria.<br><br>&nbsp;&nbsp;&nbsp; eg Public Shared Function GetCcyList(ByVal MyValue As CcyListEnum) As CcyList <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;  &nbsp; Public Shared Function GetCcyList(ByVal MyValue As CcyListEnum, byval TradeType as &nbsp;&nbsp;&nbsp; integer) As CcyList <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;  &nbsp;&nbsp;   Public Shared Function GetCcyList(ByVal MyValue As CcyListEnum, byval ClientId as integer) as CcyList<br><br>In&nbsp; Data Access method DataPortal_Fetch(ByVal criteria As Criteria), select case the enum and call the relevant SP.<br><br>Any pointers much appreciated.<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; <br><br>&nbsp;&nbsp;&nbsp; <br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fintanv replied on Friday, August 15, 2008</h2><P>FWIW I use a similar strategy to what you propose in choice 2.&nbsp; Much less confusion for the person using the API.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, August 15, 2008</h2><P>I also use #2. I do not see the need to have different objects that all have the same internal structure and methods. It is just easier to have many factory methods and then pick a branch in the DP_Fetch based on method name or some other criteria. This branch simply returns the SQL or SP and then the rest of the fetch is the same for all result sets.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Sunday, August 17, 2008</h2>And a possible choice #3: <br><br>Create functions such as <br>Public Shared Function GetCcyListAll()<br>Public Shared Function GetCcyListByTradeType(ByVal TradeType integer)<br><br>Then create a separate (private class) Criteria object for each different&nbsp; criteria sets. Ex<br>AllCriteria<br>TradeTypeCriteria<br><br>And finally create the adjoining Fetch functions in your BO's:<br>DataPortal_Fetch(ByVal criteria As AllCriteria)<br>DataPortal_Fetch(ByVal criteria as TradeTypeCriteria) <br><br>That way you will get a very clean implementation - a little more criteria classes - separate DataPortal_Fetch methods (and you can still have a common function that reads the values form a DataReader providing all SO's return the same resultset)<br><br>/jonny <br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>whelzer replied on Sunday, August 17, 2008</h2>Excellant.&nbsp; Thanks for the replies.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
