<html><header><title>Remoting Host in IIS -  SQL Server 2005 - SQL Server does not allow remote connections.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Remoting Host in IIS -  SQL Server 2005 - SQL Server does not allow remote connections.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1545.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>brettswift posted on Thursday, October 19, 2006</h2>This is a KB article that I tried with no luck: <br><br>http://support.microsoft.com/kb/914277<br><br><br>The error I get is in red on that page: <br><br><font color="#ff0000"><b>Sqlcmd: Error: Microsoft SQL Native Client: An error has occurred while
establishing a connection to the server. When connecting to SQL Server
2005, this failure may be caused by the fact that under the default
settings SQL Server does not allow remote connections.</b><font color="#000000"><br><br>I have a windows app using the CSLA 2.0 framework, setup to use IIS and remoting. <br><br>My application works fine locally, but when I install this on a remote machine (via click-once deployment) I get the error above. <br><br>I have this running on a SQL Server 2005 machine, Win XP Pro (sp2), and behind a d-link 614+ router. <br><br>I have enabled both the remote connections and the browser service..&nbsp; I haven't checked my router settings but this shouldn't be the problem - because its already getting through the firewall..&nbsp; I'm suprised that KB article would make a difference either.&nbsp; <br><br>Is it some kind of authorization I have to give the ASP_NET account that IIS uses, to access the SQL Server ? <br><br><br></font><font color="#000000"></font></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, October 20, 2006</h2>Did you restart Sql Server after changing the settings?&nbsp; I think you have to for the new settings to take effect.<br><br>Are you using integrated security=sspi?&nbsp; If so, and you have configured impersonation in iis, then yes, you'll need to allow the aspnet worker account access... but there's a cavet.&nbsp; If IIS and Sql are on different machines, you won't be able to do this, since aspnet user is a local account.&nbsp; You'll have to either create a domain account, or not use sspi.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brettswift replied on Friday, October 20, 2006</h2>Thanks, <br><br>I'm trying to find an article on how to allow the aspnet worker account access to sql server..&nbsp; do i just give it permissions on the service or how do i do that?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, October 20, 2006</h2>As I said, to do that Sql and IIS need to be on the same machine.&nbsp; If they are, you just add aspnet as a login to the database server, then set it up as a user in the database you wish it to access.<br><br>FWIW, I recommend that you setup database roles, and assign permissions to them.&nbsp; Make it easier to add a login and user.<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brettswift replied on Friday, October 20, 2006</h2>I'm just running this at home so they are on the same machine.&nbsp;&nbsp; I've been busy with work so haven't looked at this app in a while.&nbsp; <br><br>Will have to test this out when I get to work but I think this should work.&nbsp; Thanks Andy..&nbsp; I'll let you know if I have any problems.<br><br>I also setup the anonymous user in IIS to be MACHINENAME\ASPNET&nbsp; instead of IUS_MachineName<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brettswift replied on Friday, October 20, 2006</h2>I'm at work, just tried it.&nbsp; It is now giving me an error saying that it can't locate the sql server instance, but also that remote connections may not be enabled.&nbsp;&nbsp; (I know they are enabled because I just did that last night and rebooted my machine!). <br><br>hmm.&nbsp; Why would it not be able to see the sql server? <br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brettswift replied on Friday, October 20, 2006</h2>Ok, now i'm getting an error where it says that&nbsp; "Login failed for user ''.&nbsp; the user may not be associated with a trusted sql login"&nbsp; or something like that. <br><br>my connection string looks like this: <br><br>&lt;add name="Security" <br>connectionString="Network=DBMSSOCN;Data Source=192.168.0.101\SQLEXPRESS;Initial Catalog=HorseTracker;Integrated Security=SSPI;User ID=user;password=pass;"<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;providerName="System.Data.SqlClient" /&gt;<br><br><br>I also had the port on there that was in the sql server config utility, but that didn't work either. <br><br>anonymous access user in IIS has an account in sql server, sql browser is on (which is only needed if i don't supply the port) and so are remote connections.&nbsp; hmmm<br><br><b>Why would it see my username as blank? </b><br><br><br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
