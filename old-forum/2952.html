<html><header><title>CanReadProperty and Throwing Exceptions</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CanReadProperty and Throwing Exceptions</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2952.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Marjon1 posted on Tuesday, May 29, 2007</h2>I would like to get some feedback on what others using CSLA are doing for large scale applications.<br>We are developing a form based application using CSLA for the base objects, and the all our properties use the following:<br><br><font face="Courier New" size="2">Public Property Description() As String<br>&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; CanReadProperty("Description",True)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return _Description<br>&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp; Set(ByVal value As String)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CanWriteProperty("Description", True)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If _Description &lt;&gt; value Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Description = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp; End Set<br>End Property</font><br><font face="Courier New" size="2"><br><br></font>This does exactly what we would expect and throws an exception if the user does not have rights to read or write the relevant properites. However, when binding the object to a datasource to be presented on a form (with a readwriteauthorization control); the first property that the user doesn't have rights to causes an exception and no other properites are read. I would prefer not to have to put if statements throughout all properities. <br><br>How have others done this? <br><br>Thankyou in advance!<br><font face="Courier New" size="2"><br></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Tuesday, May 29, 2007</h2><P>I don't use it but if I did I think I would use it like this in order to "blank out" values they can't read and not allow sets. This avoids the exceptions.</P>
<P>Public Overridable Property Msgtype() As String<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If CanReadProperty("Msgtype") Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return mMsgtype<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return ""<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal Value As String)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If CanWriteProperty("Msgtype") Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If mMsgtype &lt;&gt; Value Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mMsgtype = Value<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged("Msgtype") <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<BR>&nbsp;&nbsp;&nbsp; End Property<BR></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, May 29, 2007</h2>Joe,<br><br>The RWAuth control should handle checking CanReadProperty and CanWriteProperty when databinding, so you should not need to have that code in the property setters and getters.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, May 29, 2007</h2><P>Andy, unfortunately the RWAuth control doesn't solve the issue. Data binding is too agressive, and tries to read the values even though the value never makes it to the control.</P>
<P>If you are using the RWAuth control you are best off doing as Joe suggests and returning some dummy value (empty string, zero, etc).</P>
<P>It doesn't really matter what you return, because RWAuth will eat the value anyway, but the exception does give data binding indigestion in this case <img src="/emoticons/emotion-6.gif" alt="Sad [:(]" /></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, May 29, 2007</h2>Ack,&nbsp; I saw code in RWAuth, and it had looked like it should handle the case, and have used it to lockout writing of properties, so I wasn't aware of the issues when reading is locked down.&nbsp; Sorry for the misinformation.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Marjon1 replied on Tuesday, May 29, 2007</h2><font size="2"><font face="Arial">Thanks Rocky and everbody else who replied, I was afraid that this was the case.<br><br>Time to update my code templates again <img src="/emoticons/emotion-12.gif" alt="Angry [:@]" /><br><br><br></font></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rdrunner replied on Thursday, May 31, 2007</h2>Be happy that it is a only a Template ;)</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, May 29, 2007</h2>What are the databound controls that you are using?&nbsp; Are you sure that every control which is bound has the ReadWriteAuth control enabled for it?<br><br>RWAuth should handle returning an empty string if the user cannot read a particular property, so an exception shouldn't be thrown at all.&nbsp; <br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
