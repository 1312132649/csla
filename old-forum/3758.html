<html><header><title>Security question - DLLs / dataportal</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Security question - DLLs / dataportal</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3758.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>xxxJasonxxx posted on Monday, October 22, 2007</h2><P>I have a security question/concern...</P>
<P>We in the process of&nbsp;using CSLA to re-write our corporation's purchasing module.&nbsp; The tentative plan is this.&nbsp; The front-end will be Windows forms and the back end is a remote dataportal and CSLA-based business objects.&nbsp; The back-end dataportal/DLLs will reside at our corporate headquarters and the front end EXE/DLLs will reside at several franchises throughout the country.</P>
<P>We are very concerned about being hacked, even internally.&nbsp; In one of our other legacy web apps, we've had trouble internally from a creative franchise tech who has written some spiders/scripts with benevolent intent, that has unfortunately had very malevolant results.&nbsp; For political reasons, this franchise tech cannot be touched.&nbsp; So we are extremely paranoid about security on this new app.&nbsp; Which leads to my question/concern...</P>
<P>So say if someone (like the franchise tech) has access to our DLLs, config file, and dataportal URL.&nbsp; Is there anything to stop them from writing their own EXE to bypass/replace our client app EXE -- and have their own code use our DLLs to hit&nbsp;our dataportal and database?&nbsp; If that is possible, is there anything we can do to minimize this threat?</P>
<P>Jason</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, October 22, 2007</h2>Well, if he's not going to re-write your library dlls, you may have a problem then.&nbsp; If you were worried about him modifiying the business libraries, I believe you'll have some protection from that.. but I don't know of anything that would stop him from simplying using those libraries.<br><br>Since your client application may not be trustworthy, you might have to move your trust boundry to the application server itself.&nbsp; In this case, your client app would simply be calling to web services.&nbsp; Now, you'll have to duplicate a lot of logic to go this route if you want a rich UI experience, because you won't have your actual business assemblies on the client.&nbsp; So just like asp.net, you'll need to do some checking on the client, have the client call the web service and re-check everything there.&nbsp; The problem will be keeping the client rules in sync with the server rules.<br><br>That's a big cost. <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>webjedi replied on Monday, October 22, 2007</h2><P>Can you use non CSLA standard naming for the connection strings etc...then encrypt the configs?&nbsp; Then if he snagged your DLLs he'd have to make his own config file but it wouldn't do him any good as you'd have different key/name pairs than the docs he'd find here.</P>
<P>There's probably a gap here that still exploitable though.&nbsp;&nbsp;</P>
<P>Maybe if you kept a CRC/Hash&nbsp;signature&nbsp;of your app in your tables and on each DB operation do a compare...again another gap in there most likely...but I'm just spitballing.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Curelom replied on Monday, October 22, 2007</h2><P>Since your remoting, you wouldn't need to include the database config on the client side, this would force them to use the server.&nbsp; Some sort of hash to pass along might help.&nbsp; Depending on how savy the user is, they may be able to sniff a hash or find it in the library itself.&nbsp; You'd want to make sure everything is SSL.&nbsp; You may also want to encrypt your config file containing the dataportal url.&nbsp; There are a number of examples on how to encrypt web config files out on the web, they work just as well encrypting the app.config.</P>
<P>If possible, you would want to put all your business rules in the library, in case they are able to use the library, they would still have to follow the business rules and only have the rights of their user.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xxxJasonxxx replied on Tuesday, October 23, 2007</h2><P>True...we definitely need to encrypt our config file.&nbsp; That would at least slow someone down in getting the dataportal URL.&nbsp; But I think someone would still get it fairly easily by monitoring the internet communications between the client app and the dataportal.</P>
<P>I expect our franchise tech will also crack open our files (EXEs/DLLs).&nbsp; So we're planning on using the "Dotfuscator" to scramble the insides of our DLLs and EXEs.&nbsp;&nbsp; I'm not too worried about him re-writing the DLLs/objects.&nbsp; Even if he could decipher and re-write them, it is my understanding that the CSLA code will throw an error if the object/DLL on the client does not match the object/DLL residing in the dataportal folder on the server.&nbsp; Even if he changes his DLLs, it won't matter because he can't change the DLLs on our server (dataportal).</P>
<P>My main concern is that still that once someone has our DLLs and the DataPortal URL, they can use them to write their own custom app.&nbsp; I've toyed with the idea of having DLLs confirm which app/code is calling their factory methods.&nbsp; I thought about&nbsp;adding a parameter to the factory methods that is some kind of security code - but I'm also wondering if that could be monitored/discovered somehow.</P>
<P>On another train of thought, one of you guys mentioned the business rules inside our DLLs/objects.....all of our critical business rules are enforced inside the objects/DLLs.&nbsp; So unless we missed something in our rules, maybe the hacker won't be able to do anything that we don't already allow them to do through our client app.&nbsp; So, am I making a big deal about nothing?</P>
<P>It's so hard to know how far to go with these security concerns.</P>
<P>Jason</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, October 23, 2007</h2><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>xxxJasonxxx:</strong></div><div>My main concern is that still that once someone has our DLLs and the DataPortal URL, they can use them to write their own custom app.&nbsp; I've toyed with the idea of having DLLs confirm which app/code is calling their factory methods.&nbsp; I thought about&nbsp;adding a parameter to the factory methods that is some kind of security code - but I'm also wondering if that could be monitored/discovered somehow.</div></BLOCKQUOTE><br><br>Such a code could be discovered I would think.&nbsp; As I said, the Dlls shouldn't be a source of worry; if he rewrites those, he'll simply get remoting errors.&nbsp; If he writes a custom app that just uses the dlls, there's nothing to really stop that.&nbsp; <br>
<p><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>xxxJasonxxx:</strong></div><div>On another train of thought, one of you guys mentioned the business rules inside our DLLs/objects.....all of our critical business rules are enforced inside the objects/DLLs.&nbsp; So unless we missed something in our rules, maybe the hacker won't be able to do anything that we don't already allow them to do through our client app.&nbsp; So, am I making a big deal about nothing?</div></BLOCKQUOTE></p><p>Well that's right; he could only push in data that passes your validation rules.&nbsp; so the only threat would be him reading / writing data that does conform to your rules, but shouldn't be there for some other reason.&nbsp; Like if he wanted to import a bunch of customers and had privledges to do so.&nbsp; You probably would want to go with Windows Authentication, if possible.&nbsp; That way he'd have to be running as someone else (probably a no-no in your company) or use his own credintials, which would lead back to him if he screwed up.<br></p>
<p><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>xxxJasonxxx:</strong></div><div>It's so hard to know how far to go with these security concerns.</div></BLOCKQUOTE></p><p>Yes, I suppose that's why security is as much of an art as engineering.</p>HTH<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>webjedi replied on Tuesday, October 23, 2007</h2><P>If you have a unique custom security code passed from the client to the portal I am sure there's a way to make certain another client is not currently using that same code and if they are you can shun any activity from them.&nbsp; It's a heavyweight solution because you'd have to track alot of activity by an IP address or whatever over a long period of time.</P>
<P>Its really a larger view of the security mantra "Never trust user input".&nbsp; If all the real logic/validation is in the dataportal itself then you should be good.&nbsp; But it will probably mean there is logic on multiple tiers.</P>
<P>All these things are well and good and should be explored to their fullest.</P>
<P>I know you said politically he can't be touched...and I know you are looking for a technical solution.&nbsp; But the real solution is strict policy enforcement.&nbsp; IMHO there's no room for political niceities when it comes to security.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
