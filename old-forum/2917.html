<html><header><title>object.save() problem</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>object.save() problem</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2917.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>MTmace posted on Monday, May 21, 2007</h2><P>I have two scenarios where I need to save an object, when the form closes and when another object has been selected via a list box.<BR><BR>When another object has been selected via the list box I am executing the following code.</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (</FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.CurrentBatchClass != </FONT><FONT color=#0000ff size=2>null</FONT><FONT size=2> &amp;&amp; </FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.CurrentBatchClass.IsDirty)<BR>{<BR></FONT><FONT color=#2b91af size=2>&nbsp;&nbsp;&nbsp;DialogResult</FONT><FONT size=2> result;</P>
<P>&nbsp;&nbsp;&nbsp;result = </FONT><FONT color=#2b91af size=2>MessageBox</FONT><FONT size=2>.Show(</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2>.Format(</FONT><FONT color=#a31515 size=2>"Do you want to save changes"</FONT><FONT size=2>, </FONT><FONT color=#a31515 size=2>"Warning"</FONT><FONT size=2>, </FONT><FONT color=#2b91af size=2>MessageBoxButtons</FONT><FONT size=2>.YesNo, </FONT><FONT color=#2b91af size=2>MessageBoxIcon</FONT><FONT size=2>.Question);</P>
<P></FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (result == </FONT><FONT color=#2b91af size=2>DialogResult</FONT><FONT size=2>.Yes)<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.CurrentBatchClass.Save();<BR></FONT><FONT size=2>}</FONT></P>
<P><FONT size=2>This example works fine. The same code is getting excuted when on the form's closing event.<BR>But on the form closing event I get an error when the base.save() method is called. the error says the object is still being edited and can not be saved. <BR><BR>How can I avoid this issue?</FONT></P>
<P><FONT size=2>MTmace<FONT size=2></P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Monday, May 21, 2007</h2>You probably have a binding source, right?<br>In that case you need to call the bindingsource's EndEdit method before doing save.<br>What's "CurrentBatchClass" ? a property? a field? when do you set it's value?<br><br>Anyway, your problem is definitely related to n-level undo and the use of begin/end edit. Make sure you get that pattern right. There are plenty of threads on this subject.<br><br>Andr√©s<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MTmace replied on Monday, May 21, 2007</h2><P>it is an object and I found the solution on another thread. Executing apply edit before the save solved my problem.</P>
<P>MTmace</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
