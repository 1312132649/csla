<html><header><title>Clone Issue with Collection</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Clone Issue with Collection</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3860.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ravimaran posted on Wednesday, November 07, 2007</h2>Hi, <br>I have an object Client and it contatains a collection List. I.E.&nbsp; <br>Client object has a variable clientOrders as a collection list and the child object Order<br>[Serializable()]<br>class Client : BusinessBase&lt;Client&gt;<br>{<br>&nbsp;&nbsp;&nbsp; _clientOrders = ClientOrders.EmptyOrderList()<br>&nbsp;&nbsp; // At run time it creates an orderList with orders.<br>}<br><br>[Serializable()]<br>class ClientOrders : BusinessListBase&lt;ClientOrders, Orders&gt;<br>{}<br><br>and<br>[Serializable()]<br>class Orders: BusinessBase&lt;Orders&gt;<br>{}<br><br>Now when I do Client.Clone() I am able to see the clientOrders but all the each order object's IsDirty or IsNew property set to False.&nbsp; Therefore when I save the cloned object the clientOrders is not saved as well.&nbsp; I wasn't able to override Clone() method in clientOrders so I can make all the order object as MarkAsChild() and IsNew() to true.&nbsp; <br><br>I am really confused on how to accomplish this.&nbsp; Please help me to make this happen.&nbsp; Thank you.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, November 07, 2007</h2><P>Clone() returns an identical clone. It must do this in fact, or the data portal will fail.</P>
<P>It sounds like you want a Copy() method that creates a new set of objects based on the original (but not the same).</P>
<P>In the past I've recommended people override the cloning behavior to make this happen, but now that would be a bad idea, because the 3.5 data portal will clone your objects by default in some cases, and it expects a real clone (100% copy).</P>
<P>So what you should do is create a Copy() method that creates a clone and then manipulates the clone as required. This may mean implementing extra methods on your objects to allow the Copy() method to reset your child states:</P>
<P>Public Function Copy() As Client<BR>&nbsp; Dim tmp As Client = Me.Clone()<BR>&nbsp; tmp.FixUpAfterCopy()<BR>End Function</P>
<P>Private Sub FixUpAfterCopy()<BR>&nbsp; MarkNew()<BR>&nbsp; mChildList.FixUpAfterCopy()<BR>End Sub</P>
<P>---- then in ChildList ----</P>
<P>Friend Sub FixUpAfterCopy()<BR>&nbsp; For Each item As Orders In DeletedList<BR>&nbsp;&nbsp;&nbsp; item.FixUpAfterCopy()<BR>&nbsp; Next<BR>&nbsp; For Each item As Orders In&nbsp;Me<BR>&nbsp;&nbsp;&nbsp; item.FixUpAfterCopy()<BR>&nbsp; Next<BR>End Sub</P>
<P>---- then in&nbsp;Orders ----</P>
<P>Friend Sub FixUpAfterCopy()<BR>&nbsp; MarkNew()<BR>End Sub</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
