<html><header><title>AddOutValue not working if rule triggered by Dependency</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>AddOutValue not working if rule triggered by Dependency</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10735.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Russ posted on Monday, October 03, 2011</h2><p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">The AddOutValue in the following rule correctly updates the TextProperty when the user changes the String1Property however it does not update the TextProperty when the user changes the String2Property or the String3Property. The Debug line does output the correct buf string with every user change.</span></span></p>
<p class="MsoNoSpacing" style="margin:0in 0in 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">#region</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> Business Rules</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">protected</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">override</span> <span style="color:blue;">void</span> AddBusinessRules()</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp; </span><span style="color:blue;">base</span>.AddBusinessRules();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>BusinessRules.AddRule(<span style="color:blue;">new</span> <span style="color:#2b91af;">UpdateTextRule</span>(String1Property, String2Property, String3Property) { Priority = 0 });</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>BusinessRules.AddRule(<span style="color:blue;">new</span> Csla.Rules.CommonRules.<span style="color:#2b91af;">Dependency</span>(String2Property, String1Property) { Priority = 0 });</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>BusinessRules.AddRule(<span style="color:blue;">new</span> Csla.Rules.CommonRules.<span style="color:#2b91af;">Dependency</span>(String3Property, String1Property) { Priority = 0 });</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">private</span><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">class</span> <span style="color:#2b91af;">UpdateTextRule</span> : Csla.Rules.<span style="color:#2b91af;">BusinessRule</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:#2b91af;">IPropertyInfo</span> SecondaryProperty { <span style="color:blue;">get</span>; <span style="color:blue;">set</span>; }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:#2b91af;">IPropertyInfo</span> TertiaryProperty { <span style="color:blue;">get</span>; <span style="color:blue;">set</span>; }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">public</span> UpdateTextRule(<span style="color:#2b91af;">IPropertyInfo</span> String1Property, <span style="color:#2b91af;">IPropertyInfo</span> String2Property, <span style="color:#2b91af;">IPropertyInfo</span> String3Property)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>: <span style="color:blue;">base</span>(String1Property)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>PrimaryProperty = String1Property;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>SecondaryProperty = String2Property;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>TertiaryProperty = String3Property;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>InputProperties = <span style="color:blue;">new</span> <span style="color:#2b91af;">List</span>&lt;<span style="color:#2b91af;">IPropertyInfo</span>&gt; { String1Property, String2Property, String3Property };</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>AffectedProperties.Add(TextProperty);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span><span style="color:blue;">protected</span> <span style="color:blue;">override</span> <span style="color:blue;">void</span> Execute(<span style="color:#2b91af;">RuleContext</span> context)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">var</span> s1 = context.InputPropertyValues[PrimaryProperty].ToString();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">var</span> s2 = context.InputPropertyValues[SecondaryProperty].ToString();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">var</span> s3 = context.InputPropertyValues[TertiaryProperty].ToString();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">string</span> buf = <span style="color:blue;">string</span>.Format(<span style="color:#a31515;">&quot;{0} {1} {2}&quot;</span>, s1, s2, s3);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>System.Diagnostics.<span style="color:#2b91af;">Debug</span>.WriteLine(buf);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp; </span>context.AddOutValue(TextProperty, buf);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;"><span style="mso-tab-count:1;">&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">#endregion</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Consolas;color:blue;font-size:8pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-size:small;"><span style="font-family:Calibri;">Has anyone else ever seen this strange behavior?</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-size:small;"><span style="font-family:Calibri;">Thanks</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;tab-stops:9.0pt .25in 27.0pt .5in 45.0pt .75in 63.0pt 1.0in;"><span style="font-size:small;"><span style="font-family:Calibri;">Russ<span style="font-size:9pt;mso-bidi-font-size:11.0pt;"></span></span></span></p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, October 06, 2011</h2><p>Hi,</p>
<p>Which version of CSLA are you using?</p>
<p>Priority = 0 may be left out, thıs ıs the default value.</p>
<p>My personal preference would be to have the TextProperty as primary property wıth a params array for input properties (any number of fields).</p>
<p>Create a sting array and use Join to create a comma separated list and add as output value.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, October 06, 2011</h2><p>I did this test with the latest CSLA 4.2 beta, without dependency rules, only change to the rule is this line: </p>
<pre style="font-family:Consolas;font-size:13;color:black;background:#fafafa;">System.Diagnostics.<span style="color:#2b91af;">Debug</span>.Print(<span style="color:#a31515;">&quot;rule:</span><span style="color:mediumseagreen;">{0}</span><span style="color:#a31515;">&quot;</span>,&nbsp;buf);
<br />and this program on a root object with the 4 string properties:<br /></pre>
<pre style="font-family:Consolas;font-size:13;color:black;background:#fafafa;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue;">var</span>&nbsp;root&nbsp;=&nbsp;<span style="color:#2b91af;">Root</span>.NewEditableRoot();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root.String1&nbsp;=&nbsp;<span style="color:#a31515;">&quot;S1&quot;</span>;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">Debug</span>.Print(<span style="color:#a31515;">&quot;root:</span><span style="color:mediumseagreen;">{0}</span><span style="color:#a31515;">&quot;</span>,&nbsp;root.Text);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root.String2&nbsp;=&nbsp;<span style="color:#a31515;">&quot;S2&quot;</span>;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">Debug</span>.Print(<span style="color:#a31515;">&quot;root:</span><span style="color:mediumseagreen;">{0}</span><span style="color:#a31515;">&quot;</span>,&nbsp;root.Text);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root.String3&nbsp;=&nbsp;<span style="color:#a31515;">&quot;S3&quot;</span>;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#2b91af;">Debug</span>.Print(<span style="color:#a31515;">&quot;root:</span><span style="color:mediumseagreen;">{0}</span><span style="color:#a31515;">&quot;</span>,&nbsp;root.Text);<br /><br />and got the following output on debug window:<br />rule:S1  <br />root:S1  <br />rule:S1 S2 <br />root:S1 S2 <br />rule:S1 S2 S3<br />root:S1 S2 S3<br /><br />However, a fully general rule could be written like this:<br />&nbsp;&nbsp;&nbsp; <span style="color:blue;">protected</span>&nbsp;<span style="color:blue;">override</span>&nbsp;<span style="color:blue;">void</span>&nbsp;AddBusinessRules()
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:green;">//&nbsp;call&nbsp;base&nbsp;class&nbsp;implementation&nbsp;to&nbsp;add&nbsp;data&nbsp;annotation&nbsp;rules&nbsp;to&nbsp;BusinessRules&nbsp;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">base</span>.AddBusinessRules();
 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BusinessRules.AddRule(<span style="color:blue;">new</span>&nbsp;<span style="color:#2b91af;">UpdateTextRule</span>(TextProperty,&nbsp;String1Property,&nbsp;String2Property,&nbsp;String3Property));
&nbsp;&nbsp;&nbsp;&nbsp;}
 
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">public</span>&nbsp;<span style="color:blue;">class</span>&nbsp;<span style="color:#2b91af;">UpdateTextRule</span>&nbsp;:&nbsp;Csla.Rules.<span style="color:#2b91af;">BusinessRule</span>
&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">public</span>&nbsp;UpdateTextRule(<span style="color:#2baaaf;">IPropertyInfo</span>&nbsp;primaryProperty,&nbsp;<span style="color:blue;">params</span>&nbsp;<span style="color:#2baaaf;">IPropertyInfo</span>[]&nbsp;valueProperties)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;<span style="color:blue;">base</span>(primaryProperty)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InputProperties&nbsp;=&nbsp;<span style="color:blue;">new</span>&nbsp;<span style="color:#2b91af;">List</span>&lt;<span style="color:#2baaaf;">IPropertyInfo</span>&gt;(valueProperties);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">protected</span>&nbsp;<span style="color:blue;">override</span>&nbsp;<span style="color:blue;">void</span>&nbsp;Execute(<span style="color:#2b91af;">RuleContext</span>&nbsp;context)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">string</span>[]&nbsp;values = context.InputPropertyValues<br />                                 .Where(p&nbsp;=&gt;&nbsp;p.Key&nbsp;!=&nbsp;PrimaryProperty)<br />                                 .Select(p&nbsp;=&gt;&nbsp;p.Value.ToString())<br />                                 .ToArray();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">var</span>&nbsp;buf&nbsp;=&nbsp;<span style="color:#2b91af;">String</span>.Join(<span style="color:#a31515;">&quot;&nbsp;&quot;</span>,&nbsp;values);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Diagnostics.<span style="color:#2b91af;">Debug</span>.Print(<span style="color:#a31515;">&quot;rule:</span><span style="color:mediumseagreen;">{0}</span><span style="color:#a31515;">&quot;</span>,&nbsp;buf);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;context.AddOutValue(buf);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}<br /></pre></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Russ replied on Thursday, October 06, 2011</h2><p>Hi Jonny,</p>
<p>Your example is very elegant.&nbsp; I have upgraded from 4.1 to 4.2 beta and it works great!&nbsp; I also noticed my application seems to run a little bit faster!</p>
<p>Thanks again<br />Russ.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
