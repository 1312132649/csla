<html><header><title>Delete root</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Delete root</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5891.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Slayer posted on Thursday, November 27, 2008</h2>Hi<br /><br />Im went through the csla 2.0 sample project. I have a question. I fetch a project object. The object contains a collection of resources. I then delete the project object. What happens to the objects status? The object is in memory even though it has been delete. What happens if the save method is executed again while the object and its children are no more ?<br /><br />Thanks</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Thursday, November 27, 2008</h2><P>I haven't looked at the sample code lately, but in our application the object is marked "old" after the delete is committed to the database. A second call to Save() would have no effect since the object does not appear dirty. If you did change a field and make the deleted object dirty, the database update would fail (similar to a concurrency violation) because the record no longer exists in the database. </P>
<P>However, this is because I implemented the save functionality myself and this is what I chose to do. CSLA is&nbsp;fairly agnostic as to what happens during object saving, so to some degree it is&nbsp;can be up to you to implement your own behavior in this case. </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Saturday, November 29, 2008</h2><P>You should be able to find this out by:</P>
<P>1. Running the code and stepping in to CSLA to see what it does.</P>
<P>2. Reading the book. (You did buy a copy, right?) You can get the 2008 book (a preview edition is available as .pdf if you pre-order it.)</P>
<P>As I recall the DataPortal marks your BO as New once the delete occurs because the data is no longer in the database. Thus another save should cause an Insert to occur.</P>
<P>Also, keep in mind that the Delete of a Root needs to handle the Delete for all its children in code (unless you have Cascade Delete turned on int he database.) </P>
<P>Oh and avoid the #1 bug of UI code saving BOs:</P>
<P>Do NOT do this:</P>
<P>myBO.Save</P>
<P>Do this instead:</P>
<P>myBO = myBO.Save</P>
<P>You have to update the variable with the returned object.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, December 01, 2008</h2>How are you deleting the object?&nbsp; Are you calling the Delete method on the instance?&nbsp; Or using a static method to delete it?&nbsp; <br><br>If you're calling Delete on the instance, the object is marked to be deleted.. but not deleted.&nbsp; To commit the delete, you need to call Save, which will mark the object as Dirty and New.&nbsp; I would think you'd mimic that behavior if you have a Delete static method as well.&nbsp; Of course all the child objects would have to be marked as such as well.<br><br>If you were then to call Save again, I would think it would re-insert all the data, although with new keys (possibly.. it depends on what data types you're using as key columns).<br><br>Check out the book for more details, and why this behavior makes sense.<br><br>HTH<br>Andy<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
