<html><header><title>Possible Save(forceUpdate) errata </title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Possible Save(forceUpdate) errata </h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6091.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>AndrewBurns posted on Tuesday, January 06, 2009</h2>I was in the middle of doing some custom save logic in my business base class when I noticed this bit of code from CSLA's BusinessBase.cs(143-154):<br><font face="Courier New">&nbsp;&nbsp;&nbsp; public T Save(bool forceUpdate)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (forceUpdate &amp;&amp; IsNew)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // mark the object as old - which makes it<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // not dirty<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MarkOld();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // now mark the object as dirty so it can save<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MarkDirty(true);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return this.Save();<br>&nbsp;&nbsp;&nbsp; }</font><br>Either I am just being stupid (which is possible as I haven't had my coffee yet today), or this is a bug:&nbsp; If the object is new (not in the DB) then that implies it is also dirty (so call the data portal methods) UNLESS it is also deleted in which case a force delete would fail anyway.&nbsp; Is this correct?<br><br>I think the line should read (not IsNew):<br><font face="Courier New">if (forceUpdate &amp;&amp; !IsNew)<br><br></font>Do I need more coffee or do I get a star?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, January 06, 2009</h2>That's the correct code.<br><br>The assumption when you call this method is that the BO actually ISN'T new at all, but for performance reasons you're going to pretend it is. Force update forces the DataPortal_Update to run, when normally the DataPortal_Insert would run.&nbsp; This allows you to code your website so that you can do a less expensive Create instead of a Fetch + Save.<br><br>Does that make sense?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AndrewBurns replied on Tuesday, January 06, 2009</h2>Ahhh.&nbsp; Thank you Ajj.<br><br>I have been out of the CSLA scene for a while.&nbsp; I misinterpreted the name to mean that it would force the data portal methods to run (Update) if IsDirty was false.<br><br>Thank you for the clarification.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
