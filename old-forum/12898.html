<html><header><title>Silverlight to WPF conversion Issue with AutoCompleteBox</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Silverlight to WPF conversion Issue with AutoCompleteBox</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/12898.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav posted on Wednesday, June 10, 2015</h2><p>I am bringing my mature SL app to WPF. I am quite liberal with the use of AutoCompleteBoxes and often have more than one on a page.</p>
<p>The data for the dropdown of each Auto...box comes from a database table.&nbsp; Instead of running to the Database for each Auto..box&#39;s list, I bring up the list for the whole page, and then use a subset of that list when the user navigates to a given Auto...box.&nbsp; All my lists are of the MobileList kind.&nbsp; This has worked fine in SL. (The same is happening with BusinessListBase)</p>
<p><br />In WPF the behavior is strange.&nbsp; The lists do appear in the dropdown, but when <em>I choose an item with mouse</em> the selection immediately disappears and the box remains empty.&nbsp; When I make the selection by using the up-down arrow keys on the keyboard, the selection behaves normally.</p>
<p><br />Now here is the interesting part.&nbsp; If, instead of displaying the subset (Path = FilteredList), I use the entire list (Path = Model), everything works fine.&nbsp; The workaround I have used on one instance of AutoCompleteBox&nbsp;is to create another class specifically to hold the selected subset.&nbsp; Using that I can set the Path = Model, and with that things appear to work.&nbsp; With the number Auto..boxses, making the change to all is, well, daunting.<br />So I thought I should ask if there is a simpler solution for this.&nbsp; </p>
<p>I&#39;ll appreciate any suggestions.</p>
<p>Javed</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, June 10, 2015</h2><p>How do you create the FilteredList collection?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Wednesday, June 10, 2015</h2><p>The main list is created as:</p>
<p>public partial class PxAttributeValueList : MobileList&lt;PxAttributeValue&gt;</p>
<p>Within this class I have a method:</p>
<p>public PxAttributeValueList GetFilteredList(string region, string part)<br />&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PxAttributeValueList Lst = new PxAttributeValueList();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int j = 0; j &lt; this.Count; j++)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // based on region and part<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Lst.Add(this[j]);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return Lst;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p>The resulting &quot;FilteredList&quot; is used in Path = FilteredList</p>
<p>Javed</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, June 10, 2015</h2><p>You are using a very basic list type - MobileList inherits from List&lt;T&gt;. No explicit data binding support, but then binding to&nbsp;a combobox doesn&#39;t require anything special.</p>
<p>It is quite puzzling that the same list type works as .Model but not as .Model.FilteredList. </p>
<p>I see no async behavior there, so that probably isn&#39;t an issue.</p>
<p>Does your FilteredList property raise PropertyChanged after it has been set/changed?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Wednesday, June 10, 2015</h2><p>FilteredList after being created as I displayed above simply goes back. In SL it works just fine.&nbsp; In WPF, I changed the list to</p>
<p>public partial class PxAttributeSelectionList : BusinessListBase&lt;PxAttributeValueList, PxAttributeValue&gt;</p>
<p>But&nbsp;that made no difference to the behavior.&nbsp; I then created another class and I use it as follows:&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; [Serializable]<br />&nbsp;&nbsp;&nbsp; public class PxAttributeSelectionList : BusinessListBase&lt;PxAttributeValueList, PxAttributeValue&gt;<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static void NewPxAttributeSelectionList(EventHandler&lt;DataPortalResult&lt;PxAttributeSelectionList&gt;&gt; callback)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var dp = new DataPortal&lt;PxAttributeSelectionList&gt;();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dp.FetchCompleted += callback;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dp.BeginFetch();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static PxAttributeSelectionList NewPxAttributeSelectionList()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return new PxAttributeSelectionList();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp; }</p>
<p>Then&nbsp;instead of the&nbsp;&quot;FilteredList&quot; I do the following:</p>
<p>public PxAttributeValueList GetFilteredList(string region, string part)<br />&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PxAttributeSelectionList Lst = new PxAttributeSelectionList ();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int j = 0; j &lt; this.Count; j++)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // based on region and part<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Lst.Add(this[j]);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;return Lst;<br />&nbsp; }</p>
<p>With that list, I can use Path = Model, and everything works just fine.</p>
<p>Javed</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>Jav replied on Friday, June 12, 2015</h2><p>Found the culprit.&nbsp; One of my methods in the chain was getting called mare than once, when it was meant to be called only once. On the last go around it was clearing my list.</p>
<p>Javed</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
