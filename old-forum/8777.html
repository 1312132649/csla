<html><header><title>ViewModelBase : Add some extensibility points</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ViewModelBase : Add some extensibility points</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8777.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>edore posted on Wednesday, April 07, 2010</h2><p>Hello,</p>
<p>I based our MVVM architecture by derivating on this base&nbsp;class and I&#39;m pretty happy with the results.&nbsp; Down the road I encountered a case for which I would like a different behaviour in QueryCompleted.&nbsp; In fact,&nbsp;I want to get a hold on the model before it it assigned to the Model property.&nbsp; Here&#39;s my proposition : add a virtual method called OnRefreshing() which we could override in our sub class.&nbsp; Here&#39;s an example of what I seek :&nbsp;</p>
<p><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;"><span style="color:#000000;"></span>private</span></span><span style="font-size:x-small;"> </span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">void</span></span><span style="font-size:x-small;"> QueryCompleted(</span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">object</span></span><span style="font-size:x-small;"> sender, </span><span style="color:#2b91af;font-size:x-small;"><span style="color:#2b91af;font-size:x-small;">EventArgs</span></span><span style="font-size:x-small;">e) </span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">false</span></span><span style="font-size:x-small;">;<span style="font-size:x-small;"> </span></span></p>
<p>
<p>{</p>
<span style="font-size:x-small;"><span style="font-size:x-small;"><font size="2">
<p>IsBusy =&nbsp;</p>
</font></span></span>
<p>&nbsp;</p>
</p>
<p><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">var</span></span> <span style="font-size:x-small;">eventArgs = (IDataPortalResult)e;<span style="font-size:x-small;">&nbsp;</span></span></p>
<p><span style="font-size:x-small;"></span>&nbsp;<span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">if</span></span><span style="font-size:x-small;"> (eventArgs.Error == </span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">null</span></span> <span style="font-size:x-small;">)</span><span style="font-size:x-small;"><span style="font-size:x-small;"><span style="font-size:x-small;">&nbsp;</span></span></span></p>
<p><span style="font-size:x-small;"><span style="font-size:x-small;"><span style="font-size:x-small;">{<span style="font-size:x-small;"><span style="font-size:x-small;"><font size="2">
<p>&nbsp;</p>
</font></span>
<p><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">var</span></span><span style="font-size:x-small;"> model = (T)eventArgs.Object;<span style="font-size:x-small;"> </span></span></p>
<p>OnRefreshing(model);</p>
<p>Model = model;</p>
<p>}</p>
</span></span></span>
<p><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">var</span></span><span style="font-size:x-small;"> model = (T)eventArgs.Object;<span style="font-size:x-small;"> </span></span></p>
<p>OnRefreshing(model);</p>
<p>Model = model;</p>
<p>}</p>
</span>&nbsp;</p>
<p>&nbsp;</p>
<p>
<p><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">else</span></span></p>
<p><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">{</span></span></p>
</p>
<p><span style="font-size:x-small;">
<p>Error = eventArgs.Error;</p>
<p>OnRefreshed();</p>
<p>}</p>
<p>}</p>
<p>And as a general rule, it would be nice to introduce more of these : On...ing() and On...ed() virtual methods to enable us to &quot;insert&quot; code without altering Csla...</p>
<p>&nbsp;</p>
<p>Thanks!</p>
</span></p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Wednesday, April 07, 2010</h2><p>I&#39;ll add this to the wish list, it is a good idea.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
