<html><header><title>O/T Object Data Sources problems in VS 2008</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>O/T Object Data Sources problems in VS 2008</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5364.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>simon_may posted on Tuesday, September 09, 2008</h2><P>I just love Winforms data binding but I have had some problems using it in VS 2008 (and for that matter had similar problems in VS 2005 as well)</P>
<P>I have Googled high and low for any articles, blogs, etc (as one does) that might mention the issues&nbsp;I find,&nbsp;but to no avail. So I thought I might take the liberty of asking here, where the likelyhood of people doing the same as me is high, so please accept my apologies for going off topic.</P>
<P>Everything starts&nbsp;out fine. New project, generate some new CSLA based objects and then create a form and add a new data source, selecting 'object' data source, add reference to Business Object library assembly then drilling through the treeview to the object I want to bind to. No problems all is well. </P>
<P>Many objects added and forms designed later it all starts to go pear shaped. My BOs are geneated with partial class files and i decide to add a property to the user code file. I then rebuild the assembly go to the form designer data sources window and refresh the data sources. I then look for the new property in the data source and it is not there. What a pain, Ok stuff happens, so I delete the data source and add it again, no luck. Get Reflector and look at the assembly, the property is there no problem. So I clean, rebuld, shutdown VS restart, kick the cat, make a cup of tea and after a lot of messing around the property appears. </P>
<P>Now recently I added new objects to the library project and went to create&nbsp; data sources based on them,&nbsp;but cant see them in the 'Add Data Source' wizzard. Again Reflector to check and there they are, I havent got much hair to start with but it is getting&nbsp;thinner day by day. </P>
<P>Ok, you probably get the drift by now. This is bloody anoying. So has anyone any ideas of what I am doing wrong, know of any known issues that I haven't tracked down, or has any magic chants that I can recite to excorcise the deamons in VS to let me get on with the work in hand.</P>
<P>Any ideas warmly&nbsp;welcomed.</P>
<P>Simon</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, September 09, 2008</h2>Are your BOs in the same assembly as the forms?&nbsp; That will cause some problems.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>simon_may replied on Tuesday, September 09, 2008</h2>No. Separate projects/assemblies, same solution</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, September 09, 2008</h2>What is your configuration of version numbers on you assemblies (in particular the BO assemblies). <br>Datasources are stamped with version number in the xml-file. <br><br>There has been some problems concerning generic classes:<br><a href="http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=249597&amp;SiteID=1">http://forums.microsoft.com/MSDN/ShowPost.aspx?PostID=249597&amp;SiteID=1 </a><br><br>Partial classes and duplicate summary tags may also cause problems:<br><a href="http://forums.msdn.microsoft.com/en-US/csharpide/thread/ecaa4be7-6b2c-4f69-83bd-f0883ab3b168/">http://forums.msdn.microsoft.com/en-US/csharpide/thread/ecaa4be7-6b2c-4f69-83bd-f0883ab3b168/ </a><br><br>And a couple of other tips here to:<br><a href="http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=105432">http://connect.microsoft.com/VisualStudio/feedback/ViewFeedback.aspx?FeedbackID=105432</a><br><a href="http://connect.microsoft.com/VisualStudio/feedback/Workaround.aspx?FeedbackID=105432">http://connect.microsoft.com/VisualStudio/feedback/Workaround.aspx?FeedbackID=105432</a><br><br>Hope this helps - and keep us updated on your findings.<br><br>/jonnybee<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>simon_may replied on Wednesday, September 10, 2008</h2><P>Hi JonnyBee, Thanks for the suggestion and links. There is no disparity between the version numbers. </P>
<P>In fact I started a completely new solution and a new form and created a new data source from the original problem BO library&nbsp;assembly. Same result: could not see the the BO that I had added.</P>
<P>Somthing is very wrong here but I just cannot put my finger on it. I am wondering as to how VS treats the objects it is binding to. Is it creating shadow dirctories and app domains as I beleive it does when dealing with web form databinding sources (little knowledge here) and for some reason it has not using the latest version of the library. I have deleted all instances of the library and then rebuilt. same problem. </P>
<P>Added a new project (library) to my test solution and a test class with test property, went to form designer and created data source - no problems. Wierd</P>
<P>Simon</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Wednesday, September 10, 2008</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>simon_may:</strong></div><div>
<P>...so I clean, rebuld, shutdown VS restart, kick the cat, make a cup of tea and after a lot of messing around the property appears. ...</P>
<P></div></BLOCKQUOTE></P>
<P>I think this is the crux of the issue, something goes haywire in VS that can only be fixed by either a complete rebuild or by exiting&nbsp;and restarting it. </P>
<P>I have similar&nbsp;problems with data sources too -- I'll go to add one and my assembly doesn't show up in the list. </P>
<P>Also, user controls I have built start breaking in the designer with bizarre messages (type not found, type couldn't be loaded, type doesn't implement a method that it obviously does, etc.). I do nothing other than close and reopen VS, and it's fixed. </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>simon_may replied on Wednesday, September 10, 2008</h2><P>Yeah,&nbsp;VS&nbsp;restarts have helped in the past but not this time (also have had problems with user controls as well, although not for quite a while). Maybe it will have to be a reinstall. What a pain.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>simon_may replied on Wednesday, September 10, 2008</h2><P>Ok, someone show me where the humble pie is (this was all pretty much self inflicted). </P>
<P>The classes concerned&nbsp;were not public, duh!!! (VS's default&nbsp;'add new item' template does not generate an access modifier for the class and I had forgotten to change that).</P>
<P>However, there is some mittigation for my post. </P>
<P>First of all, I have had problems with properties not showing up as expected rsbaker0 has kindly confirmed that there are problems. So I didnt have as open a mind as I should have.</P>
<P>Secondly, these new classes were in a new namespace and even&nbsp;this namespace was not&nbsp;present in the the 'add data source' wizzard (This led me to beleive that there was something badly wrong because of course Reflector showed the namespace no problem). Obviously, if the wizzard does not see any public classes it sees no point in including the namespace. </P>
<P>Anyway sorry for wasting peoples' time and thanks to those who took a look and especially&nbsp;to the guys who responded.</P>
<P>Anyway back to the grind.</P>
<P>Simon</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
