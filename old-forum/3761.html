<html><header><title>Databinding: Child Collections/Child Bindingsources</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Databinding: Child Collections/Child Bindingsources</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3761.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Patrick.Roeper posted on Monday, October 22, 2007</h2><P><FONT face=Tahoma size=2>This is a curiousity question geared towards databinding (and possibly CSLA)... ProjectTracker &gt; PTWin &gt; ProjectEdit.cs has an editable root project object with its 'resources' collection databound towards the bottom of the control.</FONT></P>
<P><FONT face=Tahoma size=2>There are 2 bindingsources on the control&nbsp;related to this Project -&gt; Resources object hierarchy: projectBindingSource &amp; resourcesBindingSource.</FONT></P>
<P><FONT face=Tahoma size=2>projectBindingsource has a datasource of 'ProjectTracker.Library.Project' and resourcesBindingSource is set to 'projectBindingSource' with a DataMember of 'Resources'. </FONT></P>
<P><FONT face=Tahoma size=2>I am unsure as to why 2 bindingsources are needed? The resources collection of a project is displayed in a DataGridView control with its datasource set to the resourcesBindingSource. If I were to changed the datasource of the DataGridView control to point to projectBindingSource and change its datamember property to be 'Resources' (basically moving the databinding off of a bindingsource control and putting it directly on the UI control) I get the same runtime result... I think?</FONT></P>
<P><FONT face=Tahoma size=2>Can someone explain what function is served by keeping the child collection's databinding in&nbsp;a seperate bindingsource? I was thinking it had something to do with BeginEdit()'s needing to be called on bindingsources directly or something.... Thanks in advance.</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, October 22, 2007</h2>Hmm, good question.<br><br>The only answer I can think of is if you want to listen for events from the collection but not the parent object.&nbsp; You would wire your events in the designer for the BS_ItemChanged and BS_CurrentItemChanged and not need to worry about removing / adding the event handlers when the collection changes (such as when you get a clone back from remoting).<br><br>I'm not sure about the BeginEdits one way or the other... like I said, good question. <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, November 01, 2007</h2><P>This is the result if you do drag-and-drop from the Data Sources window to set up the bindings on the controls. I always use drag-and-drop binding to bind my controls, as I find that to be more reliable than doing the bindings by hand.</P>
<P>However, if setting the DataMember by hand works for you and makes your world simpler, then go for it! :)</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Patrick.Roeper replied on Thursday, November 01, 2007</h2><P>Well the value add is the SaveProject code can now be removed of any child bindingsource references, and using generics I can now have 1 method that will take care of all UI-Root Business object saving. I try to promote tight coupling when I am given the opportunity! </P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
