<html><header><title>Error in dynamically loading DAL provider</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Error in dynamically loading DAL provider</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10993.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>kyuze posted on Saturday, December 17, 2011</h2><p>Hello, Rocky.</p>
<p>I am implementing the (preferred) encapsulated model using provider pattern.&nbsp; Any idea why I get the following error in my DALFactory? This seems to be referencing a file local to your machine?</p>
<p>Locating source for<b> &#39;D:\Users\Illiante\Documents\Visual Studio 2010\Projects\csla\Source\Csla\Reflection\MethodCaller.cs&#39;.</b> Checksum: MD5 {76 4e 81 85 6c 39 8b 4a 5d 2a 2 86 28 c0 c4 8d}</p>
<p>The file <b>&#39;D:\Users\Illiante\Documents\Visual Studio 2010\Projects\csla\Source\Csla\Reflection\MethodCaller.cs&#39; does not exist.</b></p>
<p>My code looks like:</p>
<p>namespace TechSlice.DAL<br />{<br />&nbsp;&nbsp;&nbsp; public static class DALFactory<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private static Type _dalType;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static IDALManager GetManager() <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_dalType == null)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var dalTypeName = ConfigurationManager.AppSettings[&quot;DalManagerType&quot;];<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!string.IsNullOrEmpty(dalTypeName))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _dalType = Type.GetType(dalTypeName);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw new NullReferenceException(&quot;DalManagerType&quot;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (_dalType == null)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw new ArgumentException(string.Format(&quot;Type {0} could not be found&quot;, dalTypeName));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return (IDALManager)Activator.CreateInstance(_dalType);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; }<br />}</p>
<p>Value of key in App.config is &quot;TechSlice.DAL.Mock.DALManager,TechSlice.DAL.Mock&quot;</p>
<p>Thanks!</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kyuze replied on Saturday, December 17, 2011</h2><p>p.s. I am running the latest version, CSLA 4.2.2.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Sunday, December 18, 2011</h2><p>That error is because Visual Studio is trying to load the source file so you can step through the code. Perhaps the pdb file contains my build path as one location where it looks for the source.</p>
<p>That has nothing to do with the actual issue you are seeing which would be revealed by the runtime exception information. It is that information (along with the stack trace) we need to see to help you.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kyuze replied on Monday, December 19, 2011</h2><p>
<p>Here is the call stack. &nbsp;The error is :<b>&nbsp;Csla.DataPortalException: DataPortal.Fetch failed (Type TechSlice.DAL.Mock.DALManager,TechSlice.DAL.Mock could not be found) ---&gt; Csla.Reflection.CallMethodException: DataPortal_Fetch method call failed ---&gt; System.ArgumentException: Type TechSlice.DAL.Mock.DALManager,TechSlice.DAL.Mock could not be found</b></p>
<div>My DALFactory is located in TechSlice.DAL and DALManager is located in namespace TechSlice.DAL.Mock. &nbsp;The value I assign to dalTypeName in DALFactory is &quot;TechSlice.DAL.Mock.DALManager,TechSlice.DAL.Mock&quot;.</div>
<div></div>
<p>&gt;<span>	</span>Csla.dll!Csla.Reflection.MethodCaller.CallMethod(object obj, Csla.Reflection.DynamicMethodHandle methodHandle, object[] parameters) Line 547<span>	</span>C#</p>
<p>&nbsp;<span>	</span>Csla.dll!Csla.Reflection.MethodCaller.CallMethod(object obj, string method, object[] parameters) Line 413 + 0xe bytes<span>	</span>C#</p>
<p>&nbsp;<span>	</span>Csla.dll!Csla.Reflection.LateBoundObject.CallMethod(string method, object[] parameters) Line 93 + 0x19 bytes<span>	</span>C#</p>
<p>&nbsp;<span>	</span>Csla.dll!Csla.Server.SimpleDataPortal.Fetch(System.Type objectType, object criteria, Csla.Server.DataPortalContext context) Line 131 + 0x56 bytes<span>	</span>C#</p>
<p>&nbsp;<span>	</span>Csla.dll!Csla.Server.DataPortalSelector.Fetch(System.Type objectType, object criteria, Csla.Server.DataPortalContext context) Line 77 + 0x13 bytes<span>	</span>C#</p>
<p>&nbsp;<span>	</span>Csla.dll!Csla.Server.DataPortal.Fetch(System.Type objectType, object criteria, Csla.Server.DataPortalContext context) Line 195 + 0x12 bytes<span>	</span>C#</p>
<p>&nbsp;<span>	</span>Csla.dll!Csla.DataPortalClient.LocalProxy.Fetch(System.Type objectType, object criteria, Csla.Server.DataPortalContext context) Line 49 + 0x1b bytes<span>	</span>C#</p>
<p>&nbsp;<span>	</span>Csla.dll!Csla.DataPortal.Fetch(System.Type objectType, object criteria) Line 215 + 0x12 bytes<span>	</span>C#</p>
<p>&nbsp;<span>	</span>Csla.dll!Csla.DataPortal.Fetch&lt;TechSlice.Lib.PersonEditBO&gt;(object criteria) Line 170 + 0x3f bytes<span>	</span>C#</p>
<p>&nbsp;<span>	</span>TechSlice.Lib.dll!TechSlice.Lib.PersonEditBO.GetPersonEditBO(int id) Line 61 + 0x29 bytes<span>	</span>C#</p>
<p>&nbsp;<span>	</span>TechSlice.UI.exe!TechSlice.UI.Form1.button1_Click(object sender, System.EventArgs e) Line 22 + 0x27 bytes<span>	</span>C#</p>
<p>&nbsp;<span>	</span>[External Code]<span>	</span></p>
<p>&nbsp;<span>	</span>TechSlice.UI.exe!TechSlice.UI.Program.Main() Line 18 + 0x1d bytes<span>	</span>C#</p>
<div></div>
</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Monday, December 19, 2011</h2><p>See this thread:&nbsp;http://forums.lhotka.net/forums/t/10963.aspx&nbsp;</p>
<p>Same issue.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kyuze replied on Tuesday, December 20, 2011</h2><p>Thanks, JonnyBee. &nbsp;As a temporary work around, I had created another layer that allows me to have a reference to my DALManager dll in my DALFactory project while still maintaining a reference to the DALFactory in the DALManager without creating a circular reference. &nbsp;This obviously was not sustainable. Thanks again for your help.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
