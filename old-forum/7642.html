<html><header><title>LINQ in Silverlight to WPF &gt; ArgumentNullException</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>LINQ in Silverlight to WPF &gt; ArgumentNullException</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7642.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius posted on Wednesday, September 16, 2009</h2><P>I've run into some differing runtime troubles&nbsp;regarding LINQ syntax behaving differently from SILVERLIGHT to WPF.&nbsp; Because I rarely code in WPF, I at first thought this was due to the differences between the CLRs, but now I'm wondering if it's due to the differences in Csla to CslaLight...</P>
<P>First, I posted on the Silverlight forums here:</P>
<P><A href="http://forums.silverlight.net/forums/t/128859.aspx">http://forums.silverlight.net/forums/t/128859.aspx</A></P>
<P>Is it possible that there's a difference in these two frameworks (Csla and CslaLight) instead?</P>
<P>
<P><FONT size=2></FONT></P><FONT size=2>
<P></P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius replied on Wednesday, September 16, 2009</h2><P><FONT size=2>I'm looking into it, but is there a difference in the way the CslaQueryProvider implements IQueryProvider in CslaLight vs. Csla?</FONT></P>
<P><FONT size=2>EDIT: I see now that CslaLight doesn't even have CslaQueryProvider. </P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius replied on Wednesday, September 16, 2009</h2><P>Confirmed that this is related to CSLA only&nbsp;(atleast somehow)</P>
<P>the following syntax works fine and does not throw an arguement null exception in WPF and returns an empty IEnumerable list, whereas performing the same query on a BusinessListBase does throw an ArgumentNullException</P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>var</FONT></FONT><FONT size=2> testList = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>new</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>List</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2>&gt;() { };</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>var</FONT></FONT><FONT size=2> testQuery = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>from</FONT></FONT><FONT size=2>&nbsp;s </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>in</FONT></FONT><FONT size=2> testList</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>where</FONT></FONT><FONT size=2> s.Contains(</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"test for s being null"</FONT></FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>select</FONT></FONT><FONT size=2> s;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius replied on Monday, September 21, 2009</h2><P>Can anyone help me understand what I'm seeing here? It really doesn't make sense to me that I see this behavior from Csla object when porting from Silverlight&nbsp;and&nbsp;WPF</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, September 21, 2009</h2><P>There is a difference in CSLA - in that CSLA .NET for Windows includes LINQ to CSLA and CSLA .NET for Silverlight does not.</P>
<P>In other words, CSLA .NET doesn't do anything with LINQ on the Silverlight platform - so the behaviour you see there is whatever LINQ to Objects does for any list or collection.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius replied on Friday, October 02, 2009</h2><P>Thanks for the response. I kind of presumed this might be the case, but it was certainly not immediately obvious. Now I understand why my app is running so coarse due to these LINQ queries! Any possibility of a LINQ to CSLA for SL?</P>
<P>Further, though I'm no expert on the subject,&nbsp;it seems like throwing exceptions with the following code examples breaks code. IMHO of course. If you have any suggestions to avoid these problems, I'm all ears.</P>
<P>1. For example the following syntax. If the where clause fails to return anything, in SILVERLIGHT (w/ LINQ to object) tmp will be assigned to null.&nbsp; However, in LINQ to CSLA, the LINQ query throws an ArgumentNullException if the where clause can't find anything.<FONT color=#0000ff size=2><FONT color=#0000ff size=2></P>
<BLOCKQUOTE>var</FONT></FONT><FONT color=#444444 size=2>&nbsp;tmp = </FONT><FONT size=2><FONT size=2><FONT size=2><FONT size=2></FONT></FONT></FONT></FONT></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<BLOCKQUOTE>from</FONT></FONT><FONT color=#000000 size=2> something </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>in</FONT></FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT><FONT size=2><FONT color=#000000>.SomeList</FONT></FONT></FONT></FONT><FONT size=2><FONT color=#444444> </FONT>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>where</FONT></FONT><FONT size=2>&nbsp; something.Value == someOtherValue</FONT></P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>select</FONT></FONT><FONT size=2> something;</FONT><FONT size=2></BLOCKQUOTE></BLOCKQUOTE>
<P></FONT></FONT></FONT><FONT size=2>(Workaround) The syntax below works in both environments by using a Where clause with a lambda expression:</FONT></P>
<BLOCKQUOTE>var<FONT size=2>&nbsp;tmp = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2></FONT></FONT></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<BLOCKQUOTE>from</FONT></FONT><FONT color=#000000 size=2> something </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>in</FONT></FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT><FONT size=2><FONT color=#000000>.SomeList.Where(s =&gt; s.Value == someOtherValue)</FONT></FONT></FONT></FONT><FONT size=2><FONT color=#444444> </FONT>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>select</FONT></FONT><FONT size=2> something;</FONT></P></BLOCKQUOTE></BLOCKQUOTE>
<P>2. Below assigns null to tmp in&nbsp;LINQ&nbsp;to objects&nbsp;if the query is null, but throws an ArgumentNullException in WPF (LINQ to CSLA) &nbsp;if the query returns null.</P>
<BLOCKQUOTE dir=ltr>
<P>var<FONT size=2>&nbsp;tmp = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2></FONT></FONT></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2></FONT></FONT></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2></P>
<BLOCKQUOTE>(from</FONT></FONT><FONT color=#000000 size=2> something </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>in</FONT></FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>this</FONT></FONT><FONT size=2><FONT color=#000000>.SomeList.Where(s =&gt; s.Value == someOtherValue)</FONT></FONT></FONT></FONT><FONT size=2><FONT color=#494949> </FONT>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>select</FONT></FONT><FONT size=2> something).FirstOrDefault();</FONT></P></BLOCKQUOTE></BLOCKQUOTE></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AaronErickson replied on Monday, October 05, 2009</h2>Hi - this is Aaron Erickson, the developer of the Linq to CSLA portion of CSLA.<br><br>Indeed, looks like you found a behavior difference which would be a bug.&nbsp; I expect to work on a fix during VSLive this week.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>decius replied on Monday, December 07, 2009</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>Aaron Erickson:</strong></div><div></P>
<P>Indeed, looks like you found a behavior difference which would be a bug.&nbsp; I expect to work on a fix during VSLive this week.</P>
<P></div></BLOCKQUOTE><BR></P>
<P>Just curious, was this resolved?</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
