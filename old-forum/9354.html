<html><header><title>MVVM - Possible to use Lambda expression for stronly named method name in ViewModel.BeginRefresh(...) method?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>MVVM - Possible to use Lambda expression for stronly named method name in ViewModel.BeginRefresh(...) method?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9354.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jaans posted on Tuesday, August 10, 2010</h2><p>Hi Rocky</p>
<p>I&#39;m going through the MVVM video series and it occurred to me that it would be very nice if the ViewModel.BeginRefresh( string methodName ) method was capable of using a &quot;non-magic string&quot; syntax like like we do with the RegisterProperty convention?</p>
<p>The RegisterProperty scenario I&#39;m referring to is this:</p>
<p style="padding-left:30px;">public static PropertyInfo&lt;string&gt; LastNameProperty = RegisterProperty&lt;string&gt;(<strong> c =&gt; c.LastName </strong>);</p>
<p>Would it be possible to do something similar for a method name? For example:</p>
<p style="padding-left:30px;">BeginRefresh( c =&gt; c.NewEmployeeEdit );</p>
<p>Possibly, another location also that could benefit from the Property version is the business rules section, but I haven&#39;t looked at the new CSLA 4.0 implementation in earnest yet.</p>
<p>It&#39;s usefull for us as it helps my team to not miss a reference to a property name / method name when there is renaming required, especially when it&#39;s in a &quot;magic string&quot; format.</p>
<p>I&#39;m not sure whether this is even at all technically possible for method names and or whether there are other implications that need to be considered. Just though I&#39;d raise the question since it appears to be of value in create a more concise and maintainable CSLA business object.</p>
<p>Jaans</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Tuesday, August 10, 2010</h2><p>I think that&#39;s actually in there now. I remember it being a work item at least, though I didn&#39;t do it (maybe Peran did?).</p>
<p>Obviously that uses reflection to translate the lambda into an actual string name, but I suspect the perf hit is extremely trivial, and as you note, the maintainability is better.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Peran replied on Wednesday, August 11, 2010</h2><p>Hi Janns</p>
<p>This was implemented in Csla 4 ViewModelBase for DoRefresh (sync) and BeginRefresh (async) methods.&nbsp; There are examples of its use in the code comments.</p>
<p>&nbsp;</p>
<p>

<pre style="font-family:consolas;">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:gray;">///</span><span style="color:green;">&nbsp;</span><span style="color:gray;">&lt;example&gt;</span><span style="color:green;">DoRefresh(()&nbsp;=&gt;&nbsp;BusinessList.GetList())</span><span style="color:gray;">&lt;/example&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:gray;">///</span><span style="color:green;">&nbsp;</span><span style="color:gray;">&lt;example&gt;</span><span style="color:green;">DoRefresh(()&nbsp;=&gt;&nbsp;BusinessList.GetList(id))</span><span style="color:gray;">&lt;/example&gt;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">protected</span>&nbsp;<span style="color:blue;">void</span>&nbsp;DoRefresh(<span style="color:#2b91af;">Func</span>&lt;T&gt;&nbsp;factoryMethod)<br /><br /><pre style="font-family:consolas;">&nbsp;&nbsp; <span style="color:gray;">///</span><span style="color:green;">&nbsp;</span><span style="color:gray;">&lt;example&gt;</span><span style="color:green;">BeginRefresh(handler&nbsp;=&gt;&nbsp;BusinessList.BeginGetList(handler))</span><span style="color:gray;">&lt;/example&gt;</span><br />&nbsp;&nbsp; <span style="color:gray;">///</span><span style="color:green;">&nbsp;</span><span style="color:gray;">&lt;example&gt;</span><span style="color:green;">BeginRefresh(handler&nbsp;=&gt;&nbsp;BusinessList.BeginGetList(id,&nbsp;handler))</span><span style="color:gray;">&lt;/example&gt;</span><br />&nbsp;&nbsp; <span style="color:blue;">protected</span>&nbsp;<span style="color:blue;">void</span>&nbsp;BeginRefresh(<span style="color:#2b91af;">Action</span>&lt;<span style="color:#2b91af;">EventHandler</span>&lt;<span style="color:#2b91af;">DataPortalResult</span>&lt;T&gt;&gt;&gt;&nbsp;factoryMethod)<br /></pre>
<br /><br /></pre>
</p>
<p>Regards</p>
<p>&nbsp;</p>
<p>Peran</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jaans replied on Wednesday, August 11, 2010</h2><p>That&#39;s just excellent! <br /><br />It&#39;s very nice how the BeginRefresh for a Action does not have to concern itself with the parameters of the BO factory method as this is done in the call itself. Very clean indeed</p>
<p>Thanks Guys</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jaans replied on Wednesday, August 11, 2010</h2><p>I have peeked at the business rules API for CSLA 4 and it looks so much more concise and contained.</p>
<p>In line with this thread, would it make sense to&nbsp;have the Csla.Core.BusinessRule baseclass&#39;s constructor provide support for using a Lambda expression to reference the property to which the rule should apply. </p>
<p>This would then also follow onto the derived classes and further decendants. E.g. Csla.Rules.CommonRules.CommonBusinessRule and also the other built-in common rules.</p>
<p>I&#39;m hoping for a usage pattern similar to RegisterProperty along the following lines:</p>
<pre style="font-family:consolas;">BusinessRules.AddRule(&nbsp;<span style="color:blue;">new</span>&nbsp;Csla.Rules.CommonRules.<span style="color:#2b91af;">Required</span>(&nbsp;<strong>c&nbsp;=&gt;&nbsp;c.LastName</strong>&nbsp;)&nbsp;);<br /></pre>
<p>Again the same motivation applies - less dependency on &quot;magic strings&quot; and increased maintainability.</p>
<p>Jaans</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, August 11, 2010</h2><p>CSLA 4 requires the use of PropertyInfo&lt;T&gt; fields to avoid the magic string, and to avoid reflection. </p>
<p>There area a few cases where a string property name is still allowed, because data binding is all string-based, but normally your should expect to use a propertyinfo field.</p>
<p>The lambda thing isn&#39;t necessarily ideal. Its implementation requires the use of reflection. The whole idea of the propertyinfo fields is to do that reflection once per property for the entire life of the app, so we&#39;re not paying that cost continually as the app is being used.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jaans replied on Wednesday, August 11, 2010</h2><p>You&#39;re totally right.</p>
<p><img src="http://forums.lhotka.net/emoticons/emotion-10.gif" alt="Embarrassed" /> I missed the IPropertyInfo in the signature... cannot now figure how I thought it required a string parameter. My mistake... sorry for wasting your time!</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
