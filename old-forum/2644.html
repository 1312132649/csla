<html><header><title>ReadOnlyBase Constructors - Newbie Question</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ReadOnlyBase Constructors - Newbie Question</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2644.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>JabbaTheNut posted on Saturday, March 31, 2007</h2><P>My question is this...</P>
<P><STRONG>Must</STRONG> I have a private constructor in&nbsp;a ReadOnlyBase&nbsp;object?</P>
<P>I have a SecurityPolicy object that has a couple of validation methods (to verify proper password format, expired passwords, account lockouts, etc.).&nbsp; Each of these methods returns a SecurityPolicyStatus object that provides the result of the validation method,&nbsp;as well as&nbsp;a list of any broken policies.&nbsp; This object is intended for internal consumption and should not be used by the UI.&nbsp; The SecurityPolicyStatus object is instantiated and&nbsp;populated directly by each of the respective SecurityPolicy object methods, based on data existing inside the SecurityPolicy object.&nbsp; Consequently,&nbsp;there is no need for&nbsp;any DataPortal methods in the SecurityPolicyStatus object to retrieve data from the database.&nbsp;&nbsp;Below is the code of my object (please note that Base.LVReadOnlyBase is a subclass of Csla.ReadOnlyBase).&nbsp; It does not currently have a private constructor.</P>
<P>&nbsp;&nbsp;&nbsp; [Serializable()]<BR>&nbsp;&nbsp;&nbsp; internal class SecurityPolicyStatus : Base.LVReadOnlyBase&lt;SecurityPolicyStatus&gt;<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # region Properties</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private Guid _id = Guid.NewGuid();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private bool _isValid;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private List&lt;string&gt; _brokenPolicies = new List&lt;string&gt;();</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// Determines whether or not the validation method <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// passed the required security policies.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; internal bool IsValid<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return _isValid; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _isValid = value;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// Gets a list of broken security policies.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; internal List&lt;string&gt; BrokenPolicies<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get { return _brokenPolicies; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; # endregion</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #region Business Methods</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// Adds a broken security policy to the &lt;see cref="BrokenPolicies"/&gt; list.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;param name="item"&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// A string describing the security policy that was broken.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/param&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; internal void AddBrokenPolicy(string item)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _brokenPolicies.Add(item);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// Returns a unique identifying value for the object.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected override object GetIdValue()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return _id;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #endregion</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #region Constructors</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// Class constructor<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; internal SecurityPolicyStatus(){ }</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #endregion</P>
<P>&nbsp;&nbsp;&nbsp; }<BR></P>
<P>The&nbsp;internal constructor&nbsp;is used by the SecurityPolicy object to instantiate the SecurityPolicyStatus object.&nbsp; </P>
<P>My confusion comes from the ResourceInfo object in the CSLA.Net book (page 448).&nbsp; It provides both private and internal constructors.&nbsp; The book states that the private constructor prevents the UI from instantiating the object.&nbsp; But, doesn't&nbsp;the internal constructor also prevent the UI from instantiating the object?&nbsp; My assumption is that the business objects are contained within their own assembly, separate from the UI (like the ProjectTracker.Library is).</P>
<P>I realize this is a very basic question and apologize in advance for any offense.&nbsp; I just want to solidify my understanding before I get too deep and discover that I missed something fundamental that will require recoding.</P>
<P>Thanks for your help.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Monday, April 02, 2007</h2>Hello,<br><br>Maybe the following helps you in your reasoning:<br>- private constructors are accessible only from within the same class<br>&nbsp;&nbsp;&nbsp; - typically they are invoked from a shared (static) factory method<br>&nbsp;&nbsp;&nbsp; - the central idea of factory methods paired with private constructors is that your object needs some initalization (e.g. calling dp_create) which you make more explicit in a factory method than with default constructors<br><br>- protected constructors are accessible from within the class and from any descendant class<br>&nbsp;&nbsp;&nbsp; - you typically use these on abstract classes that do not yet provide factory methods (you expect these to be defined on the concrete subclasses)<br><br><br>Both private and protected members are not accessible from any external object.<br><br>There is one caveat of course, and that would be reflection. In the end any member IS accessible (even private ones) through the use of reflection (note for example that the dp_methods are protected, yet the dataportal is able to invoke them through reflection).<br><br><br>HTH<br>Bayu<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, April 02, 2007</h2>Well, the goal is to keep the UI from creating objects via a constructor.&nbsp; If your business library needs to use a constructor though, its fine to make one internal... but I wouldn't make it public.<br><br>OTOH, I always keep my constructors private, instead using internal factory methods for BOs to create other BOs.&nbsp; There isn't really any technical reason to do this... its more for consistence within the BO library.&nbsp; Every BO is created by a factory method.<br><br>The key though is that yes, your BO should be in its own seperate assembly.&nbsp; If its in with the UI project, the UI project has access to all the interally marked members as well, and that's what you're trying to prevent.<br><br>As far as going with private / protected constructors and internal factory methods, vs. jut having an internal constructor, the choice is up to you.&nbsp; As long as your consistent, you should be fine.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Tuesday, April 03, 2007</h2><P>One other thing to consider:</P>
<P>Every class in your library does NOT need to derive from CSLA. In this case you are probably better off skipping the inheritance entirely. Now you "stand alone" class is clearly something used internally by the parent class. You can create instances of it and store them, etc.</P>
<P>Joe</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
