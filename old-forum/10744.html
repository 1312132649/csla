<html><header><title>ViewModel&lt;&gt; Save in Silverlight</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ViewModel&lt;&gt; Save in Silverlight</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10744.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jh72i posted on Thursday, October 06, 2011</h2><p>Hi folks,<br />I want to implement a grid-style interface whereby every cell is editable. I follow the MvvM pattern and all is fine except on Save. Whenever I trigger save its gets called for the individual item and not for the collection as a whole.</p>
<p>Any ideas how to sort this one out?</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><font face="Courier New" size="1" color="#a31515"><font face="Courier New" size="1" color="#a31515"><font face="Courier New" size="1" color="#a31515">
<p>&nbsp;</p>
</font></font></font></span><font face="Courier New" size="1" color="#a31515"><font face="Courier New" size="1" color="#a31515">
<p>&nbsp;</p>
</font></font></span><font face="Courier New" size="1" color="#a31515">
<p>&nbsp;</p>
</font></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">&lt;</span></span></span><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;">UserControl.Resources</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">&gt;<br /></span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">&lt;</span></span></span><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;">CollectionViewSource</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"> x</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">:</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;">Key</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">=&quot;mainViewModelViewSource&quot;</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"> d</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">:</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;">DesignSource</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">=&quot;{</span></span></span><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;">d</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">:</span></span></span><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;">DesignInstance</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"> myVM</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">:<span style="color:#2b91af;">EditableCollectionVM</span></span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">,</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"> CreateList</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">=True}&quot; /&gt;<br /></span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">&lt;</span></span></span><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;">CollectionViewSource</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"> x</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">:</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;">Key</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">=&quot;mainViewModelModelViewSource&quot;</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"> Source</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">=&quot;{</span></span></span><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;">Binding</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"> Path</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">=Model,</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"> Source</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">={</span></span></span><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;">StaticResource</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"> mainViewModelViewSource</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">}}&quot; /&gt;<br /></span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">&lt;/</span></span></span><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;">UserControl.Resources</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">&gt;</span></span></span></p>
<p><span style="font-family:Courier New;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">...then a grid...</span></span></p>
<p><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">..then a button...and a trigger action:</span></p>
<p>&nbsp;<span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">&lt;</span></span></span><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;">Xaml</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">:</span></span></span><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;">TriggerAction</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"> TargetControl</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">=&quot;{</span></span></span><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;">Binding</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"> ElementName</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">=SaveButton}&quot;</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"> TriggerEvent</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">=&quot;Click&quot;</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"> MethodName</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">=&quot;Save&quot; /&gt;</span></span></span></p>
<p><span style="font-family:Courier New;font-size:xx-small;"><span style="font-family:Courier New;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><font face="Courier New" size="1" color="#0000ff"><font face="Courier New" size="1" color="#0000ff"><font face="Courier New" size="1" color="#0000ff">
<p>public</p>
</font></font></font></span><font face="Courier New" size="1" color="#0000ff"><font face="Courier New" size="1" color="#0000ff">
<p>&nbsp;</p>
</font></font></span><font face="Courier New" size="1" color="#0000ff">
<p>&nbsp;</p>
</font></span>
<p><span style="font-family:Courier New;font-size:xx-small;"><span style="font-family:Courier New;font-size:xx-small;"> </span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">class</span></span></span><span style="font-family:Courier New;font-size:xx-small;"><span style="font-family:Courier New;font-size:xx-small;"> </span></span><span style="font-family:Courier New;color:#2b91af;font-size:xx-small;"><span style="font-family:Courier New;color:#2b91af;font-size:xx-small;"><span style="font-family:Courier New;color:#2b91af;font-size:xx-small;">EditableCollectionVM</span></span></span><span style="font-family:Courier New;font-size:xx-small;"><span style="font-family:Courier New;font-size:xx-small;"> : </span></span><span style="font-family:Courier New;color:#2b91af;font-size:xx-small;"><span style="font-family:Courier New;color:#2b91af;font-size:xx-small;"><span style="font-family:Courier New;color:#2b91af;font-size:xx-small;">ViewModel</span></span></span><span style="font-family:Courier New;font-size:xx-small;"><span style="font-family:Courier New;font-size:xx-small;">&lt;</span></span><span style="font-family:Courier New;color:#2b91af;font-size:xx-small;"><span style="font-family:Courier New;color:#2b91af;font-size:xx-small;"><span style="font-family:Courier New;color:#2b91af;font-size:xx-small;">EditableCollection</span></span></span><span style="font-family:Courier New;font-size:xx-small;"><span style="font-family:Courier New;font-size:xx-small;">&gt;
<p>&nbsp;</p>
</span></span></p>
</span></span></p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Thursday, October 06, 2011</h2><p>Set the DataContext on the TriggerAction control to point to your business object.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jh72i replied on Friday, October 07, 2011</h2><p>Thanks Rocky.<br /><br />A rookie mistake: I had forgotten that i needed to put the <em>Path=Model</em> on the collectionViewSource that grid was bound to. For anyone similarly&nbsp;struggling my trigger now simply looks like:<br /><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">&lt;</span></span></span><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;">Xaml</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">:</span></span></span><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;">TriggerAction</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"> DataContext</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">=&quot;{</span></span></span><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;">StaticResource</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"> mainViewModelViewSource</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">}&quot;</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"> TargetControl</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">=&quot;{</span></span></span><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;"><span style="font-family:Courier New;color:#a31515;font-size:xx-small;">Binding</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"> ElementName</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">=SaveButton}&quot;</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"> TriggerEvent</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">=&quot;Click&quot;</span></span></span><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"><span style="font-family:Courier New;color:#ff0000;font-size:xx-small;"> MethodName</span></span></span><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;">=&quot;Save&quot; /&gt;</span></span></span></p>
<p><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Courier New;color:#0000ff;font-size:xx-small;"><span style="font-family:Arial;color:#000000;font-size:x-small;">Rocky, I notice from the sample mentioned earlier that you also wrap access to the business objects in the collection in a viewmodel. I thought one of the reason for you exposing&nbsp;the Model property was so that the presentation can pick up all the good aspects of your <em>rich</em> as opposed to <em>anaemic</em> models(business objects). Is there a preferred (correct!) way of doing this?</span></span></span></span></p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
