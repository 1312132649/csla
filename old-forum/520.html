<html><header><title>A Twist on User Security</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>A Twist on User Security</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/520.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>albruan posted on Friday, June 30, 2006</h2><P><FONT face=Tahoma>I'm in the preliminary stages of developing a replacement for a dBase III application for a client and have a question regarding user security since they're wanting something a little&nbsp;beyond CSLA's username/role security model.&nbsp; Basically, they are using a username/role security model with the addition of a third item/field named Department.&nbsp; With the client's existing application, each user is assigned a role such as administrator, estimator, manager, etc.; additionally, each user is assigned department(s) such as architectural, structural, electrical, etc.&nbsp;in which they're allowed to perform their job function.&nbsp; On top of this, a user may be a manager in the architectural department, but only an estimator in the structural department.&nbsp; So, the role table I need to create for this application would be something along the line of:</FONT></P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT face=Tahoma><U>User</U>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<U>Role</U>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<U>Department<BR></U>&nbsp;&nbsp;&nbsp;UserA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Architectural<BR>&nbsp;&nbsp;&nbsp;UserA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Structural<BR>&nbsp;&nbsp;&nbsp;UserB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;M&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Structural<BR>&nbsp;&nbsp;&nbsp;UserC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Architectural<BR>&nbsp;&nbsp;&nbsp;UserD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Architectural</FONT></P>
<P><FONT face=Tahoma>Has anyone encountered anything similar to this and, if so, how was it solved?</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>albruan replied on Friday, June 30, 2006</h2><P>I went back to the old forum and found that I could accomplish what I need by inheriting the BusinessIdentity and BusinessPrincipal classes and adding new properties for them in my new classes.&nbsp; At least I could if I were using CSLA 1.0 or 1.5; however, since I'm using CSLA 2.0 I'm not sure how to handle this since BusinessIdentity is no longer part of the CSLA framework.</P>
<P>Any suggestions?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Friday, June 30, 2006</h2>For your principal, inherit from BusinessPrincipalBase.&nbsp; For your identity, your class definition would start with:<br>public class AppIdentity : ReadOnlyBase&lt;AppIdentity&gt;, IIdentity<br><br>The PTracker application has examples of these.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>paul@citrusdev.co.uk replied on Sunday, July 02, 2006</h2><P>Surely the department is just another twist on the role.</P>
<P>&nbsp;</P>
<P>Can you not handle this solely using the orle based security model i.e. ElectricalManager.&nbsp; This preserves both the csla and microsoft way of handling security, it makes security for cross departmental functional far easier (role - "Managers").</P>
<P>Role based security, or even AD style group security all works on the same principle.&nbsp; It feels wrong to go against the grain with so much history behind the simpler model.</P>
<P>&nbsp;</P>
<P>P</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>reagan123 replied on Tuesday, April 22, 2008</h2><P>I'm bringing this one way back from the dead....</P>
<P>Has anyone else run into a situation like this were the user has different roles based on some third element?&nbsp; If so, what was&nbsp; your solution?</P>
<P>Thanks for any insight.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>raz0rf1sh replied on Tuesday, April 22, 2008</h2>Not sure if this will help or not, but in the environments that we write most of our applications for, it is VERY hard to put everyone in a specific role.&nbsp; We didn't want to define a bunch of roles that were specific to one or two actions. <br><br>What we decided to do was implement what we call checkpoints.&nbsp; These are specific permissions like Add User, Edit User, View User, Change User Password and so on.&nbsp; We added some additional properties to our BusinessPrincipal object to validate checkpoints and load all the Checkpoints for the user, similiar to the Roles.<br><br>This gave us MAXIMUM flexibility and allowed the customer to create Roles on the fly, and assigned Checkpoints to the Roles.<br><br>Hope this helps some,<br><br>Matt<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>reagan123 replied on Tuesday, April 22, 2008</h2><P>Interesting approach Matt.. makes sense... thanks for the reply.</P>
<P>Here's a little explanation in general for my scenario. Basically we have your typical setup where a person is assigned to a group and a group has a list of roles.&nbsp; </P>
<P>This worked fine except that now a user can belong to many organizations... they may in a different group&nbsp;in each organization.&nbsp;</P>
<P>Currently,&nbsp;we&nbsp;display all of the Organizations in a treeview.&nbsp; We need to load the group for that specified organization when they click on the node.&nbsp; For example, if Joe is logged in and clicks on Organization1... We need to know he has "Admin" rights for that organization.&nbsp; If he clicks on Organization2, he needs to only have "Clerk" rights.</P>
<P>Joe&nbsp;&nbsp;&nbsp; Organization1&nbsp;&nbsp;&nbsp; Admin<BR>Joe&nbsp;&nbsp;&nbsp; Organization2&nbsp;&nbsp;&nbsp; Clerk</P>
<P>Does that make sense?<BR><BR>Any other pointers or suggestions appreciated.<BR></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>raz0rf1sh replied on Tuesday, April 22, 2008</h2>Okay ... so there is one other thing that we do that I failed to mention! =)<br><br>Similiar to your organizations, we have multiple environments, in our case separate organizational units have to have their own database.&nbsp; So we create an Environment 1 for Company 1 and Environment 2 for Company 2.&nbsp; Each Environment has their own set of permissions, so the administrator can make sure users get the appropriate access based on environment.&nbsp; It's kind of a pain in the a$$ to manage, with many environment ... but it is very flexible ... and more importantly, it works.<br><br>In your case you might do something similiar.&nbsp; It sounds like your BusinessPrincipal would need to include the organizations and the permissions for each organization.&nbsp; The maybe have a method to authorize the role or checkpoint access but include the organization. <br><br>This is a bit of a variation on how we use our environments, but hopefully it gives you another idea.<br><br>Hope this helps,<br><br>Matt<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MGervais replied on Tuesday, April 22, 2008</h2><P><FONT face=Tahoma size=2>Matt,</FONT></P>
<P><FONT face=Tahoma size=2>I'd be interested in knowing how you solved this scenario. Our application will need to follow almost an identical path as you have described.</FONT></P>
<P><FONT face=Tahoma size=2>Do you keep a central User repository that tracks the databases a certain User has access to? If so, how do tell the application which database to access? If not, then is there any additional information you can share?</FONT></P>
<P><FONT face=Tahoma size=2>Thanks.</FONT></P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
