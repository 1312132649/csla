<html><header><title>Custom Event on Business Object</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Custom Event on Business Object</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/797.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jdelano posted on Thursday, August 03, 2006</h2><P>Okay, I really hope all these hard drive crashes aren't because of me.&nbsp; It seems like my posts are always the ones that get lost when something like that happens... :-(&nbsp; how sad.</P>
<P>Anyway, I'd like to re-post the question and "half-answer" I put up yesterday morning, partially because it may help someone else down the line, and partially because I still have some unresolved questions.&nbsp; Here goes...</P>
<P>I added a custom event to my business object following the pattern that Rocky covers in the book on page 101-102.&nbsp; So far so good. I create a form with a private "datasource" object (based on the one with the custom event) and declare it as "WithEvents". I set the private data source to the parameter that I pass in to the form's constructor, and then call BeginEdit on the object (almost exact replica of the way the ProjectEdit form works in the ProjectTracker App).&nbsp; In my form, I also have an event handler for the custom event in the business object. Code compiles fine, but when the form is actually shown, I get a "Form is not declared as serializable" (or some variant thereof) error. If I take away the event handler in the form, I get no errors--form displays fine. If I pop in an event handler for the PropertyChanged event, I get no errors either. </P>
<P>Rocky had suggested that I trace through the thing with the debugger, which I did. What I found was that at the call of BeginEdit, it was for some reason seeing the "mNonSerializableHandlers" as an available field to clone. As soon as I put the &lt;NotUndoable()&gt; attribute in front of it, then things worked fine. What I still don't understand is why the PropertyChanged custom event works fine WITHOUT the NotUndoable attribute, but my custom event seems to require it. Any ideas?</P>
<P>John Delano</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Thursday, August 03, 2006</h2>I don't see why you would want the event to have serializable handlers if what you're attempting to do is simply have an event for "progress", then you're likely to only use that in the ui. So I'd go for NOT having serializable handlers, which will make your code more readable...<br><br><br>The reason for rocky's PropertyChanged event not having issues with nlevel undo is this:<br><br>PropertyChanged is declared in BindableBase.<br>UndoableBase Inherits from BindableBase.<br>When UndoableBase looks for things to undo, it goes through the inheritace hierarchy from your bo's type all the way up <u>until UndoableBase</u>. The reason that PropertyChanged doesn't fail, is that UndoableBase never goes looking for stuff to serialize in BindableBase.<br><br>So, in your place I would only have one handler that is marked as NotUndoable and NonSerialized.<br><br>Andr√©s<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jdelano replied on Thursday, August 03, 2006</h2><P>Aha!&nbsp; That makes a ton of sense.&nbsp; Perfect!</P>
<P>Thanks,</P>
<P>John Delano</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
