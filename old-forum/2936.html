<html><header><title>ReadOnly DataGridView with EditableRootListBase binding?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ReadOnly DataGridView with EditableRootListBase binding?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2936.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dcleven posted on Wednesday, May 23, 2007</h2><P>I am using CSLA 2.1.4. I have an EditableRootListBase collection bound to a DataGridView. Based on the user login the DataGridView is editable or readonly. The CanEditObject call works correctly and prevents edits for the readonly users, but the Save method on the root object is called every time I navigate to another row in the grid. How can I prevent trying to save when the user has readonly access? I have tried setting the grid to ReadOnly and that does prevent changing data but still when changing rows the bindingsource thinks it needs to call EndEdit, which calls Save which throws the "Cannot Edit" exception which pops up the message in my UI, not the best workflow for a user.</P>
<P>Thanks</P>
<P>Doug Cleven</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, May 23, 2007</h2><P>You should be able to override SaveItem() in your collection class:</P>
<P>Public Overrides Sub SaveItem(ByVal index As Integer)<BR><BR>&nbsp; If MyCollectionType.CanEditObject() Then<BR>&nbsp;&nbsp;&nbsp; MyBase.SaveItem(index)<BR>&nbsp; End If<BR><BR>End Sub</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Wednesday, May 23, 2007</h2>You could override save in your object so that if the object has not changed it aborts the save.<br><br>EDIT: Never mind, Rocky answered it.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
