<html><header><title>Passing parameters to database</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Passing parameters to database</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8313.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ChkNet posted on Friday, January 08, 2010</h2><br />Hi, i was watching the new videos (which are incidentally pretty good except the pictures of code could be sharper in places). <br /><br />So i new to CSLA.<br /><br />In Data Access video. When passing parameters to DB for insert a compound SQL statement is used. Similar to this<br /><br />cm.commandtext  = <br />"insert into TestData(name,city) values(@name,@city) ;  select scope_identity()"<br /><br />cm.parameters.Add..Value ("@name",name);<br />cm.parameters.Add..Value ("@city",city);<br /><br />etc..<br /><br />It is also said that using this technique prevents sql injections which for a store procedure would be correct. <br /><br />What i am not sure about is whether this security feature working correctly?<br /><br />The reason is that the SQL statement used is itself a compound statement. <br /><br />The very thing this is supposed to be stopping!<br /><br />Any explaination on this would be much appreciated. <br /><br /><br /><br /><br /><br /><br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Friday, January 08, 2010</h2>Hi, <br><br>The commandtext is a "constant" and when using parameters and letting the Command object handle how text+parameters is sent to the database in secure way - really does prevent possible SqlInjection.&nbsp; The very point is that command text is NOT merged into a sqlstring when using this technique. Try running the sample with SqlProfiler attached and you can see how it is actually sent to the DB. <br><br>If, on the other hand, you write: <br>string sql = "insert into TestData(name,city) values('" + name + "', '" + city + "'); select scope_identity()"; <br>you would be exposed to SqlInject if the city is f.ex<br>var city ="'; delete * from tablename; --"<br><br>the resulting text would be a valid sql that would delete all rows from a table. <br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, January 08, 2010</h2>Using the Parameter object will properly escape the user supplied data.&nbsp; Sql injection occurs when you blindly tack strings together, without properly escaping the user supplied data.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
