<html><header><title>Density Correction (or Generic Polymorphism Whaaaa?)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Density Correction (or Generic Polymorphism Whaaaa?)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/552.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>tpancoast posted on Thursday, July 06, 2006</h2><DIV>I don't get it.&nbsp; I am new to CSLA.&nbsp; I bought and read the 1.0 book a while ago, but now that we might actually use it, 2.0 is out.&nbsp; I don't have the new book, so I am winging it.&nbsp; I am also fairly new to .Net.&nbsp; I am a Delphi coder and I have been dabbling in C#, but we are approaching real work now.</DIV>
<DIV>&nbsp;</DIV>
<DIV>I am working on a proof of concept project to use the CSLA as the middle tier between our application and a content management system.&nbsp; In that content management system you define different content types as classes.&nbsp; Those classes can inherit from each other, but there are only properties; there is no behavior associated with a content class.&nbsp; One of the designs I am considering (and therefor proving in the proof of concept) is to implement a simple CSLA class for each Content Class and mirroring the inheritance.</DIV>
<DIV>&nbsp;</DIV>
<DIV>I have a Folder : BusinessBase that contains a Documents : BusinessListBase collection of Document : BusinessBase objects.&nbsp; The individual objects in the Documents collection could be of the base Document class or it could be a Loan Document or a Batch Document or a Legal Document. </DIV>
<DIV></DIV>
<DIV>&nbsp;</DIV>
<DIV>My confusion comes from your article: <A href="http://www.lhotka.net/Articles.aspx?id=b8515cd9-7f8e-43df-9efd-cd958dfdc21a">http://www.lhotka.net/Articles.aspx?id=b8515cd9-7f8e-43df-9efd-cd958dfdc21a</A></DIV>
<DIV>&nbsp;</DIV>
<DIV>After reading that, I went and read about how Generics are not Polymorphic and I think I understand that pretty well.&nbsp; The problem is that I don't see how that applies to the CSLA.&nbsp; Sure BusinessBase is generic, but my&nbsp;Document class that I derive from it is a concrete class.</DIV>
<DIV><FONT color=#0000ff>
<P>public</FONT> <FONT color=#0000ff>class</FONT> <FONT color=#008080>Document</FONT> : <FONT color=#008080>BusinessBase</FONT>&lt;<FONT color=#008080>Document</FONT>&gt;</P></DIV>
<DIV><FONT color=#0000ff>
<P>public</FONT> <FONT color=#0000ff>class</FONT> <FONT color=#008080>Documents</FONT> : <FONT color=#008080>BusinessListBase</FONT>&lt;<FONT color=#008080>Documents</FONT>, <FONT color=#008080>Document</FONT>&gt;</P>
<DIV>I should be able to derive classes from Document and the Documents collection should be able to contain them all.&nbsp; I say should, but my shell application is working fine.&nbsp; I have no problem using a cast to access an item in the list as a LoanDocument class.&nbsp; The problem is, this is only a shell.&nbsp; I don't have any DataPortal code at this time.&nbsp; Is the problem related to serialization or with the Data Portal?</DIV>
<DIV>&nbsp;</DIV>
<DIV>Can someone please tell me more about the problems I might have continuing down this road?&nbsp; I must be missing something.</DIV></DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, July 06, 2006</h2>Well, one problem is that any class derived from Document would return Document from the Save method, not my MySubClassedDocument, which is what you'd expect.&nbsp; There are other problems as well, if you search this forum you'll come across threads detailing them more.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Thursday, July 06, 2006</h2><P>I am working through some of this same issue. I've stripped polymorphic behavior out of my classes for now and hope to revisit the subject at some point. </P>
<P>One problem that I ran into was the implementation of the collection class for polymorphic child objects - outlined here in Rocky's article that you mentioned:</P>
<P><A href="http://www.lhotka.net/Articles.aspx?id=b8515cd9-7f8e-43df-9efd-cd958dfdc21a">http://www.lhotka.net/Articles.aspx?id=b8515cd9-7f8e-43df-9efd-cd958dfdc21a</A></P>
<P>Recently, after trying to work through this, I ran into a problem with implementing the data access methods as talked about in his article, outlined here (last post in the thread):</P>
<P><A href="/forums/thread/1285.aspx">http://forums.lhotka.net/forums/thread/1285.aspx</A></P>
<P>Having shelved my pursuit of this for the moment, one avenue I have been giving real consideration to and have done a really cursory glance at is to bypass BusinessBase&lt;T&gt; and inherit right from Core.BusinessBase <EM>if I really really want inheritance with polymorphism</EM>. There is really not a lot in BusinessBase&lt;T&gt; that would have to be implemented, and it seems that BusinessListBase&lt;T,C&gt; works with&nbsp;C where C is&nbsp;IEditableBusinessObject, which is implemented by Core.BusinessBase.&nbsp; </P>
<P>In my case, there are "Contacts" in the system - some of which are Individuals and some of which are Organizations. Using BusinessBase&lt;T&gt;, my Contact abstract class (which has a good deal of common implementation) needs to be generic &lt;T&gt; simply to pass along the type to BusinessBase&lt;T&gt;. Otherwise it really doesn't serve much purpose. Bypassing BusinessBase&lt;T&gt; allows Contact to be a non-generic abstract class.&nbsp; I haven't really looked deeply into the ramifications and I don't really like breaking away from BusinessBase&lt;T&gt; as staying true to the framework is certainly important. </P>
<P>Of course, using BusinessBase&lt;T&gt; I end up with Contact&lt;Individual&gt; and Contact&lt;Organization&gt;, which are simply not the same class. They may indeed implement IContact, but as mentioned above I ran into some problems trying to implement Rocky's solution in his article and I decided to shelve it until I got some more "real work" done. </P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, July 06, 2006</h2>Sounds like a viable option if you don't need the functionality that BusinessBase&lt;T&gt; provides.<br><br>I'm not clear on why some of that functionality is there; the Clone and Data Access regions make sense there, but why isn't GetIdValue and the other functionality in Core.BusinessBase?&nbsp; It doesn't seem like it would change anything moving those to Core.BusinessBase.<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, July 07, 2006</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>skagen00:</strong></div><div></P>
<P>Having shelved my pursuit of this for the moment, one avenue I have been giving real consideration to and have done a really cursory glance at is to bypass BusinessBase&lt;T&gt; and inherit right from Core.BusinessBase <EM>if I really really want inheritance with polymorphism</EM>. There is really not a lot in BusinessBase&lt;T&gt; that would have to be implemented, and it seems that BusinessListBase&lt;T,C&gt; works with&nbsp;C where C is&nbsp;IEditableBusinessObject, which is implemented by Core.BusinessBase.&nbsp; </P>
<P></div></BLOCKQUOTE></P>
<P>This is, in fact, the only reason Core.BusinessBase still exists. During the book review process it was suggested that Core.BusinessBase could go away - which is absolutely true. But I kept it specifically because you can create a NON-GENERIC version of BusinessBase by inheriting from Core.BusinessBase.</P>
<P>I would NOT have your business objects inherit directly from Core.BusinessBase - that is not a design for which Core.BusinessBase is intended. However, what you can do is create your own BusinessBase that inherits from Core.BusinessBase and then have your business objects inherit from that new base class.</P>
<P>This new BusinessBase class should (at a minimum) implement a Save() method - obviously returning type Object rather than a strong type, and GetIdValue(). You may also want to implement the protected DataPortal_XYZ methods.</P>
<P>I originally had just such a class in the framework, but dropped it in favor of only supporting BusinessBase&lt;T&gt;. I still think that was the right choice, because it reduced my surface area for testing and for the book (as it would have taken pages to explain the non-generic version, and then to show how to use it within ProjectTracker, etc.)&nbsp; Still, in anticipation that someone would want to avoid all the complexity of generics, I did keep Core.BusinessBase so you could easily create a non-generic BusinessBase if that was useful.</P>
<P>All that said, in most cases you should be able to use IEditableBusinessObject to achieve polymorphic results without giving up the benefits of BusinessBase&lt;T&gt;.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tpancoast replied on Friday, July 07, 2006</h2><DIV>O.K.&nbsp; I am still reading some of the older messages in the forums, but this message confuses me again.&nbsp; My understanding is that you can create a non-generic (concrete) version of BusinessBase simply by inheriting from BusinessBase&nbsp;and specifying&nbsp;its type parameter without specifying any new type parameters for the new class.&nbsp; There shouldn't be any need to go back to Core.BusinessBase.&nbsp; For example, this creates a new non-generic (concrete) class.</DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp;&nbsp;&nbsp;public class&nbsp;MyClass : BusinessBase&lt;MyClass&gt;</DIV>
<DIV>&nbsp;</DIV>
<DIV>Now that MyClass is concrete, you can inherit additional classes from it without any limitation on polymorphism.&nbsp; In addition, as far as I know, generics support polymorphism, provided you are morphing from a generic type to a derived concrete type.&nbsp; For example, take this snippit:</DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp;&nbsp;&nbsp; public class BusinessBase&lt;T&gt;<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; virtual public string foo() { return("BusinessBase"); }<BR>&nbsp;&nbsp;&nbsp; }</DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp;&nbsp;&nbsp; public class ConcreteBase : BusinessBase&lt;ConcreteBase&gt;<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; override public string foo() { return ("ConcreteBase"); }<BR>&nbsp;&nbsp;&nbsp; }</DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp;&nbsp;&nbsp; public class ConcreteChild : ConcreteBase<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; override public string foo() { return ("ConcreteChild"); }<BR>&nbsp;&nbsp;&nbsp; }</DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp;&nbsp;&nbsp; static void Main(string[] args)<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List&lt;ConcreteBase&gt; concreteList = new List&lt;ConcreteBase&gt;();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; concreteList.Add(new ConcreteBase());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; concreteList.Add(new ConcreteChild());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (ConcreteBase item in concreteList)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.Out.WriteLine(item.foo());</DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; List&lt;BusinessBase&lt;ConcreteBase&gt;&gt; genericList = new List&lt;BusinessBase&lt;ConcreteBase&gt;&gt;();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; genericList.Add(new BusinessBase&lt;ConcreteBase&gt;());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; genericList.Add(new ConcreteBase());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; genericList.Add(new ConcreteChild());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // genericList.Add(new BusinessBase&lt;ConcreteChild&gt;()); // Compile Error: </DIV>
<DIV>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //&nbsp;Hit the limit of generic type polymorphism<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (BusinessBase&lt;ConcreteBase&gt; item in genericList)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.Out.WriteLine(item.foo());</DIV>
<DIV>&nbsp;</DIV>
<DIV>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Console.In.ReadLine();<BR>&nbsp;&nbsp;&nbsp; }<BR></DIV>
<DIV>ConcreteBase and ConcreteChild support polymorphism fine.&nbsp; You don't run into a problem until you expect the compiler to understand that BusinessBase&lt;ConcreteChild&gt; is a child type of BusinessBase&lt;ConcreteBase&gt;.</DIV>
<DIV>&nbsp;</DIV>
<DIV>This generic type to generic type comparison issue is the only limitation to polymorphism that I know of.&nbsp; Is there something else?</DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Saturday, July 08, 2006</h2>




<DIV align=left><SPAN class=671045414-08072006><FONT face=Arial color=#0000ff size=2>Sure, that will work just fine as well.</FONT></SPAN></DIV>
<DIV align=left><SPAN class=671045414-08072006><FONT face=Arial color=#0000ff size=2></FONT></SPAN>&nbsp;</DIV>
<DIV align=left><SPAN class=671045414-08072006><FONT face=Arial color=#0000ff size=2>Rocky</FONT></SPAN></DIV><BR>
<BLOCKQUOTE>
  <DIV class=OutlookMessageHeader align=left>
  <HR>
  <FONT face=Tahoma size=2><B>From:</B> tpancoast [mailto:cslanet@lhotka.net] 
  <BR><B>Sent:</B> Friday, July 07, 2006 5:35 PM<BR><B>To:</B> 
  rocky@lhotka.net<BR><B>Subject:</B> Re: [CSLA .NET] Density Correction (or 
  Generic Polymorphism Whaaaa?)<BR></FONT><BR></DIV>
  <DIV></DIV>
  <DIV>O.K.&nbsp; I am still reading some of the older messages in the forums, 
  but this message confuses me again.&nbsp; My understanding is that you can 
  create a non-generic (concrete) version of BusinessBase simply by inheriting 
  from BusinessBase&nbsp;and specifying&nbsp;its type parameter without 
  specifying any new type parameters for the new class.&nbsp; There shouldn't be 
  any need to go back to Core.BusinessBase.&nbsp; For example, this creates a 
  new non-generic (concrete) class.</DIV></BLOCKQUOTE></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Monday, July 10, 2006</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>RockfordLhotka:</strong></div><div> 
<P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>skagen00:</strong></div><div></P>
<P>Having shelved my pursuit of this for the moment, one avenue I have been giving real consideration to and have done a really cursory glance at is to bypass BusinessBase&lt;T&gt; and inherit right from Core.BusinessBase <EM>if I really really want inheritance with polymorphism</EM>. There is really not a lot in BusinessBase&lt;T&gt; that would have to be implemented, and it seems that BusinessListBase&lt;T,C&gt; works with&nbsp;C where C is&nbsp;IEditableBusinessObject, which is implemented by Core.BusinessBase.&nbsp; </P>
<P></div></BLOCKQUOTE></P>
<P>This is, in fact, the only reason Core.BusinessBase still exists. During the book review process it was suggested that Core.BusinessBase could go away - which is absolutely true. But I kept it specifically because you can create a NON-GENERIC version of BusinessBase by inheriting from Core.BusinessBase.</P>
<P></div></BLOCKQUOTE></P>
<P>I wonder why read-only objects didn't take this approach? I notice that the only reason (unless I'm&nbsp;missing something) ReadOnlyBase is generic is to strongly type the Clone method for the ICloneable interface. I wonder in some ways if there is a point at which it's good <EM>not</EM> to introduce generics.</P>
<P><EM>Correction: I missed that Equals also is implemented with T considered. </EM></P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tpancoast replied on Thursday, July 06, 2006</h2><DIV><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>Well, one problem is that any class derived from Document would return Document from the Save method, not my MySubClassedDocument, which is what you'd expect.&nbsp; There are other problems as well, if you search this forum you'll come across threads detailing them more.</div></BLOCKQUOTE></DIV>
<DIV>That is exactly what I would expect.&nbsp; Sure, it returns the base Document type, but the actual class is of the derived LoanDocument type.&nbsp;&nbsp;A call to&nbsp;GetType() confirms it and a cast gives me access to the sub class's properties.</DIV>
<DIV>&nbsp;</DIV>
<DIV>BTW, I did search the new forum, and there wasn't any specific information.&nbsp; I'll search the old forums as well, but so far my search on "polymorphism" is mostly turning up information about the older non-generic versions.</DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, July 06, 2006</h2>Here's some theads on this forum:<br><br><a HREF="/forums/thread/1181.aspx">http://forums.lhotka.net/forums/thread/1181.aspx</a><br><a HREF="/forums/thread/250.aspx">http://forums.lhotka.net/forums/thread/250.aspx</a><br><a HREF="/forums/thread/2641.aspx">http://forums.lhotka.net/forums/thread/2641.aspx</a><br><br>I searched for 'generics inheritance.'&nbsp; Rocky has some comments in two of those threads I believe.<br><br>HTH<br>Andy<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
