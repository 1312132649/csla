<html><header><title>Calculated Columns Question</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Calculated Columns Question</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/992.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Sarosh posted on Wednesday, August 23, 2006</h2><P>Hi!</P>
<P>I have just started using CSLA.NET (2.0.3) and am about to create my fist App.</P>
<P>The application I am working on is kind of simple, it has one main transaction table which uses about 8 lookup tables (8 FK's) but requires&nbsp;about 30 calulated columns. UI will be like a spreadsheet. (Grid based)</P>
<P>My question is should the BO's handle the calulations or should they be defined&nbsp;in the Database (SQL2005 DB) Since I am using SQL2005 should I&nbsp;define them as Calculated Columns or just regular Columns which will be updated by the BO's. There will be quite a few Reports which will require those Calculated Columns as well so if BO are used for the calcs will the Reports be able to use the BO's</P>
<P>Thanks.</P>
<P>Sarosh</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, August 23, 2006</h2>I would think that the calcs should be in the business layer.&nbsp; If the calcs are based on any other modifable property, you have no choice really.&nbsp; It will be easier to maintain the calcs in .Net (usually).&nbsp; <br><br>Your reports should be able to use the BOs, but it depends on the reporting technology you're using; Crystal, MS Reports, etc.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Sarosh replied on Wednesday, August 23, 2006</h2><P>Hi!</P>
<P>I am not clear on how&nbsp;to&nbsp;implement the calc columns in the CSLA.NET BO's any example will be great.</P>
<P>e.g. ColumnD = (ColumnA * ColumnB) + ColumnC</P>
<P>Sarosh</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Wednesday, August 23, 2006</h2>Create a read-only property on your object.<br><br>public int ColumnD<br>{<br>&nbsp;&nbsp;&nbsp; get<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;  return (this.ColumnA * this.ColumnB) + this.ColumnC;<br>&nbsp;&nbsp;&nbsp; }<br>}<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Sarosh replied on Wednesday, August 23, 2006</h2><P>Hi!</P>
<P>Yes, that should do it.</P>
<P>Thanks a lot for the info.</P>
<P>Sarosh</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Adam replied on Wednesday, June 03, 2009</h2>I have created a public readonly value like so;<br><br>public decimal VATAmount { get { return NetAmount * (AppliedVATPercentage / 100); } }<br><br>which works a treat but when I update the NetAmount cell on the client UI the calculated value won't update is there anyway to get the values to update on-the-fly in the client UI. I am using Silverlight with CSLAlight 3.6.2.0<br><br>Many thanks<br><br>Adam<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>shawndewet replied on Wednesday, June 03, 2009</h2>I think you may have to set your PropertyChangedMode to 'Xaml' (as opposed to the default 'Windows') ... this will cause the PropertyChanged Event to fire for all properties, instead of just the one that changed.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Adam replied on Wednesday, June 03, 2009</h2>Hi Shawn<br><br>Thanks for the info but I have tried the following line in both App.xaml.cs Application_Startup and in the constructor for my invoice viewer without success.<br><br>//Fire events for all xaml not just the current control http://forums.lhotka.net/forums/thread/23824.aspx<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Csla.ApplicationContext.PropertyChangedMode = Csla.ApplicationContext.PropertyChangedModes.Xaml;<br><br>Any other ideas or am I using this incorrectly?<br><br>Adam<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tetranz replied on Wednesday, June 03, 2009</h2>I think you just need to fire a PropertyChanged("VATAmount") whenever NetAmount changes. I haven't used SilverLight but, as I understand it, it's not like WinForms where a change on one property causes all to refresh. That always seemed like a bug in WinForms but it is useful in situations like this. It sounds like Shawn's suggestion is trying to make SilverLight behave more like WinForms but ... "only update the properly that changed" is surely the cleaner, more logical way to go.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Adam replied on Thursday, June 04, 2009</h2>Brilliant, that works a treat - OnPropertyChnaged("VATAmount") in the Setting for the property that changes! <br><br>Then only question now is I need to update the Invoice's Totals but can't see how to do that from the property that changes. InvoiceItem( BusinessBase) is a child of InvoiceItemList(BusinessListBase) which is a child of Invoice(BusinessBase)<br><br>Any ideas?<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
