<html><header><title>Linking security (user) and a business object</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Linking security (user) and a business object</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2147.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>juddaman posted on Tuesday, January 16, 2007</h2>Hello,

<br><br>I'm developing a HR application, which will basically have two user interfaces. One will be a Windows App for HR staff to put on new jobs. The other will be a web interface for Applicants to apply for jobs.

I'm having trouble working out how to link the security (login process) to the business objects access. <br><br>What I need is for each Applicant only to be able to edit their own profile (i.e. Name, Address, Education history, etc).

So in the AddAuthorizationRules method I was looking to add something like

<br><br>AuthorizationRules.AllowUserWrite("PropertyName",this.Username).<br><br>As this doesn't exist I'm not sure what to do. Also I see many issues arising about keeping the Principal and the business class "together" i.e. what happen when a user want to remove their account, change username, etc.<br><br>&nbsp;I've done a bit of searching and found some similar problems where it is suggested a "data owner" system is used, this seams to relate to my problem. I'm very new to the Business Objects framework and quite new to C# .NET so any gentle guidance would be much appreciated. :-)

<br><br>Thank you,

George</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Tuesday, January 16, 2007</h2>Take a look at overriding CanReadProperty and CanWriteProperty.&nbsp; Also, an applicant should not be able to retrieve anyone's profile other than their own.&nbsp; You may want to just keep them from loading anyone else's profile and leave it at that.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>juddaman replied on Sunday, January 21, 2007</h2>Hey Brian, thank you for pointing me in the right direction. Much appreciated. George<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, January 22, 2007</h2>George,<br><br>Check out the Proxy design pattern.&nbsp; In "Head First Design Patterns" they discuss how to control security to an object through a proxy.&nbsp; Might not be necessary with the features Csla provides, but it wouldn't hurt to check out another way to acomplish what you want.<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Monday, January 22, 2007</h2><P><FONT face=Arial size=2>If you are talking about the login process w/ controls of ASP.Net (Membership provider API) in conjunction with the Csla's Principal &amp; Identity, etc - perhaps I can suggest a few things. </FONT></P>
<P><FONT face=Arial size=2>First, we are using the Membership API &amp; Role API of ASP.Net, and we'll be utilizing it in both Web and Windows where necessary. </FONT></P>
<P><FONT face=Arial size=2>The login control's authenticate will do this: </FONT></P>
<P><FONT face=Arial size=2>e.Authenticated = ProPrincipal.Login(Login1.UserName, Login1.Password);</FONT></P>
<P><FONT face=Arial size=2>HttpContext.Current.Session[<FONT color=#800000>"CslaPrincipal"</FONT>] = Csla.ApplicationContext.User;</FONT></P>
<P><FONT face=Arial size=2>ProPrincipal will invoke the Membership API and utilize the Role API to establish the proper Identity &amp; Roles. For the Membership API and Role API, I've created a CslaMembershipProvider and CslaRoleProvider, which wraps the entirety of the standard implementation of any appropriate provider to facilitate remoting where necessary. I hope to add this as a contribution once I have the opportunity to clean it up, because I think many developing in the Web would appreciate the ability to use all of the implementation of the AspSqlMembershipProvider and AspSqlRoleProvider, for example, with remoting enabled. </FONT></P>
<P><FONT face=Arial size=2>By fulfilling the Membership API and Role API in this way, we can leverage the Asp.Net configuration tool, which effectively gives us a simple manner to manage users. Beyond that, there's all that password hashing/changing/resetting and crap all built in to the provided implementations. </FONT></P>
<P><FONT face=Arial size=2>And the application's Csla type principal is attached to the Csla.ApplicationContext upon login, so that it's available for use in the business object logic - "IsInRole"... </FONT></P>
<P><FONT face=Arial size=2>May be off-target from what you were looking for but if it is on-target I hope it helps.</FONT></P>
<P><FONT face=Arial size=2></FONT>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
