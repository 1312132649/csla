<html><header><title>The proper way of using DTOs?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>The proper way of using DTOs?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/12764.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>pecen posted on Tuesday, September 30, 2014</h2><p>Hi,</p>
<p>I&#39;ve Always tried to make dto&#39;s correspond to a table in the database I&#39;m using. But is it fair to say that a dto should rather correspond to the Query&nbsp;I&#39;m using instead? Let&#39;s say you have a Reservation table, and then a&nbsp;ReservationDto which includes the fields Id, FacilityTypeId, StartDate, EndDate. where FacilityTypeId in the table&nbsp;is a foreign key to the FaciliType table from where I get the FacilityTypeName. </p>
<p>If&nbsp;I should&nbsp;be strict in using&nbsp;dto&#39;s&nbsp;to&nbsp;mirror the&nbsp;tables, then I also have to have a&nbsp;FacilityTypeDto in this scenario, but if I instead let my ReservationDto correspond to my Query, which uses a JOIN&nbsp;with my FacilityType table to get the&nbsp;FacilityTypeName I only have to Query the database for information once, hence making the whole thing simpler imo. </p>
<p>It would&nbsp;just be interesting to hear&nbsp;anyones thoughts in this. </p>
<p>Thanks,</p>
<p>Peter</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, September 30, 2014</h2><p>I&#39;ve always had the DTOs mirror the tables exactly, but I&#39;m assuming something like linq2sql or EF.&nbsp; Then your context has methods for proc calls, and you write your queries using Linq.&nbsp; Of course the biggest benefit is generating your DTOs from the database; don&#39;t write them by hand and you&#39;ll get things automatically like navigation properties.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Tuesday, September 30, 2014</h2><p>We&#39;ve tended to have the DTOs contain the data in a structure easiest for the business object to hydrate from and populate to - child objects typically are a DTO-classed property on the root object&#39;s DTO.&nbsp; We do hand-roll our DTOs but I&#39;ve never considered it too onerous.&nbsp; </p>
<p>That said, my guess is that the route Andy mentions above makes the data access layer much easier/efficient to write.</p>
<p>I think one thing that is clear is that you really want these to have no inherent logic to them - you want them to really just be containers of data... virtually all of not all of the properties in our DTOs are automatic properties ... {get; set;}.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pecen replied on Tuesday, September 30, 2014</h2><p>In this particular scenario I don&#39;t use EF, but have my Sql-query in my Concrete Dal (DalSql). What I mean is that with a Query like the following I don&#39;t need to go to the database again to get the actual value of FacilityType.Name. Then I will have a dto that corresponds to the Query instead. </p>
<p><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;">SELECT </span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">HousingFacility</span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">.</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">HousingFacilityId</span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">,</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> FacilityType</span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">.</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">Name</span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">, </span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">HousingFacility</span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">.</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">Name</span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">,</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">&nbsp;</span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">Rooms</span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">, </span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">Beds </span></span></p>
<p><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><font face="Consolas" size="2" color="#0000ff"><font face="Consolas" size="2" color="#0000ff"><font face="Consolas" size="2" color="#0000ff">
<p>FROM </p>
</font></font></font></span><font face="Consolas" size="2" color="#0000ff"><font face="Consolas" size="2" color="#0000ff">
<p>&nbsp;</p>
</font></font></span><font face="Consolas" size="2" color="#0000ff">
<p>&nbsp;</p>
</font></span></p>
<p><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">HousingFacility </span></span></p>
<p><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><font face="Consolas" size="2" color="#808080"><font face="Consolas" size="2" color="#808080"><font face="Consolas" size="2" color="#808080">
<p>Left </p>
</font></font></font></span><font face="Consolas" size="2" color="#808080"><font face="Consolas" size="2" color="#808080">
<p>&nbsp;</p>
</font></font></span><font face="Consolas" size="2" color="#808080">
<p>&nbsp;</p>
</font></span></p>
<p><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">Outer</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> </span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">Join </span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">Reservation </span></span><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;">ON</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> HousingFacility</span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">.</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">HousingFacilityId </span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">=</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> Reservation</span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">.</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">HousingFacilityId
<p>&nbsp;</p>
<font face="Consolas" size="2"><font face="Consolas" size="2">
<p>&nbsp;</p>
</font></font></span><font face="Consolas" size="2">
<p>&nbsp;</p>
</font></span></p>
<p>&nbsp;</p>
<p><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">and</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> Reservation</span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">.</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">StartDate </span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">&lt;= </span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">@ResEndDate<font face="Consolas" size="2"><font face="Consolas" size="2">
<p>&nbsp;</p>
</font></font></span><font face="Consolas" size="2">
<p>&nbsp;</p>
</font></span></p>
<p>&nbsp;</p>
<p><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">and</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> Reservation</span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">.</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">EndDate </span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">&gt;= </span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">@ResStartDate</span></span></p>
<p><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><font face="Consolas" size="2" color="#808080"><font face="Consolas" size="2" color="#808080"><font face="Consolas" size="2" color="#808080">
<p>Left </p>
</font></font></font></span><font face="Consolas" size="2" color="#808080"><font face="Consolas" size="2" color="#808080">
<p>&nbsp;</p>
</font></font></span><font face="Consolas" size="2" color="#808080">
<p>&nbsp;</p>
</font></span></p>
<p><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">Outer</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> </span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">Join</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> FacilityType </span></span><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;">On</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> HousingFacility</span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">.</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">TypeId </span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">=</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> FacilityType</span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">.</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">TypeId</span></span></p>
<p>
<p><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><span style="font-size:x-small;font-family:Consolas;color:#0000ff;"><font face="Consolas" size="2" color="#0000ff"><font face="Consolas" size="2" color="#0000ff"><font face="Consolas" size="2" color="#0000ff">
<p>WHERE </p>
</font></font></font></span><font face="Consolas" size="2" color="#0000ff"><font face="Consolas" size="2" color="#0000ff">
<p>&nbsp;</p>
</font></font></span><font face="Consolas" size="2" color="#0000ff">
<p>&nbsp;</p>
</font></span>
<p><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">Reservation</span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">.</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;">HousingFacilityId </span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">Is</span></span></span><span style="font-size:x-small;font-family:Consolas;"><span style="font-size:x-small;font-family:Consolas;"> </span></span><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;"><span style="font-size:x-small;font-family:Consolas;color:#808080;">Null</span></span></span></p>
</p>
</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pecen replied on Tuesday, September 30, 2014</h2><p>I absolutely agree, no inherent logic what so ever should be in the dto&#39;s, and I also only use automatic properties. Like you say, the dto&#39;s&nbsp;are just containers of data but should these containers correspond to the Query or the table? If I have joined tables, and if I follow the strict approach with dto&#39;s corresponding to the table fields, then I have to have several calls to the database, with several dto&#39;s for each table instead of having just one dto that corresponds to the Query (see my answer to Andy too). </p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Tuesday, September 30, 2014</h2><p>Hi,</p>
<p>When I need DTOs I always make these fit the query/data structure. </p>
<p>When I am using LINQ then anonymous objects is a nice alternative and when using direct SQL you will always get the best performance by using the DataReader directly and materialize into BusinessObjects. </p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
