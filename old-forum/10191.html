<html><header><title>How to update ReadOnlyListBase</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How to update ReadOnlyListBase</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10191.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>RaulLozano posted on Tuesday, March 22, 2011</h2><p>I have a ReadOnlyListBase that is bound to a grid that is used to display a list of raw-material objects. The grid only shows about 5% of the properties contained on the full raw-material object.</p>
<p>The idea is that when the user double clicks a row on the grid the application retrieves the full raw-material object (BussinesBase) and displays it on its own form so that the user can edit it.</p>
<p>All this is great but the problem is what to do with the ReadOnlyListBase item once it has been updated (after the user double-clicked the grid and updated the raw-material on the external form). I hate to have to fetch the whole ReadOnlyListBase again just to show the updated data&nbsp;for only&nbsp;one of the items. </p>
<p>Am I approaching this the wrong way? How do you guys handle this type of scenario?</p>
<p>Thanks.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Wednesday, March 23, 2011</h2><p>Is your app a single user application? </p>
<p>If not - then how would you make sure to update the list with changes from other users? </p>
<p>Sometimes - I find we try to make things more complicated/optimized than they may need to be.<br />I&#39;d probably just refetch the entire list to keep it updated. </p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, March 23, 2011</h2><p>I am with Jonny - by default I&#39;ll just refresh the list.</p>
<p>If that is a performance problem, then you can look at more complex alternatives.</p>
<p>One relatively easy alternative:</p>
<ol>
<li>Enhance the read-only child class contained in the list to add support for direct fetching (add a static factory and DataPortal_Fetch)</li>
<li>Add a RefreshItem method to the collection, and in this method:<ol>
<li>Reload the changed read-only child</li>
<li>Mark the list as IsReadOnly false</li>
<li>Replace the old item with the new one</li>
<li>Mark the list as IsReadOnly true</li>
</ol></li>
</ol>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RaulLozano replied on Wednesday, March 23, 2011</h2><p>Thanks guys.<br /><br />I think I am going to go for the refresh method as follows:<br /><br />I will add a Refresh method on the child object that takes a full RawMaterial object as its argument. Inside this Refresh method I will simply copy the new values from the full RawMaterial object to the child object.<br /><br />Of course, I am not sure if the read-only child (ReadOnlyBase) implements all the pluming necessary to fire the property change events so the grid is able to reflect the new values. I will need to verify this when I am back at my development computer.<br /><br />This is more than a performance issue by the way. This is a multiuser application and I don&rsquo;t want to refresh the whole list and have users see changes to items they didn&rsquo;t initiate changes on, this may freak users out and think there is a bug with the application. I also think (I am not sure) that when I rebind the list to the grid I am going to have to add a bunch of extra code to scroll the grid to its last scroll state, set the grid selected item etc, etc.<br /><br />So, is the Refresh item idea asking for trouble?</p>
<p>Thanks.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tmg4340 replied on Wednesday, March 23, 2011</h2><p><div style='padding-left: 50px;background-color:silver'><b>RaulLozano<br></b></p>
<p><br />This is more than a performance issue by the way. This is a multiuser application and I don&rsquo;t want to refresh the whole list and have users see changes to items they didn&rsquo;t initiate changes on, this may freak users out and think there is a bug with the application.</p>
<p></div></p>
<p>Yes - but consider this.&nbsp; Won&#39;t your users &quot;freak out&quot; if they choose to edit an item from your list and see your edit screen showing different data than what&#39;s in the list?&nbsp; They are going to see the change somewhere.&nbsp; In a multi-user app, it&#39;s not an uncommon occurrence to see data &quot;move&quot; on you.</p>
<p>I&#39;m not saying that going the &quot;refresh item&quot; idea is bad.&nbsp; I just think you may be choosing the more-complicated implementation to avoid a problem that you&#39;re going to run into eventually anyway.</p>
<p>HTH</p>
<p>- Scott</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RaulLozano replied on Wednesday, March 23, 2011</h2><p><div style='padding-left: 50px;background-color:silver'><b>tmg4340<br></b></p>
<p>Yes - but consider this.&nbsp; Won&#39;t your users &quot;freak out&quot; if they choose to edit an item from your list and see your edit screen showing different data than what&#39;s in the list?&nbsp; They are going to see the change somewhere.&nbsp; In a multi-user app, it&#39;s not an uncommon occurrence to see data &quot;move&quot; on you.</p>
<div style="clear:both;"></div>
<p></div></p>
<p>ah yes, that is true and I had tough of that too. I have the time stamp value of the raw-material object on the list and I was going to compare that value against the time stamp value of the full raw-material object and if they are different then I was going to popup a message box letting the user know about the issue. And yes, I realize that I can do the same thing if I refreshed the list in case the list had changed but that looks like a far more complex solution.</p>
<p>I am starting to get the feeling that I may be swimming against the current with this one. I was sure that my approach would have been the best way to go but it looks like it may just be me thinking that.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tetranz replied on Wednesday, March 23, 2011</h2><p>Long ago I implement an observer pattern mechanism for handling this and have been using it ever since. It&#39;s quite simple and it works very well. My ReadOnly collections register with the &quot;Observer&quot; by supplying a delegate and indicating what type of object it wants to be told about. My BusinessBase and other objects call the Observer in their Save method. The readonly collection is told the id of the object affected and whether it was added, updated or deleted.&nbsp; The collection then fires a ListChanged event so the UI is updated. I have some code in the UI to select and highlight the correct grid row. It&#39;s not just useful for grids but dropdown combo boxes etc.</p>
<p>Some of my queries are quite heavy and I wouldn&#39;t want to do it on every update.</p>
<p>Unfortunately I&#39;ve never really documented and made it general enough to publish. The observer is basically a Dictionary / HashTable keyed on full type names. Value is a collection of delegates. It&#39;s important to unregister when a collection is destroyed so we&#39;re not trying to call delegates on dead objects and cause memory leaks.</p>
<p>Yes the multi-user issue exists as others have described. It&#39;s not really an issue in my applications since whoever creates a record normally &quot;owns&quot; it so records are not normally changed by someone else.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>onlyash replied on Wednesday, August 31, 2011</h2><p>Hi...can u post the code for the same. I am new to CSLA and want to add selected item(s) from gridview to a listbox .</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
