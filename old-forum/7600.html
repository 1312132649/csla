<html><header><title>Silverlight, EF and LINQ</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Silverlight, EF and LINQ</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7600.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>CyclingFoodmanPA posted on Thursday, September 10, 2009</h2><P>I have a question and have been trying to figure out the syntax for a while.&nbsp; I have a form where a user can select 2 dates (NYMEXDate and NYMEXDate1) can select a ProductId and 2 more dates (ForwardDate and ForwardDate1).</P>
<P>I am trying to figure out how to put this in a EF/LINQ query as follows</P>
<P>SELECT * <BR>FROM NYMEXHistory nh<BR>WHERE ((nh.NYMEXDate BETWEEN NYMEXDate AND NYMEXDate1)<BR>AND (nh.NYMEXProductID = NYMEXProductID)<BR>AND (nh.ForwardDate BETWEEN ForwardDate AND ForwardDate1))</P>
<P>The dates being passed in are SmartDates so I am thinking I have to convert them to a System.DateTime.&nbsp; However, I am trying to find the Between statement in my EF syntax but cannot find it.</P>
<P>Any comments leading me in the right direction would be most appreciated.</P>
<P>Thank you in advance for your help.</P>
<P>CyclingFoodmanPA</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, September 10, 2009</h2>Hi,<br><br>You must use &gt; (GreaterThan) and &lt; (LessThan) operators. <br><br>Hint - Check out this article on <a href="http://www.albahari.com/nutshell/predicatebuilder.aspx">PredicateBuilder </a>too - in <a href="http://www.albahari.com/nutshell/linqkit.aspx">LinqKit</a>. Nice stuff from Joseph Albahari. <br>Allows you to write generic nested predicates too, like <br><br><pre>public interface IValidFromTo<br>{<br>   DateTime? ValidFrom { get; }<br>   DateTime? ValidTo   { get; }<br>}</pre><pre>public static Expression&lt;Func&lt;<b>TEntity</b>, bool&gt;&gt; IsCurrent&lt;<b>TEntity</b>&gt;()<br>   where <b>TEntity : IValidFromTo</b><br>{<br>   return e =&gt; (e.ValidFrom == null || e.ValidFrom &lt;= DateTime.Now) &amp;&amp;<br>               (e.ValidTo   == null || e.ValidTo   &gt;= DateTime.Now);<br>}<br><br>/jonnybee<br></pre></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>CyclingFoodmanPA replied on Friday, September 11, 2009</h2>JonnyBee,<br><br>Thanks for the input on building predicates.&nbsp; That is helpfull and I am getting an understanding of it.&nbsp; However, how do you build predicates for a number of conditions.&nbsp; For example, I may be looking for a string that is contained in a string field and I may be looking for a particular product id also.&nbsp; <br><br>In my initial example, I am looking for 2 date ranges (NYMEXDate, ForwardDate) and I may have a ProductId in there.&nbsp; If ProductId = 0, then I want all records within the date range.&nbsp; If ProductId != 0 then I want records within the date range AND with a ProductId = to a particular product.<br><br>I am getting there, but not quite there yet and I have a pretty complex where clause coming up.&nbsp; I want to do a query on a table and there are a number of items that can be 0 or can have a number and I want to be able to selectively query my entity.<br><br>Thanks for your help,<br>CyclingFoodmanPA<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
