<html><header><title>Automatic Save() or commit to database when editing BusinessBase in WinForms</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Automatic Save() or commit to database when editing BusinessBase in WinForms</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11022.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>cwinkelmann posted on Tuesday, December 27, 2011</h2><p>I have a BusinessBase object in a BusinessBindingListBase. When bound to a DataGridView in WinForms, I would like the BusinessBase to automatically save it&#39;s values to the database when the object IsDirty property is set. </p>
<p>What I&#39;m trying to avoid is forcing the end users from having to press a &quot;Save&quot; button every time they alter an object. I am completely aware of the database overhead of committing changes on a property level, but that is the responsiveness they require. </p>
<p>If I tie this to the ListChanged event, then I have to check IsValid before calling Save() or I get an error</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!IsValid)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw new Rules.ValidationException(Resources.NoSaveInvalidException);</p>
<p>If I check for IsValid and prevent the Save() method from being called then the user will be allowed to create new BusinessBase and delete other BusinessBase objects and modify even others and none of the changes will be saved because nothing can be saved while one child object is not valid...&nbsp;</p>
<p>I&#39;m presently having terrible difficulties understanding how to integrate a method for saving each BusinessBase in either the BindingListBase or in the BusinessBase itself. </p>
<p>I&#39;ve also investigated keying off the BusinessBase PropertyChanged event but that has similar problems in that if a row is deleted, it does not report to the parent BindingListBase to remove it from the DeletedList so the call to delete may occur twice on the same object. </p>
<p>Does anyone have advice or ideas where this functionality may be supported in the current CSLA framework? </p>
<p>&nbsp;</p>
<p>Thanks greatly,</p>
<p>Chris</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cwinkelmann replied on Tuesday, December 27, 2011</h2><p>Is DynamicBindingListBase the class I need to inherit from for this? Curious when this was added to the CSLA framework :-) </p>
<p>We&#39;ll see.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Tuesday, December 27, 2011</h2><p>Yes, that is the class you are looking for. It has been around (though with a slightly different name) since around 2005.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>ajj3085 replied on Wednesday, December 28, 2011</h2><p>Yes, DynamicBindingListBase is the class you want to use.</p>
<p>Note though that it doesn&#39;t save as each property is changed, it saves when the user is done editing the row.&nbsp; Typically when a user started editing a row, a little pencil icon appears on the left row indicator.&nbsp; The user can cancel all changes to the row by presses ESC, or may commit all changes by leaving the row (the row loses focus), or maybe there&#39;s a keyboard shortcut.&nbsp; </p>
<p>I would recommend just using this approach as its pretty standard Windows behavior, and most grid controls emulate this so you&#39;d be fighting the normal databinding to get saves on every property change.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cwinkelmann replied on Wednesday, March 14, 2012</h2><p>Is there any way for a BusinessBase&lt;T&gt; object to auto-save itself? Where this is not part of a list and not in a DataGridView? Simply bound to a form or UserControl...</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, March 15, 2012</h2><p>And what should trigger the Save method? </p>
<p>No - there is no builtin support for an auto-save of a Root Object. </p>
<p>Csla.Windows.CslaActionExtender may help but has several known bugs.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
