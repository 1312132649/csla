<html><header><title>How-To use FilteredBindingList?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How-To use FilteredBindingList?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1814.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>brembot posted on Wednesday, November 22, 2006</h2><font face="Tahoma"><font size="2">Hi All, <br><br>I have a <font color="#000080">EditableRootList </font>and <font color="#000080">ReadOnlyList </font>collection.I want to filter some data in my collection. How am i going to do this and make it work. I've searched all the forums and was not able to find a concrete example. For example i have a collection of students and i want to filter by surename.<br><br>Here's what i did:<br><br>...<br>Private mStudents As Students = Students.GetStudents()<br>Private mFiltered As Csla.FilteredBindingList(Of </font></font><font face="Tahoma"><font size="2">Students</font></font><font face="Tahoma"><font size="2">) (</font></font><font face="Tahoma"><font size="2">mStudents</font></font><font face="Tahoma"><font size="2">)<br><br></font></font><font face="Tahoma"><font size="2">mFiltered</font></font><font face="Tahoma"><font size="2">.ApplyFilter("SureName", "Doe")<br>...<br><br><br>After executing this command i got errors <font color="#006400">"Unable to cast object of type 'POS.</font></font></font><font color="#006400" face="Tahoma"><font size="2">Students </font></font><font color="#006400" face="Tahoma"><font size="2">' to type 'System.Collections.Generic.IList`1[POS</font></font><font color="#006400" face="Tahoma"><font size="2">.Students </font></font><font face="Tahoma"><font size="2"><font color="#006400">]'."</font><br><br>Am i missing something in my code?<br><br>Thanks,<br>Marlon<br><br><br></font></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Wednesday, November 22, 2006</h2>The filtered binding list (like the sorted binding list) take the type of the item, not the list. So if your list contains items of type Student, just change it to:<br><font face="Tahoma"><font size="2">Private mFiltered As Csla.FilteredBindingList(Of </font></font><font face="Tahoma"><font size="2">Student</font></font><font face="Tahoma"><font size="2">) (</font></font><font face="Tahoma"><font size="2">mStudents</font></font><font face="Tahoma"><font size="2">).<br><br>Also, you need to pass a delegate that does the filtering. Something like:<br><br><br>Public Shared Function Filter(ByVal item As Object, ByVal filterValue As Object) As Boolean<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim result As Boolean = False<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not item Is Nothing AndAlso Not filterValue Is Nothing Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = DirectCast(item, Student).Surname.Equals(filterValue)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return result<br>End Function<br><br>And then do this with the list:<br>mFiltered.FilterProvider = AddressOf Filter<br><br><br><br>Andrés</font></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>gajit replied on Thursday, December 07, 2006</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>xal:</strong></div><div>The filtered binding list (like the sorted binding list) take the type of the item, not the list. So if your list contains items of type Student, just change it to:<BR><FONT face=Tahoma><FONT size=2>Private mFiltered As Csla.FilteredBindingList(Of </FONT></FONT><FONT face=Tahoma><FONT size=2>Student</FONT></FONT><FONT face=Tahoma><FONT size=2>) (</FONT></FONT><FONT face=Tahoma><FONT size=2>mStudents</FONT></FONT><FONT face=Tahoma><FONT size=2>).<BR><BR>Also, you need to pass a delegate that does the filtering. Something like:<BR><BR><BR>Public Shared Function Filter(ByVal item As Object, ByVal filterValue As Object) As Boolean<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim result As Boolean = False<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If Not item Is Nothing AndAlso Not filterValue Is Nothing Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = DirectCast(item, Student).Surname.Equals(filterValue)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End If<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return result<BR>End Function<BR><BR>And then do this with the list:<BR>mFiltered.FilterProvider = AddressOf Filter<BR><BR><BR><BR>Andrés</FONT></FONT></div></BLOCKQUOTE></P>
<P>&nbsp;</P>
<P>I wonder if I might resurrect this thread briefly.</P>
<P>I'm having problems implemeting the filter also.</P>
<P>When I apply a string value to a column using the .ApplyFIlter method, I get a 'like' filter as opposed to an 'equals' filter.</P>
<P>So, I am trying to implement this methodology, but I am confused... WHERE is the Filter() subroutine implemented? If in the UI, then how do I pass a filter value to the object?</P>
<P>I can't ssee how or where you pass a value to the Filter() Method.</P>
<P>&nbsp;</P><FONT size=3>
<P></FONT><FONT color=#0000ff size=3>Dim</FONT><FONT size=3> FilteredList </FONT><FONT color=#0000ff size=3>As</FONT><FONT size=3> </FONT><FONT color=#0000ff size=3>New</FONT><FONT size=3> Csla.FilteredBindingList(</FONT><FONT color=#0000ff size=3>Of</FONT><FONT size=3> ProspectInfo)(list)</P><FONT size=3>
<P>FilteredList.FilterProvider = </FONT><FONT color=#0000ff size=3>AddressOf</FONT><FONT size=3> Filter </FONT><FONT color=#008000 size=3>' <STRONG>&lt;---how do I implement THIS code??</STRONG></P></FONT></FONT><FONT size=3>
<P></FONT><FONT color=#0000ff size=3>If</FONT><FONT size=3> Len(cboTeam.Text) &gt; 0 </FONT><FONT color=#0000ff size=3>Then</P></FONT><FONT size=3>
<P>&nbsp;&nbsp;&nbsp;FilteredList.ApplyFilter(</FONT><FONT color=#800000 size=3>"SALESREP"</FONT><FONT size=3>, cboTeam.SelectedValue.ToString)</P>
<P></FONT><FONT color=#0000ff size=3>End</FONT><FONT size=3> </FONT><FONT color=#0000ff size=3>If</P></FONT>
<P>I'd very much appreciate your assistance,</P>
<P>Thanks,</P>
<P>G.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
