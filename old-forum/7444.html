<html><header><title>Multiple DataPortal_Update methods in single class?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Multiple DataPortal_Update methods in single class?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7444.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>andrewrajcoomar posted on Wednesday, August 12, 2009</h2><P>Hello,</P>
<P>I&nbsp;was wondering if it's possible to have multiple dataportal_update methods in a single class to facilitate partial updates of the class. Can the update method perhaps have different signatures using the criteria class? Or is the only way possible, is to have conditional logic in the method that then class update1, update2 or update3?</P>
<P>This is a very common situation for me, where I have to update just one or two columns on the table.</P>
<P>Greatly appreciate any help on this.</P>
<P>Using VS2008 with CSLA.Net 3.5.</P>
<P>Thanks,</P>
<P>Andrew&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, August 12, 2009</h2><P>You can have it either way - or both if you want.</P>
<P>The signatures of each DataPortal_Update must be different from each other. Then the framework will locate the correct version based on its signature. So you need to use different criteria objects if you want different DataPortal_Update methods.</P>
<P>Alternatively you can always go to the one DP_Update and then branch based on the type of CriteriaObject. If I use the same criteria object many times then I also add a MethodName As String to the criteria and do further branches by MethodName. (It is obviously filled in with the name of the method that calls DP.Update.)</P>
<P>That way you can branch as much as you need to do whatever updates you require.</P>
<P>Joe</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, August 13, 2009</h2>Hi, <br><br>You can have several DataPortal_Update methods so long as they have a diffent signarture (parameters). <br><br>Normally you would send  your BO as parameter and you can ask  FieldManager to check each field for IsDirty and only update your database with the changed fields. <br><br>For other types of (partial) updates (ex change status on order) I would create Command objects and call them from my BO (and not create multiple overloads on the DataPortal_Update method in  my BO). <br><br>/jonnybee <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Marjon1 replied on Thursday, August 13, 2009</h2>If this was a root level object, then how would any specialized DataPortal_Update() be called as part of the Save() method? I don't think root level objects work that may. Or you would need some form of branching logic within the standard to call your own methods.  It's not possible to call DataPortal.Update(Of T) with any parameter other than an object of T<br /><br />At a child level with the field manager this makes sense, therefore having this really only applies to Child_Update() methods. (See comment by /jonnybee)<br /><br />Just putting this out there so people don't get confused between where this really applies.<br />Should any of the above be wrong, please feel free to correct me.<br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>andrewrajcoomar replied on Thursday, August 13, 2009</h2><P>Thanks for your responses.</P>
<P>Here's a summary of what I am trying to do:</P>
<P>&nbsp;I have a gridview bound to a BOReadOnlyList. The list contains "to-be-validated" data that has passed basic validation and has been imported into the db. Now, when the user clicks the "Validate" button, I walk the gridrows and validate the fields against specific business rules. If a row fails validation, I want to update the BO with two columns, Status and Message. By the way, I could iterate thru the List for each info object, but as I walk the grid I also use the opportunity to provide visual feedback (row coloring) to the user.</P>
<P>What I am doing is, if the row fails validation, I pass the PK as parm to the BO.GetMyObject method and return a complete object. I then set the properties for those two values and call the BO.Save method.</P>
<P>This approach&nbsp;isn't efficient as I am hitting the db twice for a row, once for the&nbsp;Fetch and then for the Update, plus I am doing this for each row in the grid :-(.</P>
<P>I would like to use&nbsp;the Criteria object to specify branching in my Update method, or just to specify a different signature for each Update method. However, I am challenged with how to implement. I am thinking a partial object would fail the Validation Rules in the class. More importantly, how do I create the partial object; I can't use NewMyObject, as that would certainly fail validations.</P>
<P>So the issue is, how to create the object that I want to perform partial updates on, and how do I call the Update?</P>
<P>I'd really like even so psuedo-code of an implementation.</P>
<P>Thanks,</P>
<P>Andrew</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, August 13, 2009</h2><P>You should be aware that the read-only base classes (like ReadOnlyListBase) don't have any update methods, because they are read-only.</P>
<P>If you want to update data you should be using an editable base class and editable stereotype.</P>
<P>If you want to do the update (and associated server-side processing) in a batch then you'd use BusinessListBase. If you want to do the update per-row you'd use EditableRootListBase - though that is <EM>far</EM> less efficient for a scenario like you describe (enough that I suspect it wouldn't be acceptable).</P>
<P>If you <EM>really</EM> want to use a read-only list, then you'll need to have a command object that you send to the server to do the server-side processing and update - either on a per-row basis (highly inefficient) or to process a batch (much more efficient).</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>andrewrajcoomar replied on Friday, August 14, 2009</h2><P>Rocky,</P>
<P>Thanks for your response.</P>
<P>I am using a ReadOnlyList and an EditableBase class. The ROL is bound to my grid. When I programatically validate a row in the list, I need to call a partial update on the table. This is where I am fetching the data into my editable base class object and then setting the properties I need to change. Then I call the Save on the editable base class. I believe this is highly inefficient, but I am not sure what other way I can do this. Am I understanding that I could return a BusinessListBase object, bind that to my grid, make my changes server side and then save the whole collection object as a batch?</P>
<P>Any pointers on how to implement - guess I need to break out the handbooks :-)</P>
<P>Thanks,</P>
<P>Andrew</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
