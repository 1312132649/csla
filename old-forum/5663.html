<html><header><title>IsDirty is always returning true</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>IsDirty is always returning true</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5663.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dculler posted on Thursday, October 23, 2008</h2>I'm just getting started on CSLA and I'm having some trouble with IsDirty.&nbsp; I've written a small test project that creates a new business object, saves it, and prints the value of it's IsDirty property to the console.&nbsp; For some reason, this is always returning true even though I can see the _isDirty member being set to false when MarkClean() is called as a result of calling my object's Save() method.&nbsp; I'm using CSLA.net 3.5.2.<br><br>I've tried using IsSelfDirty, and calling MarkClean() manually in my DataPortal_Insert method, and am not having any luck.<br><br>I've included my small test program below.&nbsp; Can anyone tell me what I'm missing?&nbsp; Thanks in advance for any help.<br><br>using System;<br>using System.Collections.Generic;<br>using System.Linq;<br>using System.Text;<br>using Csla;<br><br>namespace Csla_IsDirty_Test<br>{<br>&nbsp;&nbsp;&nbsp; class Program<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; static void Main(string[] args)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; BusObject obj = BusObject.NewBusObject();<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Console.WriteLine(obj.IsDirty); //Prints true<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Console.WriteLine("Saving ...");<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; obj.Save();<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Console.WriteLine(obj.IsDirty); //Prints true<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Console.ReadLine();<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; [Serializable()]<br>&nbsp;&nbsp;&nbsp; public class BusObject : BusinessBase&lt;BusObject&gt;<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; #region Factory Methods<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; public static BusObject NewBusObject()<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return DataPortal.Create&lt;BusObject&gt;();<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; private BusObject() <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; { /*Require use of factory methods*/ }<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; #endregion Factory Methods<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; #region Data Access<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; [RunLocal()]<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; protected override void DataPortal_Create() { }<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; protected override void DataPortal_Insert()<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; protected override void DataPortal_Update()<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; #endregion Data Access<br>&nbsp;&nbsp;&nbsp; }<br>}<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Thursday, October 23, 2008</h2><P>Try:</P>
<P>obj =&nbsp;obj.Save();</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dculler replied on Thursday, October 23, 2008</h2>Ah, simple mistake.&nbsp; That did the trick, thanks for the help.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, October 23, 2008</h2><P>You have made the #1 error is CSLA coding - so you are in good company. </P>
<P>Here is the problem:</P>
<P>obj.Save();</P>
<P>should be:</P>
<P>obj = obj.Save();</P>
<P>You have to replace the obj reference when you save it!<BR></P>
<P>Joe</P>
<P><BR>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
