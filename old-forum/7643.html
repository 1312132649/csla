<html><header><title>Help with &quot;switchable&quot; objects...</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Help with &quot;switchable&quot; objects...</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7643.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>NickTaylor posted on Wednesday, September 16, 2009</h2><P>Hi,</P>
<P>I wonder if some wise person can assist me with this please...</P>
<P>I have a simple root business object that in turn contains a child&nbsp;collection. For the sake of simplicity, let's call the root object "BoCustomer", and the child collection "ListBoCustomerContacts".&nbsp;As far as the business logic goes, BoCustomer&nbsp;will always be a parent object and is not required to exist in any form of collection. The child list, i.e. ListBoCustomerContacts contains a bunch of BoCustomerContact objects which will always be child objects&nbsp;and will never exist in their own right. All faily clear cut... </P>
<P>However, as part of my Winforms UI, I wish to display a bunch of customers in a grid ( mainly for the purposes of navigation ). Previously I had queried the database with something like "SELECT * FROM CUSTOMERS", and used the resulting datatable to populate the grid&nbsp;directly within the UI. Note that I am not bothered about the contacts at this point.&nbsp;It worked fine, but its not clean as this sort of stuff shouldn't really be in the UI should it !?</P>
<P>After a few discussions on&nbsp;this forum&nbsp;it is suggested that what I should be doing is&nbsp;using a customers collection to return the bunch of customer objects, and then bind to this in the UI. I would expect to create an editable root collection object that can be used to hold my BoCustomer root objects, and provide this&nbsp;with a method such as GetAllCustomers() which populates itself with a BoCustomer object for each customer in the database. But in doing this I have now made the BoCustomer object switchable haven't I ?&nbsp;I now have to have a collection object, and&nbsp;both root and child code within BoCustomer? This seems a bit excessive and the book advises against using switchable objects unless absolutely necessary.</P>
<P>So really the question is how do I return simple lists of things which are really only being used by the UI, and are not part of the business logic ?? Is it a case of a collection for everything, or does my original method of simply querying the database still have a place...?</P>
<P>Any suggestions would be most welcome...</P>
<P>Thanks,</P>
<P>Nick</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dlambert replied on Wednesday, September 16, 2009</h2>I've usually ended up creating a "lite" read-only version of these sorts of objects for use in lists, search results, etc., with the understanding that if someone wants to navigate to a "real" edit screen for this object, you'd load the "real" object for editing.<br /><br />So, depending on what you want to do naming convention-wise, you might end up with:<br /><br />* Customer -- this is the fully-editable object.<br />* CustomerInfo -- this is a lite, read-only version of Customer.  You can make this as big as it needs to be for your lists, but keep in mind that you'll be creating these in quantity, so it pays to keep it skinny if you can.<br />* CustomerInfoList -- this is a collection of CustomerInfo.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Wednesday, September 16, 2009</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>NickTaylor:</strong></div><div>...But in doing this I have now made the BoCustomer object switchable haven't I ?&nbsp;I now have to have a collection object, and&nbsp;both root and child code within BoCustomer? This seems a bit excessive and the book advises against using switchable objects unless absolutely necessary...</div></BLOCKQUOTE></P>
<P>My experience has been root objects work just fine as children -- you just have to call MarkAsChild on them when they are fetched. If you have an intermediate class layer you derive from instead of deriving directly from CSLA classes, this isn't hard to do. </P>
<P>I think the argument against doing this is based on use cases and that the need to do so calls the design into question -- the rules and and behavior may be different in the child scenario versus the root, and often when you are trying to use a root as a child what you really should have is an object that is specific to the relationship between them.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ozitraveller replied on Wednesday, September 16, 2009</h2>For something as simple as this I'd probably use a DataTable particularly if there is a lot of data and only load a bo when adding/editing savable data.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, September 17, 2009</h2>Yes, thats the arguement against switchable designs.  Basically it can lead you to a point where you're doing:<br /><br />if ( IsChild ) { do this } else { do this }<br /><br />which leads to hard to maintain fragile code.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>NickTaylor replied on Thursday, September 17, 2009</h2><P>Thanks to all for the responses...</P>
<P>I think for the time being I will stick with just returning a datatable and using this within the UI. It&nbsp;is the&nbsp;simplest solution for now. I quite like the idea of the lite collection and lite business object as this isn't something I hadn't considered. This is one for the future perhaps...</P>
<P>I guess in the true sense of the word my BoCustomer object&nbsp;isn't really switchable as it would&nbsp;never be used as a child and therefore we avoid any potentially messy business logic. I can now see why this scenario is best avoided.&nbsp;Its merely a child when its loaded as part of a collection and&nbsp;perhaps adding the code to load BoCustomer from a datareader isn't such a big deal after all.</P>
<P>Many thanks,</P>
<P>Nick</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, September 17, 2009</h2>Be aware by doing this you lose one of the benefits of Csla, which is the ability to switch easily from a 2-tier deployment to a 3-tier one.<br /><br />The "light" type objects are very easy to build, I would recommend taking the time to do so... you'll save yourself headaches in the future, especially if your data layer changes.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>NickTaylor replied on Friday, September 18, 2009</h2><P>Yes, you are right... We are undoubtedly going to change our database in the future as we are currently working with legacy FoxPro data and will want to move this to SQL later down the line. My simple SQL statement should have a "light" list and "light" business object associated with it. I can create these with some object factory code, so as you say, creating these objects should be easy. I can then use the "light" list to populate combos, grids, etc...</P>
<P>Many thanks!</P>
<P>Nick</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Friday, September 18, 2009</h2><P>Ok, how does the light object work in the grid in this situation?</P>
<P>A business object has 20 properties with complex logic to validate.</P>
<P>We're using an asp.net web page for the UI.</P>
<P>We'll assume the presence of a full-featured edit page somewhere using the full "heavy" business object.</P>
<P>On another web page, the user&nbsp;wants to show a subset of those objects and&nbsp;just 4 of those properties in the grid.&nbsp; The user wants to be able to change those properties directly in the grid, not go to another page to change the properties.</P>
<P>There might be several of these pages, with slightly different filter criteria and a slightly different set of 4 to 6 properties.</P>
<P>I don't want to duplicate business rule code across multiple objects.</P>
<P>What to do?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, September 18, 2009</h2>Hmm.. that's more tricky.  The "light" objects above I believe were simply readonly objects used to present some data, not edit.  Your scenario sounds different.<br /><br />Honestly, probably your best bet is to code everything seperately, then refactor common code into shared (probably internal) classes.   If you're really careful, you can probably do this at the design layer.. design your BOs to fit uses cases, identify any common functionality, then redesign add the shared classes.<br /><br />The filter criteria shouldn't matter.. you shouold be able to reuse the same classes and provide different factory methods, or dirctly expose criteria classes.  Different properties though will likely require different public classes.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, September 18, 2009</h2>Well, then creating the objects now is the right choice.  Later when you decide to move, you can simply update the DataPortal_Fetch and Child_Fetch code, and that's all you'll have to do!</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Friday, September 18, 2009</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>Well, then creating the objects now is the right choice. Later when you decide to move, you can simply update the DataPortal_Fetch and Child_Fetch code, and that's all you'll have to do!</div></BLOCKQUOTE></P>
<P>I'm confused.&nbsp; :(</P>
<P>Was that an answer to my question?&nbsp; Because I truly don't understand what you're trying to tell me if it was.</P>
<P>Edit Note:&nbsp; Ok, I see your second post now.&nbsp; Happy, happy. :)</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>NickTaylor replied on Friday, September 18, 2009</h2>I'm just using a very simple light list based on ReadOnlyListBase and a light "business object" based on ReadOnlyBase ( with a Fetch(dr) method only ). Obviously these only need minimal code, and they dont overlap any code already present in the true business object. I am only using it to populate grids etc in the UI, and so far it seems to work pretty well.<br /><br />Nick<br /><br /></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
