<html><header><title>CSLA 3.0 issue (braking change?)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA 3.0 issue (braking change?)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2715.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>stefan posted on Tuesday, April 17, 2007</h2>Hi,<br><br>I just downloaded the csla 3.0 TEST version, because I want to take advantage of a few enhancements <br>regarding validation (-&gt; PropertyFriendlyName). I deleted all things from the csla project that related<br>to .NET 3.0, prior to building csla, as I am not switching yet. <br>Then I updated all references to csla.dll in my project. The project still built successfully.<br><br>The (runtime) issue:<br>I have a property returning an enum type, joined to a validation rule from the common set: <br>StringMaxLength, which worked properly with csla 2.1.3 (well, at least I got no exception ;-) ).<br>This doesn't work anymore. Rock states this in his remarks coming with StringMaxLength:<br><br>&nbsp;&nbsp;&nbsp; /// &lt;remarks&gt;<br>&nbsp;&nbsp;&nbsp; /// This implementation uses late binding, and will only work<br>&nbsp;&nbsp;&nbsp; /// against string property values.<br>&nbsp;&nbsp;&nbsp; /// &lt;/remarks&gt;<br><br>The code inside StringMaxLength causing the exception is:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string value = (string)Utilities.CallByName(<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; target, e.PropertyName, CallType.Get);<br><br>Prior to this, I used the vb Version of clsa 2.1.3.<br>The equivalent line of code there reads:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim value As String = _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CStr(CallByName(target, e.PropertyName, CallType.Get))<br><br>I wonder why I got no exceptions in the past?<br>Any enlightenment?<br><br>Stefan<br><br><br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Tuesday, April 17, 2007</h2><P>I have not looked at the Utilities.CallByName method - but it looks like it is something Rocky wrote rather than the one in the .Net framework.</P>
<P>Try changing to to old style and see if it works for you.</P>
<P>I re-wrote the common rules in my own Module so that I could do these kinds of things without re-compililng the CSLA.dll. Plus I added my own new rules, etc.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, April 17, 2007</h2><P>You may have stumbled across a slight difference between VB and C#.</P>
<P>In VB I use the built-in CallByName functionality provided by Microsoft - no sense writing my own.</P>
<P>In C# I <EM>had</EM> to write my own, but I only wrote a small subset. The VB runtime does a lot of really cool stuff, and I don't have the time or inclination to replicate all of it to C# <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /></P>
<P>My guess is that the VB CallByName method does some pretty cool type coercion, and that's great. But my C# code just uses straight reflection and obviously doesn't handle that case.</P>
<P>Consider the extra VB functionality a bonus - but an unintended one - the idea is only to support string type properties.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
