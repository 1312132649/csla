<html><header><title>remoting issue</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>remoting issue</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2537.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jmkl1234 posted on Friday, March 16, 2007</h2><P>Hi,</P>
<P>I've read and learned quite a bit from your Expert VB 2005 Business Objects, and I've used some of the concepts to implement my own architecture.&nbsp; I wanted to use .NET Remoting for running some of my objects from a client on a server, but I have a problem.&nbsp; All my objects either inherit from a class called OBase(of T) or OBaseList(Of T).&nbsp; OBase(of T) can inherit from MarshalByRefObj like I need it to to remote all my objects that dervice from it, but OBaseList(Of T) already inherits from BindingList(Of T). ...so how can I possibly make my list objects run on the server, since I can't have OBaseList(Of T) inherit from both BindingList(Of T) and MarshalByRefObj.&nbsp; Is there a way around this that I can't think of?&nbsp; Any help would be appreciated.&nbsp; </P>
<P>Also, what if I went the Enterprise Services route for remoting instead of .NET Remoting - then will it work if I create one object called RemotObjectCreator that inherits from ServicedComponent and use that object to create all my other objects on the server and returns a reference&nbsp;of those to the client?&nbsp; Will those object's methods run on the server when called then since they were returned by reference, or no because they themselves don't inherit ServicedComponent (which would bring me back to square one since I can't have OBaseList(Of T) inherit from anything else but BindingList(of T)???</P>
<P>Thank you!!</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, March 16, 2007</h2><P>You can't, and shouldn't, have an object that is both anchored (see Chapter 1) and which implements your domain object model. As you note, there are many base classes in .NET that aren't anchored, but which you need to implement common scenarios.</P>
<P>You are best off thinking about one set of objects that expose methods or services across the network, and another set of objects that implement your business model.</P>
<P>In the case of CSLA .NET, the business model objects are mobile objects (see Chapter 1). But you can use similar techniques to create a server-only object model that would run behind your MBRO service objects.</P>
<P>It is important to realize, however, that it is virtually impossible to create a rich set of server-only business objects and still implement them in an object-oriented manner. The reality is that the client can't call across the network to get each object property, or each row in a collection - at least not if you value any sort of performance.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jmkl1234 replied on Friday, March 16, 2007</h2><P>Thanks - I see your point. ...I can't at this point in our development change our architecture though, so it seems remoting this way may be out of the question.&nbsp; But what if I had one MarshalByRefObject that I run on the server that I just use to pass my business objects (which aren't marshalbyref, but still serializable) by ref to the server and pass a method and it's parameters to call on them to this object.&nbsp; Would this be a good workaround?</P>
<P>Say I have a class called RemoteObjectRunner:</P>
<P>Public Class RemoteObjectRunner</P>
<P>&nbsp;&nbsp;&nbsp;Inherits MarshalByRefObj</P>
<P>&nbsp;&nbsp;&nbsp;Public Sub RunObjectAndItsMethodOnServer(ByRef myBusinessObject As Object, ByVal methodName As String, ByVal parameters As Object())</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'call "methodName" on myBusinessObject here - will this method run on the server this instance</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'of RemoteObjectRunner is running on then? ...that seems like it could work</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'...so something like this:</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim myMethod As MethodInfo = myBusinessObject.GetType.GetMethod(methodName)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myMethod.Invoke(myBusinessObject, parameters)</P>
<P>&nbsp;&nbsp;&nbsp;End Sub</P>
<P>End Class</P>
<P>&nbsp;</P>
<P>So would passing my local business objects to this server object to call a method on them that I want run on the server work?</P>
<P>For example, if I have an instance of my object called myObjectInstance and wanted to call it's Save method, but want it run on the server, will then&nbsp;calling: RunObjectAndItsMethodOnServer(myObjectInstance, "Save", Nothing) cause it to be run on the server the way I've proposed implementing the RemoteObjectRunner object?&nbsp; ...sorry if I'm reiterating what I want to do - I have trouble explaining myself sometimes, and want to make sure I'm being clear about what I want to do.</P>
<P>Thank you again!!!</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Sunday, March 18, 2007</h2><P>Yes, in concept this is exactly what the data portal does, though it imposes some more formal structure than what you are proposing.</P>
<P>In the simple case, this is pretty easy to implement. You may find, like I did, that you often want to step beyond the simple case, and then things can get very complex. The data portal now implements almost all the functionality of the late binder in the VB runtime, for example, because I ended up needing to support generic types, method overloads and so forth.</P>
<P>But if you can avoid the use of generic types and methods, and avoid using Overridable methods you should be set.</P>
<P>OR, since you are using VB, you could specify that the method to be called on the server must be a public method. Then you could just let VB's pre-built late binder do the work for you by setting Option Strict Off in your server-side calling file.</P>
<P>I hope that makes sense? VB already fully supports all the fancy coding necessary to do a late bound call on a public method. The <EM>only</EM> reason I wrote all that reflection code in the data portal is because I'm calling non-public methods (well, and because I also need a C# implementation, and C# doesn't have the dynamic language features of VB).</P>
<P>If I were doing a pure VB implementation, and was willing to require that the method-to-be-called had to be public, I'd just use the built-in dynamic language capabilities of VB itself.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jmkl1234 replied on Monday, March 19, 2007</h2>Late binding in case of doing this sounds like a good idea - easier to manage.&nbsp; Thank you for all your help and advice!</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
