<html><header><title>DataPortal.ReFetch?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>DataPortal.ReFetch?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/608.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Kirk posted on Wednesday, July 12, 2006</h2><P><SPAN>I have certain objects in my system that are time-sensitive - in other words, they are retrieved by a combination of primary key + date (for example, a stock "price" object).<o:p></o:p></SPAN></P>
<P><SPAN>One thing I am struggling with is the desired behavior to allow a user to change the effective date in a user interface, and have all the time-sensitive objects in the form re-fetch themselves accordingly.<o:p></o:p></SPAN></P>
<P><SPAN>I would prefer to not get a new object reference, since the databinding implications would require the UI to be a lot smarter than it should be.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>The proper solution – I think – is to implement a data portal “re-fetch” method.&nbsp; This would allow&nbsp;me to re-populate the internal members without returning a new instance of the object.</SPAN></P>
<P class=MsoNormal><SPAN><o:p></o:p></SPAN>&nbsp;</P>
<P class=MsoNormal><SPAN>An alternative would be to implement a static (not factory) method that takes the object reference and the criteria, invokes the fetch, and in some fashion copies the values from the new object to the “old” object… not sure which is preferable to everyone else but this seems like more of a hack to me.<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN></SPAN>&nbsp;</P>
<P class=MsoNormal><SPAN>Has anyone else run into this type of issue?<o:p></o:p></SPAN></P>
<P><SPAN></SPAN>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Friday, July 14, 2006</h2><P>We have the same mechanism built-into our framework to support "real-time" information that needs periodic refreshing.&nbsp; Without getting too much into the inner workings, the basic problem you have with the CSLA implementation when doing this is, as you eluded, the fact that the data portal returns a new instance of the object each time and the goal is to maintain the current object with the updated information.&nbsp; Check out this post:</P>
<P><A HREF="/forums/thread/2690.aspx">http://forums.lhotka.net/forums/thread/2690.aspx</A></P>
<P>There's been quite a discussion on this concept.&nbsp; Once you sort out how to perform the update on the client with the information returned from the data portal, implementing the refresh process is much easier.</P>
<P>In our case, we have a Refresh() method on our objects (instance scope, not static), that will call our data portal Fetch method just as we do when first instantiating the object.&nbsp; The difference is that we don't pass the returned object back to the caller, instead we pass this object to our MergeWith() method which performs the update to the existing instance.</P>
<P>With this in place, we can tailor our application to make use of this Refresh method either through manual means, such as a toolbar button, or automatically via the event handler for a timer.</P>
<P>Hope that helps.</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
