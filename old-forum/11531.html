<html><header><title>Business Rules in MonoDroid</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Business Rules in MonoDroid</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11531.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>katalun4o posted on Thursday, August 16, 2012</h2><p>Hello, </p>
<p>I am trying to add business rules in Monodroid project for a CSLA root class. The rule just checks if a string is valid. It seems to be working with context.AddErrorResult(PrimaryProperty,&quot;Tax number is not correct&quot;); and context.AddSuccessResult(false); but when i call context.AddWarningResult(PrimaryProperty, &quot;Tax number is not correct&quot;); my BeginSave method always throws TimedOut exception. Any suggestions ?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, August 16, 2012</h2><p>Which version of CSLA do you use? </p>
<p>Is your app N-tier or Edge application? </p>
<p>The most likely cause is something to do with serialization/deserialization and sometimes also WCF configuration. The Exception typically means that the client never get an answer from the server. So - assuming that it is N-tier - the next thing to check is that the message gets to the server and what happens on the server. </p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>katalun4o replied on Friday, August 17, 2012</h2><p>I am using the latest version for monodroid 4.3.13. And i still doesnt have WCF and server, this is simple class that is fetching and updating data on sqlite database and i have a simple rule that checks if a string (Tax Number) is valid (the reminder of the sum of first 8 digits devided to 11 should be equal to last digit) and I want this to be a warning. But if i call context.AddWarningResult in my business rule and after that i call BeginSave i get TimedOut exception.. it is workig with context.AddErrorResult without any errors. </p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Friday, August 17, 2012</h2><p>Well, if you call AddErrorResult (broken rule with severity Error) you are not allowed to call BeginSave. </p>
<p>So I&#39;ll assume that when:</p>
<ul>
<li>there is no broken rules you can call BeginSave and it saves OK. </li>
<li>there is&nbsp;broken rule(s) with severity Error you are not allowed to call BeginSave (should throw exception)</li>
<li>there&nbsp;broken rules but none with severity Error&nbsp;yu are allowed to call BeginSave (should save OK but&nbsp;you get a timeout exception)&nbsp;</li>
</ul>
<p>If all above is true&nbsp;then I would suspect some serialization/cloning issue with&nbsp;BrokenRulesCollection/BrokenRule. </p>
<p>If&nbsp; you call </p>
<p><strong>var obj2 = obj.Clone(); </strong></p>
<p>on your business object (before the BeginSave call) - does the Clone run OK? </p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>katalun4o replied on Monday, August 20, 2012</h2><p>Calling <strong>var obj2 = obj.Clone(); raises the same exception...<br /></strong></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Monday, August 20, 2012</h2><p>What is the exception you get? Is it still a Timeout exception on the Clone method? </p>
<p>It does seem like a serialization issue with the BrokenRulesCollection.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
