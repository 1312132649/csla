<html><header><title>ComboBox Binding to a ReadOnlyList</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ComboBox Binding to a ReadOnlyList</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/316.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>pfeds posted on Thursday, June 08, 2006</h2><P>I'm not entirely sure how to do this, so would appreciate some advice.&nbsp; This might be simple to do (or maybe not)?</P>
<P>I have an&nbsp;Employee Detail View that has a Location property - the site that they work at.&nbsp; This property is naturally bound to the Employee object.&nbsp; I now have a LocationList of LocationInfo objects.</P>
<P>What I want is to convert the Location text box to a combo box, with the data bound to the Location collection&nbsp;and the SelectedValue remaining bound to the Employee object.&nbsp; Additionally this needs to default to the default site within the Location collection.</P>
<P>The reason I am posting is to see whether this is a feasible solution. In most CSLA projects it seems that selection/picker dialogs are used instead...?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pfeds replied on Thursday, June 08, 2006</h2><P>Sorry, that was an end of the day post. I've just figured out how to do that <img src="/emoticons/emotion-44.gif" alt="Coffee [C]" /></P>
<P>I feel like a newbie developer now...</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pfeds replied on Friday, June 09, 2006</h2><P>Hmm, I do have a problem with this...</P>
<P>It seems that the databinding for the list in the combobox will alter the Employees Location property, therefore making the object dirty.</P>
<P>I've tried binding the list before and after the Employee object but suffer the same in both instances.&nbsp; Has anyone done this successfully, and if so then how?</P>
<P>Any advice appreciated! Thanks.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Friday, June 09, 2006</h2>How are you filling your combobox? How are you setting up databinding? Paste some code! :)<br>I've never had issues like that...<br><br>Also, what is the default value for your object? Is it a valid value? what does it automatically change to? Does it change to -1?<br><br>If the combobox recieves an invalid value it'll default to something else (usually -1).<br>Perhaps you want to fill your combobox with an an extra "&lt;Please select something&gt;" that has a the same value as your object's default....<br><br><br>Andrés<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pfeds replied on Friday, June 09, 2006</h2><P>Hi xal,</P>
<P>The code is roughly as follows (in the Load event of the control):</P>
<P>{</P>
<P>&nbsp;&nbsp;&nbsp;locationListBindingSource.DataSource = _locationList;</P>
<P>&nbsp;&nbsp;&nbsp;cboLocation.DataBindings.Add(new Binding("SelectedValue", _employee, "Location");</P>
<P>}</P>
<P>&nbsp;</P>
<P>The combo is bound via the locationListBindingSource, with both DisplayMember and ValueMember set to "LocationName" within the collection, and this&nbsp;list&nbsp;is currently populated with two locations:</P>
<P>Location1</P>
<P>Location2</P>
<P>&nbsp;</P>
<P>The problem is as such, if the Employee's location is Location1 then everything works fine.&nbsp; However, if it is Site2 then something occurs to make the Employee object dirty. Somehow the combination of the two bindings seems to cause this.</P>
<P>Any ideas?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pfeds replied on Monday, June 12, 2006</h2>Anybody <img src="/emoticons/emotion-4.gif" alt="Stick out tongue [:P]" /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Monday, June 12, 2006</h2>Sorry, I saw your post the other day and forgot to reply... <img src="/emoticons/emotion-10.gif" alt="Embarrassed [:$]" /><br><br>You say "However, if it is Site2 then something occurs to make the Employee object dirty"<br>Site2 isn't in the list, so I suppose binding to selected value will fail and will reset the combobox to an empty value or something that exists on the list. What value is being set in your bo when databinding triggers the change?<br><br>Andrés<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
