<html><header><title>Temporary authorization on BO w/ 3.0.2</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Temporary authorization on BO w/ 3.0.2</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3654.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>esteban404 posted on Friday, October 05, 2007</h2><P>It has been a while, done lurking,&nbsp;and I'm jumping from 1.53 to 3.0.2. Thankfully, there's no legacy code to worry about, but&nbsp;I cannot use .NET 3.0 features at all:<BR>PITA.Add(incompletImplementation.(this));</P>
<P>I have in my BO a use case where if a rule (manufacturing control limit) is broken, the worker needs to obtain an OK from an authorized person before they can continue. The use case calls for the PC to effectively lock until&nbsp;the event&nbsp;is dispositioned.&nbsp;Given that the current BO will be running using an unauthorized identity, the only thing I've come up with is a public method on my BO that will accept the response from a UI box of my design:<BR>public void AcceptDisposition(Guid _boID, int val){<BR>&nbsp;if(this.ID == _boolID)<BR>&nbsp;{ //goahead and process<BR>&nbsp;&nbsp;&nbsp; this.Val = val;}<BR>}// or something<BR>This would allow the change to be fed to the BO instance in the form and set/fire property changed events.</P>
<P>For example: an authorization is needed, my InputBox pops, user with proper authorization logs in,&nbsp;and feeds an "OK" and value to the BO via that method. I think that would remove any responsibility from my BO and it would only need to know the BO ID matches the one that it is changing and doesn't need to reload the BO or hit the db.&nbsp;It does seem to make the UI developer more responsible than she should be. IDK</P>
<P>Does this sound to hacky/hokey? If you have a suggestion, let me know.&nbsp;Nothing similar penetrated my allergy med shield&nbsp;as the same use case in the archives.</P>
<P>Thanks</P>
<P>_E</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>KKoteles replied on Friday, October 05, 2007</h2><P class=MsoNoSpacing><FONT face=Calibri>Would it be possible to add a few more rules?<SPAN>&nbsp; </SPAN>One would be that the OK property is required (and must be true) once the control limit has been reached (this would allow setting the control limit, but then it places the object in an invalid state once it has been set by always checking the OK property rule against the _originalLimit value).<SPAN>&nbsp; When the object is saved with the violating limit - the refreshed / updated object now has the violating limit as its _originalLimit value and the rule is broken.&nbsp; </SPAN>The second rule would be that the OK property can only be changed when the user belongs to the specific role you need.<SPAN>&nbsp; </SPAN>(You’ll need to keep a “copy” of the original values so you can check if&nbsp;they have been changed or not – before checking the role)</FONT></P>
<P class=MsoNoSpacing><SPAN>if</SPAN><SPAN> (_ok != _originalOK &amp;&amp; !Csla.<SPAN>ApplicationContext</SPAN>.User.IsInRole(<SPAN>"MyRoleHere"</SPAN>))<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>{<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN>e.Description = <SPAN>"Only MyRoleHere personnel can change Approval."</SPAN>;<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN>return</SPAN><SPAN> <SPAN>false</SPAN>;<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>}<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>else<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>{<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp; </SPAN>return</SPAN><SPAN> <SPAN>true</SPAN>;<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>}<o:p></o:p></SPAN></P>
<P class=MsoNoSpacing><FONT face=Calibri>Of course just setting the AllowWrite property covers the second rule where you would only need the first one.&nbsp; I know this gets a little strange – it is hard to tell sometimes where to draw the line between “Authorization” and “Validation”; however, I think this might work for you.<SPAN>&nbsp; </SPAN>Only the person in the correct role can make the change such that the object is in a valid state; therefore, only they can save / update it!</FONT></P>
<P class=MsoNoSpacing><FONT face=Calibri>Your situation may be a little more complicated, but it should just be a matter of creating rules for properties that break when the OK property is false and the violating limit is reached (and checked against the current value) so that they cannot change properties you do not want them to until the OK has been set by the appropriate authority.</FONT></P>
<P class=MsoNoSpacing><FONT face=Calibri>Ken</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>esteban404 replied on Monday, October 08, 2007</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>KKoteles:</strong></div><div> 
<P class=MsoNoSpacing><FONT face=Calibri>Your situation may be a little more complicated, but it should just be a matter of creating rules for properties that break when the OK property is false and the violating limit is reached (and checked against the current value) so that they cannot change properties you do not want them to until the OK has been set by the appropriate authority.</FONT></div></BLOCKQUOTE></P>
<P>Thanks, Ken, I think that's pretty close to what they need. I hadn't started combining&nbsp;rules yet&nbsp;b/c &nbsp;the users are&nbsp;still&nbsp;defining this case. I suppose there could be a child collection attached where the authorization is held (for traceability). I do know they wanted this type of information elsewhere.</P>
<P>I could expand this into a problem/fix collection for the process and/or&nbsp;part. It would allow them to see more trends that way on problem parts and also gather data about successful resolutions -- something they hadn't thought about.</P>
<P>Thanks for the suggestion. I'll ponder while they are finishing up the requirement. Good thing is this one thing will cascade throuhout the application. I think it sounds very beneficial&nbsp;in stabilizing the process.</P>
<P>_E</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
