<html><header><title>WinPart Id with ERLB</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>WinPart Id with ERLB</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6262.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>esteban404 posted on Tuesday, January 27, 2009</h2>I have several editors for ERLB objects. The WinPart code needs an id to identify the object being edited. What is the practice to identify these? Do I add an ID property to the ERLB itself? Seems reasonable, just checking for best practice.<br /><br />_E</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kdlc replied on Tuesday, March 17, 2009</h2>Did you find a way to handle this?<br />I'm having trouble if I try to load an empty ERLB liist to the Winpart-Inherited form. I'm thinking about removing the GetID and String methods.<br />Any suggestions?<br /><br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>esteban404 replied on Tuesday, March 17, 2009</h2>I don't think I solved anything. I just got it to work. I do include a Guid, but it hasn't been used. I get the Window list to populate with the open editors OK, and they are only allowed one open window per BO type. I constructed the ERLB list like this:<br />[Serializable()]<br /> public class QcpcList : Csla.EditableRootListBase<br /> {<br />  private Guid _Id;<br />  public Guid Id<br />  {get{ return _Id;}<br />    set{ if (_Id == value)  return;<br />    _Id = value;}<br />  }<br /><br />  #region Authorization Rules<br /><br />  #endregion<br /><br />  #region Factory Methods<br /><br />  protected override object AddNewCore()<br />  {Qcpc item = Qcpc.NewQcpc();<br />   Add(item);<br />   return item;<br />  }<br /><br />  public static QcpcList NewList()<br />  {<br />return DataPortal.Create();<br />  }<br /><br />  public static QcpcList GetList()<br />  {<br />return DataPortal.Create();<br />  }<br /><br />  public static QcpcList GetList(string workOrder)<br />  {<br />return DataPortal.Fetch(new Criteria(workOrder));<br />  }<br /><br />  private QcpcList()<br />  {<br />this.AllowEdit = true;<br />this.AllowNew = true;<br />this.AllowRemove = true;<br />  }<br /><br />  #endregion<br /><br />  #region Data Access<br />  <br />  #region Criteria<br /><br />  [Serializable()]<br />  public class Criteria<br />  {<br />private string _WorkOrder;<br />public string WorkOrder<br />{ get { return _WorkOrder; } }<br />public Criteria(string workOrder)<br />{<br /> _WorkOrder = workOrder;<br />}<br />  }<br /><br />  #endregion<br /><br />  private void DataPortal_Create()<br />  {<br />Qcpc q = Qcpc.NewQcpc();<br />Add(q);<br />  }<br /><br />  private void DataPortal_Fetch()<br />  {<br />DataPortal_Create();<br />  }<br /><br />  private void DataPortal_Fetch(Criteria criteria)<br />  {<br />this.RaiseListChangedEvents = false;<br />using (SqlConnection cn = new SqlConnection(Database.ProCertConnection))<br />{<br /> cn.Open();<br /> using (SqlCommand cm = cn.CreateCommand())<br /> {<br />  cm.CommandType = CommandType.StoredProcedure;<br /><br />  cm.Parameters.AddWithValue("@WorkOrder", criteria.WorkOrder);<br />  cm.CommandText = "getQcpcDefectList";<br />  using (SafeDataReader dr = new SafeDataReader(cm.ExecuteReader()))<br />  {<br />while (dr.Read())<br />{<br /> Add(Qcpc.GetQcpc(dr));<br />}<br />  }<br /> }<br />}<br />this.RaiseListChangedEvents = true;<br />  }<br /><br />  #endregion<br /> }<br /><br />Qcpc is a Csla.BusinessBase item. A new item is created with default values. In a couple of UIs, the list is summarily cleared just to make sure nothing is sitting there that's not part of the user's input before they begin. It's a hack.<br /><br />HTH,<br /><br />_E</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
