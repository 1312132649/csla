<html><header><title>Validation Rule - Must have at least one item in a child collection.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Validation Rule - Must have at least one item in a child collection.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/290.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 posted on Tuesday, June 06, 2006</h2><P>I'll use an example different from mine that is familiar. </P>
<P>Invoice - InvoiceLines - InvoiceLine</P>
<P>An Invoice must have at least one InvoiceLine would be the business requirement. </P>
<P>Now my property on my Invoice object for my InvoiceLines collection is read-only, of course.</P>
<P>Let's say I have a valid object and I&nbsp;remove&nbsp;the&nbsp;line from the InvoiceLines collection violating this business rule for the Invoice. </P>
<P>Do I need to maintain a referential link from the collection to the parent object in order to attempt to check a rule? (I don't like having these sorts of circular references but I've seen it somewhere in the framework where the link from the child to the parent is NonSerialize and NotUndoable). </P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Tuesday, June 06, 2006</h2>You could attach an event handler in Invoice to _invoiceLines.ListChanged.&nbsp; Then call ValidationRules.CheckRules("InvoiceLines") to see if _invoiceLines.Count &gt; 0.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Wednesday, June 07, 2006</h2><P>Thank you - worked like a charm. </P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
