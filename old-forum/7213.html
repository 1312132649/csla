<html><header><title>good case for switchable object or something else?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>good case for switchable object or something else?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7213.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>adamtuliper posted on Wednesday, July 01, 2009</h2>Lets take a scenario in the case of Books and Book objects.<br>Usually we load everything in the Books class and enumerate, etc. But we will not add new items to this collection and call save on the collection because when a new record is created we need the key back right away to set some other object information. We cannot call Child.Save() directly, and there is no parent collection at this point, we create one Book and want to insert it into the db and get its ID back.<br><br>Would this be a case for a switchable object or something else?<br><br>pseudo code using fake objects:<br><br>foreach(RareBook rareBook in rareBooks)<br>{<br><br>Book newBook = Book.GetBook();<br>newBook.Whatever=....;<br>newBook.Save()<br>--here we need the id <br>rareBook.BookId = newBook.BookId;<br>}<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, July 02, 2009</h2><P>Your pseudo code won' t work because the ID will never come back from the database due to this line of code:</P>
<P>newBook.Save()<BR><BR>It should be:</P>
<P>newBook = newBook.Save()<BR></P>
<P>I am not following the pseudo code very well - why are you calling GetBook instead of CreateBook? Why do you need the ID "right away"? Why not just leave rareBook with a fake ID until you do call save on the collection?</P>
<P><BR>Joe</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>adamtuliper replied on Tuesday, July 14, 2009</h2>yes.. the pseudo code should have CreateBook, my bad.As to your question why do you need the ID now.. that is the entire issue. You need the id to update other objects. There are other objects that for performance reasons aren't loaded/linked here we just need to know that once we get an id back we need to call another procedure to update the database to give it this new id, and this _has to_ be done after every record. I did eventually implement it as a switchable object and the world seems to be a better place now : )<br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
