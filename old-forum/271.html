<html><header><title>OT: ClickOnce and Mutexes</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>OT: ClickOnce and Mutexes</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/271.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Monday, June 05, 2006</h2>Hi all,<br><br>I tried my luck with this question in google groups, but no luck.&nbsp; So although its off topic, I'd like to see if anyone here has encounted and resolved this.<br><br>I have this code:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; appSingleton = new Mutex( false, "MedSales_App" );<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( appSingleton.WaitOne( 0, false ) ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Start my app<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Show&nbsp; message that app is already running<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>Executed on startup, to prevent multiple instances from running.&nbsp;&nbsp;&nbsp;&nbsp; Everything works fine locally, but when you launch the application after a ClickOnce installation, it doesn't work; the apps don't see the mutexes and allow startup.<br><br>Any ideas?<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, June 07, 2006</h2>Just wanted to bump this, in case the person with the solution hasn't seen it yet :-)<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>amselem replied on Friday, June 09, 2006</h2><P>This code works fine for me, even with clickonce deployments:</P>
<P><FONT color=#0000ff>Private</FONT> _Mutex <FONT color=#0000ff>As</FONT> System.Threading.Mutex</P>
<P><FONT color=#0000ff>Private</FONT> <FONT color=#0000ff>Function</FONT> IsOtherInstanceRunning() <FONT color=#0000ff>As</FONT> <FONT color=#0000ff>Boolean</P></FONT>
<P><FONT color=#0000ff>&nbsp;&nbsp; Dim</FONT> FirstInstance <FONT color=#0000ff>As</FONT> <FONT color=#0000ff>Boolean<BR>&nbsp;</FONT>&nbsp; <BR>&nbsp;&nbsp; _Mutex = <FONT color=#0000ff>New</FONT> Threading.Mutex(<FONT color=#0000ff>False</FONT>, <FONT color=#800000>"MyApplication"</FONT>, FirstInstance)<BR>&nbsp;&nbsp; <BR>&nbsp;&nbsp; <FONT color=#0000ff>Return</FONT> <FONT color=#0000ff>Not</FONT> FirstInstance</P>
<P><FONT color=#0000ff>End</FONT> <FONT color=#0000ff>Function</FONT></P>
<P>Hope that helps,<BR>Regards<FONT color=#0000ff></P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, June 12, 2006</h2>Hi amselem,<br><br>I tried checking the output boolean, but again this doesn't work for me with ClickOnce applications.&nbsp; It works fine if I run the application locally, but if I run from the shortcut which is created by the ClickOnce installation, I can still start mutliple instances.<br><br>Andy<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
