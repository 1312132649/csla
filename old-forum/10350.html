<html><header><title>Property that Only Accepts a Limited Set of Values.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Property that Only Accepts a Limited Set of Values.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10350.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>RaulLozano posted on Sunday, May 08, 2011</h2><p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">I have a business object that implements a property whose valid values are only those coming from a list of approved values. The values contained in the list come from a database table.</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">In order to prevent the user from setting the property to an invalid value, I have created a validation rule that verifies that the value entered into this property is contained on the list.</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">So in order to handle this gracefully, my business object does two things:</span></span></p>
<p class="MsoListParagraphCxSpFirst" style="text-indent:-0.25in;margin:0in 0in 0pt 0.5in;mso-list:l0 level1 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">1.</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">Retrieves and stores the list of these valid values (I need to do this so that my validation rule has the list to check against). </span></span></p>
<p class="MsoListParagraphCxSpLast" style="text-indent:-0.25in;margin:0in 0in 10pt 0.5in;mso-list:l0 level1 lfo1;"><span style="mso-bidi-font-family:Calibri;mso-bidi-theme-font:minor-latin;"><span style="mso-list:Ignore;"><span style="font-family:Calibri;font-size:small;">2.</span><span style="font:7pt &#39;Times New Roman&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></span><span style="font-size:small;"><span style="font-family:Calibri;">It also goes one step further and actually exposes the list of valid values as a property on my object so my UI can implement a combobox that binds its ItemSource property to it to allow the user to easily select a valid value.</span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Is this a good way to handle this scenario? </span></span></p>
<p class="MsoNormal" style="margin:0in 0in 10pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Thank you. </span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Monday, May 09, 2011</h2><p>Hi, </p>
<p>What is the UI framework you are using?</p>
<p>Yes, in general this is a good solution. </p>
<p>However - having the list of &quot;allowed properties&quot; in the BO is not always that good&nbsp;- especially in Windows Forms databinding and if your object is contained in a list. </p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, May 09, 2011</h2><p>The other issue with having the list of allowed values as a property of your editable object, is that when you save the editable object, that list of allowed values will serialize to the server too. That&#39;s probably wasted bandwidth, because the server could probably re-retrieve the values cheaper than the cost of serialization.</p>
<p>So you might want to implement this as a lazy-loaded property, with a private backing field, and mark the private backing field as NotSerialized. That will prevent the value from serializing over the wire, and any access of the property would trigger loading of the list. This doesn&#39;t work well in Silverlight, because the lazy load is async, and that complicates your scenario quite a lot.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fintanv replied on Tuesday, May 10, 2011</h2><p>I would encapsulate the list in a read only collection, caching the list in a static variable. &nbsp;This allows you to use it both for drop down population, and within your business rules.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Tuesday, May 10, 2011</h2><p>There are, generally speaking, two types of lookup list though.</p>
<p>There&#39;s the global lookup list, where a single list is used by many instances of another type to do the lookups or validation. That can be cached in a static cache field as you suggest.</p>
<p>There are also instance-specific lookup lists, where the lookup list is unique to a specific instance of the editable business object. Such a lookup list can&#39;t really be cached in a static field, because it is unique to that one editable object instance.</p>
<p>A UoW object can be used to retrieve such a thing, or a nonserialized lazy-loaded property can work (but not in Silverlight).</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fintanv replied on Wednesday, May 11, 2011</h2><p>To be honest I hardly ever use the static property pattern for implementing this. &nbsp;I use the MS Enterprise Frameworks caching functionality, and have created a base read-only list that takes advantage of it. &nbsp;Based on the factory methods input criteria, I generate a key that can be used to access the cached data, or if not found, pass the criteria on to the data portal. &nbsp;In this way I have the granularity required for individual business objects to have their own lists of values, while getting the advantages of cached data. &nbsp;There are additional benefits in having the ability to age the data, so it can be re-retrieved periodically if the app is open for a prolonged period of time.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
