<html><header><title>CodeSmith Template for NameValueList</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CodeSmith Template for NameValueList</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1661.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>wjcomeaux posted on Wednesday, November 01, 2006</h2><P>Does anyone have an example of XML that can create a NameValueList?</P>
<P>I am trying to generate a NameValue list that uses the ID field as well as a combination of fields for the value. So a User table would generate the properties ID, FirstName and LastName.</P>
<P>I will let the users Override the GetList method to provide the name in whatever format they want.</P>
<P>Here's what I have so far but it's throwing an Index out of range exception when I try to generate the code from it.</P>
<P><SPAN class=m><FONT color=#0000ff>&lt;</FONT></SPAN><FONT color=#990000><SPAN class=t>Object</SPAN><SPAN class=t> Access</SPAN></FONT><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>public</B><SPAN class=m><FONT color=#0000ff>"</FONT></SPAN><SPAN class=t><FONT color=#990000> Type</FONT></SPAN><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>namevaluelist</B><SPAN class=m><FONT color=#0000ff>"</FONT></SPAN><SPAN class=t><FONT color=#990000> Name</FONT></SPAN><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>NameValueListResource</B><FONT color=#0000ff><SPAN class=m>"</SPAN><SPAN class=m>&gt;</SPAN></FONT></P>
<DIV>
<DIV class=e>
<DIV class=c><A class=b><STRONG><FONT face="Courier New" color=#ff0000>-</FONT></STRONG></A> <SPAN class=m><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=t><FONT color=#990000>Properties</FONT></SPAN><SPAN class=m><FONT color=#0000ff>&gt;</FONT></SPAN></DIV>
<DIV>
<DIV class=e>
<DIV class=c><A class=b><STRONG><FONT face="Courier New" color=#ff0000>-</FONT></STRONG></A> <SPAN class=m><FONT color=#0000ff>&lt;</FONT></SPAN><FONT color=#990000><SPAN class=t>Property</SPAN><SPAN class=t> Name</SPAN></FONT><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>_ID</B><SPAN class=m><FONT color=#0000ff>"</FONT></SPAN><SPAN class=t><FONT color=#990000> Description</FONT></SPAN><FONT color=#0000ff><SPAN class=m>="</SPAN><B></B><SPAN class=m>"</SPAN></FONT><SPAN class=t><FONT color=#990000> Type</FONT></SPAN><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>string</B><SPAN class=m><FONT color=#0000ff>"</FONT></SPAN><SPAN class=t><FONT color=#990000> DataType</FONT></SPAN><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>AnsiString</B><SPAN class=m><FONT color=#0000ff>"</FONT></SPAN><SPAN class=t><FONT color=#990000> NativeType</FONT></SPAN><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>varchar</B><SPAN class=m><FONT color=#0000ff>"</FONT></SPAN><SPAN class=t><FONT color=#990000> SystemType</FONT></SPAN><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>System.String</B><SPAN class=m><FONT color=#0000ff>"</FONT></SPAN><SPAN class=t><FONT color=#990000> IsPrimaryKey</FONT></SPAN><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>true</B><SPAN class=m><FONT color=#0000ff>"</FONT></SPAN><SPAN class=t><FONT color=#990000> IsIdentity</FONT></SPAN><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>true</B><FONT color=#0000ff><SPAN class=m>"</SPAN><SPAN class=m>&gt;</SPAN></FONT></DIV>
<DIV>
<DIV class=e>
<DIV class=c><A class=b><STRONG><FONT face="Courier New" color=#ff0000>-</FONT></STRONG></A> <SPAN class=m><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=t><FONT color=#990000>ValidationRules</FONT></SPAN><SPAN class=m><FONT color=#0000ff>&gt;</FONT></SPAN></DIV>
<DIV>
<DIV class=e>
<DIV><SPAN class=b><STRONG><FONT face="Courier New" color=#ff0000>&nbsp;</FONT></STRONG></SPAN> <SPAN class=m><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=t><FONT color=#990000>Required</FONT></SPAN> <SPAN class=m><FONT color=#0000ff>/&gt;</FONT></SPAN> </DIV></DIV>
<DIV class=e>
<DIV><SPAN class=b><STRONG><FONT face="Courier New" color=#ff0000>&nbsp;</FONT></STRONG></SPAN> <SPAN class=m><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=t><FONT color=#990000>StringMaxLength</FONT></SPAN><SPAN class=m><FONT color=#0000ff>&gt;</FONT></SPAN><SPAN class=tx><STRONG>10</STRONG></SPAN><SPAN class=m><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=t><FONT color=#990000>StringMaxLength</FONT></SPAN><SPAN class=m><FONT color=#0000ff>&gt;</FONT></SPAN> </DIV></DIV>
<DIV><SPAN class=b><STRONG><FONT face="Courier New" color=#ff0000>&nbsp;</FONT></STRONG></SPAN> <SPAN class=m><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=t><FONT color=#990000>ValidationRules</FONT></SPAN><SPAN class=m><FONT color=#0000ff>&gt;</FONT></SPAN></DIV></DIV></DIV>
<DIV><SPAN class=b><STRONG><FONT face="Courier New" color=#ff0000>&nbsp;</FONT></STRONG></SPAN> <SPAN class=m><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=t><FONT color=#990000>Property</FONT></SPAN><SPAN class=m><FONT color=#0000ff>&gt;</FONT></SPAN></DIV></DIV></DIV>
<DIV class=e>
<DIV class=c><A class=b><STRONG><FONT face="Courier New" color=#ff0000>-</FONT></STRONG></A> <SPAN class=m><FONT color=#0000ff>&lt;</FONT></SPAN><FONT color=#990000><SPAN class=t>Property</SPAN><SPAN class=t> Name</SPAN></FONT><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>_FirstName</B><SPAN class=m><FONT color=#0000ff>"</FONT></SPAN><SPAN class=t><FONT color=#990000> Description</FONT></SPAN><FONT color=#0000ff><SPAN class=m>="</SPAN><B></B><SPAN class=m>"</SPAN></FONT><SPAN class=t><FONT color=#990000> Type</FONT></SPAN><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>string</B><SPAN class=m><FONT color=#0000ff>"</FONT></SPAN><SPAN class=t><FONT color=#990000> DataType</FONT></SPAN><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>AnsiString</B><SPAN class=m><FONT color=#0000ff>"</FONT></SPAN><SPAN class=t><FONT color=#990000> NativeType</FONT></SPAN><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>varchar</B><SPAN class=m><FONT color=#0000ff>"</FONT></SPAN><SPAN class=t><FONT color=#990000> SystemType</FONT></SPAN><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>System.String</B><FONT color=#0000ff><SPAN class=m>"</SPAN><SPAN class=m>&gt;</SPAN></FONT></DIV>
<DIV>
<DIV class=e>
<DIV class=c><A class=b><STRONG><FONT face="Courier New" color=#ff0000>-</FONT></STRONG></A> <SPAN class=m><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=t><FONT color=#990000>ValidationRules</FONT></SPAN><SPAN class=m><FONT color=#0000ff>&gt;</FONT></SPAN></DIV>
<DIV>
<DIV class=e>
<DIV><SPAN class=b><STRONG><FONT face="Courier New" color=#ff0000>&nbsp;</FONT></STRONG></SPAN> <SPAN class=m><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=t><FONT color=#990000>Required</FONT></SPAN> <SPAN class=m><FONT color=#0000ff>/&gt;</FONT></SPAN> </DIV></DIV>
<DIV class=e>
<DIV><SPAN class=b><STRONG><FONT face="Courier New" color=#ff0000>&nbsp;</FONT></STRONG></SPAN> <SPAN class=m><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=t><FONT color=#990000>StringMaxLength</FONT></SPAN><SPAN class=m><FONT color=#0000ff>&gt;</FONT></SPAN><SPAN class=tx><STRONG>50</STRONG></SPAN><SPAN class=m><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=t><FONT color=#990000>StringMaxLength</FONT></SPAN><SPAN class=m><FONT color=#0000ff>&gt;</FONT></SPAN> </DIV></DIV>
<DIV><SPAN class=b><STRONG><FONT face="Courier New" color=#ff0000>&nbsp;</FONT></STRONG></SPAN> <SPAN class=m><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=t><FONT color=#990000>ValidationRules</FONT></SPAN><SPAN class=m><FONT color=#0000ff>&gt;</FONT></SPAN></DIV></DIV></DIV>
<DIV><SPAN class=b><STRONG><FONT face="Courier New" color=#ff0000>&nbsp;</FONT></STRONG></SPAN> <SPAN class=m><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=t><FONT color=#990000>Property</FONT></SPAN><SPAN class=m><FONT color=#0000ff>&gt;</FONT></SPAN></DIV></DIV></DIV>
<DIV class=e>
<DIV class=c><A class=b><STRONG><FONT face="Courier New" color=#ff0000>-</FONT></STRONG></A> <SPAN class=m><FONT color=#0000ff>&lt;</FONT></SPAN><FONT color=#990000><SPAN class=t>Property</SPAN><SPAN class=t> Name</SPAN></FONT><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>_LastName</B><SPAN class=m><FONT color=#0000ff>"</FONT></SPAN><SPAN class=t><FONT color=#990000> Description</FONT></SPAN><FONT color=#0000ff><SPAN class=m>="</SPAN><B></B><SPAN class=m>"</SPAN></FONT><SPAN class=t><FONT color=#990000> Type</FONT></SPAN><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>string</B><SPAN class=m><FONT color=#0000ff>"</FONT></SPAN><SPAN class=t><FONT color=#990000> DataType</FONT></SPAN><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>AnsiString</B><SPAN class=m><FONT color=#0000ff>"</FONT></SPAN><SPAN class=t><FONT color=#990000> NativeType</FONT></SPAN><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>varchar</B><SPAN class=m><FONT color=#0000ff>"</FONT></SPAN><SPAN class=t><FONT color=#990000> SystemType</FONT></SPAN><SPAN class=m><FONT color=#0000ff>="</FONT></SPAN><B>System.String</B><FONT color=#0000ff><SPAN class=m>"</SPAN><SPAN class=m>&gt;</SPAN></FONT></DIV>
<DIV>
<DIV class=e>
<DIV class=c><A class=b><STRONG><FONT face="Courier New" color=#ff0000>-</FONT></STRONG></A> <SPAN class=m><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=t><FONT color=#990000>ValidationRules</FONT></SPAN><SPAN class=m><FONT color=#0000ff>&gt;</FONT></SPAN></DIV>
<DIV>
<DIV class=e>
<DIV><SPAN class=b><STRONG><FONT face="Courier New" color=#ff0000>&nbsp;</FONT></STRONG></SPAN> <SPAN class=m><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=t><FONT color=#990000>Required</FONT></SPAN> <SPAN class=m><FONT color=#0000ff>/&gt;</FONT></SPAN> </DIV></DIV>
<DIV class=e>
<DIV><SPAN class=b><STRONG><FONT face="Courier New" color=#ff0000>&nbsp;</FONT></STRONG></SPAN> <SPAN class=m><FONT color=#0000ff>&lt;</FONT></SPAN><SPAN class=t><FONT color=#990000>StringMaxLength</FONT></SPAN><SPAN class=m><FONT color=#0000ff>&gt;</FONT></SPAN><SPAN class=tx><STRONG>50</STRONG></SPAN><SPAN class=m><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=t><FONT color=#990000>StringMaxLength</FONT></SPAN><SPAN class=m><FONT color=#0000ff>&gt;</FONT></SPAN> </DIV></DIV>
<DIV><SPAN class=b><STRONG><FONT face="Courier New" color=#ff0000>&nbsp;</FONT></STRONG></SPAN> <SPAN class=m><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=t><FONT color=#990000>ValidationRules</FONT></SPAN><SPAN class=m><FONT color=#0000ff>&gt;</FONT></SPAN></DIV></DIV></DIV>
<DIV><SPAN class=b><STRONG><FONT face="Courier New" color=#ff0000>&nbsp;</FONT></STRONG></SPAN> <SPAN class=m><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=t><FONT color=#990000>Property</FONT></SPAN><SPAN class=m><FONT color=#0000ff>&gt;</FONT></SPAN></DIV></DIV></DIV>
<DIV><SPAN class=b><STRONG><FONT face="Courier New" color=#ff0000>&nbsp;</FONT></STRONG></SPAN> <SPAN class=m><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=t><FONT color=#990000>Properties</FONT></SPAN><SPAN class=m><FONT color=#0000ff>&gt;</FONT></SPAN></DIV></DIV></DIV>
<DIV><SPAN class=b><STRONG><FONT face="Courier New" color=#ff0000>&nbsp;</FONT></STRONG></SPAN> <SPAN class=m><FONT color=#0000ff>&lt;/</FONT></SPAN><SPAN class=t><FONT color=#990000>Object</FONT></SPAN><SPAN class=m><FONT color=#0000ff>&gt;</FONT></SPAN></DIV>
<DIV><SPAN class=m><FONT color=#0000ff></FONT></SPAN>&nbsp;</DIV>
<DIV><SPAN class=m><FONT color=#0000ff>Thanks,</FONT></SPAN></DIV>
<DIV><SPAN class=m><FONT color=#0000ff>Will</FONT></SPAN></DIV></DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>wjcomeaux replied on Wednesday, November 01, 2006</h2><P>I've gotten somewhere. I removed the ValidationRules and this allowed the class to generate but it</P>
<P>now emits like this</P>
<P>this.Add(new NameValuePair(dr.GetString(""), dr.GetString("")));</P>
<P>As you can see, it doesn't know what properties to get from the datareader, so now it's to figure out what attributes to emit in my XML Metadata.</P>
<P>Will</P>
<P>&nbsp;</P>
<P>&lt;Edit&gt;It appears that the template for a NameValue list simply grabs the Primary Key as the&nbsp;value and the first non-primary key property as the name field. This is a bit of a limitation when you want to display a set of users in LastName, FirstName order. Or am I missing something here?&lt;/Edit&gt;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, November 02, 2006</h2><P>You can modify the templates to suit your needs.</P>
<P>I added properties like these:</P>
<P>&lt;%@ Property Name="KeyName" Type="System.String" Optional="False" Category="Options" Description="The column name for the Key." %&gt;<BR></P>
<P>&lt;%@ Property Name="KeyType" Type="System.String" Optional="False" Default="String" Category="Options" Description="The Type of the Key." %&gt;<BR></P>
<P>&lt;%@ Property Name="ValueName" Type="System.String" Optional="False" Category="Options" Description="The column name for the Value." %&gt;<BR></P>
<P>&lt;%@ Property Name="ValueType" Type="System.String" Optional="False" Default="String" Category="Options" Description="The Type of the Value." %&gt;</P>
<P>Now I can specify the 2 field names and types when I generate.</P>
<P>Joe</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
