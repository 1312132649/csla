<html><header><title>Custom security requirements for business objects</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Custom security requirements for business objects</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9890.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>j0552 posted on Monday, December 20, 2010</h2><p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Hi</span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">My website application requires 3 different ways to authenticate a user. The first is through the standard username, password with forms authentication. The second logs someone in if a unique id, passed in the query string, is validated, &nbsp;so basically using forms authentication again. The third is via WCF. </span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">My question refers to the first two techniques. I want my business objects to be able to know and treat users differently depending on how they were authenticated. The business objects are secured using the CSLA roles based approach (v3.8.3). I&rsquo;m thinking I could add some new methods to the AuthorizationRules class, e.g.</span></span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:Consolas;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:blue;">private</span> <span style="color:blue;">static</span> <span style="color:blue;">void</span> AddObjectAuthorizationRules()</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:Consolas;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:Consolas;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#2b91af;">AuthorizationRules</span>.AllowAuthTypeGet(<span style="color:blue;">typeof</span>(<span style="color:#2b91af;">MyObject</span>), <span style="color:#2b91af;">&ldquo;PasswordLogin&rdquo;, &ldquo;UrlToken&rdquo;</span>);</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:Consolas;font-size:9.5pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:Consolas;font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:Consolas;font-size:9.5pt;">Then the methods could check the Authentication Type property. However I see that Csla uses this property so perhaps I might break CSLA if I do this.</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:Consolas;font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:Consolas;font-size:9.5pt;">I assume that my requirements are not unusual and therefore there may be a solution to work with CSLA. I&rsquo;d appreciate a bit of guidance about this and any lateral suggestions that might meet my needs.</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:Consolas;font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:Consolas;font-size:9.5pt;">Many thanks</span></p>
<p class="MsoNormal" style="margin:0cm 0cm 0pt;"><span style="font-family:Consolas;font-size:9.5pt;">Andrew</span></p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Monday, December 20, 2010</h2><p>You have to seperate authentication from authorization - they are very different things.</p>
<p>Authorization is simply making use of the user&#39;s identity (and roles, etc) to decide whether the user is allowed to do certain things. This pre-supposes that you know the user&#39;s identity (authentication), but otherwise has nothing to do with authentication.</p>
<p>Authentication is the process of identifying and verifying the user so you know the user&#39;s identity (and roles, etc).</p>
<p>CSLA doesn&#39;t really care how you authenticate the user. It uses the .NET principal object for authorization, and relies entirely on that value. There are many, many ways to set the .NET principal. CSLA doesn&#39;t care which one you use, or even if you use several within the same app.</p>
<p>CSLA has an authorization system, which is reflected by the code snippet in your post. That has nothing to do with authentication, and should be consistent regardless of how a user was authenticated. This works completely off the user&#39;s roles list.</p>
<p>In CSLA 4 however, authorization is much more flexible, and can take into account more than just the user&#39;s roles. It is very easy in CSLA 4 to leverage other properties of the principal or identity objects, or other ambient objects within the execution context. This was relatively difficult prior to version 4, and my recommendation prior to CSLA 4 is to try and get any required values into the user&#39;s roles list so you can use standard role-based authorization.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
