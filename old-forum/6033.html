<html><header><title>Another DataPortal.Fetch issue</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Another DataPortal.Fetch issue</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6033.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jubrane posted on Friday, December 19, 2008</h2><P><FONT face=Verdana size=2>Hello folks,</FONT></P>
<P><FONT face=Verdana size=2>Having trouble with a what should be a simple com+ wrapper for a .NET CSLA function.&nbsp; Here's the code within the wrapper:</FONT></P>
<P>&nbsp;&nbsp;public void SendMessage(string subject, string parms, int msgTypeID)<BR>&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;Hashtable keys = new Hashtable();<BR>&nbsp;&nbsp;&nbsp;string[] pairs = parms.Split('|');<BR>&nbsp;&nbsp;&nbsp;foreach(string pair in pairs)<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;string[] each = pair.Split('?');<BR>&nbsp;&nbsp;&nbsp;&nbsp;keys.Add(each[0], each[1]);<BR>&nbsp;&nbsp;&nbsp;}</P>
<P>&nbsp;&nbsp;&nbsp;Message.SendMessage(subject, keys, msgTypeID);<BR>&nbsp;&nbsp;}</P>
<P>Message.SendMessage is the CSLA function we created that I'm trying to call.&nbsp; I'm calling this from a Visual Basic 6 application (yes, I know, but we're stuck with it for now), and anytime I try and call the ComWrapper.SendMessage function I'm getting the following error:</P>
<P>Err.Number = -2146233088<BR>Err.Description = DataPortal.Fetch failed</P>
<P>Any help or insight would be VERY appreciated... even if it's to tell me I'm wasting my time and it can't be done.</P>
<P>Thanks in advance,</P>
<P>E</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, December 19, 2008</h2><P>You aren't given a lot of information about what this SendMessage() does - but I am guessing that it creates an instance of a business object? And that occurs by calling the data portal?</P>
<P>What you need is to get at the full stack trace (or use a newer version of CSLA) so you get better information about the actual exception that occurs.</P>
<P>My first guess though, is that you don't have a config file for your VB6 app, so your data access code is probably failing to get a connection string and so throws an exception. The .NET runtime looks for xxxxx.exe.config - even if xxxxx.exe is a VB6 app.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jubrane replied on Saturday, December 20, 2008</h2><P>Exactly right, sir.&nbsp; Thank you much.&nbsp; However, when I was running it through the debugger, it did not work.&nbsp; I had to compile the app and run it on its own to actually get it to run through the code.&nbsp; I wonder if vb.exe would need the config file for it to run through the debugger.&nbsp; <BR><BR>Anyway, I'll take it.&nbsp; Thanks again.</P>
<P>E</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
