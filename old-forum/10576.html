<html><header><title>GlobalContext</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>GlobalContext</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10576.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>mab posted on Monday, August 01, 2011</h2><p>Hello,</p>
<p>We would like to use an dictionary entry in ApplicationContext.GlobalContext to store a value that indicates a user account has been locked out (prior&nbsp;to logging on).&nbsp;In the Fetch method of the DataAccess class, we set the value with</p>
<p>
<p>Csla.ApplicationContext.GlobalContext.Add(&quot;IsLockedOut&quot;, true);</p>
<p>However, GlobalContext (along with ApplicationContext) is cleared out during the Fetch method of SilverlightRequestProcessor, making the value unavailable by the time the code-behind of the control is reached. I am trying to access the entry with</p>
<p>Csla.ApplicationContext.GlobalContext[&quot;IsLockedOut&quot;]&nbsp;</p>
<p>Is there some other way to access the value&nbsp;in the code-behind?</p>
</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Tuesday, August 02, 2011</h2><p>Because Silverlight requires that server interactions be async, the data portal is async. Because the data portal is async, there could be numerous simultaneous data portal calls. Because those calls will complete in unpredictable order, and because each one of them will bring back GlobalContext from that particular server call, it isn&#39;t possible for the returning GlobalContext (or any context) to automatically replace the context already on the client. </p>
<p>Just think of the mess that would cause!</p>
<p>So what we do is return GlobalContext as a property of the DataPortal object instance. You have (or can have) access to this in your factory method, and you can choose to merge the resulting GlobalContext value(s) back into the client-side GlobalContext when the callback occurs.</p>
<p>Something like this:</p>
<pre style="font-family:Consolas;background:white;color:black;font-size:13px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">public</span>&nbsp;<span style="color:blue;">static</span>&nbsp;<span style="color:blue;">void</span>&nbsp;GetRoles(<span style="color:#2b91af;">EventHandler</span>&lt;<span style="color:#2b91af;">DataPortalResult</span>&lt;<span style="color:#2b91af;">RoleEditList</span>&gt;&gt;&nbsp;callback)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:blue;">var</span>&nbsp;dp&nbsp;=&nbsp;<span style="color:blue;">new</span>&nbsp;<span style="color:#2b91af;">DataPortal</span>&lt;<span style="color:#2b91af;">RoleEditList</span>&gt;();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dp.FetchCompleted&nbsp;+=&nbsp;(o,&nbsp;e)&nbsp;=&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:green;">//&nbsp;use&nbsp;dp.GlobalContext&nbsp;here</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;callback(o,&nbsp;e);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;};<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dp.BeginFetch();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /></pre></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mab replied on Tuesday, August 02, 2011</h2><p>Thank you very much for the explanation!</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
