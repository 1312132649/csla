<html><header><title>UserControl Constructor Exception in Designer</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>UserControl Constructor Exception in Designer</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1026.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>FireGarden posted on Friday, August 25, 2006</h2><P>I have created a simple user control and have put a call to populate some business objects in the constructor. When I drag this control onto the designer an exception is thrown relating to the data portal.</P>
<P>See attached image. Is this a known issue? Is there a work around?</P>
<P>Rob Wheeldon</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Friday, August 25, 2006</h2>Rob,<br><br>If you do this sort of thing in the constructor or a form load, you should do it inside something like this:<br><br>If Not Me.DesignMode Then<br>...<br>End If<br><br><br>--<br>Andrés</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dean replied on Friday, August 25, 2006</h2>Rob,<br><br>Andrés suggestion may not work. <br><br>According to this http://msdn.microsoft.com/msdnmag/issues/03/04/Design-TimeControls/&nbsp; and my experience the DesignMode flag is not set to true until after the constructor is run. So you can use it in the load or other methods and it works but not the constructor.<br>&nbsp;<br>Alternatively I started populating the business objects/binding sources from outside the user control ie from within the load method of the form that hosts the control.<br><br>Dean. <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Saturday, August 26, 2006</h2>Rob, you might be right...<br>I usually use Factory methods that get the object and pass it to the constructor...<br>But, I believe the designer never calls your constructor. It calls the base class' constructor to make an instance of the object, and then uses the InitializeComponent() in order to get the designer to show your controls. That is why adding controls by hand in the constructor doesn't work with the designer.<br><br>Andrés<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>FireGarden replied on Saturday, August 26, 2006</h2><P><FONT face=Arial>For the record I changed the code in my user control as follows:</FONT></P><FONT color=#0000ff size=2>
<P><FONT size=3>if</FONT></FONT> (!<FONT color=#0000ff>this</FONT>.DesignMode) PopulateControls();</P>
<P><FONT face=Arial>This works perfectly. </FONT></P>
<P><FONT face=Arial>Thank You.</FONT></P>
<P><FONT size=2>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dean replied on Sunday, August 27, 2006</h2>Rob - was this in the constructor of your control?<br><br>Dean<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>FireGarden replied on Sunday, August 27, 2006</h2>Yes but I think I missed something because its no longer working. </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>David replied on Monday, August 28, 2006</h2><P>I ran into this issue a while back and was recommened to&nbsp;test for design mode with this:</P><FONT size=2>
<P>Application.ExecutablePath.ToLower().IndexOf(</FONT><FONT color=#800000 size=2>"devenv.exe"</FONT><FONT size=2>) &gt; -1</FONT></P>
<P><FONT size=2>Ugly I know, but hidden in a function you never see and&nbsp;it works for me.</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>FireGarden replied on Monday, August 28, 2006</h2><P>I changed the user control constructor as follows:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (</FONT><FONT color=#008080 size=2>Application</FONT><FONT size=2>.ExecutablePath.ToLower().IndexOf(</FONT><FONT color=#800000 size=2>"devenv.exe"</FONT><FONT size=2>) &gt; -1)<BR>{<BR>&nbsp;&nbsp;&nbsp;PopulateControls();<BR>}</P></FONT>
<P>and it now gives me the following exception when I try and load the main form:</P>
<P><STRONG>The designer loader did not provide a root component but has not indicated why. </STRONG></P>
<P>at System.ComponentModel.Design.DesignSurface.get_View()<BR>at Microsoft.VisualStudio.Shell.Design.WindowPaneProviderService.CreateWindowPane(DesignSurface surface)<BR>at Microsoft.VisualStudio.Design.Serialization.CodeDom.DeferrableWindowPaneProviderService.CreateWindowPane(DesignSurface surface)<BR>at Microsoft.VisualStudio.Design.VSDesignSurface.Microsoft.VisualStudio.Designer.Interfaces.IVSMDDesigner.get_View()</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>David replied on Monday, August 28, 2006</h2>Haven't you got that statement the wrong way around? It will currently only call&nbsp;PopulateControls if you <EM>ARE</EM> in design mode.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
