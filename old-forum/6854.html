<html><header><title>Inherits Project.vb Problem??</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Inherits Project.vb Problem??</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6854.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>khoogavin posted on Monday, April 27, 2009</h2><P>I have 1 BO let said Project_BO.vb. It inherits Project.vb.</P>
<P>In GetProject&nbsp;function, I&nbsp;use Project_BO.GetQuotation(id)&nbsp;instead of&nbsp;Project.GetQuotation(id)&nbsp;.</P>
<P>And it return an error message </P>
<P><STRONG>Exception Details: </STRONG><FONT face=Arial>System.InvalidCastException: Unable to cast object of type 'ProjectTracker.Library.Project' to type 'ProjectTracker.Library.Project_BO' .</FONT></P>
<P><FONT color=#ff0000>Line 184:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return CType(businessObject, Project_BO)</FONT></P>
<P>Thanks for helping.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, April 27, 2009</h2><P>It is difficult to do inheritance from a non-generic type, when the higher base classes are generic.</P>
<P>BusinessBase&lt;T&gt; is generic, and T is the type that inherits from BusinessBase&lt;T&gt;, and so there's code at that level that expects T to be your business type (Project). By subclassing Project, you are confusing the base class (and maybe the data portal).</P>
<P>You really have two options.</P>
<OL>
<LI>You can inherit from Csla.Core.BusinessBase, which is not generic. Then you can use non-generic inheritance all the way through your object model. You'll have to do a little extra work to replace the behaviors in BusinessBase&lt;T&gt; with non-generic equivalents (accepting/returning values of type object instead of T).</LI>
<LI>You can make your base class be generic. Project&lt;T&gt; instead of Project. I'd recommend doing this, as it makes better use of existing CSLA functionality, and this has been discussed many times on the forum, so there are many good examples.</LI></OL>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
