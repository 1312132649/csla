<html><header><title>CheckRules() on business type itself rules.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CheckRules() on business type itself rules.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11103.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rxelizondo posted on Saturday, January 28, 2012</h2><p>
<p>Hello,</p>
<p>I have a rule scoped to the business type itself and not to a specific property (the type of rule that takes a null as the property the rule is associated to).</p>
<p>What I would like to do now is to be able to execute this rule and *only* this rule when I need to do so. The problem is that since the rule is not associated to a specific property I can&rsquo;t do something like: &ldquo;CheckRule(SomeTypeItselfProperty)&rdquo;, instead the only way that I see I can run type itself rules is by doing a global &ldquo;CheckRules()&rdquo; call but this has the unfortunate side effect of running all the rules and not just type itself rules.</p>
<p>Other than creating a bogus property to associate type itself rules to that property and be able to run only the rules associate to the bogus property, is there another way to only run type itself rules? I tried &ldquo;CheckRules(null)&rdquo; but that crashes.</p>
<p>Thanks.</p>
</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Saturday, January 28, 2012</h2><p>Starting from CSLA 4.2, you can call &lt;bo&gt;.CheckObjectRules() to run all &quot;object&quot; level rules and raise OnPropertyChanged for AffectedProperties. </p>
<p>You can call this method on an object that is active in databinding. </p>
<p>Or if on a previous version&nbsp; - you can add the following code to your BusinessBase class: </p>
<p>&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br />&nbsp;&nbsp;&nbsp; /// Checks the object rules and notifies UI of properties that may have changed. <br />&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br />&nbsp;&nbsp;&nbsp; protected virtual void CheckObjectRules()<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var propertyNames = BusinessRules.CheckObjectRules();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (ApplicationContext.PropertyChangedMode == ApplicationContext.PropertyChangedModes.Windows)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OnUnknownPropertyChanged();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foreach (var name in propertyNames)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OnPropertyChanged(name);<br />&nbsp;&nbsp;&nbsp; }</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rxelizondo replied on Sunday, January 29, 2012</h2><p>&nbsp;</p>
<p>Thanks Jonny, thats exelent news.</p>
<p>We are not using&nbsp;the&nbsp;CSLA 4.2 as of now (we are using 4.1) but I think I will update the project this&nbsp;coming&nbsp;Monday to start using it and take advantage of the new features.</p>
<p>Thanks.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rxelizondo replied on Tuesday, January 31, 2012</h2><p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">Just out of curios, is there a way to associate a specific property to a type rule? Something like:</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">BusinessRules.AddRule(new Dependency(SomeProperty, &lt;PropertyThaPointsToTypeItselfRule&gt; ));</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">In this case, when the &ldquo;SomeProerty&rdquo; is changed, I would like all type rules to run. As of now, I am handling the situation by overriding the &ldquo;OnPropertyChanged&rdquo; as in:</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:9.5pt;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:9.5pt;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:9.5pt;">protected</span><span style="font-family:Consolas;font-size:9.5pt;"> <span style="color:blue;">override</span> <span style="color:blue;">void</span> OnPropertyChanged(<span style="color:blue;">string</span> propertyName)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">{</span></p>
<p class="MsoNormal" style="line-height:normal;text-indent:0.5in;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;color:blue;font-size:9.5pt;">if</span><span style="font-family:Consolas;font-size:9.5pt;"> (propertyName == SomeProperty.Name)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp; </span><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;</span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">this</span>.BusinessRules.CheckObjectRules();</span></p>
<p class="MsoNormal" style="line-height:normal;text-indent:0.5in;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;">Thanks.</span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Thursday, February 02, 2012</h2><p>Hi, </p>
<p>I&#39;d recomment to do this with an override of&nbsp; PropertyHasChanged and call &lt;bo&gt;.CheckObjectRules so that you will get an OnPropertyChanged for AffectedProperties from the object rules.&nbsp;</p>
<p>Having this code in the OnPropertChanged may create recursive calls/infinite loops as OnPropertyChanged is called from both PropertyHasChanged and CheckObjectRules.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
