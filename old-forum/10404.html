<html><header><title>Connection Manager Transaction</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Connection Manager Transaction</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10404.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>superservo15 posted on Tuesday, May 31, 2011</h2><p>Hi,</p>
<p>I have a stupid question and haven&#39;t found any documentation yet to help me out... hoping you smart people can :)</p>
<p>Looking at integrating transactions into our classes. I am updating all of our data access methods to use the ConnectionManager instead of just new connections. Because we are using stored procs, I would like to continue using the command object, which I now need to pass the active transaction to. I started the transaction from the connection manager in my UofW with the following line &quot;<span style="color:#008000;font-family:Consolas;"><span style="color:#008000;font-family:Consolas;"><span style="color:#008000;font-family:Consolas;"><span style="font-size:x-small;">conn.Connection.BeginTransaction()&quot; <span style="color:#000000;font-family:Arial;">with conn being my connection manager object.</span></span><br /></span></span></span><span style="color:#008000;font-family:Consolas;"><span style="color:#008000;font-family:Consolas;"><span style="color:#008000;font-family:Consolas;"><span style="color:#000000;font-family:Arial;"><br /><span style="font-size:x-small;">Then I go to add my new obejct... I am wondering, is there a way to access the transaction object from the connectionManager object or do I need to do a <br />&quot;Dim trans As SqlTransaction = conn.Connection.BeginTransactuin()&quot; and then pass that through somehow? if so, would be your suggested method for passign that guy around?</span></span></span></span></span></p>
<p><span style="color:#008000;font-family:Consolas;"><span style="color:#008000;font-family:Consolas;"><span style="color:#008000;font-family:Consolas;"><span style="color:#000000;font-family:Arial;">Thanks in advance :-)</span></span></span></span></p>
<p><span style="color:#008000;font-family:Consolas;"><span style="color:#008000;font-family:Consolas;"><span style="color:#008000;font-family:Consolas;"></span></span></span></p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Tuesday, May 31, 2011</h2><p>You should probably use the TransactionManager type instead of ConnectionManager.</p>
<p>The way ADO.NET works, the connection is unaware of things like transactions. But the transaction object is very much aware of the connection, and exposes the connection as a property.</p>
<p>The Csla.Data namespace includes manager types for connections, transactions, object contexts, entity contexts, and data contexts - trying to provide a way to reuse all these top-level data constructs. These are documented in the <em>Using CSLA 4: Data Access</em> ebook.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>superservo15 replied on Tuesday, May 31, 2011</h2><p>This resolved both of my issues, thanks :)</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
