<html><header><title>DataMapper GetPropertyValue request</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>DataMapper GetPropertyValue request</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6734.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong posted on Friday, April 03, 2009</h2><P>The DataMapper has performance improvements because it works with cached property's and DynamicMemberHandle, and CSLA reflection is using the DynamicMethodHandlerFactory which uses ILGenerator.Emit</P>
<P>Extreme speed, which is nice :)&nbsp; (good job!)</P>
<P>But i've a situation where i want to map specific property values from my data object to a dictionary, so i can use the dictionary later to go from dictionary to business object. The DataMapper.Map() has an exclusion parameter but that is in my situation overkill populating an exclusion set every time while i only want to read a few propertie values out an object.</P>
<P><BR>Can the following code be added to the DataMapper?</P><FONT size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>#region</FONT></FONT><FONT size=2> GetValue</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>static</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2> GetPropertyValue(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2> target, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2> propertyName)<BR>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>DynamicMemberHandle</FONT></FONT><FONT size=2> handle = </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>MethodCaller</FONT></FONT><FONT size=2>.GetCachedProperty(target.GetType(), propertyName);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>return</FONT></FONT><FONT size=2> handle.DynamicMemberGet(target);<BR>}</P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>#endregion</P></FONT></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, April 03, 2009</h2><P>I believe you can already do that using Utilities.CallByName().</P>
<P>DataMapper has one responsibility - which is to map properties from one object to another. If we need an object that exposes basic reflection-like concepts that's fine, but that's a different responsibiilty.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong replied on Friday, April 03, 2009</h2><P>Just one difference:</P>
<P>Utilities.CallByName is using pure (slow) reflection<BR>target.GetType().GetProperty(methodName)</P>
<P>Can u&nbsp;change the code under Utilities.CallByName to use (fast) dynamic member?<BR>Thru it always calls at least once GetProperty.... and then adds it to a cache</P><FONT size=2>
<P></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>DynamicMemberHandle</FONT></FONT><FONT size=2> handle = </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>MethodCaller</FONT></FONT><FONT size=2>.GetCachedProperty(target.GetType(), propertyName);<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>return</FONT></FONT><FONT size=2> handle.DynamicMemberGet(target);</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong replied on Friday, April 03, 2009</h2><P>Hmm i found the functionality already being available, i just didn't search good enough :)</P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>static</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>class</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>MethodCaller<BR></FONT></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>{<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>static</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2> CallPropertyGetter(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2> obj, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2> property)</P></FONT>
<P>Just not sure about the differences, is it really faster when using remoting or enterprise services.<BR>In a localproxy scenario it'll be increasing memory usage, but it will speed up the property reading.<FONT color=#2b91af size=2><FONT color=#2b91af size=2></P></FONT></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
