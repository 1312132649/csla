<html><header><title>BypassPropertyChecks</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>BypassPropertyChecks</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10237.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Kevin Fairclough posted on Tuesday, April 05, 2011</h2><p>Hi,</p>
<p>We&#39;re currently using <a title="AutoMapper" href="http://automapper.codeplex.com/">AutoMapper </a>to map our Csla BO to our NHIbernate data model via an object factory. &nbsp;The AutoMapper automatically maps an entire graph based configuration for each type in the graph.</p>
<p>What I need is to set BypassPropertyChecks on and off for each mapped type when going from data model to Csla bo. &nbsp;I can use intercepts in Automapper BeforeMap &amp; AfterMap to do this for each type in the graph.</p>
<p>My only solution up to now is to call methods in my BusinessBase override that sets the private field _bypassPropertyChecks like so:</p>
<p>
<pre>[<span>NonSerialized</span>]&nbsp;<span>private</span>&nbsp;<span>FieldInfo</span>&nbsp;_field&nbsp;&nbsp;=&nbsp;<span>typeof</span>(Csla.Core.<span>BusinessBase</span>).GetField(<span>&quot;_bypassPropertyChecks&quot;</span>,&nbsp;<span>BindingFlags</span>.Instance&nbsp;|&nbsp;<span>BindingFlags</span>.NonPublic&nbsp;|<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>BindingFlags</span>.FlattenHierarchy);<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>public</span>&nbsp;<span>void</span>&nbsp;BypassPropertyChecksMappingStart()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_field.SetValue(<span>this</span>,&nbsp;<span>true</span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /> <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>public</span>&nbsp;<span>void</span>&nbsp;BypassPropertyChecksMappingFinish()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_field.SetValue(<span>this</span>,&nbsp;<span>false</span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</pre>
</p>
<p>These methods are called in BeforeMap &amp; AfterMap respectively for each child in the graph when mapping takes place.</p>
<p>Is it safe to do this? &nbsp;A convention in AutoMapper ensures that they are always run in pairs.</p>
<p>Kevin</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, April 05, 2011</h2><p>In CSLA 4 there is an ICheckRules interface in Csla.Core. It exists specifically to allow external code to turn rule check on/off, and to force all rules to run. </p>
<p>We added this to support ASP.NET MVC, but it has other applications as well - such as yours.</p>
<p>There&#39;s a section in the <em>Using CSLA 4: Creating Business Objects</em> ebook that discusses all three supported techniques for enabling/disabling rules in an object.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Kevin Fairclough replied on Wednesday, April 06, 2011</h2><p>Thanks for that I needed to do that also. &nbsp;It would be nice if I could use similar methods with BypassPropertyChecks</p>
<p>Kevin</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, April 06, 2011</h2><p>I&#39;m not sure what you mean?</p>
<p>The three rule techniques for suppressing rules all end up using the same low-level scheme. So the ICheckRules interface does the same thing as BypassPropertyChecks, but in a way that provides you with more control.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Kevin Fairclough replied on Wednesday, April 06, 2011</h2><p>AutoMapper will set the property directly via its setter. &nbsp;I was under the impression BypassPropertyChecks stopped things like PropertyChanged being fired when loading the object from the database. &nbsp;If I use ICheckRules to supress rules from firing, do I still need to set BypassPropertyChecks aswell?&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, April 06, 2011</h2><p>I am almost 100% sure that ICheckRules does the same thing as BypassPropertyChecks - just through a different style of interface.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
