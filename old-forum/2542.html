<html><header><title>Calling CanWriteProperty with string literal</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Calling CanWriteProperty with string literal</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2542.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>mercule posted on Friday, March 16, 2007</h2><P>I'm setting up a BusinessBase object and adding authorization to it.&nbsp; If I use this code in a property:</P>
<P><FONT face="Courier New" size=2>CanWriteProperty(<FONT color=#0000ff>true</FONT>);</FONT></P>
<P>the authorization works as expected.&nbsp; But, if I use this:</P><FONT size=1>
<P></FONT><FONT face="Courier New" size=2>CanWriteProperty(<FONT color=#800000>"ResearchAnalystId"</FONT>);</FONT></P>
<P><FONT size=1><FONT size=3>my authorization always passes, whether or not I'm part of a group that has authorization.&nbsp; For referrence, the line from <FONT face="Courier New" size=2>AddAuthorizationRules()</FONT> is:</FONT></FONT></P><FONT size=1><FONT size=1>
<P></FONT><FONT face="Courier New" size=2>AuthorizationRules.AllowWrite(<FONT color=#800000>"ResearchAnalystId"</FONT>, <FONT color=#800000>"Administrator"</FONT>);</FONT></P>
<P><FONT size=1><FONT size=3>My main reason for wanting to call this method with a literal is to check authorization from the UI to control display of fields (label vs. dropdown).&nbsp; What am I doing wrong?&nbsp; Is there another way to do this?</FONT></P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Friday, March 16, 2007</h2>The boolean tells whether you want to throw an exception on failed authorization.&nbsp; You want to use <font face="Courier New" size="2">CanWriteProperty(<font color="#800000">"ResearchAnalystId"</font></font><font size="1"><font size="1"><font face="Courier New" size="2">, </font></font></font><font face="Courier New" size="2"><font color="#0000ff">true</font></font><font face="Courier New" size="2">);<br><br></font><font face="Courier New" size="2">CanWriteProperty(<font color="#800000">"ResearchAnalystId"</font>); will just tell you whether the current user can write to that property.</font><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mercule replied on Friday, March 16, 2007</h2><P>Thanks, Brian.&nbsp; I was definitely missing that in the property code.&nbsp; That works fine, now.</P>
<P>I'm still not getting the correct Boolean return from the CanWriteProperty method, though.&nbsp; It always returns <FONT face="Courier New" color=#0000ff size=2>true</FONT>,&nbsp;which is a problem from the UI.&nbsp; I don't think using a <FONT face="Courier New" size=2>try...catch</FONT> block is probably the best way to toggle UI elements.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, March 16, 2007</h2><P>So in the same scenario if you tell CanWriteProperty() to throw exceptions it throws, but if you tell it not to throw exceptions it returns true?</P>
<P>While there's always the possibility for bugs, I am a little skeptical here, because I use the ReadWriteAuthorization control all the time and it uses the boolean return technique to enable/disable the UI elements - it calls the same code you'd be calling.</P>
<P>That, by the way, is what I recommend, and what I show in Chapters 9 and 10 for the Windows and Web UI's - how to have the UI proactively find out what the user can and can't do so it can enable/disable the controls ahead of time.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
