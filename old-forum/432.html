<html><header><title>Is UI code REALLY independant of Data Portal configurations?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Is UI code REALLY independant of Data Portal configurations?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/432.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>brettswift posted on Wednesday, June 21, 2006</h2><P><A HREF="/forums/thread/1965.aspx">http://forums.lhotka.net/forums/thread/1965.aspx</A></P>
<P>That link is a reference to the "Online / Offline Smart Client " thread started by kdubious. </P>
<P>I have questions that will serve some of the comments on there, and my post on that thread. </P>
<P>&nbsp;</P>
<P>In the book it says you're supposed to be able to switch from a local datasource to a remote datasource via the config file, (sounds great for a smart client) but when I look at the code samples in the book I don't see how this can be done.... </P>
<P>I have a method that&nbsp;I'm trying to convert from<BR>1)&nbsp;a Local datasource where the Win Forms will connect with the database directly, and load up values in a TreeView control, <BR>to....<BR>2) loading them from my Web Service. </P>
<P>1) dealing with AnimalInfo objects that are loaded into the AnimalList<BR>2) if proxy classes are developed as in the PT sample app, I'd be dealing with AnimalData objects in an array. </P>
<P>So, question being - how do I write UI code so that it is independant of the Data Portal ?&nbsp; (2 parts)<BR>a) How do I make this line:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i)AnimalList aList = Animal.GetAnimalList();&nbsp; // from AnimalTracker.Library;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; compatible with this line:&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii)AnimalData[] aList = svc.GetAnimalList(); // using web service reference. </P>
<P>Maybe - these ReadOnlyList bases (AnimalInfo) are ok to use instead of the proxy classes? </P>
<P>I'm obviously still new to this and hoping that someone can help me out here, because I'm thinking its not a simple explanation. Or maybe I'm just missing something obvious?&nbsp; Is there a smart client version of the PT app out there that someone has played around with ? </P><FONT color=#0000ff size=2>
<P>&nbsp;</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, June 21, 2006</h2><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>brettswift:</strong></div><div>In the book it says you're supposed to be able to switch from a local datasource to a remote datasource via the config file, (sounds great for a smart client) but when I look at the code samples in the book I don't see how this can be done.... 
<p>I have a method that&nbsp;I'm trying to convert from<br>1)&nbsp;a Local datasource where the Win Forms will connect with the database directly, and load up values in a TreeView control, <br>to....<br>2) loading them from my Web Service.</div></BLOCKQUOTE></p><p>Here is your first problem; your Winform app is trying to talk to the database directly.&nbsp; Your Winforms app should be communicating with a BO, which will handle the data access.&nbsp; Your data access code should only be in the DataPortal_XXX methods.</p>There's another problem as well; the DataPortal isn't meant to allow you to switch the type of datasource.&nbsp; So if you're BO uses SqlClient, it will always use SqlClient (the difference is that your BO's DataPortal code can run locally, which means the client computer will connect directly to the database OR on a remote server (such as one inside a firewall), which means that your BO will move from the client workstation to an IIS server, and the IIS server will connect to the database.<br><br>To allow a switch from SqlServer to a web service would be tricky; you would need some kind of data access layer which hides the specifics of communicating with your datastore.&nbsp; For example, I wrote a custom one, where each class represents a row from a table or view.&nbsp; I have Insert, Update, Delete and Load methods.&nbsp; I designed it in such a way that I can switch between Sql server or Oracle, and not have to change my business code at all.&nbsp; I admit though, a WebService provider could be difficult, but it may be something I could create for my DAL.<br><p></p><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>brettswift:</strong></div><div>1) dealing with AnimalInfo objects that are loaded into the AnimalList<br><p>2) if proxy classes are developed as in the PT sample app, I'd be dealing with AnimalData objects in an array. </p>
<p>So, question being - how do I write UI code so that it is independant of the Data Portal ?&nbsp; (2 parts)<br>a) How do I make this line:<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i)AnimalList aList = Animal.GetAnimalList();&nbsp; // from AnimalTracker.Library;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; compatible with this line:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii)AnimalData[] aList = svc.GetAnimalList(); // using web service reference.</div></BLOCKQUOTE></p><p>I'm assuming that Animial is a business object.&nbsp; GetAnimialList shouldl look something like this:</p><p>/// &lt;remarks&gt;EmptyCriteria inherits from CriteriaBase, and is a private class embedded in your AnimalList class&lt;/remarks&gt;<br></p><p>public static AnimalList GetAnimalList() {</p><p>&nbsp;&nbsp;&nbsp;&nbsp; return DataPortal.Fetch&lt;AnimalList&gt;( new EmptyCriteria() );</p><p>}</p><p>private void DataPortal_Fetch( EmptyCriteria crit ) {</p><p>// This is where your data access would go, and here's where you'd need to interface with a DAL of&nbsp; your choosing.</p><p>}</p><p>On more thing; GetAnimalList should be defined in your AnimialList class, not your Animal class.<br> </p>
<p><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>brettswift:</strong></div><div>Maybe - these ReadOnlyList bases (AnimalInfo) are ok to use instead of the proxy classes?</div></BLOCKQUOTE></p><p>AnimalInfo would likely just be a readonly object used for display purposes only.&nbsp; You'd likely have a seperate class Animal which would allow a single animal to be modified in your application.<br> </p>
<font color="#0000ff" size="2">
</font><p><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>brettswift:</strong></div><div>I'm obviously still new to this and hoping that someone can help me out here, because I'm thinking its not a simple explanation. Or maybe I'm just missing something obvious?&nbsp; Is there a smart client version of the PT app out there that someone has played around with ?</div></BLOCKQUOTE></p><p>Rocky built a smart client PT app already, it is in the same download as the PT sample.&nbsp; The project is called PTWin I believe... so if you have the PT sample, you should have both the web and win forms sample.&nbsp; <br></p><p>Do you happen to have a copy of the book?&nbsp; If not, I suggest you get one.&nbsp; Reading it has greatly helped me understand OOD better, and why its good to have distinct editable and readonly objects.. sometimes even more than 2 objects, depending on your use cases.</p><p>HTH</p><p>Andy<br></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brettswift replied on Wednesday, June 21, 2006</h2><P>Sorry Andy, I guess I whipped out that post a little too fast. </P>
<P>I wrote that code in this form so GetAnimalList() does actually come from the AnimalList&nbsp; BO. The client that is in the sample code from the download is called PTClientService and I have looked at it a little bit. </P>
<P>By my Win Forms contacting the DB directly, I really meant through the local data portal, so its accessing the Busines Objects directly, then the database.&nbsp;&nbsp;</P>
<P>Because you can't expose the BO's to the Web Service,&nbsp; there needs to be some kind of intermediate step, so that you can TRULY switch data portals (local and remote) at runtime without changing UI code. </P>
<P>Something like this: </P>
<P>SQL Servier<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V<BR>&nbsp;&nbsp; CSLA<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V<BR>&nbsp;&nbsp; &nbsp;Proxy Classes (that reference the BO library, and is referenced by the UI code, and can switch portals.)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; V<BR>&nbsp;Smart Client UI. </P>
<P>So - because of this proxy - we lose the BO features - such as IsValid, IsDirty, and other features that is used by WinForms to make the interface very interactive.&nbsp; </P>
<P>I guess we could have the UI cast / convert the proxy AnimalData class back into an Animal class - but then we'd have to do proxyClass.Save(animal); and proxy would convert that back to the AnimalData class (and could probably cast AnimalData to Animal when it grabs the AnimalData proxy class from the dataportal. </P>
<P>This is already getting ugly and confusing.. haha.&nbsp;&nbsp; </P>
<P>Surely there's got to be a way of doing&nbsp; animal.Save(); and have the DataPortal know to parse that and pass it through to the web service..&nbsp;&nbsp; When I was initially getting into CSLA - this is what I thought could be done, but I guess not. </P>
<P>I just found a .NET starter kit with an online/offline Smart Client.&nbsp; It looks like it doesn't switch to a local database but will grab objects (at the users request) and copy them locally - kind of like signing it out off the server, and when you go back online it will sync it up. </P>
<P>Maybe for a new CSLA guy this is a lot to chew!</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, June 21, 2006</h2><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>brettswift:</strong></div><div>I wrote that code in this form so GetAnimalList() does actually come from the AnimalList&nbsp; BO. The client that is in the sample code from the download is called PTClientService and I have looked at it a little bit.</div></BLOCKQUOTE><br><br>I see.&nbsp; I've been known to do that quite a bit as well.<br> 
<p><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>brettswift:</strong></div><div>By my Win Forms contacting the DB directly, I really meant through the local data portal, so its accessing the Busines Objects directly, then the database.&nbsp; </div></BLOCKQUOTE></p><p>Ok, so far, so good then.<br></p>
<p><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>brettswift:</strong></div><div>Because you can't expose the BO's to the Web Service,&nbsp; there needs to be some kind of intermediate step, so that you can TRULY switch data portals (local and remote) at runtime without changing UI code. </p>
<p>Something like this: </p>
<p>SQL Servier<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V<br>&nbsp;&nbsp; CSLA<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V<br>&nbsp;&nbsp; &nbsp;Proxy Classes (that reference the BO library, and is referenced by the UI code, and can switch portals.)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; V<br>&nbsp;Smart Client UI. </p>
<p>So - because of this proxy - we lose the BO features - such as IsValid, IsDirty, and other features that is used by WinForms to make the interface very interactive. </div></BLOCKQUOTE></p><p>I'm not sure I follow here; I would think your BOs would be distributed with the smart client application.&nbsp; Why do you want to put a web service between the UI and the Business layer (or am I misunderstanding again)?&nbsp; The only reason I could think of to do that is if you are not the one writing the UI... but then you would design a web service which uses your business layer, but the web service would be more of a facade layer.&nbsp; Anyone that creates a UI which interacts with your web service facade wouldn't have the rich experience that you could create if you tied directly to the BO.. but thats just the price paid for writing an application to a web service.<br> </p>I guess I'm just not following what it is you want.<br><p><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>brettswift:</strong></div><div>I just found a .NET starter kit with an online/offline Smart Client.&nbsp; It looks like it doesn't switch to a local database but will grab objects (at the users request) and copy them locally - kind of like signing it out off the server, and when you go back online it will sync it up.</div></BLOCKQUOTE></p><p>There's many ways to do the online / offline application.&nbsp; I would think that your BO would handle this in your data portal methods, by having some means of knowing the application is offline (if the user can specify online or offline, you will probably need a BO the UI can use to set the current state).&nbsp; Possibly this may even be taken care of by your DAL layer; at least that's the method I'm going to pursue when I need to make my application 'offlineable'.&nbsp; The DAL will determine if the master server is available or not, and hide this from my business / UI layers.&nbsp; How well it will work remains to be seen though. :-)</p><p>HTH</p><p>Andy<br></p><p></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brettswift replied on Wednesday, June 21, 2006</h2><P>Ok Andy, from what I'm getting from your post... create the facade later (which I've been calling proxy classes) and deal with those...&nbsp; </P>
<P>So, to answer my question from the post a minute ago, with web services or remoting, you can't interact with the BO's - you can only interact with the facade / proxy classes. </P>
<P>Am I right? </P>
<P>&nbsp;</P>
<P>If I am right, the whole notion of "UI not caring about the dataportal" is still mis-guided, and the root of all my confusion on this - because yes.. the UI does care in a web service environment because it has to deal with only the proxy / facade classes. </P>
<P>Am I right here?&nbsp; What does Rocky mean on page 579 of the C# 2005 book, in the last sentence of the 2nd paragraph at the top of the page: </P>
<P>"The most important thing to realize about the site configuration is that the data portal can be changed from local to remote (using any of the network channels) with no need to change any UI or business object code." </P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Vadiraja replied on Wednesday, April 23, 2008</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>brettswift:</strong></div><div>In the book it says you're supposed to be able to switch from a local datasource to a remote datasource via the config file, (sounds great for a smart client) but when I look at the code samples in the book I don't see how this can be done.... 
<P>I have a method that&nbsp;I'm trying to convert from<BR>1)&nbsp;a Local datasource where the Win Forms will connect with the database directly, and load up values in a TreeView control, <BR>to....<BR>2) loading them from my Web Service.</div></BLOCKQUOTE></P>
<P>Here is your first problem; your Winform app is trying to talk to the database directly.&nbsp; Your Winforms app should be communicating with a BO, which will handle the data access.&nbsp; Your data access code should only be in the DataPortal_XXX methods.</P>There's another problem as well; the DataPortal isn't meant to allow you to switch the type of datasource.&nbsp; So if you're BO uses SqlClient, it will always use SqlClient (the difference is that your BO's DataPortal code can run locally, which means the client computer will connect directly to the database OR on a remote server (such as one inside a firewall), which means that your BO will move from the client workstation to an IIS server, and the IIS server will connect to the database.<BR><BR>To allow a switch from SqlServer to a web service would be tricky; you would need some kind of data access layer which hides the specifics of communicating with your datastore.&nbsp; For example, I wrote a custom one, where each class represents a row from a table or view.&nbsp; I have Insert, Update, Delete and Load methods.&nbsp; I designed it in such a way that I can switch between Sql server or Oracle, and not have to change my business code at all.&nbsp; I admit though, a WebService provider could be difficult, but it may be something I could create for my DAL.<BR>
<P></P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>brettswift:</strong></div><div>1) dealing with AnimalInfo objects that are loaded into the AnimalList<BR>
<P>2) if proxy classes are developed as in the PT sample app, I'd be dealing with AnimalData objects in an array. </P>
<P>So, question being - how do I write UI code so that it is independant of the Data Portal ?&nbsp; (2 parts)<BR>a) How do I make this line:<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i)AnimalList aList = Animal.GetAnimalList();&nbsp; // from AnimalTracker.Library;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; compatible with this line:&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ii)AnimalData[] aList = svc.GetAnimalList(); // using web service reference.</div></BLOCKQUOTE></P>
<P>I'm assuming that Animial is a business object.&nbsp; GetAnimialList shouldl look something like this:</P>
<P>/// &lt;remarks&gt;EmptyCriteria inherits from CriteriaBase, and is a private class embedded in your AnimalList class&lt;/remarks&gt;<BR></P>
<P>public static AnimalList GetAnimalList() {</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp; return DataPortal.Fetch&lt;AnimalList&gt;( new EmptyCriteria() );</P>
<P>}</P>
<P>private void DataPortal_Fetch( EmptyCriteria crit ) {</P>
<P>// This is where your data access would go, and here's where you'd need to interface with a DAL of&nbsp; your choosing.</P>
<P>}</P>
<P>On more thing; GetAnimalList should be defined in your AnimialList class, not your Animal class.<BR></P>
<P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>brettswift:</strong></div><div>Maybe - these ReadOnlyList bases (AnimalInfo) are ok to use instead of the proxy classes?</div></BLOCKQUOTE></P>
<P>AnimalInfo would likely just be a readonly object used for display purposes only.&nbsp; You'd likely have a seperate class Animal which would allow a single animal to be modified in your application.<BR></P><FONT color=#0000ff size=2></FONT>
<P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>brettswift:</strong></div><div>I'm obviously still new to this and hoping that someone can help me out here, because I'm thinking its not a simple explanation. Or maybe I'm just missing something obvious?&nbsp; Is there a smart client version of the PT app out there that someone has played around with ?</div></BLOCKQUOTE></P>
<P>Rocky built a smart client PT app already, it is in the same download as the PT sample.&nbsp; The project is called PTWin I believe... so if you have the PT sample, you should have both the web and win forms sample.&nbsp; <BR></P>
<P>Do you happen to have a copy of the book?&nbsp; If not, I suggest you get one.&nbsp; Reading it has greatly helped me understand OOD better, and why its good to have distinct editable and readonly objects.. sometimes even more than 2 objects, depending on your use cases.</P>
<P>HTH</P>
<P>Andy<BR></P></div></BLOCKQUOTE></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DansDreams replied on Wednesday, June 21, 2006</h2><P>Brett, I'm not really seeing the problem either as I'd also suggest you shouldn't be trying to accomplish what you are.</P>
<P>Maybe if you gave some additional background... do you already have some pre-CSLA web services in place that provide data?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DansDreams replied on Wednesday, June 21, 2006</h2>The UI would never know or care whether remoting was used or not... that's a business layer option.&nbsp; I'm not getting on the same page as you.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brettswift replied on Wednesday, June 21, 2006</h2><P>Well I'm definately lost somewhere&nbsp; ... because I seem to be getting 2 conflicting answers.&nbsp; The book says create a proxy class and get the ProjectList by calling&nbsp; webservice.getProxyObject();&nbsp; From what I'm getting from this post is that the UI shouldn't care about the data portal. - Until I learn more from you guys, the UI DOES care, because in one instance it calls the web service directly and in the other it can use the BO's directly. <BR><BR>IE:&nbsp;&nbsp; WebService.GetProxyObject&nbsp;&nbsp;&nbsp;&nbsp; vs&nbsp;&nbsp; BOLibrary.GetCSLAObject();</P>
<P>those are 2 distinct UI calls.&nbsp; - I don't see the reasoning for saying the UI doesn't care about the data portal - because these are&nbsp;&nbsp;2 dataportals with their own specific UI code.&nbsp;&nbsp; </P>
<P>&nbsp;I guess I'm missing how this would all work then - maybe the sample code in the book confused me because its referencing the web service (which I don't see how this could work without - you say the UI shouldn't care, but if thats the case, why is Rocky creating these ProjectData proxy classes in his web service?&nbsp; My perspective is, say if I had a remote dataportal ona web service, and I wanted to one day change it to a local dataportal - supposedly what you're both telling me is that the UI code shouldn't care - so maybe explain how?&nbsp; Remote Web Service as a portal uses svc.getList.&nbsp; If I take the remote portal away and set it to a local data portal, svs.WebService will fail..&nbsp; this is where I'm really confused.). </P>
<P>My HorseTracker.Library IS distributed to the client, but if I my UI doesn't care about the portal, it should be able to make the following call right? </P>
<P>Animal animal = Animal.GetAnimal(id);</P>
<P>//change it</P>
<P>animal.Save();</P>
<P>? </P>
<P>&nbsp;&nbsp;From the book's sample code it seems like the only option is to create proxy classes...&nbsp;&nbsp; I'm lost here somewhere... maybe my understanding of "the UI doesn't care about the data portal" means something else than what I'm interpreting it as. </P>
<P>I guess I'm pretty new to this to make a lot of sense from the book.&nbsp;&nbsp; </P>
<P>Maybe the best way to make progress on this question is to ask - what would my UI code look like, for me to be able to go and one day 2 months from now change the Data Portal from a Local DataPortal to a Remote Portal using Web Services - without changing UI code&nbsp; ? </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, June 21, 2006</h2>Ok, I think the confusing is coming from the fact that the book tells you <br><br>1) How to create a web service (which fucntions as a UI layer, in a manner) to allow outside people to call services on your server which performs tasks.&nbsp; These tasks still need to follow business rules, so the web service uses your BOs to carry out the services offered.&nbsp; This has nothing to do with the data portal at all.&nbsp; The web service you build here will interact exactly like a Web or Win client would interact with your Business layer.&nbsp; This is a UI &lt;--&gt; Business layer communcation.<br><br>2) The data portal can use web services to access the dastabase, instead of using remoting or running locally.&nbsp; I can't speak as to why you'd use this data portal over remoting + IIS (haven't gotten that far in the book yet), but its just another transport to allow the Business layer to communicate with the Data layer..&nbsp; Data Portal is only used for Business layer &lt;----&gt; Data layer communciation.&nbsp; It specifies if the client talks to the db (the client being the WinForms, WebForms, or Web service UI ) or if it happens on a server (the BO 'leaves' the client and moves to another computer, where the data code runs.&nbsp; When the data code is done running, the BO 'leaves' that other computer and goes back to the client).<br><br>To answer your last question, you have to realize that you're only changing how the business layer and the data layer communicate.&nbsp;&nbsp; So if you want data access code to run on a server instead of a client, you just change the .config file for your application (Web.Config for a Web Service&nbsp; or WebForms app, App.config for a WinForms app).&nbsp; Your code does not change at all; the only change is that your BO will physically leave the client and move to the server to execute dataportal_XX methods.&nbsp; Does that clear things up at all?&nbsp; You only create a proxy class if you are doing #1... exposing services which need to follow rules to the internet.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brettswift replied on Wednesday, June 21, 2006</h2><P>Ok, thanks Andy.&nbsp; </P>
<P>I think this setup is clear now, and what I was hoping to be able to do would require another&nbsp; BO&lt;--&gt;UI&nbsp; Data Portal type scenario, maybe call it a UI portal or something...which I have no idea how you'd create in order to get your BO's across the internet. </P>
<P>I live in oil country, so I'm thinking along the lines of a possible remote disconnected smart client application.&nbsp; Say an engineer takes his laptop out to well sites, uses a win forms client, in a disconnected setting to enter data on each well.&nbsp; He then goes back to the office, plugs in, and via web services syncs up the data with the main server in another city.&nbsp; I was thinking of having SQL Express on the laptop (or SQL Everywhere) that would replicate via some web service calls to the main server.&nbsp;&nbsp; The reason I wanted to figure out this post was that I wanted the database to be able to be copied onto the laptop, and when not connected to the internet, change to a local connection and manipulate data&nbsp; without the win forms UI really acting too differently, except for not being able to pull new data off the server.&nbsp;&nbsp; </P>
<P>&nbsp;</P>
<P>Ambitious thought I guess.&nbsp; For now I will continue my AnimalTracker using web services as the UI layer, and a WinForms&nbsp; click once deployment as my presentation Layer. </P>
<P>Phew!&nbsp;&nbsp; I think I must have injected some Red Bull into my veins today! </P>
<P>Thanks guys, that was a confusing post for you to understand given what I thought might have been possible with the existing framework.&nbsp; If anyone is interested in developing a management utility that could get the BO's across the internet in a secure fashion - I'd be interested in helping out.&nbsp;&nbsp; Maybe this will be a future addition to the framework so we can have a smart client as rich in features as a local Win Forms client! </P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, June 21, 2006</h2>Glad to help get things clearer.<br><br>Disconnecting doesn't mean you need to use web services at all.&nbsp; You could have the app connect to a local database, and use straight replication to managed syncing of data.&nbsp; If you do have the Sql server sync to another sql server, you can have them do so over web services, but again this wouldn't affect yoru application at all; you could also roll your own data syncing routine, but again, I think that would be seperate from yoru application and may not even use your busniess layer.<br><br>As far as your AnimalTracker application, if you're going to use ClickOnce to deploy the software, I'm not really sure if you need to include web services at all; your business layer assembly could be distributed with the UI application.&nbsp; Just to clearify, a web service isn't a UI layer at all... I simply meant that it would act as a UI layer in that it would consume your BOs the same way your Win application would.&nbsp; Sorry if I added in some confusion by doing that.&nbsp; At any rate, if you do decide to have your Win app talk to a web service which talks to your BOs on the UI's behalf, you can go that route, but as you noted you'll lose all the neat databinding and IsDirty IsNew stuff.<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brettswift replied on Wednesday, June 21, 2006</h2><P>Ok, well one more question then.&nbsp; If I deploy using ClickOnce, and deploy the BO assembly (HorseTracker.Library), I still need some way of communicating over the internet (to the database on my machine)&nbsp;OR deploying a full database for a fully disconnected environment. </P>
<P>And - if I'm using my Smart Client distributed with Click Once - over the internet - there is no need to have the HorseTracker.Library referenced on the Smart Client, because it will only be using the facade layer anyway... (given it will never be run offline to a local database). </P>
<P>Still on the same page? </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, June 21, 2006</h2><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>brettswift:</strong></div><div>Ok, well one more question then.&nbsp; If I deploy using ClickOnce, and deploy the BO assembly (HorseTracker.Library), I still need some way of communicating over the internet (to the database on my machine)&nbsp;OR deploying a full database for a fully disconnected environment.</div></BLOCKQUOTE><br><br>Correct, you'll need to have the app talk to the database over the internet (directly or indirectly) OR you will have to go with some kind of disconnected mode.<br><br>I doubt you want to open port 1433 for sql server to the internet, so this is where the Remote data portal or web services data portal will come in handy.&nbsp; Here's a pretty secure setup...<br><br>The client, which includes your UI and your business layer, updates deployed via ClickOnce.&nbsp; The configuration file specifies to use remoting to an IIS server.<br><br>Your web servicer, which is acting as an application host.&nbsp; This server is likely on a DMZ and only has port 80 open (assuming you're remoting host is IIS). <br><br>Your database server, which is behind the firewall.&nbsp; The web server can reach the database through the firewall through port 1433.&nbsp; <br><br>When your BO needs to save, it moves itself (the data portal actually does this, but its hidden from your objects) from the client to the web server.&nbsp; Code in the DataPortal_XXX routines run on the webserver, and can access the database server.&nbsp; Once the data code is done running, the newly updated BO moves back to the client, and your code picks up there.<br> 

<p><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>brettswift:</strong></div><div>And - if I'm using my Smart Client distributed with Click Once - over the internet - there is no need to have the HorseTracker.Library referenced on the Smart Client, because it will only be using the facade layer anyway... (given it will never be run offline to a local database).</div></BLOCKQUOTE></p><p>I would think you need the HorseTracker.Library, since your UI would be directly consuming your business layer; I don't see a need for a facade layer or web services with anything you've wanted to do so far.&nbsp; Everything I've said so far assumes an Online only mode application.</p>If you go the disconnected route, you'll likely use the Local data portal, which talks to a local database.&nbsp; I would probably say it should ONLY talk to the local database, and when the client computer is back on the corp. network, the databases can sync. <br><br>From what you've described, I wouldn't try to do both options though.&nbsp; Unless you have clients which are never in the office and usually have an internet connection, but MUST be able to live without an internet connection... but that is pretty complicated setup.<br><br>HTH<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>brettswift replied on Wednesday, June 21, 2006</h2>Okey dokey this is sinking in now.&nbsp; (I think). <br><br>Ok, so I think this is what I was getting at originally.&nbsp;&nbsp; I sorta understood that the Data Portal moved objects from client to server. (or handled them locally).&nbsp; Hence the [RunLocal] attribute you can put on DataPortal_Create()&nbsp; methods.&nbsp; <br><br>The setup you just suggested, using a Remoting as the host to the Server Portal, can pass BO's across the internet, to which Web Services can't - because with web service calls you'd be needing a method call essentially, external to the BO. <br><br>I would think this to be not as secure as using a Web Service with WSE's to encrypt data going across, because with a Remoting server, data is transfered in plain text no ? <br><br>Ok, I'm on track here I think. <br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cmellon replied on Thursday, June 22, 2006</h2><P>Hi Brett,</P>
<P>The remoting server can be as secure as you can make any website if its hosted in IIS.&nbsp; For example you could run the dataportal using remoting and then set your IIS to use SSL, which means all data will be encrypted.</P>
<P>Basically by hosting the remoting server in IIS you get the full functionality of IIS at your disposal, same as you would a webservice.</P>
<P>I'm not too up on WSE so not sure what advantages WSE gives you, but if you looking to just encrypt the data between you client and server, I would opt for SSL.&nbsp; You don;t need to change anything in your code just enable SSL on your server.</P>
<P>Hope this helps</P>
<P>Craig</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, June 22, 2006</h2>Craig is correct; you should be able to use SSL and remoting together.<br><br>I believe the objects serialize to binary however, so its not plain text, but it could still be easily reconstructed by a 3rd party (especially if they can get the business library).<br><br>Now, not to add more confusion when we've got things clear, but you CAN use the web service data portal to transfer your BO from client to server and back again.&nbsp; But functionally it makes no difference, its doing the exact same thing as remoting would...which is simply serializing your BO, sending it across the wire, and the server deserializes it and runs the DataPortal_XX code.&nbsp; (And the server reverses this to send the modified BO back to the client).&nbsp; <br><br>So think of the DataPoratl as something whcih just moves the BO back and forth; the remoting BO uses one technology to do this, the web services uses another.&nbsp; When WCF comes out, there will be a data portal for that as well... but its purpose is the same... just a way to move BOs across the wire.<br><br>HTH<br>Andy<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
