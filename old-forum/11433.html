<html><header><title>BusinessListBase Batch Insert or AddRange solution</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>BusinessListBase Batch Insert or AddRange solution</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11433.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>j0552 posted on Tuesday, June 26, 2012</h2><p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><a name="_MailAutoSig"><span style="font-size:small;"><span style="font-family:Calibri;">Hi</span></span></a></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span><span style="font-family:Calibri;font-size:small;">&nbsp;</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span>I have a </span>BLB with <span style="mso-spacerun:yes;">&nbsp;</span>AddRange and RemoveRange methods, e.g.</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>public void AddRange(IEnumerable&lt;int&gt; range)</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>var rlce = RaiseListChangedEvents;</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RaiseListChangedEvents = false;</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (range != null)</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>foreach (var id in range)</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Add(id);</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RaiseListChangedEvents = rlce;</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>public void Add(int id)</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if (!Contains(id))</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;</span><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>var account = AccountCreator.GetCreator(id).Result;</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Add(account);</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;"><span style="mso-spacerun:yes;">&nbsp;&nbsp; </span><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>}</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">The method is called from an MVC controller action. The problem is the range parameter could contain a few thousand ids which makes it very slow with the current implementation. Is there a way to suppress all events, rules during the inserts. I&#39;d want to raise a single list change event at the end of the batch.</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Setting RaiseListChangedEvents to false in the AddRange method doesn&rsquo;t seem to have any effect.</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">What are my options to improve performance? </span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-family:Calibri;font-size:small;">&nbsp;</span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Thank you</span></span></p>
<p class="MsoPlainText" style="margin:0cm 0cm 0pt;"><span style="font-size:small;"><span style="font-family:Calibri;">Andrew</span></span></p>
<p>&nbsp;</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
