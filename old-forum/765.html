<html><header><title>Generics &amp; Polymorphism</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Generics &amp; Polymorphism</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/765.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>cash_pat posted on Monday, July 31, 2006</h2>I am currently in the state of porting my 1.53 code to 2.03. there are are over a 500 places where lookups are used (very similar) with the same code. In 1.53 I used the following technique<br><br>SetLookupProperties(lkpSuppliers, STR_LedgerID, STR_LedgerName, mSupplierList)
<br><div>SetLookupProperties(lkpStockName, STR_StockNameID, STR_StockName, mStockNames)<br>SetLookupProperties(lkpColour, STR_ColourID, STR_ColourName, mColours)<br>SetLookupProperties
(lkpVAT, STR_LedgerID, STR_LedgerName, mSaleRates)<br><br>This 1st parameter is the lookupcontrol.<br>The 2nd parameter is the ID Column<br>The 3rd Parameter is the Display Column<br>The 4th Parameter is the BO</div><br>The SetLookupProprities then created appropriate columns, set some common proprities, and associated it with the datasource. But now with the case of generics I am unable to do so. <br><br>Do i have to use the same code to initialize all my lookups around 40 lines at 500 places. Can I do it without losing the power of generics and performance<br><br>regards<br><br>cash_pat<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, July 31, 2006</h2><P>You are stuck in&nbsp;a hard place.</P>
<P>The reason you could do that in 1.53 was because the types of the name/value pairs were constant.</P>
<P>The reason you can't do it in 2.0 is because the types of the name/value pairs are not constant - thanks to generics.</P>
<P>So NameValueListBase is more flexible, but less flexible, all at once...</P>
<P>What you might want to do is create your own non-generic NameValueListBase and then derive your actual NVL objects from your single-typed base. You can do this by inheriting from NVLB:</P>
<P>&lt;Serializable()&gt; _<BR>Public Class MyNewBase<BR>&nbsp; Inherits Csla.NameValueListBase(Of String, String)<BR>End Class</P>
<P>&lt;Serializable()&gt; _<BR>Public Class MyActualList<BR>&nbsp; Inherits MyNewBase<BR><BR>&nbsp; ' implement factory and DP_Fetch<BR>End Class</P>
<P>This creates a strongly typed base class where the types are actually known. Of course this means you give up the type flexibility of the generic base, but you gain polymorphic behavior at the MyNewBase level.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
