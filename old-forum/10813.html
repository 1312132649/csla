<html><header><title>Subclassed PropertyInfo, Custom PropertyInfoFactory, and RegisterProperty using Lambda</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Subclassed PropertyInfo, Custom PropertyInfoFactory, and RegisterProperty using Lambda</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10813.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>comp1mp posted on Wednesday, October 26, 2011</h2><p>Hello,</p>
<p>I have implemented&nbsp; MyPropertyInfo&lt;T&gt; derived from PropertyInfo&lt;T&gt;&nbsp;and a custom PropertyInfoFactory which returns my derived type.</p>
<p>My BO declaration however uses the lambda RegisterProperty overload and is declared as PropertyInfo&lt;T&gt;, not my subclassed type</p>
<p><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">private</span></span><span style="font-size:x-small;"> </span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">static</span></span><span style="font-size:x-small;"> </span><span style="color:#2b91af;font-size:x-small;"><span style="color:#2b91af;font-size:x-small;">PropertyInfo</span></span><span style="font-size:x-small;">&lt;</span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">T</span></span><span style="font-size:x-small;">&gt; LastNameProperty = RegisterProperty&lt;</span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">T</span></span><span style="font-size:x-small;">&gt;(c =&gt; c.Property);</span></p>
<p>This is consistent with the suggestion of Jonny Bekkum in the following post <a href="http://forums.lhotka.net/forums/p/10258/48079.aspx#48079">http://forums.lhotka.net/forums/p/10258/48079.aspx#48079</a></p>
<p>I have run across a few older posts by Rocky about extending PropertyInfo&lt;T&gt; without using a custom PropertyInfoFactory (??? not sure if Rocky is just omitting the need for the factory)&nbsp;<a href="http://forums.lhotka.net/forums/p/5455/26533.aspx#26533">http://forums.lhotka.net/forums/p/5455/26533.aspx#26533</a>.</p>
<p>Here is his sample declaration</p>
<p>private static MyPropertyInfo&lt;string&gt; = <br />&nbsp; RegisterProperty(new MyPropertyInfo&lt;string&gt;(...));</p>
<p>He uses an older overload for register property, but notice that he is declaring his derived type instead of PropertyInfo&lt;T&gt;.</p>
<p>Two&nbsp;questions:
<p>1. Even though my current implementation &#39;works&#39;,&nbsp;is there a compelling reason to declare using my derived class instead of the base PropertyInfo&lt;T&gt;?</p>
<p>I can do this but have to cast:</p>
<p><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">private</span></span><span style="font-size:x-small;"> </span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">static</span></span><span style="font-size:x-small;"> <span style="color:#2b91af;">My</span></span><span style="font-size:x-small;"><span style="color:#2b91af;font-size:x-small;">PropertyInfo</span></span><span style="font-size:x-small;">&lt;<span style="color:#0000ff;">T</span></span><span style="font-size:x-small;">&gt; LastNameProperty = (<span style="color:#2b91af;">My<span style="font-size:x-small;"><span style="font-size:x-small;">PropertyInfo</span></span></span><span style="font-size:x-small;">&lt;<span style="color:#0000ff;">T</span></span><span style="font-size:x-small;">&gt;</span>)</span><span style="font-size:x-small;">RegisterProperty&lt;<span style="color:#0000ff;">T</span></span><span style="font-size:x-small;">&gt;(c =&gt; c.Property);</span></p>
<p>2. I have the following key in my app.config, but when the first property attempts to initialize the Factory is null.&nbsp;Do I need more info in the value attribute?&nbsp;</p>
<p><span style="color:#a31515;font-size:x-small;"><span style="color:#a31515;font-size:x-small;">add</span></span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;"> </span></span><span style="color:#ff0000;font-size:x-small;"><span style="color:#ff0000;font-size:x-small;">key</span></span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">=</span></span><span style="font-size:x-small;">&quot;</span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">CslaPropertyInfoFactory</span></span><span style="font-size:x-small;">&quot;</span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;"> </span></span><span style="color:#ff0000;font-size:x-small;"><span style="color:#ff0000;font-size:x-small;">value</span></span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">=</span></span><span style="font-size:x-small;">&quot;</span><span style="color:#0000ff;font-size:x-small;"><span style="color:#0000ff;font-size:x-small;">OrionCsla.PropertyInfoFactory</span></span><span style="font-size:x-small;">&quot;</span></p>
<p>Thanks,</p>
<p>Matthew</p>
</p>
<div></div></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Wednesday, October 26, 2011</h2><p>1. You only need to do this if you need direct access to the added properties in PropertyInfo. <br />&nbsp;&nbsp;&nbsp;&nbsp; Else your code will only see the base properties from PropertyInfo base class.</p>
<p>2. Yes, when the first call to RegisterProperty is called your will hit</p>
<pre style="font-family:Consolas;font-size:13px;color:black;background:none repeat scroll 0% 0% #fafafa;">Csla.Core.FieldManager.<span style="color:#2b91af;">PropertyInfoFactory</span>.Factory which will check the CslaPropertyInfoFactory <br />and create a common instance of that object</pre></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>comp1mp replied on Wednesday, October 26, 2011</h2><p>I also implemented an interface IMyPropertyInfo which exposes all of the properties in MyPropertyInfo&lt;T&gt;. This should allow me to acces the extended properties if necessary from the base PropertyInfo&lt;T&gt;.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
