<html><header><title>OT: Configuration</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>OT: Configuration</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5908.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Monday, December 01, 2008</h2>Hi,<br><br>I've been addressing a need I have for configuration for some time by having my own custom code that redirects to different sections in the configuration file.&nbsp; What I want is basically multiple addSetting sections, and a way to switch between them with a simple change to the configuration file.&nbsp; So I'll have something like this:<br><br>&nbsp;&nbsp;&nbsp; &lt;configSections&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;section name="UnitTest" type="MyCompany.Configuration.MedSettingsSectionHandler,MyCore" /&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &lt;section name="devel" type="MyCompany.Configuration.MedSettingsSectionHandler,MyCore" /&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;/configSections&gt;<br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; &lt;appSettings&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;add key="Environment" value="UnitTest" /&gt;<br>&nbsp;&nbsp;&nbsp; &lt;/appSettings&gt;<br><br>&nbsp;&nbsp;&nbsp; &lt;UnitTest&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;!-- unit test settings here --&gt;<br>&nbsp;&nbsp;&nbsp; &lt;/UnitTest&gt;<br>&nbsp;&nbsp;&nbsp; &lt;devel&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;!-- local machine development settings here --&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;/devel&gt;<br><br>The Configuration Application Block in EntLib was replaced by System.Configuration in .Net 2... but I haven't figured out how to get similar functionality with it.<br><br>Any ideas?<br>Thanks<br>andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Monday, December 01, 2008</h2><P>Andy,</P>
<P>There are plenty of articles out there that should get you started.&nbsp; But, in a nutshell, you should find it very easy to switch from the App Block to Sys.Config.&nbsp; To start with, you'll need to create a new class that inherits from System.Configuration.ConfigurationSection, as follows:</P>
<P><CODE>public sealed class MySection : System.Configuration.ConfigurationSection<BR>{<BR>&nbsp; &nbsp; private static System.Configuration.ConfigurationProperty _myProperty;<BR>&nbsp;<BR>&nbsp; &nbsp; public MySection() : base()<BR>&nbsp; &nbsp; {<BR>&nbsp; &nbsp; &nbsp; &nbsp; _myProperty = new System.Configuration.ConfigurationProperty(<BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;"myProperty",<BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; &nbsp; typeof(MyPropertySettings),<BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; null,<BR>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; System.Configuration.ConfigurationPropertyOptions.None);<BR>&nbsp;<BR>&nbsp; &nbsp; &nbsp; &nbsp; Properties.Add(_myProperty);<BR> &nbsp; &nbsp; }<BR>&nbsp;<BR>&nbsp; &nbsp; [System.Configuration.ConfigurationProperty("enabled", DefaultValue = "false")]<BR>&nbsp; &nbsp; public System.Boolean Enabled<BR>&nbsp; &nbsp; {<BR>&nbsp; &nbsp; &nbsp; &nbsp; get { return (System.Boolean)base["enabled"]; }<BR>&nbsp; &nbsp; &nbsp; &nbsp; set { base["enabled"] = value; }<BR>&nbsp; &nbsp; }<BR>&nbsp;<BR>&nbsp; &nbsp; [System.Configuration.ConfigurationProperty("myProperty")]<BR>&nbsp; &nbsp; public MyPropertySettings MyProperty<BR>&nbsp; &nbsp; {<BR>&nbsp; &nbsp; &nbsp; &nbsp; get { return base["myProperty"] as MyPropertySettings; }<BR>&nbsp; &nbsp; &nbsp; &nbsp; set { base["myProperty"] = value; }<BR>&nbsp; &nbsp; }<BR>}</CODE></P>
<P>This is a simple example of a section with a single attribute and one child element.&nbsp; It would appear in the config file as:</P>
<P><CODE>&lt;configSections&gt;<BR>&nbsp;&nbsp;&nbsp; &lt;section name="mySection" type="MySection" /&gt;<BR>&lt;/configSections&gt;<BR><BR></CODE><CODE>&lt;mySection enabled="[true|false]"&gt;<BR>&nbsp; &nbsp; &lt;myProperty ...&gt;<BR>&lt;/mySection&gt;</CODE></P>
<P>To create the inner element, you'd follow the same pattern except inherit from ConfigurationElement.</P>
<P>Hope that gets you started in the right direction!</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, December 01, 2008</h2>Pirate, thanks, that is something I'll look into, although I was hoping what I wanted was more baked in already.&nbsp; My goal in posting this was to be able to get rid of more custom code I've written, much like I got rid of my custom DAL in favor of L2S.&nbsp; <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
