<html><header><title>Validation rule that is dependent on two objects?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Validation rule that is dependent on two objects?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7616.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>reagan123 posted on Sunday, September 13, 2009</h2>Hello.<br><br>I've been thinking about this for a bit today and am stumped.&nbsp; Lets say I have the following two parent child objects.&nbsp; <br><br>ObjectA<br>&nbsp;&nbsp; ObjectAChildCollection<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ObjectAChild<br><br>ObjectB<br>&nbsp;&nbsp;&nbsp; ObjectBChildCollection<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ObjectBChild<br><br>I have a rule that a value in the ObjectBChild cannot be greater than a value in the ObjectAChild.&nbsp; How would my validation rule look in this situation and which class would it be in?&nbsp; Any help greatly appreciated.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong replied on Sunday, September 13, 2009</h2>Lets say the name of the root object containing both childs is ObjectAB, u must have a root object for both collections, but then u won't need a ObjectA and ObjectB, only the collections as child of the root object.<br /><br />ObjectAB<br />  ObjectA<br />    ObjectAChildCollection<br />      ObjectAChild<br />  ObjectB<br />    ObjectBChildCollection<br />      ObjectBChild<br /><br />I would impliment a interface like IContainObjectA in ObjectAB which supply a ObjectAChildByName() property or something simular.<br /><br />In the validation i then would do something like:<br />currentitem = this;<br />repeat<br />  currentitemparent = currentitem.parent<br />  currentitem = currentitemparent;<br /> until typeof(IContainObjectA).IsAssignableFrom(currentitem)<br /><br />ofcourse this is just an idea on how i would start.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tmg4340 replied on Sunday, September 13, 2009</h2><P><FONT size=2 face=Tahoma>Well... the first thing that comes to mind is that when ObjectB is created, it's passed a reference to ObjectA.&nbsp; Then ObjectBChild can use the ObjectA reference (via the Parent property) to get down to the appropriate ObjectAChild object.&nbsp; Or, if you can determine the correct ObjectAChild for the ObjectBChild instance at creation time, you could set a reference property on ObjectBChild at that point, saving you the navigation-property-chain calls&nbsp;each time your validation rule runs.&nbsp; That also loosens the coupling between ObjectA and ObjectB.&nbsp; It depends on how the rule is constructed - is it a one-to-one mapping of A to B, or is it "the value in B can't be greater than any value A?"</FONT></P>
<P><FONT size=2 face=Tahoma>And in case you couldn't tell, I believe your validation rule belongs in ObjectBChild.&nbsp; The way you've expressed your rule, ObjectBChild has the dependency on ObjectAChild.</FONT></P>
<P><FONT size=2 face=Tahoma>HTH</FONT></P>
<P><FONT size=2 face=Tahoma>- Scott</FONT></P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
