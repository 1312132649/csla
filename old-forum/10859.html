<html><header><title>Recommendations For Password Hashing</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Recommendations For Password Hashing</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10859.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>MadGerbil posted on Wednesday, November 09, 2011</h2><p>I&#39;ve a user object with a password field.</p>
<p>The site will be hosted in an SSL and while it would be rather trival to hash&nbsp; the password server side in the Insert/Update region it occurs to me that it may make sense to hash it client side before sending it over the wire.&nbsp;&nbsp; This would happen on the creation of a new user or the update of a user.</p>
<p>I suppose I could place the hashing code inside the property set but I&#39;ve read cautionary notes about doing that since, I guess, binding can sometimes bypass the official set and do a loadproperty instead - I&#39;m foggy on that, I just have the sense that it&#39;s a bad idea.</p>
<p>The next possible location would be a business rule but I wonder about the UI impact when a value is hashed and goes from 8 characters in length to 200 characters in length - I don&#39;t think people want to see the password box value change (even if it goes from 8 dots to 200 dots) when they tab off the box.</p>
<p>So it seems like a good idea to hash the password before sending over the wire, even with SSL, but I&#39;m not sure where this should occur.&nbsp; Any recommendations?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Peran replied on Wednesday, November 09, 2011</h2><p>I would be cautious about allowing your hashing&nbsp;algorithm&nbsp;code on the client side as it can be decompiled and is useful information to an attacker.</p>
<p>For passwords you should probably be using a one way salted hash, so placing the code in a property would be useless, because in your getter it would be impossible to convert the hash back into the clear text password.</p>
<p>I would leave SSL to encrypt over the wire, and do your salt creation &amp; hashing on the server.</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Peran</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, November 09, 2011</h2><p>There is the SecureString type that can be used to store values in memory so they are hard to acquire. But you still need to send the value over the wire to the server.</p>
<p>If you are using SSL though, I am not sure why you feel the need to encrypt the value before allowing SSL to encrypt it too?</p>
<p>In any case, Peran is right - encrypting things on the client is challenging, because the key is, by definition, also on the client, so it can&#39;t be made secure without low-level hardware support.</p>
<p>Windows itself relies on such low-level hardware support (starting with Vista at least) to switch into that admin mode you see when installing software or manipulating client-side certificates/keys. I don&#39;t know if you can tap into that yourself or not though.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>StefanCop replied on Wednesday, November 09, 2011</h2><p>That depends on what are your risks, where you expect volunerable and protected places. I hope you don&#39;t have very strong security requirements, because ordinary software engineers like myself will always leave or introduce leaks.</p>
<p>Password hashing on the server can be used to store it in a way that the plain pwd only can be guessed.</p>
<p>
If you do the hash on the client side without some salt (i.e. a 
challange from server), the hashed password would always be the same, 
and an attacker could replay the hash (man in the middle attack). </p>
<p>My understanding of SSL is a secure, session-specific channel (handshake protocol is public key, session is AES). So for protecting the password on the wire, SSL is a good solution. </p>
<p>Hw to protect a password on the client side? Very difficult. If possible keep the password only in local variables (on the stack) until it&#39;s sent over the SSL wire. You could receive a token or the server remembers this session is authenticated.</p>
<p> If you need to protect values locally for the time of a session, the you can get a random key and use a symmetrical crypto algo,&nbsp; i.e. AES/<i>Rijndael,</i> DES3 (but where to hide the random key...). I&#39;ve seen a <a href="http://msdn.microsoft.com/en-us/library/system.security.securestring.aspx">SecureString</a>, which is basically doing that.<br />Commonly used Hashes are SHA-1, MD5, usually combined with RSA.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
