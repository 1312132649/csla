<html><header><title>Removing child objects from a grid (GridEx)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Removing child objects from a grid (GridEx)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/346.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Skinny posted on Monday, June 12, 2006</h2><P>Hi All,</P>
<P>After trying to find the cause myself, I decided to post my problem here. I'm using Janus GridEx in combination with&nbsp;a simple (for test purposes) custom collection based on the BusinessListBase. This collection is called "MyOrderLines"&nbsp; and contains "MyOrderLine" objects.</P>
<P>Adding, removing (and setting properties) child items from code works fine, but as soon as I try to use this collection as a DataSource for my grid an exception is thrown when I try to cancel out of adding a new line to the collection:</P>
<P><FONT face="Courier New">"Index must be non-negative and smaller then the size of the collection"</FONT></P>
<P>I traced the exception down to the following line in the "OnPropertyChanged" method of BindableBase:</P><FONT size=2>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>if</FONT><FONT size=2> (nonSerializableHandlers != </FONT><FONT color=#0000ff size=2>null</FONT></FONT><FONT size=2><FONT face="Courier New">)<BR></FONT></FONT><FONT size=2><FONT face="Courier New">nonSerializableHandlers.Invoke(</FONT></FONT><FONT face="Courier New" color=#0000ff size=2>this</FONT><FONT size=2><FONT face="Courier New">,<BR></FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>new</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>PropertyChangedEventArgs</FONT><FONT size=2>(propertyName));</FONT></FONT></P>
<P><FONT face="Courier New"><FONT size=2><FONT face="Times New Roman">If I try to step in to this function, a couple of "Equal" calls are fired for every child object, but after that the </FONT></FONT></FONT><FONT face="Courier New"><FONT size=2><FONT face="Times New Roman">exception is thrown. Below is the definition of my Child object. </FONT></FONT></FONT></P>
<P><FONT size=2>When using the standard Microsoft DataGridView, everything seems to work fine, so it must have something to do with the order of events that the GridEx is firing, but I'm currently unable to determine the exact cause.</FONT></P>
<P><FONT size=2>Hopefully someone can give me a hint about where to look further, but for now I'm out of debugging options.</FONT></P>
<P><FONT size=2>Regards,<BR></FONT><FONT size=2>Mark</FONT></P>
<P><FONT size=2>-------------------------</FONT></P><FONT face="Courier New"><FONT size=2><FONT face="Times New Roman"><FONT size=2>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>class</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>MyOrderLine</FONT><FONT size=2> : BusinessBase&lt;MyOrderLine&gt;<BR>{</FONT></FONT><FONT size=2></P>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>static</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2><FONT face="Courier New"> _lastID = 0;<BR></FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2><FONT face="Courier New"> _lineID = -1;<BR></FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2><FONT face="Courier New"> _productID = 0;</FONT></P>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>override</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2><FONT face="Courier New"> GetHashCode()<BR></FONT><FONT face="Courier New">{<BR>&nbsp; </FONT></FONT><FONT face="Courier New" color=#0000ff size=2>return</FONT><FONT size=2><FONT face="Courier New"> _lineID.GetHashCode();<BR></FONT><FONT face="Courier New">}</FONT></P>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>override</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2><FONT face="Courier New"> GetIdValue()<BR></FONT><FONT face="Courier New">{<BR></FONT></FONT><FONT face="Courier New" color=#0000ff size=2>&nbsp; return</FONT><FONT size=2><FONT face="Courier New"> _lineID;<BR></FONT><FONT face="Courier New">}</FONT></P>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff><FONT size=2>public</FONT><FONT size=2> </FONT><FONT size=2>int</FONT></FONT></FONT><FONT size=2><FONT face="Courier New"> LineID<BR>{<BR></FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2><FONT color=#000000>&nbsp; </FONT>get</FONT><FONT size=2> { </FONT><FONT color=#0000ff size=2>return</FONT></FONT><FONT size=2><FONT face="Courier New"> _lineID; }<BR>}</FONT></FONT><FONT size=2></P>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2><FONT face="Courier New"> ProductID<BR></FONT></FONT><FONT size=2><FONT face="Courier New">{<BR></FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>&nbsp; get</FONT><FONT size=2> { </FONT><FONT color=#0000ff size=2>return</FONT></FONT><FONT size=2><FONT face="Courier New"> _productID; }<BR></FONT></FONT><FONT color=#0000ff size=2><FONT face="Courier New">&nbsp; set<BR></FONT></FONT><FONT size=2><FONT face="Courier New">&nbsp; {<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>if</FONT><FONT size=2> (_productID != </FONT><FONT color=#0000ff size=2>value)<BR>&nbsp;&nbsp;&nbsp; {&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT></FONT><FONT size=2><FONT face="Courier New">_productID = </FONT></FONT><FONT face="Courier New" color=#0000ff size=2>value</FONT><FONT size=2><FONT face="Courier New">;<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PropertyHasChanged(</FONT></FONT><FONT face="Courier New" color=#800000 size=2>"ProductID"</FONT><FONT size=2><FONT face="Courier New">);<BR>&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;}<BR>}</FONT></FONT></P>
<P><FONT face="Courier New"><FONT color=#0000ff size=2>internal</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>static</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>MyOrderLine</FONT></FONT><FONT size=2><FONT face="Courier New"> NewOrderLine()<BR>{<BR>&nbsp; </FONT></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>MyOrderLine</FONT></FONT><FONT size=2><FONT face="Courier New">();<BR>}</FONT></P>
<P></FONT><FONT face="Courier New" color=#0000ff size=2>private</FONT><FONT size=2><FONT face="Courier New"> MyOrderLine()<BR>{<BR>&nbsp; </FONT></FONT><FONT size=2><FONT face="Courier New">_lineID = _lastID - 1;<BR>&nbsp; </FONT><FONT face="Courier New">_lastID = _lineID;<BR>&nbsp;&nbsp;</FONT><FONT face="Courier New">MarkAsChild();<BR></FONT><FONT face="Courier New">}</FONT></P>
<P><FONT face="Courier New">}</FONT></P></FONT></FONT></FONT></FONT>
<P><FONT face="Courier New"><FONT size=2>&nbsp;</P></FONT></FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
