<html><header><title>WinForm Binding Issue and Issue with Slowness during Apply and Cancel Edit</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>WinForm Binding Issue and Issue with Slowness during Apply and Cancel Edit</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4564.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>KickTheSky posted on Wednesday, March 26, 2008</h2>I am having two issues.<br><br>The first one involves binding to WinForms.&nbsp; When I bind my fields there are times where the last changed field never gets updated in binding when the save button is clicked.&nbsp; Is there any way to force binding to update the business object before the save?&nbsp; For example, the last field on the form is a phone number field, if you enter the data into that field and don't tab out of it, it does not update the binding when you hit the save button.<br><br>Along with that issue, is it possible to update binding on change rather than on lost focus?&nbsp; Is it something that will slow down my app?<br><br>The second issue has to do with speed of apply and cancel edits.&nbsp; It seems that the speed of which these are occuring is taking more than 5 seconds at time for a simple object with only one child object.&nbsp; The object I am representing is an Organization and an Organization has an Address.&nbsp; The Address is stored in a different component because it is a utility object used for Customers and Vendors and other objects.&nbsp; Organizations have only one address, so it is a single child.&nbsp; Also, the Address fields are stored in a seperate user control, also stored in a different component.&nbsp; This address control is then dropped onto the main Organization control to provide the address.&nbsp; Is it all of the cross component communication that is slowing everything down?&nbsp; Thanks for any insight which you can provide.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>triplea replied on Wednesday, March 26, 2008</h2><P>Regsrding your first issue, expand your (DataBindings) property of your control (whatever it is) and click on the "..." button in the Advanced field. In there, depending on where you are binding (i.e for a textbox it would be Text, for a combobox it would be SelectedValue etc) change the DataSourceUpdate mode from OnValidation to OnPropertyChange.</P>
<P>Regarding your second issue, are you overriding the OnPropertyChanged method? Also are you specifying the property name in your PropertyHasChanged, CanReadProperty, CanWriteProperty calls within your properties?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tetranz replied on Wednesday, March 26, 2008</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>KickTheSky:</strong></div><div>I am having two issues.<br>The first one involves binding to WinForms.&nbsp; When I bind my fields there are times where the last changed field never gets updated in binding when the save button is clicked.&nbsp; Is there any way to force binding to update the business object before the save?</div></BLOCKQUOTE><br>Is the save button on a toolbar? I've noticed that toolbar buttons don't make the form validate. You can always called the form's Validate() method in the button click event. If save is a normal button then I don't know why this is happening for you.<br><br><BLOCKQUOTE><div><br>Along with that issue, is it possible to update binding on change rather than on lost focus?&nbsp; Is it something that will slow down my app?</div></BLOCKQUOTE><br>triplea showed the way but you probably don't want it for all controls. I don't think it's a good idea for textboxes because you'll be refreshing the form on every keystroke.&nbsp; I set it to OnPropertyChange for things like checkboxes etc which are "instant change" sort of things.<br><br><BLOCKQUOTE><div><br>
The second issue has to do with speed of apply and cancel edits.&nbsp; It seems that the speed of which these are occuring is taking more than 5 seconds at time for a simple object with only one child object.&nbsp; The object I am representing is an Organization and an Organization has an Address.&nbsp; The Address is stored in a different component because it is a utility object used for Customers and Vendors and other objects.&nbsp; Organizations have only one address, so it is a single child.&nbsp; Also, the Address fields are stored in a seperate user control, also stored in a different component.&nbsp; This address control is then dropped onto the main Organization control to provide the address.&nbsp; Is it all of the cross component communication that is slowing everything down?&nbsp; Thanks for any insight which you can provide.<br></div></BLOCKQUOTE><br>I think you need to isolate this a little further. What if your objects are not bound to the UI? If you run some test code that calls BeginEdit(), changes a property or two and then calls CancelEdit(), does the cancel still take a long time? i.e, Is it really related to binding? I struck this sort of slowness in two ways long ago. One was that I was binding my buttons' enable properties to the BO, IsValid and IsDirty etc properties so that they are only enabled at appropriate times. That never worked smoothly for me.&nbsp; I followed Rocky's suggestion on his site somewhere (going back a year or two now) which updates button states in the bindingSource CurrentItemChanged.&nbsp; The other slowness was caused by effectively having circular references in my objects. If you have a collection item that has a reference to it's parent, then you should mark that parent reference as [NotUndoable()].<br><br>I don't know if any of that applies to you.<br><br>Cheers<br>Ross<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>KickTheSky replied on Wednesday, March 26, 2008</h2>The save button is indeed on a toolbar.&nbsp; I will work a validate call into the base windows control I have that uses the toolbar.&nbsp; Thanks to both of you for pointing out the way to change the binding behavior.<br><br>As for the second issue, all properties do indeed reference the property name in the PropertyHasChanged calls.&nbsp; I do not include parent references in any of my children.&nbsp; I pass the parent into persistance calls so that it gets persisted to the proper parent in the database.&nbsp; I have been changing my button states right in the OnPropertyChanged event handler.<br><br>I will revisit my unit testing to see if the problem is occuring in the objects first and report back my findings.<br><br>Thanks for the help!<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AzStan replied on Wednesday, March 26, 2008</h2><P>Data binding can cause a bunch of performance problems if your object remains bound to the UI while persisting your business objects.&nbsp; Rocky has taught some best practices regarding unbinding your objects from the UI and cloning the object before saving it. Unbinding is trickier than you might hope.</P>
<P>At very least, check to see that you are setting RaiseListChangedEvents=false on your binding source before calling save.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>KickTheSky replied on Wednesday, April 02, 2008</h2>Okay, it looks like the issue is in the binding.&nbsp; I ran seperate NUnit tests on the business objects to add, save, load, change, save, and delete and had nearly instant response time.&nbsp; When the objects get bound, however, that is when the issue occurs.&nbsp; I am looking at load times near 10 seconds and save times that are even longer.&nbsp; When I stop in the debugger it is cycling through the serialization code.&nbsp; I am doing the RaiseListChangedEvents and cloning on the save.&nbsp; Anything else I might be missing on the binding that is slowing it down?<br><br>Oh, one other note.&nbsp; I did a proof of concept app and did not run into these problems.&nbsp; The entire UI was contained in an executable.&nbsp; This time, there are seperate controls, one for base controls (WinPart, EditWinPart), one for each part of the business (Customer, Inventory, Accounting), and then one for the UI shell, which is the executable.&nbsp; The EditWinPart is being used, which is inheriting WinPart and adds a pick list on the left hand side of the form and then on the right hand of the form goes the form data.&nbsp; It also includes a toolbar for add/update/delete and save/cancel/close based on the state of the form.&nbsp; When I did the prototype I had the pick lists seperated out onto a pop-up form and on this they are on the form with the other data and disabled while the person is editing their data.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
