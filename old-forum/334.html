<html><header><title>Displaying the Default Value in databound controls on a web form when performing an Add</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Displaying the Default Value in databound controls on a web form when performing an Add</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/334.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>mtavares posted on Friday, June 09, 2006</h2>Hi,<br><br>I can't seem to find this answer anywhere, so maybe someone can help me.&nbsp; I'm setting a default value for a smartdate in my business object within my DataPortal_Create Method.&nbsp; I then expected that when I am putting my FormView of my web form into Insert Mode and I have a textbox bound to that field in my BO through a csla datasource, that the default date should be displayed within that textbox.&nbsp; Is that the wrong assumption?&nbsp; I've noticed that the same thing occurs in the Project Tracker Demo where a default date is set for the Project Object, but it is not displayed when putting the DetailsView in InsertMode.&nbsp; Is there a way to fix this or is it something where I need to specifically assign the defaults to the controls?<br><br>Thanks,<br>Mike<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mtavares replied on Monday, June 12, 2006</h2>No one else has had this issue?&nbsp; I would have thought it was a common question.&nbsp; I've done some more digging, and it seems that the DataItem object on a DetailsView or FormView is nothing when the controls are in InsertMode.&nbsp; What I don't know is if this is a function of those controls or of the CslaDatasource control (Or ObjectDatasource for that matter since it does the same thing).&nbsp; <br><br>I can live with setting the Default Values in each control's databound event, but it just seems to defeat the purpose of setting them in the business object.&nbsp; If someone could weigh in on this as to what the best practice is, or if there is a way of actually getting that DataItem object to be set, I'd greatly appreciate it.<br><br>Thanks,<br>Mike<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, June 12, 2006</h2>I would think the date should display.&nbsp; Can you post some relevent code?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mtavares replied on Monday, June 12, 2006</h2><P>Here's the code for the CslaDatasource:</P><FONT color=#0000ff size=2>
<P>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> CslaDataSource2_InsertObject(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Csla.Web.InsertObjectArgs) </FONT><FONT color=#0000ff size=2>Handles</FONT><FONT size=2> CslaDataSource2.InsertObject</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;Dim</FONT><FONT size=2> obj </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> NdrnGender = GetNdrnGender()</P>
<P>&nbsp;&nbsp;&nbsp;Csla.Data.DataMapper.Map(e.Values, obj, </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>() {</FONT><FONT color=#800000 size=2>"NDRNGenderID"</FONT><FONT size=2>, </FONT><FONT color=#800000 size=2>"NDRNTimeStamp"</FONT><FONT size=2>})</P>
<P>&nbsp;&nbsp;&nbsp;e.RowsAffected = SaveNdrnGender(obj)</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> CslaDataSource2_SelectObject(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Csla.Web.SelectObjectArgs) </FONT><FONT color=#0000ff size=2>Handles</FONT><FONT size=2> CslaDataSource2.SelectObject</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;Try</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim</FONT><FONT size=2> Obj </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2> = GetNdrnGender()</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If</FONT><FONT size=2> Obj </FONT><FONT color=#0000ff size=2>IsNot</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Nothing</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Then</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.BusinessObject = Obj</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;Catch</FONT><FONT size=2> ex </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.Security.SecurityException</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ValidationUtil.ApplyValidationToValidator(Master.FindControl(</FONT><FONT color=#800000 size=2>"vldGeneral"</FONT><FONT size=2>), ex)</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ChangeView(Views.MainView)</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Try</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT>
<P>Here's the code for the GetNdrnGender function:</P><FONT color=#0000ff size=2>
<P>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetNdrnGender() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> NdrnGender</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;Dim</FONT><FONT size=2> BusnessObject </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2> = Session(</FONT><FONT color=#800000 size=2>"currentObject"</FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;If</FONT><FONT size=2> BusnessObject </FONT><FONT color=#0000ff size=2>Is</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Nothing</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>OrElse</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Not</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>TypeOf</FONT><FONT size=2> BusnessObject </FONT><FONT color=#0000ff size=2>Is</FONT><FONT size=2> NdrnGender </FONT><FONT color=#0000ff size=2>Then</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If</FONT><FONT size=2> MainFormView.CurrentMode = FormViewMode.Edit </FONT><FONT color=#0000ff size=2>Then</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BusnessObject = NdrnGender.GetNdrnGender(</FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.LookupGridView.SelectedValue, Profile.TimeZone)</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Else</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BusnessObject = NdrnGender.NewNdrnGender(Profile.TimeZone)</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;Session(</FONT><FONT color=#800000 size=2>"currentObject"</FONT><FONT size=2>) = BusnessObject</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>CType</FONT><FONT size=2>(BusnessObject, NdrnGender)</P></FONT>
<P>And here's the code in the dataportal_Create method that defaults the date:</P><FONT size=2>
<P>&lt;CSLA.RunLocal()&gt; _</P>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overloads</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> DataPortal_Create(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> crit </FONT><FONT color=#0000ff size=2>as</FONT><FONT size=2> TimeZoneCriteria)</P>
<P></P>
<P></FONT><FONT color=#008000 size=2>' Set defaults for properties</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;m_activeDate = </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> SmartDate(TimeZoneSource.TZSClass.ConvertUtcToLocal(crit.TimeZone, </FONT><FONT color=#0000ff size=2>Date</FONT><FONT size=2>.UtcNow))</P>
<P>&nbsp;&nbsp;&nbsp;m_timeZone = crit.TimeZone</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;Me</FONT><FONT size=2>.ValidationRules.CheckRules()</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#000000 size=3>When I stepped through debugging, the Default values for the date and timezone&nbsp;are being set properly, but those default values never get set to the textbox in the FormView control that is bound to the ActiveDate Property in the BO.&nbsp; If more code is needed, let me know and I'll be happy to provide it, but these are the areas where the the defaults should be set from.</FONT></FONT></P>
<P>Thanks,</P>
<P>Mike<FONT color=#0000ff size=2></P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>zglenn replied on Thursday, August 24, 2006</h2>I am having the same issue. Setting default values in my DataPortal_Create sub in my aspx.vb class the object contians the correct values but they are never set in the insertitemtemplate controls. SelectObject is never called when debugging?

thanks,

Zac</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Friday, August 25, 2006</h2><P>I **think** that the SelectObject is called for the grid as a whole, not for a given row.</P>
<P>(I'm still learning, and that is what appears to be happening based on my work over the last few days.&nbsp; Haven't had time to work thru an experiment to prove my suspicion yet.)</P>
<P>I'm not sure whether forcing a databind on the grid would do anything useful or not.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Friday, August 25, 2006</h2>Just read in&nbsp;a different thread that there's a command to "reset bindings" that might be applicable here...</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, August 25, 2006</h2>The answer is to use the DetailsView.ItemCreated event. Handle this in your page and set the default values directly into the controls within your DetailsView.<br><br>I still think that this was an oversight by the ASP.NET team - as this is obviously a very awkward solution - but it appears to be the correct one...<br><br>&nbsp; Protected Sub DetailsView1_ItemCreated( _<br>&nbsp;&nbsp;&nbsp; ByVal sender As Object, ByVal e As System.EventArgs) _<br>&nbsp;&nbsp;&nbsp; Handles DetailsView1.ItemCreated<br><br>&nbsp;&nbsp;&nbsp; If DetailsView1.DefaultMode = DetailsViewMode.Insert Then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim obj As Project = GetProject()<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CType(DetailsView1.Rows(1).Cells(1).Controls(0), TextBox).Text = obj.Name<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CType(DetailsView1.Rows(2).Cells(1).Controls(0), TextBox).Text = obj.Started<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CType(DetailsView1.Rows(3).Cells(1).Controls(0), TextBox).Text = obj.Ended<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CType(DetailsView1.FindControl("TextBox1"), _<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Web.UI.WebControls.TextBox).Text = obj.Description<br>&nbsp;&nbsp;&nbsp; End If<br><br>&nbsp; End Sub<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dlcollison replied on Wednesday, August 30, 2006</h2><P>Attempted to take your code and get it to work within a FormView as follows - any ideas on how I can set textbox values or checkbox values to default values:</P>
<P>&nbsp;</P>
<P><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> frmPlants_ItemCreated(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.EventArgs) </FONT><FONT color=#0000ff size=2>Handles </FONT><FONT size=2>frmPlants.ItemCreated</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;If</FONT><FONT size=2> (</FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.frmPlants.CurrentMode = FormViewMode.Insert) </FONT><FONT color=#0000ff size=2>Then</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CType</FONT><FONT size=2>(frmPlants.FindControl(</FONT><FONT color=#800000 size=2>"logIsActive"</FONT><FONT size=2>), TextBox).Text = 1</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CType</FONT><FONT size=2>(frmPlants.FindControl(</FONT><FONT color=#800000 size=2>"corporation_id"</FONT><FONT size=2>), TextBox).Text = Session(</FONT><FONT color=#800000 size=2>"svCorpId"</FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT color=#0000ff size=2></P></FONT>
<P>System bombs when I run the code - getting the following message:</P>
<H2><I>Object reference not set to an instance of an object.</I> </H2>
<P><FONT face="Arial, Helvetica, Geneva, SunSans-Regular, sans-serif "><B>Description: </B>An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. <BR><BR><B>Exception Details: </B>System.NullReferenceException: Object reference not set to an </FONT><FONT face="Arial, Helvetica, Geneva, SunSans-Regular, sans-serif ">instance of an object.</FONT></P>
<P>&nbsp;</P>
<P>Any assistance will be appreciated.</P>
<P>&nbsp;&nbsp; DC</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Wednesday, August 30, 2006</h2>I might be just stating the obvious, but if FindControl doesn't find a control by that name, it will return null, and casting that to whatever or accessing a property, will throw a null reference exception.<br>Can you check that your Find control is actually returning anything?<br>Perhaps you mistyped the control's name...<br><br>Andrés<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>av_harris replied on Thursday, July 12, 2007</h2><P>For anyone (like me) still struggling with this issue. I just discovered that the error is being thrown because the form must be in edit mode before a textbox value can be set. I'm stil experimenting but I guess you could set the mode to edit, set your values, then change it back to insert again.</P>
<P>I'm trying to figure out how to bring back entered values in a form after a rules violation during insert. I got it working in the ItemCreated event but still haven't figured out how I will initiate this event during the insert process. </P>
<P>If someone has developed a good process for performing validation, I'd really appreciate a little guidance here.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dinparacha replied on Thursday, October 30, 2008</h2><P>Due to some reasons the <FONT size=2>frmPlants_ItemCreated(..) is being called more then once while loading the page. In the first call it does not find the control but in the subsequent calls it find it and sets the defualt value even if it is in insert mode. So &nbsp;just add one '<STRONG>if'</STRONG> statement before setting the default value</FONT></P>
<P><FONT size=2></FONT>&nbsp;</P>
<P><FONT size=2><FONT color=#800000>corporation_id </FONT>as TextBox=frmPlants.FindControl(<FONT color=#800000>"corporation_id"</FONT>) </FONT></P>
<P><FONT size=2><STRONG>if (<FONT color=#800000>corporation_id!=null) then</FONT></STRONG></FONT></P>
<P><FONT color=#800000 size=2><STRONG>corporation_id.Text=<FONT color=#000000>Session(</FONT><FONT color=#800000 size=2>"svCorpId"</FONT><FONT color=#000000 size=2>)</FONT></STRONG></FONT></P>
<P><FONT size=2><STRONG>end if</STRONG></FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, October 30, 2008</h2><P>Getting default data into a grid or details view in insert mode is a pain. Microsoft really didn't think this scenario through very well. Look at PTWeb, because ProjectEdit.aspx does address this with code such as:</P>
<P>&nbsp; protected void DetailsView1_ItemCreated(object sender, EventArgs e)<BR>&nbsp; {<BR>&nbsp;&nbsp;&nbsp; if (DetailsView1.DefaultMode == DetailsViewMode.Insert)<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Project obj = GetProject();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ((TextBox)DetailsView1.Rows[1].Cells[1].Controls[0]).Text = obj.Name;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ((TextBox)DetailsView1.Rows[2].Cells[1].Controls[0]).Text = obj.Started;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ((TextBox)DetailsView1.Rows[3].Cells[1].Controls[0]).Text = obj.Ended;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ((TextBox)DetailsView1.FindControl("TextBox1")).Text = obj.Description;<BR>&nbsp;&nbsp;&nbsp; }<BR>&nbsp; }<BR></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>aboundweb replied on Tuesday, September 11, 2007</h2><P>Hey there,</P>
<P>This is Joe from <A href="http://www.aboundweb.com">Abound Inc.</A>&nbsp; I spent some time on this issue and found the simple solution.&nbsp; You simply need to create a template field for the field you want to set a default value for.&nbsp; In the template field ASP.Net is very flexible in that you can put any type of control in there whether it be a label, text box, checkbox etc...&nbsp; You set the value for that template field by making a call to a method you create in the code-behind file.&nbsp; I have a page called Clients.aspx where I have a gridview and detailsview.&nbsp; In this page I set it up so that when the user clicks to add a new client, the COMPANY_ID field is set to session variable and cannot be changed by the user.</P>
<P>In the Clients.aspx file the code for the template field looks like this:</P>
<P>&lt;asp:TemplateField HeaderText="COMPANY_ID" SortExpression="COMPANY_ID"&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;EditItemTemplate&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;asp:Label ID="Label1" runat="server" Text='&lt;%# Eval("COMPANY_ID") %&gt;'&gt;&lt;/asp:Label&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/EditItemTemplate&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;InsertItemTemplate&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;asp:Label ID="Label2" runat="server" Text='&lt;%# GetCompanyID() %&gt;'&gt;&lt;/asp:Label&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/InsertItemTemplate&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ItemTemplate&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;asp:Label ID="Label1" runat="server" Text='&lt;%# Bind("COMPANY_ID") %&gt;'&gt;&lt;/asp:Label&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/ItemTemplate&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/asp:TemplateField&gt;</P>
<P>Notice the call to GetCompanyID() in the InsertItemTemplate.&nbsp; That method is defined in the code-behind file (Clients.aspx.cs):</P>
<P>protected String GetCompanyID()<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String sCompany = "";<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (Session["company_id"] != null)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sCompany = (string)Session["company_id"];<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sCompany = "0";<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return sCompany;<BR>&nbsp;&nbsp;&nbsp; }</P>
<P>I hope this helps</P>
<P>Joe Werner<BR>Abound Inc.<BR><A href="http://www.aboundweb.com">www.aboundweb.com</A></P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
