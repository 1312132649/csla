<html><header><title>Suggestion for Validation Rules code</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Suggestion for Validation Rules code</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4864.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>amselem posted on Monday, May 19, 2008</h2><P>Hi,</P>
<P>I'd like to suggest adding a new delegate for validation rules that returns the result inside the eventargs, instead of returning a boolean value. So instead of this code:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> CheckABRule(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> T </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> MyBO)(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> target </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> T, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Validation.RuleArgs) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Boolean</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp;If</FONT><FONT size=2> target.PropertyA&nbsp;&gt; target.PropertyB</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>e.Description = </FONT><FONT color=#a31515 size=2>"A must be&nbsp;lower than&nbsp;B"<BR>&nbsp; &nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>False<BR></FONT><FONT color=#0000ff size=2>&nbsp;Else<BR>&nbsp;&nbsp; &nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>True<BR></FONT><FONT color=#0000ff size=2>&nbsp;End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT></P>
<P>We would have&nbsp;this little more compact code:</P><FONT color=#0000ff size=2>
<P><FONT color=#0000ff size=2>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Shared</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub </FONT><FONT size=2>CheckABRule(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> <FONT color=#000000>T</FONT> </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> <FONT color=#000000>MyBO</FONT>)(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> <FONT color=#000000>target</FONT> </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> T, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> <FONT color=#000000>e</FONT> </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> <FONT color=#000000>Validation.ResultRuleArgs</FONT>)&nbsp;<BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT size=2><FONT color=#000000>e.Description </FONT>= </FONT><FONT color=#a31515 size=2>"A must be&nbsp;lower than&nbsp;B"</FONT>&nbsp;&nbsp;&nbsp;<BR>&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#000000>e.Result</FONT> =<FONT color=#000000> Not (target.PropertyA&nbsp;&gt; target.PropertyB</FONT><FONT size=2><FONT color=#000000>)<BR></FONT><BR></FONT></FONT><FONT size=2></FONT><FONT color=#0000ff size=2>End Sub</FONT></P>
<P><BR><FONT color=#000000>What do you think?</FONT><BR><FONT color=#000000>Regards</FONT><FONT color=#0000ff size=2></P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Monday, May 19, 2008</h2>Or you could write the code as <br><font color="#0000ff" size="2"><p><font color="#0000ff" size="2">Private</font><font size="2"> </font><font color="#0000ff" size="2">Shared</font><font size="2"> </font><font color="#0000ff" size="2">Sub </font><font size="2">CheckABRule(</font><font color="#0000ff" size="2">Of</font><font size="2"> <font color="#000000">T</font> </font><font color="#0000ff" size="2">As</font><font size="2"> <font color="#000000">MyBO</font>)(</font><font color="#0000ff" size="2">ByVal</font><font size="2"> <font color="#000000">target</font> </font><font color="#0000ff" size="2">As</font><font size="2"> T, </font><font color="#0000ff" size="2">ByVal</font><font size="2"> <font color="#000000">e</font> </font><font color="#0000ff" size="2">As</font><font size="2"> <font color="#000000">Validation.ResultRuleArgs</font>)&nbsp;  </font><font color="#0000ff" size="2">As</font><font size="2"> </font><font color="#0000ff" size="2">Boolean</font><br><font size="2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size="2"><font color="#000000">e.Description </font>= </font><font color="#a31515" size="2">"A must be&nbsp;lower than&nbsp;B"</font>&nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp; </font><font color="#0000ff" size="2">Return</font> <font size="2"><font color="#000000">Not (target.PropertyA&nbsp;&gt; target.PropertyB</font><font size="2"><font color="#000000">)<br></font><br></font></font><font color="#0000ff" size="2">End Sub</font></p></font>/jonnybee<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>amselem replied on Tuesday, May 20, 2008</h2><FONT size=2>Yes, that code is as compact as the one I posted but I was thinking more on following a more or less typical pattern, like System.Windows.Forms.ConvertEventArgs or System.ComponentModel.RunWorkerCompletedEventArgs. In both samples the result is returned inside the eventargs. Of course this is a matter of taste...</FONT></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
