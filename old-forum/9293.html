<html><header><title>Accessing registered rules for a given type</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Accessing registered rules for a given type</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9293.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>breakphreak posted on Thursday, July 29, 2010</h2><p>hello again :)</p>
<p>http://forums.lhotka.net/forums/t/9292.aspx</p>
<p>In my previous question (please see the link above) I&#39;ve described some authorization-related declarative approach we&#39;ve decided to follow for now. In short, the attributes are declared on a particular interface, they are processed in a special place and converted into appropriate authorization rules to be registered with &quot;BusinessRules&quot; class.</p>
<p>I would like to make the approach even more handy:</p>
<p>&nbsp;</p>
<ul>
<li>The attributes are decorating some particular BO interface (say &quot;IMyEntity&quot;)</li>
<li>That interface might inherit from another BO interface (say &quot;IMyBaseEntity&quot;) that also might have some decorating attributes</li>
<li>I am analyzing all the rules up to the hierarchy (IMyEntity -&gt; IMyBaseEntity -&gt; ... -&gt; IEntityBase -&gt; ... -&gt; IBusinessObject)</li>
<li>To avoid rules&#39; collisions&nbsp;I want to provide an overriding-like behavior, i.e. if &quot;IMyEntity&quot; declared a particular rule, then the same rule if declared also for &quot;IMyBaseEntity&quot; will be silently <i>ignored</i>.</li>
<li>This approach will also allow me to define some default rules, but decorating some application-level common denominator interface with some attributes that will trigger default rules registration. That behavior can be derived in descendants&#39; interfaces, which is pretty nice.</li>
</ul>
<p>&nbsp;</p>
<p>The <strong>problem</strong> I&#39;ve encountered, is that <strong><i>AuthorizationRuleManager</i></strong><i> </i>is internal. Which means that I can&#39;t check if a rule is already declared for the particular interface. Also another method which is very similar to <b><i>BusinessRules.EnsureUniqueRule()</i></b>&nbsp;would be highly anticipated (the only difference would be the return value of type <b><i>bool</i></b> and not throwing an exception).</p>
<p>Assuming that I&#39;ve succeeded to put my thoughts in the right wording - here is another place to ask for a better practice to implement the approach described above. The only alternative I can see from my narrow point of view is to turn the class into public. Since changing the 3rd party source is not the best thing to do, it would be great to hear your thoughts: do you think it worth to make the class public or there a better implementation is still possible with the current API?</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Thursday, July 29, 2010</h2><p>At some point I plan to implement authorization attributes that work in a manner similar to the DataAnnotations validation attributes. If you want your model to fit into some future version of CSLA that is the basic approach you should consider.</p>
<p>I am hopeful that Microsoft will actually define the base for such an attribute. While it took them years, they eventually did this for validation. In other words, I&#39;m in a position where I can either act now and rip it all out if/when Microsoft does something, or do what I did with validation and wait patiently for them to provide a supported model.</p>
<p>I suspect however, that the success of DataAnnotations will likely spur them to try the idea in the area of authorization sooner than later, so I think the risk of me implementing something and having to rip it out (and break everyone) is fairly high.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>breakphreak replied on Friday, July 30, 2010</h2><p>thanks a lot again! also, glad to hear that I am thinking in the right direction.</p>
<p>So I&#39;ll change the source (a bit) for now till the well-formed solution will arrive from the CSLA incubator :)</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
