<html><header><title>ApplicationContext with WCF service</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ApplicationContext with WCF service</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11258.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>wesa posted on Monday, March 26, 2012</h2><p>Hi, I am developing a security module for my system and have run into a problem with authorizing users. I use a WCF service as a remote data portal and also use the CSLA Authorization Provider to call my class &quot;CustomAuthorizer&quot; to verify the user and set up the identity and principal objects. </p>
<p>What is happening is that when the user is authorized and the identity and principal is created on the service I set the csla.applicationcontext.user = CustomPrincipal. When processing returns to the client application however, the role set up on the service is not in the client&#39;s applicationcontext.</p>
<p>Hoping someone can help me with this.</p>
<p>Thanks.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Monday, March 26, 2012</h2><p>User principal is one-way only, from client to server.&nbsp;</p>
<p>I assume you are using a custom principal and identity object (derived from CslaPrincipal and CslaIdentity). </p>
<p>You should authorize the user, possibly by making a separate call to the server, and set the ApplicationContext.User on the client. The principal object will then be transferred to the server when AuthorizationMode is set to anything but Windows (as the windowsprincipal is not serialzable). So the idea is that your&quot;CustomAuthorizer&quot; can check for explicit roles or do other &quot;data driven&quot; authorizations before the execution hits actual code and keep this code in just one place.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>wesa replied on Tuesday, March 27, 2012</h2><p>Thanks for the quick reply!</p>
<p>Now that I know the User principal is only one-way, things make a lot more sense now. I did change my program so it does the role set-up on the client side and still does separate checks on the server for every dataportal method.</p>
<p>Thanks again!</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
