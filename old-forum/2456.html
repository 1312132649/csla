<html><header><title>Using interfaces with CSLA</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Using interfaces with CSLA</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2456.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rgoggin53 posted on Thursday, March 01, 2007</h2><P>I am a big believer in coding to interfaces. So I would like to make interfaces for all of my business objects. </P>
<P>For example if I have the following interfaces:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>interface</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>IFoo</FONT><FONT size=2> : </FONT><FONT color=#2b91af size=2>IEditableBusinessObject </FONT><FONT size=2>{</P>
<P></FONT><FONT color=#2b91af size=2>Guid</FONT><FONT size=2> Id { </FONT><FONT color=#0000ff size=2>get</FONT><FONT size=2>; }</P>
<P></FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> Name { </FONT><FONT color=#0000ff size=2>get</FONT><FONT size=2>; </FONT><FONT color=#0000ff size=2>set</FONT><FONT size=2>; }</P>
<P>}</P><FONT color=#0000ff size=2>
<P>interface</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>IFoos <FONT size=2>: </FONT><FONT color=#2b91af size=2>IEditableCollection </FONT></FONT><FONT size=2>{</P>
<P></FONT><FONT color=#2b91af size=2>IFoo</FONT><FONT size=2> Add();</P>
<P></FONT><FONT color=#2b91af size=2>IFoo</FONT><FONT size=2> GetFooById(</FONT><FONT color=#2b91af size=2>Guid</FONT><FONT size=2> p_id);</P>
<P></FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> Remove(</FONT><FONT color=#2b91af size=2>Guid</FONT><FONT size=2> p_id);</P>
<P></FONT><FONT color=#2b91af size=2>Foos</FONT><FONT size=2> Save();</P>
<P>}</P></FONT>
<P><FONT size=3>Based on these two interfaces I declare the following classes:</FONT></P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>class</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>Foo</FONT><FONT size=2> : </FONT><FONT color=#2b91af size=2>BusinessBase</FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2>Foo</FONT><FONT size=2>&gt;, </FONT><FONT color=#2b91af size=2>IFoo{}</P></FONT><FONT size=2><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>class</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>Foos</FONT><FONT size=2> : </FONT><FONT color=#2b91af size=2>BusinessListBase</FONT><FONT size=2>&lt;</FONT><FONT color=#2b91af size=2>Foos</FONT><FONT size=2>, </FONT><FONT color=#2b91af size=2>IFoo</FONT><FONT size=2>&gt;, </FONT><FONT color=#2b91af size=2>IFoos </FONT><FONT size=2>{}</P></FONT><FONT size=2>
<P><FONT size=3>The problem is that I want to create an editable collection of IFoo's but the methods NewFoo, GetFoo, DeleteSelf, Insert, and Update are not defined in the IFoo interface. Without out making these methods public so that they can be included in the interface, it is not possible for the editable collection of IFoo's to invoke any of these methods&nbsp;it's IFoo childern. </FONT></P>
<P><FONT size=3>Does anyone know of way to make a editable collection of an interface without out exposing these methods to the world.</FONT></P>
<P><FONT size=3>Thanks for any ideas. </FONT></P>
<P><FONT size=3>rgoggin53 </FONT></P></FONT></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jeff replied on Thursday, March 01, 2007</h2><P>This is what I did:</P>
<P><FONT face="Courier New"><FONT size=2><FONT color=#0000ff>internal</FONT> <FONT color=#0000ff>interface</FONT> </FONT></FONT><FONT face="Courier New" color=#2b91af size=2>IEditableChildObject<BR></FONT><FONT face="Courier New"><FONT size=2>{<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;void</FONT></FONT></FONT><FONT face="Courier New"><FONT size=2> DeleteSelf();<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;void</FONT> Insert(<FONT color=#2b91af>Guid</FONT></FONT></FONT><FONT face="Courier New"><FONT size=2> parentId);<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;void</FONT></FONT></FONT><FONT face="Courier New" size=2> Update();<BR>}</FONT></P><FONT size=1>
<P></FONT><FONT face="Courier New"><FONT size=2><FONT color=#0000ff>internal</FONT> <FONT color=#0000ff>static</FONT> <FONT color=#0000ff>class</FONT> <FONT color=#2b91af>FooFactory<BR><FONT color=#000000>{<BR></FONT></FONT></FONT></FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;internal</FONT> <FONT color=#0000ff>static</FONT> <FONT color=#2b91af>IFoo</FONT> NewFoo(<FONT color=#2b91af>FooType</FONT> fooType</FONT><FONT face="Courier New">)<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case Type A:<BR></FONT></FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return</FONT> <FONT color=#2b91af>TypeAFoo</FONT></FONT><FONT face="Courier New">.NewTypeAFoo();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;etc...<BR></FONT></FONT><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp;}</FONT></P>
<P><FONT face="Courier New" size=2></FONT></P>
<P><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;internal</FONT> <FONT color=#0000ff>static</FONT> <FONT color=#2b91af>IFoo</FONT> GetFoo(<FONT color=#2b91af>DataRow</FONT></FONT><FONT face="Courier New"> row)<BR></FONT></FONT><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>if</FONT> (row[<FONT color=#a31515>"FooType_Id"</FONT>] == <FONT color=#2b91af>FooType.A</FONT></FONT><FONT face="Courier New">)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT color=#0000ff>return</FONT> <FONT color=#2b91af>TypeAFoo</FONT><FONT face="Courier New">.GetTypeAFoo(row);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;etc...</FONT></FONT></FONT><FONT size=2><FONT face="Courier New"><FONT face="Courier New"><BR>&nbsp;&nbsp;&nbsp;}<BR>}</FONT></FONT></FONT></P>
<P><FONT size=+0>Since the interface is internal you'll have to implement the methods in Foo like this:</FONT></P><FONT color=#0000ff size=1>
<P><FONT face="Courier New" size=2>void</FONT></FONT><FONT face="Courier New" size=2> <FONT color=#2b91af>IEditableChildObject</FONT>.Update()</FONT></P>
<P><FONT size=+0>And you'll have to do some casting in the collection:</FONT></P><FONT size=1>
<P></FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>foreach</FONT> (<FONT color=#2b91af>IFoo</FONT>&nbsp;foo <FONT color=#0000ff>in</FONT> <FONT color=#0000ff>this</FONT>)<BR>{<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;if</FONT> (foo.IsNew)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<FONT color=#2b91af>IEditableChildObject</FONT>)foo).Insert(fooParent.Id);<BR></FONT></FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;else<BR></FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<FONT color=#2b91af>IEditableChildObject</FONT>)foo).Update();<BR>}</FONT></FONT></P>
<P><FONT size=+0>I think this accomplishes what you're after.</FONT></P>
<P><FONT size=2><FONT face="Courier New"><FONT face="Courier New">&nbsp;</P></FONT></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jimbo replied on Friday, March 02, 2007</h2>Whats is that in vb speak?<br>
After all csla is multi lingual.<br>
<br>
<br>
<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rgoggin53 replied on Friday, March 02, 2007</h2><P>Jeff, </P>
<P>Thanks for the response. I believe what you did works except for the case of overriding AddNewCore(). Since AddNewCore does not take any parameters there is no way to know which concrete type of IFoo to create.</P>
<P>On a side note:</P>
<P><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>internal</FONT> <FONT color=#0000ff>static</FONT> <FONT color=#2b91af>IFoo</FONT> NewFoo(<FONT color=#2b91af>FooType</FONT> fooType)<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case Type A:<BR></FONT><FONT face="Courier New"><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return</FONT> <FONT color=#2b91af>TypeAFoo</FONT></FONT></FONT><FONT size=2><FONT face="Courier New">.NewTypeAFoo();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;etc...<BR></FONT><FONT face="Courier New">&nbsp;&nbsp;&nbsp;}</FONT></FONT></P>
<P>I think the previous code could be replaced with the following and eliminate the need for the case statement.</P><FONT size=2><FONT face="Courier New"><FONT color=#0000ff><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>internal</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>static</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>IFoo</FONT><FONT size=2> NewFoo(</FONT><FONT color=#2b91af size=2>Type</FONT><FONT size=2> fooType)</FONT></P>
<P><FONT size=2>{</P>
<P></FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> (</FONT><FONT color=#2b91af size=2>IFoo</FONT><FONT size=2>)</FONT><FONT color=#2b91af size=2>Activator</FONT><FONT size=2>.CreateInstance(fooType);</P>
<P>}</P></FONT></FONT></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>boo replied on Friday, March 02, 2007</h2>So I hate to ask, but why do you believe that you should code to interfaces?<br><br>What are you gaining by doing so?&nbsp; Are you going to suddenly swap out on the fly another business object that has the same exact signature?<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
