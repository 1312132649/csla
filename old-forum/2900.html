<html><header><title>ComboBox hell</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ComboBox hell</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2900.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Friday, May 18, 2007</h2>Hi,<br><br>I have a couple of comboboxes which I want to bind to properties on my BO.&nbsp; The first is a company combo box.&nbsp; The user may select an item from the list (and AutoComplete is on) or may type something not in the list.&nbsp; The BO property is simply a string.&nbsp; <br><br>My first problem is how to bind this properly?&nbsp; If the user types a property, SelectionIndexChanged doesn't fire, and the BO isn't updated if I bind the BO property to the SelectedValue.&nbsp; To handle this, I'm also binding the Text property to the same BO property.&nbsp; I'm not sure if thats the best way to handle this or not..<br><br>I also have a department text box which works the same way.&nbsp; The difference is that its datasource depends on if a value is selected from the Company combo box, so that only departments belonging to the selected company are shown (or the list should be cleared if the user typed something not in the company combo's selection list).&nbsp; I have the same bindings on this combo box as well.&nbsp; The problem is that when the company selection changes, I update the department combos datasource and set SelectedIndex to -1 (otherwise the combo selects the first item in the list).&nbsp; For some reason, the Text is being set to -1.&nbsp;&nbsp; <br><br>Any ideas?&nbsp; I know someone has done something similar before.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DansDreams replied on Friday, May 18, 2007</h2>Did you try it just binding the Text property of the control?&nbsp; I would think the key would be finding something that changes whether it's from typing or selecting, and that would be my first guess.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, May 18, 2007</h2>Yes, and it works fine for the company text box, but not for the Department text box.&nbsp; <br><br>Oddly, even setting the Text property on the Department combobox doesn't cause that value to be pushed into the BO..<br><br>I did find where the -1 was coming from; the form is old, and I had code to change the binding so that null was changed to -1.&nbsp; <br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
