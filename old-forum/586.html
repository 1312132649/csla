<html><header><title>Overloading DataPortal_Create</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Overloading DataPortal_Create</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/586.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>mwilkes posted on Tuesday, July 11, 2006</h2>Having problems overloading the DataPortal_Create(ByVal criteria As Object) method from csla.core.BusinessBase.&nbsp; In my Employee class, which inherits from BusinessBase, I have the following method declaration:<br><br>&nbsp;&nbsp;&nbsp; <font size="2"><i>&lt;RunLocal()&gt; _<br>&nbsp;&nbsp;&nbsp; Private Overloads Sub DataPortal_Create(ByVal criteria As Criteria)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.FirstName = "Joe"<br>&nbsp;&nbsp;&nbsp; End Sub<br><br></i></font>I also have a windows ui that references the Employee class and tries creating a new employee by using the Employee's factory method:<br><br>&nbsp;&nbsp;&nbsp; <font size="2"><i>Public Shared Function NewEmployee() As Employee<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return DataPortal.Create(Of Employee)()<br>&nbsp;&nbsp;&nbsp; End Function<br><br></i></font>However, as I am stepping through the ui, the method that is actually getting called is in csla.core.businessbase which simply throws an exception.&nbsp; If I change the method declaration in my Employee class to:<br><br>&nbsp;&nbsp;&nbsp; <font size="2"><i>&lt;RunLocal()&gt; _<br>
&nbsp;&nbsp;&nbsp; Private Overloads Sub DataPortal_Create(ByVal criteria As Object)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.FirstName = "Joe"<br>
&nbsp;&nbsp;&nbsp; End Sub<br><br></i></font>everything runs fine.&nbsp; I also should mention that inside my Employee class is the Private Criteria class.<br><br>There has to be a simple answer out there.&nbsp; I know I'm missing something.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, July 11, 2006</h2><P>This is (to some degree) discussed in Chapter 4, where the base class implements Overridable DataPortal_XYZ methods to "simplify" the creation of business objects.</P>
<P>It appears that the end result is that those virtual methods have made things more complex, and I should have probably dropped them... Too late now&nbsp;- as I shudder to think how many people's code would break at this point...</P>
<P>So the answer is this: if you are going to use "criteria As Object" you must override the method from the base class:</P>
<P>Protected Overrides Sub DataPortal_Create(ByVal criteria As Object)</P>
<P>And this is the method which will be called if you (in your factory) call DataPortal.Create() with no parameter, or with a Nothing/null parameter. It is also the fallback method that will be called if no strongly typed overload can be found when you do pass an actual criteria object.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mwilkes replied on Tuesday, July 11, 2006</h2>Thanks for your help Rocky.&nbsp; I kept referring to the text but eventually wound up keeping the Object type in the DataPortal_Create method.&nbsp; However, I am able to strongly type the criteria variable in the DataPortal_Fetch method through the use of an overload.&nbsp; I guess this has to do with the fact that my GetEmployee factory method is passing an actual criteria object to the DataPortal.<br><br>-Mike<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>antoan replied on Thursday, August 31, 2006</h2>The problem occurs when the criteria is stongly typed not when passed as an object. ie: <br /><br /><br />private void DataPortal_Create(Criteria criteria) {...} fails. <br /><br />Am I not able to implement this factory method with a custom criteria because MethodCaller picks up the BusinessBase implementation first as opposed to my overload? </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, August 31, 2006</h2>The method signatuer you posted should be called as long as you're doing this..<br><br>return DataPortal.Create&lt;BO&gt;( new Criteria( /* params, if any */ ) );<br><br>Is that what the call looks like?<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
