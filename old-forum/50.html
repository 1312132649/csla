<html><header><title>CSLA Medium Trust</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA Medium Trust</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/50.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>stayfitsoftware posted on Tuesday, May 09, 2006</h2><P>I am new to CSLA and am reading the .net 1 version of the book.&nbsp; I am toying with the idea of converting a current project to use CSLA.&nbsp; Does anyone know if it works in a medium trust web enviroment?&nbsp; This is not a deciding factor I am just curious.</P>
<P>Also thanks for the great books and code!!</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>guyroch replied on Tuesday, May 09, 2006</h2><P>Here is some good info...</P>
<P>Programs that run on the CLR use something called code access security<BR>(CAS). CAS is different from traditional security systems in that it<BR>assigns trust to code rather than users. To do this, the security<BR>system gathers a set of evidence about every assembly it loads. This<BR>evidence is then compared against the security policy, and a<BR>permission grant is generated.</P>
<P>One of the pieces of evidence that the security system gathers is the<BR>security zone that the code is running from. When you run the code<BR>from your local machine, this will be the MyComputer zone, but when<BR>you run it off of a server, or even a network share mapped to a drive<BR>on your machine, it will be the LocalIntranet zone.</P>
<P>By default any code that is run from the MyComputer zone will get a<BR>permission set of FullTrust (unrestricted permission to do anything it<BR>pleases). However, by default, there is a more restrictive permission<BR>set given to LocalIntranet assemblies.</P>
<P>The way to make an application that works from the MyComputer zone<BR>work from the LocalIntranet zone is to give the assemblies in your<BR>application a strong name, and modify the security policy to trust<BR>this strong name. Hence the need for a key.</P>
<P>In CSLA 1.x,&nbsp;DataPortal and ServicesDataPortal runs in LocalIntranet zone, not sure about CSLA2.0, would need to look a bit deeper to confirm.</P>
<P>Hope this helps</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>stayfitsoftware replied on Tuesday, May 09, 2006</h2>Thanks for the info.&nbsp; The reason I ask, is currently my data layer o/r uses reflections and that is not allowed in medium trust atleast not in the implementation I use.&nbsp; So it kind of shocked me when I moved to .net 2.&nbsp; Just wanted to get any info I can before implementing CSLA.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>CSLA101 replied on Tuesday, May 09, 2006</h2><P>There are a couple of threads on this subject in the old forum (old if 1 week is old <img src="/emoticons/emotion-5.gif" alt="Wink [;)]" /> ). CSLA definitely uses reflection if you make your CRUD calls through the normal static/DataPortal path... so if your goal was to avoid reflection, &nbsp;you would need to bypass that in some way. <A href="http://www.searchcsla.com/Details.aspx?msn_id=26522">Here</A> is a link to one of&nbsp;the old threads.&nbsp;I&nbsp;don't know if there is anywhere else in CSLA where you would get bit with medium trust... but I would like to know that answer.&nbsp;</P>
<P>Mike&nbsp;&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, May 10, 2006</h2><P>To get medium trust you'd have to give up n-level undo and the data portal at a minimum. Both of these features not only use reflection, but also serialization, and serialization requires a high level of trust. Also, if you have the data portal use Remoting, Enterprise Services or WCF you need FullTrust. (Yes, WCF! So there's no relief from this issue in the foreseeable future...)</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>stayfitsoftware replied on Wednesday, May 10, 2006</h2><P>I browsed those old post , and the information Rockford just gave was very helpful.&nbsp; Medium trust seems hard to get to.&nbsp; Like I said I am still in the early chapters of the book but n-level undo and the data portal seems, like a lot to give up in this framework just for medium trust.&nbsp;&nbsp; Thanks </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>CSLA101 replied on Wednesday, May 10, 2006</h2><P>Rocky,</P>
<P>Let's say one was using CSLA in a non-remoted web application (no remoting, no undo). Can you think of anything esle that would bite you? Someone had mentioned the CSLA date utility or something.... or maybe the safe data reader ... can't remember. </P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, May 10, 2006</h2><P>I can honestly say that I haven't spent a lot of time trying to sort through what would or wouldn't work. My focus has been on building business systems - with the (perhaps incorrect) assumption that those systems will run on computers controlled by a company - and thus the trust issue just hasn't been high on my list of things to consider.</P>
<P>I don't think there's anything else that should bite you. SafeDataReader doesn't do anything special, nor really does SmartDate. The big stuff is the use of serialization and reflection in n-level undo and the data portal. And DataMapper in version 2.0. And the ObjectAdapter&nbsp;- perhaps that's what you are&nbsp;thinking of.</P>
<P>I think though, that CAS is a dead concept. Microsoft didn't make it practical to use partial trust from day 1 and now we have years worth of development using technologies like COM interop, Enterprise Services and reflection - all of which require high trust. And in the future WCF requires high trust - so even Microsoft continues to provide very key tools that only work at high trust.</P>
<P>This is like the Amiga years and years ago. From day 1 it supported the <EM>idea</EM> of protected memory (where one process couldn't tamper with memory in another process). But they didn't turn it on because the hardware support wasn't there. A few years later, when the hardware support was there, they <EM>couldn't</EM> turn it on because it would have broken almost every app ever written. This is the same as CAS - if it were to be enforced in a broad sense, the vast majority of .NET apps would simply cease. And most of them couldn't be rewritten to work in partial trust, because .NET doesn't provide the required features at that trust level.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>stayfitsoftware replied on Wednesday, May 10, 2006</h2><p>Rockford, it is nice to hear your take on CAS.&nbsp; I am a hobbyist who still uses a hosted enviroment for many of my projects, and some of my target client would be non technical people working in a hosted enviroment.&nbsp; It was kind of a shock when I found out that all of these great features (reflection.. etc)&nbsp; were gone in medium trust.&nbsp; I guess I should have done more research but there is only so much time.</p>
<p>Once again thanks for your input.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>CSLA101 replied on Wednesday, May 10, 2006</h2><P>Rocky,</P>
<P>Yeah... I think one could make the case that CSLA isn't really a good fit for hosted web. However, if your goal was to do a proof of concept (test the waters)&nbsp;in a cheap/hosted environment... and do it in such fashion that you didn't have to re-plumb&nbsp;if it took off and made you $ millions ... you might want to just start with the Lexus (CSLA) and figure the workarounds in the hosted world. Of course, if $ millions were in your future, one could afford the rewrite. :)</P>
<P>Thanks for the input.... as usual. </P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
