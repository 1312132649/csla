<html><header><title>Shared Custom Validation Rules</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Shared Custom Validation Rules</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2011.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>cultofluna posted on Thursday, December 21, 2006</h2>Hello,<br><br>I have a question about using a shared validation rule for multiple properties containing the same information type.<br><br>For example:<br><br>An order has three registrations of customer company names, on for the customer, the recipient and the invoice customer. The information is available through three different properties CustomerName, RecipientName, InvoiceName. All three need the same validation.<br><br>But how should I handle this? When creating a custom validation rule I need to use an interface that has a property with that is also available in the order object. However I have three different propertynames and I don;t want to create three interfaces.<br><br>Any thoughts?<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cultofluna replied on Thursday, December 21, 2006</h2>For now I have the following solution:<br><br>1. Add Rules<br><br>ValidationRules.AddRule(ValidateName, "CustomerName");<br>ValidationRules.AddRule(ValidateName, "RecipientName");<br>ValidationRules.AddRule(ValidateName, "InvoiceName");<br><br>2. ValidateName<br><br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; private static bool ValidateName(object target, Csla.Validation.RuleArgs e)<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //***** Use reflection on the target to retrieve the value<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; PropertyInfo pi = target.GetType().GetProperty(e.PropertyName);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; string value = (string)pi.GetValue(target, null);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; if (value == "Name")<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; e.Description = "Invalid Name";<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return false;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; return true;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; }<br><br>It works fine! However, it doesn't feel like a good solution. Again any thoughts? <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>s_tristan replied on Friday, December 22, 2006</h2>What same you confused by? As for me&nbsp;this is not bad solution</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, December 22, 2006</h2>That seems fine to me, although you may want to check the PropertyInfo that the PropertyType is actually a string.&nbsp; Not necessary technically, although it mgiht be easier to locate a problem if you throw another exception instead of letting an InvalidCastException be thrown.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
