<html><header><title>Need a new flavor of BindableList class?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Need a new flavor of BindableList class?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/343.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>baltrinic posted on Sunday, June 11, 2006</h2><P class=MsoNormal><FONT face="Times New Roman">I have read the currently running thread on switchable objects started by cmay.<SPAN>&nbsp; </SPAN>I have a related but rather different problem I am trying to tackle.<SPAN>&nbsp; </SPAN>What I seem to need is something like a bindable list class that works with editable objects that are not marked as children, but I want some advice from those more experience with CSLA and OOD.<SPAN>&nbsp; </SPAN>Here is the scenario.</FONT></P>
<P class=MsoNormal><o:p><FONT face="Times New Roman">&nbsp;</FONT></o:p></P>
<P class=MsoNormal><FONT face="Times New Roman">I am trying to implement a grid that behaves in a manner similar to an outlook style task list.<SPAN>&nbsp; </SPAN>First the user can use a field chooser to define what properties of the task object they want to see in the grid.<SPAN>&nbsp; </SPAN>Second&nbsp;the user&nbsp;can modify&nbsp;most of those properties right in the grid, and they can double click on a row in the grid and an editor window will appear allowing them to view and edit the entirety of the object.<SPAN>&nbsp; </SPAN>Moreover, edit/undo/accept changes operates on a per task basis only.<SPAN>&nbsp; </SPAN>The list is never edited as a single entity; movement off of a row commits the changes to that row automatically.<SPAN>&nbsp; </SPAN></FONT></P>
<P class=MsoNormal><FONT face="Times New Roman"><SPAN></SPAN></FONT>&nbsp;</P>
<P class=MsoNormal><FONT face="Times New Roman"><SPAN></SPAN>This sounds to me like a need a new flavor of BindableList class that supports the following data-binding features:</FONT></P>
<OL>
<LI>
<DIV class=MsoNormal><FONT face="Times New Roman">Deleting exiting object immediately upon deletion from bound grid.</FONT></DIV></LI>
<LI>
<DIV class=MsoNormal><FONT face="Times New Roman">Adding new objects to persistent storage as soon as the newly added grid row loses focus.</FONT></DIV></LI>
<LI>
<DIV class=MsoNormal><FONT face="Times New Roman">Removing a newly added&nbsp;object from the collection and not saving it to persistent storage in the event of a CancelAdd action.</FONT></DIV></LI>
<LI>
<DIV class=MsoNormal><FONT face="Times New Roman">Saving changes to an existing object immediately upon loss of focus by the grid row to which it is bound.</FONT><o:p><FONT face="Times New Roman">&nbsp;</FONT></o:p></DIV></LI></OL>
<P class=MsoNormal><FONT face="Times New Roman">Has anything like this come up before?<SPAN>&nbsp; Has anyone implemented something like this</SPAN>?&nbsp; I would like to pattern my work after a time-tested solution or at least pick the brains of those more experienced than myself before charging off to re-invent the wheel.</FONT></P>
<P class=MsoNormal><o:p><FONT face="Times New Roman">&nbsp;</FONT></o:p></P>
<P class=MsoNormal><FONT face="Times New Roman">Thanks in advance for any advice.</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Fabio replied on Tuesday, June 13, 2006</h2>Do you mean that you have something like a <i>BOsBrotherhood </i>without parent ?<br>Csla base classes don't contemplate this case. BindiableListBase is an editable transaction list (mean that save is in one transaction) and implement n-level undo.<br>You need some more simple.<br>You can create your own<br><font size="2">[Serializable()]<br>public abstract class BoBrotherhood&lt;T, C&gt; :<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.ComponentModel.BindingList&lt;C&gt;<br>&nbsp;&nbsp;&nbsp; where T : BoBrotherhood&lt;T, C&gt;<br>&nbsp;&nbsp;&nbsp; where C: IUDBusinessObject // you need an interface in your BusinessBase to access Save a Delete method<br>&nbsp; {<br>&nbsp;&nbsp;&nbsp; protected BoBrotherhood()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AllowEdit = true;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AllowRemove = true;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AllowNew = true;<br>&nbsp;&nbsp;&nbsp; }<br>&nbsp; ..........<br><br></font>1th you need to study System.ComponentModel.BindingList&lt;C&gt; or IBindingList<br>2th study how work the ReadOnlyListBase to implement the rest of the class.<br>3th <font size="2">IUDBusinessObject </font>mean that you have two public methods in you BO: Save() that you have in BusinessBase&lt;T&gt; and Delete() to call DataPortal_DeleteSelf()<br>4th be carefully with Authorization and others important concept of Csla<br>Now we need to analize your points:<br>1) BindingList have a protected method that you can override<br><font size="2">&nbsp;&nbsp;&nbsp; protected override void RemoveItem(int index)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Items[index].Delete(); //&nbsp; C is a IUDBusinessObject<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; base.RemoveItem(index);<br>&nbsp;&nbsp;&nbsp; }<br></font>2)I think two ways: public constructor in your bo,&nbsp; "standar" factory of Csla. If you use factories you must implement something like this in your list hinerited from <font size="2">BoBrotherhood</font><br><font size="2">&nbsp;&nbsp;&nbsp; protected override object AddNewCore()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; YourBO item = YourBO .NewYourBO ();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add(item);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return item;<br>&nbsp;&nbsp;&nbsp; }<br></font>To save the added BO you need to use the BindingSource events to save boBindingSource.Current and remeber that Current, may be, implement <font size="2">IUDBusinessObject</font>.<br>Note: remeber UI is not the BO; don''t mix! don't think in databinding, csla is another story)<br>3) Where you think you need a CancelAdd ? In the UI you need a BindingSource so don't warry, when the CancelEdit method hare colled on a new bo the reference in the list is removed so you don't need to do anything.<br>4) The same of the end of point 2<br><br>Be carefully!<br>Bye.<br>Fabio.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kbaltrinic replied on Tuesday, June 13, 2006</h2><P>Fabio, </P>
<P>Thanks for the tips.&nbsp; This is generally the direction I was heading in.&nbsp; I just wanted to confirm that this was indeed something not handled by the existing framework.&nbsp; I am still a little incredulous that someone out there has not encountered this sort of requirement before and that there isn't already a standard solution.</P>
<P>If not, I guess I will post my solution here when I am done.&nbsp; Is there a respository anywhere for CSLA extensions and classes and such where developers can post their code?</P>
<P>--Ken</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Tuesday, June 13, 2006</h2>It sounds to me that you're mixing UI logic with business logic. Let me see if I get this straight. Your objects are persisted and loaded independently, right? so the collection is just there to support a list that only exists so that the users will get a grid. So you can just create a List(Of T) and handle the adding removing methods to do the saving / destroying of your objects. If you need to load a bunch of them at a time, you should then create the collection on the business objects' library and do the same thing as the other one, but you'd also implement a dataportal_fetch to load the wholebunch of root objects.<br>You could have a friend LoadObject that accepts a datareader as parameter and extracts the info that you can call from the collection's fetch or from the root's fetch.<br>That way you can load a whole bunch of root objects together or independently with little effort.<br><br><br>Andr√©s<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ronnie replied on Sunday, June 18, 2006</h2><P>Good thread. I have a feeling the OP's situation is also the reason for many wanting to create switchable objects, simply to show a list of them on the UI. The suggestion I've seen is almost always to create a readonlylist with readonly children, and suddenly you have 2 quite similar objects to maintain. I know, I know, let the use case tell you what you need...</P>
<P>Xal, I think you suggest making a collection based on "List&lt;T&gt;&nbsp;where T : BusinessBase"&nbsp;instead of a collection based on any of the csla base classes, correct? I guess I have become a little&nbsp;blinded by clsa and trying to do everything with only csla, but I like that idea. I'm not sure I like having this UI support class in the domain layer, but&nbsp;I guess you could think of it more or less like a Repository for the editable root (more or less in line with how its described in domain driven design). </P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
