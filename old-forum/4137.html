<html><header><title>Array property implementation</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Array property implementation</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4137.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ruudjah posted on Wednesday, January 09, 2008</h2>Hi,<br /><br />I am wondering what the "best" methods is for implementing an array (list of values).I could not fin this in the documentation, and I thought of several ways.<br /><br />First, you can define a completely new class which derives from EditableChildList or ReadOnlyList using a value type of string. But isnt this too much overhead?<br /><br />Second, you can use a private variable List. Then expose it using a property getter. Does the framework support this?<br /><br />Third, declare a private variable of string[] and expose it using a property getter. This has two drawbacks: each time an array is getted, it is copied instead of referenced. Also, databinding can throw exceptions when not initialized.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, January 09, 2008</h2><P>I use a private variable List(Of String) and then expose it using a property getter. </P>
<P>Joe</P>
<P><BR>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>KKoteles replied on Wednesday, January 09, 2008</h2><P>Ruudjah,</P>
<P>Look in Rocky's book for NameValueListBase.&nbsp; I think that is the object you are looking for.&nbsp; It provides an implementation of ReadOnlyBindingList which supports read-only name-value pairs.&nbsp; </P>
<P>If you need more than a simple name-value pair, then I recommend you implement a ReadOnlyList of ReadOnlyBase objects (yes, it has more overhead - but you have the ablility to better define the properties of your object).&nbsp; I'm not sure I'd go with your option two or three - at least not if you are trying to work with CSLA and keep its rich feature set.</P>
<P>Ken</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ruudjah replied on Wednesday, January 09, 2008</h2>Thanks for sharing your thoughts.<br /><br />But the datatype I am looking for, is not a name/value pair. It is an unordened list of values. Hence, the NameValueListBase does not apply here, I don't have names to store. Specifically, one property  is a list of ID's referring to data which is out of the scope of the domain.<br /><br />Keeping the CSLA featureset is the goal. The relevance of my question is because of this goal. In other words, to keep the CSLA features, do I need to implement solution 1, or is two also sufficient (three is inferior in my eyes)?<br /><br />I do not need any rules or authorization on the property mentioned. But I do have other properties which are unordened lists which muight behave different (rules &amp; authorization applied).</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>KKoteles replied on Friday, January 11, 2008</h2><P>Ruudjah,</P>
<P>I guess it boils down to whether the list of values would constitute an 'object' or not.&nbsp; If it is actually an object itself, then I would lean toward what I mentioned originally - ReadOnlyList with&nbsp;ReadOnlyBase objects.&nbsp; However, if the list is merely a property of your object then your option 2 / JoeFallon1's recommendation should work just fine.&nbsp; Since the list would be a property and not an object, you are not losing any of CSLA's features in anyway.</P>
<P>Sounds like the design choice is yours.&nbsp; Your core object can even handle the rules / authorization functionality for the property for you (even if the distinction is a little fuzzy about whether what you are really exposing is a 'property' or an object)&nbsp;- although you might need to get a little fancier to make sure it is processed correctly.</P>
<P>Ken</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
