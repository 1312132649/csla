<html><header><title>How do I....Object Graph -&gt; WCF Service -&gt; External Web Service?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How do I....Object Graph -&gt; WCF Service -&gt; External Web Service?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11783.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Phlar posted on Friday, January 11, 2013</h2><p>
<p><span>Hi
All,</span></p>
<p><span>I am not really sure how to
implement this (Business Rule, CommandBase object, other). &nbsp;I have an
object graph residing on the client machine.&nbsp;
I need to communicate with an external web service from the WCF
application server in order to submit &amp; receive a response.&nbsp; How do I accomplish this in CSLA.NET.</span></p>
<p><span>It&rsquo;s
technically not a business rule as this only need to done when the user selects
the appropriate menu option.&nbsp; I thought
the CommandBase class would be an option but I am not sure how the object graph
is marshaled to the application server for the DataPortal_Execute to reference
for the web service call.&nbsp;</span></p>
<p><span>The main purpose is to obtain a persons FICO score in our scenario.</span></p>
<p><span>Thank you,</span></p>
<p>Phlar</p>
</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Friday, January 11, 2013</h2><p>Like, Click a &quot;Show FICO Score&quot; checkbox (perhaps bound to a BO property)</p>
<p>In propertyhaschanged, do an command call and then LoadProperty+OnPropertyChanged or SetProperty the FICO score property of the BO - ideally asynchronously done, you can kick up a spinner by setting some kind of IsFicoScoreLoading property on the BO and bind a UI element to it (since it&#39;s a WCF service call - can give responsiveness back to the client and show that &quot;it&#39;s in process&quot;.</p>
<p>That&#39;s one option if I understand you correctly.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Phlar replied on Monday, January 14, 2013</h2><p><div style='padding-left: 50px;background-color:silver'><b>skagen00<br></b></p>
<p>Like, Click a &quot;Show FICO Score&quot; checkbox (perhaps bound to a BO property)</p>
<p>In propertyhaschanged, do an command call and then LoadProperty+OnPropertyChanged or SetProperty the FICO score property of the BO - ideally asynchronously done, you can kick up a spinner by setting some kind of IsFicoScoreLoading property on the BO and bind a UI element to it (since it&#39;s a WCF service call - can give responsiveness back to the client and show that &quot;it&#39;s in process&quot;.</p>
<p>That&#39;s one option if I understand you correctly.</p>
<div style="clear:both;"></div>
<p></div></p>
<p>It is more of a menu event being triggered but similar concept. &nbsp;Can you provide a sample of using the Command call (which I am assuming you mean using the Command object inheriting CommandBase&lt;T&gt;). &nbsp;I am assuming it should be as easy as implementing a property on the CommandObject and assigning it the object graph (or portion of it we require) in the BeforeServer() method.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Sunday, January 13, 2013</h2><p>Assuming that you do not need the entire object graph to call the external web service, <br />I would create a separate CommandObject (from CommandBase) with the required data -<br /> call the service in DataPortal_Execute method and return the output.&nbsp;</p>
<p>You _could_ send the entire Person object over to the server - just make sure that you use a &quot;managed property&quot; in the command object for Person.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Phlar replied on Monday, January 14, 2013</h2><p><div style='padding-left: 50px;background-color:silver'><b>JonnyBee<br></b></p>
<p>Assuming that you do not need the entire object graph to call the external web service, <br />I would create a separate CommandObject (from CommandBase) with the required data -<br /> call the service in DataPortal_Execute method and return the output.&nbsp;</p>
<p>You _could_ send the entire Person object over to the server - just make sure that you use a &quot;managed property&quot; in the command object for Person.</p>
<div style="clear:both;"></div>
<p></div></p>
<p>Is there any good examples of properly utilizing this object? &nbsp;I am assuming the client will create an instance of this class utilizing the new keyword and pass in the appropriate items in the constructor to populate the properties. &nbsp;Then it should perform the execute on that object.</p>
<p>Is that basically it or are there more things to consider/handle?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Monday, January 14, 2013</h2><p>I obviously don&#39;t know the exact scenario, but here&#39;s an example you can tweak as needed.&nbsp; In our case, we often times use &quot;Lookup&quot; read-only objects instead of command objects / both such things could work.</p>
<p>Below, we generally code a synchronous and an asynchronous parallel with .NET and Silverlight, respectively.&nbsp; We just never did get comfortable with writing asynchronous tests and settled into this sort of mechanism.</p>
<p>In PropertyHasChanged of the BO -</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp; else if (property == ShowFicoScoreProperty)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // If the Organization&#39;s Id has been set, assign the name and Id as necessary.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bool showFico = ReadProperty(ShowFicoScoreProperty);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!showFico)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Clear out FICO info (in our cases, we&#39;re basically loading name, address, etc - of a related record - our ShowFicoScoreProperty is more analogous to setting a &quot;contact Id&quot; and seeing the contact&#39;s name,&nbsp;title, etc - load&nbsp;into the&nbsp;organization&nbsp;record as read-only information.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />#if SILVERLIGHT<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FicoScoreLookup.Lookup(personId,&nbsp;&nbsp;&nbsp; //&nbsp;FicoScoreLookup would just be a readonlybase in our case, command&nbsp;would work too.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (o, e) =&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (e.Error != null) throw e.Error;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetFicoScoreInformationFromLookup(e.Object);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });<br />#else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetFicoScoreInformationFromLookup(FicoScoreLookup.Lookup(personId));<br />#endif<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p><br />SetFicoScoreInformationFromLookup could be common sets/loads/OnPropertyChanged calls, etc - to take the lookup RO properties and do whatever is needed to the current object to load and raise necessary property changed events.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
