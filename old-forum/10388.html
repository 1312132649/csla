<html><header><title>Copy / Duplicate child BO</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Copy / Duplicate child BO</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10388.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ksavoie posted on Thursday, May 19, 2011</h2><p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">I&#39;ve been ask by my client to add a &quot;duplicate&quot; function to my windows form application in VB.NET 2005, using CSLA 2.</span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">I&#39;m looked into the copy of the object.&nbsp; I tried to use the following code, but it&#39;s not doing what I need.&nbsp; </span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">Public Shared Function NewCost(ByVal oldCost As Customer) as Cost<br />&nbsp;&nbsp; Return CType(DataPortal.Create(New CopyCriteria(oldCost)), Cost)<br />End Function</span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">&lt;Serializable()&gt;<br />Private Class CopyCriteria<br />&nbsp;&nbsp; Public OldCost as Cost<br />&nbsp;&nbsp; Public Sub New(ByVal oldCostas Cost)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.OldCost = oldCost<br />&nbsp;&nbsp; End Sub<br />End Class</span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">I have a one Contract, with a list of Cost.&nbsp; I want to be able to duplicate the Contract Information and the first Cost, so CostID = 0.</span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">How would I duplicate/copy only the information of the CostID = 0?&nbsp; I tried to find a solution online, but without success.</span></p>
<p><span style="font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:black;font-size:9pt;">Can anybody help me with this one?&nbsp; Examples of code would be great.</span></p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>ajj3085 replied on Thursday, May 19, 2011</h2><p>Are you trying to duplicate the data first, then return an instance, or duplicate an instance the user is currently looking at?</p>
<p>If its the former, you probably want to go with a command object that simply copies the rows in the database, and returns the new objects id.</p>
<p>If you&#39;re after the latter, create a duplicate instance method.&nbsp; The method should be fairly straight forward, the first thing it will do is Clone itself, then you&#39;ll need to set all the primary key values in your objects to null or empty or whatever.&nbsp; Ensure each item in the graph calls MarkNew, then you may want to run rules on all instances again.</p>
<p>At that point you can present the &quot;new&quot; object to the user, allowing them to edit and then save the new object.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>ksavoie replied on Friday, May 20, 2011</h2><p>thanks Andy,</p>
<p>I&#39;ll try your second option.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
