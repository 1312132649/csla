<html><header><title>Child Object Needs to update other children</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Child Object Needs to update other children</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1550.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Norty posted on Friday, October 20, 2006</h2><P>Using CSLA2.1</P>
<P>I have an object (Inherits BusinessBase), which contains a collection of child objects (Inherits BusinessListBase).&nbsp; Each child object inherits BusinessBase.</P>
<P>My object is bound to a form, with the child collection bound to an editable datagirdview.&nbsp; One of the properties of the child object is a boolean (check box in datagridview), and can be selected by the user.</P>
<P>However, this property can only be true for 1 of the child objects at any given time.&nbsp; Is there any way for the child object&nbsp;to&nbsp;notify its parent collection to loop through all its children and take the necessary action?</P>
<P>Regards</P>
<P>Des Norton</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Friday, October 20, 2006</h2>Your child object can listen to the ListChanged event on the grandchild list.&nbsp; If the type of change is ItemChanged, the property that changed will also be included.&nbsp; If the boolean property changed and its value is true, the child object loops through its grandchildren and sets the boolean property to false if it is not already false.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Norty replied on Monday, October 23, 2006</h2><P>Thanks Chris <img src="/emoticons/emotion-2.gif" alt="Big Smile [:D]" /></P>
<P>Works great.&nbsp; Implemented slightly differently, though.</P>
<P>Loop through grandchildren, adding up number of true properties.&nbsp; Set shared Grandchild.Property&nbsp;"NumberOfSelectedItems".&nbsp; Custom validation rule enforces that shared property=1.</P>
<P>Possibly slightly more overhead, but the collection currently has 6 grandchildren, unlikely to ever reach double digits.&nbsp; Also ensures a more consistant GUI.&nbsp; User is shown all "Issues" and required to fix them before saving.</P>
<P>Regards</P>
<P>Des Norton</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
