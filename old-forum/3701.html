<html><header><title>Re-using an Editable Child object in multiple projects/assemblies</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Re-using an Editable Child object in multiple projects/assemblies</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3701.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>xxxJasonxxx posted on Friday, October 12, 2007</h2><P>Design question...<BR><BR>I have an "Editable Child" object (AddressBookEntry) in one of my projects that I've realized I should&nbsp;re-use in several other existing projects/assemblies.&nbsp; The problem is that "Editable Child" objects have their factory methods marked as "Friend", which makes it so objects in other projects/assemblies can't get at them.&nbsp; <BR><BR>I considered the following solutions...<BR>&nbsp;&nbsp; - Converting it to an "Editable Root" object.....but decided against it because on the UI screens it is always edited as part of the parent entity (think transaction implications).&nbsp; <BR>&nbsp;&nbsp; - Changing the editable child's factory method from Friend to Public.....but this seems dangerous because it opens them up to misuse or abuse.&nbsp; <BR>&nbsp;&nbsp; - Making a copy of the&nbsp;editable child&nbsp;and put one in every project that wants to use it.....but this seems&nbsp;like it would&nbsp;create a lot of unnecessary maintenance.&nbsp; </P>
<P>How would you guys handle this situation?<BR><BR>Jason</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xxxJasonxxx replied on Friday, October 12, 2007</h2><P>Or...</P>
<P>If my question is unclear or I've misunderstood some key CSLA concept, please let me know.</P>
<P>Jason</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Saturday, October 13, 2007</h2><P>I would not change CSLA or the way the BO is supposed to work.</P>
<P>I would copy it into the new project so if changes are required you don't have to be concerned with affecting other projects.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>robert_m replied on Sunday, October 14, 2007</h2><P>One other possible solution might be to&nbsp;create classes in other asemblies that inherit (without adding any additional functionality)&nbsp;from your EditableChild. Inherited classes could then still have internal (friend) factory methods and you avoid code duplication. You would just have to promote few private thing in your base class to protected...</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xxxJasonxxx replied on Monday, October 15, 2007</h2><P>Using the inherited classes is a very interesting idea.&nbsp; I'm going to play around with that today.</P>
<P>If anyone has been down that road already and run into any problems, please post.&nbsp; I'm specifically wondering if there will be any effect on PropertyChanged events and things serializing correctly.</P>
<P>Thanks,</P>
<P>Jason</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xxxJasonxxx replied on Monday, October 15, 2007</h2><P>I've been playing with the inheritance approach.&nbsp; I have a base Address object in one project and an inherited Address object in a different project.&nbsp; The factory method ("Get") of the inherited Address basically calls the factory method of the base Address.&nbsp; When I run the code and it gets to the&nbsp;factory method, I am getting an error that it cannot convert from one type of object to another (from the base Address to the inherited Address).&nbsp; I tried wrapping it in "CType" and "DirectCast" but that didn't help.&nbsp; I assumed it would be able to convert back and forth from base class to inherited class, but it can't.&nbsp; Does anybody have any idea what is happening and how I can fix this?</P>
<P>Jason</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Monday, October 15, 2007</h2><P>I have been down that road and you can't get there from where you are.</P>
<P>I am 99% sure you can't call the Base factory methods.</P>
<P>You should probably build new ones in your derived class which return the&nbsp;newly derived&nbsp;type.</P>
<P>The factory methods will&nbsp;call DataPortal_XYZ and then your derived class will use the implementation in your Base class to do the actual work.</P>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, October 16, 2007</h2>That's actually what I do as well; the base class provides a protected InsertSelf, UpdateSelf, etc&nbsp; and the subclasses have their DP_I or whatever call the base implementation.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xxxJasonxxx replied on Tuesday, October 16, 2007</h2><P>Ok, so if I'm understanding you guys correctly....</P>
<P>The subclasses should have their own factory methods, constructors, and data access methods.&nbsp; And the subclasses' data access methods should call the data access methods of the base class.</P>
<P>That sound right?</P>
<P>I'll play around with it more today.&nbsp; Thanks - I really appreciate the help.</P>
<P>Jason</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xxxJasonxxx replied on Tuesday, October 16, 2007</h2><P>Yep.....that did it.&nbsp; It is working now.&nbsp; Thanks!</P>
<P>The only thing that concerns me is that I had to use the "Shadows" keyword on a couple of the methods inside the subclasses - methods like "Insert" and "Update" that were duplicated inside both the base class and subclasses.&nbsp; The documentation I read on the "Shadows" keyword was somewhat confusing and left me wondering if that was an ok thing to do.&nbsp; </P>
<P>Is using "Shadows" keyword in this situation a problem or bad practice?<BR><BR>(maybe one of you guys can explain "Shadows" more clearly than Microsoft does)</P>
<P>Thanks,<BR><BR>Jason</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, October 16, 2007</h2>Sounds like you have a naming conflict.&nbsp; Shadows breaks encapsulation, so you shouldn't really ever use it.&nbsp; I'd rename the conflicting members to correct this problem.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
