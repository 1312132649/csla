<html><header><title>Apply validation on specific button press</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Apply validation on specific button press</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2048.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>GrullonM posted on Friday, December 29, 2006</h2><P>I am working on an application that has&nbsp;<U>two</U> submit buttons.</P>
<UL>
<LI>One is a SAVE button 
<LI>The second on is a SUBMIT button</LI></UL>
<P>The save button only requires an email field to be filled. The purpose of this button is to allow end users to start filling out the form and if they want to finish later, they can hit the SAVE button and the info will be saved in the database.</P>
<P>The SUBMIT buton on the other hand, makes sure that 90% of the values on the form are filled out.</P>
<P>I guess the question is how can I call the validation rules only when the SUBMIT button has been pressed? Do I create a separate Sub Procedure for this button, or maybe a second object? How about custome rules?</P>
<P>Thanks,</P>
<P>Miguel</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Friday, December 29, 2006</h2>Is this a Windows or web application?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>GrullonM replied on Friday, December 29, 2006</h2>Sorry... it is a web application!</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Saturday, December 30, 2006</h2>I would suggest adding an additional property called AllowSave.&nbsp; When this property is set to true, ValidationRules.CheckRules is called and the validation rules detect this and return true regardless of whether the corresponding properties are set.&nbsp; Only Email would ignore AllowSave as it is required even when you are saving.&nbsp; Inside your DataPortal_xyz methods, you set _allowSave back to false.&nbsp; You then have two scenarios:<br><ul><li>Save is clicked: AllowSave is set to true and the object is saved if it has a valid email address.</li><li>Submit is clicked: The validation is already running as normal so just return any problems with the validation.<br></li></ul></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DansDreams replied on Saturday, December 30, 2006</h2><P>I thought I read that the latest CSLA had a new feature of two levels of broken rules.&nbsp; Save would be allowed if there were no errors, while Submit would have a more strict requirement of no warnings either.</P>
<P>Or am I confused with the DevExpress error provider control which has multiple levels?&nbsp; After yesterday my head is spinning.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
