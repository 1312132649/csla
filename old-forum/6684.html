<html><header><title>Data Access Layer for any Database</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Data Access Layer for any Database</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6684.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>kam_csla posted on Thursday, March 26, 2009</h2><P>Hi,</P>
<P>i use asp.net 2.0, csla.net framework and oracle database.</P>
<P>just wondering, what will be the changes if the application should work irrespective of the type of database.</P>
<P>It's should be like aspx--&gt;aspx.cs--&gt;class1.cs--&gt;DataAccessLayer--&gt; any database (oracle, sql server, ms access etc)</P>
<P>Thanks,</P>
<P>Kam.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong replied on Thursday, March 26, 2009</h2>Use an ORM ? :)<br /><br />There are differend ORM's on the market, just go and google for it.<br /><br />- NHibernate seems to be populair and it's free.<br />- I personaly like Opf3, but then u've to pay a bit.<br /><br />General rule:<br />Don't use oracle packages or any intellegent code in mssqlserver stored procs if u want to be able to switch database vendor.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kam_csla replied on Thursday, March 26, 2009</h2>Thanks for the info. But&nbsp; we can't just go for a different frame work.&nbsp; Just wanted to know about the changes, that i need to make in the data access layer to handle different databases.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Thursday, March 26, 2009</h2><P>There are many differences in the SQL dialects understood by various backend databases. </P>
<P>They differ in what operators they support, join syntax, procedure call syntax, delimiters used for field names, etc. </P>
<P>Heck, Microsoft SQL Server and SQL Server Compact Edition&nbsp;even use a different format for the TOP predicate -- one is TOP nnn and the other is TOP(nnn), so there&nbsp;can&nbsp;be variations even from the same vendor. </P>
<P>This is the motivation to use an ORM&nbsp;(which can be used as just a DAL under CSLA) -- someone else has gone to the trouble to provide a mechanism that offers some independence from the idiosyncrasies of the back-end database. </P>
<P>You can of course do all this in your own DAL, but you're duplicating something that has already been done. </P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, March 26, 2009</h2><P>I discuss some solutions to this (at a design level) in Chapter 18 of the new 2008 book.</P>
<P>If you use the ObjectFactory model, you can just create a different set of factory objects for each type of database.</P>
<P>If you have your DataPortal_XYZ methods invoke an external DAL assembly, you can make that pluggable (using dynamic type loading and interfaces or reflection) and have a different DAL for each type of database.</P>
<P>Or you can use something like an ORM, where the data framework has done the work of abstracting the different types of database.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, March 27, 2009</h2>If you design your BOs to use the ADO.Net interfaces (like IDataReader, etc.) then the impact on your application is zero when you switch database vendors. Naturally your DAL must return the correct type of IDatareader depending on some configuration setting: SQL Server or Oracle for example.<br /><br />I used to support both and finally got rid of Oracle support but my app still supports it because I still use the interfaces.<br /><br />As of version 8, I think, Oracle SQL syntax was extremely close to SQL Server. For any differences in syntax I just branched my code to produce the correct SQL based on the same config setting.<br /><br />This technique worked just fine for years. We had some major clients using Oracle databases with our product. We convinced them to move to SQL Server so we could lower our testing costs. They wanted to free up Oracle licenses for other projects so it was a win-win.<br /><br />Joe<br /><br />Joe<br /></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
