<html><header><title>Does Save raise any event before proceeding with save</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Does Save raise any event before proceeding with save</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8723.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav posted on Thursday, March 25, 2010</h2><p>In SL, I need to do some last minute things to the object AFTER the user clicks the Save button.&nbsp; Since the CslaDataProvider directly invokes the Save method, is there an event raised that I can use?</p>
<p>Jav</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>ajj3085 replied on Thursday, March 25, 2010</h2><p>This probably isn&#39;t what you want to hear, but the CslaDataProvider is no longer the recommended approach, and this shortcoming I think is a good reason why.&nbsp; The solution would be to move to a MVVM implemention, and you should be able to do this in the ViewModel.&nbsp; I&#39;m not sure I really see any other way though.. maybe someone else does?</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>Jav replied on Thursday, March 25, 2010</h2><p>Thanks Andy.&nbsp; After posting my question I realized that ultimately the Save operation has to go through my DataPortal_xyz methods.&nbsp; What I need to do to my object can easily be done there, just before I call the AddParameters() method.</p>
<p>I have not looked into the MVVM approach because of time constraints in getting this project finished on time, and this issue would not prompt me to change.&nbsp; But are there any other compelling reasons to go to MVVM while using Csla?</p>
<p>Jav</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, March 25, 2010</h2><p>Ah, well if you can do it in the DP_xyz methods, that&#39;s much better.</p>
<p>Better testability is one of the main reasons, as is eliminating code-behind from your Xaml files.&nbsp; Then there are things you&#39;d want to do but can&#39;t, because the DataProvider limits you.&nbsp; Oh, and MS is quietly dropping support for it, as its not utilized in VS2010.&nbsp; <img src="http://forums.lhotka.net/emoticons/emotion-1.gif" alt="Smile" /></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Thursday, March 25, 2010</h2><p><div style='padding-left: 50px;background-color:silver'><b>Andy<br></b></p>
<p>&nbsp;Oh, and MS is quietly dropping support for it, as its not utilized in VS2010.&nbsp; <img src="http://forums.lhotka.net/emoticons/emotion-1.gif" alt="Smile" /></p>
<p style="CLEAR:both;"></div></p>
<p style="CLEAR:both;">Okay, now you are scaring me.&nbsp; <img src="http://forums.lhotka.net/emoticons/emotion-1.gif" alt="Smile" /><br />Can you suggest a quick route to plugging in a minimal MVVM into an ongoing project - just something with the smallest footprint.&nbsp; I tried educating myself but the plethora of info out there is enough to turn one&#39;s stomach.&nbsp; Thanks</p>
<p style="CLEAR:both;">Jav</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Thursday, March 25, 2010</h2><p>Technically you wouldn&#39;t have to go completely MVVM to be safe. </p>
<p>The ViewModel&lt;T&gt; base class in 3.8 and higher is actually very similar to the CslaDataProvider in many ways, and switching from a data provider to a ViewModel&lt;T&gt; subclass is probably not that big a mental adjustment, nor would it have huge impact on your code.</p>
<p>The complexity of MVVM comes in when you say that you want to enable testability of your viewmodel code. That decision imposes a great many extra constraints on your code and how it is designed and implemented. I generally think those constraints are good, but they&#39;d almost certainly have a major impact on existing code. </p>
<p>I personally go further and suggest that there should be zero lines of code-behind. That&#39;s not a goal of MVVM, but I think it should be a goal of any XAML-based app.</p>
<p>However, to come back to your situation with existing code and a tight schedule, it might be worth exploring the use of ViewModel&lt;T&gt; subclasses in place of your data provider controls. That change shouldn&#39;t require a tremendous effort, and even this small change can provide some pretty nice benefits - especially in WPF, but also in Silverlight.</p>
<p>The simplest ViewModel subclass is pretty simple:</p>
<p>public class CustomerViewModel : ViewModel&lt;Customer&gt;<br />{<br />&nbsp; public CustomerViewModel()<br />&nbsp; {<br />&nbsp;&nbsp;&nbsp; BeginRefresh(&quot;NewCustomer&quot;);<br />&nbsp; }<br /><br />&nbsp; public CustomerViewModel(int id)<br />&nbsp; {<br />&nbsp;&nbsp;&nbsp; BeginRefresh(&quot;GetCustomer&quot;, id);<br />&nbsp; }<br />}</p>
<p>This is for Silverlight. If you are doing WPF the BeginRefresh() calls could (optionally) be DoRefresh() which is synchronous.</p>
<p>Either way, when the refresh operation is complete the Model property is automatically updated with the new business object - just like the Data property is updated in a data provider.</p>
<p>The big difference is all the nice protected virtual methods you can override to find out about errors, that refresh is complete, save is complete and so forth. And all the public properties like CanSave, CanCancel and so forth - all designed for easy binding to UI elements so they can enable/disable/collapse as appropriate.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Friday, March 26, 2010</h2><p>Thanks Rocky.&nbsp; This was of&nbsp;great help.&nbsp; I will need to study the MVVM Demo in the 3.8.2 Samples to get a good grasp of what goes where, for example the DataBinding expressions and how to make the Save and Cancel calls.&nbsp; As I recall, in one of the SL Videos you mentioned something about the topic - or may be I am just imagining it.&nbsp; I also seem to recall that you had a couple of blogs about the topic.</p>
<p>Jav</p>
<p>&nbsp;</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
