<html><header><title>Problem overriding IsDirty</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Problem overriding IsDirty</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2388.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>kilroy posted on Tuesday, February 20, 2007</h2>All:<br><br>I'm having a time overriding IsDirty in a root BO derived from BusinessBase&lt;T&gt;. This object contains, as do all real-world BOs, other objects, and to check the IsDirty flag of this object I must override IsDirty. Problem is, my base.IsDirty always returns true, no matter what. Here is the code for the override:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public override bool IsDirty {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return (base.IsDirty || (mvarDCSEContact != null &amp;&amp; mvarDCSEContact.IsDirty) ||<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (mvarStateContact != null &amp;&amp; mvarStateContact.IsDirty) || mDefendants.IsDirty ||<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mPlaintiffs.IsDirty || (mvarOrders != null &amp;&amp; mvarOrders.IsDirty) || <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (mvarChildren != null &amp;&amp; Children.IsDirty) || mvarAPAID != 0 || mvarTechID != 0);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br><br><br><br>Here is the update procedure for the object:<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; protected override void DataPortal_Update() {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using (NpgsqlConnection cn = new NpgsqlConnection(Program.getConnectionStr())) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cn.Open();<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (IsDirty) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ExecuteUpdate(cn);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MarkOld();<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //update child object(s)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UpdateChildren(cn);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } //using<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>Even after the MarkOld() call, I can inspect the IsDirty property and it shows true. The interesting thing is, I can trace into the property calls, all the way down to BusinessBase.IsDirty, and the _isDirty flag itself is false, but when it returns, the property is True.<br><br>Thanks in advance for any help....<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Tuesday, February 20, 2007</h2>Try removing the override. Maybe it's one of the children that's returning True...<br>How are you fetching the data? directly into the fields or through their properties?&nbsp; If it's the latter, then your object will be marked dirty upon loading.<br><br><br>Andr√©s</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kilroy replied on Tuesday, February 20, 2007</h2>No, none of the children are returning true. I hover my cursor over the base.IsDirty variable and it shows up as true, and when I hover over the others they all return false.<br><br>I'm fetching the data directly into the fields. However, after executing ExecuteUpdate() in the DataPortal_Update method, and calling MarkOld(), it shouldn't matter how the data got there, _isDirty should be false, and the property IsDirty should be false. That is not the case here. If I place a breakpoint right after the MarkOld() call, the busines object's Isdirty property is still true.<br><br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>pat replied on Monday, February 26, 2007</h2><P>I had a similar problem: I found, that the debugger or ide is cheating me in these cases: it shows obviously wrong data. to help me out here, (temporarily to find out what happens exactly) I made&nbsp;one dirty-variable for each business object to find out which is really dirty.</P>
<P>patrik</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
