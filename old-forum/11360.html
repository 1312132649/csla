<html><header><title>Silverlight and CSLA - exception due to server referencing client namespace during fetch!?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Silverlight and CSLA - exception due to server referencing client namespace during fetch!?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11360.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>mtrtm posted on Tuesday, May 15, 2012</h2><p>I have a .Net 4 solution using Silverlight 5 and CSLA 4.3.&nbsp; The included projects:<br /><br />- MyProject (silverlight project that contains silverlight screens)<br />- MyProject.Web (WCF project)<br />- Library (contains csla business objects. Referenced only by MyProject.Web)<br />- Library.Sl (contains links to existing business objects in Library. Referenced only by MyProject)<br /><br />I have configured the silverlight UI project (MyProject) to point to a WCF Portal/host via a service on the WCF Project (MyProject.Web).&nbsp; I can browse the service by finding the .svc file, right clicking -&gt; view in Browser.<br /><br />When the silverlight page loads up, I run the following code:<br /><br />DataPortal&lt;MyMobileObjItem&gt; dp = new DataPortal&lt;MyMobileObjItem&gt;();<br />dp.FetchCompleted += HandleReturnedArgs;<br />dp.BeginFetch();<br /><br />When this code runs, I am getting the following error in the callback EventArgs: System.InvalidOperationException: Object type or assembly could not be loaded (MyProject.Library.MyMobileObjItem, MyProject.Library.Sl...<br /><br />I don&#39;t understand why the error on the server has the &quot;MyProject.Library.Sl&quot; namespace in the error.&nbsp; The only place that namespace exists is in the project reference for the silverlight project, and this error is coming from the server!?<br /><br />I downloaded the CSLA source so I could step through and see that the Csla.Server.Hosts.Silverlight.WcfPortal.Fetch() method is passed a criteria object with a TypeName of MyProject.Library.MyMobileObjItem, MyProject.Library.Sl...<br /><br />Again, why is this receiving the silverlight linked project namespace?&nbsp; The MyMobileObjItem object that should be requested doesn&#39;t include the &quot;.Sl&quot; namespace.&nbsp; <br /><br />I am at the end of my rope - any help would be appreciated.&nbsp; Thanks in advance</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Tuesday, May 15, 2012</h2><p>The assembly names and namespaces for Net and SL must be identical for serialization to work.&nbsp;</p>
<p>So if your Net assembly is called MyProject.Library the that must also be the name of the SL library., not MyProject.Library.Sl...</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mtrtm replied on Tuesday, May 15, 2012</h2><p>Hi Jonny, thanks for the response but I&#39;m not sure what assembly name you are talking about.&nbsp; </p>
<p>The example projects for CSLA always seem to have a &quot;MyProject.Sl&quot; or a &quot;MyProject.Client&quot; silverlight class library project that contains no code at all, just links to the mobile objects (.cs files, in my example MyMobileObjItem.cs).&nbsp; So MyMobileObjItem.cs lives in MyProject.Library, and is added as an existing link in MyProject.Library.Sl project.&nbsp; </p>
<p>In the example projects, this .Sl project is referenced by the Silverlight UI and the example projects all work, so I am not sure what I am doing different.</p>
<p>I never define a namespace of &quot;MyProject.Library.Sl&quot; anywhere - its just an empty project that links files. The classes in this project do NOT have that namespace, they don&#39;t even live in that project and since they are links their namespace in unchanged and the same in both projects.</p>
<p>Can you elaborate on what I am doing wrong?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mtrtm replied on Tuesday, May 15, 2012</h2><p>I have also tried deleting the .Sl project and linking the cs file directly in the Silverlight UI project (MyProject).&nbsp; The only change I see with this is that instead the error contains the namespace is MyProject, not MyProject.Library.Sl.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, May 15, 2012</h2><p>Quite simply:</p>
<p>.NET:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyProject.Library.dll<br />SL:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyProject.Library.dll</p>
<p>The name must be the same in both Net and SL. <br />I assume that your SL assembly name is now MyProject.Library.SL...dll</p>
<p>You must change the assembly name in &quot;Project - Properties&quot; on the SL project to be the same as the .Net project.</p>
<p>If you look at the CSLA source source and assemblies you should see that CSLA has</p>
<p>.NET :&nbsp;&nbsp;&nbsp; Csla.dll<br />SL:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Csla.dll</p>
<p>And in the source the SL project name is Csla.Silverlight and the assemly name in the project properties is just Csla - telling the C# compiler that the compiled assembly should be named Csla.dll.</p>
<p><a href="http://msdn.microsoft.com/en-us/library/f0c12ze9.aspx">How to: Change an Assembly Name (Visual Basic, C#)</a></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>garyoak replied on Wednesday, May 16, 2012</h2><p>But why is name should be identical??? I mean we can import the required namespaces.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Wednesday, May 16, 2012</h2><p>The fully qualified name transferred on the wire and used on the server by the deserializer to create instances of classes contain</p>
<p>&quot;Namespace.Classname, AssemblyName&quot;</p>
<p>Which is why both namespace and &nbsp;assembly name must be identical on both runtimes.&nbsp;</p>
<p>For more info read about AssemblyQualifiedName:<br /><a href="http://msdn.microsoft.com/en-us/library/system.type.assemblyqualifiedname(v=vs.95).aspx">http://msdn.microsoft.com/en-us/library/system.type.assemblyqualifiedname(v=vs.95).aspx</a>&nbsp;&nbsp; and<br /><a title="http://msdn.microsoft.com/en-us/library/system.type.assemblyqualifiedname(v=vs.110).aspx" href="http://msdn.microsoft.com/en-us/library/system.type.assemblyqualifiedname(v=vs.110).aspx">http://msdn.microsoft.com/en-us/library/system.type.assemblyqualifiedname(v=vs.110).aspx</a></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mtrtm replied on Wednesday, May 16, 2012</h2><p>Hi Jonny,</p>
<p>Thanks so much, if I change the namespace of my .Sl project to match that error goes away.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
