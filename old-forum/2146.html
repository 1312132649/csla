<html><header><title>NVL &amp; Combo</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>NVL &amp; Combo</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2146.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>TerryHolland posted on Tuesday, January 16, 2007</h2><P>I am having a few problems with binding a NameValueList object to a combo on a winform.</P>
<P>Just to familiarise myself with NVL I am simply trying to bind my NVL object to my combo using the following</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cboUser.DataSource = clsUser_NVL.GetUser_NVL<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cboUser.DisplayMember = "Name"</P>
<P>When I run my form it the combo has populated with data (there are as many rows as there are in clsUser_NVL) but every row is displayed in the combo as </P>
<BLOCKQUOTE dir=ltr>
<P>Csla.NameValueListBase`2+NameValuePair[System.Int32,System.String]</P></BLOCKQUOTE>
<P dir=ltr>HOw do I overcome this?</P>
<P dir=ltr>Also, Im trying to work through the Project Tracker example and familiarise myselft with DataBinding. When I get to page 487, diagram 9-8 shows the Object datasource Roles with a dropdown to the right of it which should display a menu, but I dont have this.&nbsp; Could anyone shed some light on this?</P>
<P dir=ltr>Thanks</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael Hildner replied on Tuesday, January 16, 2007</h2><P>Terry,</P>
<P>I believe I've read here it's recommended to use drag and drop.</P>
<P>Create a new data source from your NVL object. Change the control type to a combo box, then drag the combo box onto your form. The IDE will create a binding source and put in in the component tray. Also the .DataSource of the combo box will be set to the binding source, the .DisplayMember will be set to "Value" and the .ValueMember will be set to "Key".</P>
<P>I've also done it by hand, though, and honestly I'm not sure if you really need the binding source or not. Here's some code I have</P><FONT size=2></FONT><FONT color=#008000 size=2>// Load all galleries.</FONT><FONT size=2> <BR>_galleries = </FONT><FONT color=#008080 size=2>GalleryNameValueList</FONT><FONT size=2>.GetGalleryNameValueList();<BR><BR></FONT><FONT color=#008000 size=2>// Set properties on the gallery combobox so it uses the<BR></FONT><FONT size=2></FONT><FONT color=#008000 size=2>// galleries NVL (name value list).<BR></FONT><FONT size=2></FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.defaultGalleryFKComboBox.DataSource = _galleries;<BR></FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.defaultGalleryFKComboBox.ValueMember = </FONT><FONT color=#800000 size=2>"Key"</FONT><FONT size=2>;<BR></FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.defaultGalleryFKComboBox.DisplayMember = </FONT><FONT color=#800000 size=2>"Value"</FONT><FONT size=2>;<BR><BR></FONT><FONT color=#008000 size=2>// Set the binding on the combo box so the selected value gets<BR></FONT><FONT size=2></FONT><FONT color=#008000 size=2>// put into the employee gallery FK.<BR></FONT><FONT size=2></FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.defaultGalleryFKComboBox.DataBindings.Add(</FONT><FONT color=#800000 size=2>"SelectedValue"</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.employeeEditableRootListBindingSource, </FONT><FONT color=#800000 size=2>"DefaultGalleryFK"</FONT><FONT size=2>);<BR></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cds replied on Tuesday, January 16, 2007</h2><P>Terry,&nbsp;</P>
<P>I believe your original problem is that you're binding the DisplayMember to the&nbsp;Name property whereas it should be the Value property. And as Michael points out you also need to bind the ValueMember. </P>
<P>Drap and drop is definitely the way to go usually as Michael says, but I remember I have had some issues with VS getting confused with multiple NVL combo boxes on the same form. </P>
<P>Drag and drop works for the first one, but when I try to add another combo box, populated from a&nbsp;different NVL it tries to reuse the same BindingSource component from the first one.</P>
<P>In the end, sometimes it's best to add the BindingSource component yourself and connect it to your project's ObjectDataSource then wire up the properties by hand.</P>
<P>HTH</P>
<P>Craig</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>TerryHolland replied on Wednesday, January 17, 2007</h2>Thanks guys</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
