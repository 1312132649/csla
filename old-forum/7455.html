<html><header><title>CloseWinPart error</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CloseWinPart error</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7455.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>nbx posted on Thursday, August 13, 2009</h2><P>Building first&nbsp;sample application using CSLA and having an exception thrown&nbsp;when closing&nbsp;custom user control, I am using same approach as&nbsp;implemented&nbsp;in ProjectTracker&nbsp; (C# 2005), line which </P>
<P>is having problem is in CloseWinPart method,</P>
<P>MainPanel.Controls.Remove(part)</P>
<P>this is the exception:</P>
<P>"Cannot bind to the property or column EmpName on the DataSource.<BR>Parameter name: dataMember "</P>
<P>my&nbsp; UserControl has proper binding, and everything works fine until I close the control and getting above exception.</P>
<P>Any help / direction would be appreciated. Thanks</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>triplea replied on Friday, August 14, 2009</h2>Could you post a full example (just your user control and a host form) recreating the problem? I have seen this before but cannot recall how I ended up fixing this.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Friday, August 14, 2009</h2>Hi, <br><br>With Windows Forms you should alvays disconnect the BindingSources before you dispose of controls. There is no way you can control the sequence of dispose in Forms/UserControls - so I always create a method called <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void UnbindUI(bool cancel) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>in my forms/controls. <br><br>And you MUST disconnect BindingSources in correct order (reverse order of how you setup databinding). <br><br>What happens is f.ex that:<br>&nbsp; &nbsp; a ComboBox has 2 databindings<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - one for the list of items <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - one for SelectedValue or SelectedText<br>&nbsp;&nbsp;&nbsp; and if the ComboBox loses the list of values while databinding for SelectedXYZ is still active it will actually write the defaultvalue for the datatype of SelectedXYZ to your BusinessObject. <br><br>/jonnybee<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>nbx replied on Tuesday, August 18, 2009</h2>Thanks for your suggestions ...<br /><br />In my case I do proper unbinding, and the sample case is very simple - I have a control with two labels bound to binding source, calling CSLA unbind method, verified that binding source set to null, and still getting this error on trying to remove control from the panel :<br />Panel1.Controls.Remove(part);<br /><br />what's weird is that error message states that it can't bind to the object, but during remove method call ?<br /><br />any chance it is related to CSLA's bindingSourceRefresh ?  I haven't added it to  my project, may be I need it.<br /><br />thanks again.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, August 18, 2009</h2>Hi, <br><br>How do you unbind from the DataSource - and another key information her is that the error makes reference to the field EmpName. Is this one of the fields that are bound to your custom control?<br><br>To me - it seems the problem is that there is still active databindings in your panel/controls. <br><br>/jonnybee<br><br><br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
