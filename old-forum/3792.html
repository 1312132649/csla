<html><header><title>Re: SortedBindingList&lt;T&gt;</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Re: SortedBindingList&lt;T&gt;</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3792.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ozitraveller posted on Saturday, October 27, 2007</h2><FONT size=2>
<P>Hi</P>
<P>Hoping someone can help me, I want to make my list sortable, but I won't know what the type is until runtime.</P>
<P>This doesn't work</P><FONT color=#2b91af size=2>
<P>Type</FONT><FONT size=2> t = _obj.GetType();</P>
<P></FONT>Csla.</FONT><FONT color=#2b91af size=2>SortedBindingList</FONT><FONT size=2>&lt;t&gt; sortedList = </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> Csla.</FONT><FONT color=#2b91af size=2>SortedBindingList</FONT><FONT size=2>&lt;t&gt;(t.GetList(parms));</FONT></P>
<P><FONT size=2>Any ideas?</FONT></P>
<P><FONT size=2>Thanks</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Marjon1 replied on Saturday, October 27, 2007</h2><font face="Arial" size="2">This is the way that generics work, you must know the type at compilation not at run time. <br><br>It is possible to use generics to have T be a type that you can pass through, but this will depend on where you are using the sorted list.<br><br><br></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ozitraveller replied on Sunday, October 28, 2007</h2><P>I would appreciate some help, I'm a but stuck here with the generics.</P>
<P>I'm trying to make a generic search form that I can pass in a ReadOnlyListBase, and have it just work,</P>
<P>======================================================</P>
<P>This is where I started and it worked fine, until I needed to add sorting. Which is where I got lost.</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void LoadData(object[] parms)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (this.resultsDataGridView.DataSource != null)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.resultsDataGridView.DataSource = null;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.resultsDataGridView.DataSource = Microsoft.VisualBasic.Interaction.CallByName(_obj, "GetList", Microsoft.VisualBasic.CallType.Method, parms);</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch (Exception ex)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MessageBox.Show(ex.Message);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Threading.Thread.CurrentThread.Abort();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR></P>
<P>======================================================</P>
<P>Then I thought generics might work better because the SortedBindingList wanted the child object.</P>
<P>What I'm trying to do is pass in the type of object and type of child object, where&nbsp;&nbsp;I have a ReadOnlyListBase:&nbsp;</P>
<P>public class ClientList : Csla.ReadOnlyListBase&lt;ClientList, ClientInfo&gt;<BR>&nbsp;</P>
<P>Then I want to call The GetList method and assign a SortedBindingList of the output to a dataGridView datasource.</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LoadData1&lt;QL.View.ClientList, QL.View.ClientInfo&gt;(QL.View.ClientList, QL.View.ClientInfo, parameterValues);</P>
<P>&nbsp;public static void LoadData1&lt;T, C&gt;(T t, C c, object[] parms)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object o = Microsoft.VisualBasic.Interaction.CallByName(t.GetType(), "GetList", Microsoft.VisualBasic.CallType.Method, parms);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Csla.SortedBindingList&lt;t&gt; sortedList = new Csla.SortedBindingList&lt;t&gt;(o);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.resultsDataGridView.DataSource = sortedList;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</P>
<P>Error&nbsp;1&nbsp;'QuickFind.Library.View.ClientList' is a 'type', which is not valid in the given context<BR>Error&nbsp;2&nbsp;'QuickFind.Library.View.ClientInfo' is a 'type', which is not valid in the given context<BR>Error&nbsp;3&nbsp;The type or namespace name 't' could not be found (are you missing a using directive or an assembly reference?)<BR>Error&nbsp;4&nbsp;The type or namespace name 't' could not be found (are you missing a using directive or an assembly reference?)</P>
<P>&nbsp;</P>
<P><BR>&nbsp;</P>
<P>Thanks</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Marjon1 replied on Monday, October 29, 2007</h2><font face="Arial"><font size="2">The following should work (C# isn't my primary language):<br><font face="Courier New"><br></font></font></font><font face="Courier New" size="2">public static void LoadData1&lt;T, C&gt;(object[] parms)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
object tmpList = Microsoft.VisualBasic.Interaction.CallByName(T,
"GetList", Microsoft.VisualBasic.CallType.Method, parms);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Csla.SortedBindingList&lt;C&gt; sortedList = new Csla.SortedBindingList&lt;C&gt;(</font><font face="Courier New" size="2">tmpList</font><font face="Courier New" size="2">);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.resultsDataGridView.DataSource = sortedList;</font><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br><font face="Arial"><font size="2">The generics portion of the method willl allow you to determine the type, where and when you make the call to this method, and there is no need to actually pass through the list itself as you fetch that yourself. The only other thing that you could do is restrict the types of T &amp; C, but let's make sure this works for you first.The key thing to remember with generics is the T &amp; C in this scendario are types and are to be just like any other type, not as variables.<br><br>Let me know how you go!<br><br><br><br><br></font></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ozitraveller replied on Monday, October 29, 2007</h2><P>Hi Marjon</P>
<P>Thanks for the help.</P>
<P>I've put the change in, and I get the following errors</P>
<P>Error&nbsp;1&nbsp;'T' is a 'type parameter' but is used like a 'variable'&nbsp;<BR>Error&nbsp;2&nbsp;The best overloaded method match for 'Csla.SortedBindingList&lt;C&gt;.SortedBindingList(System.Collections.Generic.IList&lt;C&gt;)' has some invalid arguments&nbsp;<BR>Error&nbsp;3&nbsp;Argument '1': cannot convert from 'object' to 'System.Collections.Generic.IList&lt;C&gt;'&nbsp;<BR></P>
<P>I'm passing in :</P><FONT size=2>
<P>LoadData1&lt;QL.View.</FONT><FONT color=#2b91af size=2>ClientList</FONT><FONT size=2>, QL.View.</FONT><FONT color=#2b91af size=2>ClientInfo</FONT><FONT size=2>&gt;(parameterValues);</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Marjon1 replied on Monday, October 29, 2007</h2><font face="Arial"><font size="2">Here is a method that I'm able to get to compile on my machine, this uses normal reflection instead of the Microsoft.VisualBasic.Interaction.CallByName method that you was using as I didn't have a reference to that in my default C# project. However, this did compile for me.<br><br><font face="Courier New" size="2">&nbsp;&nbsp;&nbsp; public static void LoadData1&lt;T, C &gt;(object[] parms, Type[] paramtypes) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; where T : Csla.ReadOnlyListBase&lt;T,C&gt;<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MethodInfo factoryMethod = typeof(T).GetMethod("GetList", BindingFlags.Static | BindingFlags.Public | BindingFlags.NonPublic, null, paramtypes, null);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T tmpList = (T)(factoryMethod.Invoke(null, parms));<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Csla.SortedBindingList&lt;C&gt; sortedList = new Csla.SortedBindingList&lt;C&gt;(tmpList);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.resultsDataGridView.DataSource = sortedList;<br>&nbsp;&nbsp;&nbsp; }<br><br><font face="Arial">Good luck!</font><br></font></font></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ozitraveller replied on Tuesday, October 30, 2007</h2><P>Thanks Marjon, that compiled for me too.</P>
<P>But I'm still having problems relating to '<FONT face="Courier New" size=2>typeof(T).GetMethod("GetList", ', it' doesn't find the method and factoryMethod&nbsp;therefore is null. I did GetMethods and looped through all the methods and it was there!</FONT></P>
<P><FONT face="Courier New" size=2>Maybe something to do with namespaces.</FONT></P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ozitraveller replied on Tuesday, October 30, 2007</h2><P>Thanks Marjon for the hand.</P>
<P>I just wanted to post what finally worked for completeness.</P>
<P>&nbsp;LoadData1&lt;ClientList, ClientInfo&gt;(parameterValues);</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void LoadData1&lt;T, C&gt;(object[] parms) where T : Csla.ReadOnlyListBase&lt;T, C&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type&nbsp;t = typeof(T);</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MethodInfo methodInfo = t.GetMethod("GetList", System.Reflection.BindingFlags.Static | BindingFlags.Public);</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; T tmpList = (T)(methodInfo.Invoke(null, parms));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Csla.SortedBindingList&lt;C&gt; sortedList = new Csla.SortedBindingList&lt;C&gt;(tmpList);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.resultsDataGridView.DataSource = sortedList;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR></P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
