<html><header><title>How to write a class with dynamic properties</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How to write a class with dynamic properties</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8226.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ambreshgaur posted on Tuesday, December 29, 2009</h2>My data grid has some dynamic columns that changes depending upon critaria chosen....how can i handle such a situation in csla?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>sergeyb replied on Tuesday, December 29, 2009</h2>There is no easy way.  If you know what the max number of columns is, you can just create a number of properties (Prop1, Prop2, etc...) of type of object, then create rules that would understand what each property means in order to enforce proper use input.  Not a clean solution, but it will work.<br /><br />Sergey Barskiy<br />Principal Consultant<br />office: 678.405.0687 | mobile:&#160;404.388.1899<br /><br />Microsoft Worldwide Partner of the Year | Custom Development Solutions, Technical Innovation<br /><br />-----Original Message-----<br />From: ambreshgaur [mailto:cslanet@lhotka.net] <br />Sent: Tuesday, December 29, 2009 5:10 AM<br />To: Sergey Barskiy<br />Subject: [CSLA .NET] How to write a class with dynamic properties<br /><br />My data grid has some dynamic columns that changes depending upon critaria chosen....how can i handle such a situation in csla?<br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, December 29, 2009</h2><P>I've known people that used metadata to create a class in memory, compile it, then use it.&nbsp; I've always wondered if you could do this with Csla.</P>
<P>Not easy, but if you want to pioneer that route, the&nbsp;<A class="reference external" href="http://msdn.microsoft.com/en-us/library/system.codedom.compiler.aspx">System.CodeDom.Compiler</A>&nbsp;and&nbsp; <A class="reference external" href="http://msdn.microsoft.com/en-us/library/microsoft.csharp.csharpcodeprovider.aspx">Microsoft.CSharp.CSharpCodeProvider</A>&nbsp;namespaces would be your friend.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, December 29, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>
<P>I've known people that used metadata to create a class in memory, compile it, then use it.&nbsp; I've always wondered if you could do this with Csla.</P>
<P></div></BLOCKQUOTE></P>
<P>You could do that. I do it with my MCsla prototype for SQL Server Modeling. It is a pain to get up and running (debugging is really hard), but once it is working it is really very cool.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfcdejong replied on Tuesday, December 29, 2009</h2>I posted a simulair question..<br /><br />http://forums.lhotka.net/forums/thread/35669.aspx<br /><br />Read the last reply for the solution i went for.<br />http://forums.lhotka.net/forums/permalink/35669/35669/ShowThread.aspx#35669<br /><br />There is only some more into it if u use dynamic properties on a business object (not a readonly) cause u'll need to include the dynamic properties for checks like IsDirty or when the dynamic property change u'll need to raise a propertychanged event. Event listeners need to be decoupled and re-coupled etc etc..<br /><br />The simple version would be on readonlybase.<br /><br />But it do require an own abstraction layer, but u should always have such an layer :)</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Tuesday, December 29, 2009</h2>One other possibility is to have your object implement ICustomTypeDescriptor, and perhaps have your list class also implement ITypedList. Then you tell the grid you have an arbitrary set of properties, which will work in the case where all the objects in the list have the same set dynamic properties. <br /><br />We do this in our application, but it isn't quite as challenging as what you are asking as the set of extra "dynamic" properties is constant for the duration of the application execution. (There are other wrinkles -- search this forum for ICustomTypeDescriptor and you'll see where I have posted some caveats)</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, December 29, 2009</h2>The trick with dynamic types is that you want them to work with your UI<br />technology of choice. Just adding a dynamic property to a type may or may<br />not make your UI technology actually see that property.<br /><br />This is where things like ICustomTypeDescriptor come into play - so Windows<br />Forms (and WPF) can find your custom properties. But I don't think that<br />exists in Silverlight, and I don't know for sure that it is fully supported<br />by ASP.NET (though it should be, since this is what the DataTable uses).<br /><br />The new DLR capabilities in .NET 4.0 allow some really cool dynamic stuff -<br />but what I don't know is whether any of the UI technologies will actually<br />see the dynamic properties. It is a virtual certainty that the designers<br />won't see them in Visual Studio, since the types wouldn't even exist at<br />design time... So some of the RAD features of VS may be lost in exchange for<br />the dynamic features of types at runtime.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Wednesday, December 30, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>RockfordLhotka:</strong></div><div>...It is a virtual certainty that the designers<br />won't see them in Visual Studio, since the types wouldn't even exist at<br />design time... So some of the RAD features of VS may be lost in exchange for<br />the dynamic features of types at runtime.</div></BLOCKQUOTE><br /><br />Incidentally, this is also one of the major drawbacks I have found to implementing ICustomTypeDescriptor with WinForms.  <br /><br />If you try to use a data source that implements ICustomTypeDescriptor in the designer,  not only does Visual Studio not see the extra dynamic properties, it doesn't even see the "built-in" ones.  So, you can't benefit from anything at design time that would involve discovery of the properties the class implements.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
