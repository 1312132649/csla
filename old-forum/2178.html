<html><header><title>OT: automatically discovering data source structure</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>OT: automatically discovering data source structure</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2178.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell posted on Friday, January 19, 2007</h2>I am looking at building a sort of ORM into my metadata creator.&nbsp; To this end, I would like to find something that would allow me to point it at a data source and it would automatically figure out the tables, foreign keys, stored procedures, XML schema, or whatever else defines that data source's structure.&nbsp; I am thinking about look at NHibernate, but am not sure how to get it to premptively define tables without them being defined in an XML file.&nbsp; CodeSmith has a library that allows you to browse a database's structure, but I would prefer to not force a user of my tool to have a CodeSmith license.&nbsp; The MicroSoft enterprise library has a database class that I will probably also look into.&nbsp; Does anyone have any suggestions?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, January 19, 2007</h2>Well, its not hard to do it yourself.&nbsp; Basically you select from the table you want using a data reader, using the SchemaOnly and KeyInfo parameters.&nbsp; Then you use the GetTableSchema method on the dr, and look at the data it returns.&nbsp; <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Friday, January 19, 2007</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>Well, its not hard to do it yourself.&nbsp; Basically you select from the table you want using a data reader, using the SchemaOnly and KeyInfo parameters.&nbsp; Then you use the GetTableSchema method on the dr, and look at the data it returns.&nbsp; <br></div></BLOCKQUOTE><br>Which is fantastic if you know the tables already.&nbsp; Any insights into a method to do that for more than one ADO.NET provider from a single code base?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Saturday, January 20, 2007</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>Well, its not hard to do it yourself.&nbsp; Basically you select from the table you want using a data reader, using the SchemaOnly and KeyInfo parameters.&nbsp; Then you use the GetTableSchema method on the dr, and look at the data it returns.&nbsp; <br></div></BLOCKQUOTE><br>Thanks for the idea.&nbsp; I did some searching and found that you can get the schema from a OleDbConnection.<br><a href="http://my.execpc.com/%7Egopalan/dotnet/ado_net/ado.net_retrieving_database_metadata.html">http://my.execpc.com/~gopalan/dotnet/ado_net/ado.net_retrieving_database_metadata.html</a><br>So I will do some investigating to see how well discovery of tables, keys and such works.&nbsp; Cheers.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, January 22, 2007</h2>select * from sysobjects where type = 'u'<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Monday, January 22, 2007</h2>Yes, but as far as I know that only works for SQL Server.&nbsp; Anyway, I am pleased to report that your initial suggestion put me on the right track.&nbsp; The example that I linked to in my previous post did exactly what I wanted.&nbsp; It allowed me to get the database, table, column, etc. information without having to write provider specific code (aside from the connection string).<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, January 22, 2007</h2>Opps, I forgot you were trying to be non-sql server specific.&nbsp; Glad the suggestion was still useful though. <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson replied on Friday, January 19, 2007</h2>You may want to check out the MyMeta functionality that comes with the free code generator MyGeneration.&nbsp; It works great within MyGeneration templates (which can be written in C# and VB.NET), so it should likely work in what you're trying to build.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Friday, January 19, 2007</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>Q Johnson:</strong></div><div>You may want to check out the MyMeta functionality that comes with the free code generator MyGeneration.&nbsp; It works great within MyGeneration templates (which can be written in C# and VB.NET), so it should likely work in what you're trying to build.</div></BLOCKQUOTE><br>Thanks, I think something like that is what I am looking for.&nbsp; I will look into it.<br><br>EDIT: Doh!&nbsp; It looks like the license prohibits linking to the .dlls.&nbsp; So the best I will be able to do is generate the tables structure and then consume some metadata objects in my application.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
