<html><header><title>Problem with custom login idea, similar to IsInRole in principal</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Problem with custom login idea, similar to IsInRole in principal</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/244.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tommybouy posted on Thursday, June 01, 2006</h2><P>I am curious what I am doing wrong. I have modified the login process to include getting not only roles but also a list of forms users are able to view that may or may not belong to their role. We have plenty of users that fulfill many roles or may need to do something that their role doesn't include. I created a method called CanViewForm which is similar to IsInRole in that it checks for a string value in a list. The problem is I have created the method as public in the ??principal class and the ??identity class but the method isn't visible using the "<FONT size=2><FONT size=3>Csla.ApplicationContext.User.CanViewForm" format. The IsInRole method overrides a base method whereas mine does not. Is that the cause? </FONT></FONT></P>
<P>Thanks&nbsp;</P>
<P>Tom</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, June 01, 2006</h2>The problem is that you're expecting a property which isn't defined in the IPrincipal interface.<br><br>To get your custom property, you'll need to cast it to your custom principal.<br><br>MyCustomPrincipal prin;<br><br>prin = ApplicationContext.User as MyCustomPrincipal;<br>if ( prin == null ) {<br>&nbsp;&nbsp;&nbsp; throw new ApplicationException( "Principal must be MyCustomPrincipal" );<br>}<br><br>if ( prin.CanViewForm( "MyForm" ) ) {<br>&nbsp;&nbsp; // Do stuff<br>}<br><br>However, if your user must do something, than by definition that action is allowed under his role.&nbsp; If you have a group of users which can do X and Y, and another user in that same role must also do Z, then, by denfiition, you should create another role for that user which can do X, Y and Z.<br><br>HTH<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Tommybouy replied on Thursday, June 01, 2006</h2><P>Thx ajj3085, I probably should have mentioned I'm using VB. However I used DirectCast and it did work. Thank you. In our business so many of our clients have completely different setups depending on their size and we would end up creating roles for basically every separate piece of the app. We are trying to avoid that and this method does seem to work fine. Doing it the other way don't you find the number of roles is almost unmanageable?</P>
<P>Tom</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, June 01, 2006</h2>You may end up with a large number of roles to manage, but I would think having a seperate list of which forms a user can access would make things even more complex.&nbsp; Not only do you have to maintain this list, you also have to figure out the two will interact.&nbsp; <br><br>What if a user gets to a form they can't actually use because they don't have permission to read or write the information the business object presents?<br><br>Just my opinion though; if your method works for you, that's really what matters in the end.<br><br>Andy<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
