<html><header><title>ObjectAuthorizationRules with CanAddNewItem Property</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ObjectAuthorizationRules with CanAddNewItem Property</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9149.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Adam posted on Wednesday, June 30, 2010</h2><p>When using ObjectAuthorizationRules the CanAddNewItem doesn&rsquo;t appear to get updated but when using AuthorizationRules then property CanAddNewItem does get updated and allows the controls to go read-only etc. So the question is how do I get the ObjectAuthorizationRules to work like the AuthorizationRules or is this not possible?</p>
<p><br />I am using CSLA 3.7.0.0 for Silverlight and Silverlight 3 with the language C#</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Wednesday, June 30, 2010</h2><p>I don&#39;t understand what you are asking.</p>
<p>The CslaDataProvider has a CanAddNewItem property. This property&#39;s value is derived based on the per-type authorization rules for the child object type contained within a list.</p>
<p>Per-type authorization rules are added to a business object type in the static AddObjectAuthorizationRules() method. Your code in that method calls static methods on the Csla.Security.AuthorizationRules class to associate roles with the business object type.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Adam replied on Wednesday, June 30, 2010</h2><p>To clarify:</p>
<p><br />I have some object level authorisation rule applied in my business classes: e.g.</p>
<p><br />partial class meta_ServiceProviderList<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [System.ComponentModel.EditorBrowsable(System.ComponentModel.EditorBrowsableState.Never)]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static void AddObjectAuthorizationRules()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Csla.Security.AuthorizationRules.AllowEdit(typeof(meta_ServiceProviderList), &quot;EditMetaData&quot;, &quot;Admin&quot;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Csla.Security.AuthorizationRules.AllowCreate(typeof(meta_ServiceProviderList), &quot;EditMetaData&quot;, &quot;Admin&quot;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Csla.Security.AuthorizationRules.AllowDelete(typeof(meta_ServiceProviderList), &quot;EditMetaData&quot;, &quot;Admin&quot;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; }</p>
<p><br />On a Silverlight page displaying the data for an unauthorized user I would have expected that all of the fields would automatically become read-only (as the whole object is read-only, and the page uses the CSLA PropertyStatus control) but they aren&rsquo;t.&nbsp; i.e. I was expecting each of the properties &ldquo;CanEditItem&rdquo; to be set to false if the user is not authorised to edit the business object as a whole.&nbsp; Similarly I was expecting the &ldquo;add&rdquo; button to be disabled.</p>
<p><br />I have implemented a workaround on the Silverlight page, by putting all of my properties in a &ldquo;ContentControl&rdquo; and binding the IsEnabled to the business Object&rsquo;s &ldquo;CanCreateObject&rdquo; and &ldquo;CanEditObject&rdquo; respectively.</p>
<p><br />Is this by design? &ndash; I was expecting object level authorisation to cascade down to the properties.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, June 30, 2010</h2><p>This is by design - the per-property and per-type rules are essentially independent from each other. Per-type rules are enforced by the data portal and/or your code. Per-property rules are enforced by each business object instance at the property level (and potentially by your code).</p>
<p>In a XAML UI, the PropertyStatus control is typically used to expose the CanRead/CanWrite values on a per-property basis, and your UI controls can bind to a PropertyStatus control to enable/disable based on the permissions for a specific property.</p>
<p>If you want to bind your UI to a per-type rule that&#39;s fine too - you can bind to properties on CslaDataProvider or your viewmodel.</p>
<p>You should be aware that the data provider model is essentially obsolete. Microsoft doesn&#39;t appear to be going in that direction anymore, and CslaDataProvider exists now only for backward compatibility.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
