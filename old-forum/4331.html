<html><header><title>20 seconds to load customer list of 4000 - help !</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>20 seconds to load customer list of 4000 - help !</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4331.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>johnT posted on Monday, February 11, 2008</h2><P>I am a beginner at vb.net and csla for that matter, so I need some very basic idea of how long a customer list of 4000 customers 'should take' to load from a SQL Server database via CSLA list object. Ours is currently taking over '20 seconds', and that's about '10 times longer' then the same amount of data takes to load in the old 'MS Access' application were trying to replace. </P>
<P>The&nbsp;sql server database is on&nbsp;the&nbsp;same&nbsp;workstation as the program etc., so its not our network either. However, we are working with CSLA Ver. 1.1, but I don't think that should cause any speed problems either, should it ?</P>
<P>Any ear marks for basic data loading times you can supply would be greatly appreciated. I'm pretty sure what I have now is way off normal, so&nbsp;any ideas on how to speed things up would be also be great.</P>
<P>thanks</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>webjedi replied on Monday, February 11, 2008</h2><P>Check this post out to see if it helps: <A HREF="/forums/thread/21038.aspx">http://forums.lhotka.net/forums/thread/21038.aspx</A>&nbsp;The long and short of this thread was that the objects were being loaded one at a time instead of through one statement...Not sure there is a connection without seeing any code.</P>
<P>However there were huge performance gains in version 2.1 and higher.&nbsp; So you might want to look into going to at least 2.1...(if you can)</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Tuesday, February 12, 2008</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>webjedi:</strong></div><div>...The long and short of this thread was that the objects were being loaded one at a time instead of through one statement...</div></BLOCKQUOTE></P>
<P>Yes -- when loading lists of objects the implementaton needs some internal methods (not CSLA-specific) to let it populate objects from a IDataReader-type interface. (This should all be happening server-side anyway).&nbsp; CSLA&nbsp; can serialize the entire resulting object list&nbsp;once it has been generated, but doesn't need to be involved in loading each individual object. If you're doing a round-trip per object, performance will be abysmal.</P>
<P>Also, if you can load the fields directly rather than using the Property setters when initially populating the objects, this will also help performance. </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>johnT replied on Wednesday, February 13, 2008</h2><P>Thanks a lot people. The solutions you suggested seemed to have worked great. Our code was loading customer objects one&nbsp;at a time. Thanks to this forums help&nbsp;our applications loading speed for 4800 customers went from&nbsp;a 'v&nbsp;..&nbsp; e ..&nbsp; r ..&nbsp; y .. &nbsp; &nbsp;s .. l .. o .. w.. '&nbsp;&nbsp;35 seconds, &nbsp;'tojust2'&nbsp; !</P>
<P>This forum rocks&nbsp;.....&nbsp; !&nbsp;&nbsp;&nbsp;&nbsp; ;-)&nbsp; </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson replied on Monday, February 11, 2008</h2><P>I am still maintaining CSLA ver 1.1 apps and don't usually see the kinds of performance you're describing here.</P>
<P><U>General database issues</U></P>
<P>The one record at a time possibility mentioned in the other post here should be investigated and ruled out, to be sure.&nbsp; After that, you'll need to look at the&nbsp;SQL or T-SQL techniques you're using to get that resultset of Customers.&nbsp; 4,000 records is not a challenge for SQL Server (any more than it is for Access as you noted), but there are lots of different ways to get them.&nbsp; Do the queries involve a lot of complex joins and filters?&nbsp; Worse still, might you being manipulating Cursors to process them?&nbsp; These are both big performance killers.&nbsp; But if you are doing a fairly simple Select statement against a Customer table (even with a single&nbsp;inner join to, say, an Addresses table), 4000 records should come your way in about half a second more than 20 do.</P>
<P>Are you using ADO.NET or are you just borrowing your ADO code and using the COM-based data access objects?&nbsp; ADO.NET will beat it handily (but even ADO in .NET 1.1 should be doing better than you have described).</P>
<P><U>How are you measuring the time?</U></P>
<P>How are you deciding when the "load" is done?&nbsp; Are you populating a control to display them all?&nbsp; Might there be a problem with the way you are using that control?&nbsp; I can get&nbsp;thousands of records and display them in&nbsp;a DevExpress grid in well under five seconds (and it scrolls them VERY quickly).&nbsp; I really don't know what to expect from the built in datagrid and list controls, though.&nbsp; Are you trying to use a complicated UserControl?&nbsp; Perhaps the code in that control could use some attention.</P>
<P><U>Are you using Data Binding?</U></P>
<P>You mentioned that you're trying to upgrade from an Access-based app.&nbsp; And if that was in VB6 (or earlier! &lt;cringe&gt;), the coding technique probably avoided the then-abysmal data binding techniques.&nbsp; Are you populating an array&nbsp;one record at a time and determining the load time by the time it takes to finish popluating it (with the presumed goal of using Unbound data handling techniques in the UI)?&nbsp;&nbsp;It was&nbsp;popular&nbsp;then&nbsp;to create TWO copies of an array - one for use for editing and the other to provide quick Cancel performance.&nbsp; If there was any attempt at tier separation, you may have had the user interface send a Business Object a 'Get' command, which in turn may have sent the request to a Data Access layer that retrieved a recordset from the data store, populated the array and then passed it back to its caller (the Busn Obj),&nbsp;which would ultimately send&nbsp;it&nbsp;to the UI.&nbsp; </P>
<P>Databinding in .NET is awesome.&nbsp; You can eliminate most of the effort here by simply having your Customers collection's (EditableRootCollection in CSLA 1.1 speak)&nbsp; DataPortal_Fetch routine populate itself and the User Interface merely makes an assignment of that collection of Customers to the .DataSource property of the target UI element (grid, listbox, or whatever).&nbsp; It's VERY fast, flexible, and safe.</P>
<P>I hope one of these suggestions has you looking into the right section of your code.</P>
<P>Regards,</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>johnT replied on Tuesday, February 12, 2008</h2><P>Thanks a lot for all the great info. It will take me a while to try and check it all out, but I will let the forum know how things turn out once we've tried the suggestions.</P>
<P>thanks again</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
