<html><header><title>Paging Cache</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Paging Cache</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1564.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>daleedom posted on Monday, October 23, 2006</h2>I have been working on a paging routine.<br><br>I have a ReadOnlyListBase class defined.&nbsp; I then load only 200 rows into the collection.&nbsp; The idea is to then add more rows to the ReadOnlyListBase Class when the DataGridView needs the data via CellValueNeeded.<br><br>What I have done is create a function in the ReadOnlyListBase class that gets one ReadOnlyBase class.&nbsp; Whenever I call this function (shown Below) I check the collection count against the RowIndex the data grid wants. If I don't have enough rows I go Fetch more.&nbsp; <br><br><blockquote><font size="1"><b><i>&nbsp;</i></b>Public Function GetCase(ByVal RowIndex As Long) As ServiceCaseInfo</font><br><font size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; While RowIndex + 1 &gt; Me.count</font><br><font size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '*** When I Call DataPortal.Fetch it creates/returns a new object ***</font><br><font size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'DataPortal.Fetch(Of ServiceCaseList)(oCriteria)</font><br><font size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Fetch(oCriteria.StatusCode, oCriteria.SearchText, oCriteria.DateColumnName, oCriteria.StartDate, oCriteria.EndDate)</font><br><font size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End While</font><br><font size="1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return Me.Item(RowIndex)</font><br><font size="1">End Function</font><br></blockquote><br>The problem is that CSLA appears
to create a new version of the Class so when it gets to the DataPortal.Fetch routine
the Collection empty.&nbsp; My work around is to call the actual Fetch routine directly.&nbsp; It works, but I am afraid that I am breaking the framework when I do this.<br>
<br>I am really new to CSLA, but from what I've read this behavior is an important feature.&nbsp; So what is the correct solution?&nbsp; What are your thoughts?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, October 23, 2006</h2>If you're not going through the dataportal, then you're probably hurting your chances to move to a physical 3 tier environment later.<br><br>Probably what you need to do is create an instance method on your collection.&nbsp; This method would call the dataportal, giving the criteria for the loads which should be loaded.&nbsp; The results you get back can then be added to the existing collection.<br><br>HTH<br>Andy<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
