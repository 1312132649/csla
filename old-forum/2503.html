<html><header><title>Newbie Question - User Authentication and User Account Validation on Login</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Newbie Question - User Authentication and User Account Validation on Login</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2503.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>JabbaTheNut posted on Saturday, March 10, 2007</h2><P>I am implementing CSLA.NET for the first time.&nbsp;&nbsp;I have a pretty fair handle on it; however, there are a few areas where I still appear to be brain dead.</P>
<P>When a user logs in, I want to authenticate the user as per the book, using custom authentication.&nbsp; However, I also want to validate the user's account against things such as PasswordExpired, MaxFailedLogins, MaxGraceLogins, AccountLockedOut&nbsp;etc.&nbsp;&nbsp;If the user fails authentication or account validation, the user will not be granted access.</P>
<P>I have created an AccountPolicy object that handles the account validation routines and indicates which policies have failed.&nbsp; I use&nbsp;this in my custom identity object.&nbsp; If any policy fails,&nbsp;I set the&nbsp;IsAuthenticated property&nbsp;of the custom identity to false.&nbsp; This is fine for simply denying access at login.&nbsp; However, what I want to do is provide the UI with the reasons the login failed.&nbsp; How do I do this?</P>
<P>Any comments would be appreciated.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Sunday, March 11, 2007</h2><P>I would think you'd want a read-only&nbsp;AccountStatus object that would show all the status information about a user account. If the UI wants this information for whatever reason, it could just go get that object:</P>
<P>AccountStatus status = AcountStatus.GetStatus(username);</P>
<P>So if the login fails, principal.Identity.IsAuthenticated would be false, and the UI could then choose to go get the account status if desired.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
