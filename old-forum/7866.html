<html><header><title>BinaryFormatter to XMLSerializer...  PLEASE HELP!!!</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>BinaryFormatter to XMLSerializer...  PLEASE HELP!!!</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7866.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>MonkeyBoyUK posted on Saturday, October 24, 2009</h2><P>Hi All... I have got a problem when attempting to edit or add values to my objects. It happens when I add or edit an item from within my BusinessListBase object. The error is listed below.</P>
<P>System.Runtime.Serialization.SerializationException was unhandled by user code<BR>&nbsp; Message="Type 'WindowsApplication1.DB' in Assembly 'ICSPartyBeer, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' is not marked as serializable."<BR>&nbsp; Source="mscorlib"<BR></P>
<P>I checked online and Microsoft say it is because the CSLA uses the BinaryFormatter instead of XMLSerializer to serialize the object... </P>
<P>Just wondering if there is a new version which covers this that works with VS2005?</P>
<P>I tried to look into a fix by changing the code in the cs file but it comes up with another error then another one... Seems im not that good yet... Any help that you could offer would be greatly appreciated...</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MonkeyBoyUK replied on Saturday, October 24, 2009</h2><P>P.S. The Microsoft Article where i found this information is as follows : </P>
<P><A href="http://support.microsoft.com/kb/818412">http://support.microsoft.com/kb/818412</A></P>
<P>Many thanks again...</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MonkeyBoyUK replied on Saturday, October 24, 2009</h2><P>Hi All...</P>
<P>Right, Sorted It...</P>
<P>1. Added The Following to the BinaryFormatterWrapper</P><FONT color=#008000 size=2><FONT color=#008000 size=2>
<P>''' </FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;summary&gt;</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>''' Gets a reference to the underlying</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>''' </FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;see cref="XmlSerializer"/&gt;</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>''' object.</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>''' </FONT></FONT><FONT color=#808080 size=2><FONT color=#808080 size=2>&lt;/summary&gt;</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> Formatter() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> XmlSerializer</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Get</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Return</FONT></FONT><FONT size=2> _formatter</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Get</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT></P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2></FONT></FONT>&nbsp;</P>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#000000 size=3>2. Added the Entries into the App.config file to allow the XMLSerializer to be used.</FONT></FONT></FONT></P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>&lt;</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>setting</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2> </FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>name</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>=</FONT></FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>CslaSerializationFormatter</FONT></FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2> </FONT></FONT><FONT color=#ff0000 size=2><FONT color=#ff0000 size=2>serializeAs</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>=</FONT></FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>String</FONT></FONT><FONT size=2>"</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&gt;</P>
<P>&lt;</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>value</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&gt;</FONT></FONT><FONT size=2>XMLSerializer</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&lt;/</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>value</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&gt;</P>
<P>&lt;/</FONT></FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>setting</FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&gt;</P></FONT></FONT>
<P><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#000000 size=3>3. Then in the BinaryFormatterWrapper.vb file, I Changed </FONT></FONT></FONT></P><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>Private</FONT></FONT><FONT color=#000000 size=2> _formatter </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>New</FONT></FONT><FONT color=#000000 size=2> XmlSerializer(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>GetType</FONT></FONT><FONT size=2><FONT color=#000000>(BinaryFormatterWrapper))</FONT></P></FONT>
<P></FONT></FONT>To</P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>Private</FONT></FONT><FONT size=2> _formatter </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>New</FONT></FONT><FONT size=2> XmlSerializer(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>GetType</FONT></FONT><FONT size=2>(BinaryFormatterWrapper))</P>
<P></FONT>and obviously fixed any errors that popped up&nbsp;because of the type change...</P>
<P>When I get a spare to seconds I am gonna make this change&nbsp;more perminent. Would be nice if this is done in the next release unless it has been sorted already...</P>
<P>Great work by the way, Loving the CSLA... Makes everything so much easier...&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Saturday, October 24, 2009</h2><P>I don't know what you are trying to accomplish?</P>
<P>Generally speaking, the XmlSerializer won't work with CSLA .NET objects for several reasons:</P>
<UL>
<LI>It requires a public default constructor, which most CSLA objects don't have</LI>
<LI>It can't serialize read-only properties, which most CSLA objects do have</LI>
<LI>It can't serialize field values, only public read-write properties, so many values just don't get serialized</LI>
<LI>It can't serialize complex types like a Dictionary, which are pretty common, and are used internally to CSLA</LI>
<LI>It doesn't preserve the shape of the object graph - on deserialization you often end up with more objects than you started with</LI></UL>
<P>In the .NET framework there are two categories of serializer: the open XML type, and the .NET type.</P>
<P>The open XML serializers (XmlSerializer, DataContractSerializer, JsonSerializer, etc) are not designed for cloning an object graph with full fidelity. They are designed for converting the public elements of an object graph into a standards-based data stream that can be interpreted by any platform or technology.</P>
<P>The .NET serializers (BinaryFormatter and NetDataContractSerializer) are designed for cloning an object graph with full fidelity. They are generally intended for .NET-to-.NET interactions, though technically the NDCS output is standards based (if anyone but Microsoft was crazy enough to implement the complete standard).</P>
<P>CSLA .NET requires the ability to create a clone of the object graph with full fidelity, and therefore requires the .NET serializers.</P>
<P>If you are trying to implement an open XML interface, you should read Chapter 21 of the <EM>Expert 2008 Business Objects</EM> book, where I discuss the correct way to create that type of interface.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
