<html><header><title>Overriding DataPortal_Fetch in my own Base Class</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Overriding DataPortal_Fetch in my own Base Class</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/136.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai posted on Thursday, May 18, 2006</h2><P>Hi guys.</P>
<P>I tried to implement an override in my own BusinessBase class defined as follows</P><FONT color=#0000ff size=2>
<P>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>abstract</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>class</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>EQBusinessBase</FONT><FONT size=2>&lt;T&gt; : Csla.</FONT><FONT color=#008080 size=2>BusinessBase</FONT><FONT size=2>&lt;T&gt; </FONT><FONT color=#0000ff size=2>where</FONT><FONT size=2> T : </FONT><FONT color=#008080 size=2>EQBusinessBase</FONT><FONT size=2>&lt;T&gt;</FONT></P>
<P><FONT size=2>All my objects are based on this instead of BusinessBase, and this lets me customise/add features wiothout modifying Csla code.&nbsp; Today I tried to do </FONT></P><FONT size=2><FONT color=#0000ff size=2>
<P>protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>override</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> DataPortal_Fetch(</FONT><FONT color=#0000ff size=2>object</FONT><FONT size=2> criteria)<BR>{<BR>&nbsp;&nbsp;&nbsp;do some stuff<BR>}</FONT></P>
<P>But the code never gets hit.&nbsp; Can someone tell me why?&nbsp; Other stuff in the class works fine.</P>
<P>Thanks.</P>
<P>P.S. FWIW, I am trying to get a reference to the name of the DataPortal xyz method currently being executed within the <FONT size=2>DataPortal_OnDataPortalInvoke event of a Business Object, and figured I could store this in the <FONT color=#008080 size=2>ApplicationContext</FONT><FONT size=2>.GlobalContext for want of another way to do this.&nbsp; The event tells you that a xyz method is being excuted, but not which one. This is what I was trying to in the Fetch overrride.&nbsp; If someone could suggest a way to do this then that would be great too.</P></FONT></FONT>
<P>John.<FONT size=2></P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DavidDilworth replied on Thursday, May 18, 2006</h2><P><FONT face=Arial size=2>This may seem like an obvious question, but are you going through one of the standard factory methods and calling the DataPortal ?</FONT></P>
<P><FONT face=Arial size=2>For example:</FONT></P>
<P><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>public</FONT> <FONT color=#0000ff>static</FONT> <FONT color=#008080>AvailableRoom</FONT> GetAvailableRoom(<FONT color=#0000ff>int</FONT> roomId)</FONT></FONT></P>
<P><FONT face="Courier New" size=2>{</FONT></P>
<P><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>return</FONT> CSLA.<FONT color=#008080>DataPortal</FONT>.Fetch&lt;<FONT color=#008080>AvailableRoom</FONT>&gt;(<FONT color=#0000ff>new</FONT> <FONT color=#008080>CriteriaIntIdentity</FONT>(<FONT color=#0000ff>typeof</FONT>(<FONT color=#008080>AvailableRoom</FONT>), roomId));</FONT></FONT></P>
<P><FONT face="Courier New" size=2>}</FONT></P>
<P><FONT face=Arial size=2>Have you stepped through this code and had a break point set in the DataPortal_Fetch?</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai replied on Thursday, May 18, 2006</h2><P>Hi David</P>
<P>Yes I am calling a factory method and I have tried a breakpoint in <FONT face=Arial size=2>DataPortal_Fetch of my BO class.&nbsp; It hits that one OK but not the one in my base class.</FONT></P>
<P><FONT face=Arial size=2>John.</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DavidDilworth replied on Thursday, May 18, 2006</h2><P><FONT face=Arial size=2>So you've got an override for DataPortal_Fetch() in your BO class as well as in your abstract base class (ABC).&nbsp; In that case the method in the ABC will never be called because it will always call the instance method version, which is the one for your BO.</FONT></P>
<P><FONT face=Arial size=2>In the DataPortal_Fetch() override in your BO class you need to explicitly call the&nbsp;method in the ABC.</FONT></P>
<P><FONT face=Arial size=2>Add something like this to your code:</FONT></P>
<P><FONT face=Arial size=2>base.DataPortal_Fetch(criteria)</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai replied on Thursday, May 18, 2006</h2><P>The DataPortal_Fetch in the BOo class is not an override, just a method with that name.&nbsp; The abstract base class has the overrride version.&nbsp; But I think I understand.&nbsp; Why is it that with some classes of BO you seem to need to do an overrride of Fetch&nbsp;whereas with others you don't?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DavidDilworth replied on Thursday, May 18, 2006</h2><P><FONT face=Arial size=2>The DataPortal_Fetch in the BO class <STRONG>should</STRONG> be declared override.</FONT></P>
<P><FONT face=Arial size=2>Otherwise you're hiding the method in the base class.&nbsp; This generates a compiler warning which can be suppressed by using the "new" modifier.&nbsp; Check the MSDN for "new modifier keyword (C#)" in the C# Programmer's Reference.</FONT></P>
<P><FONT face=Arial size=2>Do you not get the compiler warning?</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai replied on Thursday, May 18, 2006</h2>No I don't get that warning David.&nbsp; I have been doing a bit of copy and paste from <A href="http://www.onelittlevictory.com/">http://www.onelittlevictory.com/</A>&nbsp;and if you look at the EditableRoot data access section there it does not have the overrride for Fetch - although that does not mean it is correct!&nbsp; It would make more sense to me if they all had to have override specified.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, May 18, 2006</h2>




<DIV align=left><SPAN class=104523914-18052006><FONT face=Arial color=#0000ff size=2>Ideally though, you wouldn't _override_, but instead you'd 
overload.</FONT></SPAN></DIV>
<DIV align=left><SPAN class=104523914-18052006><FONT face=Arial color=#0000ff size=2></FONT></SPAN>&nbsp;</DIV>
<DIV align=left><SPAN class=104523914-18052006><FONT face=Arial color=#0000ff size=2>private void DataPortal_Fetch(Criteria 
criteria)</FONT></SPAN></DIV>
<DIV align=left><SPAN class=104523914-18052006><FONT face=Arial color=#0000ff size=2></FONT></SPAN>&nbsp;</DIV>
<DIV align=left><SPAN class=104523914-18052006><FONT face=Arial color=#0000ff size=2>That way you can get a strongly typed parameter, rather 
than a parameter of type object that has to be casted by 
hand.</FONT></SPAN></DIV>
<DIV align=left><SPAN class=104523914-18052006><FONT face=Arial color=#0000ff size=2></FONT></SPAN>&nbsp;</DIV>
<DIV align=left><SPAN class=104523914-18052006><FONT face=Arial color=#0000ff size=2>Rocky</FONT></SPAN></DIV>
<DIV align=left>&nbsp;</DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DavidDilworth replied on Thursday, May 18, 2006</h2><P><FONT face=Arial size=2>DOH! Of course Rocky's right and that explains what's going on!</FONT></P>
<P><FONT face=Arial size=2>You're not getting the compiler warning because the method in your BO is an overload not an override.</FONT></P>
<P><FONT face=Arial size=2>And that's also why it never calls the method in the ABC.</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai replied on Thursday, May 18, 2006</h2>Ah!&nbsp; Thanks again for the info guys.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, May 18, 2006</h2><P>The problem is that there's a quirk in the way reflection interacts with generics... It turns out that reflection won't find a method implemented in a base class if that base class is both abstract and generic (which is your case).</P>
<P>I've been working with Ricky Supit on solving this, and there's a prototype solution in cvs for C# at the moment (<A href="http://www.lhotka.net/cslacvs">www.lhotka.net/cslacvs</A>) so you can try that. I think I did the same thing for VB, but I don't recall for sure (the last couple weeks I've been flying so much I'm kind of blurry...).</P>
<P>In any case, you can expect the fix to be in version 2.0.1 (basically a bug fix release) within the next couple weeks.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai replied on Thursday, May 18, 2006</h2>Thanks for the info Rocky, I'll check it out.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
