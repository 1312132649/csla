<html><header><title>&quot;removing items within a foreach isn't reliable&quot; - BrokenRulesCollection.Remove() ?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>&quot;removing items within a foreach isn't reliable&quot; - BrokenRulesCollection.Remove() ?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/497.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>antoan posted on Wednesday, June 28, 2006</h2>The implementation of BrokenRulesCollection makes use of a numerical counter loop instead of foreach   (page 134 of 2005 book) The reason given for this in the method comments iis that "removing items within a foreach isn't reliable". <br /><br /><br />I trying to understand why?<br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Wednesday, June 28, 2006</h2>Because foreach gets an enumerator for the IList you are enumerating over.&nbsp; If you remove an item from the list, you invalidate the enumerator.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Wednesday, June 28, 2006</h2><P>When using foreach, it's a general rule that you're not supposed to modify the collection by removing items within the loop. In this loop, he's removing an item, hence the for loop.</P>
<P>I tried to find a relevant post somewhere but I couldn't find one for you. </P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>antoan replied on Wednesday, June 28, 2006</h2>skagen00 , Brian, <br /><br />Thanks guys, it makes sense now.<br /><br />A</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>HarvDotNet replied on Wednesday, June 28, 2006</h2><P>Use a counter and go from&nbsp;last to&nbsp;first of the collection</P>
<P>For int Counter = Collection.Count() - 1 to 0 Step -1</P>
<P>&nbsp;&nbsp;&nbsp;' Delete selected items</P>
<P>Next</P>
<P>Harvey Sather</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
