<html><header><title>MissingMethodException: Method not found</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>MissingMethodException: Method not found</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5919.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>charles3900 posted on Tuesday, December 02, 2008</h2><P>I have inherited a web-site based on CSLA and never used&nbsp;CSLA before.&nbsp;</P>
<P>I have set up the web-site on Windows Vista / IIS 7.0 (I understand I can't run&nbsp;CSLA with the Cassini server.)</P>
<P>When I run the web-site, I get the following error message:</P>
<P>"MissingMethodException: Method not found"</P>
<P>I have Csla 3.6.0.0 in the GAC and the site builds.</P>
<P>My thanks in advance.</P>
<P>Charles</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, December 02, 2008</h2>Where is the exception occurring?&nbsp; The debugger should break when an exception is hit.&nbsp; Do you have any other details?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>charles3900 replied on Tuesday, December 02, 2008</h2><P>Thanks for the interest. I have actually gotten it two places, one in my own code which I know is there and one in a call to <FONT color=#2b91af size=1><FONT color=#2b91af size=1>DataPortal</FONT></FONT><FONT size=1>.Create.</FONT></P>
<P>However,&nbsp;it is possible&nbsp;that when the debugger listed my own code it was really a problem of my code calling <FONT color=#2b91af size=1><FONT color=#2b91af size=1>DataPortal</FONT></FONT><FONT size=1>.Create.</FONT></P><FONT size=3>
<P><FONT size=3>Note that since I can't run in Cassini, I get the error message in my Internet browser.</FONT></P>
<P><FONT size=3>Does this mean anything to you?</FONT></P>
<P>I assume the&nbsp;<FONT size=1><FONT color=#2b91af>DataPortal</FONT>.Create</FONT> is in the Csla in the GAC which is why I confirmed&nbsp;the Csla&nbsp;was really in the GAC and in my list of references.</FONT></P>
<P>Below is the complete error message from the browser. Let me know what else I can tell you.</P>
<P>[MissingMethodException: Method not found: 'System.Object System.Windows.Threading.Dispatcher.Invoke(System.Delegate, System.Object[])'.]<BR>&nbsp;&nbsp; Csla.DataPortal.get_IsInDesignMode() +0<BR>&nbsp;&nbsp; Csla.DataPortal.GetDataPortalProxy(Boolean forceLocal) +9<BR>&nbsp;&nbsp; Csla.DataPortal.Create(Type objectType, Object criteria) +505<BR>&nbsp;&nbsp; Csla.DataPortal.Create() +73<BR>&nbsp;&nbsp; RHIN.Library.OrganizationList.NewOrganizationList() +29<BR>&nbsp;&nbsp; RHIN.Library.Security.RHINIdentity..ctor() +174<BR>&nbsp;&nbsp; RHIN.Library.Security.RHINIdentity.UnauthenticatedIdentity() +38<BR>&nbsp;&nbsp; RHIN.Library.Security.RHINPrincipal.Logout() +27<BR>&nbsp;&nbsp; ASP.global_asax.Application_AcquireRequestState(Object sender, EventArgs e) in c:\ProjectsVS9\III\RHIN\Portal\Global.asax:142<BR>&nbsp;&nbsp; System.Web.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +92<BR>&nbsp;&nbsp; System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean&amp; completedSynchronously) +64<BR></P>
<P><FONT size=1></FONT><FONT size=1>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, December 02, 2008</h2>Hmm, that's bizarre.&nbsp; It's like it can't find Wpf.&nbsp; Do you have .Net 3.5 installed?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>charles3900 replied on Tuesday, December 02, 2008</h2><P><FONT face=Arial size=1>yes - .NET 3.5 is installed.</FONT></P>
<P><FONT face=Arial size=1>You mentioned wpf - windows presentation foundation? This is a web-site, do I need wpf?</FONT></P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, December 02, 2008</h2>Well, yes and no.&nbsp; Csla detects if it's running in a Wpf application and changes its behavior if it does.&nbsp; It also in other cases will check to see if it's running under Asp.Net using similar code.&nbsp; It seems as if that check is failing in this case... is SP1 of .Net 3.5 installed?&nbsp; I'm not sure if that's a requirement or not.<br><br>Can you attach a debugger to the process to see exactly where things are failing?<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>charles3900 replied on Tuesday, December 02, 2008</h2><P><FONT face=Arial size=1>I don't know if I have SP1. .NET 3.5 shows an install date of 5/13/2008 if that helps.</FONT></P>
<P><FONT face=Arial size=1>I don't know how to attach a debugger to a web-site running from IIS - is this possible?</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, December 03, 2008</h2>Yes, it's possible.&nbsp; You said IIS was hosted on Vista, so you'll have to run VS2008 as an Administrator (right click the shortcut and choose run as administrator).<br><br>Request a page in your browser, then go to Debug -&gt; Attach To Process and find the wp3.exe process.. if there's more than one, try to find the one with Managed Code.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
