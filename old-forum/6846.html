<html><header><title>Child_Insert Parent?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Child_Insert Parent?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6846.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Frazer posted on Friday, April 24, 2009</h2><P>Another novice question:</P>
<P>Using my earlier example, I have an editable root object:</P>
<P>RequestPackage - this object represents a request batch that is created by a user, fulfilled and managed as a aggregate work package.&nbsp; Sample properties would include:</P>
<P>RequestPackageID<BR>UserID<BR>RequestPackageName<BR>Requests&nbsp;&nbsp; &lt;-- this is a list of editable child objects</P>
<P>Then have a Requests object:&nbsp; editable child list of Request</P>
<P>Request:&nbsp; editable child object.</P>
<P>My question is, in the Child_Update method of the Request child object, what should be specified for the parent argument:&nbsp; RequestPackage or Requests?</P>
<P>Frazer</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Marjon1 replied on Friday, April 24, 2009</h2>In the request object the parent would be the Requests list; the Requests list (editable listbase) parent object would be the RequestPackage.<br /><br />Normally as part of an insert/update of a child record it is normal to pass in either the id or parent object itself, of the parent root item so the children can use it to setup foreign key constraints.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Frazer replied on Friday, April 24, 2009</h2><P>Sorry if I am slow on the uptake, but still a bit confused. The use of the word parent is ambiguous to me.</P>
<P>Which is correct in the Request class (child class):</P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>Private</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</FONT></FONT><FONT size=2> Child_Update(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> parent </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> Requests)</FONT></P>
<P><FONT size=2>or</FONT></P>
<P><FONT size=2>Private<FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Sub</FONT></FONT><FONT size=2> Child_Update(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> parent </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> RequestPackage)</FONT></FONT></P>
<P><FONT size=2><FONT size=3>I think the latter, since, as&nbsp;you say,&nbsp;this provides a means to obtain the key of the owning RequestPackage to establish the FK in the database.</FONT></FONT></P>
<P>If I understand the pattern correctly, there is nothing in the code of the Request (child) class which explicitly identifies its parent collection: Requests.&nbsp; Am I correct in this?</P>
<P><FONT size=2><FONT size=3>Frazer</FONT></FONT></P>
<P><FONT size=2>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, April 24, 2009</h2>If you're using FieldManager.UpdateChildren, you can pass whatever you want.  As long as the child has a matching signature, it will work.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
