<html><header><title>Dumb Question/Dumb Problem</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Dumb Question/Dumb Problem</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2006.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>NetStream posted on Tuesday, December 19, 2006</h2>I am trying to create an existing sql table using EditableRootList and Editable Child.&nbsp; Am I using the right objects?&nbsp; I believe I have used these before without problems but now I get this error when I hover over the EditableRootList variable - Exception of type: '{System.TypeLoadException}' occurred.&nbsp; If I try to save this object I get the error - System.NotSupported Exception.&nbsp; I am using CSLA 2.0 and CodeSmith 3.2.&nbsp; What am I missing here?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Tuesday, December 19, 2006</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>NetStream:</strong></div><div>I am trying to create an existing sql table using EditableRootList and Editable Child.&nbsp; Am I using the right objects?&nbsp; I believe I have used these before without problems but now I get this error when I hover over the EditableRootList variable - Exception of type: '{System.TypeLoadException}' occurred.&nbsp; If I try to save this object I get the error - System.NotSupported Exception.&nbsp; I am using CSLA 2.0 and CodeSmith 3.2.&nbsp; What am I missing here?</div></BLOCKQUOTE></P>
<P>If the table already exists, why are you trying to create it?&nbsp;</P>
<P>Don't think it makes a lick of difference which object type you throw at that problem.&nbsp; <BR><BR>I'm guessing you meant something else, but I wasn't able to guess what. :)</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>NetStream replied on Tuesday, December 19, 2006</h2>I have a table in SQL Server that I need to be editable and it doesn't make any difference what combination of objects I choose, I get this same error.&nbsp; My other objects work just fine, but these don't.&nbsp; Am I using the correct BO's or should I use some other combination?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Tuesday, December 19, 2006</h2><P>Sounds like it might be a security problem on the database table.</P>
<P>Are you sure the role you are logged in has the necessary insert, update or delete grants?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>NetStream replied on Tuesday, December 19, 2006</h2>I was hopeful that you were on to something.&nbsp; However, both SQL Server 2000 and 2005 give me the same error no matter which transaction type I choose, even none.&nbsp; I even gave the login system administrator type access and still the same error.&nbsp; </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Tuesday, December 19, 2006</h2>What sql statement are you issuing, and what error message do you get?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>NetStream replied on Tuesday, December 19, 2006</h2><P>I'm selecting the AddMessageList function which executes the GetMessagesAll stored proc.&nbsp; The issue is I do not get an error until I go to issue the MessageList.Save function.&nbsp; If I hover over the messagelist variable, I see the message "mMessage Count=Exception of Type: '{System.TypeLoadException}' occurred."&nbsp; I just created a brand new project with just this set of BO's and get the same message.&nbsp; If I use the child object by itself to return just one row of data from a table, it works just fine.&nbsp; But matched up with this list object, I cannot get it to work.&nbsp; The table is just 3 varchar and 1 date variables and all 4 make up the primary key.&nbsp; I have tried every set that CodeSmith offers and get the same message with each one.&nbsp; These are the calls I make:</P>
<P>1.&nbsp; Private mMessage as DataMessageList</P>
<P>2.&nbsp; mMessage = DataMessageList.AddDataMessageList()</P>
<P>3.&nbsp; mMessage.Add(DataMessage.NewDataMessage("2006-00001", New SmartDate(System.DateTime.Now), "FRNLoad", "Successful"))</P>
<P>4.&nbsp; mMessage.Save()</P>
<P>If I hover over the mMessage before line 2 executes, I get nothing as the value</P>
<P>If I hover over mMessage in line 3 before it executes, I get the above error message.&nbsp; I can single step through the code and not a single exception fires but I still get the above error message.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Wal972 replied on Wednesday, December 20, 2006</h2><P>Just thinking, but if my memory serves me correctly but should it go something like this</P>
<P>Private mMessage as DataMessageList = DatatMessageList.AddDataMessageList()</P>
<P>rathere than two lines.</P>
<P>Hope it helps</P>
<P>Ellie</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>NetStream replied on Thursday, December 21, 2006</h2>I tried many different ways and still the same error.&nbsp; I even tried different machines and accessing SQL Server both remotely and locally and still the same error.&nbsp; In fact, I get the same TypeLoad Exception when I build the objects manually using the book, but they will save OK.&nbsp; That is something for Rocky to address, if possible.&nbsp; CodeSmith VB templates suck big time.&nbsp; They absolutely will not execute the Update function.&nbsp; I tried the 3.2 beta templates and the 4.0 templates for VB and C# and still the same errors.&nbsp; Only when I build them manually, like I have always done in the past, will they operate successfully.&nbsp; Does anyone have templates they have modified that work that they would like to share?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jwooley replied on Friday, December 29, 2006</h2><P>I believe the message you are seeing in the debugger windows is erroneous. If you type "? mMessages.Count" in the immediate window, it should return the correct value. I have replicated this issue with Project Tracker as identified in the following thread: <A HREF="/forums/thread/7305.aspx">http://forums.lhotka.net/forums/thread/7305.aspx</A></P>
<P>Jim Wooley</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
