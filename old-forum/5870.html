<html><header><title>Object design question - make 2 collections interchangeable</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Object design question - make 2 collections interchangeable</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5870.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>xxxJasonxxx posted on Monday, November 24, 2008</h2><P>Object design question...</P>
<P>We&nbsp;have three CSLA-based readonly collections and we want to be able to use them interchangeably.</P>
<P>Our first thought was to&nbsp;implement a common interface on the child objects.&nbsp; </P>
<P>But I don't think that gets us all the way to where we need to be.</P>
<P>Implementing an interface on the child objects would make the child objects interchangeable but not the parent objects -- the parent collection objects would still be dealt separately as their&nbsp;different types.</P>
<P>We toyed with the idea of implementing an interface on the parent collection objects, but everybody seemed stumped when we tried to work out the details.</P>
<P>How do we make our three collections interchangeable?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonStonecash replied on Monday, November 24, 2008</h2>The simplest way to do this is to create a parent class from which all three of the CSLA child objects inherit.&nbsp; That is, you define a "Super Child" class that inherits from BusinessBase.&nbsp; Your three child classes inherit from "Super Child".&nbsp; <br><br>The next step is to define a "Super Collection" class that contains "Super Children".&nbsp; Your three collections can inherit from "Super Collection".&nbsp; Each of these derived collections might provide type safe methods for manipulating the collection.&nbsp;&nbsp;&nbsp; <br><br>The next step is to define a factory method/class to create the appropriate collection.&nbsp; It will return an object of type "Super Collection".&nbsp; All of your general application logic will work with "Super Collection"; one time you might get a "red" collection, the next time you might get a "blue" collection.&nbsp; If you do not have any requirements for maintaining type safety for the members of a collection, you could skip the child specific collections and just use the "Super Collection" object directly.&nbsp; <br><br>One of the issues that you will have to deal with is the extent to which your general application logic has to deal with the differences between the child objects.&nbsp; If you can define a set of abstract methods that covers all of the functionality, you could easily ignore all of the differences in your general application logic. &nbsp; <br><br>There are a lot of small design decisions that you have to deal with but it is not that difficult to do what you want to do.&nbsp; <br><br>Jon Stonecash<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Monday, November 24, 2008</h2><P>I have some requirements to be able to treat BOs and Collections polymorphically so I implemented Interfaces for them.</P>
<P>BOs:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Interface</FONT></FONT><FONT size=2> IMyBusinessObject<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; Inherits</FONT></FONT><FONT size=2> IEditableBusinessObject<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; Function</FONT></FONT><FONT size=2> GetIdValue() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Object<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> BrokenRulesCollection() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> Validation.BrokenRulesCollection<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; Property</FONT></FONT><FONT size=2> IsOwner() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> IsSelfValid() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Interface</P></FONT></FONT>
<P>Collections:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Interface</FONT></FONT><FONT size=2> IBusinessCollection<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> Item(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> index </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Integer</FONT></FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> useInterface </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean</FONT></FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> IMyBusinessObject<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> IsDirty() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> IsValid() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> Count() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Integer<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> IsSelfValid() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Interface</P></FONT></FONT>
<P>Then in my Base class for MyBusinessListBase:</P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>#Region</FONT></FONT><FONT size=2> </FONT><FONT color=#ff00ff size=2><FONT color=#ff00ff size=2>" IBusinessCollection Implementation "</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>'useInterface is a fake parameter and is only used to change the method signature so we can Overload the Item method. </FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>It does not use the Boolean value at all.<BR></FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>'This way the Base Item method can still return a strongly typed child BO.<BR></FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>'This Item method returns the Interface version of the child BO as IEditableBusinessObject.<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Overloads</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> Item(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> index </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Integer</FONT></FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ByVal</FONT></FONT><FONT size=2> useInterface </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean</FONT></FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> IMyBusinessObject </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Implements</FONT></FONT><FONT size=2> IBusinessCollection.Item<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; Get<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; Return</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>MyBase</FONT></FONT><FONT size=2>.Item(index)<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Get<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property<BR><BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Overloads</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> Count() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Integer</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Implements</FONT></FONT><FONT size=2> IBusinessCollection.Count<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; Get<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; Return</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>MyBase</FONT></FONT><FONT size=2>.Count<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Get<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Overloads</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> IsDirty() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Implements</FONT></FONT><FONT size=2> IBusinessCollection.IsDirty<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; Get<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; Return</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>MyBase</FONT></FONT><FONT size=2>.IsDirty<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Get<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>'JF&nbsp;-&nbsp;no short circuiting involved here.<BR></FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>'run through all the child objects and if any are invalid then the collection is invalid<BR></FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>'call IsValid on all children so that when we examine Broken Rules we get the right set of values.<BR></FONT></FONT><FONT color=#008000 size=2><FONT color=#008000 size=2>'Rocky stopped looping after he found the first invalid child.<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Overrides</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> IsValid() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Implements</FONT></FONT><FONT size=2> IBusinessCollection.IsValid<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; Get<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; Dim</FONT></FONT><FONT size=2> result </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean</FONT></FONT><FONT size=2> = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>True<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; For</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Each</FONT></FONT><FONT size=2> child </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> C </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>In</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Not</FONT></FONT><FONT size=2> child.IsValid </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Then<BR></FONT></FONT><FONT size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>False<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp; End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; Next<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; Return</FONT></FONT><FONT size=2> result<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Get<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</P></FONT></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>ReadOnly</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</FONT></FONT><FONT size=2> IsSelfValid() </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Implements</FONT></FONT><FONT size=2> IBusinessCollection.IsSelfValid<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; Get<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; Dim</FONT></FONT><FONT size=2> result </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Boolean</FONT></FONT><FONT size=2> = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>True<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; For</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Each</FONT></FONT><FONT size=2> child </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>As</FONT></FONT><FONT size=2> C </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>In</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Me<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Not</FONT></FONT><FONT size=2> child.IsSelfValid </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Then<BR></FONT></FONT><FONT size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; result = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>False<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>If<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; Next<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; Return</FONT></FONT><FONT size=2> result<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>&nbsp; End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Get<BR></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Property</P></FONT></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<P>#End</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Region</P></FONT></FONT>
<P>&nbsp;</P>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Tuesday, November 25, 2008</h2><P>I can summarize the steps as follows:</P>
<OL>
<LI>Implement a common interface on all of your child objects.</LI>
<LI>Create an interface for your parent collection that exposes all of the methods you need using the common interface.</LI>
<LI>Explicitly implement the collection interface on your parent collection.</LI>
<LI>Implement strongly-typed equivalents, if appropriate, in your parent collection.</LI></OL>
<P>Note: Try to avoid inheriting interfaces unless the explicitly extend the base interface or are required in order to satisfy the sub-interface.</P>
<P>Joe gives a great example but I'm not sure about the useInterface parameter.&nbsp; Here's how I accomplish this (using C# - just to mix things up):</P>
<P><CODE>public interface IChildObject<BR>{<BR>&nbsp; &nbsp; void DoSomething();<BR>}<BR>&nbsp;<BR>public interface IParentCollection<BR>{<BR>&nbsp; &nbsp; IChildObject this[int index] { get; }<BR>}<BR>&nbsp;<BR>public class ChildObject1 : IChildObject<BR>{<BR>&nbsp; &nbsp; public void DoSomething() { Console.WriteLine("ChildObject1"); }<BR>}<BR>&nbsp;<BR>public class ChildObject2 : IChildObject<BR>{<BR>&nbsp; &nbsp; public void DoSomething() { Console.WriteLine("ChildObject2"); }<BR>}<BR>&nbsp;<BR>public class ParentCollection1 : ..., IParentCollection<BR>{</P>&nbsp; &nbsp; public ChildObject1 this[int index]<BR>&nbsp; &nbsp; {<BR>&nbsp; &nbsp; &nbsp; &nbsp; get { ... }<BR>&nbsp; &nbsp; }<BR>&nbsp;<BR>&nbsp;&nbsp;&nbsp; // This will be pseudo-private<BR>&nbsp; &nbsp; IChildObject IParentCollection.this[int index]<BR>&nbsp; &nbsp; {<BR>&nbsp; &nbsp; &nbsp; &nbsp; get { return this[index] as IChildObject; }<BR>&nbsp; &nbsp; }<BR>}<BR>&nbsp;<BR>public class ParentCollection2 : ..., IParentCollection<BR>{<BR>&nbsp; &nbsp; public ChildObject2 this[int index]<BR>&nbsp; &nbsp; {<BR>&nbsp; &nbsp; &nbsp; &nbsp; get { ... }<BR>&nbsp; &nbsp; }<BR>&nbsp;<BR>&nbsp;&nbsp;&nbsp; // This will be pseudo-private<BR>&nbsp;&nbsp;&nbsp; IChildObject IChildObject.this[int index]<BR>&nbsp; &nbsp; {<BR>&nbsp; &nbsp; &nbsp; &nbsp; get { return this[index] as IChildObject; }<BR>&nbsp; &nbsp; }<BR>} </CODE>
<P></P>
<P>Now, you can make use of the collections as follows:</P>
<P><CODE>IParentCollection col = new ParentCollection1();<BR>IChildObject child = col[0];<BR>child.DoSomething();<BR><BR>col = new ParentCollection2();<BR>col[0].DoSomething();</CODE></P>
<P>In this case, the output will be "ChildObject1" for the first call and "ChildObject2" for the second.</P>
<P>As long as you implement what you need in the IChildObject interface, you can get everything in this manner.</P>
<P>Note: You could implement a common base class for your collections that implements the IParentCollection interface so you don't have to repeat this code.&nbsp; I would suggest making it generic so that you can allow the this[...] (Item in VB) property to be strongly-typed as shown in the example.&nbsp; By placing a constraint that T must implement the IChildObject interface, you'll be all set.&nbsp; Here's how the base collection would look:</P>
<P><CODE>public abstract class ParentCollectionBase&lt;T&gt; : ..., IParentCollection<BR>&nbsp;&nbsp;&nbsp; T : IChildObject<BR>{<BR>&nbsp; &nbsp; public abstract T this[int index] { get { ... } }<BR>&nbsp;<BR>&nbsp;&nbsp;&nbsp; // This will be pseudo-private<BR>&nbsp; &nbsp; IChildObject IParentCollection.this[int index]<BR>&nbsp; &nbsp; {<BR>&nbsp; &nbsp; &nbsp; &nbsp; get { return this[index] as IChildObject; }<BR>&nbsp; &nbsp; }<BR>}</CODE></P>
<P>Now you can derive from this class, specify the appropriate child object type for T, and implement/override this (Item in VB) and you'll have the behavior you are looking for.</P>
<P>I hope that clears things up.</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
