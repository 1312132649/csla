<html><header><title>Could BusinessBase.SetProperty&lt;P&gt;() return bool if PropertyHasChanged?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Could BusinessBase.SetProperty&lt;P&gt;() return bool if PropertyHasChanged?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6083.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael posted on Monday, January 05, 2009</h2><font size="2" face="Arial">Hi Rocky et al<br><br>I have found myself doing this quite a lot:<br><br><font face="Courier New"><font color="#0000ff">set</font><br>{<br>&nbsp;&nbsp;&nbsp; <font color="#0000ff">bool </font>propertyHasChanged = <font color="#0000ff">value </font>!= m_value;<br><br>&nbsp;&nbsp;&nbsp; SetProperty&lt;<font color="#0000ff">int</font>&gt;(ExampleProperty, <font color="#0000ff">ref </font>m_value, <font color="#0000ff">value</font>);<br><br>&nbsp;&nbsp;&nbsp; if (propertyHasChanged)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#006400">// do something</font><br>}</font><br><br>This would be more convenient:<br><br><font face="Courier New">if (</font></font><font size="2" face="Courier New">SetProperty&lt;<font color="#0000ff">int</font>&gt;(ExampleProperty, <font color="#0000ff">ref </font>m_value, <font color="#0000ff">value</font>))</font><font face="Courier New"><br></font><font size="2" face="Arial"><font face="Courier New">&nbsp;&nbsp;&nbsp; </font><font color="#006400" face="Courier New">// do something</font><br><br>Any thoughts?<br><br>Kind regards<br>Mike<br></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Monday, January 05, 2009</h2><P>The&nbsp;framework supported manner is to override PropertyHasChanged in the business object, which only is fired if a property value has changed&nbsp;- I realize the location is separated from the setter which may be undesirable for some, but just wanted to make sure you were aware of that.</P>
<P>Chris</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael replied on Monday, January 05, 2009</h2><font size="2"><font face="Arial">Thanks for the reply Chris. I hadn't thought of overriding PropertyHasChanged. That works, but would be <i>slightly</i> less efficient than having SetProperty return bool, and less desirable as you've mentioned, especially if you have many properties making use of it. I'll use the override for now.<br><br>Mike<br></font></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>vdhant replied on Monday, January 05, 2009</h2>Hi Chris<br>This issue has been discussed a few time in the past, with the below link being the most recent:<br>Determine whether SetProperty has changed the value - http://forums.lhotka.net/forums/thread/28210.aspx<br><br>In short though there was no solid action to make a change, just work arounds.<br><br>For something to change here i should guess Rocky would need to get involved.<br>Hope this helps<br>Anthony <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael replied on Monday, January 05, 2009</h2><font size="2" face="Arial">Thanks Anthony, I did do a search before posting, but didn't see that one.</font><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>AndrewBurns replied on Thursday, January 08, 2009</h2>I just ran into this issue and understand the need to hook PropertyChanged (vs running code after SetProperty) otherwise subscribers will be notified BEFORE your after code runs which can be about 99.99% guaranteed that isn't what you wanted.<br><br>What about adding an override to SetProperty where you could pass in a lamda/anonymous method that SetProperty could invoke before changing the value something along the lines of:<br>get { return GetProperty(TaxRateProperty); }<br>set<br>{<br>&nbsp;&nbsp;&nbsp; SetProperty(TaxRateProperty, value,<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; (o, n) =&gt;<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; Log.DebugFormat("Changed TaxRate from {0} to {1}.", o, n);<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; //Other stuff here<br>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; });<br>}<br>I like this alot as if you just need to do a quick one-off you can use short form [ n,o =&gt; _something += n ]&nbsp; or the entire block, or ever call another method if needed.<br><br>I realize that I am coming late to the game on this discussion so is this recommendation has come up and been vetoed before I apologize.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Tuesday, January 06, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>skagen00:</strong></div><div>
<P>The&nbsp;framework supported manner is to override PropertyHasChanged in the business object, which only is fired if a property value has changed&nbsp;- I realize the location is separated from the setter which may be undesirable for some, but just wanted to make sure you were aware of that.</P>
<P>Chris</P>
<P>&nbsp;</P>
<P></div></BLOCKQUOTE></P>
<P>An almost equivalent mechanism is to implement a business rule associated with the property ("almost" because the rule will also fire if you call CheckRules explicitly even if the property hasn't changed). However, careful implementation of the business rule logic can achieve the same results as a PropertyHasChanged override and is somewhat cleaner IMHO. </P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
