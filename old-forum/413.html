<html><header><title>1.53 Not getting IsValid value on child with AllRules</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>1.53 Not getting IsValid value on child with AllRules</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/413.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>esteban404 posted on Monday, June 19, 2006</h2><P>I have a business base object with several children&nbsp;each of which is bound to a grid and included in the overriden IsValid property on the parent. When testing it, a broken rule will show in the list box control for the parent object normally.&nbsp;Child objects, OTOH,&nbsp;place an error icon on the ofending row in the grid, but no rule is added to the list. The icon is tiny, so it needs to be in the list, too.</P>
<P>I noticed a problem when the save button would not disable when there's an error even though I bound the save button to th IsValid property of all the members. This is the&nbsp;main problem: the button should not be enabled.</P>
<P>I'm using the GetAllBrokenRules method of the AllRules class added to CSLA 1.53 release. I don't think I ****ed it up, but it's not working</P>
<P>I added the following to the Parent BO class:<FONT color=#0000ff size=2><BR>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>override</FONT><FONT size=2> CSLA.BrokenRules.RulesCollection GetBrokenRulesCollection()<BR>{<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp; return</FONT><FONT size=2> AllRules.GetAllBrokenRules(</FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>);<BR>}</FONT></P>
<P><FONT size=2>I stepped through the binding and it seems OK, but still doesn't return IsValid = false for the child. I&nbsp;also added a check box bound to the IsValid property of the collections and they don't fire.</FONT></P>
<P><FONT size=2>What did&nbsp;I mess up?</FONT></P>
<P><FONT size=2>_E</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, June 27, 2006</h2><P>This is, for better or worse, the expected behavior. IsValid cascades up (assuming you follow the code templates from the book), but there is no automatic mechanism by which broken rule descriptions are combined from the children up into the parent.</P>
<P>In other words, if you are finding IsValid is wrong then there's a bug in your object code (you probably aren't overriding IsValid at the parent level). But if you are looking for consolidated broken rules descriptions you'll have to derive your own solution, because the framework doesn't do this.</P>
<P>The reason the framework doesn't do this, is because I am not sure how to reflect the values in a meaningful way - at least not that would work with data binding. The child collection is represented as a single property at the parent level, so all the child (and grandchild, etc.) rules would need to be combined into a single string value that would be returned for that one property. It is not clear to me how you could hope to represent all the errors from an entire object graph in a single string?</P>
<P>On the other hand, you could construct a UI component/control that could do this in a meaningful way. Every BusinessBase-derived object implements IDataErrorInfo. It wouldn't be terribly hard to create a control (tree control perhaps?) that walked down your entire object graph to pull out the error text for each object (using the Error property) or even each property (using the Item property). It would be up to you to display these in a meaningful manner, but at least you'd have access to the detailed information about which objects/properties are not happy.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>esteban404 replied on Wednesday, June 28, 2006</h2><P>Thanks, Rocky. I read all the posts about IsValid and its designed behavior, so this was no surprise. It's was tough find a specific resolution in&nbsp;all the posts. There are so many great solutions.</P>
<P>I solved it by&nbsp;passing the strings from the broken rules collection up the chain and eventually into the BO parent.&nbsp;Then I&nbsp;display the strings&nbsp;in the list box. My BOs don't use ActiveObjects (yet), but I see the behavior is a bit better with AO than what I did.</P>
<P>The IDataErrorInfo is working fine every where, but my users aren't paying attention, so I've changed the behavior to catch their attention and turn off the Save button when any part of the object is not valid. Since I've been sentenced to being all things to all aspects of programs from&nbsp;DBA to user,&nbsp;it's within my power to do sneaky things to keep it on time. Everything is well documented, of course! <img src="/emoticons/emotion-5.gif" alt="Wink [;)]" /></P>
<P>_E</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
