<html><header><title>Non-generic SetProperty does not check authorization/validation rules</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Non-generic SetProperty does not check authorization/validation rules</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5871.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>chadhinton posted on Monday, November 24, 2008</h2>I'm using cslacs-3.5.1-080803 and have found that calling the non-generic SetProperty in Csla.Core.BusinessBase bypasses authorization and validation rules checking. I checked the latest 3.5.x repository code the problem is present. <br><br>&nbsp;&nbsp;&nbsp; /// &lt;summary&gt;<br>&nbsp;&nbsp;&nbsp; /// Sets a property's managed field with the <br>&nbsp;&nbsp;&nbsp; /// supplied value, first checking authorization, and then<br>&nbsp;&nbsp;&nbsp; /// calling PropertyHasChanged if the value does change.<br>&nbsp;&nbsp;&nbsp; /// &lt;/summary&gt;<br>&nbsp;&nbsp;&nbsp; /// &lt;param name="propertyInfo"&gt;<br>&nbsp;&nbsp;&nbsp; /// PropertyInfo object containing property metadata.&lt;/param&gt;<br>&nbsp;&nbsp;&nbsp; /// &lt;param name="newValue"&gt;<br>&nbsp;&nbsp;&nbsp; /// The new value for the property.&lt;/param&gt;<br>&nbsp;&nbsp;&nbsp; /// &lt;remarks&gt;<br>&nbsp;&nbsp;&nbsp; /// If the user is not authorized to change the <br>&nbsp;&nbsp;&nbsp; /// property a SecurityException is thrown.<br>&nbsp;&nbsp;&nbsp; /// &lt;/remarks&gt;<br>&nbsp;&nbsp;&nbsp; protected void SetProperty(IPropertyInfo propertyInfo, object newValue)<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FieldManager.SetFieldData(propertyInfo, newValue);<br>&nbsp;&nbsp;&nbsp; }<br><br>This essentially calls straight through to set the field data. The generic SetProperty methods explicitly check CanWriteProperty and implicitly run validation rules through calls to LoadPropertyValue and PropertyHasChanged.<br><br>Are the comments on this method a typo? Is this method intended to bypass rules? I obviously can't "easily" use the generic methods. That means reflection would be required... not the end of the world but I'd rather not. I don't mind tracking a local fix (or submitting a patch) if this is a bug and a fix for this will be incorporated into a further release.<br><br>Thanks,<br>Chad<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, November 24, 2008</h2><P>This is a bug. I need to look a little deeper to find the exact answer.</P>
<P>Either it should check the rules, or (more likely) this should be named LoadProperty().</P>
<P>The purpose of the non-generic method is purely for data loading, in the case that you don't know the data type and are willing to let CSLA do its type coersion process on your data.</P>
<P>I'll add this to the issue tracker.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
