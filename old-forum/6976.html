<html><header><title>EditLevel Error with Linq Sort</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>EditLevel Error with Linq Sort</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6976.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Topher posted on Wednesday, May 20, 2009</h2>WinForms<br />CSLA 3.6.2<br />.NET 3.5 SP2<br /><br />I've been trying to sort a child collection on a column header click in a DataGridView using Linq. I can get the the collection to sort, but I'm unable to edit the child collection due to an EditLevel error. The child collection edits fine if I don't try to apply sorting.<br /><br />I have a pretty simple object graph: Parent -> ChildCollection -> Child. The parent and child inherit from BusinessBase, the ChildCollection from BusinessListBase.  I'm using a CslaActionExtender control to handle the windows databinding. The form has various controls which have the following pertinent settings:<br /><ul><br />    ParentBS.DataSource = Parent<br />    ChildCollectionBS.DataSource = ParentBS<br />    ChildCollectionBS.DataMember = ParentBS.ChildCollectionProperty<br />    ChildCollectionDGV.DataSource = ChildCollectionBS<br />    CslaActionExtender.DataSource = ParentBS<br /></ul><br />On form load I'm populating and sorting my collection like this:<br /><blockquote><br />  Dim _sortDirection As SortOrder = SortOrder.Ascending<br /><br />  <font color="blue">Private Sub</font> FillForm()<ul><br />      _parent = Parent.GetParent()<br /><br />      CslaActionExtenderSubscriber.ResetActionBehaviors(_parent)<br />      ReadWriteAuthorization1.ResetControlAuthorization()<br /><br />      ChildCollectionBS.DataSource = _parent.ChildCollectionProperty.OrderBy(String.Format("ChildID {0}", _sortDirection.ToString))</ul><br />    <font color="blue">End Sub</font><br /></blockquote><br /><br />And I'm handling the ColumnHeaderMouseClick event to enable sorting like this:<br /><blockquote><br />      <font color="blue">Private Sub</font> ChildCollectionDGV_ColumnHeaderMouseClick(...) Handles ChildCollectionDGV.ColumnHeaderMouseClick<ul><br />    _sortDirection = IIf(_sortDirection = SortOrder.Ascending, SortOrder.Descending, SortOrder.Ascending)<br />    Dim columnName As String = ChildCollectionDGV.Columns(e.ColumnIndex).DataPropertyName<br /><br />    ChildCollectionBS.DataSource = _parent.ChildCollectionProperty.OrderBy(String.Format("{0} {1}", columnName, _sortDirection.ToString)) <br /><br />    ChildCollectionDGV.Columns(e.ColumnIndex).HeaderCell.SortGlyphDirection = _sortDirection</ul><br />    <font color="blue">End Sub</font><br /></blockquote><br /><br />I've seen Linq sort examples in the other forums, but I feel like I'm missing something. Can someone point me in the right direction so I can sort and edit the child collection?<br /><br />Thanks!<br />Topher</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Sunday, June 07, 2009</h2>Hi,<br><br>I prefer to use SortedBindingList and FilteredBindingList when programming for WindowsForms. <br><br>Unbind/Rebind of bindingsources are quite "touchy" (tpo make sure you exit edit mode properly, calling either ApplyEdit og CancelEdit before unbind)<br><br>/jonny <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Sunday, June 07, 2009</h2><P>The problem is that Windows Forms pre-dates LINQ, and they really aren't a great match.</P>
<P>While you can write a bunch of code to coerce LINQ to work with Windows Forms (and people do this), I agree that it is better to use technologies and solutions geared toward Windows Forms.</P>
<P>SortedBindingList and FilteredBindingList require FAR less code and naturally integrate with Windows Forms in ways LINQ probably never will (because Microsoft has quit updating Windows Forms in any meaningful way).</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
