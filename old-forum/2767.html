<html><header><title>Problem with SmartDate as a Property!</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Problem with SmartDate as a Property!</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2767.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken posted on Tuesday, April 24, 2007</h2><DIV class=ForumPostContentText id=ctl00_ctl01_bcr_ctl00___PostRepeater_ctl01_PostViewWrapper>
<P><FONT color=#000000 size=2>Here's a sample test class that we'll use to illustrate this problem:</FONT></P><FONT color=#008080 size=2>
<P><FONT color=#0000ff>public</FONT> <FONT color=#0000ff>class</FONT> <FONT color=#008080>TestClass<BR></FONT>{<BR>&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#0000ff>private</FONT> <FONT color=#008080>SmartDate</FONT> _mySmartDate = <FONT color=#0000ff>new</FONT> <FONT color=#008080>SmartDate</FONT>();</P>
<P><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp; public</FONT> <FONT color=#008080>SmartDate</FONT> MySmartDate<BR>&nbsp;&nbsp;&nbsp; {<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get</FONT> { <FONT color=#0000ff>return</FONT> _mySmartDate; }<BR><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set</FONT> { _mySmartDate = <FONT color=#0000ff>value</FONT>; }<BR>&nbsp;&nbsp;&nbsp;&nbsp; }</P>
<P>}</P>
<P><FONT color=#000000 size=3>Here's a test script that illustrates the problem:</FONT></P>
<P><BR>// This works great!<BR>SmartDate<FONT size=2> d = </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>SmartDate</FONT><FONT size=2>();<BR>d.Date = </FONT><FONT color=#008080 size=2>DateTime</FONT><FONT size=2>.Now;<BR></FONT></P>
<P><FONT size=2>// This does't work at all.<BR></FONT>TestClass</FONT><FONT size=2> tc = </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>TestClass</FONT><FONT size=2>();<BR>tc.MySmartDate.Date =&nbsp;<FONT color=#008080 size=2>DateTime</FONT><FONT size=2>.Now;</FONT></FONT></P>
<P><FONT size=2><FONT size=2>// compile error for above line is this:<BR>//Cannot modify the return value of 'TestClass.MySmartDate' because it is not a variable&nbsp;<BR></P></FONT></FONT>
<P><FONT size=2>// This does work.<BR>TestClass<FONT size=2> tc = </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>TestClass</FONT><FONT size=2>();<BR></FONT>tc.MySmartDate = <FONT color=#000080>n</FONT></FONT><FONT color=#0000ff size=2>ew</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>SmartDate</FONT><FONT size=2>(</FONT><FONT color=#008080 size=2>DateTime</FONT><FONT size=2>.Now);<BR></FONT></P>
<P><FONT size=2>It appears that the set logic in the property definition trumps your ability to modify properties of the property object.</FONT></P>
<P><FONT size=2>Is this intended?&nbsp; Is there a work-around?&nbsp; </P></FONT><FONT size=2></FONT></DIV></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jhw replied on Tuesday, April 24, 2007</h2>This has always been a problem with smartdate. Personally I use them internally, but expose them a a date type and do the converson in the property. Till something better comes along. I hope you find an answer<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Tuesday, April 24, 2007</h2><P>If that type of trick has to be done, wouldn't it be better to expose it as a string?</P>
<P>That way, an empty string would represent null.&nbsp; Otherwise, the DateTime class will expose null dates as some day in the 1700's, won't it?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jhw replied on Tuesday, April 24, 2007</h2>Yes that is a good point. I have never tried exposing them as a string but maybe that would be better. Does anyone else have an opinion on this.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Yang replied on Tuesday, April 24, 2007</h2><P>There is also a Nullable(of T) generics class that you can use like</P>
<P><FONT color=#0000ff size=2>Private</FONT><FONT size=2> mNullableDate </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> Nullable(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Date</FONT><FONT size=2>) = </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> Nullable(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Date</FONT><FONT size=2>)</FONT></P>
<P><FONT size=2>This allows you to represent the date as null.&nbsp;You need to&nbsp;subclass the &nbsp;DateTimePicker to allow binding to this type of object.</FONT></P>
<P><FONT size=2>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, April 24, 2007</h2><P>Honestly the whole point of SmartDate is for internal use so you can expose the value as a string. SmartDate understands the idea of an "empty" date, and that an empty string equates to an empty date.</P>
<P>If you don't need the concept of a date being empty, then you really don't need SmartDate in most cases. If a date is required, you can just use DateTime. If it can be null you can use Nullable&lt;DateTime&gt;. </P>
<P>But if you need the concept of "empty" (which is quite different from null), then SmartDate is your friend.</P>
<P>Also, if you want to expose a date value in a simple textbox so the user can type dates free-form, use parsing shortcuts like "Monday" or "Today" or "t" then again, SmartDate is your friend, because it handles all the string-to-and-from-date translation.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Wednesday, May 09, 2007</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>RockfordLhotka:</strong></div><div>
<P>Honestly the whole point of SmartDate is for internal use so you can expose the value as a string. SmartDate understands the idea of an "empty" date, and that an empty string equates to an empty date.</P>
<P>If you don't need the concept of a date being empty, then you really don't need SmartDate in most cases. If a date is required, you can just use DateTime. If it can be null you can use Nullable&lt;DateTime&gt;. </P>
<P>But if you need the concept of "empty" (which is quite different from null), then SmartDate is your friend.</P>
<P>Also, if you want to expose a date value in a simple textbox so the user can type dates free-form, use parsing shortcuts like "Monday" or "Today" or "t" then again, SmartDate is your friend, because it handles all the string-to-and-from-date translation.</P>
<P></div></BLOCKQUOTE></P>
<P>Ok, you sold me on the approach of exposing the property as a string.</P>
<P>However, once we bind the collection to a datagrid, we want to allow the user to sort it.</P>
<P>And, of course, the datagrid sorts our dates and numbers as strings.</P>
<P>Is there an easy workaround for this?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Wednesday, May 09, 2007</h2>Wrap your list in an ObjectListView.&nbsp; It provides both interface and event options for changing how a property is sorted.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, May 10, 2007</h2><P>Brian's solution is a good one.</P>
<P>A quick and dirty one is to have two properties for the date - one as a String and the other as a Date.</P>
<P>Bind the grid to the string property&nbsp;but sort by the date property.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Thursday, May 10, 2007</h2><P>Brian,</P>
<P>I had seen your ObjectListView before, but hadn't gotten around to trying it.</P>
<P>Very nice!</P>
<P>Pretty intuitive, and it seems to me much easier to use than the SortedBindingList and FilteredBindingList.</P>
<P>Thanks for the good work, and for the tip!</P>
<P>========================================</P>
<P>FYI, the Sort and Filter help text need some examples of usage, such as:</P>
<P><STRONG>Sort:</STRONG></P>
<P>"PropertyOne asc, PropertyFive desc"</P>
<P><STRONG>Filter:</STRONG></P>
<P>"PropertyOne &gt;= 10 and PropertyFive like 'M%'"</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Thursday, May 10, 2007</h2><P>We're looking at implementing the IExtendSort in our RuleBusinessBase class, which is our development&nbsp;subclass of BusinessBase.</P>
<P>We use the standard naming convention of "PropertyName" for a property&nbsp;and "_propertyName" for the corresponding private variable.&nbsp; We're hoping that we can deduce the private variable name and use reflection to get the value to return.&nbsp; </P>
<P><STRONG>Advantages (we hope!):</STRONG></P>
<UL>
<LI>No extra code needed in each class that follows naming conventions.</LI>
<LI>Could be overridden in a specific class as necessary.</LI>
<LI>Can't forget to add the new property to the GetSortValue method logic, because it is handled automatically.</LI></UL>
<P><STRONG>Disadvantages (we hope not!):</STRONG></P>
<UL>
<LI>Might be too slow since reflection is being used.&nbsp; (Then again, a long case or if statement takes time to process to, so here's hoping!)</LI></UL>
<P>Have you tried this?&nbsp; If not, we'll post our progress.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Brian Criswell replied on Thursday, May 10, 2007</h2>Interesting solution.&nbsp; It should work fine.&nbsp; I would recommend caching the property descriptors and field descriptors per object type.<br><br>The ObjectView (the item in an ObjectListView) uses reflection already, and the sorting code uses reflection to get at the property values.&nbsp; I once ran a real world test, and if memory serves, it sorted 8000 items in 2 or 3 seconds.<br><br>Filtering is quite a bit slower though because each item is passed into a DataView to see if it passes the filter criteria.&nbsp; This allows for the easy filter syntax, but I think that one of these days I need to use one of the free lexers/parsers to parse the filter string and test the values directly.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Thursday, May 10, 2007</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>Brian Criswell:</strong></div><div>Interesting solution.&nbsp; It should work fine.&nbsp; I would recommend caching the property descriptors and field descriptors per object type.</div></BLOCKQUOTE></P>
<P>Good idea!&nbsp; My colleague, who's taking it to the next step, just left for the day, but he felt pretty confident he would get it working in the morning.&nbsp; I'll pass on your suggestion.&nbsp; </P>
<P>I'm really excited for it to work, because that would become one less thing I would&nbsp;have to worry about going wrong, and therefore one less thing to test. :)</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Tuesday, May 15, 2007</h2><P>We moved the code up to our version of BusinessBase and it worked great.</P>
<P>So, the only thing we have to do in our business objects is to claim they implement the interface.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, May 16, 2007</h2><P>Would you mind sharing some code so we can see how it was done? <BR>Thanks.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Wednesday, May 16, 2007</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>JoeFallon1:</strong></div><div>
<P>Would you mind sharing some code so we can see how it was done? <BR>Thanks.</P>
<P></div></BLOCKQUOTE></P>
<P>Not at all!&nbsp;&nbsp; </P>
<P>But the current version is company-specific and company-proprietary. :(</P>
<P>I have to redevelop it at home.&nbsp; I'm testing a new DotNetNuke module version this week, so it probably won't happen until next week.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Wednesday, May 16, 2007</h2><P>Ok, I got bored at lunch. :)</P>
<P>This would go into your subclass of BusinessBase.</P>
<P><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;summary&gt;<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> All internal variables that are SmartFields (SmartDate, SmartInt16, etc.), if exposed as properties,<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> are exposed as strings. This makes binding extremely easy, but it also means that the default sorting<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> behavior is to sort those properties as strings. This routine works in conjunction with the sorting <BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> capability provided by </FONT><FONT color=#808080 size=2>&lt;see cref="ObjectListView"/&gt;</FONT><FONT color=#008000 size=2> so that the objects are sorted<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> by their underlying datatypes, not their public string values.<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> <BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> Note:<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> <BR>/// If the property is not a string, it is assumed that the property itself should be used to sort by.<BR>///<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> This implementation is based upon correctly following a simple naming convention. If a property is named<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> PropertyNameHere, it's underlying private variable will be named _propertyNameHere. If such a variable<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> is found we return an object of the appropriate private variable type. Otherwise, we <BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> just return the value we were given.<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;/summary&gt;<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;param name="property"&gt;</FONT><FONT color=#008000 size=2>Contains a PropertyDescriptor for the property being sorted.</FONT><FONT color=#808080 size=2>&lt;/param&gt;<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;param name="value"&gt;</FONT><FONT color=#008000 size=2>Contains an object of the appropriate property type, containing that property's value.</FONT><FONT color=#808080 size=2>&lt;/param&gt;<BR></FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;returns&gt;</FONT><FONT color=#008000 size=2>An object of the type we want to sort by, containing the value to sort by.</FONT><FONT color=#808080 size=2>&lt;/returns&gt;</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>object</FONT><FONT size=2> GetSortValue(</FONT><FONT color=#008080 size=2>PropertyDescriptor</FONT><FONT size=2> property, </FONT><FONT color=#0000ff size=2>object</FONT><FONT size=2> value)<BR>{<BR></FONT><FONT color=#008000 size=2>&nbsp;&nbsp;&nbsp; // We are only interested in doing special handling when the </FONT><FONT color=#008000 size=2>public variable is a string. <BR>&nbsp;&nbsp;&nbsp; // Otherwise, leave well enough alone and return </FONT><FONT color=#008000 size=2>the value we were supplied.<BR></FONT><FONT color=#008000 size=2>&nbsp;&nbsp;&nbsp; //</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>&nbsp;&nbsp;&nbsp; // So, if the property is not a string, we can short-circuit the test and return the value we<BR></FONT><FONT color=#008000 size=2>&nbsp;&nbsp;&nbsp; // were given.<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; if</FONT><FONT size=2> (property.PropertyType.FullName != </FONT><FONT color=#800000 size=2>"System.String"</FONT><FONT size=2>)<BR>&nbsp;&nbsp; {<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return</FONT><FONT size=2> value;<BR>&nbsp;&nbsp; }</P>
<P></FONT><FONT color=#008000 size=2>&nbsp;&nbsp; // Get a list of all fields in the object.<BR></FONT><FONT color=#008080 size=2>&nbsp;&nbsp; FieldInfo</FONT><FONT size=2>[] fi = </FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>.GetType().GetFields(</FONT><FONT color=#008080 size=2>BindingFlags</FONT><FONT size=2>.Public | </FONT><FONT color=#008080 size=2>BindingFlags</FONT><FONT size=2>.NonPublic | </FONT><FONT color=#008080 size=2>BindingFlags</FONT><FONT size=2>.Instance);</FONT></P>
<P><FONT color=#008000 size=2>&nbsp;&nbsp; // We assume the property name starts with an uppercase letter, and that the corresponding private variable<BR></FONT><FONT color=#008000 size=2>&nbsp;&nbsp; // starts with an underscore and a lowercase version of the starting letter.<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp; int</FONT><FONT size=2> len = property.Name.Length - 1;<BR></FONT><FONT size=2><BR></FONT><FONT color=#008000 size=2>&nbsp;&nbsp; // privateVariableName = the deduced corresponding private variable name.<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp; string</FONT><FONT size=2> privateVariableName = </FONT><FONT color=#800000 size=2>"_"</FONT><FONT size=2> <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; + (property.Name.ToCharArray()[0].ToString().ToLower()) <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +&nbsp; property.Name.Substring(1, len);</P>
<P></FONT><FONT color=#008000 size=2>&nbsp;&nbsp;&nbsp; // Check each variable name for a match.<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; foreach</FONT><FONT size=2> (</FONT><FONT color=#008080 size=2>FieldInfo</FONT><FONT size=2> f </FONT><FONT color=#0000ff size=2>in</FONT><FONT size=2> fi)<BR>&nbsp;&nbsp;&nbsp; {<BR></FONT><FONT color=#008000 size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // We have the correct private variable if the names match.<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if</FONT><FONT size=2> (f.Name.Equals(privateVariableName))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008000 size=2>// Return the underlying variable value.<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return</FONT><FONT size=2> f.GetValue(</FONT><FONT color=#0000ff size=2>this</FONT><FONT size=2>);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</P>
<P>&nbsp;&nbsp;&nbsp; }</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; return</FONT><FONT size=2> value;<BR>}</P>
<P>}</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, May 17, 2007</h2><P>Thanks for sharing the code.</P>
<P>I see what you mean now.</P>
<P>Thanks.</P>
<P>Joe</P>
<P>Here is a VB version which assumes private variables are named: mPropertyName.</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetSortValue(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> [property] </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.ComponentModel.PropertyDescriptor, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> value </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object<BR>&nbsp; </FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> [property].PropertyType.FullName &lt;&gt; </FONT><FONT color=#ff00ff size=2>"System.String"</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> value<BR>&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>&nbsp; 'Get a list of all fields in the object.<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> fi </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> FieldInfo() = </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.GetType().GetFields((BindingFlags.Public </FONT><FONT color=#0000ff size=2>Or</FONT><FONT size=2> BindingFlags.NonPublic </FONT><FONT color=#0000ff size=2>Or</FONT><FONT size=2> BindingFlags.Instance))</P>
<P></FONT><FONT color=#008000 size=2>&nbsp; 'We assume that the private variable corresponding to the Property name starts with an m and uses the same PropertyName.<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> privateVariableName </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = </FONT><FONT color=#ff00ff size=2>"m"</FONT><FONT size=2> &amp; [property].Name</FONT></P>
<P><FONT color=#0000ff size=2>&nbsp; Dim</FONT><FONT size=2> f </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> FieldInfo</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp; For</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Each</FONT><FONT size=2> f </FONT><FONT color=#0000ff size=2>In</FONT><FONT size=2> fi<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> f.Name.Equals(privateVariableName) </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> f.GetValue(</FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>)<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Next</FONT><FONT size=2> f<BR><BR>&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> value<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT></P><FONT color=#0000ff size=2><FONT color=#008000 size=2>
<P>This routine is added to your Base class that Inherits BusinessBase and it works in conjunction with the sorting&nbsp; </FONT><FONT color=#008000 size=2>capability provided by &lt;see cref="ObjectListView"/&gt; so that the objects are sorted </FONT><FONT color=#008000 size=2>by their underlying datatypes, not their public string values. </FONT></P>
<P><FONT color=#008000 size=2>A BO that wants to use this feature should simply:</FONT></P>
<P><FONT color=#008000 size=2>Implement IExtendSort</P></FONT>
<P><FONT color=#008000 size=2>The ObjectListView class will then call this code automatically if it needs to sort properties on that BO.</FONT></P>
<P><FONT color=#008000 size=2>&nbsp;</P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Wbmstrmjb replied on Friday, April 24, 2009</h2>Rocky,<br /><br />Can you please explain what you mean by a difference between a null date and an empty date?  This is easy to understand for a string, but I do not see the difference for a date since an empty date is not a date where as a zero length string is a set value just with no characters.<br /><br />What does an empty date buy you that is different from a null date?  Is the string implementation a hold over from .NET 1.1 and is not necessary with nullable types?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Friday, April 24, 2009</h2>I've explained this several times on the forum in the past.<br /><br />There are rules for null values. Anything compared to null is null.<br /><br />But in many applications an empty date isn't null. In fact, an empty date is<br />either infinitely far in the past or the future. You can compare an empty<br />date to a specific date and find out if it is greater than or less than.<br /><br />This is particularly apparent in systems that allow the user to type in a<br />date value on a TextBox - like Quicken, Money and every point of sale or<br />sales order system I've ever created over the past couple decades. Users<br />hate masked edit boxes and calendar controls - at least in any heads-down<br />app where productivity is valuable.<br /><br />And in those cases, what does it mean when the Ship Date field is empty? It<br />means the order hasn't shipped yet - so the date is effectively infinitely<br />far in the future. Reports or other comparisons should consider that empty<br />value as bigger than any other value.<br /><br />That isn't null - because if it were null you couldn't get a meaningful<br />comparison result.<br /><br />So empty is not a specific date, but it isn't a null date either.<br /><br />Rocky</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Wbmstrmjb replied on Monday, April 27, 2009</h2>Thanks Rocky.  I hope the new FAQ will kill our repetitive questions that I'm sure you hate.<br /></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
