<html><header><title>Inserting NULL values into Database tables using CSLA objects</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Inserting NULL values into Database tables using CSLA objects</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3922.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jvnbkk posted on Wednesday, November 21, 2007</h2>Hi All,<br><br>Please help me out, how to insert NULL values into database tables using CSLA objects.&nbsp; I am getting exception whenever I try to insert NULL values into a column using CSLA objects.&nbsp; Is there any property needs to be created for this.<br><br>Thanks in Advance<br><br>Kiran<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DavidDilworth replied on Wednesday, November 21, 2007</h2><P>This is a really obvious question.&nbsp; The column you are trying to insert the data into does allow NULL does it?</P>
<P>So you can write an INSERT statement that succesfully inserts a NULL value.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jvnbkk replied on Wednesday, November 21, 2007</h2>Hi David,<br><br>My table allow NULL values to be inserted, still I am not able to insert NULL values using VB.NET code is there any clue.<br><br>Thanks<br><br>Kiran<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>richardb replied on Wednesday, November 21, 2007</h2><P>The SmartDate CSLA datatype is an example how a .Net date type has been customised to allow NULLS in dates.</P>
<P>If you are working with other SQL data types, ints, etc you may find that the .Net types won't let you store a null.&nbsp; For example, an integer will probably get defaulted to zero - remember the internal variables in your class that are often initialised to help make binding work.</P>
<P>This can be a problem when you come to insert the data.&nbsp; It's zero but you want a null to be saved.</P>
<P>Well maybe you could create a SmartInt data type.&nbsp; I've seen other solutions where just before you insert the data (either in the DataPortal or Stored procedure), the code checks for a certain value and changes it to a null.</P>
<P>I thought I read something once about the .Net data types being changed to allow Nulls but perhaps I just imagined that.</P>
<P>There's probably some further advice on this site if you do a search.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DavidDilworth replied on Wednesday, November 21, 2007</h2><P>What type is&nbsp;the field that you are trying to persist?&nbsp; Are you using SPs? Perhaps you can post some code snippets to help?</P>
<P>@Richard:&nbsp; .NET 2.0 supports the concept of nullable types.&nbsp; I think that is what you meant.&nbsp; Check out this <A href="http://www.c-sharpcorner.com/UploadFile/mosessaur/nullabletypes08222006164135PM/nullabletypes.aspx">link</A> for a brief description.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>richardb replied on Thursday, November 22, 2007</h2><P>Ah yes, Nullable Types - thanks thats it.&nbsp; I knew I read it somewhere.</P>
<P>Just come out of a 1.52 year massive CSLA1.x project and only now am moving to a .Net 2.0 and upwards world.</P>
<P>Thanks.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ward0093 replied on Wednesday, November 21, 2007</h2><P>I use the new Nullable Types almost everywhere in my code and BOs because my DB has a lot of fields that are suppose to be NULL when no data has been presented/persisted.&nbsp; For examble: Nullable(of int32) or Nullable(of Uint16).</P>
<P>There is some important discoveries when persisting Nullable Data to the database via a Stored Proc...&nbsp; First, in your stored proc., make sure that all nullable parameters have default values (i.e. @customerAge as smallint = null)</P>
<P>This is important because if you pass the parameter in like this:</P>
<P>sqlCmd.Parameters.AddWithValue("@customerAge", mCustomerAge) where mCustomerAge is a Nullable(of UInt16); the SP will default to the default value in the SP... if there is no default value in the SP parameter and your BO/mCustomerAge is Null/Nothing... the sqlCmd will throw an exception saying that "@customerAge parameter is required and not&nbsp;provided" (or something like that).</P>
<P>Also notice that you DO NOT have to perform a check on the BO mCustomerAge "Value" or "HasValue" or "GetDefaultValue"... the SP and the parameter Default Value takes care of it for you...</P>
<P>So this should be how you persist your Nullable data to the database.</P>
<P>TO FETCH:</P>
<P>I had to override and create a custom SafeDataReader from Rockys SafeDataReader.... to load nullable types into my BO's... see post <A HREF="/forums/thread/19060.aspx">http://forums.lhotka.net/forums/thread/19060.aspx</A></P>
<P>this show the function GetValue(of T) that i created to handle loading of Nullable Types in BOs</P>
<P>&nbsp;</P>
<P>Hope this helps</P>
<P>ward0093</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jvnbkk replied on Sunday, November 25, 2007</h2>Hi ward,<br><br>Thanks I will try using Nullable data <br><br>Thanks again<br><br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
