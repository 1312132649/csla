<html><header><title>Slight imrpovement in CanWriteProperty</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Slight imrpovement in CanWriteProperty</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5140.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>triplea posted on Wednesday, July 23, 2008</h2><P>I know this has been untouched for a long while but&nbsp;the possibility of a&nbsp;slight improvement occured to me today.<BR>Assume a BO with a property MyProperty of type string. The setter would look like this:</P><FONT color=#0000ff size=2>
<P>set<BR></FONT><FONT size=2>{<BR>&nbsp;&nbsp; CanWriteProperty(</FONT><FONT color=#a31515 size=2>"MyProperty"</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>);<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp; if</FONT><FONT size=2> (value == </FONT><FONT color=#0000ff size=2>null</FONT><FONT size=2>) value = </FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2>.Empty;<BR></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;if</FONT><FONT size=2> (_myProperty != value)<BR>&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _myProperty = value;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged(</FONT><FONT color=#a31515 size=2>"MyProperty"</FONT><FONT size=2>);<BR>&nbsp;&nbsp; }<BR>}</P></FONT>
<P>We have a form that has a textbox bound to that property and the form contains a readWriteAuthorization control. Assume that the current user (me) cannot edit that property so CanWriteProperty returns false so readWriteAuthorization sets my textbox as readonly. If i place the cursor in that (readonly) textbox and tab out of it without making any changes, the setter will throw a security exception and my cursor is forever stuck in the textbox, silently throwing the security exceptions on my output window but no other visible cueues to the user (who wouldn't be able to do anything anyway).<BR>If I change CanWriteProperty so that an exception is not thrown then the code will continue check that the value is not null (if its a string like in the example above), no changes would have been made and will exit. But this doesnt seem right. Wouldn't it be better to do the following:</P><FONT color=#0000ff size=2>
<P>set<BR></FONT><FONT size=2>{<BR>&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (</FONT><FONT color=#0000ff size=2>value</FONT><FONT size=2> == </FONT><FONT color=#0000ff size=2>null</FONT><FONT size=2>) </FONT><FONT color=#0000ff size=2>value</FONT><FONT size=2> = </FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2>.Empty;<BR>&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (CanWriteProperty(</FONT><FONT color=#a31515 size=2>"MyProperty"</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>false</FONT><FONT size=2>) &amp;&amp; (_myProperty != </FONT><FONT color=#0000ff size=2>value</FONT><FONT size=2>))<BR>&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _myProperty = </FONT><FONT color=#0000ff size=2>value</FONT><FONT size=2>;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged(</FONT><FONT color=#a31515 size=2>"MyProperty"</FONT><FONT size=2>);<BR>&nbsp;&nbsp; }<BR></FONT><FONT size=2>}</FONT></P>
<P><FONT size=2><FONT size=3>The error would be thrown should the flag be&nbsp;true whereas if its false then you dont run into issues changing a value you shouldnt if you forget to set the textbox to read only (e.g. via readWriteAuthorization).<BR>All this in 3.0.4, not sure how this is handled within 3.5, will have to check that later but it might be relevant.</FONT></P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, July 24, 2008</h2>Added to my list of things to research.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>justncase80 replied on Thursday, August 14, 2008</h2>I noticed this exact same issue when binding to a property you don't have authorization to write to in Silverlight. I didn't consider not throwing an exception in the setter however... The solution I came up with was more like this:<br><p><font color="#0000ff" size="2">set<br></font><font size="2">{<br>&nbsp;&nbsp; </font><font color="#0000ff" size="2">if</font><font size="2"> (</font><font color="#0000ff" size="2">value</font><font size="2"> == </font><font color="#0000ff" size="2">null</font><font size="2">) </font><font color="#0000ff" size="2">value</font><font size="2"> = </font><font color="#0000ff" size="2">string</font><font size="2">.Empty;<br>&nbsp;&nbsp; </font><font color="#0000ff" size="2">if</font><font size="2"> (_myProperty != value &amp;&amp; CanWriteProperty(</font><font color="#a31515" size="2">"MyProperty"</font><font size="2">, </font><font color="#0000ff"><font size="2">true</font></font><font size="2">))</font><font size="2"><br>&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _myProperty = </font><font color="#0000ff" size="2">value</font><font size="2">;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged(</font><font color="#a31515" size="2">"MyProperty"</font><font size="2">);<br>&nbsp;&nbsp; }<br></font><font size="2">}</font></p><br>Which will still throw the exception if you're not authorized to set the value but it won't bother to do anything if the values are exactly the same still.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
