<html><header><title>How to handle insertable but non-updateable properties?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How to handle insertable but non-updateable properties?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3772.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken posted on Wednesday, October 24, 2007</h2><P>I have standard editable business objects (in editable collections, of course).</P>
<P>Some of the properties can be set when the object is new, but they cannot be updated once the object has been saved.&nbsp; I cannot limit the setting of the properties to constructors only, so read-only properties won't do.&nbsp; </P>
<P>I can't imagine wanting to have two sets of objects, one for new and one for old, and trying to manage them in the same strongly typed collection - unless there is some way to avoid duplicating code.</P>
<P>Since I can set the values some of the time, the properties have to have setters.</P>
<P>Should I throw an exception when someone tries to change one of these property values when it's an old object instead of a new one?</P>
<P>Or is there a better way?.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tmg4340 replied on Wednesday, October 24, 2007</h2><P><FONT face=Tahoma size=2>I know this has been discussed in the forums before, but I can't remember under what topic - otherwise I'd send you there.</FONT></P>
<P><FONT face=Tahoma size=2>IIRC, the gist of the prior conversations is that you override CanWriteProperty() in your business object.&nbsp; Then you can look at IsNew/IsDirty to determine whether the property should be writable.&nbsp;&nbsp;That allows you to write your setters like you always would, and decide whether you want to throw an exception (which I probably would) or do something else.</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Wednesday, October 24, 2007</h2>Thanks!&nbsp; Much better than the idea I had!</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>KKoteles replied on Wednesday, October 24, 2007</h2><P>David,</P>
<P>I added custom rules; however, that doesn't provide the best feedback since the user doesn't know until they try to make a change.&nbsp; It would be much better to address this through authorization rules.&nbsp; Could you post an example of what you might come up with here?</P>
<P>Here is an example of my validation rule:</P>
<P><FONT face=Calibri><SPAN><FONT color=#0000ff><SPAN>protected</SPAN><SPAN><FONT color=#000000> </FONT><SPAN>void</SPAN><FONT color=#000000> AddCustomRules()<BR>{<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><FONT color=#006400><SPAN>//<BR></SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><FONT color=#006400><SPAN>// Name<BR></SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN><FONT color=#006400>//<BR></FONT></SPAN><FONT color=#000000><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>ValidationRules.AddRule&lt;</FONT><SPAN><FONT color=#a9a9a9>StatusType</FONT></SPAN><FONT color=#000000>&gt;(CanChangeOnlyWhenNewName&lt;</FONT><SPAN><FONT color=#a9a9a9>StatusType</FONT></SPAN><FONT color=#000000>&gt;, </FONT><SPAN><FONT color=#a52a2a>"Name"</FONT></SPAN><FONT color=#000000>);<BR>}<BR><BR></FONT><SPAN>private</SPAN><FONT color=#000000> </FONT><SPAN>static</SPAN><FONT color=#000000> </FONT><SPAN>bool</SPAN><FONT color=#000000> CanChangeOnlyWhenNewName&lt;T&gt;(T target, Csla.Validation.</FONT><SPAN><FONT color=#a9a9a9>RuleArgs</FONT></SPAN><FONT color=#000000> e) </FONT><SPAN>where</SPAN><FONT color=#000000> T: </FONT><SPAN><FONT color=#a9a9a9>StatusType<BR></FONT></SPAN><FONT color=#000000>{<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>if</SPAN><FONT color=#000000> (target.IsNew != </FONT><SPAN>true</SPAN><FONT color=#000000>)<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>if</SPAN><FONT color=#000000> (target._name != target._originalName)<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>e.Description = </FONT><SPAN><FONT color=#a52a2a>"Can only change Name when object is new."</FONT></SPAN><FONT color=#000000>;<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>return</SPAN><FONT color=#000000> </FONT><SPAN>false</SPAN><FONT color=#000000>;<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>else<BR></SPAN><FONT color=#000000><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>return</SPAN><FONT color=#000000> </FONT><SPAN>true</SPAN><FONT color=#000000>;<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>else<BR></SPAN><FONT color=#000000><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>{<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN></FONT><SPAN>return</SPAN><FONT color=#000000> </FONT><SPAN>true</SPAN><FONT color=#000000>;<BR><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>}<BR>}</FONT><BR><BR></SPAN></FONT></SPAN></FONT><o:p><FONT face=Calibri>&nbsp;Thanks,</FONT></o:p></P>
<P class=MsoNoSpacing><o:p><FONT face=Calibri>Ken</FONT></o:p></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>KKoteles replied on Monday, October 29, 2007</h2><P>Wow - found this in another thread.&nbsp; I feel pretty foolish now that I see how simple it is:</P>
<P class=MsoNormal><SPAN><FONT color=#0000ff>public</FONT></SPAN><SPAN><FONT color=#0000ff> <SPAN>override</SPAN> <SPAN>bool</SPAN></FONT> CanWriteProperty(<SPAN><FONT color=#0000ff>string</FONT></SPAN> propertyName)<BR>{<BR>&nbsp;&nbsp;&nbsp; <SPAN><FONT color=#0000ff>if</FONT></SPAN> (<SPAN><FONT color=#0000ff>this</FONT></SPAN>.IsNew != <SPAN><FONT color=#0000ff>true</FONT></SPAN>)<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN><FONT color=#0000ff>if</FONT></SPAN> (propertyName == <SPAN><FONT color=#a52a2a>"Name"</FONT></SPAN>)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#0000ff><SPAN>return</SPAN> <SPAN>false</SPAN></FONT>;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }<BR><BR>&nbsp;&nbsp;&nbsp; <FONT color=#0000ff><SPAN>return</SPAN> <SPAN>base</SPAN></FONT>.CanWriteProperty(propertyName);<BR>}<o:p></o:p></SPAN></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tmg4340 replied on Monday, October 29, 2007</h2><P><FONT face=Tahoma size=2>This is what I was talking about earlier - I knew it was covered in another thread.&nbsp; Can you link to the thread you found?&nbsp; IIRC, the discussion was rather long, and involved a couple of other facets to this issue.</FONT></P>
<P><FONT face=Tahoma size=2>I wouldn't feel foolish&nbsp;about your solution - everybody has to learn this stuff somehow.&nbsp; <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /></FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>KKoteles replied on Monday, October 29, 2007</h2><P>tmg4340,</P>
<P>Here is the thread I saw it on, but I'm pretty sure this is not the one you were thinking of because it is so recent:</P>
<P><A HREF="/forums/thread/18730.aspx">http://forums.lhotka.net/forums/thread/18730.aspx</A></P>
<P>I found several others as well:</P>
<P><A HREF="/forums/thread/2642.aspx">http://forums.lhotka.net/forums/thread/2642.aspx</A></P>
<P><A HREF="/forums/thread/10837.aspx">http://forums.lhotka.net/forums/thread/10837.aspx</A></P>
<P><A HREF="/forums/thread/12789.aspx">http://forums.lhotka.net/forums/thread/12789.aspx</A></P>
<P>Ken</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
