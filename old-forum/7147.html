<html><header><title>winforms design time errors with custom usercontrol</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>winforms design time errors with custom usercontrol</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7147.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>mr_fuku posted on Monday, June 22, 2009</h2>Hey Rocky:<br><br>I have a NameValueList in a custom winforms usercontrol.<br><br>When I drag the usercontrol onto a form, it seems that the DataPortal_Fetch is being called (at design time) which naturally generates an error.<br><br>Here is the code from the usercontrol:<br><br><b>ClientsNVL clients = BoHelper.GetClientsNVL();<br>foreach (NameValueListBase&lt;string, string&gt;.NameValuePair client in clients)<br>{<br>&nbsp; item = new RadComboBoxItem(client.Value, client.Key);<br>&nbsp; cbSelectInst.Items.Add(item);<br>}</b><br><br>and from the BoHelper class:<br><br><b>[Cache(LocalCache.Key.Clients)]<br>public static ClientsNVL GetClientsNVL()<br>{<br>&nbsp; return ClientsNVL.GetClientsNVL();<br>}</b><br><br>I find this to be very odd - meaning - why would the DataPortal_Fetch method be called from the designer when the application isn't running? I've used this design pattern previously in a web app and everything was fine. What am I doing incorrectly? I've been pulling my hair out over this one.<br><br>Thanks in advance for your thoughts and expertise!<br><br>Best,<br>Ted<br><br><br><br><br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mr_fuku replied on Monday, June 22, 2009</h2>btw I seem to have gotten around this with the following snippet but it seems kind of ridiculous:<br><br><b>if (System.Diagnostics.Process.GetCurrentProcess().ProcessName !=devenv")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // load the combobox<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br></b><br>argh...<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>triplea replied on Monday, June 22, 2009</h2>You usually get these errors when you have code executing in your constructor. Make sure you don't make a call to the DP from within your constructor(s) and that they are marked as private. Also sometimes you will find that if you close your solution, delete all the dll/exe files and rebuild these problems are resolved.<br /><br />HTH</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mr_fuku replied on Monday, June 22, 2009</h2>thanks for getting back so quickly triplea - and yeah i'd seen a couple of posts about what your describing. <br><br>that being said, the only method call in the constructor is and has been the InitializeComponent() call...<br><br>this one has me stumped.<br><br>thanks for your thoughts.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>triplea replied on Monday, June 22, 2009</h2>I actually ment the constructor of your BO not the UI one. What is probably happening is that the UI is calling the constructor on your BO when rendering the view in the designer. If your BO constructor has got any logic that is calling the DP then you would get this error. So the question is, what do your constructor(s) look like?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mr_fuku replied on Monday, June 22, 2009</h2>Ah - oivey! I misunderstood you...it's been one of those days hehe.<br><br>Anyhew, here is the bo constructor:<br><br><b>private ClientsNVL()<br>&nbsp;&nbsp;&nbsp; { /* require use of factory methods */ }</b><br><br>The constructor of the usercontrol:<br><br><b>public CustomerEmploymentInfo()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InitializeComponent();<br>&nbsp;&nbsp;&nbsp; }</b><br><br>And finally the constructor of the form which contains the usercontrol:<br><br><b>public frmCustomer()<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InitializeComponent();<br>&nbsp;&nbsp;&nbsp; }<br></b><br>Obviously not a lot going on there....<br><br>Just to mention, we have quite a bit of 3rd party controls and frameworks in this application:<br><br><ul><li>PostSharp (v 1.5.x)</li><li>Tekerik RadControls</li><li>Memcached (the enyim.com flavor)<br></li><li>Spring.net (for connecting to a JAVA BST)</li></ul>Perhaps it has something to do with one of these (my guess would be the telerik stuff which is pretty but...suffice to say it has some odd behaviours that i've noticed over the life cycle of this project).<br><br>Also, this is my first foray into Winforms (typically I do asp.net dev) so obviously my experience is somewhat lacking.<br><br>Anyway, thanks again for your thoughts! This forum has been really great...and I really am a hardcore propoent of utilizing CSLA as the framework for the DAL.<br><br>Cheers!<br>-Ted<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>lukky replied on Tuesday, June 23, 2009</h2>@mr_fuku,<br><br>Would be most helpful if you could provide the EXACT exception message, and also the call stack when the exception occurs.<br><br>Regards.<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mr_fuku replied on Tuesday, June 23, 2009</h2>@lukky:<br><br>please note that the spring context for this data portal call is specified in the web.config (since we're utilizing the remote data portal option over WCF). this works when the application runs perfectly well, but as i said in my previous posts it is at design time when the errors occur. thanks for your interest and i hope this is helpful.<br><br>the error message is as follows:<br><br><b>No context registered. Use the 'RegisterContext</b>' <b>method or the 'spring/context' section from your configuration file.</b><br><br>and the call stack:<br><br><b>at PurchasingPower.ServiceHost.ServiceManager.get_ApplicationContext() in 
C:\!!development\trunk\PurchasingPower.ServiceHost\ServiceManager.cs:line 
54<br>at PurchasingPower.ServiceHost.ServiceManager.GetClientService() in 
C:\!!development\trunk\PurchasingPower.ServiceHost\ServiceManager.cs:line 
124<br>at PurchasingPower.ServiceHost.ServiceManager.get_ClientService() in 
C:\!!development\trunk\PurchasingPower.ServiceHost\ServiceManager.cs:line 
95<br>at PurchasingPower.BusinessObjects.Clients.ClientsNVL.DataPortal_Fetch() 
in 
C:\!!development\trunk\PurchasingPower.BusinessObjects\Clients\ClientsNVL.cs:line 
52<br>at dm(Object , Object[] )<br>at 
Csla.Reflection.MethodCaller.CallMethod(Object obj, DynamicMethodHandle 
methodHandle, Object[] parameters) </b><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
