<html><header><title>VB.NET Lambda Expressions on RegisterProperty</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>VB.NET Lambda Expressions on RegisterProperty</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7672.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Israel posted on Wednesday, September 23, 2009</h2>I have not seen any example yet of VB.NET implementation of RegisterProperty using lamba expressions similar to the C# version. I have created this test class that does that. It works fine using my limited testing. Any reason why I should avoid this notation?<br /><br />Imports Csla<br /><br />Public Class Class1<br />    Inherits BusinessBase(Of Class1)<br /><br />    Private Shared sProp As PropertyInfo(Of String) = RegisterProperty(Of String)(Function(ss As Class1) ss.TestProperty)<br />    Public Property TestProperty() As String<br />        Get<br />            Return ReadProperty(Of String)(sProp)<br />        End Get<br />        Set(ByVal value As String)<br />            LoadProperty(sProp, value)<br />        End Set<br />    End Property<br /><br />End Class<br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, September 23, 2009</h2>Hmm... probably no reason to avoid it, but compared to the C# syntax, thats much less clear to me than just using a string literal.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, September 23, 2009</h2>The primary advantage of the lambda expression in both C# and VB is that refactoring will automatically rename the property everywhere. So while the syntax is a little verbose, it is probably worth it to get the maintainability of having no string literals at all.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Israel replied on Wednesday, September 23, 2009</h2>That is what I am after. I do not want to include the string literals and be a maintenance hassle later on. Thanks for the input. Greatly appreciated.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, September 24, 2009</h2>Ahh, hadn't considered that.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cdkisa replied on Thursday, September 24, 2009</h2>I like the syntax and the refactoring support of lambda expressions.<br /><br />My question is, when you add validation rules using the lamda syntax, how do you get the "friendly name" and default values during validation?<br /><br />Currently I use:<br />Private Shared IdProperty As PropertyInfo(Of Integer) = RegisterProperty(Of Integer)(GetType(Class1), New PropertyInfo(Of Integer)("Identity", "Identity", -1))<br /><br />If I change this to:<br />Private Shared IdProperty As PropertyInfo(Of Integer) = RegisterProperty(Of Integer)(Function(cls As Class1) cls.Identity)<br /><br />How do you support validation?<br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, September 24, 2009</h2>In your validation rule you should be able to use the PropertyInfo.Name value.  I think there's another one allowing you to get the default.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cdkisa replied on Thursday, September 24, 2009</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>ajj3085:</strong></div><div>In your validation rule you should be able to use the PropertyInfo.Name value.  I think there's another one allowing you to get the default.</div></BLOCKQUOTE><br /><br />If you use lamda expressions, how do you set the values for friendly name and default value? Do you have to set that in the constructor or the dataportal.create method?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, September 24, 2009</h2>There should be overloads that still take FriendlyName and default value.<br /><br />Isn't this what you're looking for?<br /><br />protected static PropertyInfo<P> RegisterProperty<P>(Expression> propertyLambdaExpression, string friendlyName);</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cdkisa replied on Friday, September 25, 2009</h2>Yes there is!<br /><br />Thank you for pointing that out. I didn't take the time to look for myself.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
