<html><header><title>Checking for Duplicate Composite Key in ERLB</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Checking for Duplicate Composite Key in ERLB</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7372.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>esteban404 posted on Thursday, July 30, 2009</h2>Not all my CSLA ref books are with me and I'm not finding what I'm looking for in the forum (yet).<br /><br />I have a CSLA 3.0.5 ERLB object in a grid. There is a composite key on two fields for each BB item in the list: product and OperationType. If I change/add data and that creates a duplicate combination, the grid sees no errors and data binding fires, no update to the db, but the grid still shows the change.<br /><br />Since the item is a member of a list of the same type, where do I capture the issue and warn the user? Is there a rule I can set in the list object?<br /><br />Thanks in advance,<br /><br />_E</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>esteban404 replied on Thursday, July 30, 2009</h2>I found no working solutions and tried the suggestions, but none really worked well for the error notification, so I just turned off column fields for the two fields. It would be tantamount to allowing the editing of a primary key and who allows that after a record's committed? So if it's wrong, they delete and recreate it.<br /><br />So let it be coded...<br /><br />_E</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Thursday, July 30, 2009</h2>What I do is have business rules that do an Exists test on the primary key or key combination. <br /><br />For either a new object or an existing object whose primary key is dirty, the primary key properties are broken.<br /><br />(Note that detecting whether an individual property is actually dirty is not a capabillity built into CSLA. I had to implement this myself)</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>esteban404 replied on Monday, August 03, 2009</h2><P>Thanks rsbaker0. As it turned out, I modified the Exists method to look at the existing list since it's readily available using a simple nested loop. It's damn fast and the sproc provides a second layer of checking just to&nbsp;prevent duplicate insertions without throwing an&nbsp;error in the UI. There are a couple dozen people using the app with a potential to have last write wars.</P>
<P>_E</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
