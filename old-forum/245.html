<html><header><title>Business rule question</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Business rule question</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/245.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Thursday, June 01, 2006</h2>HI all,<br><br>I'm sure others have come up against this, so I'd like to hear how you've handled it.<br><br>I have a business object, which has two integer properties (for the sake of keeping this question simple).&nbsp; I have a business rule which dicates that those two property may never be equal.<br><br>The property settings look like this:<br><br>public int MyInt1 {<br>&nbsp;&nbsp;&nbsp; set {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( value != myInt1 ) {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; myInt1 = value;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged( "MyInt1" );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ValidationRules.CheckRules( "MyInt2" );<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>}<br><br>
public int MyInt2 {<br>
&nbsp;&nbsp;&nbsp; set {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( value != myInt2 ) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; myInt2 = value;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged( "MyInt2" );<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ValidationRules.CheckRules( "MyInt1" );<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>
}<br>
<br><br>So if you set MyInt1 = MyInt2, there are two broken rules recorded, one for each property, stating that MyInt1 cannot equal MyInt2.&nbsp; That works.<br><br>The problem is that when you set MyInt1 = MyInt2, the UI (ErrorProvider for MyInt2) doesn't notice<br>&nbsp;that MyInt2 now is invalid.&nbsp; I'm assuming this is because there was not a PropertyChanged event raised for MyInt2.&nbsp; I know I can solve it by calling UnknownPropertyChanged, which would raise events for all the properties, but is that the best way to handle something like this?<br><br>For my BO, it shouldn't matter too much, there are only 3 properties total, but if I need to do this for a larger BO, there may be alot of PropertyChanged events raised which can hammer the UI.&nbsp; It also seems odd to raise a PropertyChanged for a property which hasn't changed.<br><br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, June 01, 2006</h2>Your problem is that you have to call CheckRules <i>before</i> calling PropertyHasChanged. The ErrorProvider actually refreshes everything, but it does it on the PropertyChanged event - since you are checking the rules after that event has been raised, the ErrorProvider doesn't see the broken rule.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, June 01, 2006</h2>Ahh, of course, that makes sense.<br><br>Thanks<br>Andy<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
