<html><header><title>Problem with TimeStamp parameter on Insert</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Problem with TimeStamp parameter on Insert</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1290.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>David posted on Wednesday, September 20, 2006</h2><P>I am using the EditableRoot template to create an object that has a LastChanged timestamp column (using the partial class option). When I do an insert I get this error:</P>
<P><FONT color=#ff0000>System.InvalidOperationException: String[26]: the Size property has an invalid size of 0.<BR>at System.Data.SqlClient.SqlParameter.Validate(Int32 index) </FONT></P>
<P>The problem is due to the fact that mLastChanged has not been initialised when it is added to the parameter collection. There are a number of ways to fix this, but possibly the easiest is to change the declaration of the member variable for timestamp columns from this:</P>
<P>&nbsp;&nbsp; <FONT color=#0000ff>Private</FONT> mLastChanged <FONT color=#0000ff>As Byte</FONT>()</P>
<P>to this:</P>
<P>&nbsp;&nbsp; <FONT color=#0000ff>Private</FONT> mLastChanged(7) <FONT color=#0000ff>As Byte</FONT></P>
<P>I would also like to add my vote to include support for write first concurrency.<BR></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rasupit replied on Thursday, September 21, 2006</h2>The C# version has been fixed and is now available on CSLAContrib (build 6445)<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
