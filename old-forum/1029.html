<html><header><title>OT: Same UserControl on Different Pages, different behavior??</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>OT: Same UserControl on Different Pages, different behavior??</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1029.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken posted on Friday, August 25, 2006</h2><P>I have a user control that is acting very, very strangely.</P>
<P>Two gridviews on it, nearly identical.&nbsp; Both have a delete button on them, both wired to their respective OnCommand event handlers with structurally identical code. </P>
<P>This control is used in two pages, one directly in the page, one inside a wizard in another page.</P>
<P>In the wizard page, the top grid button works perfectly.</P>
<P>In the standalone page, the top grid button doesn't work unless I add this to the page directive:</P>
<P><EM>EnableEventValidation="false" </EM></P>
<P>If I add the above line, the top grid button works as expected.</P>
<P>That line is not present in the wizard page directive.</P>
<P>Now comes more fun with the bottom grid:</P>
<P>In the stand-alone page, the bottom grid button event handler fires correctly .</P>
<P>(However, the GridView is "empty" whereas in the top grid event handler, the GridView is "full".)</P>
<P>In the wizard page, the bottom grid button event handler never fires at all.</P>
<P>&nbsp;</P>
<P>Needless to say, I am really, really, really confused by all this.</P>
<P>Why would the same user control work differently when&nbsp;embedded in different pages?&nbsp; In particular, why would the event handlers work/not work?</P>
<P>From Top Grid:</P><FONT size=2>
<UL>
<LI></FONT><FONT color=#0000ff size=2>&lt;</FONT><FONT color=#800000 size=2>asp</FONT><FONT color=#0000ff size=2>:</FONT><FONT color=#800000 size=2>TemplateField</FONT><FONT size=2> </FONT><FONT color=#ff0000 size=2>ShowHeader</FONT><FONT color=#0000ff size=2>="False"&gt;</LI></FONT><FONT size=2>
<LI></FONT><FONT color=#0000ff size=2>&lt;</FONT><FONT color=#800000 size=2>ItemTemplate</FONT><FONT color=#0000ff size=2>&gt;</LI></FONT><FONT size=2>
<LI></FONT><FONT color=#0000ff size=2>&lt;</FONT><FONT color=#800000 size=2>asp</FONT><FONT color=#0000ff size=2>:</FONT><FONT color=#800000 size=2>ImageButton</FONT><FONT size=2> </FONT><FONT color=#ff0000 size=2>ID</FONT><FONT color=#0000ff size=2>="btnBatchDelete"</FONT><FONT size=2> </FONT><FONT color=#ff0000 size=2>runat</FONT><FONT color=#0000ff size=2>="server"</FONT><FONT size=2> </FONT><FONT color=#ff0000 size=2>CausesValidation</FONT><FONT color=#0000ff size=2>="False"</FONT><FONT size=2> </FONT><FONT color=#ff0000 size=2>CommandName</FONT><FONT color=#0000ff size=2>="Delete"</LI></FONT><FONT size=2>
<LI></FONT><FONT color=#ff0000 size=2>ImageUrl</FONT><FONT color=#0000ff size=2>="~/Images/delete.gif"</FONT><FONT size=2> </LI>
<LI></FONT><FONT color=#ff0000 size=2>CommandArgument</FONT><FONT color=#0000ff size=2>='</FONT><FONT size=2>&lt;%# DataBinder.Eval(Container,"RowIndex") %&gt;</FONT><FONT color=#0000ff size=2>'</FONT><FONT size=2> </LI>
<LI></FONT><FONT color=#ff0000 size=2>OnCommand</FONT><FONT color=#0000ff size=2>="gvBatch_DeleteCommand"</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>/&gt;</LI></FONT><FONT size=2>
<LI></FONT><FONT color=#0000ff size=2>&lt;/</FONT><FONT color=#800000 size=2>ItemTemplate</FONT><FONT color=#0000ff size=2>&gt;</LI></FONT><FONT size=2>
<LI></FONT><FONT color=#0000ff size=2>&lt;/</FONT><FONT color=#800000 size=2>asp</FONT><FONT color=#0000ff size=2>:</FONT><FONT color=#800000 size=2>TemplateField</FONT><FONT color=#0000ff size=2>&gt;</FONT></LI></UL>
<P><FONT color=#0000ff size=2>From Bottom Grid:</FONT></P><FONT color=#0000ff size=2><FONT size=2>
<UL>
<LI></FONT><FONT color=#0000ff size=2>&lt;</FONT><FONT color=#800000 size=2>asp</FONT><FONT color=#0000ff size=2>:</FONT><FONT color=#800000 size=2>TemplateField</FONT><FONT size=2> </FONT><FONT color=#ff0000 size=2>ShowHeader</FONT><FONT color=#0000ff size=2>="False"&gt;</LI></FONT><FONT size=2>
<LI></FONT><FONT color=#0000ff size=2>&lt;</FONT><FONT color=#800000 size=2>ItemTemplate</FONT><FONT color=#0000ff size=2>&gt;</LI></FONT><FONT size=2>
<LI></FONT><FONT color=#0000ff size=2>&lt;</FONT><FONT color=#800000 size=2>asp</FONT><FONT color=#0000ff size=2>:</FONT><FONT color=#800000 size=2>ImageButton</FONT><FONT size=2> </FONT><FONT color=#ff0000 size=2>ID</FONT><FONT color=#0000ff size=2>="btnDetailDelete"</FONT><FONT size=2> </FONT><FONT color=#ff0000 size=2>runat</FONT><FONT color=#0000ff size=2>="server"</FONT><FONT size=2> </FONT><FONT color=#ff0000 size=2>CausesValidation</FONT><FONT color=#0000ff size=2>="false"</FONT><FONT size=2> </FONT><FONT color=#ff0000 size=2>CommandName</FONT><FONT color=#0000ff size=2>="Delete"</LI></FONT><FONT size=2>
<LI></FONT><FONT color=#ff0000 size=2>ImageUrl</FONT><FONT color=#0000ff size=2>="~/Images/delete.gif"</FONT><FONT size=2> </LI>
<LI></FONT><FONT color=#ff0000 size=2>CommandArgument</FONT><FONT color=#0000ff size=2>='</FONT><FONT size=2>&lt;%# DataBinder.Eval(Container,"RowIndex") %&gt;</FONT><FONT color=#0000ff size=2>'</FONT><FONT size=2> </LI>
<LI></FONT><FONT color=#ff0000 size=2>OnCommand</FONT><FONT color=#0000ff size=2>="btnDetail_DeleteCommandxxx"</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>/&gt;</LI></FONT><FONT size=2>
<LI></FONT><FONT color=#0000ff size=2>&lt;/</FONT><FONT color=#800000 size=2>ItemTemplate</FONT><FONT color=#0000ff size=2>&gt;</LI></FONT><FONT size=2>
<LI></FONT><FONT color=#0000ff size=2>&lt;/</FONT><FONT color=#800000 size=2>asp</FONT><FONT color=#0000ff size=2>:</FONT><FONT color=#800000 size=2>TemplateField</FONT><FONT color=#0000ff size=2>&gt;</FONT></LI></UL>
<P><FONT color=#0000ff size=2>From Top Grid:</FONT></P><FONT size=2>
<UL>
<LI></FONT><FONT color=#0000ff size=2>protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> gvBatch_DeleteCommand(</FONT><FONT color=#0000ff size=2>object</FONT><FONT size=2> sender, </FONT><FONT color=#008080 size=2>CommandEventArgs</FONT><FONT size=2> e) </LI>
<LI>{</LI>
<LI></FONT><FONT color=#008000 size=2>// This button was templated so that it would have its own command handler instead of using</LI></FONT><FONT size=2>
<LI></FONT><FONT color=#008000 size=2>// the GridView RowCommand event handler directly. The reason is due to a known bug.</LI></FONT><FONT size=2>
<LI></FONT><FONT color=#008000 size=2>// At some point, the problem will be fixed and the field could be moved back to a simple command button.</LI></FONT><FONT size=2>
<LI></FONT><FONT color=#008000 size=2>// see http://www.velocityreviews.com/forums/t261419-row-command-firing-twice-in-gridview-control.html</LI></FONT><FONT size=2>
<LI></FONT><FONT color=#008080 size=2>ImageButton</FONT><FONT size=2> btnDelete = (</FONT><FONT color=#008080 size=2>ImageButton</FONT><FONT size=2>)sender;</LI>
<LI></FONT><FONT color=#008080 size=2>GridView</FONT><FONT size=2> gv = (</FONT><FONT color=#008080 size=2>GridView</FONT><FONT size=2>)</FONT><FONT color=#008080 size=2>Helper</FONT><FONT size=2>.FindControl(btnDelete.Page,</FONT><FONT color=#800000 size=2>"gvBatch"</FONT><FONT size=2>);</LI>
<LI></FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> rownum = </FONT><FONT color=#008080 size=2>Convert</FONT><FONT size=2>.ToInt32(e.CommandArgument);</LI></UL></FONT>
<P><FONT color=#0000ff size=2>From Bottom Grid:</FONT></P><FONT color=#0000ff size=2><FONT color=#0000ff size=2>
<UL>
<LI>protected</FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT color=#000000 size=2> btnDetail_DeleteCommandxxx(</FONT><FONT color=#0000ff size=2>object</FONT><FONT color=#000000 size=2> sender, </FONT><FONT color=#008080 size=2>CommandEventArgs</FONT><FONT size=2><FONT color=#000000> e)</FONT></LI>
<LI>{</LI>
<LI></FONT><FONT color=#008000 size=2>// This button was templated so that it would have its own command handler instead of using</LI></FONT><FONT size=2>
<LI></FONT><FONT color=#008000 size=2>// the GridView RowCommand event handler directly. The reason is due to a known bug.</LI></FONT><FONT size=2>
<LI></FONT><FONT color=#008000 size=2>// At some point, the problem will be fixed and the field could be moved back to a simple command button.</LI></FONT><FONT size=2>
<LI></FONT><FONT color=#008000 size=2>// see http://www.velocityreviews.com/forums/t261419-row-command-firing-twice-in-gridview-control.html</LI></FONT><FONT size=2>
<LI></FONT><FONT color=#008080 size=2>ImageButton</FONT><FONT size=2> btnDelete = (</FONT><FONT color=#008080 size=2>ImageButton</FONT><FONT size=2>)sender;</LI>
<LI></FONT><FONT color=#008080 size=2>GridView</FONT><FONT size=2> gv = (</FONT><FONT color=#008080 size=2>GridView</FONT><FONT size=2>)</FONT><FONT color=#008080 size=2>Helper</FONT><FONT size=2>.FindControl(btnDelete.Page, </FONT><FONT color=#800000 size=2>"gvDetail"</FONT><FONT size=2>);</LI>
<LI></FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> rownum = </FONT><FONT color=#008080 size=2>Convert</FONT><FONT size=2>.ToInt32(e.CommandArgument);</FONT></LI></UL>
<P><FONT size=2>The bottom grid shows up empty (it isn't!), and the top grid shows up full (it is).</FONT></P>
<P><FONT size=2>In the wizard page, the bottom grid event handler doesn't fire.&nbsp; In the stand-alone page, it does.</FONT></P>
<P><FONT size=2>The wizard page sets the control to invisible if the user options are such that the user won't be allowed to navigate to that page, visible otherwise.&nbsp; Beyond that, neither page has any of my code that would change any user control setting.</P></FONT></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Saturday, August 26, 2006</h2>bump.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>david.wendelken replied on Tuesday, August 29, 2006</h2><P>For what it is worth to others, I found out how to solve the problem.&nbsp; </P>
<P>Not necessarily why the solution works...</P>
<P>Apparently, the fact that the control was invisible at the time the wizard page was loaded was enough to make it unhappy.&nbsp; Evidently something didn't get run at page load time that would otherwise have been done, and that made the difference.</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
