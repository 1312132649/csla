<html><header><title>BindingList Serialization Bug Revisited in CSLA 3.5/3.6</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>BindingList Serialization Bug Revisited in CSLA 3.5/3.6</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5795.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Spencer posted on Wednesday, November 12, 2008</h2><FONT size=1><FONT face=Arial><FONT size=2>I am experiencing a problem with the BusinessListBase class, regarding serialization. The exception seems vaguely familiar to the exception that happened with earlier versions and was subsequently fixed. Here is the message:<BR><B><BR><FONT color=#ff0000>Type 'System.ComponentModel.ReflectPropertyDescriptor' in Assembly 'System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' is not marked as serializable.</FONT></B><BR><BR>Has anyone else seen this exception with the BusinessListBase class? It is happening on DataPortal_Update().<BR><BR>Thank you for any help you can provide.<BR></FONT></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, November 13, 2008</h2>I would suspect that your subclass isn't marked as Serializable, or you have something in your BO that isn't marked as serializable.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Spencer replied on Thursday, November 13, 2008</h2><font size="2" face="Arial">You would think that was the case, but these objects work perfectly with CSLA 3.0.5. It's almost like the bug related to attempted serialization of declared events is back... <br><br>I never had to deal with it in 2.0, because it was fixed for the version of CSLA we were using for .net 2.0 before we started using CSLA. I do not want to create my own BusinessListBase to fix this though...&nbsp; <br><br>&nbsp;<br></font>&nbsp;<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, November 13, 2008</h2>Do you have any other information?&nbsp; I don't recall this bug in 2.x, and I'm using 3.6 beta 2 refresh without issue.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, November 13, 2008</h2><P>I don't think it is a BLB issue, at least in general. I say this because lots of people use 3.5, and a number of people use 3.6, and their classes work :)</P>
<P>Which is not to say there might not be some specific BLB feature that you are triggering that has a bug.</P>
<P>Nor is it to say that your code might not have some issue - though I appreciate that it worked in 3.0.x.</P>
<P><STRONG>So here's my current question: does it work in CSLA 3.0.x <EM>running on .NET 3.5</EM>? </STRONG>Since there are new compilers and framework changes in .NET 3.5, I know that there've been some small and subtle things that people have encountered just by switching runtimes - especially around reflection and code access security.</P>
<P>It seems pretty clear from your exception that something (your code, BLB, etc) is somehow holding a reference to a PropertyDescriptor object. BLB does interact with some PropertyDescriptor objects, so it is possible that there's an obscure&nbsp;bug where it somehow holds an instance reference to one of them.</P>
<P><STRONG>So here's another question: You can repeat this issue in both 3.5.2 and 3.6?</STRONG></P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Spencer replied on Thursday, November 13, 2008</h2><font size="2"><font face="Arial">Thank you very much for your help. </font></font><font size="2"><font face="Arial">This issue has been resolved. </font></font><font size="2"><font face="Arial">You were correct, it </font></font><font size="2"><font face="Arial">was a reference being held to a PropertyDescriptor object. <br><br></font></font><font size="2"><font face="Arial">I had to mark _SortPropertyCore as NonSerializable; a private field that I was using for the </font></font><font size="2" face="Arial"><b>BindingList<span class="cs">&lt;</span><span class="vb"></span><span class="nu"></span><span class="typeparameter">T</span><span class="cs">&gt;</span><span class="nu">.</span>SortPropertyCore</b> property. </font><font size="2"><font face="Arial">I honestly did not
anticipate having to change anything related to the sorting method
overrides I created to implement sorting in my list objects, so I did not even review that region for a PropertyDescriptor object. </font></font><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
