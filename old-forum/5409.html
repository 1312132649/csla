<html><header><title>Instance related rules for deleting objects</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Instance related rules for deleting objects</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5409.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>detritus posted on Tuesday, September 16, 2008</h2>Hi All,<br><br>I've seen some topics about this usually around the requirement to check if the BO is used in another BO before deleting it and recommendation usually is to solve it with Command object to help the UI, etc.<br><br>Our design dictates some system defined records in addition to user-definable ones. We don't want "any" user to delete system defined BOs. Other that some key value (like Id &lt; 0) there is no difference between system defined and user defined BO.<br><br>Where to check if the user is trying to delete a system defined BO? The only place I can think of is inside DataPortal_Delete but I'm not sure if this is correct. <br><br>TIA<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>IanK replied on Thursday, September 25, 2008</h2><P>Why not add a property to your object such as </P>
<P>Public&nbsp; ReadOnly Property IsDeletable() as boolean</P>
<P>&nbsp;&nbsp;&nbsp;<FONT color=#0000ff size=2>Get</P></FONT><FONT size=2>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CanReadProperty(</FONT><FONT color=#0000ff size=2>True</FONT><FONT size=2>)</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return</FONT><FONT size=2> (</FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.Id&nbsp; &lt; 0)</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Get</P></FONT>
<P>END PROPERTY</P>
<P>You could then bind the property to your enabled property of the delete button or simply check value prior to executing delete. This would avoid throwing exceptions and avoid a strip to next tier.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>detritus replied on Friday, September 26, 2008</h2>&gt; simply check value prior to executing delete<br>That's what I'm actually asking. Is this check should be done inside DataPortal_Delete? Should we do these kind of things inside methods talking with DAL or is there a better place to put these kinds of checks?<br><br>Thanks<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, September 26, 2008</h2><P>You should do it before getting to the DataPortal call.</P>
<P>1. So in your UI, if a user wants to click a Delete button it won't be enabled if it is bound to your BO in the new proeprty described earlier.</P>
<P>2. If for some reason the user manages to click the button anyway, then your BO code that calls DataPortal Delete can have a check in it prior to making the call. If the check fails, then don't make the call and return a message to the UI.</P>
<P>Joe</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>detritus replied on Friday, September 26, 2008</h2>Thanks Joe,<br><br>That will do the trick. It's strange though, with all the bells and whistles integrated in to the framework I expect this kind of thing already have its place. Spent a lot of time looking for a method to override :)<br><br>Sinan<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
