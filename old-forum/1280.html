<html><header><title>StringMinLength</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>StringMinLength</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1280.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>DeHaynes posted on Wednesday, September 20, 2006</h2><P>I am just wondering why there wasn't a StringMinLength in the Validation.CommonRules?</P>
<P>I added it, here is the code:</P><FONT color=#0000ff size=2>
<P>#region</FONT><FONT size=2> StringMinLength</P>
<P>[System.Diagnostics.CodeAnalysis.</FONT><FONT color=#008080 size=2>SuppressMessage</FONT><FONT size=2>(</FONT><FONT color=#800000 size=2>"Microsoft.Design"</FONT><FONT size=2>, </FONT><FONT color=#800000 size=2>"CA1062:ValidateArgumentsOfPublicMethods"</FONT><FONT size=2>)]</P>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>static</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>bool</FONT><FONT size=2> StringMinLength(</FONT><FONT color=#0000ff size=2>object</FONT><FONT size=2> target, </FONT><FONT color=#008080 size=2>RuleArgs</FONT><FONT size=2> e)<BR>{<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> min = ((</FONT><FONT color=#008080 size=2>MinLengthRuleArgs</FONT><FONT size=2>)e).MinLength;</FONT></P>
<P><FONT size=2>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (min &lt; 0)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min = 0;</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;string</FONT><FONT size=2> value = (</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2>)</FONT><FONT color=#008080 size=2>Utilities</FONT><FONT size=2>.CallByName(target, e.PropertyName, </FONT><FONT color=#008080 size=2>CallType</FONT><FONT size=2>.Get);<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (min == 0)<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (value == </FONT><FONT color=#0000ff size=2>null</FONT><FONT size=2>)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.Description = </FONT><FONT color=#008080 size=2>String</FONT><FONT size=2>.Format(</FONT><FONT color=#008080 size=2>Resources</FONT><FONT size=2>.StringMinLengthRule, e.PropertyName, min.ToString());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>false</FONT><FONT size=2>;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>;<BR>&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>else<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT size=2>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>if</FONT><FONT size=2> (</FONT><FONT color=#008080 size=2>String</FONT><FONT size=2>.IsNullOrEmpty(value) || (value.Length &lt; min))<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.Description = </FONT><FONT color=#008080 size=2>String</FONT><FONT size=2>.Format(</FONT><FONT color=#008080 size=2>Resources</FONT><FONT size=2>.StringMinLengthRule, e.PropertyName, min.ToString());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>false</FONT><FONT size=2>;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>else<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>true</FONT><FONT size=2>;<BR>&nbsp;&nbsp;&nbsp;}<BR>}</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>class</FONT><FONT size=2> </FONT><FONT color=#008080 size=2>MinLengthRuleArgs</FONT><FONT size=2> : </FONT><FONT color=#008080 size=2>RuleArgs<BR></FONT><FONT size=2>{<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> _minLength;<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;summary&gt;<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> Get the min length for the string.<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;/summary&gt;</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> MinLength<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>get</FONT><FONT size=2> { </FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> _minLength; }<BR>&nbsp;&nbsp;&nbsp;}</P>
<P></FONT><FONT color=#808080 size=2>&nbsp;&nbsp;&nbsp;///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;summary&gt;<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> Create a new object.<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;/summary&gt;<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;param name="propertyName"&gt;</FONT><FONT color=#008000 size=2>Name of the property to validate.</FONT><FONT color=#808080 size=2>&lt;/param&gt;<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;param name="minLength"&gt;</FONT><FONT color=#008000 size=2>Min length of characters allowed.</FONT><FONT color=#808080 size=2>&lt;/param&gt;<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>public</FONT><FONT size=2> MinLengthRuleArgs(</FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> propertyName, </FONT><FONT color=#0000ff size=2>int</FONT><FONT size=2> minLength) : </FONT><FONT color=#0000ff size=2>base</FONT><FONT size=2>(propertyName)<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_minLength = minLength;<BR>&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;summary&gt;<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> Return a string representation of the object.<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#808080 size=2>///</FONT><FONT color=#008000 size=2> </FONT><FONT color=#808080 size=2>&lt;/summary&gt;</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp;public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>override</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> ToString()<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>base</FONT><FONT size=2>.ToString() + </FONT><FONT color=#800000 size=2>"!"</FONT><FONT size=2> + _minLength.ToString();<BR>&nbsp;&nbsp;&nbsp;}<BR>}</P></FONT></FONT><FONT color=#0000ff size=2>
<P>#endregion</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DeHaynes replied on Wednesday, September 20, 2006</h2>You also need to add a description of the rule in the resources, for when there is an error.&nbsp; The name of the rule should be "<FONT size=2>StringMinLengthRule".&nbsp; For mine I used "{0} must be at least {1} characters".</FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, September 20, 2006</h2><P>Thanks.</P>
<P>In 2.1 Rocky changes the way to use ToString to code like this:</P>
<P><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> ToString() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>MyBase</FONT><FONT size=2>.ToString &amp; </FONT><FONT color=#ff00ff size=2>"?minLength="</FONT><FONT size=2> &amp; _minLength.ToString</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT></P>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DeHaynes replied on Wednesday, September 20, 2006</h2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>JoeFallon1:</strong></div><div>
<P>Thanks.</P>
<P>In 2.1 Rocky changes the way to use ToString to code like this:</P>
<P><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> ToString() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>MyBase</FONT><FONT size=2>.ToString &amp; </FONT><FONT color=#ff00ff size=2>"?minLength="</FONT><FONT size=2> &amp; _minLength.ToString</P>
<P></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT></P>
<P>Joe</P>
<P></div></BLOCKQUOTE></P>
<P>You are talking about the validation rules?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, September 20, 2006</h2><P>Yes. This code uses the old style.</P>
<P>I recommend using the newer style for RuleArgs.</P>
<P><FONT color=#0000ff>public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>override</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>string</FONT><FONT size=2> ToString()<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>return</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>base</FONT><FONT size=2>.ToString() + </FONT><FONT color=#800000 size=2>"!"</FONT><FONT size=2> + _minLength.ToString();<BR>&nbsp;&nbsp;&nbsp;}<BR>}</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, September 20, 2006</h2><P>Yes, in 2.1 the ToString value is used to build a URI for the rule, so the ToString method needs to return the correct part of the URI as Joe shows in a previous post.</P>
<P>For most people this may not matter, but this goes along with another 2.1 feature: the ability to get a list of all the rules for an object - and that list returns an array of string. Each string is a URI, and you can use System.Uri to parse them to find things like the rule name, property name, parameters,&nbsp; etc.</P>
<P>Obviously you can't use System.Uri if any part of the ToString chain doesn't play nicely <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, September 20, 2006</h2><P>Oh, and to answer the original question - why isn't this rule in CommonRules?</P>
<P>I knew from the start that I couldn't implement every rule out there. This one would make a good addition, no doubt about it.</P>
<P>But my hope is that there'll be an effort on CSLAcontrib to create a community-maintained validation rules library. That would make sense if there are enough commonly used rules that people build and would be willing to donate to such an effort.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
