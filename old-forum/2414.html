<html><header><title>CSLA Validation for Grid...error provider not blinking in grid cells.</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA Validation for Grid...error provider not blinking in grid cells.</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2414.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bhupesh posted on Friday, February 23, 2007</h2><P>Hi,</P>
<P>I am having some problems validating the grid using CSLA validation rules. I've included&nbsp;the necessary steps related to validation, which I think can be. The steps include:<BR>1) In the property named CustomerName in Customer class I've included the following two&nbsp;&nbsp; lines:<BR>- PropertyHasChanged(CustomerName);<BR>- ValidationRules.CheckRules(CustomerName);</P>
<P>2) Then added the following validation rules in the same class:<BR>- ValidationRules.AddRule(new RuleHandler(CommonRules.StringRequired),&nbsp;&nbsp;&nbsp; CustomerName);<BR>- ValidationRules.AddRule(CommonRules.StringMaxLength, new&nbsp;&nbsp;&nbsp;&nbsp; Csla.Validation.CommonRules.MaxLengthRuleArgs(CustomerName, 50));</P>
<P>3) Assigned the grid's Error on errorProvider1 to errorProvider1</P>
<P>4) Then for the grid added the following code:<BR>&nbsp;&nbsp; grdCustomer.DataMember = "CustomerList";<BR>&nbsp;&nbsp; grdCustomer.DataSource = _formBindingSource; //_formBindingSource an object of&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //BindingSource</P>
<P>&nbsp;&nbsp; errorProvider1.DataSource = _formBindingSource;<BR>&nbsp;&nbsp; errorProvider1.DataMember = "CustomerList";</P>
<P>But still I am unable to show the error provider in the grid cells despite when the rule breaks when the customer name is left blank or the specified characters exceeds 50.<BR>Though when the code is run by adding the watch window...it shows the rule broken and the message showing customer name required. Also IsValid() returns false.<BR>&nbsp;&nbsp; Do I've to include more steps in this or have to include a custom validation rule handler?<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Seeking help in this matter.</P>
<P>Thanks,<BR>Bhupesh</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, February 27, 2007</h2><P>I suggest you review Chapter 9 to see how the binding is handled.</P>
<P>You DO NOT need to call CheckRules() in a property set - that is already handled by PropertyHasChanged(), and you are just causing the rules to be checked twice, which is a waste.</P>
<P>You DO NOT need to use an ErrorProvider control with a grid. It won't actually do anything, because the grid control handles its own error status. ErrorProvider only works against things like TextBox.</P>
<P>I suggest using drag-and-drop from the Data Sources window in Visual Studio to set up your bindings. That's far simpler than trying to do it by hand. I suspect that you are not correctly setting the DataSource properties for the grid or your bindingsource - or perhaps you are doing them in the wrong order.</P>
<P>Even if you don't want to use drag-and-drop binding in your actual app (though I don't know why you wouldn't), I suggest you use it in a sample app and look at the resulting code - that will show you the correct way to set up the bindingsource and binding to the grid control.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bhupesh replied on Wednesday, March 28, 2007</h2><P>Hi Rocky,</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Thanks for your reply. I m pretty much sorry&nbsp;for replying late to your reply. Actually your concepts and tips regarding databinding&nbsp;and CheckRules hepled a lot. Also I was using the thirdparty control grid. So had to change some properties for the grid to support data error handling in that. So its running perfectly all right now.</P>
<P>&nbsp;</P>
<P>Thanks &amp; Regards,</P>
<P>Bhupesh</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
