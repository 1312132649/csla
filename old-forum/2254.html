<html><header><title>DevExpress LookupEdit</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>DevExpress LookupEdit</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2254.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>kdlc posted on Thursday, February 01, 2007</h2><P>How do i bind a NVL to a LookupEdit Control (DevExpress)?</P>
<P>On my InvoiceEdit form i have this:</P><FONT color=#800000 size=2><FONT color=#0000ff size=2>
<P>Public</FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT color=#000000 size=2>(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT color=#000000 size=2> NewInvoice </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2><FONT color=#000000> Invoice)<BR></FONT>InitializeComponent()<BR>mInvoice = NewInvoice<BR>LookUpEdit1.DataBindings.Add(</FONT><FONT color=#800000 size=2>"EditValue"</FONT><FONT size=2>, mInvoice, </FONT><FONT color=#800000 size=2>"EmployeeID"</FONT><FONT size=2>)<BR>LookUpEdit1.Properties.DataSource = EmployeeList.GetEmployeeList<BR></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.LookUpEdit1.Properties.DisplayMember = </FONT><FONT color=#800000 size=2>"Name"<BR></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.LookUpEdit1.Properties.ValueMember = </FONT><FONT color=#800000 size=2>"Id"<BR></FONT><FONT size=2>ApplyAuthorizationRules()<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT></P>
<P><FONT color=#0000ff size=2>but when i check the value of my mInvoice.EmployeeID prop on the event of the LookupEdit editvaluechanged the mInvoice.employeeID still = 0, am i overlooking something?</FONT></P>
<P><FONT color=#0000ff size=2>Thanks in Advance!</P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>razorkai replied on Thursday, February 01, 2007</h2><P>Two suggestions.</P>
<P>1).&nbsp;&nbsp;Change the line LookUpEdit1.DataBindings.Add(<FONT color=#800000 size=2>"EditValue"</FONT><FONT size=2>, mInvoice, </FONT><FONT color=#800000 size=2>"EmployeeID"</FONT><FONT size=2>) to be</FONT></P>
<P>LookUpEdit1.DataBindings.Add(<FONT color=#800000 size=2>"EditValue"</FONT><FONT size=2>, mInvoice, </FONT><FONT color=#800000 size=2>"EmployeeID", false, DataSourceUpdateMode.OnPropertyChanged</FONT><FONT size=2>)</FONT></P>
<P>Might not make a difference, but that is how I use it.</P>
<P>2)&nbsp; Check that the datatype of EmployeeID in mInvoice is exactly the same as the datatype of Id in your EmployeeList object.&nbsp; If they are even slightly different e.g. int and short it will not work.&nbsp;</P>
<P><FONT size=2><FONT size=3>Other than that can't see anything wrong.&nbsp; I use LookUpEdits with NVLs all the time</FONT>.</P>
<P><BR></FONT><FONT size=2>HTH</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, February 01, 2007</h2>The other suggestion I would add is to stick a BindingSource component between the LookupEdit and the actual BO collection.. I know this has solved problems in the past.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>kdlc replied on Thursday, February 01, 2007</h2><P>Allright Guys! i got it working using the following code:<BR><FONT color=#008000 size=2><BR>'Fill the lookupEdit Control - Employee<BR></FONT><FONT size=2>LookUpEdit1.Properties.DataSource = EmployeeList.GetEmployeeList<BR>LookUpEdit1.EditValue = </FONT><FONT color=#800000 size=2>"0"<BR></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.LookUpEdit1.Properties.DisplayMember = </FONT><FONT color=#800000 size=2>"Name"<BR></FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.LookUpEdit1.Properties.ValueMember = </FONT><FONT color=#800000 size=2>"Id"<BR></FONT><FONT color=#008000 size=2>'Bind Course.EmployeeID to LookupEdit control - Employee List<BR></FONT><FONT size=2>LookUpEdit1.DataBindings.Add(</FONT><FONT color=#800000 size=2>"EditValue"</FONT><FONT size=2>, mInvoice, </FONT><FONT color=#800000 size=2>"EmployeeID"</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>False</FONT><FONT size=2>, DataSourceUpdateMode.OnPropertyChanged)</FONT></P>
<P>Also in the control props i didn't set any properties&nbsp;(if anyone its wondering about that) and this code its located on the Public Sub New&nbsp;of the FormEdit.</P>
<P>Thanks for the Help!&nbsp;</P>
<P><FONT size=2>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>cash_pat replied on Thursday, February 01, 2007</h2>Just to pitch in.<br><br>If you are using PivotGrid from DevExpress then the ''case'' of your properties in your BO must exactly match to ur DevExpress Pivotgrid fieldnames<br><br>I have a spent many a nights trying to figure this bug. <br><br>regards<br><br>pat cash<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
