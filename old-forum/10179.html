<html><header><title>Sync Rule in Server and Async in Client</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Sync Rule in Server and Async in Client</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10179.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ranjini posted on Friday, March 18, 2011</h2><p>CSLA 4/ Silverlight 4</p>
<p>I have a &quot;IsExists&quot; rule to check for duplicate object with the same name. This rule was initially set up as an Async rule that triggers a command object.&nbsp; I am trying to modify it , so it runs async ONLY if it is executed on client/silverlight. I am not having much success. Can someone fill&nbsp; in the blanks for me ?</p>
<p>Here is the code - </p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp; </span></span><span style="font-family:Consolas;color:blue;font-size:9pt;mso-bidi-font-size:9.5pt;">public</span><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"> <span style="color:blue;">class</span> <span style="color:#2b91af;">DuplicateRule</span> : Csla.Rules.<span style="color:#2b91af;">BusinessRule</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">public</span> Csla.Core.<span style="color:#2b91af;">IPropertyInfo</span> IdProperty { <span style="color:blue;">get</span>; <span style="color:blue;">set</span>; }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">public</span> DuplicateRule (Csla.Core.<span style="color:#2b91af;">IPropertyInfo</span> primaryProperty, Csla.Core.<span style="color:#2b91af;">IPropertyInfo</span> idProperty)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>: <span style="color:blue;">base</span>(primaryProperty)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IsAsync = (Csla.<span style="color:#2b91af;">ApplicationContext</span>.LogicalExecutionLocation != <span style="color:#2b91af;">ApplicationContext</span>.<span style="color:#2b91af;">LogicalExecutionLocations</span>.Server);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IdProperty = idProperty;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>InputProperties = <span style="color:blue;">new</span> <span style="color:#2b91af;">List</span>&lt;Csla.Core.<span style="color:#2b91af;">IPropertyInfo</span>&gt;();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>InputProperties.Add(primaryProperty);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>InputProperties.Add(idProperty);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">protected</span> <span style="color:blue;">override</span> <span style="color:blue;">void</span> Execute (Csla.Rules.<span style="color:#2b91af;">RuleContext</span> context)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:blue;">var</span> name = (<span style="color:blue;">string</span>)context.InputPropertyValues[PrimaryProperty];</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">var</span> Id = (<span style="color:#2b91af;">Guid</span>)context.InputPropertyValues[IdProperty];</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (IsAsync)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">DomainExists</span> command = <span style="color:blue;">new</span> <span style="color:#2b91af;">DomainExists</span>(name, Id);<span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">DataPortal</span>&lt;<span style="color:#2b91af;">DomainExists</span>&gt; dpCmd = <span style="color:blue;">new</span> <span style="color:#2b91af;">DataPortal</span>&lt;<span style="color:#2b91af;">DomainExists</span>&gt;();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dpCmd.ExecuteCompleted += (o, e) =&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (e.Error != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;</span>context.AddErrorResult(e.Error.Message);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">else</span> <span style="color:blue;">if</span> (e.Object.IsExists)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.AddErrorResult(<span style="color:#a31515;">&quot;This domain name already exists.&quot;</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.Complete();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>};</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dpCmd.BeginExecute(command);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">else</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-size:small;"><b style="mso-bidi-font-weight:normal;"><span style="font-family:Consolas;color:red;mso-bidi-font-size:9.5pt;">&hellip;What goes here&hellip;.</span></b><b style="mso-bidi-font-weight:normal;"><span style="font-family:Consolas;color:red;font-size:9pt;mso-bidi-font-size:9.5pt;"></span></b></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9pt;mso-bidi-font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p>
<p>Thanks</p>
<p>Ranjini</p>
<p>&nbsp;</p>
</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Sunday, March 20, 2011</h2><p>Since Silverlight has async methods only you probably need to add a compiler directive so the sync code only runs in .NET.</p>
<p>You should test for ExecutionLocation (and not LogicalExecutionLocation) and the rule should look like this: </p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9.5pt;"><span>&nbsp; </span></span><span style="font-family:Consolas;color:blue;font-size:9pt;">public</span><span style="font-family:Consolas;font-size:9pt;"> <span style="color:blue;">class</span> <span style="color:#2b91af;">DuplicateRule</span> : Csla.Rules.<span style="color:#2b91af;">BusinessRule</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">public</span> Csla.Core.<span style="color:#2b91af;">IPropertyInfo</span> IdProperty { <span style="color:blue;">get</span>; <span style="color:blue;">set</span>; }</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">public</span> DuplicateRule (Csla.Core.<span style="color:#2b91af;">IPropertyInfo</span> primaryProperty, Csla.Core.<span style="color:#2b91af;">IPropertyInfo</span> idProperty)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>: <span style="color:blue;">base</span>(primaryProperty)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IsAsync = (Csla.<span style="color:#2b91af;">ApplicationContext</span>.ExecutionLocation != <span style="color:#2b91af;">ApplicationContext</span>.<span style="color:#2b91af;">ExecutionLocations</span>.Server);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IdProperty = idProperty;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>InputProperties = <span style="color:blue;">new</span> <span style="color:#2b91af;">List</span>&lt;Csla.Core.<span style="color:#2b91af;">IPropertyInfo</span>&gt;();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>InputProperties.Add(primaryProperty);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>InputProperties.Add(idProperty);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">protected</span> <span style="color:blue;">override</span> <span style="color:blue;">void</span> Execute (Csla.Rules.<span style="color:#2b91af;">RuleContext</span> context)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color:blue;">var</span> name = (<span style="color:blue;">string</span>)context.InputPropertyValues[PrimaryProperty];</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">var</span> Id = (<span style="color:#2b91af;">Guid</span>)context.InputPropertyValues[IdProperty];</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (IsAsync)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">DomainExists</span> command = <span style="color:blue;">new</span> <span style="color:#2b91af;">DomainExists</span>(name, Id);<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">DataPortal</span>&lt;<span style="color:#2b91af;">DomainExists</span>&gt; dpCmd = <span style="color:blue;">new</span> <span style="color:#2b91af;">DataPortal</span>&lt;<span style="color:#2b91af;">DomainExists</span>&gt;();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dpCmd.ExecuteCompleted += (o, e) =&gt;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">if</span> (e.Error != <span style="color:blue;">null</span>)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&nbsp;&nbsp;&nbsp;</span>context.AddErrorResult(e.Error.Message);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">else</span> <span style="color:blue;">if</span> (e.Object.IsExists)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.AddErrorResult(<span style="color:#a31515;">&quot;This domain name already exists.&quot;</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.Complete();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>};</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dpCmd.BeginExecute(command);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:blue;">else</span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // use sync dataportal</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;">#if !SILVERLIGHT<br /></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">DomainExists</span> command = <span style="color:blue;">new</span> <span style="color:#2b91af;">DomainExists</span>(name, Id);<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">DataPortal</span>&lt;<span style="color:#2b91af;">DomainExists</span>&gt; dpCmd = <span style="color:blue;">new</span> <span style="color:#2b91af;">DataPortal</span>&lt;<span style="color:#2b91af;">DomainExists</span>&gt;();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-size:small;"><b><span style="font-family:Consolas;color:red;"></span></b><b><span style="font-family:Consolas;color:red;font-size:9pt;"></span></b></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dpCmd.Execute(command);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span style="color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if</span> (command.IsExists)</span>
</p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.AddErrorResult(<span style="color:#a31515;">&quot;This domain name already exists.&quot;</span>);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;">#endif<br /></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;">&nbsp;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ranjini replied on Sunday, March 20, 2011</h2><p>Thanks for your response..</p>
<p>I did try that but it gives me this exception</p>
<p>&nbsp;&#39;Csla.DataPortal&lt;DomainExists&gt;&#39; does not contain a definition for &#39;Execute&#39; and no extension method &#39;Execute&#39; accepting a first argument of type &#39;Csla.DataPortal&lt;DomainExists&gt;&#39; could be found (are you missing a using directive or an assembly reference?)&nbsp;</p>
<p>DomainExists is a CommandBase object with a dataportal_execute implemented so..</p>
<p>&nbsp;protected override void DataPortal_Execute()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using (var dalFactory = DAL.DalFactory.GetManager())<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var dal = dalFactory.GetProvider&lt;DAL.IDomainDal&gt;();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; using (var dr = new SafeDataReader(dal.Fetch((new DomainCriteria() { Name = Name}).StateBag)))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while (dr.Read())<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (dr.GetGuid(&quot;Id&quot;) != Id)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IsExists = true;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Sunday, March 20, 2011</h2><p>Try this: </p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;">#if !SILVERLIGHT<br /></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:#2b91af;">DomainExists</span> command = <span style="color:blue;">new</span> <span style="color:#2b91af;">DomainExists</span>(name, Id);<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-size:small;"><b><span style="font-family:Consolas;color:red;"></span></b><b><span style="font-family:Consolas;color:red;font-size:9pt;"></span></b></span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; command = </span><span style="font-family:Consolas;font-size:9pt;"><span></span><span style="color:#2b91af;">DataPortal</span></span><span style="font-family:Consolas;font-size:9pt;">.Execute&lt;</span><span style="font-family:Consolas;font-size:9pt;"><span></span><span style="color:#2b91af;">DomainExists</span>&gt;</span><span style="font-family:Consolas;font-size:9pt;">(command);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span style="color:blue;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if</span> (command.IsExists)</span>
</p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;"><span style="font-family:Consolas;font-size:9pt;"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>context.AddErrorResult(<span style="color:#a31515;">&quot;This domain name already exists.&quot;</span>);</span></p>
<p>
<span style="font-family:Consolas;font-size:9pt;">#endif</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ranjini replied on Sunday, March 20, 2011</h2><p>Thanks Jonny.. That did compile. However, can you explain to me </p>
<p>1) The usecases for LogicalExecutionLocation vs ExecutionLocation</p>
<p>In my case , when I change it to ExecutionLocation, since it is returned as &quot;Client&quot; , it takes the async path .. What I am trying to do here is write a test method to exercise this rule on the server side and I dont want any async calls made.</p>
<p>2) Why DataPortal.Execute gives me a compile error?</p>
<p>Please help!</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Sunday, March 20, 2011</h2><p>1.&nbsp; ExecutionLocation returns Client or Server depending on whether the code is actually executing on the client or server.&nbsp; If you&#39;re using the local data portal, this will ALWAYS return Client since there is no server tier.&nbsp; Logical returns Client or Server based on whether you&#39;re logically on the client or server.&nbsp; For for local data portal, if you&#39;re actually executing code &quot;in the data portal&quot; it will return server.&nbsp; Otherwise it will return client.</p>
<p>2.&nbsp; DataPortal.Execute static method&nbsp;is only available in .Net.&nbsp; In Silverlight, only the DataPortal instance member exist.&nbsp; Remember, code in Silverlight is a different runtime based on .Net 2.&nbsp; The normal .Net runtime is what most people are used to.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ranjini replied on Sunday, March 20, 2011</h2><p>Thanks Andy.. I get (2), but I am still a little unclear on (1) and that may just be because I am not a CSLA pro... My solution is primarily a silverlight application, with a silverlight project, a business.client and a business.server set up. I am now in the process of testing JUST business.server and I started this conversation thread when I realised i cannot do this test unless i redid all my &quot;IsExists&quot; rules to handle client and server differently (async on client and sync on server). </p>
<p>When debugging the&nbsp;test project, I am noticing that when I try to run this rule(by changign the value of the primary property), it shows my executionlocation as &quot;Client&quot;&nbsp; but my logicalexecutionlocation as &quot;Server&quot;. I am having a hard time wrapping my head around why this might be.</p>
<p>Thanks again for taking the time... </p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Sunday, March 20, 2011</h2><p>If you use LogicalExecutionLocation your rule will be async or sync depending on whether the first instance is created in a DataPortal call or directly on the client. When using Local DataPortal your code is running in the same instance and should not try to switch between client/server. </p>
<p>ExecutionLocation is Server if the DataPortal has IsRemoteDataPortal == true. </p>
<p>LogicalExecutionLocation is Server when you are in a DataPortal call</p>
<p>So in your case - ExecutionLocation is Client because you are running in the client instance and logical execution location is Server because you code is executing in the &quot;serverside&quot; of the DataPortal.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ranjini replied on Monday, March 21, 2011</h2><p>In which case then I should change my rule constructor to say </p>
<p><span style="font-family:Calibri;color:#000000;font-size:small;">
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp; </span><span style="color:blue;">public</span> DuplicateRule (Csla.Core.<span style="color:#2b91af;">IPropertyInfo</span> primaryProperty, Csla.Core.<span style="color:#2b91af;">IPropertyInfo</span> idProperty)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>: <span style="color:blue;">base</span>(primaryProperty)</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IsAsync = (Csla.<span style="color:#2b91af;">ApplicationContext</span>.ExecutionLocation == <span style="color:#2b91af;">ApplicationContext</span>.<span style="color:#2b91af;">ExecutionLocations</span>.Silverlight);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IdProperty = idProperty;</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>InputProperties = <span style="color:blue;">new</span> <span style="color:#2b91af;">List</span>&lt;Csla.Core.<span style="color:#2b91af;">IPropertyInfo</span>&gt;();</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>InputProperties.Add(primaryProperty);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>InputProperties.Add(idProperty);</span></p>
<p class="MsoNormal" style="line-height:normal;margin:0in 0in 0pt;mso-layout-grid-align:none;"><span style="font-family:Consolas;font-size:9.5pt;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>
<p class="MsoNormal"><span style="font-family:Calibri;color:#000000;font-size:small;">Would that be correct?</span></p>
</span></p>
<p class="MsoNormal">&nbsp;</p>
<p>&nbsp;</p>
<p class="MsoNormal"><span style="font-family:Calibri;color:#000000;font-size:small;">Thanks much for taking the time to answer my questions</span></p>
<p class="MsoNormal"><span style="font-family:Calibri;color:#000000;font-size:small;">Ranjini</span></p>
<p><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;"><span style="font-family:Consolas;color:#0000ff;font-size:x-small;">
<p>&nbsp;</p>
</span></span></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, March 22, 2011</h2><p>For your app it would work fine, however for a more general solution I&#39;d prefer: </p>
<p><span style="font-family:Calibri;color:#000000;font-size:small;"><span style="font-family:Consolas;font-size:9.5pt;"><span> </span>IsAsync = (Csla.<span style="color:#2b91af;">ApplicationContext</span>.ExecutionLocation != <span style="color:#2b91af;">ApplicationContext</span>.<span style="color:#2b91af;">ExecutionLocations</span>.Server);</span></span></p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
