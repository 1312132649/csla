<html><header><title>BusinessBaseList and Remove(item)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>BusinessBaseList and Remove(item)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4614.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dirtbert posted on Thursday, April 03, 2008</h2><P>I have a collection implemented with BusinessBaseList, when I call the Remove(item) on the collection I can see the item move from the collection to the deleted items list.</P>
<P>What do I need to do in my collection implementation to get the Child_DeleteSelf to be called when I save the collection?</P>
<P>Or more generally, how does the deleted items list get cleared when the list is saved?</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>triplea replied on Friday, April 04, 2008</h2><P>Assuming you are using CSLA 3.x then (and I am quoting PTracker) this should be sufficient:</P><FONT size=2>
<P>RaiseListChangedEvents = </FONT><FONT color=#0000ff size=2>false</FONT><FONT size=2>;</P>
<P></FONT><FONT color=#008000 size=2>// update (thus deleting) any deleted child objects<BR></FONT><FONT color=#0000ff size=2>foreach</FONT><FONT size=2> (</FONT><FONT color=#2b91af size=2>ResourceAssignment</FONT><FONT size=2> item </FONT><FONT color=#0000ff size=2>in</FONT><FONT size=2> DeletedList)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item.DeleteSelf(resource);<BR></FONT><FONT color=#008000 size=2>// now that they are deleted, remove them from memory too<BR></FONT><FONT size=2>DeletedList.Clear();</P></FONT>
<P>If your list is a rot list (so not a child list of a root parent object) then just make sure you use the transactional attribute of manually start your transaction in your dataportal.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>archimedes replied on Tuesday, August 12, 2008</h2><FONT size=2>The ResourceAssignment class in PTracker inherits from </FONT>
<P><FONT size=2>BusinessBase&lt;<FONT color=#2b91af>ResourceAssignment</FONT>&gt;, which as far as I can tell in 3.x (I'm using 3.5), there is no DeleteSelf method defined.&nbsp; There is a private void Child_DeleteSelf on ResourceAssignment in the PTracker solution, but the question would be "how do you invoke that method via the data portal?".&nbsp; DataPortal.Delete&lt;T&gt;(..) calls the DataPortal_DeleteABC, but no permutation of Child_DeleteABC.</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Tuesday, August 12, 2008</h2><P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>archimedes:</strong></div><div><FONT size=2>There is a private void Child_DeleteSelf on ResourceAssignment in the PTracker solution, but the question would be "how do you invoke that method via the data portal?".&nbsp; DataPortal.Delete&lt;T&gt;(..) calls the DataPortal_DeleteABC, but no permutation of Child_DeleteABC.</FONT></div></BLOCKQUOTE></P>
<P>I'd think you would already be on the "server" side of the data portal when saving changes to a BusinessListBase (BLB) and could invoke child deletion methods directly rather than making further calls over the portal. (e.g. you're already in DataPortal_Update of the BLB when updating/removing the child objects)</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Tuesday, August 12, 2008</h2><P>Right. One of the enhancements in 3.5, to reduce code, is that BLB contains code to automatically call the right methods on all the items in the collection.</P>
<P>If the BLB is your root object, you do need to override DataPortal_Update(), but in that method you'd just call base.Child_Update() and let BLB do the work.</P>
<P>If the BLB is a child of some other object, it is entirely automatic and you shouldn't have to worry about it at all.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
