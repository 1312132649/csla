<html><header><title>Data binding to an index property of a collection</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Data binding to an index property of a collection</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5190.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>boon3333 posted on Sunday, August 03, 2008</h2><P>Hello:<BR><BR>We are currently using CLSA for our development. One of our implementation is to allow for dyamic variables for the object. It is like binding to&nbsp;key&nbsp;in&nbsp;dictionary object. As such we are using index property to do data binding to an element of collection. However, the code does not seems to work properly. If any one can point us to a direction, it will be a great help. We have create the follow code as proof of concept to test it out:<BR><BR>[The following is the code for the object in questions:]<BR>using System;<BR>using System.Collections.Generic;<BR>using System.Linq;<BR>using System.Text;<BR>using System.ComponentModel;<BR>using System.Xml.Linq;<BR>using System.Windows;<BR><BR>namespace UIWpf<BR>{<BR>public class Person : IDataErrorInfo<BR>{<BR>private Guid id;<BR><BR>public Guid Id<BR>{<BR>get{ return id; }<BR>set{ id = value; }<BR>}<BR><BR>private int age;<BR><BR>public int Age<BR>{<BR>get{ return age; }<BR>set{ age = value; }<BR>}<BR><BR>private XElement data;<BR><BR>public object this[string key]<BR>{<BR>get<BR>{<BR>return (from el in data.Elements()<BR>where el.Name == key<BR>select el.Value).First();<BR>}<BR>set<BR>{<BR>data.Element(key).Value = value.ToString();<BR><STRONG>string a = ((IDataErrorInfo)this)["["+key+"]"];<BR><BR></STRONG>}<BR>} <BR><BR>public Person()<BR>{<BR>id = Guid.NewGuid();<BR>age = 156;<BR>data = new XElement("Data",<BR>new XElement("Name", "Henstar"),<BR>new XElement("Description", "Hello, Henstar") <BR>);<BR>}<BR><BR>public void Save()<BR>{<BR>MessageBox.Show(data.ToString());<BR>}<BR><BR>string IDataErrorInfo.Error<BR>{<BR>get<BR>{<BR>return null;<BR>}<BR>} <BR><BR>string IDataErrorInfo.this[string key]<BR>{<BR>get<BR>{<BR>string result = null;<BR><BR>if (key == "Age")<BR>{<BR>if (this.age &lt; 0 || this.age &gt; 150)<BR>{<BR><BR>result = "Age must not be less than 0 or greater than 150.";<BR>}<BR>}<BR><BR>if (key == "[Name]")<BR>{<BR>if (data.Element("Name").Value.Length &gt; 5)<BR>{<BR>result = "Name length can't exceed to 10";<BR>}<BR>}<BR><BR>return result;<BR>}<BR>}<BR>}<BR>}<BR><BR>[The following is the code for the window class]<BR>&lt;Window x:Class="UIWpf.Window1"<BR>xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"<BR>xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"<BR>Title="Window1" Height="300" Width="500"&gt;<BR>&lt;Grid&gt;<BR>&lt;Grid.Resources&gt;<BR><BR>&lt;/Grid.Resources&gt;<BR>&lt;StackPanel Name="splData"&gt;<BR>&lt;DockPanel Margin="10,10,10,10"&gt;<BR>&lt;Label Width="80"&gt;ID:&lt;/Label&gt;<BR>&lt;TextBox Width="200" Text="{Binding Path=Id, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" /&gt;<BR>&lt;/DockPanel&gt;<BR>&lt;DockPanel Margin="10,10,10,10"&gt;<BR>&lt;Label Width="80"&gt;Age:&lt;/Label&gt;<BR>&lt;TextBox Width="200" Text="{Binding Path=Age, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" /&gt;<BR>&lt;/DockPanel&gt;<BR>&lt;DockPanel Margin="10,10,10,10"&gt;<BR>&lt;Label Width="80"&gt;Name:&lt;/Label&gt;<BR>&lt;TextBox Width="200" Text="{Binding Path=[Name], Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" /&gt;<BR>&lt;/DockPanel&gt;<BR>&lt;DockPanel Margin="10,10,10,10"&gt;<BR>&lt;Label Width="80"&gt;Description:&lt;/Label&gt;<BR>&lt;TextBox Width="200" Text="{Binding Path=[Description], Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" /&gt;<BR>&lt;/DockPanel&gt;<BR>&lt;DockPanel Margin="10,10,10,10"&gt;<BR>&lt;Button Width="80" Click="Button_Click"&gt;Save&lt;/Button&gt;<BR>&lt;/DockPanel&gt;<BR>&lt;/StackPanel&gt;<BR>&lt;/Grid&gt;<BR>&lt;/Window&gt;<BR><BR>The symtom: The data binding work properly for Age but does not work for index property for [Name]. We suspect that IDataErrorInfo does not recognize the index property [key] and so we attempt to pass in key with [] added as above but it still&nbsp;does not work.<BR><BR>Please advice whether it is possible to do data binding to an element of a collection in the first place and if so, how can I get it to work properly. I am new to this so please forgive me if the question is a bid stupid. <BR><BR>Thank. </P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, August 04, 2008</h2><P>Data binding binds to the "native interface" of an object, not secondary interfaces.</P>
<P>In other words, data binding can only use the public properties defined directly on your object.</P>
<P>An interface like IDataErorrInfo is normally implemented in a non-public manner. Your public implementation is very non-standard, and will probably cause you problems at some point (because you are "wasting" your one indexer in an inappropriate manner).</P>
<P>But your particular issue is that your object is NOT a collection. Just because an object has an indexer doesn't make it a collection - at least not to most of .NET. What makes an object a collection is whether it implements one or more of the collection interfaces.</P>
<P>At the VERY least you need IEnumerable and/or IEnumerable&lt;T&gt;. Probably you need IList/IList&lt;T&gt; and maybe ICollection/ICollection&lt;T&gt;. Which interfaces you need to implement will vary depending on what parts of .NET you are using, and how much collection functionality they require.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>boon3333 replied on Monday, August 04, 2008</h2>Thanks</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
