<html><header><title>ChildChanged Event not firing in CSLA 4.3 when using SQL Server Session State</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ChildChanged Event not firing in CSLA 4.3 when using SQL Server Session State</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11690.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>mtavares posted on Friday, November 09, 2012</h2><p>I&#39;ve run into an issue switching my Session type from InProc to SQL Server. &nbsp;Basically, a validation rule on the parent is not being re-run when my child collection has been changed. &nbsp;It seems that the ChildChanged event is no longer firing when I change something in the child collection. &nbsp; Based on looking at past posts it sounds like it could be a deserialization issue where my events are not being re-hooked. &nbsp;But according to Rocky&#39;s response in this post: &nbsp;<a href="http://forums.lhotka.net/forums/p/4617/22514.aspx">http://forums.lhotka.net/forums/p/4617/22514.aspx</a>&nbsp;As of Csla 3.5 the child events are re-hooked automatically. &nbsp;I&#39;m assuming they should still be automatically re-hooked upon deserialization in 4.3, but can anyone tell me if this is not the case? &nbsp;And if not, what do I need to do to re-hook my events?</p>
<p>&nbsp;</p>
<p>Thanks,</p>
<p>Mike</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Friday, November 09, 2012</h2><p>My preference (as long as this is encapsulated) is to override OnChildChanged method and add the code there rather than hooking into the events with an event handler.&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mtavares replied on Friday, November 09, 2012</h2><p>Ok, changing it to use the override worked, and luckily I will only need to change it in a handful of places. But, is this considered a bug? &nbsp;Should CSLA 4.3 be automatically re-hooking the events upon deserialization?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Saturday, November 10, 2012</h2><p>I believe the situation is as follows;</p>
<p>CSLA will rehook the ChildChanged event handler for child collection but NOT rehook YOUR event handler that you set to listen for ChildChanged. So the child changed event is raised (as proof by the OnChildChanged method is called) but YOUR eventhandler code is not called because it is unknown after deserialization. </p>
<p><b>So - it is your responsibility to rehook your event hooks by overriding OnAddEventHooks and OnRemoveEventHooks to add/remove your own event hooks. </b></p>
<p>Which is why I prefer to override the On.... methods - as this also allows me to chose whether my own code runs before or after the event is raised (sometimes I want to make sure that my own code runs first ) as there is no guarantee for that in an event handler</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mtavares replied on Saturday, November 10, 2012</h2><p>That makes perfect sense. &nbsp;Thanks Jonny for both the answer and the explanation. &nbsp;I appreciate your help.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
