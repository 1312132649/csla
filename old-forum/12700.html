<html><header><title>Object Design Question</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Object Design Question</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/12700.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>MadGerbil posted on Wednesday, July 16, 2014</h2><p>I&#39;ve the following object graph:</p>
<p>Client Singleton<br />Charges Collection<br />Payments Collection<br />ChargePayments Collection</p>
<p>The Client object has the 3 collections as child objects.<br />The Charges collection holds a collection of all charges to the client.<br />The Payment collection holds a collection of all payments to the client.<br />The ChargePayments collection manages the many to many relationships bewteen Charges and Payments.</p>
<p>The balance on a charge is the total of all amount applied to that charge as located in the ChargePayments collection.<br />The amount applied for a payment is the total of all amount applied for that payment located in the ChargePayments collection.</p>
<p>When a payment is deleted (this can happen while creating the record) all the ChargePayments related to that payment are deleted which means the totals on any Charges that used that payment need to be updated.<br />Likewise, if a charge is deleted the ChargePayments related to that Charge are deleted and the amount applied for each of the Payments needs to be updated.</p>
<p>Long story short, the removal of items in the ChargePayments collection (and addition of items) needs to cause each member of the Charges and Payments collections to update their totals.</p>
<p>POSSIBLE FIXES<br />1: Should this be managed by the parent object such that the parent Client object flips through children collections updating values<br />2: Should each Charge and each Payment have a reference to the ChargePayments collection and update themselves when the ChargePayments collection changes <br />3: Is there a better way altogether to handle this?</p>
<div></div></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Tuesday, July 22, 2014</h2><p>The less objects know about each other (or reference each other) the better - as a general rule.</p>
<p>I&#39;d probably have the root object listen for ChildChanged events and use that knowledge to tell the correct child object graphs to update themselves as necessary.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MadGerbil replied on Thursday, July 31, 2014</h2><p>That is the route I ended up taking - it not only preserves the object integrity but it is the easiest to work with by far.</p>
<p>&nbsp;</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
