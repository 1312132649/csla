<html><header><title>Generic NameValueListBase class</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Generic NameValueListBase class</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5495.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>abhicbsa posted on Tuesday, September 30, 2008</h2>Can i create a generic class for fetching (name, value) type of data.<br>I have many comboboxes in my pages that i need to populate.<br>Creating separate classes for every table doesn't make any sense (to me anyway i may be wrong here).<br><br>Should i create only one class where i will pass table name, id column name, value column name&nbsp; as parameters.<br><br>Thanks,<br>Abhi<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>sergeyb replied on Tuesday, September 30, 2008</h2>






 

 
  
 




<div class=Section1>

<p class=MsoNormal><span>I have done this before.&nbsp; I had a generic NVLB class that
would accept enumeration on GetBlahBlah, the convert the enum to stored
procedure name, and just read first column as ID, second column as name.&nbsp;
Having said that, I do not recommend doing this because it is hard to secure
such asset via authorization rules and you have tight coupling between possibly
unrelated classes.<o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><b><span>Sergey Barskiy<o:p></o:p></span></b></p>

<p class=MsoNormal><b><i><span>Principal Consultant<o:p></o:p></span></i></b></p>

<p class=MsoNormal><span>office: 678.405.0687 |
mobile:&nbsp;404.388.1899<o:p></o:p></span></p>

<p class=MsoNormal><b><i><span>Magenic</span></i></b><span> </span><span>&reg;</span><b><i><span><o:p></o:p></span></i></b></p>

<p class=MsoNormal><b><span>Microsoft Worldwide Partner of the Year |</span></b><span> </span><b><span>Custom
Development Solutions, Technical Innovation</span></b><span><o:p></o:p></span></p>

<p class=MsoNormal><span><o:p>&nbsp;</o:p></span></p>

<div>

<p class=MsoNormal><b><span>From:</span></b><span> abhicbsa
[mailto:cslanet@lhotka.net] <br>
<b>Sent:</b> Tuesday, September 30, 2008 8:08 AM<br>
<b>To:</b> Sergey Barskiy<br>
<b>Subject:</b> [CSLA .NET] Generic NameValueListBase class<o:p></o:p></span></p>

</div>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Can i create a generic class for fetching (name, value) type
of data.<br>
I have many comboboxes in my pages that i need to populate.<br>
Creating separate classes for every table doesn't make any sense (to me anyway
i may be wrong here).<br>
<br>
Should i create only one class where i will pass table name, id column name,
value column name&nbsp; as parameters.<br>
<br>
Thanks,<br>
Abhi<br>
<br>
<br>
<o:p></o:p></p>

</div>



</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Tuesday, September 30, 2008</h2><P>"Can i create a generic class for fetching (name, value) type of data."</P>
<P>Yes you can. But should you?</P>
<P>I have done it with similar classes and it works but is not very OO and can get unwieldy over time. </P>
<P>It is recommended that you create separate classes for each. Yes you have more files but stick them all in a folder and hide them. You will probably appreciate it in the long run.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Tuesday, September 30, 2008</h2><P>We did something in between a single generic class and completely separate classes:</P>
<P>1. Most of the functionality is indeed identical (loading data, populating list, etc.), so this is in a common base that derives from NameValueListBase.</P>
<P>2.&nbsp;We did was have our DTO's implement an interface if they want to be "generically" loadable into a NameValueListBase -derived class:</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>interface</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>INameValueBase</FONT></FONT><FONT size=2>&lt;K, V&gt;</P>
<P>{</P></FONT><FONT size=2>
<P></FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>NameValueListBase</FONT></FONT><FONT size=2>&lt;K, V&gt;.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>NameValuePair</FONT></FONT><FONT size=2> ToNameValuePair();</P>
<P>}</P></FONT>
<P>3. Our DTO's all derive from a common class, so the generic class in (1) can safely access their fetch methods to populate the list. The interface in (2) provides for construction of the data to be stored in the list.</P>
<P>The end result of this is that we do have individual class files for each NVLB class, but they are tiny -- usually just the class declaration. </P>
<P>Here is an example: (ItemType is the DTO that will populate the list, and it's a list of int+string pairs)</P><FONT size=2>
<P>[</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Serializable</FONT></FONT><FONT size=2>()]</P>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>class</FONT></FONT><FONT size=2> </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ItemTypeList</FONT></FONT><FONT size=2> : </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>WORMapperNameValueListBase</FONT></FONT><FONT size=2>&lt;</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>int</FONT></FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2>, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ItemType</FONT></FONT><FONT size=2>, </FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>ItemTypeList</FONT></FONT><FONT size=2>&gt;</P>
<P>{</P>
<P>}</P></FONT>
<P>&nbsp;</P>
<P>&nbsp;</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
