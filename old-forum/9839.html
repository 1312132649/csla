<html><header><title>Data binding problem when property value does not exist in a bound list (WinForms)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Data binding problem when property value does not exist in a bound list (WinForms)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9839.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>CBoland posted on Tuesday, December 07, 2010</h2><p>I&#39;m running into a problem with databinding via BindingSource when the property of my business object has a value that does not exist in a bound list (say, a combobox). <br /><br />For example, the form displays a list of states/regions; in this case the 50 U.S. states. My business object&#39;s .Region property has been initialized to a region not in that list, say Puerto Rico. I bind these together on a form so that the user can select a Region for the object.<br /><br />When the .Region value exists in the list, the combobox is positioned to the correct value. However, as in this example, when the .Region value does not exist in the list, the combobox defaults to the first item, but the object is not updated accordingly. In this case, the screen is misleading: the combobox displays the first item in the list (AK - Alaska), but the underlying business object is still set to PR - Puerto Rico.<br /><br />I&#39;ve tried tapping the various events on BindingSource, checking for this condition and setting the object&#39;s value to the first value in the list. This works, but now I&#39;m manually updating objects which questions databinding in the first place. I like databinding, but this breaks my trust when binding to lists. <br /><br />Has anyone addressed this problem?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael replied on Tuesday, December 07, 2010</h2><p>I thought the combo box should show nothing for the displayed value if the business object&#39;s property does not match a value in the list. I just did a quick test and that&#39;s how it behaves for me.</p>
<p>What I often do is have a &quot;(Not selected)&quot; display item in the combo box with a bound value of 0 or Guid.Empty or whatever is appropriate, and then on the business object initialise the property to this value, and validate it to say it&#39;s required. It forces the user to make a selection, which is sometimes a good idea, too.</p>
<p>Probably not the answer you were looking for, but it may help.</p>
<p>Regards<br />Michael</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>CBoland replied on Thursday, December 09, 2010</h2><p>You are correct about the list positioning behavior. I added a line of code to manually set the list position (BindingSource.Find method) to the bound object&#39;s value. I presume the behavior you describe to be accurate.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, December 07, 2010</h2><p>Hi, </p>
<p>What is the DataBinding UpdateMode on your ComboBox?</p>
<p> I&#39;d assume you are using the default OnValidation but have you tried to change this setting to OnPropertyChanged? That should make sure the value is always in sync to the databound object.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Michael replied on Tuesday, December 07, 2010</h2><p>Yes, you should use OnPropertyChanged, but the property on the business object still won&#39;t actually have a value pushed to it when there is no matching value in the combo box.</p>
<p>However, if you bind the combo box&#39;s data source <i>after </i>binding the data source for the business object, then it will clobber the biz object&#39;s property value with the first value in the list. (This is not usually the desired behaviour either.)</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>rsbaker0 replied on Thursday, December 09, 2010</h2><p>It might be that&nbsp;whether a CombBox will display values not in the list depends on the DropDownStyle. I can type a value not in the list if the value is DropDown, but not DropDownList.&nbsp; This might not be helpful in all cases depending on the underlying data mapping. </p>
<p>&nbsp;</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
