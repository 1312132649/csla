<html><header><title>Automatic setting of Controls' background color</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Automatic setting of Controls' background color</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5959.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>lukky posted on Tuesday, December 09, 2008</h2>Hi,<br><br>I've had a request from a client where he'd like to show a different background color on bound controls when the bound to BO is newly created, up until such time when user actually changes the default value for all those colored controls.<br><br>I'm thinking that maybe this could be done through an extender control. Maybe I could setup a dictionary of controls that this extender control extends, and then respond to the Validating event to set the color back to normal color.<br><br>Is this how you guys would handle it ? I don't think this should go into my BOs, should it ? Or is there already a mechanism in CSLA that would tell me if a managed property has been modified since a certain point in time ?<br><br>Any ideas/suggestions/laughs ?<br><br>Thank you<br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Tuesday, December 09, 2008</h2><P>There have discussions about having a Managed property be aware of its initial value so that if it is changed then the property could tell you if it was dirty or not. Then if you changed it back to the original value it would not be dirty! The dirty state of the BO would be a loop over all the managed properties until the first IsDirty is True, else it is False.</P>
<P>Rocky does not want to implement this (yet? / ever?)&nbsp; because it "doubles" the size of the graph. But that assumes every property would always need to know its original value. Maybe only a subset require this functionality.</P>
<P>At any rate, if you search for this you should find some sample code I posted on how to implement this idea by extending Rocky's classes. Once you have these classes in place, each property can tell you if it is dirty or not and your problem above becomes trivial.</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Wednesday, December 10, 2008</h2><P>Yes, you could create an extender class that would "default enable" a control.&nbsp; That would be the best way to encapsulate the logic and allow you to reuse it on your forms without having to add more code.</P>
<P>To accomplish it, I would suggest making use of the existing System.ComponentModel.DefaultValue attribute.&nbsp; You can mark your BO properties with this attribute and specify the appropriate value.&nbsp; Then your extender can compare this value to the current property value to determine if it has changed or not.</P>
<P>Alternatively, your extender can have an InitialValue property that is exposed to the UI.&nbsp; When designing the form, specify the initial/default value here and have the extender modify the extended controls properties according to whether the bound BO's property is or isn't set to the InitialValue.&nbsp; This would require you to hard-code the value for each extended control and takes the default value definition away from the BO - which is why I prefer the first approach.</P>
<P>Hope that helps.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>lukky replied on Wednesday, December 10, 2008</h2>I kind of like the Extender Control way of doing this because it allows me to reuse it on other forms.<br><br>Speaking with the client, we have agreed (read, I was able to convince him) that the background color of those controls should be set to another color when a new BO is created, those fields having empty initial values, then as soon as the user enters something, the color should revert to normal.<br><br>This way, I don't have to worry about initial/default values. It's simply a visual cue that the value was never set.<br><br>Though, in some other cases, it might be handy to compare to some initial value, so maybe it could be done by "loading" the Extender Control with a snapshot of the values (after BO creation), then as each one of them validates, if the current value is not equal to the "snapshot" value, revert the color to normal.<br><br>This sounds fun <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /><br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
