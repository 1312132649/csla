<html><header><title>CSLA 1.52 - DataPortal failure.  DB is read only??!!</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA 1.52 - DataPortal failure.  DB is read only??!!</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2492.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson posted on Thursday, March 08, 2007</h2><P><BR>I have an WinForms application that uses a JET database.&nbsp; The app and the db are both installed on a user's workstation at my client's office and it works just splendidly there&nbsp;(he said, modestly &lt;g&gt;).</P>
<P>I installed the app (by file copy, except for the db which they need to share) on to her boss' computer and established a share to the folder on her machine.&nbsp; I went to the config file and changed the relevant lines in it from:</P>
<P>&lt;add key="DB:TagTracker.mdb" value="Provider=Microsoft.Jet.OLEDB.4.0; User ID=Admin; Data Source=C:\Program Files\TagTracker\TagTracker.mdb; Persist Security Info=False" /&gt; </P>
<P>to:</P>
<P>&lt;add key="DB:TagTracker.mdb" value="Provider=Microsoft.Jet.OLEDB.4.0; User ID=Admin; Data Source=N:\TagTracker.mdb; Persist Security Info=False" /&gt; </P>
<P>The app uses the regular technique of using the DB() function to establish the db connection, ala:</P>
<P>Dim cn As New OleDbConnection(db("TagTracker.mdb"))</P>
<P>As I said, EVERYTHING works on HER workstation.&nbsp; But on his? I can open the app, retrieve my objects, and even execute a database compact operation.&nbsp; But I get a DataPortal failure when I try to save the app's main EditableRootObject.</P>
<P>When I opened the database with Access from his computer, I get a notification that the database is Read-Only even though its read-only flag isn't showing up on the file properties in Windows Explorer and neither the app nor the database are in use on the other machine.&nbsp; </P>
<P>I have gone into permissions on the shared drive and given him Full Control.&nbsp; I even changed the .NET 1.1 CodeAccessSecurity to TrustAll for anything from that share.</P>
<P>Still no joy.</P>
<P>Any ideas?&nbsp; Thanks in advance.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, March 08, 2007</h2>I'd check the NTFS file permissions on the 'server' computer.&nbsp; Also check the Share permissions as well; it could be the share permissions are set to read only, which wouldn't show up on the file properties.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson replied on Thursday, March 08, 2007</h2><P>How would I find that Read-Only attribute on the sharing permissions.&nbsp; I can't find it in the UI offered in Windows Explorer.&nbsp; But I'm not used to work with this stuff, so I"m probably walking right past it without realizing.</P>
<P>&nbsp;</P>
<P>Q</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, March 09, 2007</h2><P>Whenever you open a JET database it has to create a .ldb file for locking purposes.<BR>If it can't create the file you get the READONLY error.<BR>This is very common when trying to run a .mdb from a CD drive.<BR><BR>Give your user permission to create files in the shared folder and it should be fine.</P>
<P>If you open the .mdb in Exclusive mode then it won't try and create the .ldb file.<BR>But then your app is single user.</P>
<P>Joe</P>
<P>&nbsp;</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, March 09, 2007</h2>On the server machine, right cilck the folder and choose Sharing and Security.&nbsp; You'll be on the sharing tag.&nbsp; Click the Permissions button on that screen.&nbsp; I think Change should be enough, but I'm not sure so you may want to try Full Control too.&nbsp; <br><br>This assumes Windows XP SP2.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson replied on Monday, March 12, 2007</h2><P>Thanks for the help on this.&nbsp; I discovered that the I was confusing the user's logon on for his OWN machince (which couldn't gain access) with the one set up for him on the host computer.&nbsp; </P>
<P>I never could figure out how to identify ONLY him among other users trying to gain access from the network, but I was able to give <STRONG>Everyone </STRONG>permission.&nbsp; Since no one else knows the app is even here, this is probably safe until tomorrow when their IT guy can come up with something better.</P>
<P>Thanks again.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, March 12, 2007</h2>Are the machines part of the domain?<br><br>If they aren't you could create an account on the 'host' server for this remote user, and have him set the password as the same one he uses on his own workstation.&nbsp; Then as long as the passwords are in sync, the login will succeed, and you can assign just his account to the share permissions.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson replied on Monday, March 12, 2007</h2><P>Thanks for that.&nbsp; I don't know if the passwords are the same or not.&nbsp; </P>
<P>On her computer (the host), his user shows up for permissions as Matt/TAX1 and TAX1 is her machine.&nbsp; His is TAX2 and no TAX2 shows up for permissions use on the share.</P>
<P>There are other servers in their environment (a dozen or more) so I'd bet that they are part of a domain.&nbsp; So this is definitely worth pursuing.</P>
<P>Thanks again!</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Tuesday, March 13, 2007</h2>Hmm.. well if there is a domain in place, everything is simplier... but it sounds like Matt is a local account on the workstation TAX1.&nbsp; It would be very odd that TAX1 is part of a domain, but the user has a local account.&nbsp; If possible, I'd see if you couldn't move them to their domain accounts.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
