<html><header><title>Is it wise to tie my framework to Linq to SQL?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Is it wise to tie my framework to Linq to SQL?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9757.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>almostchristian posted on Saturday, November 13, 2010</h2><p>I&#39;ve been working on an extension to the CSLA framework that ties it with Linq to SQL in order to reduce code.&nbsp;</p>
<p>My goal was to link the PropertyInfo with fetch and persist methods which will retrieve or store the property values when the object is saved or fetched . The base class has a Linq to SQL object as a type parameter so the fetch and persist lambdas in the overloaded RegisterProperty methods are strongly typed. Below, Customer is a Linq to SQL class.</p>
<h4>public class CustomerEntry : LinqRootBusinessBase&lt;CustomerEntry, Customer&gt;</h4>
<h4>protected static readonly PropertyInfo&lt;string&gt; FirstNameProperty = RegisterProperty&lt;string&gt;(c =&gt; c.FirstName, r =&gt; r.FirstName, (c, r) =&gt; r.FirstName = c.FirstName);</h4>
<p>In the data access portion of the code, you only need to implement two methods which defines the DataContext and the Linq query the fetch the row required. You don&#39;t need to load and save the values from Linq to SQL, it is already handled in the base class.</p>
<p>&nbsp;</p>
<h4>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;protected override Customer FetchRow(MultiCriteria criteria, Table&lt;Customer&gt; table)&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</h4>
<h4>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return (from x in table</h4>
<h4>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;where x.CustomerID == (int)criteria[&quot;CustomerID&quot;]</h4>
<h4>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;select x).Single();</h4>
<h4>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</h4>
<h4>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;public override IDisposable GetConnectionToken()&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;{</h4>
<h4>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;return SetDataContext&lt;DataAccess.AdventureWorksDbDataContext&gt;(&quot;AdventureWorksDB&quot;);</h4>
<h4>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;}</h4>
<p>I&#39;ve also created other base classes and I&#39;m happy so far with the framework. My concern is that the classes are strongly tied to Linq to SQL, I don&#39;t know if I should attempt trying to make it work with entities and I think a&nbsp;separate&nbsp;version would be&nbsp;required. I don&#39;t have experience working on projects with Linq to SQL. Is it a ORM choice? I attempted to work with Entities but it doesn&#39;t play well with the schema I have to work with. </p>
<p>&nbsp;</p>
<p>Maybe I should have stuck with code generation, but thats no fun <img src="http://forums.lhotka.net/emoticons/emotion-2.gif" alt="Big Smile" />&nbsp;and I wouldn&#39;t learn as much. But I fear later on, I&#39;ll have a maintenance problem on my hands.</p>
<p>Ideas and advice would be greatly appreciated.</p>
<p>Thanks.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Saturday, November 13, 2010</h2><p>Microsoft has made it pretty clear that their direction is EF, not L2S. But since L2S shipped as part of .NET, it falls under the standard service agreement, which means they&#39;ll basically keep it running and support it for 10 years, but it probably won&#39;t get enhanced, or be integrated into anything new or that sort of thing.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>almostchristian replied on Saturday, November 13, 2010</h2><p>Hmmm. I&#39;ll look into entity in the future, but for now L2S works well and I don&#39;t need any of the features in entities. Hopefully, I could add entity support later on without breaking too much of my code. Designing frameworks is hard. Thanks Rocky.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Vinodonly replied on Sunday, November 14, 2010</h2><p>hi <strong>almostchristian,</strong></p>
<p><strong>your approach looks very interesting.. is it possible for you to share more details/code on how this full thing is working..</strong></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>almostchristian replied on Wednesday, November 17, 2010</h2><p>Sure! I&#39;d love to share my work. I let me prepare some samples and I&#39;ll share a link</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>almostchristian replied on Wednesday, November 17, 2010</h2><p>You can download my code and a &nbsp;sample using the AdventureWorks sample database here&nbsp;http://cid-40804cef94254f69.skydrive.live.com/redir.aspx?resid=40804CEF94254F69!1357</p>
<p>I got it working on Silverlight once but then I did something and it broke. Silverlight is not a priority for me right now so if someone can provide a working example, please do. I need suggestions and criticism so I can improve my code.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Vinodonly replied on Thursday, November 18, 2010</h2><p>I liked the whole idea of elminating the codegens and overall this looks quite intersting.. although linq to sql fact is also undeniable.. </p>
<p>&nbsp;</p>
<p>in any case, thanks for sharing.. i will get back with my comments after studying code..</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
