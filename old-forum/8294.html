<html><header><title>Custom Principal Not Serializable - Silverlight</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Custom Principal Not Serializable - Silverlight</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8294.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>GregDobbs posted on Wednesday, January 06, 2010</h2>Hello all.<br /><br />I've created custom Identity and Principal objects - see attached. Each class is separated into a server-side and client (Silverlight) partial class. Logging in works fine.<br /><br />However, when I go to fetch a busines object I get the following error:<br /><br />System.InvalidOperationException was unhandled by user code<br />  Message="Object not serializable (dazCore.Library.Security.dazPrincipal)"<br />  StackTrace:<br />       at Csla.Serialization.Mobile.MobileFormatter.SerializeObject(Object obj)<br />       at Csla.Serialization.Mobile.MobileFormatter.Serialize(XmlWriter writer, Object graph)<br />       at Csla.Serialization.Mobile.MobileFormatter.Serialize(Stream serializationStream, Object graph)<br />       at Csla.Serialization.Mobile.MobileFormatter.Serialize(Object obj)<br />       at Csla.DataPortalClient.WcfProxy`1.GetBaseCriteriaRequest()<br />       at Csla.DataPortalClient.WcfProxy`1.BeginFetch(Object criteria, Object userState)<br />       at Csla.DataPortal`1.BeginFetch(Object criteria, Object userState)<br />       at dazCore.Library.NewMember.GetNewMemberByeMail(String eMail, EventHandler`1 callback)<br />       at dazPublicPortal.pageWelcome.TestFetch()<br />       at dazPublicPortal.pageWelcome.btnRegister_Click(Object Sender, RoutedEventArgs e)<br />       at System.Windows.Controls.Primitives.ButtonBase.OnClick()<br />       at System.Windows.Controls.Button.OnClick()<br />       at System.Windows.Controls.Primitives.ButtonBase.OnMouseLeftButtonUp(MouseButtonEventArgs e)<br />       at System.Windows.Controls.Control.OnMouseLeftButtonUp(Control ctrl, EventArgs e)<br />       at MS.Internal.JoltHelper.FireEvent(IntPtr unmanagedObj, IntPtr unmanagedObjArgs, Int32 argsTypeIndex, String eventName)<br />  InnerException: <br /><br />Can anyone see something in my code that's causing the principal or identity objects to be unserializable?<br /><br />Thanks!</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>sergeyb replied on Wednesday, January 06, 2010</h2>Are they decorated with Serializable attribute?  What base classes do they inherit from?<br /><br />Sergey Barskiy<br />Principal Consultant<br />office: 678.405.0687 | mobile:&#160;404.388.1899<br /><br />Microsoft Worldwide Partner of the Year | Custom Development Solutions, Technical Innovation<br /><br />-----Original Message-----<br />From: GregDobbs [mailto:cslanet@lhotka.net] <br />Sent: Wednesday, January 06, 2010 7:13 PM<br />To: Sergey Barskiy<br />Subject: [CSLA .NET] Custom Principal Not Serializable - Silverlight<br /><br />Hello all.<br /><br />I've created custom Identity and Principal objects - see attached. Each class is separated into a server-side and client (Silverlight) partial class. Logging in works fine.<br /><br />However, when I go to fetch a busines object I get the following error:<br /><br />System.InvalidOperationException was unhandled by user code<br />  Message="Object not serializable (dazCore.Library.Security.dazPrincipal)"<br />  StackTrace:<br />       at Csla.Serialization.Mobile.MobileFormatter.SerializeObject(Object obj)<br />       at Csla.Serialization.Mobile.MobileFormatter.Serialize(XmlWriter writer, Object graph)<br />       at Csla.Serialization.Mobile.MobileFormatter.Serialize(Stream serializationStream, Object graph)<br />       at Csla.Serialization.Mobile.MobileFormatter.Serialize(Object obj)<br />       at Csla.DataPortalClient.WcfProxy`1.GetBaseCriteriaRequest()<br />       at Csla.DataPortalClient.WcfProxy`1.BeginFetch(Object criteria, Object userState)<br />       at Csla.DataPortal`1.BeginFetch(Object criteria, Object userState)<br />       at dazCore.Library.NewMember.GetNewMemberByeMail(String eMail, EventHandler`1 callback)<br />       at dazPublicPortal.pageWelcome.TestFetch()<br />       at dazPublicPortal.pageWelcome.btnRegister_Click(Object Sender, RoutedEventArgs e)<br />       at System.Windows.Controls.Primitives.ButtonBase.OnClick()<br />       at System.Windows.Controls.Button.OnClick()<br />       at System.Windows.Controls.Primitives.ButtonBase.OnMouseLeftButtonUp(MouseButtonEventArgs e)<br />       at System.Windows.Controls.Control.OnMouseLeftButtonUp(Control ctrl, EventArgs e)<br />       at MS.Internal.JoltHelper.FireEvent(IntPtr unmanagedObj, IntPtr unmanagedObjArgs, Int32 argsTypeIndex, String eventName)<br />  InnerException: <br /><br />Can anyone see something in my code that's causing the principal or identity objects to be unserializable?<br /><br />Thanks!<br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>GregDobbs replied on Wednesday, January 06, 2010</h2>Hello, Sergey.<br /><br />Your response pointed me in the right direction. My classes inherited appropriately from BusinessPrincipalBase and CSLAIdentity.<br /><br />It was the Serializable attribute that was the issue. I had the Serializable attribute applied  on the SERVER partial class, not on the SHARED partial class available to Silverlight. <br /><br />Thus, the Silverlight client had no idea that the class was Serializable.<br /><br />Once I removed the Serializable attribute from the Server-side class and put it on the Shared class instead the issue was resolved.<br /><br />Thanks for steering me in the right direction!</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>elizas replied on Tuesday, February 02, 2010</h2>If we want to serialize and deSerialize an object in silverlight We have to use DataContractSerializer as Silverlight doesn't support BinaryFormatter.<br />DataContractSerializer under the type System.Runtime.Serialization Serializes and deserializes an instance of a type into an XML stream  using dataContract.<br /> <br />Create a Silverlight-enabled wcf service and define the data contract and Datamember attributes withing the .svc.<br />Imports System.ServiceModel<br />End Class</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
