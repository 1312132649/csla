<html><header><title>WCF and Sharepoint</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>WCF and Sharepoint</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6613.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>danielw posted on Tuesday, March 17, 2009</h2><P>I am trying to get CSLA running under sharepoint. </P>
<P>But am having trouble getting it to work.<BR>I have followed the below example</P>
<P><A href="http://blah.winsmarts.com/2008-5-SharePoint_2007_as_a_WCF_host_-_Step_-1,_make_a_WCF_Home.aspx">http://blah.winsmarts.com/2008-5-SharePoint_2007_as_a_WCF_host_-_Step_-1,_make_a_WCF_Home.aspx</A></P>
<P>and have managed to get it working for a test example. But can not get it working for csla.</P>
<P>Has anybody had any experience of this?</P>
<P>&nbsp;</P>
<P>Cheers</P>
<P>Daniel</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Craig.Young replied on Wednesday, September 09, 2009</h2>I got the service to work actually just a few moments ago. Meaning I got the wsdl to show up in a browser. The trick was to GAC the server version of CSLA. <br><br><br>So far to get to this point I have to GAC:<br>
CSLA Assembly (server version)<br>
WCF Service Assembly (which also contains the code for WCFSupport in Sharepoint).<br>
Business Objects Assembly. <br>Business ObjectFactory Assembly<br><br>However upon invocation, I receive an error that says DataPortal.Fetch&lt;BusinessObject&gt;() failed because the type Business.DataAccess.BusinessObjectFactory, Business.DataAccess cannot be found. <br><br>This is odd because I have Business.DataAccess GAC'd as well. My BusinessObjectFactory is tagged with Csla.Server.ObjectFactoryAttributes. Something is crazy with reflection here and loading the named assembly. I even fully qualified the assembly to load with the Version=, Culture=, and the correct PublicKeyToken. <br><br>Help?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Craig.Young replied on Thursday, September 10, 2009</h2>Actually I figured this out as well. WSPBuilder to the rescue!<br>After a day of toying with my solution I now only need to GAC one assembly and the rest I figured out I needed to place in the 80/bin folder of my Sharepoint Solution project.<br><br>The really difficult part for me at least was figuring out how to get Sharepoint Context. But that's solved now thanks to AspNetCompatibilityMode being set to Required on my WCF service.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
