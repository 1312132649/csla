<html><header><title>Reporting</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Reporting</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4680.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dtabako posted on Saturday, April 12, 2008</h2><P>Has anyone used MS Reporting (i.e. ReportViewer) or Crystal Reports in conjunction with CSLA? I am rewriting an application that was originally written in a proprietary unix-based, non-GUI environment. Most of the functionality provided through .NET and CSLA is improving the app 1000-fold. However, one of the old app's strong points was a very flexible reporting system. There was a standard reporting interface from which users could choose from dozens of fields to set up filtering and sorting options. Filtering could be done on any of those fields through either a range or a list (or, of course, no filter). The sorting options included the ability to set up grouping with group-break headers and page-breaks on groups. Users could also save named reports and load those reports later to avoid having to re-enter a lot of options.</P>
<P>I'm looking to recreate this reporting functionality as closely as possible. If anyone has any ideas or could help point me in the right direction it would be greatly appreciated. The reporting piece is a huge piece of my app and it would be a huge advance if&nbsp;I could develop a good standard interface from which I could easily derive all my reports.</P>
<P>Thanks,</P>
<P>Dennis</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Saturday, April 12, 2008</h2><P>I divide "reporting" into two concepts: lists and reports.</P>
<P>Lists are a type of "report" that requires relatively little data (even if the <EM>output</EM> is lengthy, the data required is relatively small). Lists can often be created based on existing objects in your object model, and so are quite approachable from a CSLA perspective - just bind your reporting tool to your objects (on the client) and away you go.</P>
<P>Reports are a type of "report" that requires more than a little data (even if the <EM>output</EM> is very short!). Reports should be created directly from the database. Trying to load objects (or datasets or anything) and then create a report is inherently inefficient and should be avoided. You are far better off using a reporting tool that can efficiently get the data directly from the database. Ideally reports are <EM>created</EM> on an app server (or maybe even the database server), even though they are <EM>viewed</EM> on the client.</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Monday, April 14, 2008</h2>Not knowing your requirements on database and reporting options my recommendations do follow Rockys advice, I would just like to add:<br><br>MS ReportViewer in "local mode" has no knowledge of the database and will work fine with CSLA objects, simple objects and datasets. However, if possible, I would choose to use ReportingServices for SQL Server and generate those reports on the Server. Ie, the report is created on the server but viewer is run locally or in a <br>web-browser - loaded from an&nbsp; iis-server. <br><br>ReportingServices also supports parameters (and allows the user to set parameter values), however may not so flexible as your old app does out of the box. <br><br>You will find a lot more information on http://www.gotreportviewer.com&nbsp; <br><br>/jonny <br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Monday, April 14, 2008</h2><P>FWIW</P>
<P>We tried hard to get Reporting Services to work inside our Web app and found far too many issues with it.</P>
<P>We have been using Data Dynamics Active Reports for a couple of years now and they are great to work with. I set up a framework where a ReadOnly&nbsp;BO contains the header data and a ROC contains the details and we have been able to produce every report from our old system. We allow users to enter complex sets of criteria and save those sets with names for later re-use.</P>
<P>We wanted to go down the road of having users "design" reports by selecting fields, etc but we never had the time or expertise to get that done. </P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dtabako replied on Monday, April 14, 2008</h2><P>Thanks for all the replies. Rocky, I assume what you're suggesting is some sort of reporting service correct? That's not the kind of thing I've really ever worked with but, like most things with this project, I guess I can get myself into it hip-deep soon enough ;^) Any specifics that could help dumb it down for me? BTW at this point, we're using MySql rather than SQL Server. I doubt that will change unless we find compelling reason to do so.</P>
<P>Joe, your solution sounds interesting. Like you, my original hope was to allow users to "design" their reports but I also don't have the experience or time to go down that road. I think if I could get the app out there with the type of reporting features you describe I could focus on upgrading the reporting capabilities for version 2. I'd be interested to hear any implementation details you could share.</P>
<P>Thanks everyone, Dennis</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Monday, April 14, 2008</h2><P>One of the really nice things about Active Reports is that the reports are nothing more than normal .Net classes. So everything you have learned can be re-used in normal class style code.</P>
<P>At a high level we have a Base class:</P><FONT color=#0000ff size=2>
<P>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> ReportBaseFrame<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Inherits</FONT><FONT size=2> DataDynamics.ActiveReports.ActiveReport3</P></FONT>
<P>There are many Properties and methods - some key ones include:<BR><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetReadOnlyBO() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IMyReadOnlyObject<BR></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetROC() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IReadOnlyList<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>Protected</FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2>Overridable</FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT color=#000000 size=2> GetSQLStatement() </FONT><FONT color=#0000ff size=2>As</FONT><FONT color=#000000 size=2> </FONT><FONT color=#0000ff size=2>String</FONT></FONT></P>
<P>By using interfaces I can cast various BOs and ROCs to the Interface and utilize their common properties. I had to add a few to the standard CSLA interfaces.</P>
<P>Here is where we handle the main Active Reports events:</P><FONT color=#0000ff size=2>
<P>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> rpt_ReportStart(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.EventArgs) </FONT><FONT color=#0000ff size=2>Handles</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.ReportStart<BR>&nbsp; </FONT><FONT size=2>mReadOnlyBO = GetReadOnlyBO()<BR>&nbsp; </FONT><FONT size=2>mROC = GetROC()<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</P></FONT><FONT color=#0000ff size=2>
<P>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> rpt_DataInitialize(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> e </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> System.EventArgs) </FONT><FONT color=#0000ff size=2>Handles</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.DataInitialize</P>
<P></P></FONT>
<P>&nbsp; 'this uses reflection to set all properties of the report outside the Detail section.<BR><FONT size=2><FONT color=#0000ff>End</FONT> <FONT color=#0000ff>Sub</FONT></FONT><FONT color=#0000ff></P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Sub</FONT><FONT size=2> rpt_FetchData(</FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> sender </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Object</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>ByVal</FONT><FONT size=2> eArgs </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> DataDynamics.ActiveReports.ActiveReport3.FetchEventArgs) </FONT><FONT color=#0000ff size=2>Handles</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>.FetchData</P>
<P></P></FONT>
<P>&nbsp; 'this uses reflection to set all properties of the report in the Detail section and is called once per row of data in the ROC.<BR><FONT size=2><FONT color=#0000ff>End</FONT> <FONT color=#0000ff>Sub</FONT></FONT><FONT color=#0000ff></P></FONT>
<P>==================================================================</P>
<P>Then for a specific family of reports we use inheritance like this: (there might be 10 similar reports for Dollars - by supplier, by buyer, by requisitioner, etc.)</P><FONT color=#0000ff size=2>
<P>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2> DollarReportBase<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Inherits</FONT><FONT size=2> ReportBaseFrame</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetROC() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> IReadOnlyList<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> DollarROC.GetDollarROC(GetSQLStatement</FONT><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>Protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Overrides</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetSQLStatement() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Return</FONT><FONT size=2> DollarDAO.GetSQLStatement(</FONT><FONT color=#0000ff size=2>Me</FONT><FONT size=2>)<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT></P>
<P><FONT color=#0000ff size=2>End<FONT color=#0000ff size=2> Class</FONT></P></FONT>
<P>==================================================================</P>
<P>The code for the actual report looks like this: (because the Base class handles all the work)</P><FONT color=#0000ff size=2>
<P>Public</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</FONT><FONT size=2>&nbsp;ADollarReport<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Inherits</FONT><FONT size=2> DollarDetailBase<BR></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Class</P></FONT>
<P>There is obvioulsy a lot of code omitted but the idea is pretty straightforward. Once you have the framework written, building new reports is pretty simple.</P>
<P>I omitted the whole UI side of things where complex&nbsp;criteria are saved to the DB and passed to these reports. There is a lot of interaction goigng on. But the key is Active Reports is just a set of classes.</P>
<P>The only issue I had with them is that the report engine will not do a sort for you. You have to feed it pre-sorted data. But once you get past that it is not a major adjustment.</P>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dtabako replied on Monday, April 14, 2008</h2>And thanks, Jonny, for your reply. I've looked through that site a bit and it seems helpful. Like I said in my other post, we're going to try to get this done with MySql but your link did give me some general help with MS Report Viewer as well. I will have to explore that site in more depth.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
