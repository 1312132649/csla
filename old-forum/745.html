<html><header><title>CSLA 1.x - using MS-SBA API calls in my BO makes it non-seriablizable!!</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>CSLA 1.x - using MS-SBA API calls in my BO makes it non-seriablizable!!</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/745.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson posted on Thursday, July 27, 2006</h2><P>I'm trying to build an application that interfaces with another vendor's software.&nbsp; I would like to be able to discuss it without using names because the topic would seem to be important for other situations, too. But I'll name the name: Microsoft Small Business Accounting (SBA).</P>
<P>The SDK seems very well thought-out and constructed.&nbsp; It offers an object model&nbsp;and insists you use it rather than access the underlying SQL Server data directly.&nbsp; It even offers that object funtionality&nbsp;via defined Interfaces to insulate you from version change issues (although you can use the actual instance methods if you prefer).</P>
<P>I was confident that I could build "side-by-side" BO classes with SBA "pieces."&nbsp; I figured my&nbsp;BO would have properties needed by myApp only.&nbsp;&nbsp;And it would have properties that SBA handled, as well.&nbsp; All I would have to do&nbsp;for the crud operations is code the work to&nbsp;manage myApp-specific properties as usual and add calls in my DataPortal_XXX methods to those SBA API methods and things compiled fine.&nbsp;</P>
<P>The Fetch stuff in my proof-of-concept app worked so well that I rolled up my sleeves and dove in.&nbsp; But when I began to deal with editable objects, I got the miserable surprise when I BeginEdit that the calls to the SBA API have made my BO non-serializable!</P>
<P>Can I wrap their API somehow and get around this or is this an architectural incompatability that I can't economically hurdle?</P>
<P>Thanks is advance,</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>hurcane replied on Thursday, July 27, 2006</h2>Do you have class level variables that are SBA objects? If so, you can mark them with the &lt;NonSerialized&gt; atrribute so they don't get serialized when BeginEdit is called. It's the same practice you should use when a child object holds a reference to its parent collection. The variable in the child that references the parent should be marked with the same attribute.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Q Johnson replied on Friday, July 28, 2006</h2><P>&gt;&gt;&nbsp; Do you have class level variables that are SBA objects? If so, you can mark them with the &lt;NonSerialized&gt; atrribute so they don't get serialized when BeginEdit is called.&nbsp;&lt;&lt;</P>
<P>I&nbsp;<STRONG><EM>had been</EM></STRONG>&nbsp;hoping to have a single BO whose properties persist in DP_XXX mthods with calls to MY DB for some of the properties and calls to the SBA API for others.&nbsp; Scratch that!!</P>
<P>From your question, I <STRONG><EM>now</EM></STRONG> envision a "shadow SBA object" that would be a child of my version of the BO.&nbsp; In the DP_XXX methods of "my" BO I would call the child's own CRUD code rather than run it in my BO, right?&nbsp; </P>
<P>I'm only trying to think of this now for the first time, but I'm expecting that the child (and therefore its properties) won't be able to take part in the Undo operations, right?&nbsp; So it will probably be most efficient to just&nbsp;implement <STRONG><EM>all</EM></STRONG> the properties I need in MY BO (some being duplicates of the ones in the child) &nbsp;and handle the getting/putting of the values between parent and child just after Fetch and just before Update operations.&nbsp; So, for example, the factory GetMyBO() method would call the shadow object's fetching method and then call the DataPortal.Fetch so that my own DP_Fetch code is executed.&nbsp; In my DP_Fetch I would populate my "non-SBA" properties from my DB and the others with their corresponding property values&nbsp;from the shadow/child object.&nbsp; Similar treatment in the Save() implementation.</P>
<P>The UI developer won't even be aware that there are two data stores for the object and needn't care.</P>
<P>Does it sound like I'm on the right track, or would you like to offer a course correction?</P>
<P>Thanks!<BR></P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
