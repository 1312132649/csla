<html><header><title>ERLB - How to get selected record refreshed from the database</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>ERLB - How to get selected record refreshed from the database</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8088.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jetta posted on Thursday, December 03, 2009</h2><P>Hi There,</P>
<P>How can we refresh a single row on the datagrid which was binded to ERLB of&nbsp;BusinessBase child object. We&nbsp;have to refresh the datagrid row&nbsp;showing&nbsp;any latest changes&nbsp;from the database&nbsp;just before&nbsp;record is entering into&nbsp;edit&nbsp;mode. Is there any way we can do this either at ERLB end or BB level? Please let me know.</P>
<P>Thanks Regards</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Friday, December 04, 2009</h2><P>Well your BB object contained within the ERLB instance should be a root object.&nbsp; You might be able to add a refersh method to the BB class, which would update all your properties and then send an unknown propertychanged.&nbsp; I think it could work in theory at least..</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jetta replied on Monday, December 07, 2009</h2>Thanks for the reply ajj3085. This is&nbsp;so helpful!&nbsp;I&nbsp;will implement this and let you know.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>jetta replied on Friday, December 18, 2009</h2><P>Thanks again ajj3085, I have implemented this approach works well. Here is&nbsp;my code&nbsp;snippet,</P>
<P>&nbsp;&nbsp;&nbsp; Public Sub Refresh()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Me.DoRefresh()<BR>&nbsp;&nbsp;&nbsp; End Sub</P>
<P>&nbsp;&nbsp;&nbsp; Private Sub DoRefresh()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Get most recent data from the db.<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Dont use Me.BypassPropertyChecks here<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'Populate BB properties with latest data from db.<BR>&nbsp;&nbsp;&nbsp; End Sub</P>
<P>Best Regards</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>mbblum replied on Sunday, December 20, 2009</h2>Word of caution! This looks like it is not using dataportal for db access. Result can be client accessing database directly for the refresh, even if you move the rest to 3-tier.<br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, December 21, 2009</h2><P>Well the idea of the Refersh method on the BB subclass would be that it internally uses a command object&nbsp;to&nbsp;use as a DTO, which&nbsp;includes&nbsp;using the dataportal&nbsp;to fetch the relevent data, and then update itself.</P>
<P>so your refresh would look like this:</P>
<P>public void Refresh() {</P>
<P>&nbsp;&nbsp; var getLatestDataCmd = DataPortal.Execute&lt;DataCmd&gt;( new DataCmd( myId ) );</P>
<P>&nbsp;&nbsp; // update properties here</P>
<P>}</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
