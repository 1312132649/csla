<html><header><title>List view</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>List view</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3704.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 posted on Friday, October 12, 2007</h2>Hi,<br><br>I have a list, LineItemsInternal, which is used to store my line items.&nbsp; Line items may contain other line items as well.&nbsp; This internal list is fine for my program, but to display on a grid I need to flatten out this line item hierarchy.<br><br>To do so, I have a LineItems class, which holds a list of the flattened hierarchy.&nbsp; It delegates calls to the Internal list, and rebuilds the flattened list by listening to the Internal list's ListChanged event.&nbsp; Also, RaiseListChangedEvents is on the Internal list is kept in sync with the view's flattened list.&nbsp; <br><br>Now, I'm trying to improve performance of databinding.&nbsp; To do so, I turn off RaiseListChangedEvents for the binding source.&nbsp; This doesn't help much, because the BS is still being told of all the list changes, which isn't necessary (because I call ResetBindings after list change operation is complete).&nbsp; So my next step to speed things up is to set RaiseListChangedEvents on the flattened list itself.&nbsp; <br><br>The problem is that the flattened list is never rebuild, because rebuilding the flattened list is only done when the Internal list raises its event.<br><br>So, my first thought was to add a flag to track if the two lists get out of sync; because the Internal list is not seen at all, the view list handles the tasks of adding or removing items from the Internal list.&nbsp; If one of these modifying operations is called, and RaiseListChangedEvents is set to false, I could set this flag, and at other points check the flag and rebuild the flattened list if needed.&nbsp; I'm not sure if that's the best way to handle this (and I'm not sure keeping to lists in sync was the best way to get either).&nbsp; <br><br>Am I going about this in the best way possible?<br><br>Thanks<br>Andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Friday, October 12, 2007</h2>Do you _really_ need to keep the flat list in sync with the bo? I assume you're not going to be displaying both things at the same time, so why not create it on demand? it seems like it would be fast enough doing it this way, since you are talking about invoices which generally don't have that many items.<br><br>Another possibility (since I hear you use infragistics stuff) is to use their tree view which works like a grid essentially. That way you don't need to flatten the hierarchy and you save yourself from that step.<br><br>Andr√©s<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, October 15, 2007</h2>Well, it sort of is created on demand.&nbsp; I rebuild the whole flattened list when needed.. its just that now I have a situation where it the rebuild doesn't happen as it should..<br><br>Some of our invoices can have 30 items... and that's not counting "sub" items.<br><br>In this case, using the hierachry capability of the grid is out of the question; I did specifically ask about it, since there are other places where I have implemented that.&nbsp; The answer for this use of the grid was a very firm No.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Monday, October 15, 2007</h2>Well I did some quick reworking; basically, I now set a flag if the list is modified in anyway and RaiseListChangeEvents is off.&nbsp; The underlying list also always raises events.<br><br>Anything that queries the list will rebuild the flattened list if the flag is set; also, if RaiseEvents is true, I don't rebuild the flattened list if the change type is simply ItemChanged (anything else would require a rebuild).<br><br>I now set both the binding source and the list's RaiseLCE to false before inserting even a single item and turn it back on and ResetBindings after.&nbsp; Performance is now as quick as it would be with a standard list.<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
