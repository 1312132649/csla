<html><header><title>DataPortal_Insert and Transactions</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>DataPortal_Insert and Transactions</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/9753.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>jfreeman posted on Friday, November 12, 2010</h2><p>I have a BusinessBase object that shows data from a couple of different tables.&nbsp; Right now when I do an Insert, I call one stored proc and it determines what tables to insert into.&nbsp; I&#39;d like to move that logic into the DataPortal_Insert and make multiple stored procedure calls based on what data is on the object.&nbsp; I&#39;d also like all the stored procs to be in a Transaction, so if one fails they all rollback.&nbsp; Is that possible?&nbsp; Any samples of how to make the transaction work?&nbsp; Thanks.</p>
<p>Jonathan</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Friday, November 12, 2010</h2><p>Chapter 18 of <em>Expert 2008 Business Objects</em> talks about data access in some depth.</p>
<p>The short answer, is that you can just put a Transactional attribute on your DataPortal_Insert method and tell it to use a TransactionScope transaction. </p>
<p>If you do this however, you must understand that your code will be running in a System.Transactions.TransactionScope, and all the rules and nuances of using a TransactionScope come into play. Obviously that&#39;s all standard .NET, so you can find info about that in many places, including Chapter 18.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
