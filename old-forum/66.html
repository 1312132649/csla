<html><header><title>Object Composition Vs Object Inheritance</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Object Composition Vs Object Inheritance</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/66.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>RanceDowner1234 posted on Wednesday, May 10, 2006</h2>Hey all:<br><br>I'm doing an OOP project for the first time.&nbsp; And trying to learn CLSA.net at the same time.&nbsp; So I'm trying to keep it as simple as possible to prevent brain shock.&nbsp; But I'm also trying to do it right.&nbsp; <br><br>I've been reading some article lately on Object Composition vs Object Inheritance.&nbsp; Does anybody have any thoughts either way on the subject, especially using the CSLA 2.x framework.<br><br>Some articles I've read are: <br>http://brighton.ncsa.uiuc.edu/~prajlich/T/node14.html (seems to favor composition)<br>http://cpptips.hyperformix.com/cpptips/inh_vs_comp (seems to favor composition)<br>http://www.javapractices.com/Topic72.cjp (seems to favor compositon)<br><br>Of course none of these brilliant fellows give any real-life code examples on the differences between the two!<br><br>After a few hours of searching I finally found sort of an example for vb.net<br>http://discuss.develop.com/archives/wa.exe?A2=ind0502b&amp;L=vbdotnet&amp;T=0&amp;F=&amp;S=&amp;P=1552<br><br>The above article focuses on "containing" a child object.&nbsp; This seems like it would be hard to "bind" to the object using vb.net's datasource and bindingsource utilities.&nbsp; Is there any other way to do Object Compositon?<br><br>Long story short... I would consider using Object Composition if I could find a good practical example or tutorial that explains how to implement it in the real world.&nbsp; Does anybody know of any sites that show some good vb.net or c#.net examples of a class that uses Object Composition vs Inheritance?<br><br>Or if anyone is currently using Object Compositon with CSLA 2.x I would love it if you could post a couple of your classes and "base"classes (if "base" is what you call them in Composite terms).&nbsp; Especially showing how and when you write to the database using these little module classes.<br><br>Thx<br><br>Rance Downer<br>rancedowner1234@hotmail.com<br><br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RanceDowner1234 replied on Thursday, May 11, 2006</h2>I think I found my own answer, so I might as well post it incase any other lost soul is looking for an answer too.&nbsp; They key came in finding out that Object "Composition" goes by another name...&nbsp;&nbsp; Object "Delegation".&nbsp; It also goes by another name "Object Aggregation".&nbsp; In short... It's basically just the old VB6 way of doing OOP.&nbsp; <br><br>I'm surprised many persons so strongly advocate it over inheritance.&nbsp; But what do I know!&nbsp; I'm a newbie to OOP.&nbsp; Personally, though, I think this is one reason so many developers get turned off to OOP, is that sometimes OOP advocates get a little bit on the religiously ferverous side on ya!&nbsp; That's a different subject, but for an interesing read on that topic you might read Rocky's Guest OP in the latest Visual Studio Magazine...&nbsp; http://www.ftponline.com/vsm/2006_04/magazine/departments/guestop/<br><br>But back on topic...&nbsp; I figured out how atleast how I <b><i>think </i></b>I would assemble an "Agregated" (I prefer that moniker) Object.&nbsp; Some questions do arise though.<br><br>If I did use Agregation in CSLA.net I wondered primarily about ValidationRules:<br>* Where's the best place to put the ValidationRules... inside the module Objects or inside the Aggregate?&nbsp; If I put them in the "Module" Objects how do I "stitch" them all together in the Agreggate to provide a common "broken rules" collection for users without resorting to all kinds of withevents and&nbsp; event trapping on my base modules... which could lead to my objects not being serializable (or more difficult to make serializable)?&nbsp; If I put them in the "Agreggate" Object do I have to keep <i>copying and pasting</i> similiar logic every time I implement one of the Modules.&nbsp;&nbsp; And if I'm doing so much copying and pasting have I lost some value to the whole Object Oriented approach.<br><br>* Also I don't think there's really any good reason to inherit  BusinessBase(Of Payment) and BusinessBase(Of LineItem) in the respective module objects.&nbsp; But I did wonder?<br><br>Long story short... I think I'm going to decide on Inheritance chains over aggregation, being that my program isn't really that difficult, and my inheritance hierarchies will be rather small.&nbsp; I don't think I'll be doing alot of overriding in my SubClasses.&nbsp; Also my gut tells me that inheritance will work better with the CSLA.net framework than Agreggation.&nbsp; For instance I think Business Rules will be easier to implement in an inheritance environment.&nbsp; I don't want to do that many workarounds.&nbsp; Thirdly I pretty much so just cringe at the idea of writing and implementing all those interfaces.&nbsp; <br><br>But it will be fun to post how I think I would do aggregation.&nbsp; If anyone has an actual better way of doing it though.... please.... post it by all means.&nbsp; Or if anyone has any comments on my implementation that would help too.&nbsp; Good or bad.<br><br>Note:&nbsp; Some examples of aggregation I saw on the internet did not Implement the Interfaces in the aggregate object, they merely provided pointers to module objects.&nbsp; But I chose to Implement the Interfaces because I will be databinding these objects to grids and controls in my winforms using datasources and the bindingSource control.&nbsp; The only way I could figure out to accomplish this was to do a full blown delegation, which would emulate the base module properties.<br><br>Note2:&nbsp; I didn't implement everything... it's just a sample... so I only did the DataPortal_Create and Fetch methods.&nbsp; I haven't tried actually running this code it's just my thoughts on how I <i>think </i>I might do it.&nbsp; I suppose it could get tricky when it came to the updating logic.&nbsp; I found an article on Rocky's website that shows how to do updating using inheritance.&nbsp; I imagine the same principles would apply in an Agreggate scenario.&nbsp; So I used a similiar technique in the Fetch in this example.&nbsp; In updating, I suppose I would just create an Update subroutine and pass in a command object, like he does in his article on inheritance.&nbsp; Here's Rocky's advice... http://www.lhotka.net/Articles.aspx?id=e130b265-15cb-453d-9719-d5a944385fd3<br><br>The following example basically shows a ResidentialCustomerPayment which is an aggregate of Payment and LineItem.&nbsp; For definition sake... a Line Item is in the context of an accountbook registry "line item".&nbsp; I don't show it in the example but I will also want to use LineItem in deriving other objects like an ElectricBillStatement Object or a GasBillStatement Object.&nbsp; I would also want to use the Payment class in agreggating other objects such as a CommercialCustomerPayment.<br><br>Anyway... without further musing... here's the code:<br><br>Imports Csla<br>Imports Csla.Data<br><br>Public Interface ILineItem<br>&nbsp;&nbsp;&nbsp; Property LineItemID() As Integer<br>&nbsp;&nbsp;&nbsp; Property EntryDate() As SmartDate<br>&nbsp;&nbsp;&nbsp; Property EntryAmount() As Double<br>End Interface<br><br><b>Public Class LineItem</b><br>&nbsp;&nbsp;&nbsp; Inherits BusinessBase(Of LineItem) 'Haven't implemented Business rule logic so I don't know if I really need to inherit from BusinessBase or not???<br><br>&nbsp;&nbsp;&nbsp; Implements ILineItem<br><br>&nbsp;&nbsp;&nbsp; Protected Overrides Function GetIdValue() As Object<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return _LineItemID<br>&nbsp;&nbsp;&nbsp; End Function<br><br>&nbsp;&nbsp;&nbsp; Private _EntryAmount As Double<br>&nbsp;&nbsp;&nbsp; Public Property EntryAmount() As Double Implements ILineItem.EntryAmount<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return _EntryAmount<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As Double)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _EntryAmount = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>&nbsp;&nbsp;&nbsp; Private _EntryDate As New SmartDate()<br>&nbsp;&nbsp;&nbsp; Public Property EntryDate() As Csla.SmartDate Implements ILineItem.EntryDate<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return _EntryDate<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As Csla.SmartDate)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _EntryDate = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>&nbsp;&nbsp;&nbsp; Private _LineItemID As Integer<br>&nbsp;&nbsp;&nbsp; Public Property LineItemID() As Integer Implements ILineItem.LineItemID<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return _LineItemID<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As Integer)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _LineItemID = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>&nbsp;&nbsp;&nbsp; Private Sub New()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Force Factory methods<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>&nbsp;&nbsp;&nbsp; Public Shared Function NewInstance() As LineItem<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return DataPortal.Create(Of LineItem)()<br>&nbsp;&nbsp;&nbsp; End Function<br><br>&nbsp;&nbsp;&nbsp; Public Sub Fetch(ByVal dr As SafeDataReader)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; With dr<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _LineItemID = .GetInt32("LineItemID")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _EntryAmount = .GetDecimal("EntryAmount")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _EntryDate = .GetSmartDate("EntryDate")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End With<br>&nbsp;&nbsp;&nbsp; End Sub<br>End Class<br><br>Public Interface IPayment<br>&nbsp;&nbsp;&nbsp; Property CheckAmount() As Double<br>&nbsp;&nbsp;&nbsp; Property CheckNumber() As String<br>&nbsp;&nbsp;&nbsp; Property AppliesToPrincipal() As Double<br>&nbsp;&nbsp;&nbsp; Property AppliesToInterest() As Double<br>End Interface<br><br><b>Public Class Payment</b><br>&nbsp;&nbsp;&nbsp; Inherits BusinessBase(Of Payment) 'Haven't implemented Business rule logic so I don't know if I really need to inherit from BusinessBase or not???<br><br>&nbsp;&nbsp;&nbsp; Implements IPayment<br><br>&nbsp;&nbsp;&nbsp; Protected Overrides Function GetIdValue() As Object<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Cant think of anything to return so I'm returning Nothing<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return Nothing<br>&nbsp;&nbsp;&nbsp; End Function<br><br>&nbsp;&nbsp;&nbsp; Private _AppliesToInterest As Double<br>&nbsp;&nbsp;&nbsp; Public Property AppliesToInterest() As Double Implements IPayment.AppliesToInterest<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return _AppliesToInterest<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As Double)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _AppliesToInterest = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>&nbsp;&nbsp;&nbsp; Private _AppliesToPrincipal As Double<br>&nbsp;&nbsp;&nbsp; Public Property AppliesToPrincipal() As Double Implements IPayment.AppliesToPrincipal<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return _AppliesToPrincipal<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As Double)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _AppliesToPrincipal = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>&nbsp;&nbsp;&nbsp; Private _CheckAmount As String<br>&nbsp;&nbsp;&nbsp; Public Property CheckAmount() As Double Implements IPayment.CheckAmount<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return _CheckAmount<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As Double)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _CheckAmount = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>&nbsp;&nbsp;&nbsp; Private _CheckNumber As Double<br>&nbsp;&nbsp;&nbsp; Public Property CheckNumber() As String Implements IPayment.CheckNumber<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return _CheckNumber<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As String)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _CheckNumber = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>&nbsp;&nbsp;&nbsp; Private Sub New()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Force Factory methods<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>&nbsp;&nbsp;&nbsp; Public Shared Function NewInstance() As Payment<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return DataPortal.Create(Of Payment)()<br>&nbsp;&nbsp;&nbsp; End Function<br><br>&nbsp;&nbsp;&nbsp; Public Sub Fetch(ByVal dr As SafeDataReader)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; With dr<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _AppliesToInterest = .GetDecimal("AppliesToInterest")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _AppliesToPrincipal = .GetDecimal("AppliesToPrincipal")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _CheckAmount = .GetDecimal("CheckAmount")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _CheckNumber = .GetString("CheckNumber")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End With<br>&nbsp;&nbsp;&nbsp; End Sub<br>End Class<br><br>Public Interface IResidentialCustomerPayment<br>&nbsp;&nbsp;&nbsp; Property KilowattHoursUsed() As Double<br>&nbsp;&nbsp;&nbsp; Property ResidentialRate() As Double<br>End Interface<br><br><b>Public Class ResidentialCustomerPayment</b><br>&nbsp;&nbsp;&nbsp; Inherits BusinessBase(Of ResidentialCustomerPayment)<br>&nbsp;&nbsp;&nbsp; Implements IResidentialCustomerPayment<br>&nbsp;&nbsp;&nbsp; Implements ILineItem<br>&nbsp;&nbsp;&nbsp; Implements IPayment<br><br>&nbsp;&nbsp;&nbsp; Private mLineItem As LineItem<br>&nbsp;&nbsp;&nbsp; Private mPayment As Payment<br><br>&nbsp;&nbsp;&nbsp; Protected Overrides Function GetIdValue() As Object<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return mLineItem.LineItemID<br>&nbsp;&nbsp;&nbsp; End Function<br><br>&nbsp;&nbsp;&nbsp; Private Sub New()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Forces Factory Methods<br>
&nbsp;&nbsp;&nbsp; End Sub<br><br>&nbsp;&nbsp;&nbsp; Public Shared Function NewInstance() As ResidentialCustomerPayment<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return DataPortal.Create(Of ResidentialCustomerPayment)()<br>
&nbsp;&nbsp;&nbsp; End Function<br><br>&nbsp;&nbsp;&nbsp; Public Shared Function GetInstance(ByVal id As Integer) As ResidentialCustomerPayment<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return DataPortal.Fetch(Of ResidentialCustomerPayment)(id)<br>&nbsp;&nbsp;&nbsp; End Function<br><br>&nbsp;&nbsp;&nbsp; Protected Overrides Sub DataPortal_Create(ByVal criteria As Object)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mLineItem = LineItem.NewInstance()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mPayment = Payment.NewInstance()<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>&nbsp;&nbsp;&nbsp; Public Sub Fetch(ByVal dr As SafeDataReader)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; With dr<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _ResidentialRate = .GetDecimal("ResidentialRate")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _KilowattHoursUsed = .GetDecimal("KilowattHoursUsed")<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End With<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Note:&nbsp; I suppose I could have just called the properties directly<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'But I chose to have an easy function called Fetch to be able to<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'pass a SafeDateReader<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Call mLineItem.Fetch(dr)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Call mPayment.Fetch(dr)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MarkOld() 'For Good measure<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>&nbsp;&nbsp;&nbsp; Protected Overrides Sub DataPortal_Fetch(ByVal criteria As Object)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MyBase.DataPortal_Fetch(criteria)<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dim dr As SafeDataReader<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'Put logic here to call from Database and populate dr<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Call Fetch(dr)<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>#Region " IResidentialCustomerPayment"<br><br>&nbsp;&nbsp;&nbsp; Private _KilowattHoursUsed As Double<br>&nbsp;&nbsp;&nbsp; Public Property KilowattHoursUsed() As Double Implements IResidentialCustomerPayment.KilowattHoursUsed<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return _KilowattHoursUsed<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As Double)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _KilowattHoursUsed = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>&nbsp;&nbsp;&nbsp; Private _ResidentialRate As Double<br>&nbsp;&nbsp;&nbsp; Public Property ResidentialRate() As Double Implements IResidentialCustomerPayment.ResidentialRate<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return _ResidentialRate<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As Double)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _ResidentialRate = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged()<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>#End Region<br><br>#Region " ILineItem "<br>&nbsp;&nbsp;&nbsp; Public Property EntryAmount() As Double Implements ILineItem.EntryAmount<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return mLineItem.EntryAmount<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As Double)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mLineItem.EntryAmount = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged() 'treat delegated propertyChange same as local propertyChange<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>&nbsp;&nbsp;&nbsp; Public Property EntryDate() As Csla.SmartDate Implements ILineItem.EntryDate<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return mLineItem.EntryDate<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As Csla.SmartDate)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mLineItem.EntryDate = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged() 'treat delegated propertyChange same as local propertyChange<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>&nbsp;&nbsp;&nbsp; Public Property LineItemID() As Integer Implements ILineItem.LineItemID<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return mLineItem.LineItemID<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As Integer)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mLineItem.LineItemID = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged() 'treat delegated propertyChange same as local propertyChange<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>#End Region<br><br>#Region " IPayment "<br><br>&nbsp;&nbsp;&nbsp; Public Property AppliesToInterest() As Double Implements IPayment.AppliesToInterest<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return mPayment.AppliesToInterest<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As Double)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mPayment.AppliesToInterest = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged() 'treat delegated propertyChange same as local propertyChange<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>&nbsp;&nbsp;&nbsp; Public Property AppliesToPrincipal() As Double Implements IPayment.AppliesToPrincipal<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return mPayment.AppliesToPrincipal<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As Double)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mPayment.AppliesToPrincipal = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged() 'treat delegated propertyChange same as local propertyChange<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>&nbsp;&nbsp;&nbsp; Public Property CheckAmount() As Double Implements IPayment.CheckAmount<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return mPayment.CheckAmount<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As Double)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mPayment.CheckAmount = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged() 'treat delegated propertyChange same as local propertyChange<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>&nbsp;&nbsp;&nbsp; Public Property CheckNumber() As String Implements IPayment.CheckNumber<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return mPayment.CheckNumber<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Set(ByVal value As String)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mPayment.CheckNumber = value<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyHasChanged() 'treat delegated propertyChange same as local propertyChange<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Set<br>&nbsp;&nbsp;&nbsp; End Property<br><br>#End Region<br><br>End Class<br><br><br><br><br><br><br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>malloc1024 replied on Monday, May 15, 2006</h2><p class="MsoNormal"><span>One of the
fundamental principles of OOP is favor composition over inheritance.<span>&nbsp; </span>Composition will give you more maintainable
and flexible code.<span>&nbsp; </span>Inheritance is
overused and abused way too often.<span>&nbsp; </span>BTW,
the articles you listed did give code examples.<span>&nbsp;
</span>They said to look at design patterns.<span>&nbsp;
</span>Design patterns will show the power that composition has over
inheritance.<span>&nbsp; </span>I would strongly suggest
that you get a good OOP/Design Patterns book.<span>&nbsp;
</span>It will help you much more than Rocky's book in the long run.<span>&nbsp; </span>Knowing the fundamentals will give you more appreciation
on what Rocky did and also help you become a much better programmer.<span></span><o:p></o:p></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>MichaelBosch replied on Tuesday, May 16, 2006</h2>Malloc:&nbsp; <br>
I like you're test replacing "is-a" with "behaves as a".&nbsp; Any suggestions on the best <span>OOP/Design
Patterns book?&nbsp; I bought the Head First design patterns book, but
it seems like a very basic, simplistic presentation of design
patterns.&nbsp; Maybe thats a good thing?&nbsp; Any other
suggestions...?</span><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>malloc1024 replied on Tuesday, May 16, 2006</h2>

<p class="MsoNormal"><span>I read the
"Head First" book and enjoyed it.<span>&nbsp;
</span>I would strongly recommend this book to anyone who wants to learn about
design patterns and OOP.<span>&nbsp; </span>The examples
are simplistic, but this aids the user in trying to understand the
pattern.<span>&nbsp; </span>If you are already very familiar
with OOP and design pattern you won't get much out of the book.<span>&nbsp; </span>However, this is true with most design
pattern books.<span>&nbsp; </span>If you want something
more difficult, you could always try the original GoF Book.<span>&nbsp; </span>The book is notorious for its difficulty
though.<span>&nbsp;&nbsp; </span>I would also recommend Fowler’s
“Patterns of Enterprise Application Architecture” and Kerievsky’s “Refactoring
to Patterns” and “Design Patterns Explained”.<span>&nbsp;
</span>These are the better books that I have read.&nbsp; <span></span><span></span>Rocky
recommends David West’s “Object Thinking”. <span>&nbsp;</span>I have not read it so
I can not comment on it.<span>&nbsp; </span>Maybe someone
in this forum can.<span>&nbsp; </span>If I can remember any
more, I will list them.<span>&nbsp; </span><span>&nbsp;</span>Finding good books can be difficult and expensive.<span>&nbsp; </span>If anyone has anymore recommendations, please
share them.<span>&nbsp; </span><span>&nbsp;</span><o:p></o:p></span></p>








<p class="MsoNormal"><span>Head First
Design Patterns:<o:p></o:p><br>
<a href="http://www.amazon.com/gp/product/0596007124/103-6049992-6751013?v=glance&amp;n=283155">http://www.amazon.com/gp/product/0596007124/103-6049992-6751013?v=glance&amp;n=283155</a><o:p></o:p><br>
</span></p>
<p class="MsoNormal"><span>Refactoring
to Patterns:<o:p></o:p><br>
<a href="http://www.amazon.com/gp/product/0321213351/103-6049992-6751013">http://www.amazon.com/gp/product/0321213351/103-6049992-6751013</a><o:p></o:p></span></p>






<p class="MsoNormal"><span><o:p></o:p>Patterns of
</span><span>Enterprise</span><span> Application Architecture:<o:p></o:p><br>
<a href="http://www.amazon.com/gp/product/0321127420/103-6049992-6751013?v=glance&amp;n=283155">http://www.amazon.com/gp/product/0321127420/103-6049992-6751013?v=glance&amp;n=283155</a><o:p></o:p></span></p>






<p class="MsoNormal"><span><o:p>&nbsp;</o:p>Design
Patterns Explained:<o:p></o:p><br>
<a href="http://www.amazon.com/gp/product/0201715945/103-6049992-6751013?v=glance&amp;n=283155">http://www.amazon.com/gp/product/0201715945/103-6049992-6751013?v=glance&amp;n=283155</a><o:p></o:p></span></p>






<p class="MsoNormal"><span><o:p>&nbsp;</o:p>Object
Thinking:<o:p></o:p><br>
<a href="http://www.amazon.co.uk/exec/obidos/ASIN/0735619654/202-8705868-5724646">http://www.amazon.co.uk/exec/obidos/ASIN/0735619654/202-8705868-5724646</a><o:p></o:p></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Bayu replied on Wednesday, May 17, 2006</h2>Hey,<br><br>Don't forget to mention the classic:<br><br>Design Patterns: Elements of Reusable OO Software, by the 'Gang of Four'.<br><a href="http://www.amazon.com/gp/search/ref=nb_ss_gw/002-5875380-8679251?url=search-alias%3Daps&amp;field-keywords=design+patterns+elements&amp;Go.x=0&amp;Go.y=0&amp;Go=Go"></a><a href="http://www.amazon.com/gp/product/0201633612/sr=8-1/qid=1147851537/ref=pd_bbs_1/002-5875380-8679251?%5Fencoding=UTF8">http://www.amazon.com/gp/product/0201633612/sr=8-1/qid=1147851537/ref=pd_bbs_1/002-5875380-8679251?%5Fencoding=UTF8</a><br><br>Actually, this book is all I ever read 'on paper' about design patterns. It is more like a catalog then a tutorial. Really great reference to have on your workbench to look up the 20+ most commonly used design patterns of all. With sample code (not dotnet, but very comprehensible), UML.diagrams and detailed explanation of the pros and cons of each pattern. IMO: a must-have!<br><br>(Sometimes, when discussing these matters, I tend to get a little carried away <img src="/emoticons/emotion-5.gif" alt="Wink [;)]" />).<br><br>Check it out!<br>Bayu<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>malloc1024 replied on Wednesday, May 17, 2006</h2>I mentioned the GoF book.&nbsp; I just forgot to provide the link to it.&nbsp; Thanks for posting the link.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DancesWithBamboo replied on Sunday, May 14, 2006</h2>Hi Rance-<br><br><br>I see you answered your own post but I thought I would add a couple of thoughts.&nbsp; My first consideration when deciding to use inheritance is wheter the realtionship I am modeling is a "is-a" or a "has-a" relationship.&nbsp; The is-a is more likeley to be modeled as an inheritance structure like "address is a contact"".&nbsp; The has-a is modeled as a composition such as "a customer has an order".<br><br>After that, inheritance is almost always more complicated to design correctly in the real-world environment.&nbsp; It seems that all of the requirements for a project are never known at design time and it is much easier to add functionality by composition than inheritance later on in the product's lifecycle.&nbsp; <br><br>In your answer you only use interface inheritance so I don't think what you did can really be compared to composition since you didn't inherit functionality.&nbsp; Interface inheritance allows you to act on all the objects in the same way (polymorphism) but doesn't give you any any less work to do in the derived class since you have to implement the methods anyway.&nbsp; Not to say that it is right or wrong, but I haven't seen anyone do what you did.&nbsp; Basically you said that a ResidentialCustomerPayment is-a LineItem and has-a LineItem.&nbsp; I don't see why you would do this?&nbsp; I would probably make a full LineItem class and give it to the customer as a property; then access it as ResidentialCustomerPayment.Charge.EntryAmount.&nbsp; But, it is always hard to give answers without knowing all of the requirements!&nbsp; It just doesn't seem right for it to be in both types of relationships at the same time.<br><br>Another advantage to composition in CSLA is the use of switchable objects.&nbsp; With LineItem as its own full featured object, it could be a child when needed and a parent when needed.&nbsp; This allows you to pluck an object out of its hierarchy and use it on an add/edit form without the need for the whole tree.<br><br>There are always many ways to design objects and it is always fun to discuss the options.<br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Monday, May 15, 2006</h2>DancesWithBamboo:<br><br>Grady Booch?<br><br>Andrés<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>malloc1024 replied on Monday, May 15, 2006</h2>Bamboo,<br>
<br>
The "is-a"&nbsp; test is misleading.&nbsp; Replace the "is-a" test with
a "behaves as a" test.&nbsp; Inheritace should be based on behavoir not
data.&nbsp; The "behaves as a" test will help enforce this.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RanceDowner1234 replied on Thursday, May 18, 2006</h2>Thanks everybody (especially Dances With Bamboo) for taking a look and offering some thoughts.&nbsp; Thanks especially for the links to the books I will check them out. This was definitely my first attempt at composition (aggregation), so I needed some input.<br><br>In my secenario a <b>ResidentialCustomerPayment </b>"is a" (or "behaves as a") <b>Payment </b>which in turn "is a" <b>LineItem</b>.&nbsp; Infact the "Primary Key" in the database for a ResidentialCustomerPayment will be "LineItemID".&nbsp; The primary key for any other derived objects such as <u>Business</u>CustomerPayment would also be "LineItemID".&nbsp; So, first of all, am I correct in concluding that inheritance might be the way to go here?<br><br>But for theory's sake... if I <i>was </i>to go the Composition (aka Aggregation) route...<br><br>I agree with Dances With Bamboo that the interface implementation route in my code sample didn't seem like any less work than just copying and pasting the properties into each "aggregate" object.&nbsp; As I was coding the example it did seem like it would be just easier to create a full fledged LineItem Object and then pass it as a property.&nbsp; <br><br>I suppose the "pass the reference" model would look something like...<br><br>Public Class<b> LineItem<br>&nbsp;&nbsp;&nbsp; </b>Inherits BusinessBase(Of LineItem)<br>&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp; 'Add properties such as: LineItemID, EntryDate, EntryAmount<br><br>&nbsp;&nbsp;&nbsp; 'Add some factory instantion: NewInstance( )<br><b>End Class<br></b><br>Public Class <b>Payment<br></b>&nbsp;&nbsp;&nbsp; Inherits BusinessBase(Of Payment)<br><br>&nbsp;&nbsp;&nbsp; 'Add properties such as: CheckNumber, CheckAmount, AppliesToPrincipal, AppliesToInterest<br><br>&nbsp;&nbsp;&nbsp; 'Add some factory instantion: NewInstance( )<br>End Class<br><br>Public Class <b>ResidentialCustomerPayment<br>&nbsp;&nbsp;&nbsp; </b>Inherits BusinessBase(Of ResidentialCustomerPayment)<br><br>&nbsp;&nbsp;&nbsp; Public Shared Function NewInstance() As ResidentialCustomerPayment<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return DataPortal.Create(Of ResidentialCustomerPayment)()<br>
&nbsp;&nbsp;&nbsp; End Function<br><br>&nbsp;&nbsp;&nbsp; Protected Overrides Sub DataPortal_Create(ByVal criteria As Object)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _LineItem = LineItem.NewInstance( ) 'Instantiate a private LineItem Object<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _Payment = Payment.NewInstance( ) 'Instantiate a Private Payment Object<br>&nbsp;&nbsp;&nbsp; End Sub<br><br>&nbsp;&nbsp;&nbsp; Private _LineItem As LineItem<br>&nbsp;&nbsp;&nbsp; Public ReadOnly Property LineItem( ) As LineItem <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return _LineItem <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>&nbsp;&nbsp;&nbsp; End Property<br><br>&nbsp;&nbsp;&nbsp; Private _Payment As Payment<br>
&nbsp;&nbsp;&nbsp; Public ReadOnly Property Payment( ) As Payment<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Get<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Return _LineItem <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; End Get<br>
&nbsp;&nbsp;&nbsp; End Property<br><br>End Class<b><br><br></b>Then in GUI code if I wanted to refer to the "derived" properties in ResidentialCustomerPayment I could just say something like<br><br>Dim rcp as ResidentialCustomerPayment = ResidentialCustomerPayment.GetInstance( )<br><br>MsgBox rcp.<b>LineItem</b>.EntryAmount.ToString.Trim<br>MsgBox rcp.LineItem.EntryDate.ToString.Trim<br>MsgBox rcp.<b>Payment</b>.CheckNumber.Trim<br>MsgBox rcp.Payment.AppliesToPrincipal.ToString.Trim<br><br>etc. etc.<br><br>But the reason in specific I was going that interface route was because I wanted to take advantage of visual studio.net windows <b>data-binding</b>... especially on a datagridview control.&nbsp; To explain...<br><br>In Visual Studio I have been creating a "Data Source" out of my objects.&nbsp; Then on the forms I create a BindingSource Control and set it's datasource property to My object.&nbsp; In this case I would set the datasource to the ResidentialCustomerPayment object.<br><br>Then I would set the datagridview control datasource to the BindingSource control.&nbsp; But when you goto add fields to the datagridview you are only able to add "base" properties.&nbsp; You don't get the option of seeing properties in child (aggregated) objects.&nbsp;&nbsp; And in my case I want to be able to show LineItemID, EntryDate, EntryAmount,&nbsp; CheckNumber, CheckAmount, AppliesToInterest on the same datagridview control.<br><br>To work around this I figured I could just implement the interfaces on the child objects and then delegate the "base" properties to the child properties.<br><br>Also when I'm dealing with other control types, and databinding....&nbsp; If I use the "passing the reference" model above it's not quite as difficult, but it's a little messy.&nbsp; In order to use Microsoft's BindingSource controls I have to create separate BindingSource controls for both my Payment and LineItem Objects using the respective DataMember properties on each control.&nbsp; Then I can add databindings to say textbox, maskedTextbox, DateTimePicker and other controls.&nbsp; It works... but I was hoping for a simpler, cleaner solution.<br><br>Should I just forget about Microsoft's BindingSource controls and just populate any grids or controls the old-fashioned unbound way?<br><br>I kind of like the new BindingSource controls.&nbsp; They're pretty cool.&nbsp; I've always avoided DataBinding in the past because Visual Studios previous implementations of it kind of stunk up the joint.&nbsp; So if anyone can think of another way to use it... along with aggregation... your thoughts would be appreciated.<br><br><i>Rance</i><br><br><br><br><br> <br><br><br><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>malloc1024 replied on Thursday, May 18, 2006</h2>

<p class="MsoNormal">A payment does not behave as a lineitem. Therefore
inheritance is not appropriate in this situation.<span>&nbsp; </span>Shouldn’t there be an invoice or order object
that contains multiple lineitems?<span>&nbsp; </span>Are
payments actually applied to a lineitem or are they applied to an account?<span>&nbsp; </span>Your classes should not be designed with
binding in mind.<span>&nbsp; </span>You will not get a very
good design this way.<span>&nbsp; </span>If you want to
bind multiple objects you could try a façade that wraps multiple objects to
provide a simpler interface.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RanceDowner1234 replied on Thursday, May 18, 2006</h2>Thanks for your input malloc1024.&nbsp; In this case the definition of a "LineItem" is an entry in an Accountbook, not an InvoiceItem.&nbsp; A LineItem can be either a debit or a credit.... similiar to a checkbook "line item". &nbsp; In my application there is a AccountBookQuarter Parent Object.&nbsp; Then there are Invoice "LineItems", Payment LineItems, Interest LineItems.&nbsp; So to answer your question directly, yes Line Items are applied to an Account, not an Invoice.<br><br>There are different types of Invoice LineItems.&nbsp; In this case my company sells wholesale energies to smaller Telephone, Gas, and Electric companies.&nbsp; But a Telephone company receives a different kind of Bill, with different fields on it, than a Gas or Electric Company Does.<br><br>Also there are different kinds of Payment methods.&nbsp; For instance a ResidentialOnlyServiceProvider is only allowed to pay by Check or Money Order.&nbsp; A CommercialServiceProvider is allowed to pay by check or Automatic Fund Transfer.&nbsp; There's some other logic too.&nbsp; For instance Telephone "ResidentialOnly" service providers are able to correct their own bill, namely "kilowatt hours used", sending that corrected information in with the payment.&nbsp; A Telephone CommercialServiceProvider cannot correct their bill, but must call in first, we correct the invoice, and then re-bill them.&nbsp; So on a Telephone ResidentialServiceProvider's payment we want to track what they stated on their returned bill, and before voiding out and correcting the invoice line item itself.&nbsp; <br><br>I'm sure all that was clear as mud.&nbsp; It's kind of muddy business rules :0)<br><br>Anyway... I tried setting up the inheritance chain as follows:<br><br><b>LineItemBase</b>:&nbsp; With EntryID, EntryDate, EntryAmount (Debit or Credit)<br><br><b>InvoiceBase </b>(Derives from "LineItemBase"): With Fields that all Invoices hold in common.&nbsp; <font color="#a52a2a">Note: This object does indeed have a collection of InvoiceItems that applies to the total billable amount</font><br><b>TelephoneCompanyInvoice </b>(Derives from InvoiceBase): With fields particular to an Telephone company invoice <br><b>GasCompanyInvoice</b>: With fields particular to an Gas company invoice<br><b>ElectricCompanyInvoice</b>: With fields particular to an Electric company invoice <br><br><b>PaymentBase </b>(Derives from "LineItemBase"): With fields that all Payments have in common (for instance Check Number, and check amount, what part of payment applies to Principal, and what part applies to interest)<br><b></b><b>TelephonePayment </b>(Derives from PaymentBase):&nbsp; Corrected Kilowatt hours is an extra field<br><b>TelephoneCommercialPayment </b>(Derives from PaymentBase):&nbsp; But adds the Automatic Fund Transfer routing number <br><b>GasPayment </b>(Derives from PaymentBase):&nbsp; Nothing extra right now, but perhaps in future???<br><b>ElecPayment </b>(Derives from PaymentBase):&nbsp; Nothing extra right now, but perhaps in future???<br><br>Anyway... long story short...&nbsp; I kinda thought PaymentBase looked like a "behaves as a" scenario.... but even if it is... what's your take... inheritance or aggregation?<br><br>Thx again.&nbsp; I'm trying to get this OOP down.&nbsp; But boy, what a deep subject.&nbsp; Most people say your first OOP project fails.&nbsp; I'm trying not to fall into that category.&nbsp; I think Lhotka's set me in the right direction with his framework.&nbsp; I'm starting to grasp concepts like singleton instantiation, and factories.&nbsp; But like I said, I suppose it could be real easy to shoot yourself in the foot on this aggregation vs inheritance thing.&nbsp; Especially if some of the business rules change down the road.<br><br>Also thanks for the idea on the facade.&nbsp; I imagine that could take care of my databinding issues if I went with aggregation.<br><br><i>Rance</i><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
