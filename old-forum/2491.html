<html><header><title>Encapsulation/composition question...</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Encapsulation/composition question...</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/2491.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfphill posted on Thursday, March 08, 2007</h2><P>&nbsp;&nbsp;Hey all,</P>
<P>I'm trying to sort the best way to leverage the framework for a particular kind of class that is cased on relationship that is sort of like ResourceAssignment in the projectTracker example.</P>
<P>In our case we have a Resource class with a child collection of Tags.</P>
<P>From a data perspective we find these tags via an association table because the relationship of Resources to Tags is many to many.</P>
<P>Initially I just defined a RelationshipTag child object and wrote stored procs that would query both the association table and the tag table, and handle saving to both the association table and the tag table as well.</P>
<P>But, I'm finding that I don't want to have to make changes to both the ResourceTag AND the tag classes when the business rules change, so...&nbsp; it makes sense that ResourceTag needs to use Tag when necessary and I have to give in to the natural "behaves like" that is staring me in the face.</P>
<P>So, the ResourceTag behaves like a Tag, but has the additional ID field that ties it to the resource to which it belongs.&nbsp; The properties of the ResourceTag are essentially all the fields of the Tag + the ResourceID it's tied to.</P>
<P>finally my question... </P>
<P>I'm looking for ease and best practice here.&nbsp; I don't REALLY want to define this via inheritance, but rather composition, it&nbsp;seems like that is predominant advice on this forum.&nbsp; So I create a ResourceTag object and within the class add a private Tag object to manage all the CRUD to the Tag (thereby getting to use all its methods).&nbsp; </P>
<P>If I define the Tag as a private child class within ResourceTag I can use the framework to do all the heavy lifting for me.&nbsp;&nbsp;I can then just map all the properties of the private child class up to the public properties of the parent class (ResourceTag).&nbsp; Is that the proper way to use the framework?&nbsp; </P>
<P>I just don't see any examples of when I look around on this forum of a parent class that hides a child class and just wraps the properties of that class. </P>
<P>Thanks for any and all advice...</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Justin replied on Thursday, March 08, 2007</h2><P>Well in your case it sounds like the only behaivoral difference between ResourceTag and Tag is how the Tag data is retrieved, either one at a time to edit a tag, or all the Tags for a resource when the Resource is loaded.</P>
<P>If this is truly the case then&nbsp;you could&nbsp; just use the Tag class but you could run into performance issues since you would do a sql query to find the TagID associated with the Resource and loop through the results doing a Fetch on each ID to get a Tag to place in the Resource.Tags list.</P>
<P>To make it perform better you may have to perhaps add an alternate Fetch to Tag that takes a ResourceID and returns the List using SQL to gather all Tag data in one shot. Although others may chime and and suggest you not add that to Tag but instead make a ResourceTag that supports this new fetch being a different behaivor.</P>
<P>Justin</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, March 08, 2007</h2><BLOCKQUOTE><div><img src="/Themes/basicblue/images/icon-quote.gif"> <strong>rfphill:</strong></div><div>So, the ResourceTag behaves like a Tag, but has the additional ID field that ties it to the resource to which it belongs.&nbsp; The properties of the ResourceTag are essentially all the fields of the Tag + the ResourceID it's tied to.<p>I'm looking for ease and best practice here.&nbsp; I don't REALLY want to define this via inheritance, but rather composition, it&nbsp;seems like that is predominant advice on this forum.&nbsp; So I create a ResourceTag object and within the class add a private Tag object to manage all the CRUD to the Tag (thereby getting to use all its methods). </div></BLOCKQUOTE></p>If Tag's behavior is what you want, inheritance may be an option for you, provided that the behaviors ResourceTag gets from Tag are always going to be the one that ResourceTag should keep.<br><br>If you want composition though, it sounds like your plan of attack is a valid one.&nbsp; You'd encapsulate as you plan, but you'll need to be sure to have an event handler that listens to PropertyChanged events from Tag.&nbsp; You'll probably want to re-raise the event from Tag, especially if you can change the embedded Tag's properties through your ResourceTag.&nbsp; You may need to re-implement System.ComponentModel.IDataErrorInfo so that you can get error messages out of the Tag object.&nbsp; I'm not sure about that one though...<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rfphill replied on Thursday, March 08, 2007</h2><P>Thanks to those who gave their opinions...&nbsp;&nbsp;&nbsp; I went the route of just making the actual tag class a private child class of the ResourceTag.&nbsp; I will just delegate to the Tag object all the CRUD chores of the tag based properties...</P>
<P>I guess my prevailing question is:&nbsp; When using composition/aggregation, like in this case, a Tag within a ResourceTag, should the Tag be a&nbsp;Editable Child?</P>
<P>If a ResourceTag 'has a' Tag, but the Tag is hidden/private, is the Tag considered an editable child?</P>
<P>I'm insanely out of my element here, but learning...&nbsp; thanks for your patience with these newbie questions..</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rkotecha replied on Thursday, March 08, 2007</h2><P>I've been comparing your approach to the approach Rocky took in defining the Project, ProjectResources, ProjectResource hierarchy. I think it would help if you could contrast your situation with his.</P>
<P>I can see that Rocky ultimately resists the temptation to use composition in his case. Instead he passes a Resource (in your case I think this would be Tag) to the ProjectResource and then sets some private members. It seems he doesn't need to access the CRUD members of Resource from ProjectResource (In the context of ProjectTracker this makes a lot of sense)</P>
<P>Based on the approach you've described I have some questions:</P>
<P>i. Do you have a screen that allows you to edit Tag information outside of the context of any Resource? If so aren't you forced to create a ResourceTag object in order to update the Tag?</P>
<P>ii. How does your situation differ from Rocky's (re Project, ProjectResources and ProjectResource)?</P>
<P>I'm looking to adopt CSLA so I'm looking for all the feedback I can from real life problems and questions so thanks for posting!</P>
<P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>rfphill:</strong></div><div></P>
<P>Thanks to those who gave their opinions...&nbsp;&nbsp;&nbsp; I went the route of just making the actual tag class a private child class of the ResourceTag.&nbsp; I will just delegate to the Tag object all the CRUD chores of the tag based properties...</P>
<P>I guess my prevailing question is:&nbsp; When using composition/aggregation, like in this case, a Tag within a ResourceTag, should the Tag be a&nbsp;Editable Child?</P>
<P>If a ResourceTag 'has a' Tag, but the Tag is hidden/private, is the Tag considered an editable child?</P>
<P>I'm insanely out of my element here, but learning...&nbsp; thanks for your patience with these newbie questions..</P>
<P>&nbsp;</P></div></BLOCKQUOTE></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
