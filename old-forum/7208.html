<html><header><title>How to validate child collection?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>How to validate child collection?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7208.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>tchimev posted on Wednesday, July 01, 2009</h2>I have a base class which inherits BusinessBase.<br>I have a child property of type BLB in my masterBB.<br>I need to vlaidate that child collection when items are added or removed.<br>Errors should be displayed through windows forms error provider.<br>In my base class I have a fake property(standart .net readonly property) to display errors.<br>So I add validation rule for the child collection to my fake property.<br><br>ValidationRules&lt;MasterBB&gt;.AddRule(ValidateChildCollection, "FakeProperty");<br><br>In my base class I hook up for ChildChanged and PropertyChanged events and call<br><br>ValidationRules.CheckRules("FakeProperty");<br><br>When I change items in the child collection the error provider not seems to refresh correctly.<br><br>If masterBB become invalid sometimes error provider does not display the error.<br>Sometime when masterBB become valid error provider displays previous errors.<br>After I click on a control the error provider refreshes to correct values.<br><br>Is it a good practice to call CheckRules("FakeProperty") in ChildChanged and PropertyChanged events?<br>Could those calls mess-up the error provider?</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tchimev replied on Thursday, July 02, 2009</h2>No one faced that situation?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Thursday, July 02, 2009</h2>Usually I override OnChildChanged, InsertItem, and RemoveItem to call a private method enumerate the collection and call a CheckRules method on each child method, which runs whatever rules need to be run (usually all of them).</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
