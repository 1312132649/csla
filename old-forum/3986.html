<html><header><title>Returning data from dataportal even when a Authorization rule fails</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Returning data from dataportal even when a Authorization rule fails</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3986.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>bigface3 posted on Wednesday, December 05, 2007</h2><P>I'd like to know if there is a way to get the dataportal to still load and return the object even though it may encounter a Authorization rule exception for one of the properties?</P>
<P>At first glance I've noticed if you add a AuthorizationRule.AllowRead (or DenyRead) for a particular property and give it a role that will fail, and&nbsp;you&nbsp;specify CanReadProperty("property", true) in it's getter, that when the dataportal fetches the object it throws the error back to the UI and the object is null.&nbsp; Is the only way around this to change all the getters to code like this?</P>
<P>if (CanReadProperty("name", false))<BR>&nbsp;return _name;<BR>else<BR>&nbsp;return string.Empty;</P>
<P>Of course returning string.Empty would only work for a string Property, other types would required their own default return value.&nbsp; Which would mean that this type of code would have to be added to the BOs manually, not templatable?</P>
<P>As a side note, I tested out the ProjectTracker solution adding a AuthorizationRule.AllowRead("Name", "NoRule"); to the Project BO and ran the winform&nbsp;project (using Csla authentication), viewed a project, and Main.cs caught the exception and poped-up a dialog box, but the project form still loaded the rest of the data, is that done through the ReadWriteAuthorization control?</P>
<P>&nbsp;</P>
<P>One more question! :-)&nbsp; What is the diff between InstanceAllowRead and AllowRead?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, December 05, 2007</h2>Well, I'm not sure what the DataPortal has to do with your Authorization exception.&nbsp; In the DataPortal, you should be interacting with fields only.<br><br>As far as the UI goes, yes, the exception is a problem, and the getter code should be modified not to throw an exception.&nbsp; That's because data binding attempts to read the value anyway.<br><br>InstannceAllowRead works on one instance of the object; say for Invoice #123, users in Role y cannot read a property.&nbsp; AllowRead would enforce that rule on ALL instances of Invoice, regardless of their number.<br><br>HTH<br>andy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>KeithElder replied on Wednesday, December 05, 2007</h2>I think what he was saying is that the rules were getting checked on the application server and throwing an exception before it was getting data bounded.&nbsp; Based on that the object was having its data put into it then something else obviously had to run to check the rules.&nbsp; Are the rules check after the object is fetched every time?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>KeithElder replied on Wednesday, December 05, 2007</h2>Question on the InstanceAllowRead then. What is the best practice using the Instance* methods for rules.&nbsp; For example if the business determines the a Manager can read the cost field for an item but other team members can't.&nbsp; When an instance of that object is created there has to be some rule that says if the person looking at the instance of the object is a manager then allow the cost property to be read and vice versa not be read if they are not.&nbsp; <br><br>Just curius how most folks handle that situation.<br><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
