<html><header><title>Interacting with DataPortal_XYZ methods in my base class</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Interacting with DataPortal_XYZ methods in my base class</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/3840.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>bgilbert posted on Friday, November 02, 2007</h2>I need to be able to wedge some code in after certain DataPortal methods. In my base class, I've tried overriding DataPortal_Fetch, but it never gets hit. I've also tried using DataPortal_OnDataPortalInvokeComplete, but I can't see how to determine which method fired it. I saw <a HREF="/forums/post/558.aspx">some discussion</a> on this last year and Rocky mentioned that he would have a fix for this, but I haven't seen anything that would help me. I'm using 3.02.<br><br>Any ideas?<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DavidDilworth replied on Friday, November 02, 2007</h2><P>Double check the signature for your DataPortal_Fetch() override method.&nbsp; The method in your base class should look something like this:</P><FONT size=2>
<P></FONT><FONT face="Courier New"><FONT color=#0000ff size=2>protected</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>override</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>void</FONT><FONT size=2> DataPortal_Fetch(</FONT><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2><FONT face="Courier New"> criteria)<BR>{<BR>&nbsp;&nbsp;&nbsp;// Your code goes here<BR>}</FONT></P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>bgilbert replied on Friday, November 02, 2007</h2>David,<br><br>That is the signature I have, however, in my business class, I have to use an Overload, like this:<br><br>Private Overloads Sub DataPortal_Fetch(ByVal criteria As MyCriteriaClass)<br><br>MyCriteriaClass cannot be an override of Object, therefore I can't use:<br><br>Private Overrides Sub DataPortal_Fetch(ByVal criteria As FilterCriteria)<br><br><br>Barry<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DavidDilworth replied on Friday, November 02, 2007</h2><P>If you've got a DataPortal_Fetch() with a strongly typed criteria object (as you suggest) in your BO class, then the override method&nbsp;in the base class will NEVER be hit.&nbsp; The DataPortal automatically detects the method signature with the strongly-typed Criteria object and calls that directly.</P>
<P>So if you really want to write some code in an abstract base class that will work for any BO class, then you have to work with the abstraction of a loosely-typed Criteria object.&nbsp; Like the one I posted above.&nbsp; That way the&nbsp;override&nbsp;will always get hit for any Criteria object from any Business Object.</P>
<P>That also means that you can't use a method in your BO class with a strongly-typed Criteria object.</P>
<P>However, inside your BO&nbsp;class you can then override the DataPortal_Fetch() from your abstract base class and cast the loosely-typed Criteria object to the strongly-typed Criteria object that you really want to work with.</P>
<P>Does that help?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>bgilbert replied on Friday, November 02, 2007</h2>Yes, it makes sense, however in many of my business classes, I have overloads of each DataPortal method, which receive different criteria objects. I would have several nested criteria classes that handle different combinations of criteria. I do this because different DataPortal methods need to call different stored procedures. <br><br>As I write this, I realize that I might be able to use one criteria class and one DataPortal method and simply pass the spoc name though the criteria class.<br><br>I'll give it a try.<br><br>Thanks.<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Friday, November 02, 2007</h2><P>Barry,</P>
<P>This discussion may help a bit.</P>
<P>I have been passing in MethodName for a long time now.</P>
<P><A HREF="/forums/post/17535.aspx">http://forums.lhotka.net/forums/post/17535.aspx</A></P>
<P>Joe</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
