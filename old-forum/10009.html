<html><header><title>BindingSource and Parent - Child forms interaction</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>BindingSource and Parent - Child forms interaction</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10009.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Lazaro posted on Monday, January 31, 2011</h2><p style="margin:0in 0in 10pt;" class="MsoNormal"><span style="font-size:small;font-family:Calibri;">I have a doubt related with BindingSource</span></p>
<p style="margin:0in 0in 10pt;" class="MsoNormal"><span style="font-size:small;font-family:Calibri;">Scenario:</span></p>
<p style="margin:0in 0in 10pt;" class="MsoNormal"><span style="font-size:small;font-family:Calibri;">I have a main form where one of the controls it contains is a grid, and from this grid you can open a dialog to edit one of its elements (edit a child object). Changes in the child object causes changes in the parent object as well (in main form). </span></p>
<p style="margin:0in 0in 10pt;" class="MsoNormal"><span style="font-size:small;font-family:Calibri;">Main form: LoanSetupForm (Root Object: LoanSetup and Child Collection: WorkUnits)</span></p>
<p style="margin:0in 0in 10pt;" class="MsoNormal"><span style="font-size:small;font-family:Calibri;">Dialog: WorkUnikForm (Child Object: WorkUnit)</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;" class="MsoNormal"><span style="font-size:small;font-family:Calibri;">When the dialog form opens, I have to call:</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;" class="MsoNormal"><span style="font-size:small;font-family:Calibri;">ParentForm.UnBindEverything()</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;" class="MsoNormal"><span style="font-size:small;font-family:Calibri;">ParentForm.LoanSetupObj.BeginEdit()</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;" class="MsoNormal"><span style="font-size:small;font-family:Calibri;">&nbsp;</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;" class="MsoNormal"><span style="font-size:small;font-family:Calibri;">When the dialog form closes I have to call:</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;" class="MsoNormal"><span style="font-size:small;font-family:Calibri;">ParentForm.LoanSetupObj.ApplyEdit() or ParentForm.LoanSetupObj.CancelEdit()</span></p>
<p style="margin:0in 0in 0pt;line-height:normal;" class="MsoNormal"><span style="font-size:small;font-family:Calibri;">ParentForm.RebindEverything()</span></p>
<p style="margin:0in 0in 10pt;" class="MsoNormal"><span style="font-size:small;font-family:Calibri;">&nbsp;</span></p>
<p style="margin:0in 0in 10pt;" class="MsoNormal"><span style="font-size:small;font-family:Calibri;">I am wondering if there is a better way to call BeginEdit() on a root object after bound (from a child object/form) because I have to expose the unbind and rebind to other forms to be able to accomplish this. This approach seems as an overkilled, especially if the child object were to be editable in the grid (and I would have to do this when getting into one line of the grid).</span></p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Monday, January 31, 2011</h2><p>Prior to CSLA 4 it was not possible to bind one object to more than one Windows Forms binding source, because the IEditableObject implementation wouldn&#39;t support the concept.</p>
<p>In CSLA 4 the one major enhancement for Windows Forms was to update this implementation so it is possible to bind one object to more than one binding source.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, February 01, 2011</h2><p>But, there&#39;s just a few lines of code that needs to be changed in Csla.Core.BusinessBase so I could easily &quot;downport&quot; this from Csla 4 to Csla 3.8.4 beta. </p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Lazaro replied on Tuesday, February 01, 2011</h2><p style="margin:0in 0in 10pt;" class="MsoNormal"><span style="font-size:small;font-family:Calibri;">My question was really about having to <strong>unbind</strong> because I had to call the <strong>BeginEdit </strong>in the root object not because I had to bind the same objects with other controls, which is also true.</span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Tuesday, February 01, 2011</h2><p>When you say Dialog you actually mean a Modal Form - owned by the parent form? </p>
<p>What type of changes are done to the parent object when you edit a child? </p>
<p>The challenge is to maintain a correct EditLevel on you object graph and maintain a predictable series of Begin/Apply/Cancel and if DataBinding is active in the MainForm you really have little control on when BeginEdit/ApplyEdit or CancelEdit is called unless you do an unbind/rebind.&nbsp;</p>
<p>If you have a modal dialog I&#39;d prefer to keep the Unibind/Rebind as private methods in your MainForm. </p>
<p>And the properties that are set in Parent cold possible be reset by BusinessRules when a ChildChanged event occurs (and thus maintained by the root object only). That way you would only have to worry about BeginEdit/CancelEdit/ApplyEdit on the child object.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
