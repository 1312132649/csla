<html><header><title>Csla 1.1 and using TransactionScope</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Csla 1.1 and using TransactionScope</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6598.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>SeanRhone posted on Wednesday, March 11, 2009</h2><P>My company won't give me the time to upgrade so we're still using Csla 1.1 but I put in a </P><FONT color=#0000ff size=2>
<P>using</FONT><FONT size=2> (transScope = </FONT><FONT color=#0000ff size=2>new</FONT><FONT size=2> </FONT><FONT color=#2b91af size=2>TransactionScope</FONT><FONT size=2>(</FONT><FONT color=#2b91af size=2>TransactionScopeOption</FONT><FONT size=2>.RequiresNew))<BR>{<BR>}</FONT></P>
<P><FONT size=2>in a method that calls child business object for updating and I'm getting '<FONT size=2>The operation is not valid for the state of the transaction" sometimes. Anyone know if there is a compatability issue between Csla 1.1 transactions and the newer .NET 2.0 TransactionScope?</FONT></FONT></P>
<P><FONT size=2>It looks like all the child business objects updated correctly but I still get this error.</FONT></P>
<P><FONT size=2><FONT size=2>Thanks</P></FONT></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tlong replied on Wednesday, March 11, 2009</h2><P>We had something like this happening and it was due to not using the same connection for the child update as the parent.</P>
<P>Are you using the ContextManager (ala CSLA 3.x) or the ApplicationContext (ala CSLA 2.1.4) to pass the connection to the child?</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SeanRhone replied on Wednesday, March 11, 2009</h2>Nope still using Csla 1.1 for now.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tlong replied on Wednesday, March 11, 2009</h2><P>I don't have a copy of 1.1 handy.&nbsp; What's the pattern for a child update method?</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, March 11, 2009</h2><P>You must remember that your application is only running in the context of <EM>one version of .NET</EM>. So a TransactionScope is the same throughout your app, because you are only running one version of .NET.</P>
<P>(there was no TransactionScope in .NET 1.x btw, so there are obvious "compatibility issues" there :) )</P>
<P>Odds are that you are not using the same transaction scope or the same database connection across all your objects, and that's causing you the issue.</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
