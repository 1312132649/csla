<html><header><title>getting item id from datagridview</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>getting item id from datagridview</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/155.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>dean posted on Saturday, May 20, 2006</h2>in his window forms example, when using a datagridview to display his collections, rocky has a non visible column (width=5 for some reason) hold his item key. This he accesses with:<br><br>resourceid =&nbsp;&nbsp; CInt(Me.ResourcesDataGridView.SelectedRows(0).Cells(0).Value)<br><br>This is similar to the strategy used with his datalistview control from csla 1.0/1.5 days.<br><br>One of the problems with this is you can't let the user change column widths.<br><br>What about using:<br>ResourcesDataGridView.CurrentRow.DataBoundItem.ToString<br><br>since we override each objects tostring with our key value this seems to work. Additionally you can get any property value by casting it to your object type. For instance in project edit, resourcesdatagridview, project resource item:<br><br>RoleID = ctype(ResourcesDataGridView.CurrentRow.DataBoundItem,ProjectResource).Role<br><br>Anyone see any problems with this?<br><br>Dean<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xal replied on Saturday, May 20, 2006</h2>It's always best to use your currency manager / binding source.<br><br>I think it's: <br>yourBindingSource.Current <br>(I don't have access to the code now, and since this is coded in my base class it's not something i do too often...)<br><br>You'll have to cast it to whatever your item is...<br><br>DirectCast(yourBindingSource.Current, ObjectType).ObjectId<br>Make sure you check for nulls!!<br><br>Andr√©s<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
