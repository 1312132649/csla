<html><header><title>Localization with NameValueList</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Localization with NameValueList</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/1255.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Gort posted on Monday, September 18, 2006</h2><P>I am wondering about the suggested way to handle the following scenario:</P>
<P>We have dropdownlists that are populated from our database via the NameValueList class.&nbsp; We also are implementing localization on our site, so is there is a recommended method for changing the value of the string for the dropdownlist?</P>
<P>So, if our dropdownlist has the items 'Public', 'Private', and 'Other' (each with their own ID value), how would I update those values for, say, a French user?&nbsp; The lookup table that I am referring to above is a foreign key for another table, say 'Company'.&nbsp; </P>
<P>We were thinking of putting a pseudo string in the database, like 'Company_Private'.&nbsp; Then, replacing this string within the NameValueList with the actual resource string.&nbsp; Not sure if this is the best approach though.</P>
<P>Thoughts?</P>
<P>Thanks for looking...</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Henrik replied on Monday, September 18, 2006</h2><P>Gort</P>
<P>You could put the resource key string into the database and then do a replacement when you display the valuelist. However, this reduces your extensibility. If you ever want to add other types to the database, you'll have to at least add the new values to your resources files and recompile these or at worst recompile your entire application if the resources aren't in satellite assemblies.</P>
<P>Another way of solving this is to create a localized string table in the database and store the different language representations of your strings in this and have a foreign key from your lookup table. The table could look like this:</P>
<P>Table: Strings<BR><FONT face="Courier New" size=2>StringId&nbsp;&nbsp; Int Identity<BR>Culture&nbsp;&nbsp;&nbsp; varchar(6)<BR>String&nbsp;&nbsp;&nbsp;&nbsp; nvarchar(256) null<BR>LongString ntext null</FONT></P>
<P>The stored proc, that retrieves your lookup table values will need the culture code (en-US/da-DK/other) and make a join with the Strings table. You'll be able to use this for other tables that must be localized as well.</P>
<P>This, however, is a lot more work and you'll get a small performance penalty from the join. This approach will work both for static values (values that you define as a developer) and for user defined values (values created by the user).</P>
<P>There is one catch, though. The user created strings stored in the db will be in the language that the user speaks, meaning that if an english speaking user is entering a description of something, say a road direction, this will only be stored in the english version unless you provide the user with a UI where he/she can provide a string version for every language your app supports and the user is capable of translating the string into all these languages, which is unlikely.</P>
<P>I come from Denmark and we are only about 6 mio people speaking the danish language in the world, so I've come across localizing applications more often than not. What I found is that the above-described method is great for static (developer defined) strings, but it's almost impossible to create an application where user defined strings are localized as well. Even if users are capable of describing strings in 10 different languages, nobody would want to do this. So I've come to a manual solution, where I instruct the users to write their strings in english, if they know that it will be seen by users speaking other languages (just like this messageboard, where everything is in english).</P>
<P>Hope this helps</P>
<P>/Henrik</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Gort replied on Tuesday, September 19, 2006</h2>I do not want to store any resources in the database.&nbsp; I want all my resources stored in one location, the resource files.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Henrik replied on Wednesday, September 20, 2006</h2><P><SPAN>Then you should follow the approach you suggested by storing the resource key strings in the lookup table and replace these in your fetch method like so:<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>Private</SPAN><SPAN> <SPAN>Overloads</SPAN> <SPAN>Sub</SPAN> DataPortal_Fetch(<SPAN>ByVal</SPAN> crit <SPAN>As</SPAN> Criteria)<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp; </SPAN>…<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp; </SPAN><SPAN>Using</SPAN> dr <SPAN>As</SPAN> <SPAN>New</SPAN> SafeDataReader(cm.ExecuteReader)<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp; </SPAN><SPAN>&nbsp;&nbsp; </SPAN><SPAN>If</SPAN> dr.Read() <SPAN>Then<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN>&nbsp;&nbsp; </SPAN><SPAN>With</SPAN> dr<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>_value = <SPAN>My</SPAN>.Resources.ResourceManager.GetString(.GetString(</SPAN><SPAN>"Value"</SPAN><SPAN>))<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN>…<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT color=#0000ff>End With</FONT>&nbsp;</SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN></SPAN><SPAN>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End</SPAN> <SPAN>If<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp; </SPAN><SPAN>End</SPAN> <SPAN>Using<o:p></o:p></SPAN></SPAN></P>
<P class=MsoNormal><SPAN><SPAN>&nbsp;&nbsp; </SPAN>…<o:p></o:p></SPAN></P>
<P class=MsoNormal><SPAN>End</SPAN><SPAN> <SPAN>Sub</SPAN></SPAN><SPAN><o:p></o:p></SPAN></P>
<P class=MsoNormal><o:p>&nbsp;</o:p></P>
<P class=MsoNormal>/Henrik</P>
<P><FONT size=2>&nbsp;</P></FONT></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Gort replied on Wednesday, September 20, 2006</h2>OK, I'll look into implementing things that way then.&nbsp; Thanks for checking&nbsp;out my post and giving me some feedback.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
