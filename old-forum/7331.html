<html><header><title>Use BusinessBase for both base and derived classes</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Use BusinessBase for both base and derived classes</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/7331.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Frances83 posted on Thursday, July 23, 2009</h2><font size="2" face="Verdana">Hi all,<br><br>I apologize in advance if this question has been asked before on this forum, but I couldn't find it <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /><br><br>I have the following situation (as a simplified example): <br><br>In our app we have to support addresses for several countries, i.e. New Zealand, Australia etc. The addresses largely consist of the same properties, so we have a base class called BaseAddress which has properties like Country, City and ZipCode. The NZ address (NZAdress) derives from BaseAddress and has some extra properties of its own, like Suburb.<br><br>Now we're integrating CSLA .Net in our app, and I'm trying to refactor the Address-classes. Ideally, what I want is that:<br><br></font><ul><li><font size="2">BaseAddress inherits from Businessbase (public class BaseAddress : BusinessBase&lt;BaseAddress&gt;) <br></font></li><li><font size="2">NZAddress inherits both from BusinessBase <span>and </span>from BaseAddress (public class NZAddress : BaseAddress, BusinessBase&lt;NZAddress&gt;). </font></li></ul><br><font size="2">I know the last is not possible, since .Net doesn't support multiple inheritance, but I'm wondering if there's a clever trick in CSLA .Net to work around this?<br><br>Thanks in advance for your reply,<br>Frances83<br></font><font size="2" face="Verdana"><br></font><font size="2"><br></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>SonOfPirate replied on Thursday, July 23, 2009</h2><P>Not sure I follow the request.&nbsp; By deriving NZAddress from BaseAddress, it does inherit BusinessBase so you do get the benefit of all behaviors in that class plus polymorphism which will allow you to type your variables and references as either BaseAddress or BusinessBase.&nbsp; Is there something else you are trying to accomplish?</P>
<P>If you are looking to strongly type the generic BusinessBase methods to NZAddress, then let me suggest this:&nbsp; </P>
<UL>
<LI>
<P>Make AddressBase generic with your common properties and methods, such as:<BR>&nbsp;<BR>&nbsp; &nbsp; <CODE>public abstract class AddressBase&lt;T&gt; : BusinessBase&lt;T&gt;</CODE> </P></LI>
<LI>
<P>Create an Address class which is declared as:<BR>&nbsp;<BR>&nbsp; &nbsp; <CODE>public class Address : AddressBase&lt;Address&gt;</CODE> </P></LI>
<LI>
<P>Create the NZAddress as:<BR>&nbsp;<BR>&nbsp; &nbsp; <CODE>public class NZAddress : AddressBase&lt;NZAddress&gt;</CODE></P></LI></UL>
<P>This will allow you to strongly type BusinessBase and allow polymorphism through the AddressBase class.</P>
<P>If this isn't what you were after, please explain.</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Frances83 replied on Thursday, July 23, 2009</h2><font size="2" face="Verdana"><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>SonOfPirate:</strong></div><div>By deriving NZAddress from BaseAddress, it does inherit BusinessBase so you do get the benefit of all behaviors in that class plus polymorphism which will allow you to type your variables and references as either BaseAddress or BusinessBase.</div></BLOCKQUOTE><br><br>Hi SonOfPirate,<br><br>Thanks for your response. Let me explain further. What you said in the above quote I tried to use as well. My BaseAddress class looked like this:<br><br><font size="1" face="Courier New">&nbsp;&nbsp;&nbsp; [Serializable()]<br>&nbsp;&nbsp;&nbsp; public class BaseAddress : BusinessBase&lt;BaseAddress&gt;, IAddress<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static PropertyInfo&lt;string&gt; countryProperty = RegisterProperty&lt;string&gt;(c =&gt; c.Country, "Country", String.Empty);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static PropertyInfo&lt;string&gt; addressProperty = RegisterProperty&lt;string&gt;(c =&gt; c.Address, "Address", String.Empty);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static PropertyInfo&lt;string&gt; cityProperty = RegisterProperty&lt;string&gt;(c =&gt; c.City, "City", String.Empty);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static PropertyInfo&lt;string&gt; zipCodeProperty = RegisterProperty&lt;string&gt;(c =&gt; c.ZipCode, "ZipCode", String.Empty);<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // All the rest of the implementation etc<br>&nbsp;&nbsp;&nbsp; }</font><br><br>And my NZAddress like this:<br><br><font size="1" face="Courier New">&nbsp;&nbsp;&nbsp; [Serializable]<br>&nbsp;&nbsp;&nbsp; public class NZAddress : BaseAddress<br>&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private static PropertyInfo&lt;string&gt; addressLineTwoProperty = RegisterProperty&lt;string&gt;(c =&gt; c.AddressLineTwo, "AddressLineTwo", String.Empty);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private static PropertyInfo&lt;string&gt; suburbProperty = RegisterProperty&lt;string&gt;(c =&gt; c.Suburb, "Suburb", String.Empty);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // All the rest of the implementation etc.<br>&nbsp;&nbsp;&nbsp; }<br></font><br>The problem here being that in NZAddress I would get the error: <font size="1" face="Courier New">'BaseAddress' does not contain a definition for 'AddressLineTwo' and no extension method 'AddressLineTwo' accepting a first argument of type 'BaseAddress' could be found (are you missing a using directive or an assembly reference?)<br><br><font size="2" face="Verdana">So if I derive my class from a class which implements BusinessBase, I can't add PropertyInfo objects to the derived class! Which is a bother <img src="/emoticons/emotion-5.gif" alt="Wink [;)]" /><br><br></font></font></font></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Frances83 replied on Thursday, July 23, 2009</h2><font size="2" face="Verdana">I am tired... Whole problem fixed by just using a different way of registering the properties... This works:</font><br><br><font size="1" face="Courier New">private static PropertyInfo&lt;string&gt; addressLineTwoProperty = RegisterProperty&lt;string&gt;(new PropertyInfo&lt;string&gt;("AddressLineTwo", "AddressLineTwo", String.Empty));<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string AddressLineTwo<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; get<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return GetProperty(addressLineTwoProperty);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; set<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SetProperty(addressLineTwoProperty, value);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</font><br><br><font size="2" face="Verdana">Thanks for the eye opener <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /></font><br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dlambert replied on Friday, July 24, 2009</h2>I think if you're going to do this, you might want to consider having:<br /><br />* BaseAddress<br />* NZAddress : BaseAddress<br />* Address : BaseAddress<br /><br />This last class will end up being essentially an empty shell, but you'll then have a good way to handle departures of your two concrete classes (this is bound to happen at some point).</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>lucafontanarosa replied on Tuesday, January 19, 2010</h2>public abstract class AddressBase T : BusinessBase T  where T:BusinessBase T<br /><br /><br />then you can do all you were saying you couldn't do.</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Wednesday, January 20, 2010</h2>You may have a case where you need to have separate descendents for each different address format, but that could get problematic too. <br /><br />I don't know if you've ever seen this: <br /><br />FRANK'S COMPULSIVE GUIDE TO POSTAL ADDRESSES<br />http://www.columbia.edu/kermit/postal.html<br /><br />Is the number of countries you need to support open-ended or pretty well defined?<br /><br />p.s. there are really good resources out there for phone numbers, too, if you need to handle that. A globalized "phone number" solution is really quite easy to implement. Addresses, not so much. </div><div style='padding:0 15 3 15;background-color:powderblue'><h2>whelzer replied on Wednesday, January 20, 2010</h2>Personally I would just create seperate distinct classes for all your use cases.<br>If you end with NZAddress, AusAddress, IreAddress, etc so be it.&nbsp; It might seem like a good idea to have a base class but what does it really give you&nbsp; - a few properties that you would most probably code gen in about a nanosecond?&nbsp; Generally speaking by having BaseAddress you'll end up with code that is harder to maintain. You'll probably end up with props/methods that not all inherited classes need and a bug in there will flow down to all your classes.&nbsp; Rocky and others has explained&nbsp; this much better in previous posts.<br><br>In our early csla days we made the same "mistake" with baseInstrument (BB) and now have around 9 classes inheriting from this, it gives me nothing but trouble (and a few properties)... eg I get a requirement for a new piece of data, it is common to 4 instruments do I put in the base or just those that need it.&nbsp; It gets worse when you consider validation rules, authorisation, the DP etc.&nbsp; Not saying it can't be done but unless there is a clear business resason to do it I wouldn't bother.. &nbsp; <br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Wednesday, January 20, 2010</h2>If this is meant to be a solution that can support international addresses in general I really don't think separate classes for each country is a good idea.  <br /><br />My two cents</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skagen00 replied on Thursday, January 21, 2010</h2>Someone posted a question. People are giving answers. Don't you think by asking a question the developer is soliciting suggestions? It seems like using inheritence is a primary aspect to the question.<br /><br />If with every country you're creating a new class - something isn't quite right. But that said, if the realistic universe of countries is somewhat defined, then it's probably not a big deal. It sounds like that's the direction the developer was leaning - so be it. <br /><br />If a sampled purpose of separate classes per country would be to have a postal code property for Canada versus a zip code property for US with a validation rule on each for format &amp; length, for example -- that can be done by having a postal code property on a single class, with a regular expression for each country (country as an aspect of the address) to validate a postal code along with some sort of description on the country as to what its referred to. <br /><br /><br /><br /><br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>dlambert replied on Thursday, January 21, 2010</h2>FWIW, I've used inheritance with CSLA classes with great success.  As others have mentioned, it's important to understand whether you're adding complexity or removing it by using inheritance, and that's going to vary greatly based on the design of each individual application.<br /><br />Personally, I'd be a little wary about a design where I've got a class per country, whether they're inherited or not -- I can envision scenarios where that makes sense, but I'd expect them to be rare.</div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
