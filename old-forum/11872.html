<html><header><title>High serialization size/overhead for requests submitted over DataPortal (mainly the DataPortalContext)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>High serialization size/overhead for requests submitted over DataPortal (mainly the DataPortalContext)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11872.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 posted on Thursday, March 07, 2013</h2><p>In response to some complaints from customers regarding network utilitization of our CSLA-based application when deployed using a remote data portal, we&#39;ve done some network snooping and have determined that even the most trivial of requests to the data portal involves a payload of 3K bytes or so of data that is *uploaded* or sent to the data portal, this does not include the data that is returned.</p>
<p>We have determined that much of this&nbsp;is the DataPortalContext (at least 1500 bytes), but we aren&#39;t storing anything in the GlobalContext and have what should be only a few bytes of data in the Client context (two&nbsp;integers and one enum).&nbsp; Eliminating the principal saves &quot;only&quot; 300 bytes, so that isn&#39;t the problem. </p>
<p>It may not seem like much for one request, but when we have hundreds (and at least in one case thousands) of active clients on a network with the total request rate exceeding 100 per second, it starts to add up quickly.&nbsp; </p>
<p>We are still on a version&nbsp;CSLA 3.5 with selective enhancements from newer versions backported to it. Was this by any chance addressed in a newer version? I&#39;m&nbsp;considering implementing some sort of custom serialization but did not want to reinvent the wheel. Other suggestions or recommendations also welcome. </p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>RockfordLhotka replied on Thursday, March 07, 2013</h2><p>In current (4.3 or 4.5) versions of CSLA there are more efficient serialization options available.</p>
<p>In 3.5 your best bet is to utilize compression.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>rsbaker0 replied on Thursday, March 07, 2013</h2><p>Thanks for the quick reply, Rocky.&nbsp; Actually, it was in implementing compression that we discovered the problem.&nbsp; We have implemented Deflate based compression and find that that binary-serialized data that we are downloading will compress surprisingly well, roughly to 25% of original size on average. However, the uploaded criteria/context payload does not compress well at all, generally not better than 50% of the original size and often more than 60%. </p>
<p>Could you point me to something in 4.2/5 that I might be able to take advantage of? I&#39;ve ported newer features back into our version in the past when it made sense to do so.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, March 07, 2013</h2><p>Unfortunately it is a pretty major change that comes at a couple levels.</p>
<p>First, the MobileFormatter was changed to allow the use of custom reader/writer components - the things that actually generate and consume the byte stream.</p>
<p>Second, there&#39;s a new and more efficient reader/writer component pair.</p>
<p>Finally, the overall framework was modified so MobileFormatter can be used in pure .NET scenarios, where before it was just Silverlight/WP7. Now it can be used anywhere.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
