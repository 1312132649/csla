<html><header><title>Root BO Constructor</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Root BO Constructor</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8015.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 posted on Wednesday, November 18, 2009</h2><P>My Root BOs have always had constructors like this:</P>
<P>&nbsp;&nbsp;&nbsp; Protected Sub New()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 'require use of factory methods&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; End Sub</P>
<P>I am setting up a transition to managed properties and may want to use Silverlight in the future.</P>
<P>Should my constructor be changed from Protected to Public?</P>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DancesWithBamboo replied on Wednesday, November 18, 2009</h2>I only make the Silverlight constuctor public so that it can only be mis-used in one type of UI.&nbsp; Format is usually something like this with the constructors and factory methods grouped:<br><br>#if SILVERLIGHT<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;public OfficeManagerClass() <br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;{<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;}<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;public static void&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BeginGetOfficeManager(EventHandler&lt;DataPortalResult&lt;OfficeManagerClass&gt;&gt; handler)<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;{<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;var dp = new DataPortal&lt;OfficeManagerClass&gt;();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;dp.FetchCompleted += handler;<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;dp.BeginFetch();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;}<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#else<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;private OfficeManagerClass()<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;{<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;}<br><br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;public static OfficeManagerClass GetOfficeManager()<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;{<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;return DataPortal.Fetch&lt;OfficeManagerClass&gt;();<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;}<br>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;#endif</div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Wednesday, November 18, 2009</h2><P>Thanks!</P>
<P>That helps a lot.</P>
<P>Where is this defined:&nbsp; &nbsp; #if SILVERLIGHT</P>
<P>Joe</P>
<P>&nbsp;</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>DancesWithBamboo replied on Wednesday, November 18, 2009</h2>Its a conditional compiler symbol like "DEBUG".&nbsp; It gets defines on a Silverlight project automatically.&nbsp; To use Silverlight you need to compile your Business Objects in 2 different projects; one for the server and one for the client.&nbsp; Here is Rocky's blog describing the steps: <a href="http://www.lhotka.net/weblog/SettingUpABasicNtierCSLANETForSilverlightProject.aspx">http://www.lhotka.net/weblog/SettingUpABasicNtierCSLANETForSilverlightProject.aspx</a><br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
