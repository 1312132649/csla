<html><header><title>Is there a way to suspend rule execution in a given object?</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Is there a way to suspend rule execution in a given object?</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/11373.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav posted on Friday, May 25, 2012</h2><p>I have an object hierarchy that is used in multiple &quot;areas&quot; in the same running application. In one of those areas, the rules should not be executed. Is there a way to do that?&nbsp; All of the rule, and there are not many, are the DataAnnotation kind.</p>
<p>Jav</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Friday, May 25, 2012</h2><p>Hi Jav, </p>
<p>Well, there are 2 possibilities I can think of:</p>
<p>1. RuleSets - DataAnnotation rules is typically added to the &quot;default&quot;&nbsp; (actually the current ruleset) in base.AddBusinessRules.&nbsp; You could create an &quot;Empty&quot; ruleset and have none or only a subset of rules. </p>
<p>2. Add ShortCircuiting rules with a priority below 0 (ex 1). DataAnnotation rules is added at Priority=0 so ShortCircuiting at a lower priority will prevent the rules from running. In order to use this you must have a &quot;condition&quot; to test for whether to ShortCircuit or not. .</p>
<p>Is the object editable when you do not want the rules to run. I you do not allow editing then it is even a third option:<br />3. Have an overload or flag that make CanWriteProperty always return false and use a StopIfNotCanWrite rule with Priority = -1:This can also be used with UI helpers like ReadWriteAuthorization and PropertyStatus to &quot;diaable&quot; UI controls.</p>
<p>&nbsp; public class StopIfNotCanWrite : BusinessRule<br />&nbsp; {<br />&nbsp;&nbsp;&nbsp; public StopIfNotCanWrite(IPropertyInfo primaryProperty)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : base(primaryProperty)<br />&nbsp;&nbsp;&nbsp; { }<br /><br />&nbsp;&nbsp;&nbsp; protected override void Execute(RuleContext context)<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var target = (Csla.Core.BusinessBase)context.Target;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Short circuit rule processing for this property if user is not allowed to edit field.<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (!target.CanWriteProperty(PrimaryProperty))<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; context.AddSuccessResult(true);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; }<br />&nbsp; }</p>
<p>This rule and many more can be found in the RuleTutorial Sample (Csla Sample download) and CslaGenFork on CodePlex.</p>
<p><b>The 1st suggestion is probably the easiest to implement. </b>Just set BusinessRules.RuleSet to an &quot;unknown&quot; rule set name and your object will have no rules.</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Jav replied on Friday, May 25, 2012</h2><p>Thanks Johny,</p>
<p>That was helpful.&nbsp; My situation is relatively simple. </p>
<p>I have to deal with incoming XML mesages, which are to be deciphered and interpreted for the user, who will then answer with a message which is the converted to XML and sent back. The requirement is that incoming message be received without validation, but the outgoing messages be thoroughly vetted before being sent back.</p>
<p>At the heart of the process, I have a single, csla based, object hierarchy.&nbsp; Everything is working great but&nbsp; by my objects need to be lenient on the incoming and strict on the outgoing, and I am trying to achieve that.</p>
<p>Jav</p>
<p>&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RonHickman replied on Monday, May 28, 2012</h2><p>Hey jonny , still I couldn&#39;t understand those possibilities, how it works exactly?</p>
<p><a href="http://www.oilpaintingsreproductions.com/">oil painting reproductions</a></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JonnyBee replied on Monday, May 28, 2012</h2><p>Read the blog article here: <a href="http://www.lhotka.net/weblog/CSLA4BusinessRulesSubsystem.aspx">http://www.lhotka.net/weblog/CSLA4BusinessRulesSubsystem.aspx</a>&nbsp;</p>
<p>1. All BusinessBase objects support RuleSet (starting in 4.x) and you can have an &quot;unknown&quot; (or undefined) RuleSet that has no registered&nbsp; rules and thus &quot;disable&quot; all the rules in the &quot;default&quot; ruleset. . </p>
<p>2. Rules run in the given Priority (low to high) per Property and you may short circuit processing (immediate stop) by calling f,.ex context.AddSuccessResult(true).&nbsp; Look at the Net\cs\BusinessRuleDemo in the samples download on how to use this for conditional validation. </p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
