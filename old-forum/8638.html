<html><header><title>Binding Silverlight treeview control - MVVM</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Binding Silverlight treeview control - MVVM</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/8638.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>Larry posted on Wednesday, March 10, 2010</h2><p>There have been several earlier posts regarding binding BOs to treeview controls in Windows Forms and Web forms but we are trying to bind to Silverlight treeview using MVVM with a Csla based tree structure that is retrieved from the db. Because the number of levels of the tree (and the tree nodes) is variable depending on the criteria for the query we would like to have the implementation be somewhat generic. That is, the number of levels and the number of tree nodes at each levels is determined at runtime.</p>
<p>An example of a generic tree implementation for Silverlight can be found on Justin Angel&#39;s blog at <br />(<a href="http://blogs.silverlight.net/blogs/justinangel/archive/2008/11/18/silverlight-toolkit-treeview-treeviewitem-amp-hierarchaldatatemplate.aspx">http://blogs.silverlight.net/blogs/justinangel/archive/2008/11/18/silverlight-toolkit-treeview-treeviewitem-amp-hierarchaldatatemplate.aspx</a>). It is a rather long article but about midway he describes a simple treecontrol that uses the XAML &quot;HierarchicalDataTemplate&quot; and he binds the tree to a list (at page load) that populates the tree control - it works nicely. Has anyone done a similar implementation using SL/MVVM with Csla? </p>
<p>We tried populating a hierarchical structure with BusinessListBase -&gt; BusinessBase and enabled the tree control to bind to the Model but it only displays the first level of the tree. Any property of the first level can be bound and displayed but we couldn&#39;t get the second level to display even though we can verify that the root object does have populated children/grandchildren nodes.</p>
<p>Larry</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Wednesday, March 10, 2010</h2><p>CSLA supports a tree structure where a node can have a list of other nodes:</p>
<p>node -&gt; nodelist -&gt; node(s)</p>
<p>I haven&#39;t looked into this myself, but does the treeview want a list of lists structure:</p>
<p>list -&gt; list -&gt; list</p>
<p>where every node is a node <em>and</em>&nbsp;<em>is a list</em>? </p>
<p>If so, you&#39;d need to use viewmodel concepts to reshape the object model, merging each BusinessBase and its associated BusinessListBase into a single object.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>skagen00 replied on Thursday, March 11, 2010</h2><p>I actually just finished with some work in this kind of area where I had an arbitrarily depthed tree of objects - but objects where I wanted to show multiple columns of data for (formatted amounts, etc).</p>
<p>So a tree view just didn&#39;t look like the best option for me. </p>
<p>I ended up populating the business object in a manner such that I loaded it in the proper &quot;hierarchical order&quot; and then exposed a method that would run through an efficient algorithm (on the client side) to establish non-serialized references between items in the list - one pointing to the parent and one a collection of the item&#39;s children - it also established a non-serialized depth property.</p>
<p>Then, I bound the list to a grid, and used a converter to bind the margin of the first column (which contained an expand/collapse sort of button)&nbsp;to a multiple of the depth. Since I had a handle on children of each item, it was easy to respond to the expand/contract to hide/show the appropriate items in the view for the grid.</p>
<p>I am guessing that this as far as you&#39;re taking your treeview but I figured searches looking to do this sort of thing will stumble upon this post so I figured I&#39;d share.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Larry replied on Friday, March 12, 2010</h2><p>Thanks Rocky and Skagen00 for your replies. </p>
<p>After a fair amount of investigation we were able to get the treeview control to work the way we hoped. It is handling trees with arbitrary depths as skagen00 mentioned and as described in Justin Angel&#39;s article. Although we are using a small bit of code behind in addition to the viewmodel, we hope to eventually be able to refactor that out. </p>
<p>We needed to the small bit of code behind to handle sending several commands to the VM, and navigation to another page - the things I&nbsp; know you are working on Rocky. The business object(s) structure that is working has a root TreeNodelist(BusinessListBase) with sub TreeNode(BusinessBase). Each TreeNode Business Object has a TreeNodeList property to extend the sub levels of the hierarchical tree. </p>
<p><br />By next week a colleague will post more details to share.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>Ranjini replied on Friday, March 12, 2010</h2><p class="MsoNormal"><span style="font-family:Calibri;font-size:small;">I work with Larry and after much persistence and playing around with the MVVM Test Project (thanks to Rocky), we found a way to make it work for us conforming for the most part to the CSLA + MVVM structure. Our layout required that the tree be loaded on a button click event and since there was also the need to navigate a frame within the user control to a different page on the same click event, we had to make use of some code behind. </span></p>
<p class="MsoNormal"><span style="font-family:Calibri;font-size:small;">There were 2 key parts to this. The first part was trying to figure out what hierarchical structure was acceptable to the tree control and Justin Angel&rsquo;s blog (</span><a href="http://blogs.silverlight.net/blogs/justinangel/archive/2008/11/18/silverlight-toolkit-treeview-treeviewitem-amp-hierarchaldatatemplate.aspx"><span style="line-height:115%;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;font-size:9pt;">http://blogs.silverlight.net/blogs/justinangel/archive/2008/11/18/silverlight-toolkit-treeview-treeviewitem-amp-hierarchaldatatemplate.aspx</span></a><span style="line-height:115%;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;font-size:9pt;">) </span><span style="font-family:Calibri;font-size:small;">helped us there.<span style="mso-spacerun:yes;">&nbsp; </span>The second was to figure out the binding associated with the control itself and the hierarchical data template. Following is the XAML snippet we ended up with eventually. </span><span style="line-height:115%;font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;">TreeListViewModel </span><span style="font-family:Calibri;font-size:small;">is the view model object we are using to bind the treeview.</span></p>
<p class="MsoNormal"><span style="font-family:Calibri;font-size:small;">XAML Code:</span></p>
<p class="MsoNormal"><span style="mso-tab-count:1;"><span style="font-family:Calibri;font-size:small;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">UserControl.Resources</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;"></span><span style="mso-tab-count:1;"><span style="font-family:Calibri;font-size:small;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">this</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TreeListViewModel</span><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"> <span style="color:red;">x</span><span style="color:blue;">:</span><span style="color:red;">Key</span><span style="color:blue;">=&quot;</span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:12pt;mso-no-proof:yes;mso-bidi-font-size:10.0pt;">TreeListModel</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&quot; /&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">common</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">HierarchicalDataTemplate</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> x</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;">Key</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:12pt;mso-no-proof:yes;mso-bidi-font-size:10.0pt;">TreeTemplate</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&quot;</span><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"> <span style="color:red;"><span style="mso-spacerun:yes;">&nbsp;</span>ItemsSource</span><span style="color:blue;">=&quot;{</span><span style="color:#a31515;">Binding</span><span style="color:red;"> Path</span><span style="color:blue;">=</span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:12pt;mso-no-proof:yes;mso-bidi-font-size:10.0pt;">TreeNodeList</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot;&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">StackPanel</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Orientation</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;Horizontal&quot;&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TextBlock</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Text</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;{</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">Binding</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Name</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot; /&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;/</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">StackPanel</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;/</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">common</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">HierarchicalDataTemplate</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp; </span><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;/</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">UserControl.Resources</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;"><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">controls</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TreeView</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> x</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;">Name</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;treeViewCtrl&quot;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:red;">DataContext</span><span style="color:blue;">=&quot;{</span><span style="color:#a31515;">StaticResource</span><span style="color:red;"> </span></span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:12pt;mso-no-proof:yes;mso-bidi-font-size:10.0pt;">TreeListModel</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot;</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> ItemsSource</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;{</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">Binding</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Path</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:12pt;mso-no-proof:yes;mso-bidi-font-size:10.0pt;">Model</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot;</span><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:red;"></span></span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:red;">ItemTemplate</span><span style="color:blue;">=&quot;{</span><span style="color:#a31515;">StaticResource</span><span style="color:red;"> </span></span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:12pt;mso-no-proof:yes;mso-bidi-font-size:10.0pt;">TreeTemplate</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot;</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> </span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">/&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span><span style="font-family:Calibri;font-size:small;">At run time, here is the TreeListModel Structure. This should give a good idea about the binding BO. The Model itself is of type </span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TreeNodeList</span><span style="font-family:Calibri;font-size:small;"> (BLB) which contains children </span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TreeNodes</span><span style="font-family:Calibri;font-size:small;"> (BB) which in turn contains Name property, Level Property, SearchExpression Property and children </span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TreeNodeLists</span><span style="font-family:Calibri;font-size:small;">. </span></p>
<p class="MsoNormal"><span style="mso-no-proof:yes;"></span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;"><a href="http://forums.lhotka.net/cfs-file.ashx/__key/CommunityServer.Components.UserFiles/00.00.01.04.18/TreeViewModel_4000_RunTime.png"><img src="http://forums.lhotka.net/resized-image.ashx/__size/550x295/__key/CommunityServer.Components.UserFiles/00.00.01.04.18/TreeViewModel_4000_RunTime.png" border="0" alt="" /></a>&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:Calibri;font-size:small;">I can definitely see how this can be confusing but after much trial and error this worked. I am also attaching all the objects and code associated with buiding the tree to this post along with a snapshot of the TreeListModel structure at runtime (so you can see how the hierarchical data is organized). Hope it helps someone and saves them some aggravation!</span></p>
<p class="MsoNormal"><span style="font-family:Calibri;font-size:small;">&nbsp;</span><span style="font-family:Calibri;font-size:small;">Thanks</span></p>
<p class="MsoNormal"><span style="font-family:Calibri;font-size:small;">Ranjini</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;"><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;"><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ranjini replied on Friday, March 12, 2010</h2><p class="MsoNormal"><span style="font-family:Calibri;font-size:small;">I work with Larry and after much persistence and playing around with the MVVM Test Project (thanks to Rocky), we found a way to make it work for us conforming for the most part to the CSLA + MVVM structure. Our layout required that the tree be loaded on a button click event and since there was also the need to navigate a frame within the user control to a different page on the same click event, we had to make use of some code behind. </span></p>
<p class="MsoNormal"><span style="font-family:Calibri;font-size:small;">There were 2 key parts to this. The first part was trying to figure out what hierarchical structure was acceptable to the tree control and Justin Angel&rsquo;s blog (</span><a href="http://blogs.silverlight.net/blogs/justinangel/archive/2008/11/18/silverlight-toolkit-treeview-treeviewitem-amp-hierarchaldatatemplate.aspx"><span style="line-height:115%;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;font-size:9pt;">http://blogs.silverlight.net/blogs/justinangel/archive/2008/11/18/silverlight-toolkit-treeview-treeviewitem-amp-hierarchaldatatemplate.aspx</span></a><span style="line-height:115%;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;font-size:9pt;">) </span><span style="font-family:Calibri;font-size:small;">helped us there.<span style="mso-spacerun:yes;">&nbsp; </span>The second was to figure out the binding associated with the control itself and the hierarchical data template. Following is the XAML snippet we ended up with eventually. </span><span style="line-height:115%;font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;">TreeListViewModel </span><span style="font-family:Calibri;font-size:small;">is the view model object we are using to bind the treeview.</span></p>
<p class="MsoNormal"><span style="font-family:Calibri;font-size:small;">XAML Code:</span></p>
<p class="MsoNormal"><span style="mso-tab-count:1;"><span style="font-family:Calibri;font-size:small;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">UserControl.Resources</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;"></span><span style="mso-tab-count:1;"><span style="font-family:Calibri;font-size:small;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">this</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TreeListViewModel</span><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"> <span style="color:red;">x</span><span style="color:blue;">:</span><span style="color:red;">Key</span><span style="color:blue;">=&quot;</span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:12pt;mso-no-proof:yes;mso-bidi-font-size:10.0pt;">TreeListModel</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&quot; /&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">common</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">HierarchicalDataTemplate</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> x</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;">Key</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:12pt;mso-no-proof:yes;mso-bidi-font-size:10.0pt;">TreeTemplate</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&quot;</span><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"> <span style="color:red;"><span style="mso-spacerun:yes;">&nbsp;</span>ItemsSource</span><span style="color:blue;">=&quot;{</span><span style="color:#a31515;">Binding</span><span style="color:red;"> Path</span><span style="color:blue;">=</span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:12pt;mso-no-proof:yes;mso-bidi-font-size:10.0pt;">TreeNodeList</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot;&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">StackPanel</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Orientation</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;Horizontal&quot;&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TextBlock</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Text</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;{</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">Binding</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Name</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot; /&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;/</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">StackPanel</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;/</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">common</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">HierarchicalDataTemplate</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp; </span><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;/</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">UserControl.Resources</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;"><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">controls</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TreeView</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> x</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;">Name</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;treeViewCtrl&quot;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:red;">DataContext</span><span style="color:blue;">=&quot;{</span><span style="color:#a31515;">StaticResource</span><span style="color:red;"> </span></span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:12pt;mso-no-proof:yes;mso-bidi-font-size:10.0pt;">TreeListModel</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot;</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> ItemsSource</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;{</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">Binding</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Path</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:12pt;mso-no-proof:yes;mso-bidi-font-size:10.0pt;">Model</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot;</span><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:red;"></span></span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:red;">ItemTemplate</span><span style="color:blue;">=&quot;{</span><span style="color:#a31515;">StaticResource</span><span style="color:red;"> </span></span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:12pt;mso-no-proof:yes;mso-bidi-font-size:10.0pt;">TreeTemplate</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot;</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> </span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">/&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span><span style="font-family:Calibri;font-size:small;">At run time, here is the TreeListModel Structure. This should give a good idea about the binding BO. The Model itself is of type </span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TreeNodeList</span><span style="font-family:Calibri;font-size:small;"> (BLB) which contains children </span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TreeNodes</span><span style="font-family:Calibri;font-size:small;"> (BB) which in turn contains Name property, Level Property, SearchExpression Property and children </span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TreeNodeLists</span><span style="font-family:Calibri;font-size:small;">. </span></p>
<p class="MsoNormal"><span style="mso-no-proof:yes;"></span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;"><a href="http://forums.lhotka.net/cfs-file.ashx/__key/CommunityServer.Components.UserFiles/00.00.01.04.18/TreeViewModel_4000_RunTime.png"><img src="http://forums.lhotka.net/resized-image.ashx/__size/550x295/__key/CommunityServer.Components.UserFiles/00.00.01.04.18/TreeViewModel_4000_RunTime.png" border="0" alt="" /></a>&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:Calibri;font-size:small;">I can definitely see how this can be confusing but after much trial and error this worked. I am also attaching all the objects and code associated with buiding the tree to this post along with a snapshot of the TreeListModel structure at runtime (so you can see how the hierarchical data is organized). Hope it helps someone and saves them some aggravation!</span></p>
<p class="MsoNormal"><span style="font-family:Calibri;font-size:small;">&nbsp;</span><span style="font-family:Calibri;font-size:small;">Thanks</span></p>
<p class="MsoNormal"><span style="font-family:Calibri;font-size:small;">Ranjini</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;"><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;"><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>Ranjini replied on Friday, March 12, 2010</h2><p class="MsoNormal"><span style="font-family:Calibri;font-size:small;">I work with Larry and after much persistence and playing around with the MVVM Test Project (thanks to Rocky), we found a way to make it work for us conforming for the most part to the CSLA + MVVM structure. Our layout required that the tree be loaded on a button click event and since there was also the need to navigate a frame within the user control to a different page on the same click event, we had to make use of some code behind. </span></p>
<p class="MsoNormal"><span style="font-family:Calibri;font-size:small;">There were 2 key parts to this. The first part was trying to figure out what hierarchical structure was acceptable to the tree control and Justin Angel&rsquo;s blog (</span><a href="http://blogs.silverlight.net/blogs/justinangel/archive/2008/11/18/silverlight-toolkit-treeview-treeviewitem-amp-hierarchaldatatemplate.aspx"><span style="line-height:115%;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;font-size:9pt;">http://blogs.silverlight.net/blogs/justinangel/archive/2008/11/18/silverlight-toolkit-treeview-treeviewitem-amp-hierarchaldatatemplate.aspx</span></a><span style="line-height:115%;font-family:&#39;Arial&#39;,&#39;sans-serif&#39;;color:#333333;font-size:9pt;">) </span><span style="font-family:Calibri;font-size:small;">helped us there.<span style="mso-spacerun:yes;">&nbsp; </span>The second was to figure out the binding associated with the control itself and the hierarchical data template. Following is the XAML snippet we ended up with eventually. </span><span style="line-height:115%;font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;">TreeListViewModel </span><span style="font-family:Calibri;font-size:small;">is the view model object we are using to bind the treeview.</span></p>
<p class="MsoNormal"><span style="font-family:Calibri;font-size:small;">XAML Code:</span></p>
<p class="MsoNormal"><span style="mso-tab-count:1;"><span style="font-family:Calibri;font-size:small;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">UserControl.Resources</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;"></span><span style="mso-tab-count:1;"><span style="font-family:Calibri;font-size:small;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">this</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TreeListViewModel</span><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"> <span style="color:red;">x</span><span style="color:blue;">:</span><span style="color:red;">Key</span><span style="color:blue;">=&quot;</span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:12pt;mso-no-proof:yes;mso-bidi-font-size:10.0pt;">TreeListModel</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&quot; /&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">common</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">HierarchicalDataTemplate</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> x</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;">Key</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:12pt;mso-no-proof:yes;mso-bidi-font-size:10.0pt;">TreeTemplate</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&quot;</span><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"> <span style="color:red;"><span style="mso-spacerun:yes;">&nbsp;</span>ItemsSource</span><span style="color:blue;">=&quot;{</span><span style="color:#a31515;">Binding</span><span style="color:red;"> Path</span><span style="color:blue;">=</span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:12pt;mso-no-proof:yes;mso-bidi-font-size:10.0pt;">TreeNodeList</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot;&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">StackPanel</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Orientation</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;Horizontal&quot;&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:2;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TextBlock</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Text</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;{</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">Binding</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Name</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot; /&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;/</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">StackPanel</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;/</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">common</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">HierarchicalDataTemplate</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp; </span><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp; </span></span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&lt;/</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">UserControl.Resources</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;"><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt;</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">controls</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TreeView</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> x</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">:</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;">Name</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;treeViewCtrl&quot;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:red;">DataContext</span><span style="color:blue;">=&quot;{</span><span style="color:#a31515;">StaticResource</span><span style="color:red;"> </span></span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:12pt;mso-no-proof:yes;mso-bidi-font-size:10.0pt;">TreeListModel</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot;</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> ItemsSource</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=&quot;{</span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">Binding</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> Path</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">=</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:12pt;mso-no-proof:yes;mso-bidi-font-size:10.0pt;">Model</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot;</span><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:red;"></span></span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;font-size:10pt;mso-no-proof:yes;"><span style="mso-spacerun:yes;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:red;">ItemTemplate</span><span style="color:blue;">=&quot;{</span><span style="color:#a31515;">StaticResource</span><span style="color:red;"> </span></span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:12pt;mso-no-proof:yes;mso-bidi-font-size:10.0pt;">TreeTemplate</span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">}&quot;</span><span style="font-family:&#39;Courier New&#39;;color:red;font-size:10pt;mso-no-proof:yes;"> </span><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">/&gt;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span><span style="font-family:Calibri;font-size:small;">At run time, here is the TreeListModel Structure. This should give a good idea about the binding BO. The Model itself is of type </span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TreeNodeList</span><span style="font-family:Calibri;font-size:small;"> (BLB) which contains children </span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TreeNodes</span><span style="font-family:Calibri;font-size:small;"> (BB) which in turn contains Name property, Level Property, SearchExpression Property and children </span><span style="font-family:&#39;Courier New&#39;;color:#a31515;font-size:10pt;mso-no-proof:yes;">TreeNodeLists</span><span style="font-family:Calibri;font-size:small;">. </span></p>
<p class="MsoNormal"><span style="mso-no-proof:yes;"></span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;"><a href="http://forums.lhotka.net/cfs-file.ashx/__key/CommunityServer.Components.UserFiles/00.00.01.04.18/TreeViewModel_4000_RunTime.png"><img src="http://forums.lhotka.net/resized-image.ashx/__size/550x295/__key/CommunityServer.Components.UserFiles/00.00.01.04.18/TreeViewModel_4000_RunTime.png" border="0" alt="" /></a>&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:Calibri;font-size:small;">I can definitely see how this can be confusing but after much trial and error this worked. I am also attaching all the objects and code associated with buiding the tree to this post along with a snapshot of the TreeListModel structure at runtime (so you can see how the hierarchical data is organized). Hope it helps someone and saves them some aggravation!</span></p>
<p class="MsoNormal"><span style="font-family:Calibri;font-size:small;">&nbsp;</span><span style="font-family:Calibri;font-size:small;">Thanks</span></p>
<p class="MsoNormal"><span style="font-family:Calibri;font-size:small;">Ranjini</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;"><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;">&nbsp;</span></p>
<p class="MsoNormal"><span style="font-family:&#39;Courier New&#39;;color:blue;font-size:10pt;mso-no-proof:yes;"><span style="mso-tab-count:1;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>simon replied on Monday, May 30, 2011</h2><p>I go through the codes, it&#39;s a switchable objects! &nbsp;Why did you split it four class?</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
