<html><header><title>Required list</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Required list</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/6964.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>MTmace posted on Monday, May 18, 2009</h2><P>I have a list that is a property of my root class. I would like to make sure that at least one item exists in the list before it is saved. So I added this rule</P><FONT size=2>
<P></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>public</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>static</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>bool</FONT></FONT><FONT size=2> ListRequired(</FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>object</FONT></FONT><FONT size=2> target, Csla.Validation.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>RuleArgs</FONT></FONT><FONT size=2> e)<BR>{<BR></FONT><FONT size=2>System.Collections.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>IList</FONT></FONT><FONT size=2> value = (System.Collections.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>IList</FONT></FONT><FONT size=2>)Csla.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>Utilities</FONT></FONT><FONT size=2>.CallByName(target, e.PropertyName, Csla.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>CallType</FONT></FONT><FONT size=2>.Get);<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>if</FONT></FONT><FONT size=2> (value == </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>null</FONT></FONT><FONT size=2> || value.Count == 0)<BR>{<BR>e.Description = </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>string</FONT></FONT><FONT size=2>.Format(</FONT><FONT color=#a31515 size=2><FONT color=#a31515 size=2>"{0} required"</FONT></FONT><FONT size=2>, Csla.Validation.</FONT><FONT color=#2b91af size=2><FONT color=#2b91af size=2>RuleArgs</FONT></FONT><FONT size=2>.GetPropertyName(e));<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>return</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>false</FONT></FONT><FONT size=2>;<BR>}<BR></FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>return</FONT></FONT><FONT size=2> </FONT><FONT color=#0000ff size=2><FONT color=#0000ff size=2>true</FONT></FONT><FONT size=2>;<BR>}<BR><BR>But my root object is still invalid when I add a record to the object.</FONT></P>
<P><FONT size=2>How can I validate the collection when a item has been added to it?</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Monday, May 18, 2009</h2><P>Your parent object needs to handle the collection's ListChanged event and in that event handler call ValidationRules.CheckRules("ChildCollectionPropertyName")</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>OscarLauroba replied on Monday, February 08, 2010</h2><p>Hello Rocky:</p>
<p>Where is the best place to add the addhandler for the ListChanged event if the collection is &quot;lazy loaded&quot; in the parent object?</p>
<p>Thank you very much.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>xAvailx replied on Monday, February 08, 2010</h2><p>One option is to override in your root class the ChildChanged event and then call the appropriate validation rule. The args will give you what object was changed.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>OscarLauroba replied on Tuesday, February 09, 2010</h2><p>That&#39;s a good option.</p>
<p>Thank you very much.</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>OscarLauroba replied on Wednesday, February 10, 2010</h2><p>The last step is to notify&nbsp;the &quot;list required&quot; message to the user. I&#39;ve set a propertyStatus binded to my child property collection. The problem is that propertyStatus does not show the error message. The child property collection is defined as readonly because it&#39;s only a reference to an editable list. so this property doesn&#39;t have a propertychanged. How can I get propertyStatus to show the error message?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>OscarLauroba replied on Wednesday, February 10, 2010</h2><p>It seems that if I call PropertyHasChanged(ChildCollectionProperty.Name) instead of Validation.CheckRules(ChildCollectionProperty) in the ChildChanged event the propertyStatus does show the error message. Is this the way to accomplish this?</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>ajj3085 replied on Wednesday, February 10, 2010</h2><p>Well, ValidationRules.CheckRules runs the rule check; but for the UI to know a property has changed (and thus, to query whether or not an error indicator is needed), it must receive a PropertyChanged event for the relevent property.&nbsp; The two are related in that ValidationRules.CheckRules will update the broken rules collection, which is what will supply the information about errors to the UI when asked.</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
