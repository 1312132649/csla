<html><header><title>Design Question</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Design Question</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/5021.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>selim51 posted on Thursday, June 26, 2008</h2><P>Hello!</P>
<P>I need some help choosing the right pattern for my business object.</P>
<P>There is a general parent which is divided into three specialized parents, and there is a general child which is divided into three specialized children, too. The <FONT face="Courier New" size=2>ChildA</FONT> should be associated only with its <FONT face="Courier New" size=2>ParentA</FONT>, and&nbsp;<FONT face="Courier New" size=2>ChildB</FONT>&nbsp;with <FONT face="Courier New" size=2>ParentB<FONT face="Times New Roman" size=3>, and so on</FONT></FONT>.</P>
<P>For now I have this:</P><FONT color=#0000ff>
<P><FONT face="Courier New" size=2>public</FONT></FONT><FONT size=2><FONT face="Courier New"> <FONT color=#0000ff>abstract</FONT> <FONT color=#0000ff>class</FONT> <FONT color=#2b91af>Parent</FONT> : <FONT color=#2b91af>BusinessBase</FONT>&lt;<FONT color=#2b91af>Parent</FONT></FONT><FONT face="Courier New">&gt;<BR></FONT></FONT><FONT face="Courier New" size=2>{<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008000><FONT face="Courier New" size=2>// general properties<BR><FONT color=#0000ff size=2>&nbsp;&nbsp;&nbsp; public</FONT><FONT color=#000000 size=2> </FONT><FONT color=#2b91af size=2>Childs</FONT><FONT size=2><FONT color=#000000> Childs;</FONT></FONT><BR></FONT></FONT><FONT face="Courier New" size=2>}<BR><BR></FONT><FONT color=#0000ff><FONT face="Courier New" size=2>public</FONT></FONT><FONT face="Courier New"><FONT size=2> <FONT color=#0000ff>class</FONT> <FONT color=#2b91af>ParentA</FONT> : <FONT color=#2b91af>Parent<BR></FONT></FONT></FONT><FONT face="Courier New" size=2>{<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008000><FONT face="Courier New" size=2>// special properties for ParentA<BR></FONT></FONT><FONT face="Courier New" size=2>}<BR><BR></FONT><FONT color=#0000ff><FONT face="Courier New" size=2>public</FONT></FONT><FONT face="Courier New"><FONT size=2> <FONT color=#0000ff>class</FONT> <FONT color=#2b91af>ParentB</FONT> : <FONT color=#2b91af>Parent<BR></FONT></FONT></FONT><FONT face="Courier New" size=2>{<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008000><FONT face="Courier New" size=2>// special properties for ParentB<BR></FONT></FONT><FONT face="Courier New" size=2>}<BR><BR></FONT><FONT color=#0000ff><FONT face="Courier New" size=2>public</FONT></FONT><FONT size=2><FONT face="Courier New"> <FONT color=#0000ff>abstract</FONT> <FONT color=#0000ff>class</FONT> <FONT color=#2b91af>Child</FONT> : <FONT color=#2b91af>BusinessBase</FONT>&lt;<FONT color=#2b91af>Child</FONT></FONT><FONT face="Courier New">&gt;<BR></FONT></FONT><FONT face="Courier New" size=2>{<BR></FONT><FONT color=#008000><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; // general properties<BR></FONT></FONT><FONT face="Courier New" size=2>}<BR><BR></FONT><FONT color=#0000ff><FONT face="Courier New" size=2>public</FONT></FONT><FONT face="Courier New"><FONT size=2> <FONT color=#0000ff>class</FONT> <FONT color=#2b91af>ChildA</FONT> : <FONT color=#2b91af>Child<BR></FONT></FONT></FONT><FONT face="Courier New" size=2>{<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008000><FONT face="Courier New" size=2>// special properties for ChildA<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>internal</FONT> <FONT color=#0000ff>static</FONT> <FONT color=#2b91af>ChildA</FONT></FONT><FONT face="Courier New"> NewChildA()<BR></FONT></FONT><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>return</FONT> <FONT color=#0000ff>new</FONT> <FONT color=#2b91af>ChildA</FONT></FONT><FONT face="Courier New">();<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT face="Courier New" size=2>}<BR></FONT><FONT face="Courier New" size=2>}<BR><BR></FONT><FONT color=#0000ff><FONT face="Courier New" size=2>public</FONT></FONT><FONT face="Courier New"><FONT size=2> <FONT color=#0000ff>class</FONT> <FONT color=#2b91af>ChildB</FONT> : <FONT color=#2b91af>Child<BR></FONT></FONT></FONT><FONT face="Courier New" size=2>{<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008000><FONT face="Courier New" size=2>// special properties for ChildB<BR></FONT></FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>&nbsp;&nbsp;&nbsp; internal</FONT> <FONT color=#0000ff>static</FONT> <FONT color=#2b91af>ChildB</FONT></FONT><FONT face="Courier New"> NewChildB()<BR></FONT></FONT><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; {<BR></FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return</FONT> <FONT color=#0000ff>new</FONT> <FONT color=#2b91af>ChildB</FONT></FONT><FONT face="Courier New">();<BR></FONT></FONT><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; }<BR></FONT><FONT face="Courier New" size=2>}<BR><BR></FONT><FONT color=#0000ff><FONT face="Courier New" size=2>public</FONT></FONT><FONT size=2><FONT face="Courier New"> <FONT color=#0000ff>abstract</FONT> <FONT color=#0000ff>class</FONT> <FONT color=#2b91af>Childs</FONT> : <FONT color=#2b91af>BusinessListBase</FONT>&lt;<FONT color=#2b91af>Childs</FONT>, <FONT color=#2b91af>Child</FONT></FONT><FONT face="Courier New">&gt;<BR></FONT></FONT><FONT face="Courier New" size=2>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>abstract</FONT> <FONT color=#0000ff>public</FONT> <FONT color=#2b91af>Child</FONT></FONT><FONT face="Courier New"> AddNewChild();<BR></FONT></FONT><FONT face="Courier New" size=2>}<BR><BR></FONT><FONT color=#0000ff><FONT face="Courier New" size=2>public</FONT></FONT><FONT face="Courier New"><FONT size=2> <FONT color=#0000ff>class</FONT> <FONT color=#2b91af>ChildsA</FONT> : <FONT color=#2b91af>Childs<BR></FONT></FONT></FONT><FONT face="Courier New" size=2>{<BR></FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>&nbsp;&nbsp;&nbsp; public</FONT> <FONT color=#0000ff>override</FONT> <FONT color=#2b91af>Child</FONT></FONT><FONT face="Courier New"> AddNewChild()<BR></FONT></FONT><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; {<BR></FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var</FONT> childA = <FONT color=#2b91af>ChildA</FONT></FONT><FONT face="Courier New">.NewChildA();<BR></FONT></FONT><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add(childA);<BR></FONT><FONT size=2><FONT face="Courier New" color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return</FONT><FONT face="Courier New"> childA;<BR></FONT></FONT><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; }<BR></FONT><FONT face="Courier New" size=2>}<BR><BR></FONT><FONT color=#0000ff><FONT face="Courier New" size=2>public</FONT></FONT><FONT face="Courier New"><FONT size=2> <FONT color=#0000ff>class</FONT> <FONT color=#2b91af>ChildsB</FONT> : <FONT color=#2b91af>Childs<BR></FONT></FONT></FONT><FONT face="Courier New" size=2>{<BR></FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>&nbsp;&nbsp;&nbsp; public</FONT> <FONT color=#0000ff>override</FONT> <FONT color=#2b91af>Child</FONT></FONT><FONT face="Courier New"> AddNewChild()<BR></FONT></FONT><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; {<BR></FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; var</FONT> childB = <FONT color=#2b91af>ChildB</FONT></FONT><FONT face="Courier New">.NewChildB();<BR></FONT></FONT><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Add(childB);<BR></FONT><FONT size=2><FONT face="Courier New" color=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return</FONT><FONT face="Courier New"> childB;<BR></FONT></FONT><FONT face="Courier New" size=2>&nbsp;&nbsp;&nbsp; }<BR></FONT><FONT face="Courier New" size=2>}</FONT></P>
<P>I don't like the fact to have an abstract child collection and a concrete child collection for each concrete child object. Is that the "right" way? Or is there another nicer solution?&nbsp;Am&nbsp;I right, that I would have to do some if&nbsp;or switch checks, when I use one child collection only (without abstract concrete collections)?</P>
<P>Yavuz</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>vdhant replied on Friday, June 27, 2008</h2>Hi Yavuz<br />I can see the problem that you are talking about and it is a common issue.<br /><br />the best way that i have found to solve this issue is by using IoC (Inversion of Control pattern). Basically this says that in your case you would create the instance objects in the abstract class. The problem is though and the reason why you haven't done it this way in the first place is that the abstract class doesn't know what instance type to create. <br /><br />IoC deals with this very problem and defers this decision via a level of abstraction. If you have a look at this article http://msdn.microsoft.com/en-us/magazine/cc337885.aspx it is a really really really good article on this very issue. The IoC part is towards the end but make sure your read through as it builds up to this point. <br /><br />In your case to achieve what you are after i would say that you would use generics on the base class. <br /><br />public abstract class Childs[T] : BusinessListBase<br />    where T : Child<br />{<br />   public Child AddNewChild()<br />   {<br />        var child = new T();<br />        Add(child);<br />        return child;<br />   }<br />}<br /><br />public class ChildsA : Childs[ChildB]<br />{ <br />}<br /><br />public class ChildsB : Childs[ChildB]<br />{<br />}<br /><br />Hope this helps.<br />Anthony <br /><br />PLEASE NOTE -- I have used square brackets because my browser is having issues with diamond brackets <br /></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>selim51 replied on Sunday, June 29, 2008</h2><P>Hi Anthony!</P>
<P>Thank you for your answer. I can see that now <FONT face="Courier New" size=2>AddNewChild()</FONT> is implemented in the base collection class. However&nbsp;I have to implement one empty concrete collection class per&nbsp;concrete child classes. I was looking for an solution where I have <STRONG>only one non-abstract collection class</STRONG> which can handle each concrete child class. I have achieved that with a&nbsp;different generic collection class (see code below), so&nbsp;I can do this:</P><FONT size=2>
<P></FONT><FONT face="Courier New"><FONT color=#2b91af size=2>ParentA</FONT><FONT size=2> parentA = </FONT><FONT color=#2b91af size=2>ParentA</FONT></FONT><FONT face="Courier New"><FONT size=2>.NewParentA();<BR></FONT><FONT color=#2b91af size=2>ChildA</FONT></FONT><FONT face="Courier New"><FONT size=2> childA1 = parentA.Childs.AddNewChild();<BR></FONT><FONT color=#2b91af size=2>Child</FONT></FONT><FONT face="Courier New"><FONT size=2> childA2 = parentA.Childs.AddNewChild();<BR><BR></FONT><FONT color=#2b91af size=2>ParentB</FONT><FONT size=2> parentB = </FONT><FONT color=#2b91af size=2>ParentB</FONT></FONT><FONT face="Courier New"><FONT size=2>.NewParentB();<BR></FONT><FONT color=#2b91af size=2>ChildB</FONT></FONT><FONT face="Courier New"><FONT size=2> childB1 = parentB.Childs.AddNewChild();<BR></FONT><FONT color=#2b91af size=2>Child</FONT><FONT size=2> childB2 = parentB.Childs.AddNewChild();</P></FONT></FONT>
<P>Each concrete parent class's child collection member (<FONT face="Courier New" size=2>Childs</FONT>) is of type <FONT face="Courier New" size=2>Childs&lt;ConceteChild&gt;</FONT>. Adding a new child to the collection returns the right concrete child object. While implementing the child collection member in each of the concrete classes, I can't do this:</P><FONT size=2>
<P></FONT><FONT face="Courier New"><FONT color=#2b91af size=2>Parent</FONT><FONT size=2> parentA = </FONT><FONT color=#2b91af size=2>ParentA</FONT></FONT><FONT face="Courier New"><FONT size=2>.NewParentA();<BR></FONT><FONT color=#2b91af size=2>ChildA</FONT><FONT size=2> childA1 = parentA.Childs.AddNewChild(); </FONT></FONT><FONT face="Courier New"><FONT color=#008000 size=2>// does not work<BR></FONT><FONT color=#2b91af size=2>Child</FONT><FONT size=2> childA2 = parentA.Childs.AddNewChild();&nbsp; </FONT><FONT color=#008000 size=2>// does not work</P></FONT></FONT>
<P>This is my solution so far:</P>
<P><FONT face="Courier New"><FONT size=2><FONT color=#0000ff>public</FONT> <FONT color=#0000ff>abstract</FONT> <FONT color=#0000ff>class</FONT> <FONT color=#2b91af>Parent</FONT> : <FONT color=#2b91af>BusinessBase</FONT>&lt;<FONT color=#2b91af>Parent</FONT></FONT></FONT><FONT face="Courier New" size=2>&gt;<BR>{<BR></FONT><FONT face="Courier New"><FONT size=2><FONT color=#008000>&nbsp;&nbsp;&nbsp; // general Parent properties<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff>protected</FONT></FONT></FONT><FONT face="Courier New" size=2> Parent() {}<BR>}<BR><BR><FONT color=#0000ff>public</FONT> <FONT color=#0000ff>class</FONT> <FONT color=#2b91af>ParentA</FONT> : </FONT><FONT face="Courier New" color=#2b91af size=2>Parent<BR></FONT><FONT face="Courier New" size=2>{<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT face="Courier New"><FONT size=2><FONT color=#008000>// special ParentA properties<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff>private</FONT> <FONT color=#2b91af>Childs</FONT>&lt;<FONT color=#2b91af>ChildA</FONT>&gt; _childs = <FONT color=#0000ff>new</FONT> <FONT color=#2b91af>Childs</FONT>&lt;<FONT color=#2b91af>ChildA</FONT></FONT></FONT><FONT face="Courier New"><FONT size=2>&gt;();<BR>&nbsp;&nbsp;&nbsp; <FONT color=#0000ff>public</FONT> <FONT color=#2b91af>Childs</FONT>&lt;<FONT color=#2b91af>ChildA</FONT></FONT></FONT><FONT face="Courier New"><FONT size=2>&gt; Childs&nbsp;{ <FONT color=#0000ff>get </FONT>{ <FONT color=#0000ff>return</FONT></FONT></FONT><FONT face="Courier New"><FONT size=2> _childs; } }<BR><BR>&nbsp;&nbsp;&nbsp; <FONT color=#0000ff>public</FONT> <FONT color=#0000ff>static</FONT> <FONT color=#2b91af>ParentA</FONT></FONT></FONT><FONT face="Courier New"><FONT size=2> NewParentA()<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT color=#0000ff>return</FONT> <FONT color=#2b91af>DataPortal</FONT>.Create&lt;<FONT color=#2b91af>ParentA</FONT></FONT></FONT><FONT face="Courier New"><FONT size=2>&gt;();<BR>&nbsp;&nbsp;&nbsp; }<BR><BR>&nbsp;&nbsp;&nbsp; <FONT color=#0000ff>protected</FONT></FONT></FONT><FONT face="Courier New" size=2> ParentA() {}<BR>}</FONT></P>
<P><FONT face="Courier New"><FONT size=2><FONT color=#0000ff>public</FONT> <FONT color=#0000ff>class</FONT> <FONT color=#2b91af>ParentB</FONT> : <FONT color=#2b91af>Parent<BR></FONT></FONT></FONT><FONT face="Courier New" size=2>{<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008000><FONT face="Courier New" size=2>// special ParentB properties<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>private</FONT> <FONT color=#2b91af>Childs</FONT>&lt;<FONT color=#2b91af>ChildB</FONT>&gt; _childs = <FONT color=#0000ff>new</FONT> <FONT color=#2b91af>Childs</FONT>&lt;<FONT color=#2b91af>ChildB</FONT></FONT><FONT face="Courier New">&gt;();<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>public</FONT> <FONT color=#2b91af>Childs</FONT>&lt;<FONT color=#2b91af>ChildB</FONT></FONT><FONT face="Courier New">&gt; Childs </FONT></FONT><FONT face="Courier New" size=2>{ </FONT><FONT color=#0000ff><FONT face="Courier New" size=2>get </FONT></FONT><FONT face="Courier New" size=2>{ </FONT><FONT size=2><FONT face="Courier New" color=#0000ff>return</FONT><FONT face="Courier New"> _childs; </FONT></FONT><FONT face="Courier New" size=2>} </FONT><FONT face="Courier New" size=2>}<BR><BR>&nbsp;&nbsp;&nbsp; </FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>public</FONT> <FONT color=#0000ff>static</FONT> <FONT color=#2b91af>ParentB</FONT></FONT><FONT face="Courier New"> NewParentB()<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT face="Courier New" size=2>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>return</FONT> <FONT color=#2b91af>DataPortal</FONT>.Create&lt;<FONT color=#2b91af>ParentB</FONT></FONT><FONT face="Courier New">&gt;();<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT face="Courier New" size=2>}<BR><BR>&nbsp;&nbsp;&nbsp; </FONT><FONT size=2><FONT face="Courier New" color=#0000ff>protected</FONT><FONT face="Courier New"> ParentB() </FONT></FONT><FONT face="Courier New" size=2>{</FONT><FONT face="Courier New" size=2>}<BR></FONT><FONT face="Courier New" size=2>}</FONT></P>
<P><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>public</FONT> <FONT color=#0000ff>abstract</FONT> <FONT color=#0000ff>class</FONT> <FONT color=#2b91af>Child</FONT> : <FONT color=#2b91af>BusinessBase</FONT>&lt;<FONT color=#2b91af>Child</FONT></FONT><FONT face="Courier New">&gt;<BR></FONT></FONT><FONT face="Courier New" size=2>{<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008000><FONT face="Courier New" size=2>// general Child properties<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT size=2><FONT face="Courier New" color=#0000ff>protected</FONT><FONT face="Courier New"> Child() </FONT></FONT><FONT face="Courier New" size=2>{</FONT><FONT face="Courier New" size=2>}<BR></FONT><FONT face="Courier New" size=2>}<BR><BR></FONT><FONT face="Courier New"><FONT size=2><FONT color=#0000ff>public</FONT> <FONT color=#0000ff>abstract</FONT> <FONT color=#0000ff>class</FONT> <FONT color=#2b91af>Child</FONT>&lt;T&gt; : <FONT color=#2b91af>Child<BR></FONT></FONT></FONT><FONT face="Courier New" size=2>{<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>internal</FONT> <FONT color=#0000ff>static</FONT></FONT><FONT face="Courier New"> T NewChild()<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT face="Courier New" size=2>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>return</FONT> <FONT color=#2b91af>DataPortal</FONT></FONT><FONT face="Courier New">.Create&lt;T&gt;();<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT face="Courier New" size=2>}<BR><BR>&nbsp;&nbsp;&nbsp; </FONT><FONT size=2><FONT face="Courier New" color=#0000ff>protected</FONT><FONT face="Courier New"> Child() </FONT></FONT><FONT face="Courier New" size=2>{</FONT><FONT face="Courier New" size=2>}<BR></FONT><FONT face="Courier New" size=2>}<BR><BR></FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>public</FONT> <FONT color=#0000ff>class</FONT> <FONT color=#2b91af>ChildA</FONT> : <FONT color=#2b91af>Child</FONT>&lt;<FONT color=#2b91af>ChildA</FONT></FONT><FONT face="Courier New">&gt;<BR></FONT></FONT><FONT face="Courier New" size=2>{<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008000><FONT face="Courier New" size=2>// special ChildA properties<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT size=2><FONT face="Courier New" color=#0000ff>protected</FONT><FONT face="Courier New"> ChildA() </FONT></FONT><FONT face="Courier New" size=2>{</FONT><FONT face="Courier New" size=2>}<BR></FONT><FONT face="Courier New" size=2>}<BR><BR></FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>public</FONT> <FONT color=#0000ff>class</FONT> <FONT color=#2b91af>ChildB</FONT> : <FONT color=#2b91af>Child</FONT>&lt;<FONT color=#2b91af>ChildB</FONT></FONT><FONT face="Courier New">&gt;<BR></FONT></FONT><FONT face="Courier New" size=2>{<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008000><FONT face="Courier New" size=2>// special ChildB properties<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT size=2><FONT face="Courier New" color=#0000ff>protected</FONT><FONT face="Courier New"> ChildB() </FONT></FONT><FONT face="Courier New" size=2>{</FONT><FONT face="Courier New" size=2>}<BR></FONT><FONT face="Courier New" size=2>}<BR><BR></FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>public</FONT> <FONT color=#0000ff>class</FONT> <FONT color=#2b91af>Childs</FONT>&lt;T&gt; : <FONT color=#2b91af>BusinessListBase</FONT>&lt;<FONT color=#2b91af>Childs</FONT>&lt;T&gt;, <FONT color=#2b91af>Child</FONT>&lt;T&gt;&gt; <FONT color=#0000ff>where</FONT> T : <FONT color=#2b91af>Child</FONT></FONT><FONT face="Courier New">&lt;T&gt;<BR></FONT></FONT><FONT face="Courier New" size=2>{<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT size=2><FONT face="Courier New" color=#0000ff>internal</FONT><FONT face="Courier New"> Childs() </FONT></FONT><FONT face="Courier New" size=2>{</FONT><FONT face="Courier New" size=2>}<BR><BR>&nbsp;&nbsp;&nbsp; </FONT><FONT size=2><FONT face="Courier New" color=#0000ff>public</FONT><FONT face="Courier New"> T AddNewChild()<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT face="Courier New" size=2>{<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size=2><FONT face="Courier New"><FONT color=#0000ff>var</FONT> c = <FONT color=#2b91af>Child</FONT></FONT><FONT face="Courier New">&lt;T&gt;.NewChild();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT face="Courier New" size=2>Add(c);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size=2><FONT face="Courier New" color=#0000ff>return</FONT><FONT face="Courier New"> c;<BR>&nbsp;&nbsp;&nbsp; </FONT></FONT><FONT face="Courier New" size=2>}<BR></FONT><FONT face="Courier New" size=2>}</FONT></P>
<P>I haven't figured out yet how to implement the <FONT face="Courier New" size=2>Childs</FONT> member within the abstract parent class, so&nbsp;it returns the right child object based on the&nbsp;type of the parent.</P>
<P>Yavuz</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>tmg4340 replied on Sunday, June 29, 2008</h2><FONT face=Tahoma size=2><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>selim51:</strong></div><div></FONT><FONT face=Tahoma size=2>I was looking for an solution where I have <STRONG>only one non-abstract collection class</STRONG> which can handle each concrete child class.</FONT>
<P><FONT face=Tahoma size=2>...</FONT></P>
<P><FONT face=Tahoma size=2>I haven't figured out yet how to implement the Childs member within the abstract parent class, so&nbsp;it returns the right child object based on the&nbsp;type of the parent.</FONT><FONT face=Tahoma size=2></div></BLOCKQUOTE></FONT></P>
<P><FONT face=Tahoma size=2>You said in your OP that you didn't like having to create specific parent and child classes to match up your parents and children.&nbsp; Why?&nbsp; What about that bothers you?&nbsp; Because I think it's probably the better option.</FONT></P>
<P><FONT face=Tahoma size=2>In the end, I don't think you're going to get what you want without developing some if/switch code, as you mentioned earlier.&nbsp; While that would certainly give you what you want,&nbsp;I don't think&nbsp;it's a better solution than simply creating concrete parents that return the appropriate concrete children, especially if you have behaviors specific to the concrete subtypes.&nbsp; The code is much simpler to follow, and it keeps you from having to deal with a lot of headaches and casting.&nbsp; The single-parent, single-collection solution is essentially mixing responsibilities, and as your needs change with the parent/child combinations, trying to maintain that within one class only makes it more complex.</FONT></P>
<P><FONT face=Tahoma size=2>If you want to create an IoC container, as Anthony suggests, then by all means, go ahead.&nbsp; But you're still creating a match between a concrete parent type and concrete child type.&nbsp; You're just doing it in your IoC configuration, instead of writing the code yourself.</FONT></P>
<P><FONT face=Tahoma size=2>HTH</FONT></P>
<P><FONT face=Tahoma size=2>- Scott</FONT></P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>selim51 replied on Monday, June 30, 2008</h2><P>Thank You for your&nbsp;arguments Scott!</P>
<P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>tmg4340:</strong></div><div><FONT face=Tahoma size=2>You said in your OP that you didn't like having to create specific parent and child classes to match up your parents and children.</FONT></div></BLOCKQUOTE></P>
<P>Maybe You haven't understood or I haven't clearly expressed myself. I didn't say&nbsp;I don't like having specific parent and child classes. They have to be there because they are my business object. I meant that I dont't like having specific child collection classes, for each specific child class one specific child collection class. Anthony's generic abstract child collection class&nbsp;has reduced implementing&nbsp;<FONT face="Courier New" size=2>AddNewChild()</FONT> to one time in the base class. In my original approach I had to&nbsp;implement it&nbsp;n times in very similar ways (one in each specific child collection class).</P>
<P>I assumed that I will not have specific behaviours for the child collections, so I get rid of the specific child collection classes by turning Anthony's generic abstract child collection class to a generic non-abstract one.</P>
<P>Following the CSLA pattern for creating new business objects through static methods (factories) I had to change my abstract child class to a generic one, too,&nbsp;because <FONT face="Courier New" size=2>T.NewChild()</FONT> does not work. This has the side effect that the concrete children don't need a factory method. As long as the process of creating&nbsp;children in each concrete child is similar this is good.</P>
<P><BLOCKQUOTE><div><img src="/Themes/default/images/icon-quote.gif"> <strong>tmg4340:</strong></div><div>...<FONT face=Tahoma size=2>&nbsp;I don't think&nbsp;it's a better solution than simply creating concrete parents that return the appropriate concrete children, especially if you have behaviors specific to the concrete subtypes.</FONT></P>
<P>...</P>
<P><FONT face=Tahoma size=2>If you want to create an IoC container, as Anthony suggests, then by all means, go ahead.&nbsp; But you're still creating a match between a concrete parent type and concrete child type.</FONT></div></BLOCKQUOTE></P>
<P>In the original post each concrete parent returned concrete collections with concrete children in it. Now each concrete parent return the same generic colection which holds that concrete parent's concrete children. Simply by matching them in this way: <FONT face="Courier New" size=2>Childs&lt;ConcreteChild&gt; _childs</FONT>. I am aware of that I have to match&nbsp;parents with their children. I have never said that I don't want that. For now the <FONT face="Courier New" size=2>_childs</FONT> field is declared in each of the concrete parent, so I can't access it&nbsp;after casting&nbsp;a concrete parent to its base abstract parent type.</P>
<P>When shifting the <FONT face="Courier New" size=2>_childs</FONT> field to the abstract parent class the question is which type&nbsp;does it have? <FONT face="Courier New" size=2>Childs&lt;Child&gt;</FONT>&nbsp;and <FONT face="Courier New" size=2>Childs&lt;Child&lt;T&gt;&gt;</FONT> result in a compilation error.</P>
<P>If there is no solution until the next few days I will use my original approach because&nbsp;I have to finish my project <img src="/emoticons/emotion-1.gif" alt="Smile [:)]" /></P>
<P>Yavuz</P></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
