<html><header><title>Validation Rule Dependency</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Validation Rule Dependency</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/10322.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>ballistic posted on Thursday, April 28, 2011</h2><p>I have a site where members are able to select the country they are from. &nbsp;If they are from the US, I need to validate that they enter a zip code. If international, I need to validate that a region and city name are specified.</p>
<p>I have two questions with validating several dependent properties...<br /><br /><b>Question one:</b><br />Validation is triggered as each property is set, therefore I cannot completely guarantee that if a zip code is being set, the country has been previously selected. &nbsp;Is this something that can be solved by ensuring that the zip code gets set before the zip code?</p>
<p><b>Question two:</b><br />If the &nbsp;values are stored in the following properties, how should my dependencies be set up?<br />CountryIdProperty<br />ZipCodeProperty<br />RegionProperty&nbsp;<br />CityProperty&nbsp;<br /><br />I&#39;m migrating over from 3.8 and trying to figure out the new way of doing this.<br /><br />Thank you,</p>
<p>&nbsp;- Andy&nbsp;</p></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>RockfordLhotka replied on Thursday, April 28, 2011</h2><p>You can use an authorization rule to prevent ZipCode from being writable until CountryId has been set.</p></div><div style='padding:0 15 3 15;background-color:lightgreen'><h2>JonnyBee replied on Friday, April 29, 2011</h2><p>Hi Andy,</p>
<p>Take a look at the Samples\Net\cs\BusinessRuleDemo solution. <br />This shows pretty much of what you need to do. </p>
<p>1. You need to create Authz rules to determine is user can write into fields (based on country)<br />2. Use a schortcut rule like <strong>StopIfNotCanWrite</strong> with priority -1 - available on CslaContrib (no validation rules to run if user is not allowed to edit field)<br />3. Use regular <strong>DataAnnotation rules</strong> or <strong>Csla rules for Required</strong> on fields. </p>
<p>You could alternatively create inherited rules like:<br /><strong>RequiredIfUS</strong> and <strong>RequiredIfNonUS</strong> that inherits from the Csla Required rule and looks at the value of Country field befor calling base.Execute(context);</p>
<p>But I like to possibility to use standard rules and the StopIfNotVanWrite to shortcut rules. This allows me to use DataAnnotation rules but only allow validation ro run when user is allowed to edt (write) into the field. </p>
<p>&nbsp;</p></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
