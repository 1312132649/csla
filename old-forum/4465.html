<html><header><title>Converting a list of BO to DataTable using CopyToDataTable (System.Data.DataSetExtensions)</title></header><body><div style='float:right'><a href='http://cslanet.com'><img src='https://github.com/MarimerLLC/csla/raw/master/Support/Logos/csla%20win8_compact_s.png'/></a></div><p><h1>Converting a list of BO to DataTable using CopyToDataTable (System.Data.DataSetExtensions)</h1><span style='font-size:small'>Old forum URL: forums.lhotka.net/forums/t/4465.aspx</span></p><hr><div style='padding:0 15 3 15;background-color:powderblue'><h2>skaue posted on Thursday, March 06, 2008</h2>Has anyone used this before? I tried to search for info on this here, but no luck. Maybe it's a bad idea, but all I really want to do is simply get a DataTable out of a readonlylist.<br><br>-Tommy<br></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>JoeFallon1 replied on Thursday, March 06, 2008</h2><P>I had to build a DataTable from a ROC in order to bind it to a chart.<BR>(Technically the ROC could be bound to the chart but I wanted to add some logic to the process so I built the dt.)</P>
<P>You should be able to do something similar.</P><FONT color=#0000ff size=2>
<P>Private</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</FONT><FONT size=2> GetData() </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> DataTable<BR>&nbsp; <FONT color=#0000ff size=2>Dim</FONT><FONT size=2> dt </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> DataTable()<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> row </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> DataRow = dt.NewRow()<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Dim</FONT><FONT size=2> currDate </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> = mFilteredList.Item(0).Mydate</FONT></FONT><FONT size=2>&nbsp;</FONT></P><FONT size=2><FONT size=2></FONT><FONT color=#0000ff size=2><FONT size=2>
<P></FONT><FONT color=#008000 size=2>&nbsp; 'Build a list of unique code values&nbsp;<BR></FONT>&nbsp; Dim</FONT><FONT size=2> codeList </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>New</FONT><FONT size=2> System.Collections.Generic.List(</FONT><FONT color=#0000ff size=2>Of</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>)<BR><BR>&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>For</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Each</FONT><FONT size=2> info </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> MyROC.MyInfo </FONT><FONT color=#0000ff size=2>In</FONT><FONT size=2> mFilteredList<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Not</FONT><FONT size=2> codeList.Contains(info.Code) </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>codeList.Add(info.Code)<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Next</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>&nbsp; 'Create the columns&nbsp;for each unique code<BR>&nbsp; </FONT><FONT size=2>dt.Columns.Add(</FONT><FONT color=#ff00ff size=2>"Series Label"</FONT><FONT size=2>, </FONT><FONT color=#0000ff size=2>GetType</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2>))</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp; For</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Each</FONT><FONT size=2> code </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>String</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>In</FONT><FONT size=2> codeList<BR>&nbsp;&nbsp;&nbsp; dt.Columns.Add(code, </FONT><FONT color=#0000ff size=2>GetType</FONT><FONT size=2>(</FONT><FONT color=#0000ff size=2>Decimal</FONT><FONT size=2>))<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Next</P></FONT><FONT size=2>
<P>&nbsp; row.Item(0) = </FONT><FONT color=#0000ff size=2>CDate</FONT><FONT size=2>(mFilteredList.Item(0).Mydate).ToString(</FONT><FONT color=#ff00ff size=2>"MMM dd, yyyy"</FONT><FONT size=2>) </FONT><FONT color=#008000 size=2>'Series Label</P></FONT><FONT size=2>
<P></FONT><FONT color=#0000ff size=2>&nbsp; For</FONT><FONT size=2> i </FONT><FONT color=#0000ff size=2>As</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Integer</FONT><FONT size=2> = 0 </FONT><FONT color=#0000ff size=2>To</FONT><FONT size=2> mFilteredList.Count - 1<BR>&nbsp;&nbsp;&nbsp; mInfo = mFilteredList.Item(i)<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT color=#0000ff size=2>If</FONT><FONT size=2> currDate &lt;&gt; mInfo.Mydate </FONT><FONT color=#0000ff size=2>Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008000 size=2>'add the row with values to the dt<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>dt.Rows.Add(row)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT color=#008000 size=2>'then create a new row and assign the date to the series label<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>row = dt.NewRow()<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; row.Item(0) = </FONT><FONT color=#0000ff size=2>CDate</FONT><FONT size=2>(mInfo.Mydate).ToString(</FONT><FONT color=#ff00ff size=2>"MMM dd, yyyy"</FONT><FONT size=2>) </FONT><FONT color=#008000 size=2>'Series Label<BR>&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>currDate = mInfo.Mydate<BR>&nbsp;&nbsp;&nbsp;</FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>If</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>&nbsp;&nbsp;&nbsp; 'assign the value to the column with the same name as code<BR>&nbsp;&nbsp;&nbsp; </FONT><FONT size=2>row.Item(mInfo.Code) = mInfo.Myvalue<BR>&nbsp; </FONT><FONT color=#0000ff size=2>Next</P></FONT><FONT size=2>
<P></FONT><FONT color=#008000 size=2>&nbsp; 'add the last row<BR>&nbsp; </FONT><FONT size=2>dt.Rows.Add(row)</P>
<P></FONT><FONT color=#0000ff size=2>&nbsp; Return</FONT><FONT size=2> dt<BR></FONT></FONT><FONT color=#0000ff size=2>End</FONT><FONT size=2> </FONT><FONT color=#0000ff size=2>Function</P></FONT>
<P>Joe</P></div><div style='padding:0 15 3 15;background-color:powderblue'><h2>skaue replied on Thursday, March 06, 2008</h2>Thanks for your input. I started to write code to convert manually to DataTable, but I then started to search for a way so that I didn't have to write a load of code on every BO.... I found a "attribute+reflection"-way, but I was hoping that this could be done from the System.Data namespace.<br><br>-Tommy<br></div><p style='font-size:small'>Copyright (c) Marimer LLC</body></html>
